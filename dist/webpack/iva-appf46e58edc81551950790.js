/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = 28);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var bind = __webpack_require__(1);

/*global toString:true*/

// utils is a library of generic helper functions non-specific to axios

var toString = Object.prototype.toString;

/**
 * Determine if a value is an Array
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is an Array, otherwise false
 */
function isArray(val) {
  return toString.call(val) === '[object Array]';
}

/**
 * Determine if a value is undefined
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if the value is undefined, otherwise false
 */
function isUndefined(val) {
  return typeof val === 'undefined';
}

/**
 * Determine if a value is a Buffer
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Buffer, otherwise false
 */
function isBuffer(val) {
  return val !== null && !isUndefined(val) && val.constructor !== null && !isUndefined(val.constructor)
    && typeof val.constructor.isBuffer === 'function' && val.constructor.isBuffer(val);
}

/**
 * Determine if a value is an ArrayBuffer
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is an ArrayBuffer, otherwise false
 */
function isArrayBuffer(val) {
  return toString.call(val) === '[object ArrayBuffer]';
}

/**
 * Determine if a value is a FormData
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is an FormData, otherwise false
 */
function isFormData(val) {
  return (typeof FormData !== 'undefined') && (val instanceof FormData);
}

/**
 * Determine if a value is a view on an ArrayBuffer
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false
 */
function isArrayBufferView(val) {
  var result;
  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {
    result = ArrayBuffer.isView(val);
  } else {
    result = (val) && (val.buffer) && (val.buffer instanceof ArrayBuffer);
  }
  return result;
}

/**
 * Determine if a value is a String
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a String, otherwise false
 */
function isString(val) {
  return typeof val === 'string';
}

/**
 * Determine if a value is a Number
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Number, otherwise false
 */
function isNumber(val) {
  return typeof val === 'number';
}

/**
 * Determine if a value is an Object
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is an Object, otherwise false
 */
function isObject(val) {
  return val !== null && typeof val === 'object';
}

/**
 * Determine if a value is a Date
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Date, otherwise false
 */
function isDate(val) {
  return toString.call(val) === '[object Date]';
}

/**
 * Determine if a value is a File
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a File, otherwise false
 */
function isFile(val) {
  return toString.call(val) === '[object File]';
}

/**
 * Determine if a value is a Blob
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Blob, otherwise false
 */
function isBlob(val) {
  return toString.call(val) === '[object Blob]';
}

/**
 * Determine if a value is a Function
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Function, otherwise false
 */
function isFunction(val) {
  return toString.call(val) === '[object Function]';
}

/**
 * Determine if a value is a Stream
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a Stream, otherwise false
 */
function isStream(val) {
  return isObject(val) && isFunction(val.pipe);
}

/**
 * Determine if a value is a URLSearchParams object
 *
 * @param {Object} val The value to test
 * @returns {boolean} True if value is a URLSearchParams object, otherwise false
 */
function isURLSearchParams(val) {
  return typeof URLSearchParams !== 'undefined' && val instanceof URLSearchParams;
}

/**
 * Trim excess whitespace off the beginning and end of a string
 *
 * @param {String} str The String to trim
 * @returns {String} The String freed of excess whitespace
 */
function trim(str) {
  return str.replace(/^\s*/, '').replace(/\s*$/, '');
}

/**
 * Determine if we're running in a standard browser environment
 *
 * This allows axios to run in a web worker, and react-native.
 * Both environments support XMLHttpRequest, but not fully standard globals.
 *
 * web workers:
 *  typeof window -> undefined
 *  typeof document -> undefined
 *
 * react-native:
 *  navigator.product -> 'ReactNative'
 * nativescript
 *  navigator.product -> 'NativeScript' or 'NS'
 */
function isStandardBrowserEnv() {
  if (typeof navigator !== 'undefined' && (navigator.product === 'ReactNative' ||
                                           navigator.product === 'NativeScript' ||
                                           navigator.product === 'NS')) {
    return false;
  }
  return (
    typeof window !== 'undefined' &&
    typeof document !== 'undefined'
  );
}

/**
 * Iterate over an Array or an Object invoking a function for each item.
 *
 * If `obj` is an Array callback will be called passing
 * the value, index, and complete array for each item.
 *
 * If 'obj' is an Object callback will be called passing
 * the value, key, and complete object for each property.
 *
 * @param {Object|Array} obj The object to iterate
 * @param {Function} fn The callback to invoke for each item
 */
function forEach(obj, fn) {
  // Don't bother if no value provided
  if (obj === null || typeof obj === 'undefined') {
    return;
  }

  // Force an array if not already something iterable
  if (typeof obj !== 'object') {
    /*eslint no-param-reassign:0*/
    obj = [obj];
  }

  if (isArray(obj)) {
    // Iterate over array values
    for (var i = 0, l = obj.length; i < l; i++) {
      fn.call(null, obj[i], i, obj);
    }
  } else {
    // Iterate over object keys
    for (var key in obj) {
      if (Object.prototype.hasOwnProperty.call(obj, key)) {
        fn.call(null, obj[key], key, obj);
      }
    }
  }
}

/**
 * Accepts varargs expecting each argument to be an object, then
 * immutably merges the properties of each object and returns result.
 *
 * When multiple objects contain the same key the later object in
 * the arguments list will take precedence.
 *
 * Example:
 *
 * ```js
 * var result = merge({foo: 123}, {foo: 456});
 * console.log(result.foo); // outputs 456
 * ```
 *
 * @param {Object} obj1 Object to merge
 * @returns {Object} Result of all merge properties
 */
function merge(/* obj1, obj2, obj3, ... */) {
  var result = {};
  function assignValue(val, key) {
    if (typeof result[key] === 'object' && typeof val === 'object') {
      result[key] = merge(result[key], val);
    } else {
      result[key] = val;
    }
  }

  for (var i = 0, l = arguments.length; i < l; i++) {
    forEach(arguments[i], assignValue);
  }
  return result;
}

/**
 * Function equal to merge with the difference being that no reference
 * to original objects is kept.
 *
 * @see merge
 * @param {Object} obj1 Object to merge
 * @returns {Object} Result of all merge properties
 */
function deepMerge(/* obj1, obj2, obj3, ... */) {
  var result = {};
  function assignValue(val, key) {
    if (typeof result[key] === 'object' && typeof val === 'object') {
      result[key] = deepMerge(result[key], val);
    } else if (typeof val === 'object') {
      result[key] = deepMerge({}, val);
    } else {
      result[key] = val;
    }
  }

  for (var i = 0, l = arguments.length; i < l; i++) {
    forEach(arguments[i], assignValue);
  }
  return result;
}

/**
 * Extends object a by mutably adding to it the properties of object b.
 *
 * @param {Object} a The object to be extended
 * @param {Object} b The object to copy properties from
 * @param {Object} thisArg The object to bind function to
 * @return {Object} The resulting value of object a
 */
function extend(a, b, thisArg) {
  forEach(b, function assignValue(val, key) {
    if (thisArg && typeof val === 'function') {
      a[key] = bind(val, thisArg);
    } else {
      a[key] = val;
    }
  });
  return a;
}

module.exports = {
  isArray: isArray,
  isArrayBuffer: isArrayBuffer,
  isBuffer: isBuffer,
  isFormData: isFormData,
  isArrayBufferView: isArrayBufferView,
  isString: isString,
  isNumber: isNumber,
  isObject: isObject,
  isUndefined: isUndefined,
  isDate: isDate,
  isFile: isFile,
  isBlob: isBlob,
  isFunction: isFunction,
  isStream: isStream,
  isURLSearchParams: isURLSearchParams,
  isStandardBrowserEnv: isStandardBrowserEnv,
  forEach: forEach,
  merge: merge,
  deepMerge: deepMerge,
  extend: extend,
  trim: trim
};


/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function bind(fn, thisArg) {
  return function wrap() {
    var args = new Array(arguments.length);
    for (var i = 0; i < args.length; i++) {
      args[i] = arguments[i];
    }
    return fn.apply(thisArg, args);
  };
};


/***/ }),
/* 2 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(0);

function encode(val) {
  return encodeURIComponent(val).
    replace(/%40/gi, '@').
    replace(/%3A/gi, ':').
    replace(/%24/g, '$').
    replace(/%2C/gi, ',').
    replace(/%20/g, '+').
    replace(/%5B/gi, '[').
    replace(/%5D/gi, ']');
}

/**
 * Build a URL by appending params to the end
 *
 * @param {string} url The base of the url (e.g., http://www.google.com)
 * @param {object} [params] The params to be appended
 * @returns {string} The formatted url
 */
module.exports = function buildURL(url, params, paramsSerializer) {
  /*eslint no-param-reassign:0*/
  if (!params) {
    return url;
  }

  var serializedParams;
  if (paramsSerializer) {
    serializedParams = paramsSerializer(params);
  } else if (utils.isURLSearchParams(params)) {
    serializedParams = params.toString();
  } else {
    var parts = [];

    utils.forEach(params, function serialize(val, key) {
      if (val === null || typeof val === 'undefined') {
        return;
      }

      if (utils.isArray(val)) {
        key = key + '[]';
      } else {
        val = [val];
      }

      utils.forEach(val, function parseValue(v) {
        if (utils.isDate(v)) {
          v = v.toISOString();
        } else if (utils.isObject(v)) {
          v = JSON.stringify(v);
        }
        parts.push(encode(key) + '=' + encode(v));
      });
    });

    serializedParams = parts.join('&');
  }

  if (serializedParams) {
    var hashmarkIndex = url.indexOf('#');
    if (hashmarkIndex !== -1) {
      url = url.slice(0, hashmarkIndex);
    }

    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;
  }

  return url;
};


/***/ }),
/* 3 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function isCancel(value) {
  return !!(value && value.__CANCEL__);
};


/***/ }),
/* 4 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(process) {

var utils = __webpack_require__(0);
var normalizeHeaderName = __webpack_require__(16);

var DEFAULT_CONTENT_TYPE = {
  'Content-Type': 'application/x-www-form-urlencoded'
};

function setContentTypeIfUnset(headers, value) {
  if (!utils.isUndefined(headers) && utils.isUndefined(headers['Content-Type'])) {
    headers['Content-Type'] = value;
  }
}

function getDefaultAdapter() {
  var adapter;
  if (typeof XMLHttpRequest !== 'undefined') {
    // For browsers use XHR adapter
    adapter = __webpack_require__(5);
  } else if (typeof process !== 'undefined' && Object.prototype.toString.call(process) === '[object process]') {
    // For node use HTTP adapter
    adapter = __webpack_require__(5);
  }
  return adapter;
}

var defaults = {
  adapter: getDefaultAdapter(),

  transformRequest: [function transformRequest(data, headers) {
    normalizeHeaderName(headers, 'Accept');
    normalizeHeaderName(headers, 'Content-Type');
    if (utils.isFormData(data) ||
      utils.isArrayBuffer(data) ||
      utils.isBuffer(data) ||
      utils.isStream(data) ||
      utils.isFile(data) ||
      utils.isBlob(data)
    ) {
      return data;
    }
    if (utils.isArrayBufferView(data)) {
      return data.buffer;
    }
    if (utils.isURLSearchParams(data)) {
      setContentTypeIfUnset(headers, 'application/x-www-form-urlencoded;charset=utf-8');
      return data.toString();
    }
    if (utils.isObject(data)) {
      setContentTypeIfUnset(headers, 'application/json;charset=utf-8');
      return JSON.stringify(data);
    }
    return data;
  }],

  transformResponse: [function transformResponse(data) {
    /*eslint no-param-reassign:0*/
    if (typeof data === 'string') {
      try {
        data = JSON.parse(data);
      } catch (e) { /* Ignore */ }
    }
    return data;
  }],

  /**
   * A timeout in milliseconds to abort a request. If set to 0 (default) a
   * timeout is not created.
   */
  timeout: 0,

  xsrfCookieName: 'XSRF-TOKEN',
  xsrfHeaderName: 'X-XSRF-TOKEN',

  maxContentLength: -1,

  validateStatus: function validateStatus(status) {
    return status >= 200 && status < 300;
  }
};

defaults.headers = {
  common: {
    'Accept': 'application/json, text/plain, */*'
  }
};

utils.forEach(['delete', 'get', 'head'], function forEachMethodNoData(method) {
  defaults.headers[method] = {};
});

utils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {
  defaults.headers[method] = utils.merge(DEFAULT_CONTENT_TYPE);
});

module.exports = defaults;

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(15)))

/***/ }),
/* 5 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(0);
var settle = __webpack_require__(17);
var buildURL = __webpack_require__(2);
var buildFullPath = __webpack_require__(19);
var parseHeaders = __webpack_require__(22);
var isURLSameOrigin = __webpack_require__(23);
var createError = __webpack_require__(6);

module.exports = function xhrAdapter(config) {
  return new Promise(function dispatchXhrRequest(resolve, reject) {
    var requestData = config.data;
    var requestHeaders = config.headers;

    if (utils.isFormData(requestData)) {
      delete requestHeaders['Content-Type']; // Let the browser set it
    }

    var request = new XMLHttpRequest();

    // HTTP basic authentication
    if (config.auth) {
      var username = config.auth.username || '';
      var password = config.auth.password || '';
      requestHeaders.Authorization = 'Basic ' + btoa(username + ':' + password);
    }

    var fullPath = buildFullPath(config.baseURL, config.url);
    request.open(config.method.toUpperCase(), buildURL(fullPath, config.params, config.paramsSerializer), true);

    // Set the request timeout in MS
    request.timeout = config.timeout;

    // Listen for ready state
    request.onreadystatechange = function handleLoad() {
      if (!request || request.readyState !== 4) {
        return;
      }

      // The request errored out and we didn't get a response, this will be
      // handled by onerror instead
      // With one exception: request that using file: protocol, most browsers
      // will return status as 0 even though it's a successful request
      if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {
        return;
      }

      // Prepare the response
      var responseHeaders = 'getAllResponseHeaders' in request ? parseHeaders(request.getAllResponseHeaders()) : null;
      var responseData = !config.responseType || config.responseType === 'text' ? request.responseText : request.response;
      var response = {
        data: responseData,
        status: request.status,
        statusText: request.statusText,
        headers: responseHeaders,
        config: config,
        request: request
      };

      settle(resolve, reject, response);

      // Clean up request
      request = null;
    };

    // Handle browser request cancellation (as opposed to a manual cancellation)
    request.onabort = function handleAbort() {
      if (!request) {
        return;
      }

      reject(createError('Request aborted', config, 'ECONNABORTED', request));

      // Clean up request
      request = null;
    };

    // Handle low level network errors
    request.onerror = function handleError() {
      // Real errors are hidden from us by the browser
      // onerror should only fire if it's a network error
      reject(createError('Network Error', config, null, request));

      // Clean up request
      request = null;
    };

    // Handle timeout
    request.ontimeout = function handleTimeout() {
      var timeoutErrorMessage = 'timeout of ' + config.timeout + 'ms exceeded';
      if (config.timeoutErrorMessage) {
        timeoutErrorMessage = config.timeoutErrorMessage;
      }
      reject(createError(timeoutErrorMessage, config, 'ECONNABORTED',
        request));

      // Clean up request
      request = null;
    };

    // Add xsrf header
    // This is only done if running in a standard browser environment.
    // Specifically not if we're in a web worker, or react-native.
    if (utils.isStandardBrowserEnv()) {
      var cookies = __webpack_require__(25);

      // Add xsrf header
      var xsrfValue = (config.withCredentials || isURLSameOrigin(fullPath)) && config.xsrfCookieName ?
        cookies.read(config.xsrfCookieName) :
        undefined;

      if (xsrfValue) {
        requestHeaders[config.xsrfHeaderName] = xsrfValue;
      }
    }

    // Add headers to the request
    if ('setRequestHeader' in request) {
      utils.forEach(requestHeaders, function setRequestHeader(val, key) {
        if (typeof requestData === 'undefined' && key.toLowerCase() === 'content-type') {
          // Remove Content-Type if data is undefined
          delete requestHeaders[key];
        } else {
          // Otherwise add header to the request
          request.setRequestHeader(key, val);
        }
      });
    }

    // Add withCredentials to request if needed
    if (!utils.isUndefined(config.withCredentials)) {
      request.withCredentials = !!config.withCredentials;
    }

    // Add responseType to request if needed
    if (config.responseType) {
      try {
        request.responseType = config.responseType;
      } catch (e) {
        // Expected DOMException thrown by browsers not compatible XMLHttpRequest Level 2.
        // But, this can be suppressed for 'json' type as it can be parsed by default 'transformResponse' function.
        if (config.responseType !== 'json') {
          throw e;
        }
      }
    }

    // Handle progress if needed
    if (typeof config.onDownloadProgress === 'function') {
      request.addEventListener('progress', config.onDownloadProgress);
    }

    // Not all browsers support upload events
    if (typeof config.onUploadProgress === 'function' && request.upload) {
      request.upload.addEventListener('progress', config.onUploadProgress);
    }

    if (config.cancelToken) {
      // Handle cancellation
      config.cancelToken.promise.then(function onCanceled(cancel) {
        if (!request) {
          return;
        }

        request.abort();
        reject(cancel);
        // Clean up request
        request = null;
      });
    }

    if (requestData === undefined) {
      requestData = null;
    }

    // Send the request
    request.send(requestData);
  });
};


/***/ }),
/* 6 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var enhanceError = __webpack_require__(18);

/**
 * Create an Error with the specified message, config, error code, request and response.
 *
 * @param {string} message The error message.
 * @param {Object} config The config.
 * @param {string} [code] The error code (for example, 'ECONNABORTED').
 * @param {Object} [request] The request.
 * @param {Object} [response] The response.
 * @returns {Error} The created error.
 */
module.exports = function createError(message, config, code, request, response) {
  var error = new Error(message);
  return enhanceError(error, config, code, request, response);
};


/***/ }),
/* 7 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(0);

/**
 * Config-specific merge-function which creates a new config-object
 * by merging two configuration objects together.
 *
 * @param {Object} config1
 * @param {Object} config2
 * @returns {Object} New object resulting from merging config2 to config1
 */
module.exports = function mergeConfig(config1, config2) {
  // eslint-disable-next-line no-param-reassign
  config2 = config2 || {};
  var config = {};

  var valueFromConfig2Keys = ['url', 'method', 'params', 'data'];
  var mergeDeepPropertiesKeys = ['headers', 'auth', 'proxy'];
  var defaultToConfig2Keys = [
    'baseURL', 'url', 'transformRequest', 'transformResponse', 'paramsSerializer',
    'timeout', 'withCredentials', 'adapter', 'responseType', 'xsrfCookieName',
    'xsrfHeaderName', 'onUploadProgress', 'onDownloadProgress',
    'maxContentLength', 'validateStatus', 'maxRedirects', 'httpAgent',
    'httpsAgent', 'cancelToken', 'socketPath'
  ];

  utils.forEach(valueFromConfig2Keys, function valueFromConfig2(prop) {
    if (typeof config2[prop] !== 'undefined') {
      config[prop] = config2[prop];
    }
  });

  utils.forEach(mergeDeepPropertiesKeys, function mergeDeepProperties(prop) {
    if (utils.isObject(config2[prop])) {
      config[prop] = utils.deepMerge(config1[prop], config2[prop]);
    } else if (typeof config2[prop] !== 'undefined') {
      config[prop] = config2[prop];
    } else if (utils.isObject(config1[prop])) {
      config[prop] = utils.deepMerge(config1[prop]);
    } else if (typeof config1[prop] !== 'undefined') {
      config[prop] = config1[prop];
    }
  });

  utils.forEach(defaultToConfig2Keys, function defaultToConfig2(prop) {
    if (typeof config2[prop] !== 'undefined') {
      config[prop] = config2[prop];
    } else if (typeof config1[prop] !== 'undefined') {
      config[prop] = config1[prop];
    }
  });

  var axiosKeys = valueFromConfig2Keys
    .concat(mergeDeepPropertiesKeys)
    .concat(defaultToConfig2Keys);

  var otherKeys = Object
    .keys(config2)
    .filter(function filterAxiosKeys(key) {
      return axiosKeys.indexOf(key) === -1;
    });

  utils.forEach(otherKeys, function otherKeysDefaultToConfig2(prop) {
    if (typeof config2[prop] !== 'undefined') {
      config[prop] = config2[prop];
    } else if (typeof config1[prop] !== 'undefined') {
      config[prop] = config1[prop];
    }
  });

  return config;
};


/***/ }),
/* 8 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/**
 * A `Cancel` is an object that is thrown when an operation is canceled.
 *
 * @class
 * @param {string=} message The message.
 */
function Cancel(message) {
  this.message = message;
}

Cancel.prototype.toString = function toString() {
  return 'Cancel' + (this.message ? ': ' + this.message : '');
};

Cancel.prototype.__CANCEL__ = true;

module.exports = Cancel;


/***/ }),
/* 9 */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(10);

/***/ }),
/* 10 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(0);
var bind = __webpack_require__(1);
var Axios = __webpack_require__(11);
var mergeConfig = __webpack_require__(7);
var defaults = __webpack_require__(4);

/**
 * Create an instance of Axios
 *
 * @param {Object} defaultConfig The default config for the instance
 * @return {Axios} A new instance of Axios
 */
function createInstance(defaultConfig) {
  var context = new Axios(defaultConfig);
  var instance = bind(Axios.prototype.request, context);

  // Copy axios.prototype to instance
  utils.extend(instance, Axios.prototype, context);

  // Copy context to instance
  utils.extend(instance, context);

  return instance;
}

// Create the default instance to be exported
var axios = createInstance(defaults);

// Expose Axios class to allow class inheritance
axios.Axios = Axios;

// Factory for creating new instances
axios.create = function create(instanceConfig) {
  return createInstance(mergeConfig(axios.defaults, instanceConfig));
};

// Expose Cancel & CancelToken
axios.Cancel = __webpack_require__(8);
axios.CancelToken = __webpack_require__(26);
axios.isCancel = __webpack_require__(3);

// Expose all/spread
axios.all = function all(promises) {
  return Promise.all(promises);
};
axios.spread = __webpack_require__(27);

module.exports = axios;

// Allow use of default import syntax in TypeScript
module.exports.default = axios;


/***/ }),
/* 11 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(0);
var buildURL = __webpack_require__(2);
var InterceptorManager = __webpack_require__(12);
var dispatchRequest = __webpack_require__(13);
var mergeConfig = __webpack_require__(7);

/**
 * Create a new instance of Axios
 *
 * @param {Object} instanceConfig The default config for the instance
 */
function Axios(instanceConfig) {
  this.defaults = instanceConfig;
  this.interceptors = {
    request: new InterceptorManager(),
    response: new InterceptorManager()
  };
}

/**
 * Dispatch a request
 *
 * @param {Object} config The config specific for this request (merged with this.defaults)
 */
Axios.prototype.request = function request(config) {
  /*eslint no-param-reassign:0*/
  // Allow for axios('example/url'[, config]) a la fetch API
  if (typeof config === 'string') {
    config = arguments[1] || {};
    config.url = arguments[0];
  } else {
    config = config || {};
  }

  config = mergeConfig(this.defaults, config);

  // Set config.method
  if (config.method) {
    config.method = config.method.toLowerCase();
  } else if (this.defaults.method) {
    config.method = this.defaults.method.toLowerCase();
  } else {
    config.method = 'get';
  }

  // Hook up interceptors middleware
  var chain = [dispatchRequest, undefined];
  var promise = Promise.resolve(config);

  this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {
    chain.unshift(interceptor.fulfilled, interceptor.rejected);
  });

  this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {
    chain.push(interceptor.fulfilled, interceptor.rejected);
  });

  while (chain.length) {
    promise = promise.then(chain.shift(), chain.shift());
  }

  return promise;
};

Axios.prototype.getUri = function getUri(config) {
  config = mergeConfig(this.defaults, config);
  return buildURL(config.url, config.params, config.paramsSerializer).replace(/^\?/, '');
};

// Provide aliases for supported request methods
utils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {
  /*eslint func-names:0*/
  Axios.prototype[method] = function(url, config) {
    return this.request(utils.merge(config || {}, {
      method: method,
      url: url
    }));
  };
});

utils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {
  /*eslint func-names:0*/
  Axios.prototype[method] = function(url, data, config) {
    return this.request(utils.merge(config || {}, {
      method: method,
      url: url,
      data: data
    }));
  };
});

module.exports = Axios;


/***/ }),
/* 12 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(0);

function InterceptorManager() {
  this.handlers = [];
}

/**
 * Add a new interceptor to the stack
 *
 * @param {Function} fulfilled The function to handle `then` for a `Promise`
 * @param {Function} rejected The function to handle `reject` for a `Promise`
 *
 * @return {Number} An ID used to remove interceptor later
 */
InterceptorManager.prototype.use = function use(fulfilled, rejected) {
  this.handlers.push({
    fulfilled: fulfilled,
    rejected: rejected
  });
  return this.handlers.length - 1;
};

/**
 * Remove an interceptor from the stack
 *
 * @param {Number} id The ID that was returned by `use`
 */
InterceptorManager.prototype.eject = function eject(id) {
  if (this.handlers[id]) {
    this.handlers[id] = null;
  }
};

/**
 * Iterate over all the registered interceptors
 *
 * This method is particularly useful for skipping over any
 * interceptors that may have become `null` calling `eject`.
 *
 * @param {Function} fn The function to call for each interceptor
 */
InterceptorManager.prototype.forEach = function forEach(fn) {
  utils.forEach(this.handlers, function forEachHandler(h) {
    if (h !== null) {
      fn(h);
    }
  });
};

module.exports = InterceptorManager;


/***/ }),
/* 13 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(0);
var transformData = __webpack_require__(14);
var isCancel = __webpack_require__(3);
var defaults = __webpack_require__(4);

/**
 * Throws a `Cancel` if cancellation has been requested.
 */
function throwIfCancellationRequested(config) {
  if (config.cancelToken) {
    config.cancelToken.throwIfRequested();
  }
}

/**
 * Dispatch a request to the server using the configured adapter.
 *
 * @param {object} config The config that is to be used for the request
 * @returns {Promise} The Promise to be fulfilled
 */
module.exports = function dispatchRequest(config) {
  throwIfCancellationRequested(config);

  // Ensure headers exist
  config.headers = config.headers || {};

  // Transform request data
  config.data = transformData(
    config.data,
    config.headers,
    config.transformRequest
  );

  // Flatten headers
  config.headers = utils.merge(
    config.headers.common || {},
    config.headers[config.method] || {},
    config.headers
  );

  utils.forEach(
    ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],
    function cleanHeaderConfig(method) {
      delete config.headers[method];
    }
  );

  var adapter = config.adapter || defaults.adapter;

  return adapter(config).then(function onAdapterResolution(response) {
    throwIfCancellationRequested(config);

    // Transform response data
    response.data = transformData(
      response.data,
      response.headers,
      config.transformResponse
    );

    return response;
  }, function onAdapterRejection(reason) {
    if (!isCancel(reason)) {
      throwIfCancellationRequested(config);

      // Transform response data
      if (reason && reason.response) {
        reason.response.data = transformData(
          reason.response.data,
          reason.response.headers,
          config.transformResponse
        );
      }
    }

    return Promise.reject(reason);
  });
};


/***/ }),
/* 14 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(0);

/**
 * Transform the data for a request or a response
 *
 * @param {Object|String} data The data to be transformed
 * @param {Array} headers The headers for the request or response
 * @param {Array|Function} fns A single function or Array of functions
 * @returns {*} The resulting transformed data
 */
module.exports = function transformData(data, headers, fns) {
  /*eslint no-param-reassign:0*/
  utils.forEach(fns, function transform(fn) {
    data = fn(data, headers);
  });

  return data;
};


/***/ }),
/* 15 */
/***/ (function(module, exports) {

// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };


/***/ }),
/* 16 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(0);

module.exports = function normalizeHeaderName(headers, normalizedName) {
  utils.forEach(headers, function processHeader(value, name) {
    if (name !== normalizedName && name.toUpperCase() === normalizedName.toUpperCase()) {
      headers[normalizedName] = value;
      delete headers[name];
    }
  });
};


/***/ }),
/* 17 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var createError = __webpack_require__(6);

/**
 * Resolve or reject a Promise based on response status.
 *
 * @param {Function} resolve A function that resolves the promise.
 * @param {Function} reject A function that rejects the promise.
 * @param {object} response The response.
 */
module.exports = function settle(resolve, reject, response) {
  var validateStatus = response.config.validateStatus;
  if (!validateStatus || validateStatus(response.status)) {
    resolve(response);
  } else {
    reject(createError(
      'Request failed with status code ' + response.status,
      response.config,
      null,
      response.request,
      response
    ));
  }
};


/***/ }),
/* 18 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/**
 * Update an Error with the specified config, error code, and response.
 *
 * @param {Error} error The error to update.
 * @param {Object} config The config.
 * @param {string} [code] The error code (for example, 'ECONNABORTED').
 * @param {Object} [request] The request.
 * @param {Object} [response] The response.
 * @returns {Error} The error.
 */
module.exports = function enhanceError(error, config, code, request, response) {
  error.config = config;
  if (code) {
    error.code = code;
  }

  error.request = request;
  error.response = response;
  error.isAxiosError = true;

  error.toJSON = function() {
    return {
      // Standard
      message: this.message,
      name: this.name,
      // Microsoft
      description: this.description,
      number: this.number,
      // Mozilla
      fileName: this.fileName,
      lineNumber: this.lineNumber,
      columnNumber: this.columnNumber,
      stack: this.stack,
      // Axios
      config: this.config,
      code: this.code
    };
  };
  return error;
};


/***/ }),
/* 19 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var isAbsoluteURL = __webpack_require__(20);
var combineURLs = __webpack_require__(21);

/**
 * Creates a new URL by combining the baseURL with the requestedURL,
 * only when the requestedURL is not already an absolute URL.
 * If the requestURL is absolute, this function returns the requestedURL untouched.
 *
 * @param {string} baseURL The base URL
 * @param {string} requestedURL Absolute or relative URL to combine
 * @returns {string} The combined full path
 */
module.exports = function buildFullPath(baseURL, requestedURL) {
  if (baseURL && !isAbsoluteURL(requestedURL)) {
    return combineURLs(baseURL, requestedURL);
  }
  return requestedURL;
};


/***/ }),
/* 20 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/**
 * Determines whether the specified URL is absolute
 *
 * @param {string} url The URL to test
 * @returns {boolean} True if the specified URL is absolute, otherwise false
 */
module.exports = function isAbsoluteURL(url) {
  // A URL is considered absolute if it begins with "<scheme>://" or "//" (protocol-relative URL).
  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed
  // by any combination of letters, digits, plus, period, or hyphen.
  return /^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(url);
};


/***/ }),
/* 21 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/**
 * Creates a new URL by combining the specified URLs
 *
 * @param {string} baseURL The base URL
 * @param {string} relativeURL The relative URL
 * @returns {string} The combined URL
 */
module.exports = function combineURLs(baseURL, relativeURL) {
  return relativeURL
    ? baseURL.replace(/\/+$/, '') + '/' + relativeURL.replace(/^\/+/, '')
    : baseURL;
};


/***/ }),
/* 22 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(0);

// Headers whose duplicates are ignored by node
// c.f. https://nodejs.org/api/http.html#http_message_headers
var ignoreDuplicateOf = [
  'age', 'authorization', 'content-length', 'content-type', 'etag',
  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',
  'last-modified', 'location', 'max-forwards', 'proxy-authorization',
  'referer', 'retry-after', 'user-agent'
];

/**
 * Parse headers into an object
 *
 * ```
 * Date: Wed, 27 Aug 2014 08:58:49 GMT
 * Content-Type: application/json
 * Connection: keep-alive
 * Transfer-Encoding: chunked
 * ```
 *
 * @param {String} headers Headers needing to be parsed
 * @returns {Object} Headers parsed into an object
 */
module.exports = function parseHeaders(headers) {
  var parsed = {};
  var key;
  var val;
  var i;

  if (!headers) { return parsed; }

  utils.forEach(headers.split('\n'), function parser(line) {
    i = line.indexOf(':');
    key = utils.trim(line.substr(0, i)).toLowerCase();
    val = utils.trim(line.substr(i + 1));

    if (key) {
      if (parsed[key] && ignoreDuplicateOf.indexOf(key) >= 0) {
        return;
      }
      if (key === 'set-cookie') {
        parsed[key] = (parsed[key] ? parsed[key] : []).concat([val]);
      } else {
        parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;
      }
    }
  });

  return parsed;
};


/***/ }),
/* 23 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(0);
var isValidXss = __webpack_require__(24);

module.exports = (
  utils.isStandardBrowserEnv() ?

  // Standard browser envs have full support of the APIs needed to test
  // whether the request URL is of the same origin as current location.
    (function standardBrowserEnv() {
      var msie = /(msie|trident)/i.test(navigator.userAgent);
      var urlParsingNode = document.createElement('a');
      var originURL;

      /**
    * Parse a URL to discover it's components
    *
    * @param {String} url The URL to be parsed
    * @returns {Object}
    */
      function resolveURL(url) {
        var href = url;

        if (isValidXss(url)) {
          throw new Error('URL contains XSS injection attempt');
        }

        if (msie) {
        // IE needs attribute set twice to normalize properties
          urlParsingNode.setAttribute('href', href);
          href = urlParsingNode.href;
        }

        urlParsingNode.setAttribute('href', href);

        // urlParsingNode provides the UrlUtils interface - http://url.spec.whatwg.org/#urlutils
        return {
          href: urlParsingNode.href,
          protocol: urlParsingNode.protocol ? urlParsingNode.protocol.replace(/:$/, '') : '',
          host: urlParsingNode.host,
          search: urlParsingNode.search ? urlParsingNode.search.replace(/^\?/, '') : '',
          hash: urlParsingNode.hash ? urlParsingNode.hash.replace(/^#/, '') : '',
          hostname: urlParsingNode.hostname,
          port: urlParsingNode.port,
          pathname: (urlParsingNode.pathname.charAt(0) === '/') ?
            urlParsingNode.pathname :
            '/' + urlParsingNode.pathname
        };
      }

      originURL = resolveURL(window.location.href);

      /**
    * Determine if a URL shares the same origin as the current location
    *
    * @param {String} requestURL The URL to test
    * @returns {boolean} True if URL shares the same origin, otherwise false
    */
      return function isURLSameOrigin(requestURL) {
        var parsed = (utils.isString(requestURL)) ? resolveURL(requestURL) : requestURL;
        return (parsed.protocol === originURL.protocol &&
            parsed.host === originURL.host);
      };
    })() :

  // Non standard browser envs (web workers, react-native) lack needed support.
    (function nonStandardBrowserEnv() {
      return function isURLSameOrigin() {
        return true;
      };
    })()
);


/***/ }),
/* 24 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


module.exports = function isValidXss(requestURL) {
  var xssRegex = /(\b)(on\w+)=|javascript|(<\s*)(\/*)script/gi;
  return xssRegex.test(requestURL);
};



/***/ }),
/* 25 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var utils = __webpack_require__(0);

module.exports = (
  utils.isStandardBrowserEnv() ?

  // Standard browser envs support document.cookie
    (function standardBrowserEnv() {
      return {
        write: function write(name, value, expires, path, domain, secure) {
          var cookie = [];
          cookie.push(name + '=' + encodeURIComponent(value));

          if (utils.isNumber(expires)) {
            cookie.push('expires=' + new Date(expires).toGMTString());
          }

          if (utils.isString(path)) {
            cookie.push('path=' + path);
          }

          if (utils.isString(domain)) {
            cookie.push('domain=' + domain);
          }

          if (secure === true) {
            cookie.push('secure');
          }

          document.cookie = cookie.join('; ');
        },

        read: function read(name) {
          var match = document.cookie.match(new RegExp('(^|;\\s*)(' + name + ')=([^;]*)'));
          return (match ? decodeURIComponent(match[3]) : null);
        },

        remove: function remove(name) {
          this.write(name, '', Date.now() - 86400000);
        }
      };
    })() :

  // Non standard browser env (web workers, react-native) lack needed support.
    (function nonStandardBrowserEnv() {
      return {
        write: function write() {},
        read: function read() { return null; },
        remove: function remove() {}
      };
    })()
);


/***/ }),
/* 26 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var Cancel = __webpack_require__(8);

/**
 * A `CancelToken` is an object that can be used to request cancellation of an operation.
 *
 * @class
 * @param {Function} executor The executor function.
 */
function CancelToken(executor) {
  if (typeof executor !== 'function') {
    throw new TypeError('executor must be a function.');
  }

  var resolvePromise;
  this.promise = new Promise(function promiseExecutor(resolve) {
    resolvePromise = resolve;
  });

  var token = this;
  executor(function cancel(message) {
    if (token.reason) {
      // Cancellation has already been requested
      return;
    }

    token.reason = new Cancel(message);
    resolvePromise(token.reason);
  });
}

/**
 * Throws a `Cancel` if cancellation has been requested.
 */
CancelToken.prototype.throwIfRequested = function throwIfRequested() {
  if (this.reason) {
    throw this.reason;
  }
};

/**
 * Returns an object that contains a new `CancelToken` and a function that, when called,
 * cancels the `CancelToken`.
 */
CancelToken.source = function source() {
  var cancel;
  var token = new CancelToken(function executor(c) {
    cancel = c;
  });
  return {
    token: token,
    cancel: cancel
  };
};

module.exports = CancelToken;


/***/ }),
/* 27 */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/**
 * Syntactic sugar for invoking a function and expanding an array for arguments.
 *
 * Common use case would be to use `Function.prototype.apply`.
 *
 *  ```js
 *  function f(x, y, z) {}
 *  var args = [1, 2, 3];
 *  f.apply(null, args);
 *  ```
 *
 * With `spread` this example can be re-written.
 *
 *  ```js
 *  spread(function(x, y, z) {})([1, 2, 3]);
 *  ```
 *
 * @param {Function} callback
 * @returns {Function}
 */
module.exports = function spread(callback) {
  return function wrap(arr) {
    return callback.apply(null, arr);
  };
};


/***/ }),
/* 28 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);

// CONCATENATED MODULE: ./node_modules/lit-html/lib/directive.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const directives = new WeakMap();
/**
 * Brands a function as a directive factory function so that lit-html will call
 * the function during template rendering, rather than passing as a value.
 *
 * A _directive_ is a function that takes a Part as an argument. It has the
 * signature: `(part: Part) => void`.
 *
 * A directive _factory_ is a function that takes arguments for data and
 * configuration and returns a directive. Users of directive usually refer to
 * the directive factory as the directive. For example, "The repeat directive".
 *
 * Usually a template author will invoke a directive factory in their template
 * with relevant arguments, which will then return a directive function.
 *
 * Here's an example of using the `repeat()` directive factory that takes an
 * array and a function to render an item:
 *
 * ```js
 * html`<ul><${repeat(items, (item) => html`<li>${item}</li>`)}</ul>`
 * ```
 *
 * When `repeat` is invoked, it returns a directive function that closes over
 * `items` and the template function. When the outer template is rendered, the
 * return directive function is called with the Part for the expression.
 * `repeat` then performs it's custom logic to render multiple items.
 *
 * @param f The directive factory function. Must be a function that returns a
 * function of the signature `(part: Part) => void`. The returned function will
 * be called with the part object.
 *
 * @example
 *
 * import {directive, html} from 'lit-html';
 *
 * const immutable = directive((v) => (part) => {
 *   if (part.value !== v) {
 *     part.setValue(v)
 *   }
 * });
 */
const directive_directive = (f) => ((...args) => {
    const d = f(...args);
    directives.set(d, true);
    return d;
});
const isDirective = (o) => {
    return typeof o === 'function' && directives.has(o);
};
//# sourceMappingURL=directive.js.map
// CONCATENATED MODULE: ./node_modules/lit-html/lib/dom.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * True if the custom elements polyfill is in use.
 */
const isCEPolyfill = window.customElements !== undefined &&
    window.customElements.polyfillWrapFlushCallback !==
        undefined;
/**
 * Reparents nodes, starting from `start` (inclusive) to `end` (exclusive),
 * into another container (could be the same container), before `before`. If
 * `before` is null, it appends the nodes to the container.
 */
const reparentNodes = (container, start, end = null, before = null) => {
    while (start !== end) {
        const n = start.nextSibling;
        container.insertBefore(start, before);
        start = n;
    }
};
/**
 * Removes nodes, starting from `start` (inclusive) to `end` (exclusive), from
 * `container`.
 */
const removeNodes = (container, start, end = null) => {
    while (start !== end) {
        const n = start.nextSibling;
        container.removeChild(start);
        start = n;
    }
};
//# sourceMappingURL=dom.js.map
// CONCATENATED MODULE: ./node_modules/lit-html/lib/part.js
/**
 * @license
 * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * A sentinel value that signals that a value was handled by a directive and
 * should not be written to the DOM.
 */
const noChange = {};
/**
 * A sentinel value that signals a NodePart to fully clear its content.
 */
const nothing = {};
//# sourceMappingURL=part.js.map
// CONCATENATED MODULE: ./node_modules/lit-html/lib/template.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * An expression marker with embedded unique key to avoid collision with
 * possible text in templates.
 */
const marker = `{{lit-${String(Math.random()).slice(2)}}}`;
/**
 * An expression marker used text-positions, multi-binding attributes, and
 * attributes with markup-like text values.
 */
const nodeMarker = `<!--${marker}-->`;
const markerRegex = new RegExp(`${marker}|${nodeMarker}`);
/**
 * Suffix appended to all bound attribute names.
 */
const boundAttributeSuffix = '$lit$';
/**
 * An updateable Template that tracks the location of dynamic parts.
 */
class Template {
    constructor(result, element) {
        this.parts = [];
        this.element = element;
        const nodesToRemove = [];
        const stack = [];
        // Edge needs all 4 parameters present; IE11 needs 3rd parameter to be null
        const walker = document.createTreeWalker(element.content, 133 /* NodeFilter.SHOW_{ELEMENT|COMMENT|TEXT} */, null, false);
        // Keeps track of the last index associated with a part. We try to delete
        // unnecessary nodes, but we never want to associate two different parts
        // to the same index. They must have a constant node between.
        let lastPartIndex = 0;
        let index = -1;
        let partIndex = 0;
        const { strings, values: { length } } = result;
        while (partIndex < length) {
            const node = walker.nextNode();
            if (node === null) {
                // We've exhausted the content inside a nested template element.
                // Because we still have parts (the outer for-loop), we know:
                // - There is a template in the stack
                // - The walker will find a nextNode outside the template
                walker.currentNode = stack.pop();
                continue;
            }
            index++;
            if (node.nodeType === 1 /* Node.ELEMENT_NODE */) {
                if (node.hasAttributes()) {
                    const attributes = node.attributes;
                    const { length } = attributes;
                    // Per
                    // https://developer.mozilla.org/en-US/docs/Web/API/NamedNodeMap,
                    // attributes are not guaranteed to be returned in document order.
                    // In particular, Edge/IE can return them out of order, so we cannot
                    // assume a correspondence between part index and attribute index.
                    let count = 0;
                    for (let i = 0; i < length; i++) {
                        if (endsWith(attributes[i].name, boundAttributeSuffix)) {
                            count++;
                        }
                    }
                    while (count-- > 0) {
                        // Get the template literal section leading up to the first
                        // expression in this attribute
                        const stringForPart = strings[partIndex];
                        // Find the attribute name
                        const name = lastAttributeNameRegex.exec(stringForPart)[2];
                        // Find the corresponding attribute
                        // All bound attributes have had a suffix added in
                        // TemplateResult#getHTML to opt out of special attribute
                        // handling. To look up the attribute value we also need to add
                        // the suffix.
                        const attributeLookupName = name.toLowerCase() + boundAttributeSuffix;
                        const attributeValue = node.getAttribute(attributeLookupName);
                        node.removeAttribute(attributeLookupName);
                        const statics = attributeValue.split(markerRegex);
                        this.parts.push({ type: 'attribute', index, name, strings: statics });
                        partIndex += statics.length - 1;
                    }
                }
                if (node.tagName === 'TEMPLATE') {
                    stack.push(node);
                    walker.currentNode = node.content;
                }
            }
            else if (node.nodeType === 3 /* Node.TEXT_NODE */) {
                const data = node.data;
                if (data.indexOf(marker) >= 0) {
                    const parent = node.parentNode;
                    const strings = data.split(markerRegex);
                    const lastIndex = strings.length - 1;
                    // Generate a new text node for each literal section
                    // These nodes are also used as the markers for node parts
                    for (let i = 0; i < lastIndex; i++) {
                        let insert;
                        let s = strings[i];
                        if (s === '') {
                            insert = createMarker();
                        }
                        else {
                            const match = lastAttributeNameRegex.exec(s);
                            if (match !== null && endsWith(match[2], boundAttributeSuffix)) {
                                s = s.slice(0, match.index) + match[1] +
                                    match[2].slice(0, -boundAttributeSuffix.length) + match[3];
                            }
                            insert = document.createTextNode(s);
                        }
                        parent.insertBefore(insert, node);
                        this.parts.push({ type: 'node', index: ++index });
                    }
                    // If there's no text, we must insert a comment to mark our place.
                    // Else, we can trust it will stick around after cloning.
                    if (strings[lastIndex] === '') {
                        parent.insertBefore(createMarker(), node);
                        nodesToRemove.push(node);
                    }
                    else {
                        node.data = strings[lastIndex];
                    }
                    // We have a part for each match found
                    partIndex += lastIndex;
                }
            }
            else if (node.nodeType === 8 /* Node.COMMENT_NODE */) {
                if (node.data === marker) {
                    const parent = node.parentNode;
                    // Add a new marker node to be the startNode of the Part if any of
                    // the following are true:
                    //  * We don't have a previousSibling
                    //  * The previousSibling is already the start of a previous part
                    if (node.previousSibling === null || index === lastPartIndex) {
                        index++;
                        parent.insertBefore(createMarker(), node);
                    }
                    lastPartIndex = index;
                    this.parts.push({ type: 'node', index });
                    // If we don't have a nextSibling, keep this node so we have an end.
                    // Else, we can remove it to save future costs.
                    if (node.nextSibling === null) {
                        node.data = '';
                    }
                    else {
                        nodesToRemove.push(node);
                        index--;
                    }
                    partIndex++;
                }
                else {
                    let i = -1;
                    while ((i = node.data.indexOf(marker, i + 1)) !== -1) {
                        // Comment node has a binding marker inside, make an inactive part
                        // The binding won't work, but subsequent bindings will
                        // TODO (justinfagnani): consider whether it's even worth it to
                        // make bindings in comments work
                        this.parts.push({ type: 'node', index: -1 });
                        partIndex++;
                    }
                }
            }
        }
        // Remove text binding nodes after the walk to not disturb the TreeWalker
        for (const n of nodesToRemove) {
            n.parentNode.removeChild(n);
        }
    }
}
const endsWith = (str, suffix) => {
    const index = str.length - suffix.length;
    return index >= 0 && str.slice(index) === suffix;
};
const isTemplatePartActive = (part) => part.index !== -1;
// Allows `document.createComment('')` to be renamed for a
// small manual size-savings.
const createMarker = () => document.createComment('');
/**
 * This regex extracts the attribute name preceding an attribute-position
 * expression. It does this by matching the syntax allowed for attributes
 * against the string literal directly preceding the expression, assuming that
 * the expression is in an attribute-value position.
 *
 * See attributes in the HTML spec:
 * https://www.w3.org/TR/html5/syntax.html#elements-attributes
 *
 * " \x09\x0a\x0c\x0d" are HTML space characters:
 * https://www.w3.org/TR/html5/infrastructure.html#space-characters
 *
 * "\0-\x1F\x7F-\x9F" are Unicode control characters, which includes every
 * space character except " ".
 *
 * So an attribute is:
 *  * The name: any character except a control character, space character, ('),
 *    ("), ">", "=", or "/"
 *  * Followed by zero or more space characters
 *  * Followed by "="
 *  * Followed by zero or more space characters
 *  * Followed by:
 *    * Any character except space, ('), ("), "<", ">", "=", (`), or
 *    * (") then any non-("), or
 *    * (') then any non-(')
 */
const lastAttributeNameRegex = /([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;
//# sourceMappingURL=template.js.map
// CONCATENATED MODULE: ./node_modules/lit-html/lib/template-instance.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * @module lit-html
 */


/**
 * An instance of a `Template` that can be attached to the DOM and updated
 * with new values.
 */
class template_instance_TemplateInstance {
    constructor(template, processor, options) {
        this.__parts = [];
        this.template = template;
        this.processor = processor;
        this.options = options;
    }
    update(values) {
        let i = 0;
        for (const part of this.__parts) {
            if (part !== undefined) {
                part.setValue(values[i]);
            }
            i++;
        }
        for (const part of this.__parts) {
            if (part !== undefined) {
                part.commit();
            }
        }
    }
    _clone() {
        // There are a number of steps in the lifecycle of a template instance's
        // DOM fragment:
        //  1. Clone - create the instance fragment
        //  2. Adopt - adopt into the main document
        //  3. Process - find part markers and create parts
        //  4. Upgrade - upgrade custom elements
        //  5. Update - set node, attribute, property, etc., values
        //  6. Connect - connect to the document. Optional and outside of this
        //     method.
        //
        // We have a few constraints on the ordering of these steps:
        //  * We need to upgrade before updating, so that property values will pass
        //    through any property setters.
        //  * We would like to process before upgrading so that we're sure that the
        //    cloned fragment is inert and not disturbed by self-modifying DOM.
        //  * We want custom elements to upgrade even in disconnected fragments.
        //
        // Given these constraints, with full custom elements support we would
        // prefer the order: Clone, Process, Adopt, Upgrade, Update, Connect
        //
        // But Safari dooes not implement CustomElementRegistry#upgrade, so we
        // can not implement that order and still have upgrade-before-update and
        // upgrade disconnected fragments. So we instead sacrifice the
        // process-before-upgrade constraint, since in Custom Elements v1 elements
        // must not modify their light DOM in the constructor. We still have issues
        // when co-existing with CEv0 elements like Polymer 1, and with polyfills
        // that don't strictly adhere to the no-modification rule because shadow
        // DOM, which may be created in the constructor, is emulated by being placed
        // in the light DOM.
        //
        // The resulting order is on native is: Clone, Adopt, Upgrade, Process,
        // Update, Connect. document.importNode() performs Clone, Adopt, and Upgrade
        // in one step.
        //
        // The Custom Elements v1 polyfill supports upgrade(), so the order when
        // polyfilled is the more ideal: Clone, Process, Adopt, Upgrade, Update,
        // Connect.
        const fragment = isCEPolyfill ?
            this.template.element.content.cloneNode(true) :
            document.importNode(this.template.element.content, true);
        const stack = [];
        const parts = this.template.parts;
        // Edge needs all 4 parameters present; IE11 needs 3rd parameter to be null
        const walker = document.createTreeWalker(fragment, 133 /* NodeFilter.SHOW_{ELEMENT|COMMENT|TEXT} */, null, false);
        let partIndex = 0;
        let nodeIndex = 0;
        let part;
        let node = walker.nextNode();
        // Loop through all the nodes and parts of a template
        while (partIndex < parts.length) {
            part = parts[partIndex];
            if (!isTemplatePartActive(part)) {
                this.__parts.push(undefined);
                partIndex++;
                continue;
            }
            // Progress the tree walker until we find our next part's node.
            // Note that multiple parts may share the same node (attribute parts
            // on a single element), so this loop may not run at all.
            while (nodeIndex < part.index) {
                nodeIndex++;
                if (node.nodeName === 'TEMPLATE') {
                    stack.push(node);
                    walker.currentNode = node.content;
                }
                if ((node = walker.nextNode()) === null) {
                    // We've exhausted the content inside a nested template element.
                    // Because we still have parts (the outer for-loop), we know:
                    // - There is a template in the stack
                    // - The walker will find a nextNode outside the template
                    walker.currentNode = stack.pop();
                    node = walker.nextNode();
                }
            }
            // We've arrived at our part's node.
            if (part.type === 'node') {
                const part = this.processor.handleTextExpression(this.options);
                part.insertAfterNode(node.previousSibling);
                this.__parts.push(part);
            }
            else {
                this.__parts.push(...this.processor.handleAttributeExpressions(node, part.name, part.strings, this.options));
            }
            partIndex++;
        }
        if (isCEPolyfill) {
            document.adoptNode(fragment);
            customElements.upgrade(fragment);
        }
        return fragment;
    }
}
//# sourceMappingURL=template-instance.js.map
// CONCATENATED MODULE: ./node_modules/lit-html/lib/template-result.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * @module lit-html
 */


const commentMarker = ` ${marker} `;
/**
 * The return type of `html`, which holds a Template and the values from
 * interpolated expressions.
 */
class template_result_TemplateResult {
    constructor(strings, values, type, processor) {
        this.strings = strings;
        this.values = values;
        this.type = type;
        this.processor = processor;
    }
    /**
     * Returns a string of HTML used to create a `<template>` element.
     */
    getHTML() {
        const l = this.strings.length - 1;
        let html = '';
        let isCommentBinding = false;
        for (let i = 0; i < l; i++) {
            const s = this.strings[i];
            // For each binding we want to determine the kind of marker to insert
            // into the template source before it's parsed by the browser's HTML
            // parser. The marker type is based on whether the expression is in an
            // attribute, text, or comment poisition.
            //   * For node-position bindings we insert a comment with the marker
            //     sentinel as its text content, like <!--{{lit-guid}}-->.
            //   * For attribute bindings we insert just the marker sentinel for the
            //     first binding, so that we support unquoted attribute bindings.
            //     Subsequent bindings can use a comment marker because multi-binding
            //     attributes must be quoted.
            //   * For comment bindings we insert just the marker sentinel so we don't
            //     close the comment.
            //
            // The following code scans the template source, but is *not* an HTML
            // parser. We don't need to track the tree structure of the HTML, only
            // whether a binding is inside a comment, and if not, if it appears to be
            // the first binding in an attribute.
            const commentOpen = s.lastIndexOf('<!--');
            // We're in comment position if we have a comment open with no following
            // comment close. Because <-- can appear in an attribute value there can
            // be false positives.
            isCommentBinding = (commentOpen > -1 || isCommentBinding) &&
                s.indexOf('-->', commentOpen + 1) === -1;
            // Check to see if we have an attribute-like sequence preceeding the
            // expression. This can match "name=value" like structures in text,
            // comments, and attribute values, so there can be false-positives.
            const attributeMatch = lastAttributeNameRegex.exec(s);
            if (attributeMatch === null) {
                // We're only in this branch if we don't have a attribute-like
                // preceeding sequence. For comments, this guards against unusual
                // attribute values like <div foo="<!--${'bar'}">. Cases like
                // <!-- foo=${'bar'}--> are handled correctly in the attribute branch
                // below.
                html += s + (isCommentBinding ? commentMarker : nodeMarker);
            }
            else {
                // For attributes we use just a marker sentinel, and also append a
                // $lit$ suffix to the name to opt-out of attribute-specific parsing
                // that IE and Edge do for style and certain SVG attributes.
                html += s.substr(0, attributeMatch.index) + attributeMatch[1] +
                    attributeMatch[2] + boundAttributeSuffix + attributeMatch[3] +
                    marker;
            }
        }
        html += this.strings[l];
        return html;
    }
    getTemplateElement() {
        const template = document.createElement('template');
        template.innerHTML = this.getHTML();
        return template;
    }
}
/**
 * A TemplateResult for SVG fragments.
 *
 * This class wraps HTML in an `<svg>` tag in order to parse its contents in the
 * SVG namespace, then modifies the template to remove the `<svg>` tag so that
 * clones only container the original fragment.
 */
class template_result_SVGTemplateResult extends template_result_TemplateResult {
    getHTML() {
        return `<svg>${super.getHTML()}</svg>`;
    }
    getTemplateElement() {
        const template = super.getTemplateElement();
        const content = template.content;
        const svgElement = content.firstChild;
        content.removeChild(svgElement);
        reparentNodes(content, svgElement.firstChild);
        return template;
    }
}
//# sourceMappingURL=template-result.js.map
// CONCATENATED MODULE: ./node_modules/lit-html/lib/parts.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * @module lit-html
 */






const isPrimitive = (value) => {
    return (value === null ||
        !(typeof value === 'object' || typeof value === 'function'));
};
const isIterable = (value) => {
    return Array.isArray(value) ||
        // tslint:disable-next-line:no-any
        !!(value && value[Symbol.iterator]);
};
/**
 * Writes attribute values to the DOM for a group of AttributeParts bound to a
 * single attibute. The value is only set once even if there are multiple parts
 * for an attribute.
 */
class AttributeCommitter {
    constructor(element, name, strings) {
        this.dirty = true;
        this.element = element;
        this.name = name;
        this.strings = strings;
        this.parts = [];
        for (let i = 0; i < strings.length - 1; i++) {
            this.parts[i] = this._createPart();
        }
    }
    /**
     * Creates a single part. Override this to create a differnt type of part.
     */
    _createPart() {
        return new parts_AttributePart(this);
    }
    _getValue() {
        const strings = this.strings;
        const l = strings.length - 1;
        let text = '';
        for (let i = 0; i < l; i++) {
            text += strings[i];
            const part = this.parts[i];
            if (part !== undefined) {
                const v = part.value;
                if (isPrimitive(v) || !isIterable(v)) {
                    text += typeof v === 'string' ? v : String(v);
                }
                else {
                    for (const t of v) {
                        text += typeof t === 'string' ? t : String(t);
                    }
                }
            }
        }
        text += strings[l];
        return text;
    }
    commit() {
        if (this.dirty) {
            this.dirty = false;
            this.element.setAttribute(this.name, this._getValue());
        }
    }
}
/**
 * A Part that controls all or part of an attribute value.
 */
class parts_AttributePart {
    constructor(committer) {
        this.value = undefined;
        this.committer = committer;
    }
    setValue(value) {
        if (value !== noChange && (!isPrimitive(value) || value !== this.value)) {
            this.value = value;
            // If the value is a not a directive, dirty the committer so that it'll
            // call setAttribute. If the value is a directive, it'll dirty the
            // committer if it calls setValue().
            if (!isDirective(value)) {
                this.committer.dirty = true;
            }
        }
    }
    commit() {
        while (isDirective(this.value)) {
            const directive = this.value;
            this.value = noChange;
            directive(this);
        }
        if (this.value === noChange) {
            return;
        }
        this.committer.commit();
    }
}
/**
 * A Part that controls a location within a Node tree. Like a Range, NodePart
 * has start and end locations and can set and update the Nodes between those
 * locations.
 *
 * NodeParts support several value types: primitives, Nodes, TemplateResults,
 * as well as arrays and iterables of those types.
 */
class parts_NodePart {
    constructor(options) {
        this.value = undefined;
        this.__pendingValue = undefined;
        this.options = options;
    }
    /**
     * Appends this part into a container.
     *
     * This part must be empty, as its contents are not automatically moved.
     */
    appendInto(container) {
        this.startNode = container.appendChild(createMarker());
        this.endNode = container.appendChild(createMarker());
    }
    /**
     * Inserts this part after the `ref` node (between `ref` and `ref`'s next
     * sibling). Both `ref` and its next sibling must be static, unchanging nodes
     * such as those that appear in a literal section of a template.
     *
     * This part must be empty, as its contents are not automatically moved.
     */
    insertAfterNode(ref) {
        this.startNode = ref;
        this.endNode = ref.nextSibling;
    }
    /**
     * Appends this part into a parent part.
     *
     * This part must be empty, as its contents are not automatically moved.
     */
    appendIntoPart(part) {
        part.__insert(this.startNode = createMarker());
        part.__insert(this.endNode = createMarker());
    }
    /**
     * Inserts this part after the `ref` part.
     *
     * This part must be empty, as its contents are not automatically moved.
     */
    insertAfterPart(ref) {
        ref.__insert(this.startNode = createMarker());
        this.endNode = ref.endNode;
        ref.endNode = this.startNode;
    }
    setValue(value) {
        this.__pendingValue = value;
    }
    commit() {
        while (isDirective(this.__pendingValue)) {
            const directive = this.__pendingValue;
            this.__pendingValue = noChange;
            directive(this);
        }
        const value = this.__pendingValue;
        if (value === noChange) {
            return;
        }
        if (isPrimitive(value)) {
            if (value !== this.value) {
                this.__commitText(value);
            }
        }
        else if (value instanceof template_result_TemplateResult) {
            this.__commitTemplateResult(value);
        }
        else if (value instanceof Node) {
            this.__commitNode(value);
        }
        else if (isIterable(value)) {
            this.__commitIterable(value);
        }
        else if (value === nothing) {
            this.value = nothing;
            this.clear();
        }
        else {
            // Fallback, will render the string representation
            this.__commitText(value);
        }
    }
    __insert(node) {
        this.endNode.parentNode.insertBefore(node, this.endNode);
    }
    __commitNode(value) {
        if (this.value === value) {
            return;
        }
        this.clear();
        this.__insert(value);
        this.value = value;
    }
    __commitText(value) {
        const node = this.startNode.nextSibling;
        value = value == null ? '' : value;
        // If `value` isn't already a string, we explicitly convert it here in case
        // it can't be implicitly converted - i.e. it's a symbol.
        const valueAsString = typeof value === 'string' ? value : String(value);
        if (node === this.endNode.previousSibling &&
            node.nodeType === 3 /* Node.TEXT_NODE */) {
            // If we only have a single text node between the markers, we can just
            // set its value, rather than replacing it.
            // TODO(justinfagnani): Can we just check if this.value is primitive?
            node.data = valueAsString;
        }
        else {
            this.__commitNode(document.createTextNode(valueAsString));
        }
        this.value = value;
    }
    __commitTemplateResult(value) {
        const template = this.options.templateFactory(value);
        if (this.value instanceof template_instance_TemplateInstance &&
            this.value.template === template) {
            this.value.update(value.values);
        }
        else {
            // Make sure we propagate the template processor from the TemplateResult
            // so that we use its syntax extension, etc. The template factory comes
            // from the render function options so that it can control template
            // caching and preprocessing.
            const instance = new template_instance_TemplateInstance(template, value.processor, this.options);
            const fragment = instance._clone();
            instance.update(value.values);
            this.__commitNode(fragment);
            this.value = instance;
        }
    }
    __commitIterable(value) {
        // For an Iterable, we create a new InstancePart per item, then set its
        // value to the item. This is a little bit of overhead for every item in
        // an Iterable, but it lets us recurse easily and efficiently update Arrays
        // of TemplateResults that will be commonly returned from expressions like:
        // array.map((i) => html`${i}`), by reusing existing TemplateInstances.
        // If _value is an array, then the previous render was of an
        // iterable and _value will contain the NodeParts from the previous
        // render. If _value is not an array, clear this part and make a new
        // array for NodeParts.
        if (!Array.isArray(this.value)) {
            this.value = [];
            this.clear();
        }
        // Lets us keep track of how many items we stamped so we can clear leftover
        // items from a previous render
        const itemParts = this.value;
        let partIndex = 0;
        let itemPart;
        for (const item of value) {
            // Try to reuse an existing part
            itemPart = itemParts[partIndex];
            // If no existing part, create a new one
            if (itemPart === undefined) {
                itemPart = new parts_NodePart(this.options);
                itemParts.push(itemPart);
                if (partIndex === 0) {
                    itemPart.appendIntoPart(this);
                }
                else {
                    itemPart.insertAfterPart(itemParts[partIndex - 1]);
                }
            }
            itemPart.setValue(item);
            itemPart.commit();
            partIndex++;
        }
        if (partIndex < itemParts.length) {
            // Truncate the parts array so _value reflects the current state
            itemParts.length = partIndex;
            this.clear(itemPart && itemPart.endNode);
        }
    }
    clear(startNode = this.startNode) {
        removeNodes(this.startNode.parentNode, startNode.nextSibling, this.endNode);
    }
}
/**
 * Implements a boolean attribute, roughly as defined in the HTML
 * specification.
 *
 * If the value is truthy, then the attribute is present with a value of
 * ''. If the value is falsey, the attribute is removed.
 */
class parts_BooleanAttributePart {
    constructor(element, name, strings) {
        this.value = undefined;
        this.__pendingValue = undefined;
        if (strings.length !== 2 || strings[0] !== '' || strings[1] !== '') {
            throw new Error('Boolean attributes can only contain a single expression');
        }
        this.element = element;
        this.name = name;
        this.strings = strings;
    }
    setValue(value) {
        this.__pendingValue = value;
    }
    commit() {
        while (isDirective(this.__pendingValue)) {
            const directive = this.__pendingValue;
            this.__pendingValue = noChange;
            directive(this);
        }
        if (this.__pendingValue === noChange) {
            return;
        }
        const value = !!this.__pendingValue;
        if (this.value !== value) {
            if (value) {
                this.element.setAttribute(this.name, '');
            }
            else {
                this.element.removeAttribute(this.name);
            }
            this.value = value;
        }
        this.__pendingValue = noChange;
    }
}
/**
 * Sets attribute values for PropertyParts, so that the value is only set once
 * even if there are multiple parts for a property.
 *
 * If an expression controls the whole property value, then the value is simply
 * assigned to the property under control. If there are string literals or
 * multiple expressions, then the strings are expressions are interpolated into
 * a string first.
 */
class PropertyCommitter extends AttributeCommitter {
    constructor(element, name, strings) {
        super(element, name, strings);
        this.single =
            (strings.length === 2 && strings[0] === '' && strings[1] === '');
    }
    _createPart() {
        return new PropertyPart(this);
    }
    _getValue() {
        if (this.single) {
            return this.parts[0].value;
        }
        return super._getValue();
    }
    commit() {
        if (this.dirty) {
            this.dirty = false;
            // tslint:disable-next-line:no-any
            this.element[this.name] = this._getValue();
        }
    }
}
class PropertyPart extends parts_AttributePart {
}
// Detect event listener options support. If the `capture` property is read
// from the options object, then options are supported. If not, then the thrid
// argument to add/removeEventListener is interpreted as the boolean capture
// value so we should only pass the `capture` property.
let eventOptionsSupported = false;
try {
    const options = {
        get capture() {
            eventOptionsSupported = true;
            return false;
        }
    };
    // tslint:disable-next-line:no-any
    window.addEventListener('test', options, options);
    // tslint:disable-next-line:no-any
    window.removeEventListener('test', options, options);
}
catch (_e) {
}
class parts_EventPart {
    constructor(element, eventName, eventContext) {
        this.value = undefined;
        this.__pendingValue = undefined;
        this.element = element;
        this.eventName = eventName;
        this.eventContext = eventContext;
        this.__boundHandleEvent = (e) => this.handleEvent(e);
    }
    setValue(value) {
        this.__pendingValue = value;
    }
    commit() {
        while (isDirective(this.__pendingValue)) {
            const directive = this.__pendingValue;
            this.__pendingValue = noChange;
            directive(this);
        }
        if (this.__pendingValue === noChange) {
            return;
        }
        const newListener = this.__pendingValue;
        const oldListener = this.value;
        const shouldRemoveListener = newListener == null ||
            oldListener != null &&
                (newListener.capture !== oldListener.capture ||
                    newListener.once !== oldListener.once ||
                    newListener.passive !== oldListener.passive);
        const shouldAddListener = newListener != null && (oldListener == null || shouldRemoveListener);
        if (shouldRemoveListener) {
            this.element.removeEventListener(this.eventName, this.__boundHandleEvent, this.__options);
        }
        if (shouldAddListener) {
            this.__options = getOptions(newListener);
            this.element.addEventListener(this.eventName, this.__boundHandleEvent, this.__options);
        }
        this.value = newListener;
        this.__pendingValue = noChange;
    }
    handleEvent(event) {
        if (typeof this.value === 'function') {
            this.value.call(this.eventContext || this.element, event);
        }
        else {
            this.value.handleEvent(event);
        }
    }
}
// We copy options because of the inconsistent behavior of browsers when reading
// the third argument of add/removeEventListener. IE11 doesn't support options
// at all. Chrome 41 only reads `capture` if the argument is an object.
const getOptions = (o) => o &&
    (eventOptionsSupported ?
        { capture: o.capture, passive: o.passive, once: o.once } :
        o.capture);
//# sourceMappingURL=parts.js.map
// CONCATENATED MODULE: ./node_modules/lit-html/lib/default-template-processor.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */

/**
 * Creates Parts when a template is instantiated.
 */
class default_template_processor_DefaultTemplateProcessor {
    /**
     * Create parts for an attribute-position binding, given the event, attribute
     * name, and string literals.
     *
     * @param element The element containing the binding
     * @param name  The attribute name
     * @param strings The string literals. There are always at least two strings,
     *   event for fully-controlled bindings with a single expression.
     */
    handleAttributeExpressions(element, name, strings, options) {
        const prefix = name[0];
        if (prefix === '.') {
            const committer = new PropertyCommitter(element, name.slice(1), strings);
            return committer.parts;
        }
        if (prefix === '@') {
            return [new parts_EventPart(element, name.slice(1), options.eventContext)];
        }
        if (prefix === '?') {
            return [new parts_BooleanAttributePart(element, name.slice(1), strings)];
        }
        const committer = new AttributeCommitter(element, name, strings);
        return committer.parts;
    }
    /**
     * Create parts for a text-position binding.
     * @param templateFactory
     */
    handleTextExpression(options) {
        return new parts_NodePart(options);
    }
}
const defaultTemplateProcessor = new default_template_processor_DefaultTemplateProcessor();
//# sourceMappingURL=default-template-processor.js.map
// CONCATENATED MODULE: ./node_modules/lit-html/lib/template-factory.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */

/**
 * The default TemplateFactory which caches Templates keyed on
 * result.type and result.strings.
 */
function templateFactory(result) {
    let templateCache = templateCaches.get(result.type);
    if (templateCache === undefined) {
        templateCache = {
            stringsArray: new WeakMap(),
            keyString: new Map()
        };
        templateCaches.set(result.type, templateCache);
    }
    let template = templateCache.stringsArray.get(result.strings);
    if (template !== undefined) {
        return template;
    }
    // If the TemplateStringsArray is new, generate a key from the strings
    // This key is shared between all templates with identical content
    const key = result.strings.join(marker);
    // Check if we already have a Template for this key
    template = templateCache.keyString.get(key);
    if (template === undefined) {
        // If we have not seen this key before, create a new Template
        template = new Template(result, result.getTemplateElement());
        // Cache the Template for this key
        templateCache.keyString.set(key, template);
    }
    // Cache all future queries for this TemplateStringsArray
    templateCache.stringsArray.set(result.strings, template);
    return template;
}
const templateCaches = new Map();
//# sourceMappingURL=template-factory.js.map
// CONCATENATED MODULE: ./node_modules/lit-html/lib/render.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * @module lit-html
 */



const render_parts = new WeakMap();
/**
 * Renders a template result or other value to a container.
 *
 * To update a container with new values, reevaluate the template literal and
 * call `render` with the new result.
 *
 * @param result Any value renderable by NodePart - typically a TemplateResult
 *     created by evaluating a template tag like `html` or `svg`.
 * @param container A DOM parent to render to. The entire contents are either
 *     replaced, or efficiently updated if the same result type was previous
 *     rendered there.
 * @param options RenderOptions for the entire render tree rendered to this
 *     container. Render options must *not* change between renders to the same
 *     container, as those changes will not effect previously rendered DOM.
 */
const render = (result, container, options) => {
    let part = render_parts.get(container);
    if (part === undefined) {
        removeNodes(container, container.firstChild);
        render_parts.set(container, part = new parts_NodePart(Object.assign({ templateFactory: templateFactory }, options)));
        part.appendInto(container);
    }
    part.setValue(result);
    part.commit();
};
//# sourceMappingURL=render.js.map
// CONCATENATED MODULE: ./node_modules/lit-html/lit-html.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 *
 * Main lit-html module.
 *
 * Main exports:
 *
 * -  [[html]]
 * -  [[svg]]
 * -  [[render]]
 *
 * @module lit-html
 * @preferred
 */
/**
 * Do not remove this comment; it keeps typedoc from misplacing the module
 * docs.
 */




// TODO(justinfagnani): remove line when we get NodePart moving methods








// IMPORTANT: do not change the property name or the assignment expression.
// This line will be used in regexes to search for lit-html usage.
// TODO(justinfagnani): inject version number at build time
(window['litHtmlVersions'] || (window['litHtmlVersions'] = [])).push('1.1.2');
/**
 * Interprets a template literal as an HTML template that can efficiently
 * render to and update a container.
 */
const lit_html_html = (strings, ...values) => new template_result_TemplateResult(strings, values, 'html', defaultTemplateProcessor);
/**
 * Interprets a template literal as an SVG template that can efficiently
 * render to and update a container.
 */
const lit_html_svg = (strings, ...values) => new template_result_SVGTemplateResult(strings, values, 'svg', defaultTemplateProcessor);
//# sourceMappingURL=lit-html.js.map
// CONCATENATED MODULE: ./node_modules/lit-html/lib/modify-template.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * @module shady-render
 */

const walkerNodeFilter = 133 /* NodeFilter.SHOW_{ELEMENT|COMMENT|TEXT} */;
/**
 * Removes the list of nodes from a Template safely. In addition to removing
 * nodes from the Template, the Template part indices are updated to match
 * the mutated Template DOM.
 *
 * As the template is walked the removal state is tracked and
 * part indices are adjusted as needed.
 *
 * div
 *   div#1 (remove) <-- start removing (removing node is div#1)
 *     div
 *       div#2 (remove)  <-- continue removing (removing node is still div#1)
 *         div
 * div <-- stop removing since previous sibling is the removing node (div#1,
 * removed 4 nodes)
 */
function removeNodesFromTemplate(template, nodesToRemove) {
    const { element: { content }, parts } = template;
    const walker = document.createTreeWalker(content, walkerNodeFilter, null, false);
    let partIndex = nextActiveIndexInTemplateParts(parts);
    let part = parts[partIndex];
    let nodeIndex = -1;
    let removeCount = 0;
    const nodesToRemoveInTemplate = [];
    let currentRemovingNode = null;
    while (walker.nextNode()) {
        nodeIndex++;
        const node = walker.currentNode;
        // End removal if stepped past the removing node
        if (node.previousSibling === currentRemovingNode) {
            currentRemovingNode = null;
        }
        // A node to remove was found in the template
        if (nodesToRemove.has(node)) {
            nodesToRemoveInTemplate.push(node);
            // Track node we're removing
            if (currentRemovingNode === null) {
                currentRemovingNode = node;
            }
        }
        // When removing, increment count by which to adjust subsequent part indices
        if (currentRemovingNode !== null) {
            removeCount++;
        }
        while (part !== undefined && part.index === nodeIndex) {
            // If part is in a removed node deactivate it by setting index to -1 or
            // adjust the index as needed.
            part.index = currentRemovingNode !== null ? -1 : part.index - removeCount;
            // go to the next active part.
            partIndex = nextActiveIndexInTemplateParts(parts, partIndex);
            part = parts[partIndex];
        }
    }
    nodesToRemoveInTemplate.forEach((n) => n.parentNode.removeChild(n));
}
const countNodes = (node) => {
    let count = (node.nodeType === 11 /* Node.DOCUMENT_FRAGMENT_NODE */) ? 0 : 1;
    const walker = document.createTreeWalker(node, walkerNodeFilter, null, false);
    while (walker.nextNode()) {
        count++;
    }
    return count;
};
const nextActiveIndexInTemplateParts = (parts, startIndex = -1) => {
    for (let i = startIndex + 1; i < parts.length; i++) {
        const part = parts[i];
        if (isTemplatePartActive(part)) {
            return i;
        }
    }
    return -1;
};
/**
 * Inserts the given node into the Template, optionally before the given
 * refNode. In addition to inserting the node into the Template, the Template
 * part indices are updated to match the mutated Template DOM.
 */
function insertNodeIntoTemplate(template, node, refNode = null) {
    const { element: { content }, parts } = template;
    // If there's no refNode, then put node at end of template.
    // No part indices need to be shifted in this case.
    if (refNode === null || refNode === undefined) {
        content.appendChild(node);
        return;
    }
    const walker = document.createTreeWalker(content, walkerNodeFilter, null, false);
    let partIndex = nextActiveIndexInTemplateParts(parts);
    let insertCount = 0;
    let walkerIndex = -1;
    while (walker.nextNode()) {
        walkerIndex++;
        const walkerNode = walker.currentNode;
        if (walkerNode === refNode) {
            insertCount = countNodes(node);
            refNode.parentNode.insertBefore(node, refNode);
        }
        while (partIndex !== -1 && parts[partIndex].index === walkerIndex) {
            // If we've inserted the node, simply adjust all subsequent parts
            if (insertCount > 0) {
                while (partIndex !== -1) {
                    parts[partIndex].index += insertCount;
                    partIndex = nextActiveIndexInTemplateParts(parts, partIndex);
                }
                return;
            }
            partIndex = nextActiveIndexInTemplateParts(parts, partIndex);
        }
    }
}
//# sourceMappingURL=modify-template.js.map
// CONCATENATED MODULE: ./node_modules/lit-html/lib/shady-render.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * Module to add shady DOM/shady CSS polyfill support to lit-html template
 * rendering. See the [[render]] method for details.
 *
 * @module shady-render
 * @preferred
 */
/**
 * Do not remove this comment; it keeps typedoc from misplacing the module
 * docs.
 */







// Get a key to lookup in `templateCaches`.
const getTemplateCacheKey = (type, scopeName) => `${type}--${scopeName}`;
let compatibleShadyCSSVersion = true;
if (typeof window.ShadyCSS === 'undefined') {
    compatibleShadyCSSVersion = false;
}
else if (typeof window.ShadyCSS.prepareTemplateDom === 'undefined') {
    console.warn(`Incompatible ShadyCSS version detected. ` +
        `Please update to at least @webcomponents/webcomponentsjs@2.0.2 and ` +
        `@webcomponents/shadycss@1.3.1.`);
    compatibleShadyCSSVersion = false;
}
/**
 * Template factory which scopes template DOM using ShadyCSS.
 * @param scopeName {string}
 */
const shadyTemplateFactory = (scopeName) => (result) => {
    const cacheKey = getTemplateCacheKey(result.type, scopeName);
    let templateCache = templateCaches.get(cacheKey);
    if (templateCache === undefined) {
        templateCache = {
            stringsArray: new WeakMap(),
            keyString: new Map()
        };
        templateCaches.set(cacheKey, templateCache);
    }
    let template = templateCache.stringsArray.get(result.strings);
    if (template !== undefined) {
        return template;
    }
    const key = result.strings.join(marker);
    template = templateCache.keyString.get(key);
    if (template === undefined) {
        const element = result.getTemplateElement();
        if (compatibleShadyCSSVersion) {
            window.ShadyCSS.prepareTemplateDom(element, scopeName);
        }
        template = new Template(result, element);
        templateCache.keyString.set(key, template);
    }
    templateCache.stringsArray.set(result.strings, template);
    return template;
};
const TEMPLATE_TYPES = ['html', 'svg'];
/**
 * Removes all style elements from Templates for the given scopeName.
 */
const removeStylesFromLitTemplates = (scopeName) => {
    TEMPLATE_TYPES.forEach((type) => {
        const templates = templateCaches.get(getTemplateCacheKey(type, scopeName));
        if (templates !== undefined) {
            templates.keyString.forEach((template) => {
                const { element: { content } } = template;
                // IE 11 doesn't support the iterable param Set constructor
                const styles = new Set();
                Array.from(content.querySelectorAll('style')).forEach((s) => {
                    styles.add(s);
                });
                removeNodesFromTemplate(template, styles);
            });
        }
    });
};
const shadyRenderSet = new Set();
/**
 * For the given scope name, ensures that ShadyCSS style scoping is performed.
 * This is done just once per scope name so the fragment and template cannot
 * be modified.
 * (1) extracts styles from the rendered fragment and hands them to ShadyCSS
 * to be scoped and appended to the document
 * (2) removes style elements from all lit-html Templates for this scope name.
 *
 * Note, <style> elements can only be placed into templates for the
 * initial rendering of the scope. If <style> elements are included in templates
 * dynamically rendered to the scope (after the first scope render), they will
 * not be scoped and the <style> will be left in the template and rendered
 * output.
 */
const prepareTemplateStyles = (scopeName, renderedDOM, template) => {
    shadyRenderSet.add(scopeName);
    // If `renderedDOM` is stamped from a Template, then we need to edit that
    // Template's underlying template element. Otherwise, we create one here
    // to give to ShadyCSS, which still requires one while scoping.
    const templateElement = !!template ? template.element : document.createElement('template');
    // Move styles out of rendered DOM and store.
    const styles = renderedDOM.querySelectorAll('style');
    const { length } = styles;
    // If there are no styles, skip unnecessary work
    if (length === 0) {
        // Ensure prepareTemplateStyles is called to support adding
        // styles via `prepareAdoptedCssText` since that requires that
        // `prepareTemplateStyles` is called.
        //
        // ShadyCSS will only update styles containing @apply in the template
        // given to `prepareTemplateStyles`. If no lit Template was given,
        // ShadyCSS will not be able to update uses of @apply in any relevant
        // template. However, this is not a problem because we only create the
        // template for the purpose of supporting `prepareAdoptedCssText`,
        // which doesn't support @apply at all.
        window.ShadyCSS.prepareTemplateStyles(templateElement, scopeName);
        return;
    }
    const condensedStyle = document.createElement('style');
    // Collect styles into a single style. This helps us make sure ShadyCSS
    // manipulations will not prevent us from being able to fix up template
    // part indices.
    // NOTE: collecting styles is inefficient for browsers but ShadyCSS
    // currently does this anyway. When it does not, this should be changed.
    for (let i = 0; i < length; i++) {
        const style = styles[i];
        style.parentNode.removeChild(style);
        condensedStyle.textContent += style.textContent;
    }
    // Remove styles from nested templates in this scope.
    removeStylesFromLitTemplates(scopeName);
    // And then put the condensed style into the "root" template passed in as
    // `template`.
    const content = templateElement.content;
    if (!!template) {
        insertNodeIntoTemplate(template, condensedStyle, content.firstChild);
    }
    else {
        content.insertBefore(condensedStyle, content.firstChild);
    }
    // Note, it's important that ShadyCSS gets the template that `lit-html`
    // will actually render so that it can update the style inside when
    // needed (e.g. @apply native Shadow DOM case).
    window.ShadyCSS.prepareTemplateStyles(templateElement, scopeName);
    const style = content.querySelector('style');
    if (window.ShadyCSS.nativeShadow && style !== null) {
        // When in native Shadow DOM, ensure the style created by ShadyCSS is
        // included in initially rendered output (`renderedDOM`).
        renderedDOM.insertBefore(style.cloneNode(true), renderedDOM.firstChild);
    }
    else if (!!template) {
        // When no style is left in the template, parts will be broken as a
        // result. To fix this, we put back the style node ShadyCSS removed
        // and then tell lit to remove that node from the template.
        // There can be no style in the template in 2 cases (1) when Shady DOM
        // is in use, ShadyCSS removes all styles, (2) when native Shadow DOM
        // is in use ShadyCSS removes the style if it contains no content.
        // NOTE, ShadyCSS creates its own style so we can safely add/remove
        // `condensedStyle` here.
        content.insertBefore(condensedStyle, content.firstChild);
        const removes = new Set();
        removes.add(condensedStyle);
        removeNodesFromTemplate(template, removes);
    }
};
/**
 * Extension to the standard `render` method which supports rendering
 * to ShadowRoots when the ShadyDOM (https://github.com/webcomponents/shadydom)
 * and ShadyCSS (https://github.com/webcomponents/shadycss) polyfills are used
 * or when the webcomponentsjs
 * (https://github.com/webcomponents/webcomponentsjs) polyfill is used.
 *
 * Adds a `scopeName` option which is used to scope element DOM and stylesheets
 * when native ShadowDOM is unavailable. The `scopeName` will be added to
 * the class attribute of all rendered DOM. In addition, any style elements will
 * be automatically re-written with this `scopeName` selector and moved out
 * of the rendered DOM and into the document `<head>`.
 *
 * It is common to use this render method in conjunction with a custom element
 * which renders a shadowRoot. When this is done, typically the element's
 * `localName` should be used as the `scopeName`.
 *
 * In addition to DOM scoping, ShadyCSS also supports a basic shim for css
 * custom properties (needed only on older browsers like IE11) and a shim for
 * a deprecated feature called `@apply` that supports applying a set of css
 * custom properties to a given location.
 *
 * Usage considerations:
 *
 * * Part values in `<style>` elements are only applied the first time a given
 * `scopeName` renders. Subsequent changes to parts in style elements will have
 * no effect. Because of this, parts in style elements should only be used for
 * values that will never change, for example parts that set scope-wide theme
 * values or parts which render shared style elements.
 *
 * * Note, due to a limitation of the ShadyDOM polyfill, rendering in a
 * custom element's `constructor` is not supported. Instead rendering should
 * either done asynchronously, for example at microtask timing (for example
 * `Promise.resolve()`), or be deferred until the first time the element's
 * `connectedCallback` runs.
 *
 * Usage considerations when using shimmed custom properties or `@apply`:
 *
 * * Whenever any dynamic changes are made which affect
 * css custom properties, `ShadyCSS.styleElement(element)` must be called
 * to update the element. There are two cases when this is needed:
 * (1) the element is connected to a new parent, (2) a class is added to the
 * element that causes it to match different custom properties.
 * To address the first case when rendering a custom element, `styleElement`
 * should be called in the element's `connectedCallback`.
 *
 * * Shimmed custom properties may only be defined either for an entire
 * shadowRoot (for example, in a `:host` rule) or via a rule that directly
 * matches an element with a shadowRoot. In other words, instead of flowing from
 * parent to child as do native css custom properties, shimmed custom properties
 * flow only from shadowRoots to nested shadowRoots.
 *
 * * When using `@apply` mixing css shorthand property names with
 * non-shorthand names (for example `border` and `border-width`) is not
 * supported.
 */
const shady_render_render = (result, container, options) => {
    if (!options || typeof options !== 'object' || !options.scopeName) {
        throw new Error('The `scopeName` option is required.');
    }
    const scopeName = options.scopeName;
    const hasRendered = render_parts.has(container);
    const needsScoping = compatibleShadyCSSVersion &&
        container.nodeType === 11 /* Node.DOCUMENT_FRAGMENT_NODE */ &&
        !!container.host;
    // Handle first render to a scope specially...
    const firstScopeRender = needsScoping && !shadyRenderSet.has(scopeName);
    // On first scope render, render into a fragment; this cannot be a single
    // fragment that is reused since nested renders can occur synchronously.
    const renderContainer = firstScopeRender ? document.createDocumentFragment() : container;
    render(result, renderContainer, Object.assign({ templateFactory: shadyTemplateFactory(scopeName) }, options));
    // When performing first scope render,
    // (1) We've rendered into a fragment so that there's a chance to
    // `prepareTemplateStyles` before sub-elements hit the DOM
    // (which might cause them to render based on a common pattern of
    // rendering in a custom element's `connectedCallback`);
    // (2) Scope the template with ShadyCSS one time only for this scope.
    // (3) Render the fragment into the container and make sure the
    // container knows its `part` is the one we just rendered. This ensures
    // DOM will be re-used on subsequent renders.
    if (firstScopeRender) {
        const part = render_parts.get(renderContainer);
        render_parts.delete(renderContainer);
        // ShadyCSS might have style sheets (e.g. from `prepareAdoptedCssText`)
        // that should apply to `renderContainer` even if the rendered value is
        // not a TemplateInstance. However, it will only insert scoped styles
        // into the document if `prepareTemplateStyles` has already been called
        // for the given scope name.
        const template = part.value instanceof template_instance_TemplateInstance ?
            part.value.template :
            undefined;
        prepareTemplateStyles(scopeName, renderContainer, template);
        removeNodes(container, container.firstChild);
        container.appendChild(renderContainer);
        render_parts.set(container, part);
    }
    // After elements have hit the DOM, update styling if this is the
    // initial render to this container.
    // This is needed whenever dynamic changes are made so it would be
    // safest to do every render; however, this would regress performance
    // so we leave it up to the user to call `ShadyCSS.styleElement`
    // for dynamic changes.
    if (!hasRendered && needsScoping) {
        window.ShadyCSS.styleElement(container.host);
    }
};
//# sourceMappingURL=shady-render.js.map
// CONCATENATED MODULE: ./node_modules/lit-element/lib/updating-element.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
var _a;
/**
 * When using Closure Compiler, JSCompiler_renameProperty(property, object) is
 * replaced at compile time by the munged name for object[property]. We cannot
 * alias this function, so we have to use a small shim that has the same
 * behavior when not compiling.
 */
window.JSCompiler_renameProperty =
    (prop, _obj) => prop;
const defaultConverter = {
    toAttribute(value, type) {
        switch (type) {
            case Boolean:
                return value ? '' : null;
            case Object:
            case Array:
                // if the value is `null` or `undefined` pass this through
                // to allow removing/no change behavior.
                return value == null ? value : JSON.stringify(value);
        }
        return value;
    },
    fromAttribute(value, type) {
        switch (type) {
            case Boolean:
                return value !== null;
            case Number:
                return value === null ? null : Number(value);
            case Object:
            case Array:
                return JSON.parse(value);
        }
        return value;
    }
};
/**
 * Change function that returns true if `value` is different from `oldValue`.
 * This method is used as the default for a property's `hasChanged` function.
 */
const notEqual = (value, old) => {
    // This ensures (old==NaN, value==NaN) always returns false
    return old !== value && (old === old || value === value);
};
const defaultPropertyDeclaration = {
    attribute: true,
    type: String,
    converter: defaultConverter,
    reflect: false,
    hasChanged: notEqual
};
const microtaskPromise = Promise.resolve(true);
const STATE_HAS_UPDATED = 1;
const STATE_UPDATE_REQUESTED = 1 << 2;
const STATE_IS_REFLECTING_TO_ATTRIBUTE = 1 << 3;
const STATE_IS_REFLECTING_TO_PROPERTY = 1 << 4;
const STATE_HAS_CONNECTED = 1 << 5;
/**
 * The Closure JS Compiler doesn't currently have good support for static
 * property semantics where "this" is dynamic (e.g.
 * https://github.com/google/closure-compiler/issues/3177 and others) so we use
 * this hack to bypass any rewriting by the compiler.
 */
const finalized = 'finalized';
/**
 * Base element class which manages element properties and attributes. When
 * properties change, the `update` method is asynchronously called. This method
 * should be supplied by subclassers to render updates as desired.
 */
class UpdatingElement extends HTMLElement {
    constructor() {
        super();
        this._updateState = 0;
        this._instanceProperties = undefined;
        this._updatePromise = microtaskPromise;
        this._hasConnectedResolver = undefined;
        /**
         * Map with keys for any properties that have changed since the last
         * update cycle with previous values.
         */
        this._changedProperties = new Map();
        /**
         * Map with keys of properties that should be reflected when updated.
         */
        this._reflectingProperties = undefined;
        this.initialize();
    }
    /**
     * Returns a list of attributes corresponding to the registered properties.
     * @nocollapse
     */
    static get observedAttributes() {
        // note: piggy backing on this to ensure we're finalized.
        this.finalize();
        const attributes = [];
        // Use forEach so this works even if for/of loops are compiled to for loops
        // expecting arrays
        this._classProperties.forEach((v, p) => {
            const attr = this._attributeNameForProperty(p, v);
            if (attr !== undefined) {
                this._attributeToPropertyMap.set(attr, p);
                attributes.push(attr);
            }
        });
        return attributes;
    }
    /**
     * Ensures the private `_classProperties` property metadata is created.
     * In addition to `finalize` this is also called in `createProperty` to
     * ensure the `@property` decorator can add property metadata.
     */
    /** @nocollapse */
    static _ensureClassProperties() {
        // ensure private storage for property declarations.
        if (!this.hasOwnProperty(JSCompiler_renameProperty('_classProperties', this))) {
            this._classProperties = new Map();
            // NOTE: Workaround IE11 not supporting Map constructor argument.
            const superProperties = Object.getPrototypeOf(this)._classProperties;
            if (superProperties !== undefined) {
                superProperties.forEach((v, k) => this._classProperties.set(k, v));
            }
        }
    }
    /**
     * Creates a property accessor on the element prototype if one does not exist.
     * The property setter calls the property's `hasChanged` property option
     * or uses a strict identity check to determine whether or not to request
     * an update.
     * @nocollapse
     */
    static createProperty(name, options = defaultPropertyDeclaration) {
        // Note, since this can be called by the `@property` decorator which
        // is called before `finalize`, we ensure storage exists for property
        // metadata.
        this._ensureClassProperties();
        this._classProperties.set(name, options);
        // Do not generate an accessor if the prototype already has one, since
        // it would be lost otherwise and that would never be the user's intention;
        // Instead, we expect users to call `requestUpdate` themselves from
        // user-defined accessors. Note that if the super has an accessor we will
        // still overwrite it
        if (options.noAccessor || this.prototype.hasOwnProperty(name)) {
            return;
        }
        const key = typeof name === 'symbol' ? Symbol() : `__${name}`;
        Object.defineProperty(this.prototype, name, {
            // tslint:disable-next-line:no-any no symbol in index
            get() {
                return this[key];
            },
            set(value) {
                const oldValue = this[name];
                this[key] = value;
                this._requestUpdate(name, oldValue);
            },
            configurable: true,
            enumerable: true
        });
    }
    /**
     * Creates property accessors for registered properties and ensures
     * any superclasses are also finalized.
     * @nocollapse
     */
    static finalize() {
        // finalize any superclasses
        const superCtor = Object.getPrototypeOf(this);
        if (!superCtor.hasOwnProperty(finalized)) {
            superCtor.finalize();
        }
        this[finalized] = true;
        this._ensureClassProperties();
        // initialize Map populated in observedAttributes
        this._attributeToPropertyMap = new Map();
        // make any properties
        // Note, only process "own" properties since this element will inherit
        // any properties defined on the superClass, and finalization ensures
        // the entire prototype chain is finalized.
        if (this.hasOwnProperty(JSCompiler_renameProperty('properties', this))) {
            const props = this.properties;
            // support symbols in properties (IE11 does not support this)
            const propKeys = [
                ...Object.getOwnPropertyNames(props),
                ...(typeof Object.getOwnPropertySymbols === 'function') ?
                    Object.getOwnPropertySymbols(props) :
                    []
            ];
            // This for/of is ok because propKeys is an array
            for (const p of propKeys) {
                // note, use of `any` is due to TypeSript lack of support for symbol in
                // index types
                // tslint:disable-next-line:no-any no symbol in index
                this.createProperty(p, props[p]);
            }
        }
    }
    /**
     * Returns the property name for the given attribute `name`.
     * @nocollapse
     */
    static _attributeNameForProperty(name, options) {
        const attribute = options.attribute;
        return attribute === false ?
            undefined :
            (typeof attribute === 'string' ?
                attribute :
                (typeof name === 'string' ? name.toLowerCase() : undefined));
    }
    /**
     * Returns true if a property should request an update.
     * Called when a property value is set and uses the `hasChanged`
     * option for the property if present or a strict identity check.
     * @nocollapse
     */
    static _valueHasChanged(value, old, hasChanged = notEqual) {
        return hasChanged(value, old);
    }
    /**
     * Returns the property value for the given attribute value.
     * Called via the `attributeChangedCallback` and uses the property's
     * `converter` or `converter.fromAttribute` property option.
     * @nocollapse
     */
    static _propertyValueFromAttribute(value, options) {
        const type = options.type;
        const converter = options.converter || defaultConverter;
        const fromAttribute = (typeof converter === 'function' ? converter : converter.fromAttribute);
        return fromAttribute ? fromAttribute(value, type) : value;
    }
    /**
     * Returns the attribute value for the given property value. If this
     * returns undefined, the property will *not* be reflected to an attribute.
     * If this returns null, the attribute will be removed, otherwise the
     * attribute will be set to the value.
     * This uses the property's `reflect` and `type.toAttribute` property options.
     * @nocollapse
     */
    static _propertyValueToAttribute(value, options) {
        if (options.reflect === undefined) {
            return;
        }
        const type = options.type;
        const converter = options.converter;
        const toAttribute = converter && converter.toAttribute ||
            defaultConverter.toAttribute;
        return toAttribute(value, type);
    }
    /**
     * Performs element initialization. By default captures any pre-set values for
     * registered properties.
     */
    initialize() {
        this._saveInstanceProperties();
        // ensures first update will be caught by an early access of
        // `updateComplete`
        this._requestUpdate();
    }
    /**
     * Fixes any properties set on the instance before upgrade time.
     * Otherwise these would shadow the accessor and break these properties.
     * The properties are stored in a Map which is played back after the
     * constructor runs. Note, on very old versions of Safari (<=9) or Chrome
     * (<=41), properties created for native platform properties like (`id` or
     * `name`) may not have default values set in the element constructor. On
     * these browsers native properties appear on instances and therefore their
     * default value will overwrite any element default (e.g. if the element sets
     * this.id = 'id' in the constructor, the 'id' will become '' since this is
     * the native platform default).
     */
    _saveInstanceProperties() {
        // Use forEach so this works even if for/of loops are compiled to for loops
        // expecting arrays
        this.constructor
            ._classProperties.forEach((_v, p) => {
            if (this.hasOwnProperty(p)) {
                const value = this[p];
                delete this[p];
                if (!this._instanceProperties) {
                    this._instanceProperties = new Map();
                }
                this._instanceProperties.set(p, value);
            }
        });
    }
    /**
     * Applies previously saved instance properties.
     */
    _applyInstanceProperties() {
        // Use forEach so this works even if for/of loops are compiled to for loops
        // expecting arrays
        // tslint:disable-next-line:no-any
        this._instanceProperties.forEach((v, p) => this[p] = v);
        this._instanceProperties = undefined;
    }
    connectedCallback() {
        this._updateState = this._updateState | STATE_HAS_CONNECTED;
        // Ensure first connection completes an update. Updates cannot complete
        // before connection and if one is pending connection the
        // `_hasConnectionResolver` will exist. If so, resolve it to complete the
        // update, otherwise requestUpdate.
        if (this._hasConnectedResolver) {
            this._hasConnectedResolver();
            this._hasConnectedResolver = undefined;
        }
    }
    /**
     * Allows for `super.disconnectedCallback()` in extensions while
     * reserving the possibility of making non-breaking feature additions
     * when disconnecting at some point in the future.
     */
    disconnectedCallback() {
    }
    /**
     * Synchronizes property values when attributes change.
     */
    attributeChangedCallback(name, old, value) {
        if (old !== value) {
            this._attributeToProperty(name, value);
        }
    }
    _propertyToAttribute(name, value, options = defaultPropertyDeclaration) {
        const ctor = this.constructor;
        const attr = ctor._attributeNameForProperty(name, options);
        if (attr !== undefined) {
            const attrValue = ctor._propertyValueToAttribute(value, options);
            // an undefined value does not change the attribute.
            if (attrValue === undefined) {
                return;
            }
            // Track if the property is being reflected to avoid
            // setting the property again via `attributeChangedCallback`. Note:
            // 1. this takes advantage of the fact that the callback is synchronous.
            // 2. will behave incorrectly if multiple attributes are in the reaction
            // stack at time of calling. However, since we process attributes
            // in `update` this should not be possible (or an extreme corner case
            // that we'd like to discover).
            // mark state reflecting
            this._updateState = this._updateState | STATE_IS_REFLECTING_TO_ATTRIBUTE;
            if (attrValue == null) {
                this.removeAttribute(attr);
            }
            else {
                this.setAttribute(attr, attrValue);
            }
            // mark state not reflecting
            this._updateState = this._updateState & ~STATE_IS_REFLECTING_TO_ATTRIBUTE;
        }
    }
    _attributeToProperty(name, value) {
        // Use tracking info to avoid deserializing attribute value if it was
        // just set from a property setter.
        if (this._updateState & STATE_IS_REFLECTING_TO_ATTRIBUTE) {
            return;
        }
        const ctor = this.constructor;
        const propName = ctor._attributeToPropertyMap.get(name);
        if (propName !== undefined) {
            const options = ctor._classProperties.get(propName) || defaultPropertyDeclaration;
            // mark state reflecting
            this._updateState = this._updateState | STATE_IS_REFLECTING_TO_PROPERTY;
            this[propName] =
                // tslint:disable-next-line:no-any
                ctor._propertyValueFromAttribute(value, options);
            // mark state not reflecting
            this._updateState = this._updateState & ~STATE_IS_REFLECTING_TO_PROPERTY;
        }
    }
    /**
     * This private version of `requestUpdate` does not access or return the
     * `updateComplete` promise. This promise can be overridden and is therefore
     * not free to access.
     */
    _requestUpdate(name, oldValue) {
        let shouldRequestUpdate = true;
        // If we have a property key, perform property update steps.
        if (name !== undefined) {
            const ctor = this.constructor;
            const options = ctor._classProperties.get(name) || defaultPropertyDeclaration;
            if (ctor._valueHasChanged(this[name], oldValue, options.hasChanged)) {
                if (!this._changedProperties.has(name)) {
                    this._changedProperties.set(name, oldValue);
                }
                // Add to reflecting properties set.
                // Note, it's important that every change has a chance to add the
                // property to `_reflectingProperties`. This ensures setting
                // attribute + property reflects correctly.
                if (options.reflect === true &&
                    !(this._updateState & STATE_IS_REFLECTING_TO_PROPERTY)) {
                    if (this._reflectingProperties === undefined) {
                        this._reflectingProperties = new Map();
                    }
                    this._reflectingProperties.set(name, options);
                }
            }
            else {
                // Abort the request if the property should not be considered changed.
                shouldRequestUpdate = false;
            }
        }
        if (!this._hasRequestedUpdate && shouldRequestUpdate) {
            this._enqueueUpdate();
        }
    }
    /**
     * Requests an update which is processed asynchronously. This should
     * be called when an element should update based on some state not triggered
     * by setting a property. In this case, pass no arguments. It should also be
     * called when manually implementing a property setter. In this case, pass the
     * property `name` and `oldValue` to ensure that any configured property
     * options are honored. Returns the `updateComplete` Promise which is resolved
     * when the update completes.
     *
     * @param name {PropertyKey} (optional) name of requesting property
     * @param oldValue {any} (optional) old value of requesting property
     * @returns {Promise} A Promise that is resolved when the update completes.
     */
    requestUpdate(name, oldValue) {
        this._requestUpdate(name, oldValue);
        return this.updateComplete;
    }
    /**
     * Sets up the element to asynchronously update.
     */
    async _enqueueUpdate() {
        // Mark state updating...
        this._updateState = this._updateState | STATE_UPDATE_REQUESTED;
        let resolve;
        let reject;
        const previousUpdatePromise = this._updatePromise;
        this._updatePromise = new Promise((res, rej) => {
            resolve = res;
            reject = rej;
        });
        try {
            // Ensure any previous update has resolved before updating.
            // This `await` also ensures that property changes are batched.
            await previousUpdatePromise;
        }
        catch (e) {
            // Ignore any previous errors. We only care that the previous cycle is
            // done. Any error should have been handled in the previous update.
        }
        // Make sure the element has connected before updating.
        if (!this._hasConnected) {
            await new Promise((res) => this._hasConnectedResolver = res);
        }
        try {
            const result = this.performUpdate();
            // If `performUpdate` returns a Promise, we await it. This is done to
            // enable coordinating updates with a scheduler. Note, the result is
            // checked to avoid delaying an additional microtask unless we need to.
            if (result != null) {
                await result;
            }
        }
        catch (e) {
            reject(e);
        }
        resolve(!this._hasRequestedUpdate);
    }
    get _hasConnected() {
        return (this._updateState & STATE_HAS_CONNECTED);
    }
    get _hasRequestedUpdate() {
        return (this._updateState & STATE_UPDATE_REQUESTED);
    }
    get hasUpdated() {
        return (this._updateState & STATE_HAS_UPDATED);
    }
    /**
     * Performs an element update. Note, if an exception is thrown during the
     * update, `firstUpdated` and `updated` will not be called.
     *
     * You can override this method to change the timing of updates. If this
     * method is overridden, `super.performUpdate()` must be called.
     *
     * For instance, to schedule updates to occur just before the next frame:
     *
     * ```
     * protected async performUpdate(): Promise<unknown> {
     *   await new Promise((resolve) => requestAnimationFrame(() => resolve()));
     *   super.performUpdate();
     * }
     * ```
     */
    performUpdate() {
        // Mixin instance properties once, if they exist.
        if (this._instanceProperties) {
            this._applyInstanceProperties();
        }
        let shouldUpdate = false;
        const changedProperties = this._changedProperties;
        try {
            shouldUpdate = this.shouldUpdate(changedProperties);
            if (shouldUpdate) {
                this.update(changedProperties);
            }
        }
        catch (e) {
            // Prevent `firstUpdated` and `updated` from running when there's an
            // update exception.
            shouldUpdate = false;
            throw e;
        }
        finally {
            // Ensure element can accept additional updates after an exception.
            this._markUpdated();
        }
        if (shouldUpdate) {
            if (!(this._updateState & STATE_HAS_UPDATED)) {
                this._updateState = this._updateState | STATE_HAS_UPDATED;
                this.firstUpdated(changedProperties);
            }
            this.updated(changedProperties);
        }
    }
    _markUpdated() {
        this._changedProperties = new Map();
        this._updateState = this._updateState & ~STATE_UPDATE_REQUESTED;
    }
    /**
     * Returns a Promise that resolves when the element has completed updating.
     * The Promise value is a boolean that is `true` if the element completed the
     * update without triggering another update. The Promise result is `false` if
     * a property was set inside `updated()`. If the Promise is rejected, an
     * exception was thrown during the update.
     *
     * To await additional asynchronous work, override the `_getUpdateComplete`
     * method. For example, it is sometimes useful to await a rendered element
     * before fulfilling this Promise. To do this, first await
     * `super._getUpdateComplete()`, then any subsequent state.
     *
     * @returns {Promise} The Promise returns a boolean that indicates if the
     * update resolved without triggering another update.
     */
    get updateComplete() {
        return this._getUpdateComplete();
    }
    /**
     * Override point for the `updateComplete` promise.
     *
     * It is not safe to override the `updateComplete` getter directly due to a
     * limitation in TypeScript which means it is not possible to call a
     * superclass getter (e.g. `super.updateComplete.then(...)`) when the target
     * language is ES5 (https://github.com/microsoft/TypeScript/issues/338).
     * This method should be overridden instead. For example:
     *
     *   class MyElement extends LitElement {
     *     async _getUpdateComplete() {
     *       await super._getUpdateComplete();
     *       await this._myChild.updateComplete;
     *     }
     *   }
     */
    _getUpdateComplete() {
        return this._updatePromise;
    }
    /**
     * Controls whether or not `update` should be called when the element requests
     * an update. By default, this method always returns `true`, but this can be
     * customized to control when to update.
     *
     * * @param _changedProperties Map of changed properties with old values
     */
    shouldUpdate(_changedProperties) {
        return true;
    }
    /**
     * Updates the element. This method reflects property values to attributes.
     * It can be overridden to render and keep updated element DOM.
     * Setting properties inside this method will *not* trigger
     * another update.
     *
     * * @param _changedProperties Map of changed properties with old values
     */
    update(_changedProperties) {
        if (this._reflectingProperties !== undefined &&
            this._reflectingProperties.size > 0) {
            // Use forEach so this works even if for/of loops are compiled to for
            // loops expecting arrays
            this._reflectingProperties.forEach((v, k) => this._propertyToAttribute(k, this[k], v));
            this._reflectingProperties = undefined;
        }
    }
    /**
     * Invoked whenever the element is updated. Implement to perform
     * post-updating tasks via DOM APIs, for example, focusing an element.
     *
     * Setting properties inside this method will trigger the element to update
     * again after this update cycle completes.
     *
     * * @param _changedProperties Map of changed properties with old values
     */
    updated(_changedProperties) {
    }
    /**
     * Invoked when the element is first updated. Implement to perform one time
     * work on the element after update.
     *
     * Setting properties inside this method will trigger the element to update
     * again after this update cycle completes.
     *
     * * @param _changedProperties Map of changed properties with old values
     */
    firstUpdated(_changedProperties) {
    }
}
_a = finalized;
/**
 * Marks class as having finished creating properties.
 */
UpdatingElement[_a] = true;
//# sourceMappingURL=updating-element.js.map
// CONCATENATED MODULE: ./node_modules/lit-element/lib/decorators.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const legacyCustomElement = (tagName, clazz) => {
    window.customElements.define(tagName, clazz);
    // Cast as any because TS doesn't recognize the return type as being a
    // subtype of the decorated class when clazz is typed as
    // `Constructor<HTMLElement>` for some reason.
    // `Constructor<HTMLElement>` is helpful to make sure the decorator is
    // applied to elements however.
    // tslint:disable-next-line:no-any
    return clazz;
};
const standardCustomElement = (tagName, descriptor) => {
    const { kind, elements } = descriptor;
    return {
        kind,
        elements,
        // This callback is called once the class is otherwise fully defined
        finisher(clazz) {
            window.customElements.define(tagName, clazz);
        }
    };
};
/**
 * Class decorator factory that defines the decorated class as a custom element.
 *
 * @param tagName the name of the custom element to define
 */
const customElement = (tagName) => (classOrDescriptor) => (typeof classOrDescriptor === 'function') ?
    legacyCustomElement(tagName, classOrDescriptor) :
    standardCustomElement(tagName, classOrDescriptor);
const standardProperty = (options, element) => {
    // When decorating an accessor, pass it through and add property metadata.
    // Note, the `hasOwnProperty` check in `createProperty` ensures we don't
    // stomp over the user's accessor.
    if (element.kind === 'method' && element.descriptor &&
        !('value' in element.descriptor)) {
        return Object.assign({}, element, { finisher(clazz) {
                clazz.createProperty(element.key, options);
            } });
    }
    else {
        // createProperty() takes care of defining the property, but we still
        // must return some kind of descriptor, so return a descriptor for an
        // unused prototype field. The finisher calls createProperty().
        return {
            kind: 'field',
            key: Symbol(),
            placement: 'own',
            descriptor: {},
            // When @babel/plugin-proposal-decorators implements initializers,
            // do this instead of the initializer below. See:
            // https://github.com/babel/babel/issues/9260 extras: [
            //   {
            //     kind: 'initializer',
            //     placement: 'own',
            //     initializer: descriptor.initializer,
            //   }
            // ],
            initializer() {
                if (typeof element.initializer === 'function') {
                    this[element.key] = element.initializer.call(this);
                }
            },
            finisher(clazz) {
                clazz.createProperty(element.key, options);
            }
        };
    }
};
const legacyProperty = (options, proto, name) => {
    proto.constructor
        .createProperty(name, options);
};
/**
 * A property decorator which creates a LitElement property which reflects a
 * corresponding attribute value. A `PropertyDeclaration` may optionally be
 * supplied to configure property features.
 *
 * @ExportDecoratedItems
 */
function property(options) {
    // tslint:disable-next-line:no-any decorator
    return (protoOrDescriptor, name) => (name !== undefined) ?
        legacyProperty(options, protoOrDescriptor, name) :
        standardProperty(options, protoOrDescriptor);
}
/**
 * A property decorator that converts a class property into a getter that
 * executes a querySelector on the element's renderRoot.
 *
 * @ExportDecoratedItems
 */
function decorators_query(selector) {
    return (protoOrDescriptor, 
    // tslint:disable-next-line:no-any decorator
    name) => {
        const descriptor = {
            get() {
                return this.renderRoot.querySelector(selector);
            },
            enumerable: true,
            configurable: true,
        };
        return (name !== undefined) ?
            legacyQuery(descriptor, protoOrDescriptor, name) :
            standardQuery(descriptor, protoOrDescriptor);
    };
}
/**
 * A property decorator that converts a class property into a getter
 * that executes a querySelectorAll on the element's renderRoot.
 *
 * @ExportDecoratedItems
 */
function queryAll(selector) {
    return (protoOrDescriptor, 
    // tslint:disable-next-line:no-any decorator
    name) => {
        const descriptor = {
            get() {
                return this.renderRoot.querySelectorAll(selector);
            },
            enumerable: true,
            configurable: true,
        };
        return (name !== undefined) ?
            legacyQuery(descriptor, protoOrDescriptor, name) :
            standardQuery(descriptor, protoOrDescriptor);
    };
}
const legacyQuery = (descriptor, proto, name) => {
    Object.defineProperty(proto, name, descriptor);
};
const standardQuery = (descriptor, element) => ({
    kind: 'method',
    placement: 'prototype',
    key: element.key,
    descriptor,
});
const standardEventOptions = (options, element) => {
    return Object.assign({}, element, { finisher(clazz) {
            Object.assign(clazz.prototype[element.key], options);
        } });
};
const legacyEventOptions = 
// tslint:disable-next-line:no-any legacy decorator
(options, proto, name) => {
    Object.assign(proto[name], options);
};
/**
 * Adds event listener options to a method used as an event listener in a
 * lit-html template.
 *
 * @param options An object that specifis event listener options as accepted by
 * `EventTarget#addEventListener` and `EventTarget#removeEventListener`.
 *
 * Current browsers support the `capture`, `passive`, and `once` options. See:
 * https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener#Parameters
 *
 * @example
 *
 *     class MyElement {
 *
 *       clicked = false;
 *
 *       render() {
 *         return html`<div @click=${this._onClick}`><button></button></div>`;
 *       }
 *
 *       @eventOptions({capture: true})
 *       _onClick(e) {
 *         this.clicked = true;
 *       }
 *     }
 */
const eventOptions = (options) => 
// Return value typed as any to prevent TypeScript from complaining that
// standard decorator function signature does not match TypeScript decorator
// signature
// TODO(kschaaf): unclear why it was only failing on this decorator and not
// the others
((protoOrDescriptor, name) => (name !== undefined) ?
    legacyEventOptions(options, protoOrDescriptor, name) :
    standardEventOptions(options, protoOrDescriptor));
//# sourceMappingURL=decorators.js.map
// CONCATENATED MODULE: ./node_modules/lit-element/lib/css-tag.js
/**
@license
Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const supportsAdoptingStyleSheets = ('adoptedStyleSheets' in Document.prototype) &&
    ('replace' in CSSStyleSheet.prototype);
const constructionToken = Symbol();
class CSSResult {
    constructor(cssText, safeToken) {
        if (safeToken !== constructionToken) {
            throw new Error('CSSResult is not constructable. Use `unsafeCSS` or `css` instead.');
        }
        this.cssText = cssText;
    }
    // Note, this is a getter so that it's lazy. In practice, this means
    // stylesheets are not created until the first element instance is made.
    get styleSheet() {
        if (this._styleSheet === undefined) {
            // Note, if `adoptedStyleSheets` is supported then we assume CSSStyleSheet
            // is constructable.
            if (supportsAdoptingStyleSheets) {
                this._styleSheet = new CSSStyleSheet();
                this._styleSheet.replaceSync(this.cssText);
            }
            else {
                this._styleSheet = null;
            }
        }
        return this._styleSheet;
    }
    toString() {
        return this.cssText;
    }
}
/**
 * Wrap a value for interpolation in a css tagged template literal.
 *
 * This is unsafe because untrusted CSS text can be used to phone home
 * or exfiltrate data to an attacker controlled site. Take care to only use
 * this with trusted input.
 */
const unsafeCSS = (value) => {
    return new CSSResult(String(value), constructionToken);
};
const textFromCSSResult = (value) => {
    if (value instanceof CSSResult) {
        return value.cssText;
    }
    else if (typeof value === 'number') {
        return value;
    }
    else {
        throw new Error(`Value passed to 'css' function must be a 'css' function result: ${value}. Use 'unsafeCSS' to pass non-literal values, but
            take care to ensure page security.`);
    }
};
/**
 * Template tag which which can be used with LitElement's `style` property to
 * set element styles. For security reasons, only literal string values may be
 * used. To incorporate non-literal values `unsafeCSS` may be used inside a
 * template string part.
 */
const css = (strings, ...values) => {
    const cssText = values.reduce((acc, v, idx) => acc + textFromCSSResult(v) + strings[idx + 1], strings[0]);
    return new CSSResult(cssText, constructionToken);
};
//# sourceMappingURL=css-tag.js.map
// CONCATENATED MODULE: ./node_modules/lit-element/lit-element.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */








// IMPORTANT: do not change the property name or the assignment expression.
// This line will be used in regexes to search for LitElement usage.
// TODO(justinfagnani): inject version number at build time
(window['litElementVersions'] || (window['litElementVersions'] = []))
    .push('2.2.1');
/**
 * Minimal implementation of Array.prototype.flat
 * @param arr the array to flatten
 * @param result the accumlated result
 */
function arrayFlat(styles, result = []) {
    for (let i = 0, length = styles.length; i < length; i++) {
        const value = styles[i];
        if (Array.isArray(value)) {
            arrayFlat(value, result);
        }
        else {
            result.push(value);
        }
    }
    return result;
}
/** Deeply flattens styles array. Uses native flat if available. */
const flattenStyles = (styles) => styles.flat ? styles.flat(Infinity) : arrayFlat(styles);
class lit_element_LitElement extends UpdatingElement {
    /** @nocollapse */
    static finalize() {
        // The Closure JS Compiler does not always preserve the correct "this"
        // when calling static super methods (b/137460243), so explicitly bind.
        super.finalize.call(this);
        // Prepare styling that is stamped at first render time. Styling
        // is built from user provided `styles` or is inherited from the superclass.
        this._styles =
            this.hasOwnProperty(JSCompiler_renameProperty('styles', this)) ?
                this._getUniqueStyles() :
                this._styles || [];
    }
    /** @nocollapse */
    static _getUniqueStyles() {
        // Take care not to call `this.styles` multiple times since this generates
        // new CSSResults each time.
        // TODO(sorvell): Since we do not cache CSSResults by input, any
        // shared styles will generate new stylesheet objects, which is wasteful.
        // This should be addressed when a browser ships constructable
        // stylesheets.
        const userStyles = this.styles;
        const styles = [];
        if (Array.isArray(userStyles)) {
            const flatStyles = flattenStyles(userStyles);
            // As a performance optimization to avoid duplicated styling that can
            // occur especially when composing via subclassing, de-duplicate styles
            // preserving the last item in the list. The last item is kept to
            // try to preserve cascade order with the assumption that it's most
            // important that last added styles override previous styles.
            const styleSet = flatStyles.reduceRight((set, s) => {
                set.add(s);
                // on IE set.add does not return the set.
                return set;
            }, new Set());
            // Array.from does not work on Set in IE
            styleSet.forEach((v) => styles.unshift(v));
        }
        else if (userStyles) {
            styles.push(userStyles);
        }
        return styles;
    }
    /**
     * Performs element initialization. By default this calls `createRenderRoot`
     * to create the element `renderRoot` node and captures any pre-set values for
     * registered properties.
     */
    initialize() {
        super.initialize();
        this.renderRoot =
            this.createRenderRoot();
        // Note, if renderRoot is not a shadowRoot, styles would/could apply to the
        // element's getRootNode(). While this could be done, we're choosing not to
        // support this now since it would require different logic around de-duping.
        if (window.ShadowRoot && this.renderRoot instanceof window.ShadowRoot) {
            this.adoptStyles();
        }
    }
    /**
     * Returns the node into which the element should render and by default
     * creates and returns an open shadowRoot. Implement to customize where the
     * element's DOM is rendered. For example, to render into the element's
     * childNodes, return `this`.
     * @returns {Element|DocumentFragment} Returns a node into which to render.
     */
    createRenderRoot() {
        return this.attachShadow({ mode: 'open' });
    }
    /**
     * Applies styling to the element shadowRoot using the `static get styles`
     * property. Styling will apply using `shadowRoot.adoptedStyleSheets` where
     * available and will fallback otherwise. When Shadow DOM is polyfilled,
     * ShadyCSS scopes styles and adds them to the document. When Shadow DOM
     * is available but `adoptedStyleSheets` is not, styles are appended to the
     * end of the `shadowRoot` to [mimic spec
     * behavior](https://wicg.github.io/construct-stylesheets/#using-constructed-stylesheets).
     */
    adoptStyles() {
        const styles = this.constructor._styles;
        if (styles.length === 0) {
            return;
        }
        // There are three separate cases here based on Shadow DOM support.
        // (1) shadowRoot polyfilled: use ShadyCSS
        // (2) shadowRoot.adoptedStyleSheets available: use it.
        // (3) shadowRoot.adoptedStyleSheets polyfilled: append styles after
        // rendering
        if (window.ShadyCSS !== undefined && !window.ShadyCSS.nativeShadow) {
            window.ShadyCSS.ScopingShim.prepareAdoptedCssText(styles.map((s) => s.cssText), this.localName);
        }
        else if (supportsAdoptingStyleSheets) {
            this.renderRoot.adoptedStyleSheets =
                styles.map((s) => s.styleSheet);
        }
        else {
            // This must be done after rendering so the actual style insertion is done
            // in `update`.
            this._needsShimAdoptedStyleSheets = true;
        }
    }
    connectedCallback() {
        super.connectedCallback();
        // Note, first update/render handles styleElement so we only call this if
        // connected after first update.
        if (this.hasUpdated && window.ShadyCSS !== undefined) {
            window.ShadyCSS.styleElement(this);
        }
    }
    /**
     * Updates the element. This method reflects property values to attributes
     * and calls `render` to render DOM via lit-html. Setting properties inside
     * this method will *not* trigger another update.
     * * @param _changedProperties Map of changed properties with old values
     */
    update(changedProperties) {
        super.update(changedProperties);
        const templateResult = this.render();
        if (templateResult instanceof template_result_TemplateResult) {
            this.constructor
                .render(templateResult, this.renderRoot, { scopeName: this.localName, eventContext: this });
        }
        // When native Shadow DOM is used but adoptedStyles are not supported,
        // insert styling after rendering to ensure adoptedStyles have highest
        // priority.
        if (this._needsShimAdoptedStyleSheets) {
            this._needsShimAdoptedStyleSheets = false;
            this.constructor._styles.forEach((s) => {
                const style = document.createElement('style');
                style.textContent = s.cssText;
                this.renderRoot.appendChild(style);
            });
        }
    }
    /**
     * Invoked on each update to perform rendering tasks. This method must return
     * a lit-html TemplateResult. Setting properties inside this method will *not*
     * trigger the element to update.
     */
    render() {
    }
}
/**
 * Ensure this class is marked as `finalized` as an optimization ensuring
 * it will not needlessly try to `finalize`.
 *
 * Note this property name is a string to prevent breaking Closure JS Compiler
 * optimizations. See updating-element.ts for more information.
 */
lit_element_LitElement['finalized'] = true;
/**
 * Render method used to render the lit-html TemplateResult to the element's
 * DOM.
 * @param {TemplateResult} Template to render.
 * @param {Element|DocumentFragment} Node into which to render.
 * @param {String} Element name.
 * @nocollapse
 */
lit_element_LitElement.render = shady_render_render;
//# sourceMappingURL=lit-element.js.map
// CONCATENATED MODULE: ./lib/jsorolla/src/core/utilsNew.js
class utilsNew_UtilsNew {
  static get MESSAGE_SUCCESS() {
    return "SUCCESS";
  }

  static get MESSAGE_ERROR() {
    return "ERROR";
  }

  static get MESSAGE_INFO() {
    return "INFO";
  }

  static get MESSAGE_WARNING() {
    return "WARNING";
  }

  static isUndefined(obj) {
    return typeof obj === 'undefined';
  }

  static isNotUndefined(obj) {
    return typeof obj !== 'undefined';
  }

  static isNull(obj) {
    return obj === null;
  }

  static isNotNull(obj) {
    return obj !== null;
  }

  static isUndefinedOrNull(obj) {
    return typeof obj === 'undefined' || obj === null;
  }

  static isNotUndefinedOrNull(obj) {
    return typeof obj !== 'undefined' && obj !== null;
  }

  static isEmpty(obj) {
    if (typeof obj === "undefined" || obj === null) {
      return true;
    } // obj is an actual Object


    if (typeof obj === "object") {
      for (let key in obj) {
        if (obj.hasOwnProperty(key)) return false;
      }

      return true;
    } else {
      // obj is a String
      if (typeof obj === "string") {
        return obj === "";
      }
    }
  }

  static isNotEmpty(obj) {
    return !this.isEmpty(obj);
  }

  static isEmptyArray(arr) {
    return typeof arr !== 'undefined' && arr !== null && arr.length === 0;
  }

  static isNotEmptyArray(arr) {
    return typeof arr !== 'undefined' && arr !== null && arr.length > 0;
  }

  static defaultString(str, str2) {
    return this.isNotEmpty(str) ? str : str2;
  }

  static containsArray(arr, item) {
    if (utilsNew_UtilsNew.isNotEmptyArray(arr) && utilsNew_UtilsNew.isNotUndefinedOrNull(item)) {
      return arr.indexOf(item) > -1;
    }

    return false;
  }

  static removeDuplicates(array, prop) {
    var newArray = [];
    var lookupObject = {};

    for (let i in array) {
      lookupObject[array[i][prop]] = array[i];
    }

    for (let i in lookupObject) {
      newArray.push(lookupObject[i]);
    }

    return newArray;
  }

  static checkPermissions(project) {
    return utilsNew_UtilsNew.isUndefinedOrNull(project) || utilsNew_UtilsNew.isNotUndefinedOrNull(project) && Object.keys(project).length === 0;
  }

  static isNotEqual(str, str2) {
    return str !== str2;
  }

  static isEqual(str, str2) {
    return str === str2;
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/PolymerUtils.js

class PolymerUtils_PolymerUtils {
  static isNotEmptyValueById(id) {
    const value = PolymerUtils_PolymerUtils.getValue(id);
    return typeof value !== 'undefined' && value !== null && value !== '';
  }

  static getValue(id) {
    return PolymerUtils_PolymerUtils.getPropertyById(id, 'value');
  }

  static setValue(id, value) {
    return PolymerUtils_PolymerUtils.setPropertyById(id, 'value', value);
  }

  static getElementById(id) {
    return document.getElementById(id);
  }

  static getElementsByClassName(className, element) {
    if (utilsNew_UtilsNew.isUndefined(element)) {
      return document.getElementsByClassName(className);
    } // If element is a string we do first a getElementById, if it exist we execute the query


    if (typeof element === 'string') {
      const elem = PolymerUtils_PolymerUtils.getElementById(element);

      if (elem !== undefined && elem !== null) {
        return element.getElementsByClassName(className);
      } // The given element id does not exist


      return undefined;
    } // Element exists and it is not a string, it must be a object


    return element.getElementsByClassName(className);
  }

  static querySelector(selectors, element) {
    if (utilsNew_UtilsNew.isUndefinedOrNull(element)) {
      return document.querySelector(selectors);
    } // If element is a string we do first a getElementById, if it exist we execute the query


    if (typeof element === 'string') {
      const elem = PolymerUtils_PolymerUtils.getElementById(element);

      if (elem !== undefined && elem !== null) {
        return elem.querySelector(selectors);
      } // The given element id does not exist


      return undefined;
    } // Element exists and it is not a string, it must be a object


    return element.querySelector(selectors);
  }

  static querySelectorAll(selectors, element) {
    if (utilsNew_UtilsNew.isUndefinedOrNull(element)) {
      return document.querySelectorAll(selectors);
    } // If element is a string we do first a getElementById, if it exist we execute the query


    if (typeof element === 'string') {
      const elem = PolymerUtils_PolymerUtils.getElementById(element);

      if (elem !== undefined && elem !== null) {
        return elem.querySelectorAll(selectors);
      } // The given element id does not exist


      return undefined;
    } // Element exists and it is not a string, it must be a object


    return element.querySelectorAll(selectors);
  }

  static getTextOptionSelected(id) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(id)) {
      const sel = PolymerUtils_PolymerUtils.getElementById(id);

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(sel)) {
        return sel.options[sel.selectedIndex].text;
      }

      return undefined;
    }
  }

  static show(id, type = 'block') {
    PolymerUtils_PolymerUtils.addStyle(id, 'display', type);
  }

  static showByClass(className, type = 'block') {
    PolymerUtils_PolymerUtils.addStyleByClass(className, 'display', type);
  }

  static hide(id) {
    PolymerUtils_PolymerUtils.addStyle(id, 'display', 'none');
  }

  static hideByClass(className) {
    PolymerUtils_PolymerUtils.addStyleByClass(className, 'display', 'none');
  }

  static addClassById(id, className) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(id)) {
      return this.addClass(PolymerUtils_PolymerUtils.getElementById(id), className);
    }
  }

  static addClassByQuerySelector(id, className) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(id)) {
      return this.addClass(PolymerUtils_PolymerUtils.querySelectorAll(id), className);
    }
  }

  static addClass(id, className) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(id)) {
      let el;

      if (typeof id === "object") {
        el = id;
      } else {
        if (id.startsWith('.')) {
          // If starts with a dot then is a class, we use querySelector
          el = PolymerUtils_PolymerUtils.querySelector(id);
        } else {
          // It is an ID
          el = PolymerUtils_PolymerUtils.getElementById(id);
        }
      }

      if (Array.isArray(className)) {
        if (!utilsNew_UtilsNew.isUndefinedOrNull(el)) {
          className.forEach(item => {
            el.classList.add(item);
          });
        }
      } else {
        if (el.length > 1) {
          el.forEach(item => {
            item.classList.add(className);
          });
        } else {
          el.classList.add(className);
        }
      }
    }
  }

  static removeClass(id, className) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(id)) {
      let el;

      if (id.startsWith('.')) {
        // If starts with a dot then is a class, we use querySelector
        el = PolymerUtils_PolymerUtils.querySelectorAll(id);
      } else {
        // It is an ID
        el = PolymerUtils_PolymerUtils.getElementById(id);
      }

      if (Array.isArray(className)) {
        if (utilsNew_UtilsNew.isNotUndefinedOrNull(el)) {
          className.forEach(item => {
            el.classList.remove(item);
          });
        }
      } else if (utilsNew_UtilsNew.isNotUndefinedOrNull(el.length) && el.length > 1) {
        el.forEach(element => {
          element.classList.remove(className);
        });
      } else {
        el.classList.remove(className);
      }
    }
  }

  static toggleClass(id, className) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(id)) {
      let el;

      if (id.startsWith('.')) {
        // If starts with a dot then is a class, we use querySelector
        el = PolymerUtils_PolymerUtils.querySelectorAll(id);
      } else {
        // It is an ID
        el = PolymerUtils_PolymerUtils.getElementById(id);
      }

      if (Array.isArray(className)) {
        if (utilsNew_UtilsNew.isNotUndefinedOrNull(el)) {
          className.forEach(item => {
            el.classList.toggle(item);
          });
        }
      } else if (utilsNew_UtilsNew.isNotUndefinedOrNull(el.length) && el.length > 1) {
        el.forEach(element => {
          element.classList.toggle(className);
        });
      } else {
        el.classList.toggle(className);
      }
    }
  }

  static removeElement(id) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(id)) {
      const el = this.getElementById(id);

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(el)) {
        el.parentNode.removeChild(el);
      }
    }
  }

  static addStyle(id, key, value) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(id)) {
      const el = PolymerUtils_PolymerUtils.getElementById(id);

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(el)) {
        el.style[key] = value;
      }
    }
  }

  static addStyleByClass(className, key, value) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(className)) {
      const els = PolymerUtils_PolymerUtils.getElementsByClassName(className);

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(els)) {
        Array.from(els).forEach(element => {
          element.style[key] = value;
        });
      }
    }
  }

  static removeStyle(id, key) {
    if (!utilsNew_UtilsNew.isUndefinedOrNull(id)) {
      const el = PolymerUtils_PolymerUtils.getElementById(id);

      if (!utilsNew_UtilsNew.isUndefinedOrNull(el)) {
        delete el.style[key];
      }
    }
  }

  static removeStyleByClass(className, key) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(className)) {
      const els = PolymerUtils_PolymerUtils.getElementsByClassName(className);

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(els)) {
        Array.from(els).forEach(element => {
          delete element.style[key];
        });
      }
    }
  }

  static setAttribute(id, key, value) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(key)) {
      const el = PolymerUtils_PolymerUtils.getElementById(id);

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(el)) {
        el.setAttribute(key, value);
      }
    }
  }

  static removeAttribute(id, key) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(key)) {
      const el = PolymerUtils_PolymerUtils.getElementById(id);

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(el)) {
        el.removeAttribute(key);
      }
    }
  }

  static removeAttributebyclass(className, key) {
    const els = PolymerUtils_PolymerUtils.getElementsByClassName(className);

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(key)) {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(els)) {
        Array.from(els).forEach(element => {
          element.removeAttribute(key);
        });
      }
    }
  }

  static innerHTML(id, text) {
    const el = PolymerUtils_PolymerUtils.getElementById(id);

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(el)) {
      el.innerHTML = text;
    }
  }

  static innerHtmlByClass(className, text) {
    const els = PolymerUtils_PolymerUtils.getElementsByClassName(className);

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(els)) {
      Array.from(els).forEach(element => {
        element.innerHTML = text;
      });
    }
  }

  static setPropertyByClassName(className, key, value) {
    const els = PolymerUtils_PolymerUtils.getElementsByClassName(className);

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(key)) {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(els)) {
        Array.from(els).forEach(element => {
          element[key] = value;
        });
      }
    }
  }

  static setPropertyById(id, key, value) {
    const element = PolymerUtils_PolymerUtils.getElementById(id);

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(key)) {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(element)) {
        element[key] = value;
      }
    }
  }

  static getPropertyById(id, key) {
    const element = PolymerUtils_PolymerUtils.getElementById(id);

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(key)) {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(element)) {
        return element[key];
      }
    }
  }

  static setAttributeByClassName(className, key, value) {
    const els = PolymerUtils_PolymerUtils.getElementsByClassName(className);

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(key)) {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(els)) {
        Array.from(els).forEach(element => {
          element.setAttribute(key, value);
        });
      }
    }
  }

}
// CONCATENATED MODULE: ./src/welcome.js
function _templateObject5() {
  const data = _taggedTemplateLiteral(["\n                                    <a class=\"icon-wrapper\" href=\"#", "/", "\">\n                                    <div class=\"hi-icon\">\n                                        <img src=\"img/tools/icons/", "\" /> \n                                    </div>\n                                    <p>", "</p>\n                                    <span class=\"smaller\"></span>\n                                </a>\n                                "]);

  _templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function _templateObject4() {
  const data = _taggedTemplateLiteral(["\n                                <a class=\"icon-wrapper\" href=\"#cat-", "/", "\">\n                                    <div class=\"hi-icon\">\n                                        <img src=\"img/tools/icons/", "\" /> \n                                    </div>\n                                    <p>", "</p>\n                                    <span class=\"smaller\"></span>\n                                </a>\n                                "]);

  _templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function _templateObject3() {
  const data = _taggedTemplateLiteral(["\n                            ", "\n                "]);

  _templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function _templateObject2() {
  const data = _taggedTemplateLiteral(["\n                <div>\n                    <input id=\"welcomeSearchTextBox\" type=\"text\" class=\"form-control input-lg\" list=\"FeatureDatalist\" @change=\"", "\" placeholder=\"Search for gene symbols, genomic regions or variants\" value=\"\">\n                        <datalist id=\"FeatureDatalist\"></datalist>\n                        <!-- Examples -->\n                    <span style=\"font-size: 0.8em; padding-left: 10px\">\n                            Examples - Gene: <a @click=\"", "\" data-type=\"gene\" style=\"cursor: pointer\">BRCA2</a>,\n                            Region: <a @click=\"", "\" data-type=\"region\" style=\"cursor: pointer\">3</a>, <a @click=\"", "\" data-type=\"region\" style=\"cursor: pointer\">3:113000-1150000</a>,\n                            SNP: <a @click=\"", "\" data-type=\"snp\" style=\"cursor: pointer\">rs445909</a>\n                            Variant: <a @click=\"", "\" data-type=\"variant\" style=\"cursor: pointer\">13:32962274:G:T</a>\n                    </span>\n                </div>"]);

  _templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function _templateObject() {
  const data = _taggedTemplateLiteral(["\n        <style>\n            #logo {\n                width: 200px;\n                margin: 50px 0 0 0;\n            }\n        \n            #title {\n                font-size: 10em;\n                text-align: center;\n                font-weight: bold;\n                letter-spacing: -20px;\n            }\n        \n            #title::first-letter {\n                letter-spacing: -5px;\n            }\n        \n            #title span {\n                font-size: 20px;\n                letter-spacing: 0;\n            }\n            \n            .hi-icon-wrap {\n                text-align: center;\n                margin: 0 auto;\n                padding: 2em 0 3em;\n            }\n            .hi-icon {\n                display: inline-block;\n                cursor: pointer;\n                margin: 15px 30px;\n                width: 110px;\n                height: 110px;\n                border-radius: 50%;\n                text-align: center;\n                position: relative;\n                z-index: 1;\n            }\n            .hi-icon a p {\n                text-decoration: none;\n                color: #000966;\n            }\n            .hi-icon a:hover p {\n                text-decoration: none;\n            }\n            .hi-icon:after {\n                pointer-events: none;\n                position: absolute;\n                width: 100%;\n                height: 100%;\n                border-radius: 50%;\n                content: '';\n                -webkit-box-sizing: content-box;\n                -moz-box-sizing: content-box;\n                box-sizing: content-box;\n            }\n            .hi-icon:before {\n                /*font-family: 'ecoicon';*/\n                speak: none;\n                font-size: 48px;\n                line-height: 110px;\n                font-style: normal;\n                font-variant: normal;\n                text-transform: none;\n                display: block;\n                -webkit-font-smoothing: antialiased;\n                color: #000966;\n            }\n            .hi-icon-mobile:before {\n                content: \"\\e009\";\n            }\n            .hi-icon-animation .hi-icon {\n                -webkit-transition: box-shadow 0.2s;\n                -moz-transition: box-shadow 0.2s;\n                transition: box-shadow 0.2s;\n            }\n            .hi-icon-animation p {\n                -webkit-transition: all 0.3s;\n                -moz-transition: all 0.3s;\n                transition: all 0.3s;\n                color: #797979;\n            }\n            .hi-icon-animation .hi-icon svg {\n                -webkit-transition: -webkit-transform 0.2s, all 0.2s;\n                -moz-transition: -moz-transform 0.2s, all 0.2s;\n                transition: transform 0.2s, all 0.2s;\n                fill: #000966;\n                height: 90px;\n                width: 90px;\n            }\n            .hi-icon-animation .hi-icon.fa,\n            .hi-icon-animation .icon-wrapper:hover .hi-icon img{\n                -webkit-transition: -webkit-transform 0.2s, all 0.2s;\n                -moz-transition: -moz-transform 0.2s, all 0.2s;\n                transition: transform 0.2s, all 0.2s;\n            }\n            .hi-icon-animation .hi-icon svg image{\n                height: 90px;\n                width: 90px;\n            }\n            .hi-icon-animation .hi-icon:after {\n                top: 0;\n                left: 0;\n                padding: 0;\n                box-shadow: 0 0 0 4px #000966;\n                -webkit-transition: -webkit-transform 0.2s, opacity 0.2s;\n                -moz-transition: -moz-transform 0.2s, opacity 0.2s;\n                transition: transform 0.2s, opacity 0.2s;\n            }\n            .hi-icon-animation .icon-wrapper:hover {\n                display: inline-block;\n                text-decoration: none;\n            }\n            .hi-icon-animation .icon-wrapper:hover .hi-icon:after {\n                -webkit-transform: scale(0.85);\n                -moz-transform: scale(0.85);\n                -ms-transform: scale(0.85);\n                transform: scale(0.85);\n                opacity: 0.5;\n            }\n            /* in case of svg or image[src=svg] icon */\n            .hi-icon-animation .icon-wrapper:hover .hi-icon svg,\n            .hi-icon-animation .icon-wrapper:hover .hi-icon img{\n                transform: scale(0.85);\n            }\n            /* in case of fa icon*/\n            .hi-icon-animation .icon-wrapper:hover .hi-icon.fa {\n                transform: scale(0.85);\n            }\n            .hi-icon-animation .icon-wrapper:hover .hi-icon {\n                box-shadow: 0 0 0 10px rgba(0, 9, 102, 1);\n                color: #fff;\n            }\n            .hi-icon-animation .icon-wrapper:hover p {\n                color: #000966;\n            }\n            .smaller {\n                font-size: 75%;\n            }\n\n            .getting-started {\n                display: inline-block;\n                border: 4px #000966 solid;\n                background: white;\n                position: relative;\n                padding: 10px 35px;\n                -webkit-transition: all 0.3s;\n                -moz-transition: all 0.3s;\n                transition: all 0.3s;\n                border-radius: 30px;\n            }\n\n            .getting-started:hover {\n                text-decoration: none;\n            }\n\n            .getting-started span {\n                color: #000966;\n                font-size: .8em;\n                display: inline-block;\n                -webkit-transition: all 0.3s;\n                -moz-transition: all 0.3s;\n                transition: all 0.3s;\n            }\n\n            .getting-started:hover {\n                -webkit-transform: scale(1.2);\n                -moz-transform: scale(1.2);\n                -ms-transform: scale(1.2);\n                transform: scale(1.2);\n                border: 4px #fff solid;\n                background: #000966;\n            }\n\n            .getting-started:hover span {\n                -webkit-transform: scale(.8);\n                -moz-transform: scale(.8);\n                -ms-transform: scale(.8);\n                transform: scale(.8);\n                color: #fff\n            }\n\n            #title {\n                font-size: 10em;\n                text-align: center;\n                font-weight: bold;\n                letter-spacing: -20px;\n                position: relative;\n            }\n\n            #title::first-letter {\n                letter-spacing: -5px;\n            }\n\n            #title span.subtitle {\n                font-size: 20px;\n                display: block;\n                letter-spacing: 0;\n            }\n\n            #title .version {\n                font-size: 15px;\n                display: inline-block;\n                vertical-align: top;\n                letter-spacing: 0px;\n                margin: 25px 0 0 0;\n                position: absolute;\n            }\n\n            #title .bracket {\n                font-size: 2em;\n                color: black;\n            }\n\n            .footer {\n                margin-bottom: 80px;\n            }\n        \n            .hi-icon-wrap {\n                display: grid;\n                grid-template-columns: auto auto auto auto auto auto; /* TODO FIXME hi-icon:before seems to be a problem there are 5 items not 6 */\n            }\n        </style>\n        \n                                           \n\n        <!-- This is where main application is rendered -->\n        <div class=\"col-md-6 col-md-offset-3 welcome-center text-muted text-justify\">\n            <h1 id=\"title\">\n                \n                <img style=\"width: 2.5em\" src=\"./img/iva.svg\" />\n                <p class=\"version\">\n                    <span class=\"bracket\">(</span><span>", "</span><span class=\"bracket\">)</span>\n                </p>\n                <span class=\"subtitle\">Interactive Variant Analysis</span>\n            </h1>\n            \n            <p class=\"text-center\">\n                Welcome to the IVA tool for whole genome variant analysis.<br />\n                This interactive tool allows finding genes affected by deleterious variants that segregate along family\n                pedigrees, case-controls or sporadic samples.\n            </p>\n            <br>\n            <!--<input type=\"text\" class=\"form-control input-lg\" id=\"welcomeSearchTextBoxOld\" style=\"text-align: center;\"-->\n            <!--placeholder=\"Search for a gene, transcript, protein or a variant\" on-blur=\"onBlur\" on-keyup=\"onKeyup\">-->\n            <!--<br>-->\n        \n            ", "\n             \n            <div class=\"row hi-icon-wrap hi-icon-effect-9 hi-icon-animation\">\n                ", "\n            </div>\n\n            <div class=\"row text-center\">\n                <a class=\"getting-started\" href=\"#gettingstarted\"><span>Getting started with IVA</span></a>\n            </div>\n                       \n           <!-- <h4>Note</h4>\n            <small>\n                IVA web application makes an intensive use of the HTML5 standard and other cutting-edge web technologies such as\n                Web Components,\n                so only modern web browsers are fully supported, these include Chrome 49+, Firefox 45+, Microsoft Edge 14+,\n                Safari 10+ and Opera 36+.\n            </small>-->\n            <p><img id=\"logo\" src=\"img/opencb-logo.png\"/></p>\n        </div>\n        "], ["\n        <style>\n            #logo {\n                width: 200px;\n                margin: 50px 0 0 0;\n            }\n        \n            #title {\n                font-size: 10em;\n                text-align: center;\n                font-weight: bold;\n                letter-spacing: -20px;\n            }\n        \n            #title::first-letter {\n                letter-spacing: -5px;\n            }\n        \n            #title span {\n                font-size: 20px;\n                letter-spacing: 0;\n            }\n            \n            .hi-icon-wrap {\n                text-align: center;\n                margin: 0 auto;\n                padding: 2em 0 3em;\n            }\n            .hi-icon {\n                display: inline-block;\n                cursor: pointer;\n                margin: 15px 30px;\n                width: 110px;\n                height: 110px;\n                border-radius: 50%;\n                text-align: center;\n                position: relative;\n                z-index: 1;\n            }\n            .hi-icon a p {\n                text-decoration: none;\n                color: #000966;\n            }\n            .hi-icon a:hover p {\n                text-decoration: none;\n            }\n            .hi-icon:after {\n                pointer-events: none;\n                position: absolute;\n                width: 100%;\n                height: 100%;\n                border-radius: 50%;\n                content: '';\n                -webkit-box-sizing: content-box;\n                -moz-box-sizing: content-box;\n                box-sizing: content-box;\n            }\n            .hi-icon:before {\n                /*font-family: 'ecoicon';*/\n                speak: none;\n                font-size: 48px;\n                line-height: 110px;\n                font-style: normal;\n                font-variant: normal;\n                text-transform: none;\n                display: block;\n                -webkit-font-smoothing: antialiased;\n                color: #000966;\n            }\n            .hi-icon-mobile:before {\n                content: \"\\\\e009\";\n            }\n            .hi-icon-animation .hi-icon {\n                -webkit-transition: box-shadow 0.2s;\n                -moz-transition: box-shadow 0.2s;\n                transition: box-shadow 0.2s;\n            }\n            .hi-icon-animation p {\n                -webkit-transition: all 0.3s;\n                -moz-transition: all 0.3s;\n                transition: all 0.3s;\n                color: #797979;\n            }\n            .hi-icon-animation .hi-icon svg {\n                -webkit-transition: -webkit-transform 0.2s, all 0.2s;\n                -moz-transition: -moz-transform 0.2s, all 0.2s;\n                transition: transform 0.2s, all 0.2s;\n                fill: #000966;\n                height: 90px;\n                width: 90px;\n            }\n            .hi-icon-animation .hi-icon.fa,\n            .hi-icon-animation .icon-wrapper:hover .hi-icon img{\n                -webkit-transition: -webkit-transform 0.2s, all 0.2s;\n                -moz-transition: -moz-transform 0.2s, all 0.2s;\n                transition: transform 0.2s, all 0.2s;\n            }\n            .hi-icon-animation .hi-icon svg image{\n                height: 90px;\n                width: 90px;\n            }\n            .hi-icon-animation .hi-icon:after {\n                top: 0;\n                left: 0;\n                padding: 0;\n                box-shadow: 0 0 0 4px #000966;\n                -webkit-transition: -webkit-transform 0.2s, opacity 0.2s;\n                -moz-transition: -moz-transform 0.2s, opacity 0.2s;\n                transition: transform 0.2s, opacity 0.2s;\n            }\n            .hi-icon-animation .icon-wrapper:hover {\n                display: inline-block;\n                text-decoration: none;\n            }\n            .hi-icon-animation .icon-wrapper:hover .hi-icon:after {\n                -webkit-transform: scale(0.85);\n                -moz-transform: scale(0.85);\n                -ms-transform: scale(0.85);\n                transform: scale(0.85);\n                opacity: 0.5;\n            }\n            /* in case of svg or image[src=svg] icon */\n            .hi-icon-animation .icon-wrapper:hover .hi-icon svg,\n            .hi-icon-animation .icon-wrapper:hover .hi-icon img{\n                transform: scale(0.85);\n            }\n            /* in case of fa icon*/\n            .hi-icon-animation .icon-wrapper:hover .hi-icon.fa {\n                transform: scale(0.85);\n            }\n            .hi-icon-animation .icon-wrapper:hover .hi-icon {\n                box-shadow: 0 0 0 10px rgba(0, 9, 102, 1);\n                color: #fff;\n            }\n            .hi-icon-animation .icon-wrapper:hover p {\n                color: #000966;\n            }\n            .smaller {\n                font-size: 75%;\n            }\n\n            .getting-started {\n                display: inline-block;\n                border: 4px #000966 solid;\n                background: white;\n                position: relative;\n                padding: 10px 35px;\n                -webkit-transition: all 0.3s;\n                -moz-transition: all 0.3s;\n                transition: all 0.3s;\n                border-radius: 30px;\n            }\n\n            .getting-started:hover {\n                text-decoration: none;\n            }\n\n            .getting-started span {\n                color: #000966;\n                font-size: .8em;\n                display: inline-block;\n                -webkit-transition: all 0.3s;\n                -moz-transition: all 0.3s;\n                transition: all 0.3s;\n            }\n\n            .getting-started:hover {\n                -webkit-transform: scale(1.2);\n                -moz-transform: scale(1.2);\n                -ms-transform: scale(1.2);\n                transform: scale(1.2);\n                border: 4px #fff solid;\n                background: #000966;\n            }\n\n            .getting-started:hover span {\n                -webkit-transform: scale(.8);\n                -moz-transform: scale(.8);\n                -ms-transform: scale(.8);\n                transform: scale(.8);\n                color: #fff\n            }\n\n            #title {\n                font-size: 10em;\n                text-align: center;\n                font-weight: bold;\n                letter-spacing: -20px;\n                position: relative;\n            }\n\n            #title::first-letter {\n                letter-spacing: -5px;\n            }\n\n            #title span.subtitle {\n                font-size: 20px;\n                display: block;\n                letter-spacing: 0;\n            }\n\n            #title .version {\n                font-size: 15px;\n                display: inline-block;\n                vertical-align: top;\n                letter-spacing: 0px;\n                margin: 25px 0 0 0;\n                position: absolute;\n            }\n\n            #title .bracket {\n                font-size: 2em;\n                color: black;\n            }\n\n            .footer {\n                margin-bottom: 80px;\n            }\n        \n            .hi-icon-wrap {\n                display: grid;\n                grid-template-columns: auto auto auto auto auto auto; /* TODO FIXME hi-icon:before seems to be a problem there are 5 items not 6 */\n            }\n        </style>\n        \n                                           \n\n        <!-- This is where main application is rendered -->\n        <div class=\"col-md-6 col-md-offset-3 welcome-center text-muted text-justify\">\n            <h1 id=\"title\">\n                \n                <img style=\"width: 2.5em\" src=\"./img/iva.svg\" />\n                <p class=\"version\">\n                    <span class=\"bracket\">(</span><span>", "</span><span class=\"bracket\">)</span>\n                </p>\n                <span class=\"subtitle\">Interactive Variant Analysis</span>\n            </h1>\n            \n            <p class=\"text-center\">\n                Welcome to the IVA tool for whole genome variant analysis.<br />\n                This interactive tool allows finding genes affected by deleterious variants that segregate along family\n                pedigrees, case-controls or sporadic samples.\n            </p>\n            <br>\n            <!--<input type=\"text\" class=\"form-control input-lg\" id=\"welcomeSearchTextBoxOld\" style=\"text-align: center;\"-->\n            <!--placeholder=\"Search for a gene, transcript, protein or a variant\" on-blur=\"onBlur\" on-keyup=\"onKeyup\">-->\n            <!--<br>-->\n        \n            ", "\n             \n            <div class=\"row hi-icon-wrap hi-icon-effect-9 hi-icon-animation\">\n                ", "\n            </div>\n\n            <div class=\"row text-center\">\n                <a class=\"getting-started\" href=\"#gettingstarted\"><span>Getting started with IVA</span></a>\n            </div>\n                       \n           <!-- <h4>Note</h4>\n            <small>\n                IVA web application makes an intensive use of the HTML5 standard and other cutting-edge web technologies such as\n                Web Components,\n                so only modern web browsers are fully supported, these include Chrome 49+, Firefox 45+, Microsoft Edge 14+,\n                Safari 10+ and Opera 36+.\n            </small>-->\n            <p><img id=\"logo\" src=\"img/opencb-logo.png\"/></p>\n        </div>\n        "]);

  _templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function _taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



class welcome_WelcomeWeb extends lit_element_LitElement {
  constructor() {
    super();
    this.checkProjects = false;
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      version: {
        type: String
      },
      cellbaseClient: {
        type: Object
      },
      checkProjects: {
        type: Boolean
      },
      config: {
        type: Object
      }
    };
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession")) {
      this.opencgaSessionObserver();
    }
  }

  opencgaSessionObserver() {
    //console.log("opencgaSessionObserver")
    //console.log(this.opencgaSession)
    this.checkProjects = !!(utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.project));
  }

  onExampleClick(e) {
    const query = {
      study: this.opencgaSession.study.fqn
    };

    switch (e.currentTarget.dataset.type) {
      case "gene":
        query.gene = e.currentTarget.text;
        break;

      case "region":
        query.region = e.currentTarget.text;
        break;

      case "snp":
        query.xref = e.currentTarget.text;
        break;

      case "variant":
        query.xref = e.currentTarget.text;
        break;
    }

    this.notify(query);
  }

  notify(query) {
    query.study = this.opencgaSession.study.fqn;
    this.dispatchEvent(new CustomEvent("search", {
      detail: query,
      bubbles: true,
      composed: true
    }));
  }

  callAutocomplete(e) {
    // Only gene symbols are going to be searched and not Ensembl IDs
    const featureId = PolymerUtils_PolymerUtils.getElementById("welcomeSearchTextBox").value;

    if (utilsNew_UtilsNew.isNotEmpty(featureId)) {
      const query = {};

      if (featureId.startsWith("chr") || featureId.startsWith("X") || featureId.startsWith("Y") || featureId.startsWith("MT") || featureId.match(/^\d/)) {
        if (featureId.split(":").length < 3) {
          // It's a region, contains only one ':' character
          query.region = featureId;
        } else {
          query.xref = featureId;
        }
      } else if (featureId.startsWith("rs")) {
        query.xref = featureId;
      } else {
        // The ID written seems to be a gene name
        query.gene = featureId;

        if (featureId.length >= 3 && !featureId.startsWith("ENS")) {
          const _this = this;

          _this.cellbaseClient.get("feature", "id", featureId.toUpperCase(), "starts_with", {}, {}).then(function (response) {
            let options = "";

            for (const id of response.response[0].result) {
              options += "<option value=\"".concat(id.name, "\">");
            }

            PolymerUtils_PolymerUtils.innerHTML("FeatureDatalist", options);
          });
        }
      }

      if (e.keyCode === 13) {
        this.notify(query);
        PolymerUtils_PolymerUtils.getElementById("welcomeSearchTextBox").value = "";
      }
    } else {
      PolymerUtils_PolymerUtils.innerHTML("FeatureDatalist", "");
    }
  }

  isVisible(item) {
    switch (item.visibility) {
      case "public":
        return true;

      case "private":
        return utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotEmpty(this.opencgaSession.token);

      case "none":
      default:
        return false;
    }
  }

  render() {
    return lit_html_html(_templateObject(), this.version, this.checkProjects ? lit_html_html(_templateObject2(), this.callAutocomplete, this.onExampleClick, this.onExampleClick, this.onExampleClick, this.onExampleClick, this.onExampleClick) : null, this.config.menu.filter(this.isVisible).map(item => lit_html_html(_templateObject3(), item.submenu ? lit_html_html(_templateObject4(), item.id, this.checkProjects ? "".concat(this.opencgaSession.project.id, "/").concat(this.opencgaSession.study.id) : '', item.icon, item.title) : lit_html_html(_templateObject5(), item.id, this.checkProjects ? "".concat(this.opencgaSession.project.id, "/").concat(this.opencgaSession.study.id) : '', item.icon, item.title))));
  }

}
customElements.define("welcome-web", welcome_WelcomeWeb);
// CONCATENATED MODULE: ./src/about.js
function about_templateObject() {
  const data = about_taggedTemplateLiteral(["\n        <div class=\"col-md-6 .col-md-offset-3\">\n            <h1>About us</h1>\n        </div>\n        "]);

  about_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function about_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

class about_AboutWeb extends lit_element_LitElement {
  constructor() {
    super();
  }

  createRenderRoot() {
    return this;
  }

  render() {
    return lit_html_html(about_templateObject());
  }

}
customElements.define("about-web", about_AboutWeb);
// CONCATENATED MODULE: ./src/contact.js
function contact_templateObject() {
  const data = contact_taggedTemplateLiteral(["\n        <div class=\"row\">\n            <div class=\"col-md-6 col-md-offset-3\">\n                <h1>Contact</h1>\n            </div>\n        </div>\n        "]);

  contact_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function contact_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

class contact_ContactWeb extends lit_element_LitElement {
  constructor() {
    super();
  }

  createRenderRoot() {
    return this;
  }

  render() {
    return lit_html_html(contact_templateObject());
  }

}
customElements.define("contact-web", contact_ContactWeb);
// CONCATENATED MODULE: ./src/faq.js
function faq_templateObject() {
  const data = faq_taggedTemplateLiteral(["\n        <div class=\"row\">\n            <div class=\"col-md-6 col-md-offset-3\">\n                <h1>Frequently Asked Questions</h1>\n            </div>\n        </div>\n        "]);

  faq_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function faq_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

class faq_FaqWeb extends lit_element_LitElement {
  constructor() {
    super();
  }

  createRenderRoot() {
    return this;
  }

  render() {
    return lit_html_html(faq_templateObject());
  }

}
customElements.define('faq-web', faq_FaqWeb);
// CONCATENATED MODULE: ./src/terms.js
function terms_templateObject() {
  const data = terms_taggedTemplateLiteral(["\n        <div class=\"row\">\n            <div class=\"col-md-6 col-md-offset-3\">\n                <h1>Terms</h1>\n            </div>\n        </div>\n        "]);

  terms_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function terms_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

class terms_TermsWeb extends lit_element_LitElement {
  constructor() {
    super();
  }

  createRenderRoot() {
    return this;
  }

  render() {
    return lit_html_html(terms_templateObject());
  }

}
customElements.define("terms-web", terms_TermsWeb);
// CONCATENATED MODULE: ./src/getting-started.js
function getting_started_templateObject2() {
  const data = getting_started_taggedTemplateLiteral(["\n                    <section>\n                        <div class=\"row\">\n                            <div class=\"col-sm-6 col-md-5 ", " position-relative\">\n                                <img class=\"img-responsive\" src=\"img/tools/thumbnails/", "\" @click=\"", "\">\n                            </div>\n                            <div class=\"col-xs-6 col-md-7 ", "\">\n                                <h2><a href=\"#", "/", "\"> ", " </a></h2>\n                                <div>", "</div>\n                            </div>\n                        </div>\n                    </section>\n                "]);

  getting_started_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function getting_started_templateObject() {
  const data = getting_started_taggedTemplateLiteral(["\n        <style>\n            a:hover {\n                text-decoration: none;\n            }\n            \n            .getting-started .position-relative {\n                position: relative;\n            }\n            \n            .getting-started section {\n                padding: 50px 0;\n                border-bottom: 1px solid #d4d4d4;\n            }\n            \n            .getting-started section:last-child {\n                border:0\n            }\n            \n            .getting-started section img {\n                cursor: pointer;\n                -webkit-transition: all 0.2s;\n                -moz-transition: all 0.2s;\n                transition: all 0.2s;\n                -webkit-box-shadow: 0px 0px 10px -2px rgba(0,0,0,0.75);\n                -moz-box-shadow: 0px 0px 10px -2px rgba(0,0,0,0.75);\n                box-shadow: 0px 0px 10px -2px rgba(0,0,0,0.75);\n                position: relative;\n            }\n            \n            .getting-started section img:hover {\n                -webkit-box-shadow: 0px 0px 13px 0px rgba(0,0,0,0.75);\n                -moz-box-shadow: 0px 0px 13px 0px rgba(0,0,0,0.75);\n                box-shadow: 0px 0px 13px 0px rgba(0,0,0,0.75);\n            }\n            \n            .getting-started .modal .modal-dialog {\n                width: 80%;\n            }\n            \n            .getting-started ul {\n                display: inline-block;\n            }\n            \n        </style>\n        <div class=\"getting-started\">\n            <div class=\"container\">\n                <div class=\"row\">\n                    <div class=\"col-md-12\"><h1>Getting started with IVA</h1>\n                        <hr>\n                    </div>\n                </div>\n                ", "\n            </div>\n        </div>\n\n        <div class=\"modal fade\" id=\"thumbnail_modal\" tabindex=\"-1\" role=\"dialog\">\n            <div class=\"modal-dialog\" role=\"document\">\n                <div class=\"modal-content\">\n                    <div class=\"modal-body\">\n                        <img class=\"img-responsive\" src=\"img/tools/thumbnails/screenshot1.png\">\n                    </div>\n                </div>\n            </div>\n        </div>\n        "]);

  getting_started_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function getting_started_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


class getting_started_GettingStarted extends lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      version: {
        type: String
      },
      opencgaSession: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "gs-" + Utils.randomString(6) + "_";
  }

  openModal(e) {
    $("#thumbnail_modal img", this).attr("src", e.target.src);
    $("#thumbnail_modal", this).modal("show");
  }

  isVisible(item) {
    switch (item.visibility) {
      case "public":
        return true;

      case "private":
        return utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotEmpty(this.opencgaSession.token);

      case "none":
      default:
        return false;
    }
  }

  renderHTML(html) {
    return document.createRange().createContextualFragment("".concat(html));
  }

  render() {
    return lit_html_html(getting_started_templateObject(), this.config.components.filter(this.isVisible).map((tool, i) => lit_html_html(getting_started_templateObject2(), i % 2 ? "col-md-push-7" : "", tool.thumbnail, this.openModal, i % 2 ? "col-md-pull-5 text-right" : "", tool.id, this.opencgaSession && this.opencgaSession.project ? "".concat(this.opencgaSession.project.id, "/").concat(this.opencgaSession.study.id) : "", tool.title, this.renderHTML(tool.description))));
  }

}
customElements.define("getting-started", getting_started_GettingStarted);
// CONCATENATED MODULE: ./src/opencga-breadcrumb.js
function opencga_breadcrumb_templateObject3() {
  const data = opencga_breadcrumb_taggedTemplateLiteral(["\n            <style>\n                .breadcrumb{\n                    padding-left: 40px;\n                }\n            </style>\n            <div>\n                <ol class=\"breadcrumb\">\n                    <li>\n                        <a href=\"#projects/", "\" data-category=\"", "\">", "</a></li>\n                    </li>\n                    ", "\n                </ol>\n            </div>\n        "]);

  opencga_breadcrumb_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_breadcrumb_templateObject2() {
  const data = opencga_breadcrumb_taggedTemplateLiteral(["\n                                <li class=\"active\">\n                                    null\n                                </li>"]);

  opencga_breadcrumb_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_breadcrumb_templateObject() {
  const data = opencga_breadcrumb_taggedTemplateLiteral(["\n                                <li>\n                                    <a href=\"#project/", "\" data-category=\"project\">", "</a>\n                                </li>\n                                <li class=\"active\">\n                                    ", "\n                                </li>"]);

  opencga_breadcrumb_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_breadcrumb_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

class opencga_breadcrumb_OpencgaBreadcrumb extends lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "bc-";
  }

  render() {
    let breadcrumHtml, projectAndStudy;

    if (this.opencgaSession.project && this.opencgaSession.project.id) {
      let studyId = this.opencgaSession.study ? this.opencgaSession.study.id : "null";
      projectAndStudy = this.opencgaSession.project.id + "/" + studyId;
      breadcrumHtml = lit_html_html(opencga_breadcrumb_templateObject(), projectAndStudy, this.opencgaSession.project.id, studyId);
    } else {
      projectAndStudy = "null";
      breadcrumHtml = lit_html_html(opencga_breadcrumb_templateObject2());
    }

    return lit_html_html(opencga_breadcrumb_templateObject3(), projectAndStudy, this.config.breadcrumb.title, this.config.breadcrumb.title, breadcrumHtml);
  }

}
customElements.define("opencga-breadcrumb", opencga_breadcrumb_OpencgaBreadcrumb);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/utils.js
/*
 * Copyright (c) 2012 Francisco Salavert (ICM-CIPF)
 * Copyright (c) 2012 Ruben Sanchez (ICM-CIPF)
 * Copyright (c) 2012 Ignacio Medina (ICM-CIPF)
 *
 * This file is part of JS Common Libs.
 *
 * JS Common Libs is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 2 of the License, or
 * (at your option) any later version.
 *
 * JS Common Libs is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with JS Common Libs. If not, see <http://www.gnu.org/licenses/>.
 */
/* harmony default export */ var utils = ({
  // properties
  characters: "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",
  months: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
  number: {
    sign(x) {
      return x ? x < 0 ? -1 : 1 : 0;
    }

  },
  images: {
    add: "data:image/gif;base64,R0lGODlhEAAQAIcAAD2GNUKNNkOPOESMO0WNPEmPP0iNQUmPQlOVTFWWTVCZQVeeRV6cVmGeWGSgVWSgV2aiWGejW2WrVWirU2uqWGqsW2yqWm61WG+1WG+1WXS3W3S3XHC4WXK5W3O6XHG+X3asZ3iuaHe8YHi0ZH+yany6ZH28Zn2+Z3m9bn25an25a3+5bUD/QHDBY3nBZHrGa3zDa37BaX7Hb4K1boO1boa3cYi4d4y7doq5eYm+eI2+e5O/f4HMdYbJeobJfIXNeYrCeY/CfYnIf4rPfZW/gozLgY7MhI7Sg5LFgJXAgpfHhZfMhZPNiJjLhpjMh5jMipvBl5vBmJTTipbTiZXUipbUi5fVi5nRi53YkqTOlKbPlqbQlqDZlaDZlqXbm6rUnavUnKbIoKfJoa/fpa/fprPZpbTZpbTaprLbqLPdqbXbqLfaqrTdqrXfrLbdrLjVr7jdr7vcr7rWsbfgr77itr3ktsTcuMXducXowMvmw87pydTrz9fu0tzx2ODy3P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAACwALAAAAAAQABAAAAi/AFkIHEiwoME7SWrMwCHH4MAdWfLs0QNnRQiHN+L4qeOlyxg8QCAU3LGmDxYmRqpQOTJHRYSBdpTw4SJFyJ8/P2DIaLNAjEAibsgU8YHiZgURHq4gaSCQBh0rPW5K/cMhxpcCAkmkGcJj6k0OJ8AMEGjjyZQXLSR85dBhiY4EAt9MYOPig4ivFzacEQBlIIgUaJByyIBBQxkLBwo6GKHGiYkSTcxQAODwgYIgW7TkCGDAocAwDAoQQBDFs2mCAQEAOw==",
    del: "data:image/gif;base64,R0lGODlhEAAQAIcAAED/QLpSNL9TOr5WOb5cQL9cQMFNM8RQNMBVPcBZP8xSPNBPPttWS9ddUcJnTMRkTMdrVM1gUc5iVMxmVclrVs1oWNZgVNZuZNtpZdxraN5ratxuadRxZd14c955dOZWTOZYTOZZTulZTelbT+ZWUOZaUuddWepcUOxfVOBlXO5mUuljW+pmXO5qXvBkVvNzXeNrYeNuY+FvcOJwZuJ7deR4ceJ5eeN4eeJ/feN/fOl7cOh6del/ePJ3Y/N5Y+qDfe6Efe+Gfu6KdfaCaPaEbPCFcPCDe/CMd/GOeviGcPiMdvCRf/eRfveTfvmSfvqTf/iUf9ymltynl+6Mge2Tju6Sj/SOgfqah/qdi/GclvGdluGpnvSgnvSinvWjn/qjkfupnPqrneGroOqwrOuzr/Ono/WmoferofarovWsofWvpfKtqvivpPS0qvi2qPm5r/q6rvC1tfC2tvjDvvzHuvnLxPnTzPzUzf3b1P3c2P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAMAAAAALAAAAAAQABAAAAi6AAEIHEiwoEE5ODRk8EDG4EAbVObYqdNmxgWHMtbkgfMFCxg6OiQUvFEGz5UlSKA4UeImRoWBcX7cwdJECJGbRHywWSBGYA41YY6gGEq0hxUeFARuePOkiJ6nUEW00IJAIIYzSYZAjcoiywCBHaYweSGirNkRRmg8EDiGARoXKsyKAFHCy4EoAznASIPihIgQH0h0sVCgYIQUZoKsMAGES4MADico2FGlSg0DBBwK3AIhgQAHUjSLJhgQADs=",
    enable: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAKfSURBVDjLpZPrS1NhHMf9O3bOdmwDCWREIYKEUHsVJBI7mg3FvCxL09290jZj2EyLMnJexkgpLbPUanNOberU5taUMnHZUULMvelCtWF0sW/n7MVMEiN64AsPD8/n83uucQDi/id/DBT4Dolypw/qsz0pTMbj/WHpiDgsdSUyUmeiPt2+V7SrIM+bSss8ySGdR4abQQv6lrui6VxsRonrGCS9VEjSQ9E7CtiqdOZ4UuTqnBHO1X7YXl6Daa4yGq7vWO1D40wVDtj4kWQbn94myPGkCDPdSesczE2sCZShwl8CzcwZ6NiUs6n2nYX99T1cnKqA2EKui6+TwphA5k4yqMayopU5mANV3lNQTBdCMVUA9VQh3GuDMHiVcLCS3J4jSLhCGmKCjBEx0xlshjXYhApfMZRP5CyYD+UkG08+xt+4wLVQZA1tzxthm2tEfD3JxARH7QkbD1ZuozaggdZbxK5kAIsf5qGaKMTY2lAU/rH5HW3PLsEwUYy+YCcERmIjJpDcpzb6l7th9KtQ69fi09ePUej9l7cx2DJbD7UrG3r3afQHOyCo+V3QQzE35pvQvnAZukk5zL5qRL59jsKbPzdheXoBZc4saFhBS6AO7V4zqCpiawuptwQG+UAa7Ct3UT0hh9p9EnXT5Vh6t4C22QaUDh6HwnECOmcO7K+6kW49DKqS2DrEZCtfuI+9GrNHg4fMHVSO5kE7nAPVkAxKBxcOzsajpS4Yh4ohUPPWKTUh3PaQEptIOr6BiJjcZXCwktaAGfrRIpwblqOV3YKdhfXOIvBLeREWpnd8ynsaSJoyESFphwTtfjN6X1jRO2+FxWtCWksqBApeiFIR9K6fiTpPiigDoadqCEag5YUFKl6Yrciw0VOlhOivv/Ff8wtn0KzlebrUYwAAAABJRU5ErkJggg==",
    warning: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAIsSURBVDjLpVNLSJQBEP7+h6uu62vLVAJDW1KQTMrINQ1vPQzq1GOpa9EppGOHLh0kCEKL7JBEhVCHihAsESyJiE4FWShGRmauu7KYiv6Pma+DGoFrBQ7MzGFmPr5vmDFIYj1mr1WYfrHPovA9VVOqbC7e/1rS9ZlrAVDYHig5WB0oPtBI0TNrUiC5yhP9jeF4X8NPcWfopoY48XT39PjjXeF0vWkZqOjd7LJYrmGasHPCCJbHwhS9/F8M4s8baid764Xi0Ilfp5voorpJfn2wwx/r3l77TwZUvR+qajXVn8PnvocYfXYH6k2ioOaCpaIdf11ivDcayyiMVudsOYqFb60gARJYHG9DbqQFmSVNjaO3K2NpAeK90ZCqtgcrjkP9aUCXp0moetDFEeRXnYCKXhm+uTW0CkBFu4JlxzZkFlbASz4CQGQVBFeEwZm8geyiMuRVntzsL3oXV+YMkvjRsydC1U+lhwZsWXgHb+oWVAEzIwvzyVlk5igsi7DymmHlHsFQR50rjl+981Jy1Fw6Gu0ObTtnU+cgs28AKgDiy+Awpj5OACBAhZ/qh2HOo6i+NeA73jUAML4/qWux8mt6NjW1w599CS9xb0mSEqQBEDAtwqALUmBaG5FV3oYPnTHMjAwetlWksyByaukxQg2wQ9FlccaK/OXA3/uAEUDp3rNIDQ1ctSk6kHh1/jRFoaL4M4snEMeD73gQx4M4PsT1IZ5AfYH68tZY7zv/ApRMY9mnuVMvAAAAAElFTkSuQmCC",
    edit: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAB80lEQVR42o2T30tTURzArb8ioiAI6kHoZeF7CGE/IISCUDNCqAeL3rIWPfSwByskYUEJIhSChBhJFAiNqMVYPqRuc4tcW3NLt3C7u3d3d3c/+nS+0GRK0134cC6c8/ncc+7ltgFt6jqgcCg6duGQYq84deoBR6lU0iqVSq1arfI/1Dxut3u0Htke6BC5UChgmuYm+XyeXC5HOp1GIsnQNJHJi3x/7WJh/CSLT9r7Rd4jAVlgWRa2bSOjYBgGmqaRyWQwkq9Y8wyhLb0BI0VuaRrfo671xoDIwmakWCyi6zrr36bILt/HXp1l7cNDioEZqnEvgYmr1paAOgYy1u/l3NrqHNngPWpFL8XodTa+3CD8YoCvz/o078i5o1sC29FT78kG7lCzfJgrl7ESvejLThLPuxk8fbhP3KaBVFCdeX7on9yP9bOHfPAu0bEzmKkg4jQNpEKzhOduqW1/xIoNUEpcQlM7WXl6Cj39Q9Y0D4Q/TRJ662Tx3WOS/guYsV42Fm4THe/G/B2T97Jz4OVwJ+hxImPn8Tj381k91TfShfErIvLuAde1Y9g+N7Z/FL/rBDODR8gmgpTL5To7B3o69zF8pR3Pg7PMT90kn47LJ22kaeCPghapidP4Lxy3bduUiVZktdaQH7AxcFAiUm0Rhzji/gUhbp0s2Zf2xwAAAABJRU5ErkJggg==",
    info: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAJ1SURBVHjafJJdSJNhFMd/z3QzLWdZrnQmSA2DPqRCK4KuhIq66kLoAy/qoqCguqqL6JsgLwoKKhCMSIy6CDKKRFZZYYQRVhJl02nWmG5uc19u7/vuPV0lW7QOnIsHnt+P8z/Pg4gw26aZ0263uzEUCn2IxWJjXq/3JqBETLIZ8gkePLhfKyKy/Z5HHJf7xe0Jic/n65mejizPK0inUiSTKUSE0dHRhxf6JoSDb4Rjr4QDz0REJBgMtmczFrJKKYVSCjCYnPR/W1FuAwQSGjbHXAA0LRXKZnIm0NJpgAKvd/hSOBz2iIj0eiPS2vtDYsmUPH/uPg9YshklIrOyCb+/eUG5ve3au5C99W2AqGbgKivk8R4X1lSkv2pJZaNmmBQVWWeZnAiGoa+3KovdyBjsW2kn/SvK4Jcgtaf7cDqrGkQMUDkBcgXVS2tOHjp8dG2jOXT1yo5lYOpgFTB0wKTAOqdQMlqOoDD7EE8kREwGXr/oWTg4HjxONAklBayuKSUeT/hFTxrwnwlAMa8I1qyrP3H95RiQgUiC/RsWM+wZ6jIME0M38wtSM0mmojM4nc6mzr5xKDQgnWb/pmoedT29EU3pTMUS+QVKKerq6kqnI3EVHwmAplO8qBh7WTFnzpz9bOg6FovlfxGEixfOrfT6YxCOQ1rDUaIAG4EJ38+PAwNb/95Bzj8ITAZwLHbMT0yHw3N33YVwEnQDqss41VzPkaalX6Iz+m6Xy/Xp34JAAICR7187nLWuvbe6h9C0DA2uRTTVV9J++87OlpaWJxUVFf9+xj+1cfOWls6OO93Nq1zblMVm9flG3pcvXNPm90+E/777ewB+UIqdqtYXHAAAAABJRU5ErkJggg==",
    //    bucket: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90BCg4hBcbCoOMAAABsSURBVDjLY2RgYFBjYGCIZCAPLGeBam4g0wAGJgYKARMDA8NZCvSfZYQy6sk0oJEFiUNqODRQLQxGDYCAb2To/YZswEsyDHiJbMAHMgz4gO6F5aTkQpgXYElZkoGBgZeEbL2cgYHhMwMDw3MA93ARk+mSg4gAAAAASUVORK5CYII=",
    bucket: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3QkQDC8RTstxRAAAAGBJREFUOMtjYBgswIWBgeE/idiFgYGBgRFqwH8GBoYGEi1tYGBgYGRBE9QjUvMlGANmgCsDA8NuElzRANXDwAQV2ENGuO1BNoBsMGoAlQ3wJTIdNEDVYgU+ROQBH6rmQgAWgB19xco60wAAAABJRU5ErkJggg==",
    //    dir: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsSAAALEgHS3X78AAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAKNJREFUeNrEk7sNwkAQBefQ5m6BTiAAQssZiMh0QFUIMrAEpKYD8ynAJeD4nXQEkJHgu4CXv9GsdteFEEjJgMQ4gPli+aWx227cLwAD8FK8QZ4XTyCL6B6qal+YlzLgCpSn87HpbTCdzAKwAkpg1Bdgn/nbmDLQmby6hC3W5qUGGEcCGpNUJwBq09tgHdO+Pe61eamNvIMLgEkaxuoDuL9/42sAM20/EZafbV8AAAAASUVORK5CYII=",
    dir: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDNzU0RUNBNzU3OEIxMUUyOEM3QzkxOEZDOTU1RTdFMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDNzU0RUNBODU3OEIxMUUyOEM3QzkxOEZDOTU1RTdFMCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkM3NTRFQ0E1NTc4QjExRTI4QzdDOTE4RkM5NTVFN0UwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkM3NTRFQ0E2NTc4QjExRTI4QzdDOTE4RkM5NTVFN0UwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+S/WxbAAAAERJREFUeNpi/P//PwMlgJFSA1g2bNiAzYQLQOwIxB8IGcCEQ9wAiPcDsQBBF+CRAxnynlwXEA1GDRg1gCqZiWIDAAIMADidE0PBoGsZAAAAAElFTkSuQmCC",
    r: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB90CDRIvNbHTpbwAAADjSURBVDjLpZFBbsIwEEUfVRZYahcVK3qKXoauMFK5C91nkyUB+xC5BqeAA7SKq1B5ugl2EiC04UkjayzN17NnROTRWvvJFbTWL8CBHqbGWOlSlqVkWSbGWAGm3aGHZiMiAByPP6FOd1rP2W7NvhvSCvDe10E+VJPFQpPnm1ZIcsmgPgJVVZGmaejX63y/XL4/AV/JJYPTCeDcN7PZWyuwKAqA8wARqSsGKDVGqXGjV8H07AnRQPq21TK8+YSBAQMN4hb6Df7wB/5eA+4zmEyehxk451itPrhFksSxUeP+lf+z+wXwdayJk/mqtgAAAABJRU5ErkJggg==",
    box: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wMHAwRAVvTmTAAAAK/SURBVDjLpZM9bFxFGEXPNzPvZ+39sb2xHceREjDQBwlDCqqIiiotokAghYKEjvSkQkKJkEiB0lOkoAHaBAokFCQKUATIIOLIMbHWrHfX+7zvvZk3MzQODUgU3PJK5+g2F/5n5N/Kb66/1NNK3hAxr4HcFqVuvfju18V/Cu58sPmMVnJZ4K32Qr+t8za+KnCz4kCUuiGibm5euTv5h+CL958/nxj1XivVF+e6C9TVhPmFdbROgEhwNU1d4m09UaJuInLjhct3DgDUh5ee7j14PLxulLvYP/0seadPkub88Wib0eB3bDkmxgbRoFPpxeCuKvjsyQIzOyqImT7/y8Mh++NveW7jLFmrx6m1NlWxz6PHA7otQ7tloAmYJE9isOeeCJRtIrULLLUTjsqG7+//xs72z7jZgCTNONlVJKEiuobW0jqSaoiet19dFQATJcc2FSFEciNoLYwOHcPDASvdjM5cQntxlbR9gqacoFSK84VsnOrkH11Zdmp0FFXjobSeCFgXSDS0Eo11ge7yGXSaU092UUlCaEpC8FK4tDcu4rzZ2a/S+bWI94HSAgFigDQD24Cvp4gIOp0juBJvC2L07B1Uc/Mtg9k7sHMbywZrA3lLECV4AtaCpAp79CcmzXHlhOBrAJrGyNbOVBY7qTO1C9r5EKyPSttAiJEs01SuQStFkrdp6gKd5AzHjixVxCDxp+1paZRUxoc4Kp36bndYbS53U5WlCq0CMYIPMY7GI0mNpiqmGK0oK4jIveGkPgRqfTBt3A8Pqtvrq52HtglnGh9XIaKUkCQ6nj6RyWBsmdXCtFI/bu2Fq5c+3roGzIAgWokCDNACOhfOLb781Ip+vd+RC2dXWibROkxKvvp1z376yZe7d4HpMdz8/YVjiQYyoA30Ti6la2++0n/n83vTW/e3ix1gcgzXgPchBoC/AFu/UBF5InryAAAAAElFTkSuQmCC",
    bluebox: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wMHAwTE5pcivoAAALsSURBVDjLXZPPaxxlGMc/77wz+3N2k822tWsTIrQFe/BWEKxKCV5UohdFhJ60p6rgUfpP6C0K4kHx0ENEkV7aElHwUikhFVosRGoTm83+3pnZnXfed2beHtItIQ98+Z6+H57nga8AsNYKDkYcEofcHvKZEEJYcSTszPzqL3fmf3+w/+a51tytby9d6D0N5UecGeBZ8MPv/jh9fy/6dKzMpVPHmvWdbl/XCvKn5Wbl6+ufrNwGssMgYa2VgFj58sZr7VB/LqX3zlKrydJzTTzXxdqcx90hO+0Bk2l8Z74i1z6+cOba5VfOqGeAb3579M/NR53T40xwrDGHFALPEUjn4LoMi0ktwWTKXqCIqAVrbyycvHj2hHYBR+bO8Q/Ov0imEzZ2xrRDRalQwC9LLBalUgaJQy+tU6gvIBJbv3j2RA4IFxDdICFa9ulMCrz/UgOs5kEwpeh57I4Nt/dzsmLOYlEThgFjUePp33IHoD9SJAbuTVyudRweixJvnVtg3/i00wpLPiwQ0hkO6YYKawWj0UjONqAfKHwDkxTqqeW/RHA3hO2+Zqk05e5wTD9KmOqMKDEUqoLNzU0PyF2AQaBoaIhiw0h6TIwgUDCODb5NiWJNlKREyhAozXwOW1tbFSmlcAHbD2KaytCdGgyWglfEs4LeNKeaa4axYRgpwlgTTTXVDDqdTslaewAYh4kNlKUbZsTGonOwCYwm1vq5Ft1AMYgU08SQR5o0gziOcRxHuoCNtdl6uPHX6/Vmi3Yyh9I5IoEgMdkgT9x+qJhEGrdQo77cJMuy+4DJskwLa60DOCtf3HhZpfZKtVx+L3x+sfCv8CFxTINd72HfodQ4aQp5fP24/v/Hd4Nf/5RSJmma6lkXZn1wPvvq5qndsbhS9esf/Zy/UEtzxnURfn8+/fuHV7m353mecV1XSym1lDI72kaxvr5e3N7eruyP0tpG/e3LK/rW2mLNUb7vm3K5nFarVdNqtbJer2dXV1fzJ6cDpboAZRAGAAAAAElFTkSuQmCC",
    refresh: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAK8AAACvABQqw0mAAAAAd0SU1FB90CFA8bKScXIjIAAAJ1SURBVDjLlVJdSJNRGH7es+/7NlduWFLTKAskwjJqZYiBglJhLKguqou6EFkFIkLQH9IPBFI3BsouzMJupGYRajcqmeBFhWBU5oUgpZikrSnzZ9v3nW/ndKEbziXUAwfOOe/7Puc9z/MCq1DwMmB1NX/rzfCNnsc/gK08lPgnnT8Cs33BULg0HI4YKdkHX9DqKwKArXXv1bTMTFcoyruC89E8MxaDw659t6rKhIUwRBLdP2t2v/5bBwQA+5pH8ibnIj3BucgWIQRASw8RERTGYFUtsGmWYUXKmqmr7t4UAnal54GQ8lq8MBlyOU0CEnA67MiwqfvHbhZ+Smgg6o9eV2L8Nhk6wI2lZeggrpvE+TTjxgxxQ4IbmJsJYSa00JQiotnguacJ8zIZOmDosAnzTpowt8tGj0s0ejZqprnDKmPHSNebjHDkUPatt4cTTbZ+LsmO79XK52dZxTNp9/ovAEDnaM62lo8HHrd9SVfiOelVryrSq9vrEx0s8sW2tuEzDgDgT875bcIsjy6owwAwHhjnYT5bGTL29PiHyuwAMO873aL/Ct5PiPjwXe5vq7KJW2hdJxENMFInGCkhIblLj80WRoyxGxZmh1XJGlSIlV8s6A8kuVDXn+MF6JHC7GBkBSNlOSRgiihMsQhAgJGGNNU1atc2HPG6O8YSBABwt2/nGyFlGSCSB4UIBMuyoQKMFNiUjIApRH5t8YfpFOOrO/JrhZBVUiJLxq2ipIkY8Z36uivpC6txqb3YbhqhIingFlLmxmLSKyXAGAaYqh13aFjfcHJwfE2ClSitK9psc85PMVC3M999orX4Kcf/wuPb27VW7A+O2QVVA1M1CQAAAABJRU5ErkJggg==",
    newitem: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAtxJREFUeNqM0llIVHEUBvDv3vlfZ8ac6zZtWpmamtliUUHRDlFJWlEYLdBLtG/QBlFJQUTSU089RZRlG4EvkS9NlqkpldHyYLk1OurcOzp30vHO/y6nBwsSIvzgvBw+fpyHA8MwwDmHbdsjQwSbCACkYDBYp6pqU3Fxcfyf/Z+eYRjQOQf+Bnw+30IiIsMwhizL4n3lV6mn7BzZtm1yzn8SETU0NKz+J2ARobe3t85/+SI1506j9hOHqTEO9FYEtR/ZTx/n5FDH6eOkquoni2g00NjUtEzTtBYioneLCulVHKg2yUkNmelUn5VOtUlueu0SqDE/m4iIIpFI64fm5vU65xAMIlicR9rOn/UEKytgmQbYuARAEDAqRLCiQxBFhtTNWzDzxk1LcjgkFhuKIhLR2qJKcN5Al/q7reF/cXUHoA0MtA9Gh4klJIxz6ro+PZiVC0uOw1jimJEDWZbTDhw8lCi0+/3PtUeV696ePIPUnIwxAf3fOjG/7AK8e/e9ZH2K0uWdPRdivANm3NguED1OJBYWQunvDwgAXIqifO54+CC7/tSxMQELL11B/r6D3cnJybniQDis25Ikfn1wD2GdQLIMISkF5JFhudwgjwySkyCkpILkRER0wpf7d2FJkqSoapQRRPCYjoLDR+EY70VXbS2YxCC4nAARbAAQBJBlwTIMZJRsQN7W7eA6t9O8XkE0jRhWLV2y+Gdm9q0dT6rMhLw8dPn7EAoEMBSLIcpjCPUEEPD3gU1Kw+6qZ6TPKrizq3TbAjUUIkFRVYAIkkfG99bWp4P1b7Z0vq5BXtFGPN6zE6Zuo7SiAh01PkycV4jJRRt96VOmrOHhMESHiBEAgMkNlGwqmXC78mG1DXtQdruTgx/eF5g6x9Tly1pCmtYjMSnxatnFTeXXyn8wxiCMAgxz5EmcTjCXCynxblf1C9910eFwrl254nh/dDhqcQ5zeBgAwBiDIAr4NQAWJarVjshqqgAAAABJRU5ErkJggg=="
  },

  // Methods

  /*formatNumber(position) {
      console.warn("formatNumber method is duplicated.");
      return position.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
  },*/
  formatText(text, spaceChar) {
    let _text = text.replace(new RegExp(spaceChar, "gi"), " ");

    _text = _text.charAt(0).toUpperCase() + _text.slice(1);
    return _text;
  },

  titleCase(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
  },

  camelCase(str) {
    return str.toLowerCase().replace(/[.-_\s](.)/g, (match, group1) => group1.toUpperCase());
  },

  camelToSpace(str) {
    const result = str.replace(/([A-Z])/g, " $1").toLowerCase().trim();
    return result.charAt(0).toUpperCase() + result.slice(1);
  },

  closest(element, selector) {
    const matches = element.matches ? "matches" : "msMatchesSelector";

    while (element) {
      if (element[matches](selector)) {
        break;
      }

      element = element.parentElement;
    }

    return element;
  },

  isFunction(s) {
    return typeof s === "function" || s instanceof Function;
  },

  parseDate(strDate) {
    return "".concat(strDate.substring(4, 6), "/").concat(strDate.substring(6, 8), "/").concat(strDate.substring(0, 4), " ").concat(strDate.substring(8, 10), ":").concat(strDate.substring(10, 12), ":").concat(strDate.substring(12, 14));
  },

  genId(prefix) {
    let _prefix = prefix || "";

    _prefix = prefix.length == 0 ? prefix : "".concat(prefix, "-");
    return _prefix + this.randomString(4) + this.getRandomInt(1000, 9999);
  },

  randomString(length) {
    const _length = length || 10;

    let str = "";

    for (let i = 0; i < _length; i++) {
      str += this.characters.charAt(this.getRandomInt(0, this.characters.length - 1));
    }

    return str;
  },

  getRandomInt(min, max) {
    // https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Math/random
    // Using Math.round() will give you a non-uniform distribution!
    return Math.floor(Math.random() * (max - min + 1)) + min;
  },

  endsWithIgnoreCase(str, test) {
    const regex = new RegExp("^.*\\.(".concat(test, ")$"), "i");
    return regex.test(str);
  },

  endsWith(str, test) {
    return str.length >= test.length && str.substr(str.length - test.length) == test;
  },

  addQueryParamtersToUrl(paramsWS, url) {
    let chr = "?";

    if (url.indexOf("?") != -1) {
      chr = "&";
    }

    let query = Utils.queryString(paramsWS);

    if (query !== "") {
      query = chr + query;
    }

    return url + query;
  },

  queryString(obj) {
    const items = [];

    for (const key in obj) {
      if (obj[key] != null && obj[key] != undefined) {
        items.push("".concat(key, "=").concat(encodeURIComponent(obj[key])));
      }
    }

    return items.join("&");
  },

  randomColor() {
    let color = "";

    for (let i = 0; i < 6; i++) {
      color += [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, "a", "b", "c", "d", "e", "f"][Math.floor(Math.random() * 16)];
    }

    return "#".concat(color);
  },

  colorLuminance(hex, lum) {
    // validate hex string
    let _hex = String(hex).replace(/[^0-9a-f]/gi, "");

    _hex = String(hex).replace(/#/gi, "");

    if (_hex.length < 6) {
      _hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
    }

    let _lum = lum || 0; // convert to decimal and change luminosity


    let rgb = "#";
    let c;
    let i;

    for (i = 0; i < 3; i++) {
      c = parseInt(hex.substr(i * 2, 2), 16);
      c = Math.round(Math.min(Math.max(0, c + c * _lum), 255)).toString(16);
      rgb += "00".concat(c).substr(c.length);
    }

    return rgb;
  },

  getSpeciesFromAvailable(availableSpecies, speciesCode) {
    for (const phylos in availableSpecies) {
      for (let i = 0; i < availableSpecies[phylos].length; i++) {
        const species = availableSpecies[phylos][i];

        if (species.id === speciesCode || species.scientificName.toLowerCase() === speciesCode.toLowerCase()) {
          return species;
        }
      }
    }

    return [];
  },

  getSpeciesCode(speciesName) {
    const pair = speciesName.split(" ");
    let code;

    if (pair.length < 3) {
      code = (pair[0].charAt(0) + pair[1]).toLowerCase();
    } else {
      code = (pair[0].charAt(0) + pair[1] + pair[pair.length - 1].replace(/[/_().\-]/g, "")).toLowerCase();
    }

    return code;
  },

  basicValidationForm(scope) {
    let validated = true;
    let msg = "";

    if (scope.$.outdir.selectedFile === undefined || scope.$.outdir.selectedFile.type != "FOLDER") {
      msg += "Error: Please select an output folder.\n";
      validated = false;
    }

    if (scope.$.inputFile.selectedFile === undefined || scope.$.inputFile.selectedFile.type != "FILE") {
      msg += "Error: Please select an input file.\n";
      validated = false;
    }

    if (scope.$.jobName.value === "") {
      msg += "Error: Please add a job name.\n";
      validated = false;
    }

    if (!validated) {
      alert(msg);
    }

    return validated;
  },

  getUrl(fileId) {
    return OpencgaManager.files.download({
      id: fileId,
      query: {
        sid: Cookies("bioinfo_sid")
      },
      request: {
        url: true
      }
    });
  },

  getFileContent(callback, fileId) {
    OpencgaManager.files.content({
      id: fileId,
      query: {
        sid: Cookies("bioinfo_sid")
      },
      request: {
        success(response) {
          callback(response);
        },

        error() {
          this.message = "Server error, try again later.";
        }

      }
    });
  },

  loadExampleFile(callback, toolName, exampleFileName) {
    const me = this;
    OpencgaManager.files.contentExample({
      query: {
        toolName,
        fileName: exampleFileName
      },
      request: {
        // method: 'POST',
        success(response) {
          callback(response); //                            debugger
          //                            me.loadedMainSelectChanged(false,true);
        },

        error() {
          console.log("utils.js223:Server error, try again later.");
        }

      }
    });
  },

  downloadExampleFile(toolName, fileName) {
    const url = OpencgaManager.files.downloadExample({
      query: {
        toolName,
        fileName
      },
      request: {
        url: true
      }
    });
    const link = document.createElement("a");
    link.href = url; // link.setAttribute("download", "download.zip");

    const event = new MouseEvent("click", {
      view: window,
      bubbles: true,
      cancelable: true
    });
    link.dispatchEvent(event);
  },

  argsParser(form, args) {
    if (form.toolName == args.tool) {
      for (const key in args) {
        if (typeof args[key] === "object") {
          if (form.$[key] !== undefined) {
            form.$[key].selectedFile = args[key];
          }
        } else {
          const elems = form.shadowRoot.querySelectorAll("input[name=\"".concat(key, "\"]"));

          if (form.$[key] !== undefined) {
            switch (form.$[key].type) {
              case "checkbox":
                form.$[key].checked = args[key];

              default:
                form.$[key].value = args[key];
            }
          }

          for (let i = 0; i < elems.length; i++) {
            const elem = elems[i];

            if (elem.value == args[key]) {
              elem.checked = true;
            }
          }
        }
      }
    }
  },

  getLinks(terms) {
    const links = [];

    for (let i = 0; i < terms.length; i++) {
      const term = terms[i];
      links.push(Utils.getLink(term));
    }

    return links;
  },

  getLink(term) {
    let link = "http://www.ebi.ac.uk/QuickGO/GTerm?id=";

    if (term.indexOf("(") >= 0) {
      var id = term.split("(");

      if (id.length > 1) {
        id = id[1];
      }

      id = id.split(")")[0];
    } else {
      id = term;
    }

    if (id.indexOf("IPR") == 0) {
      link = "http://www.ebi.ac.uk/interpro/entry/";
    }

    link += id;
    return link;
  },

  myRound(value, decimals) {
    const _decimals = typeof decimals !== "undefined" ? decimals : 2;

    let _value = parseFloat(value);
    /** rounding * */


    if (Math.abs(value) >= 1) {
      _value = value.toFixed(_decimals);
    } else {
      _value = value.toPrecision(_decimals);
    }

    _value = parseFloat(value);
    return _value;
  },

  formatNumber(value, decimals) {
    console.warn("formatNumber method is duplicated.");
    value = Utils.myRound(value, decimals);

    if (Math.abs(value) > 0 && Math.abs(value) < 0.001) {
      value = value.toExponential();
    }

    return value;
  },

  getSpecies(specieValue, species) {
    for (let i = 0; i < species.length; i++) {
      const specie = species[i];

      if (specie.value == specieValue) {
        return specie;
      }
    }

    return null;
  },

  test() {
    return this;
  },

  cancelFullscreen() {
    if (document.cancelFullScreen) {
      document.cancelFullScreen();
    } else if (document.mozCancelFullScreen) {
      document.mozCancelFullScreen();
    } else if (document.webkitCancelFullScreen) {
      document.webkitCancelFullScreen();
    }
  },

  launchFullScreen(element) {
    if (element.requestFullScreen) {
      element.requestFullScreen();
    } else if (element.mozRequestFullScreen) {
      element.mozRequestFullScreen();
    } else if (element.webkitRequestFullScreen) {
      element.webkitRequestFullScreen();
    }
  },

  parseJobCommand(item) {
    const commandObject = {};
    const commandArray = item.commandLine.split(/ -{1,2}/g);
    let tableHtml = "<table cellspacing=\"0\" style=\"max-width:400px;border-collapse: collapse;border:1px solid #ccc;\"><tbody>";
    tableHtml += "<tr style=\"border-collapse: collapse;border:1px solid #ccc;font-weight:bold;\">";
    tableHtml += "<td style=\"min-width:50px;border-collapse: collapse;border:1px solid #ccc;padding: 5px;background-color: whiteSmoke;\">Parameter</td>";
    tableHtml += "<td style=\"border-collapse: collapse;border:1px solid #ccc;padding: 5px;background-color: whiteSmoke;\">Value</td>";
    tableHtml += "</tr>";

    for (let i = 1; i < commandArray.length; i++) {
      // ignore first argument
      const paramenter = commandArray[i];
      const paramenterArray = paramenter.split(/ {1}/g);
      let name = "";
      let value = "";

      if (paramenterArray.length < 2) {
        name = paramenterArray[0];
        value = "<span color:darkgray;font-weight:bold;>This paramenter is a flag</span>";
      } else {
        name = paramenterArray[0];
        value = paramenterArray[1];
      }

      commandObject[name] = value;
      /* clean values for viz */

      value = value.replace(/\/httpd\/bioinfo\/opencga\/analysis\/.+\/examples\//, "");
      value = value.replace("/httpd/bioinfo/opencga/accounts/", "");
      value = value.replace(/,/g, ", ");
      tableHtml += "<tr style=\"border-collapse: collapse;border:1px solid #ccc;\">";
      tableHtml += "<td style=\"border-collapse: collapse;border:1px solid #ccc;padding: 5px;background-color: whiteSmoke;color:steelblue;font-weight:bold;white-space: nowrap;\">".concat(name, "</td>");
      tableHtml += "<td style=\"border-collapse: collapse;border:1px solid #ccc;padding: 5px;background-color: whiteSmoke;\">".concat(value, "</td>");
      tableHtml += "</tr>";
    }

    tableHtml += "</tbody></table>";
    return {
      html: tableHtml,
      data: commandObject
    };
  },

  htmlTable(object) {
    let tableHtml = "";
    tableHtml += "<table cellspacing=\"0\" style=\"border-collapse: collapse;border:1px solid #ccc;\"><tbody>";

    for (const key in object) {
      tableHtml += "<tr style=\"border-collapse: collapse;border:1px solid #ccc;\">";
      tableHtml += "<td style=\"border-collapse: collapse;border:1px solid #ccc;padding: 5px;background-color: whiteSmoke;color:steelblue;font-weight:bold;white-space: nowrap;\">".concat(key, "</td>");
      tableHtml += "<td style=\"border-collapse: collapse;border:1px solid #ccc;padding: 5px;background-color: whiteSmoke;\">".concat(object[key], "</td>");
      tableHtml += "</tr>";
    }

    tableHtml += "</tbody></table>";
    return tableHtml;
  },

  msg(title, msg) {
    let div = document.createElement("div");
    div.classList.add("jso-msg-hidden");
    const titleDiv = document.createElement("div");
    titleDiv.textContent = title;
    const msgDiv = document.createElement("div");
    msgDiv.textContent = msg;
    div.appendChild(titleDiv);
    div.appendChild(msgDiv);
    document.body.appendChild(div);
    div.addEventListener("click", () => {
      document.body.removeChild(div);
      div = null;
    });
    setTimeout(() => {
      div.classList.add("jso-msg-shown");
    }, 10);
    setTimeout(() => {
      if (div) {
        div.classList.remove("jso-msg-shown");
      }
    }, 4000);
    setTimeout(() => {
      if (div) {
        document.body.removeChild(div);
        div = null;
      }
    }, 4400);
  },

  repeat(string, count) {
    if (string == null) {
      throw new TypeError("can't convert ".concat(string, " to object"));
    }

    let str = "".concat(string);
    count = +count;

    if (count != count) {
      count = 0;
    }

    if (count < 0) {
      throw new RangeError("repeat count must be non-negative");
    }

    if (count == Infinity) {
      throw new RangeError("repeat count must be less than infinity");
    }

    count = Math.floor(count);

    if (str.length == 0 || count == 0) {
      return "";
    } // Ensuring count is a 31-bit integer allows us to heavily optimize the
    // main part. But anyway, most current (august 2014) browsers can't handle
    // strings 1 << 28 chars or longer, so:


    if (str.length * count >= 1 << 28) {
      throw new RangeError("repeat count must not overflow maximum string size");
    }

    let rpt = "";

    for (;;) {
      if ((count & 1) == 1) {
        rpt += str;
      }

      count >>>= 1;

      if (count == 0) {
        break;
      }

      str += str;
    }

    return rpt;
  },

  clone(obj) {
    return JSON.parse(JSON.stringify(obj));
  },

  timeDiff(timeStart, timeEnd) {
    const ts = new Date(Date.parse(timeStart));
    const te = new Date(Date.parse(timeEnd));

    if (isNaN(ts) || isNaN(te)) {
      return "";
    }

    let milisecDiff = 0;

    if (ts < te) {
      milisecDiff = te - ts;
    } else {
      milisecDiff = ts - te;
    }

    const days = Math.floor(milisecDiff / 1000 / 60 / (60 * 24));
    let daysMessage = "".concat(days, " Days ");

    if (days === 0) {
      daysMessage = "";
    }

    const dateDiff = new Date(milisecDiff);
    const hours = dateDiff.getHours() - 1;
    let hoursMessage = "".concat(hours, " hour");
    let minutesMessage = "".concat(dateDiff.getMinutes(), " minute");
    let secondsMessage = "".concat(dateDiff.getSeconds(), " second");

    if (hours !== 1) {
      hoursMessage += "s ";
    } else {
      hoursMessage += " ";
    }

    if (dateDiff.getMinutes() !== 1) {
      minutesMessage += "s ";
    } else {
      minutesMessage += " ";
    }

    if (dateDiff.getSeconds() !== 1) {
      secondsMessage += "s ";
    } else {
      secondsMessage += " ";
    }

    if (hours === 0) {
      hoursMessage = "";
    }

    if (dateDiff.getMinutes() === 0) {
      minutesMessage = "";
    }

    if (dateDiff.getSeconds() === 0) {
      secondsMessage = "";
    }

    return daysMessage + hoursMessage + minutesMessage + secondsMessage;
  },

  deleteIndexedDB() {
    window.indexedDB.webkitGetDatabaseNames().onsuccess = function (sender, args) {
      const r = sender.target.result;

      for (const i in r) {
        indexedDB.deleteDatabase(r[i]);
      }
    };
  },

  subsetArray(array, from, to) {
    const aux = [];
    from = from < 0 ? 0 : from;
    to = to >= array.length ? array.length : to;

    for (let i = from; i < to; i++) {
      aux.push(array[i]);
    }

    return aux;
  },

  applyFunctionBatch(array, batchsize, callback) {
    let end = batchsize;
    let auxArray = this.subsetArray(array, 0, end);

    while (auxArray.length > 0) {
      callback(auxArray);
      auxArray = this.subsetArray(array, end, end + batchsize);
      end += batchsize;
    }
  }

});
// CONCATENATED MODULE: ./src/category-page.js
function category_page_templateObject4() {
  const data = category_page_taggedTemplateLiteral(["\n                    <a href=\"#", "\" class=\"shadow-lg item\">\n                            <div class=\"title uppercase\">", "</div>                    \n                            <div class=\"text-icon ", "\">\n                                ", "\n                                <!--<img src=\"img/tools/icons/", "\" /> -->\n                            </div>\n                            <div class=\"description\">", "</div>                    \n                    </a>\n            "]);

  category_page_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function category_page_templateObject3() {
  const data = category_page_taggedTemplateLiteral(["\n                    <a  class=\"shadow-lg item ", "\">\n                    <div class=\"lock-overlay\">\n                        <i class=\"fas fa-4x fa-lock\"></i>\n                    </div>\n                        <div class=\"title uppercase\">", "</div>                    \n                            <div class=\"text-icon ", "\">\n                                ", "\n                                <!--<img src=\"img/tools/icons/", "\" /> -->\n                            </div>\n                            <div class=\"description\">", "</div>\n                    \n                                                \n                    </a>"]);

  category_page_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function category_page_templateObject2() {
  const data = category_page_taggedTemplateLiteral(["\n                <div class=\"section-title\">", "</div>\n                "]);

  category_page_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function category_page_templateObject() {
  const data = category_page_taggedTemplateLiteral(["\n        <style>\n            #category-page {\n                display: grid;\n                grid-template-columns: repeat( auto-fit, 25% );\n                grid-gap: 10px;\n                padding: 10px;\n            }\n            #category-page > a.item{\n                padding: 10px;\n                display: block;\n                color: #333;\n                position: relative;\n            }\n            \n            #category-page > a.item:hover{\n                text-decoration: none;\n            }\n\n        \n            #category-page .icon {\n                width: 100px;\n                vertical-align: bottom;\n            }\n            \n            #category-page .description {\n                padding: 10px\n            }\n            \n            #category-page .section-title {\n                grid-column: 1 / span 4;\n                font-size: 2.5em;\n                font-variant: all-small-caps;\n                font-weight: 500;\n                letter-spacing: 5px;\n                margin-top: 1em;\n                color: #000966;\n                font-family: \"Roboto\",serif;\n            }\n            \n            #category-page .lock-overlay {            \n                position: absolute;\n                background-image: linear-gradient(45deg, #4d4d4d80 25%, #47474780 25%, #47474780 50%, #4d4d4d80 50%, #4d4d4d80 75%, #47474780 75%, #47474780 100%);\n                background-size: 40px 40px;\n                width: 100%;\n                height: 100%;\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                margin: -10px;\n            }\n        </style>\n\n        <h1>", "</h1>\n        <div id=\"category-page\">\n            ", "\n        </div>\n        "]);

  category_page_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function category_page_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



class category_page_CategoryPage extends lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "sf-" + utils.randomString(6) + "_";
  }

  updated(changedProperties) {
    if (changedProperties.has("property")) {
      this.propertyObserver();
    }
  }

  isVisible(item) {
    switch (item.visibility) {
      case "public":
        return true;

      case "private":
        return utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotEmpty(this.opencgaSession.token);

      case "none":
      default:
        return false;
    }
  }

  renderHTML(html) {
    return document.createRange().createContextualFragment("".concat(html));
  }

  render() {
    return lit_html_html(category_page_templateObject(), this.config.title, this.config.submenu && this.config.submenu.length ? this.config.submenu.map((item, i) => item.category ? lit_html_html(category_page_templateObject2(), item.title) : item.separator ? null : item.disabled ? lit_html_html(category_page_templateObject3(), item.disabled ? "disabled" : "", item.title, i % 2 === 0 ? "green" : i % 3 === 0 ? "red" : "", item.acronym ? item.acronym : item.title[0] + item.title[1] + item.title[2].toLowerCase(), item.icon || "variant_browser.svg", this.renderHTML(item.description || "Lorem ipsom sic dolor")) : lit_html_html(category_page_templateObject4(), item.id, item.title, i % 2 === 0 ? "green" : i % 3 === 0 ? "red" : "", item.acronym ? item.acronym : item.title[0] + item.title[1] + item.title[2].toLowerCase(), item.icon || "variant_browser.svg", this.renderHTML(item.description || "Lorem ipsom sic dolor"))) : null);
  }

}
customElements.define("category-page", category_page_CategoryPage);
// CONCATENATED MODULE: ./src/iva-profile.js
function iva_profile_templateObject() {
  const data = iva_profile_taggedTemplateLiteral(["\n        <div>\n            <h1>Profile</h1>\n        </div>\n        "]);

  iva_profile_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function iva_profile_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

class iva_profile_IvaProfile extends lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      cellbaseClient: {
        type: Object
      },
      query: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "p-";
  }

  updated(changedProperties) {
    if (changedProperties.has("property")) {
      this.propertyObserver();
    }
  }

  render() {
    return lit_html_html(iva_profile_templateObject());
  }

}
customElements.define("iva-profile", iva_profile_IvaProfile);
// CONCATENATED MODULE: ./src/iva-settings.js
function iva_settings_templateObject() {
  const data = iva_settings_taggedTemplateLiteral(["\n        <div>\n            <h1>Settings</h1>\n        </div>\n        "]);

  iva_settings_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function iva_settings_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

class iva_settings_IvaSettings extends lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      cellbaseClient: {
        type: Object
      },
      query: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "s-";
  }

  updated(changedProperties) {
    if (changedProperties.has("property")) {
      this.propertyObserver();
    }
  }

  render() {
    return lit_html_html(iva_settings_templateObject());
  }

}
customElements.define("iva-settings", iva_settings_IvaSettings);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/RestResponse.js
/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * This class models the response of a RESTful call in OpenCGA.
 */
class RestResponse {
  /**
   * @param {Object} response The response object
   * @throw {Error} in case of wrong structure
   */
  constructor(response) {
    this.getResults = (responsePos = 0) => this.responses[responsePos].results;

    this.getResult = (resultPos, responsePos = 0) => this.responses[responsePos].results[resultPos];

    this.getResponses = () => this.responses;

    this.getResponse = (responsePos = 0) => this.responses[responsePos];

    this.getParams = () => this.params;

    this.getNumMatches = responsePos => this.count("numMatches", responsePos);

    this.getNumResults = responsePos => this.count("numResults", responsePos);

    this.getNumInserted = responsePos => this.count("numInserted", responsePos);

    this.getNumUpdated = responsePos => this.count("numUpdated", responsePos);

    this.getNumDeleted = responsePos => this.count("numDeleted", responsePos);

    try {
      // console.log("REST response", response)
      this.apiVersion = response.apiVersion;
      this.time = response.time;
      this.events = response.events;
      this.params = response.params;
      this.responses = response.responses || response.response; // TODO This is a small hack that can be activated if backward compatibility is needed. This should be removed in next 2.1.

      this.params = this.queryOptions = response.params || response.queryOptions;
      this.response = [];
      this.responses.forEach((response, i) => {
        this.response[i] = response;

        if (response.results) {
          this.response[i].result = response.results;
          if (response.time !== undefined) this.response[i].dbTime = response.time;
          if (response.numMatches !== undefined) this.response[i].numTotalResults = response.numMatches;
        } else {
          this.response[i].results = response.result;
        }
      });
    } catch (e) {
      console.error(e);
      console.log("Response", response);
      throw new Error("Unexpected response format");
    }
  }
  /**
   * Return the list of results of the responsePos response.
   * @param {Number} [responsePos=0] The index of the node to get the results from
   * @return {Array} The list of results
   **/


  /**
   *  Return all results out of all responses (or from a single node in case 'responsePos' is defined) in form of Iterator
   * @param {Number} responsePos The index of the response
   *  Consumer-side usage examples:
   *  <pre><code>
   *      for (let a of responseInstance.resultIterator()) {
   *          console.log(a)
   *      }
   * </code></pre>
   *      let a, it = responseInstance.resultIterator();
   *      while(!(a = it.next()).done) {
   *          console.log(a)
   *      }
   *
   * console.log(...responseInstance.resultIterator())
   *
   */
  *resultIterator(responsePos) {
    if (responsePos) {
      for (const result of this.responses[responsePos].results) {
        yield result;
      }
    } else {
      for (const response of this.responses) {
        for (const result of response.results) {
          yield result;
        }
      }
    }
  }
  /**
   * Utility function. It maps a result object in the way the param 'fields' defines. Nested properties needs to be defined in dot notation.
   * Consumer-side usage:
   * 1. Accessing the fields 'id', 'name' and 'scientificName' in 'organism'
   *      responseInstance.transformResults("id,name,organism.scientificName")
   *
   * 2. Accessing the fields 'id' and the first 'id' of the array 'studies' in the second node only
   *      responseInstance.transformResults("id,studies.0.id", 1)
   *
   * @param {String} fields The properties of interest
   * @param {Number} responsePos The node index
   * @return {Array} List of mapped result objects
   */


  transformResults(fields, responsePos = 0) {
    /**
     * @param {Object} result Single result Object
     * @param {String} field Field to retrieve in dot notation
     * @return {Object}
     */
    const getField = (result, field) => field.split(".").reduce((o, i) => o ? o[i] : o, result);

    return this.responses[responsePos].result.map(result => {
      return Object.assign({}, ...fields.split(",").map(field => ({
        [field]: getField(result, field)
      })));
    });
  }
  /**
   * @param {string} [eventType] The type of the event to be retrieved
   * @return {Object | Array} The retrieved event object or the list of events in case of no eventType defined.
   */


  getEvents(eventType) {
    const eventNames = ["INFO", "WARNING", "ERROR"];

    if (!eventType || !this.events.length) {
      return this.events || [];
    } else if (eventNames.includes(eventType)) {
      return this.events.find(event => event.type === eventType);
    } else {
      throw new Error("Argument \"eventType\" must be one of the following values: \"".concat(eventNames.join(", "), "\""));
    }
  }
  /**
   * @param {String} eventType The type of the event to retieve
   * @param {Number} [responsePos = 0] The node index
   * @return {Array} The list of the events
   * @throw {Error} in case of the param "eventType" is not a valid value
   */


  getResultEvents(eventType, responsePos = 0) {
    const eventNames = ["INFO", "WARNING", "ERROR"];

    if (!eventType) {
      return this.responses[responsePos].events || [];
    } else if (eventNames.includes(eventType)) {
      return this.responses[responsePos].events ? this.responses[responsePos].events.filter(event => event.type === eventType) : [];
    } else {
      throw new Error("Argument \"eventType\" must be one of the following values: \"".concat(eventNames.join(", "), "\""));
    }
  }
  /**
   * Computes the sum for the given property. If 'responsePos' param is provided it counts on that node, it counts in all nodes otherwise.
   * @param {String} attribute The attribute to count
   * @param {Number} [responsePos] The node index
   * @return {Number} The total number
   */


  count(attribute, responsePos) {
    if (responsePos) {
      return this.responses[responsePos][attribute];
    } else {
      return this.responses.reduce((acc, curr) => acc + curr[attribute]);
    }
  }
  /**
   * @param {Number} [responsePos] The node index
   * @return {Number} The total number of matches
   */


} // module.exports = exports = RestResponse;
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/rest-client-xmlhttp.js

class rest_client_xmlhttp_RestClientXmlhttp {
  static callXmlhttp(url, options) {
    let method = options.method || "GET";
    let async = options.async;
    let dataResponse = null;
    console.time("AJAX call to CellBase");
    let request = new XMLHttpRequest();

    request.onload = function (event) {
      console.log("CellBaseClient: call to URL succeed: '".concat(url, "'"));
      let contentType = this.getResponseHeader("Content-Type");

      if (contentType === "application/json") {
        dataResponse = JSON.parse(this.response);

        if (typeof options !== "undefined" && typeof options.cacheFn === "function") {
          options.cacheFn(dataResponse);
        } // If the call is OK then we execute the success function from the user
        // console.log(options)


        if (typeof options !== "undefined" && typeof options.success === "function" && typeof options.cacheFn === "undefined") {
          options.success(dataResponse);
        }

        console.timeEnd("AJAX call to CellBase");
        console.log(options, "Size: ".concat(event.total, " Bytes"));
      } else {
        console.log(this.response);
      }
    };

    request.onerror = function (event) {
      // console.log(event)
      console.error("CellBaseClient: an error occurred when calling to '".concat(url, "'"));

      if (typeof options.error === "function") {
        options.error(this);
      }
    };

    request.ontimeout = function (event) {
      console.error("CellBaseClient: a timeout occurred when calling to '".concat(url, "'"));

      if (typeof options.error === "function") {
        options.error(this);
      }
    };

    request.open(method, url, async);

    if (typeof options !== "undefined" && options.hasOwnProperty("sid")) {
      request.setRequestHeader("Authorization", "Bearer ".concat(options["sid"]));
    } // request.timeout = options.timeout || 0;


    request.send();
    return dataResponse;
  }

  static call(url, options) {
    console.log("REMOTE", url, options);
    let method = "GET";
    let async = true;

    if (typeof options !== "undefined") {
      method = options.method || "GET";
      async = options.async || true;
    }

    let dataResponse = null;
    console.time("REST call to ".concat(url)); // Creating the promise

    return new Promise(function (resolve, reject) {
      let request = new XMLHttpRequest();

      request.onload = function (event) {
        if (request.status === 200) {
          let contentType = this.getResponseHeader("Content-Type"); // indexOf() is used because sometimes the contentType is 'application/json;charset=utf-8'

          if (contentType.indexOf("application/json") != -1) {
            dataResponse = JSON.parse(this.response);

            if (typeof options !== "undefined" && typeof options.cacheFn === "function") {
              options.cacheFn(dataResponse);
            } // If the call is OK then we execute the success function from the user


            if (typeof options !== "undefined" && typeof options.success === "function" && typeof options.cacheFn === "undefined") {
              options.success(dataResponse);
            }

            console.timeEnd("REST call to ".concat(url));
            resolve(new RestResponse(dataResponse));
          } else if (contentType.startsWith("text/plain")) {
            resolve(this.response);
          } else if (contentType.startsWith("application/octet-stream")) {
            resolve(this.response);
          } else {
            console.log("Result is not JSON: ".concat(this.response));
          }
        } else {
          console.error("REST call to URL failed: '".concat(url, "'"));
          reject(JSON.parse(request.response));
        }
      };

      request.onerror = function (event) {
        console.error("CellBaseClient: an error occurred when calling to '".concat(url, "'"));

        if (typeof options.error === "function") {
          options.error(this);
        }

        reject(Error("CellBaseClient: an error occurred when calling to '".concat(url, "'")));
      };

      request.ontimeout = function (event) {
        console.error("CellBaseClient: a timeout occurred when calling to '".concat(url, "'"));

        if (typeof options.error === "function") {
          options.error(this);
        }
      };

      console.log("CALL [method, url, options]", method, url, options);
      request.open(method, url, async);

      if (typeof options !== "undefined" && options.hasOwnProperty("sid")) {
        request.setRequestHeader("Authorization", "Bearer ".concat(options["sid"]));
      } // request.timeout = options.timeout || 0;


      if (method === "POST" && options !== undefined && options.hasOwnProperty("data")) {
        if (options.hasOwnProperty("post-method") && options["post-method"] === "form") {
          let myForm = new FormData();
          let keys = Object.keys(options.data);

          for (let i in keys) {
            myForm.append(keys[i], options.data[keys[i]]);
          }

          request.send(myForm);
        } else {
          // request.setRequestHeader("Access-Control-Allow-Origin", "*");
          // // request.setRequestHeader("Access-Control-Allow-Credentials", "true");
          // request.setRequestHeader("Access-Control-Allow-Methods", "GET, POST, OPTIONS");
          request.setRequestHeader("Content-type", "application/json");
          request.send(JSON.stringify(options.data));
        }
      } else {
        request.send();
      }
    });
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/rest-client-axios.js
function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
// node.js env
if (typeof window === "undefined") {
  axios = __webpack_require__(9);
}
/**
 * This is the new version of rest-client.
 */
// TODO use shared observable pattern (in order to avoid repeated calls)


class RestClientAxios {
  // timeout = 0;
  static encodeObject(obj) {
    Object.entries(obj).map(([k, v]) => {
      return "".concat(encodeURIComponent(k), "=").concat(encodeURIComponent(v));
    }).join("&");
  }

  static async _get(url, options = {}) {
    try {
      console.log("_GET", url, options);
      const response = await axios.get(url, {
        url: url,
        // method: "GET",
        headers: {
          "Authorization": "Bearer ".concat(options.token),
          "Content-Type": "application/json;charset=UTF-8",
          "Access-Control-Allow-Origin": "*"
        }
      });
      console.log("response _GET", response);
    } catch (e) {
      console.error(e);
    }
  }

  static async call(url, options = {}) {
    try {
      // console.log("URL", url, "OPTIONS", options)
      // in case of authentication header
      const auth = options && options.sid ? {
        Authorization: "Bearer ".concat(options.sid)
      } : null; // in case of formData

      let reqContentType = {
        "Content-Type": "application/json"
      };

      if (options && options["post-method"] === "form") {
        const formData = new URLSearchParams();

        for (const [k, v] in Object.entries(options.data)) {
          formData.append(k, v);
        }

        reqContentType = {
          "content-type": "application/x-www-form-urlencoded"
        };
      } // in case of GET request with params


      console.log(options);
      const queryString = options && options.data && (!options.method || options.method === "GET") ? "?".concat(this.encodeObject(options.data)) : "";
      console.time("REST call to ".concat(url));
      console.log("PARAMS", _objectSpread({
        url: url + queryString,
        // method: "GET",
        headers: _objectSpread({
          auth
        }, reqContentType),
        auth
      }, options));
      const response = await axios.request(_objectSpread({
        url: url + queryString,
        // method: "GET",
        headers: _objectSpread({
          auth
        }, reqContentType),
        auth
      }, options));
      const contentType = response.headers["content-type"];

      if (["application/json", "text/plain", "application/octet-stream"].includes(contentType)) {
        if (options && typeof options.cacheFn === "function") {
          options.cacheFn(response);
        } // If the call is OK then we execute the success function from the user
        // TODO check if we really need it


        if (options && typeof options.success === "function") {
          options.success(response);
        }

        console.timeEnd("REST call to ".concat(url));
        return response.data;
      } else {
        console.error("Result format unexpected ", response);
      }
    } catch (e) {
      return e;
    }
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/rest-client.js



// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/opencga-parent-class.js
function opencga_parent_class_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_parent_class_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_parent_class_ownKeys(Object(source), true).forEach(function (key) { opencga_parent_class_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_parent_class_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_parent_class_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

// parent class

class opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    this._config = config; // this.token = null;
  }

  _post(category, ids, category2, ids2, action, body, params) {
    return this.extendedPost(category, ids, category2, ids2, action, params, body);
  }

  _get(category, ids, category2, ids2, action, params) {
    return this.extendedGet(category, ids, category2, ids2, action, params);
  } // TODO


  _delete(category, ids, category2, ids2, action, params) {
    return this.__delete(category, ids, category2, ids2, action, params);
  }

  post(category, ids, action, params, body, options) {
    return this.extendedPost(category, ids, null, null, action, params, body, options);
  }

  extendedPost(category1, ids1, category2, ids2, action, params = {}, body, options = {}) {
    const host = this._config.host;
    const version = this._config.version;
    const rpc = this._config.mode;

    const _options = opencga_parent_class_objectSpread({}, options, {
      method: "POST"
    });

    if (this._config.token) {
      _options.sid = this._config.token;
      _options.token = this._config.token;
    }

    const _params = opencga_parent_class_objectSpread({}, params, {
      body: body
    });

    if (rpc.toLowerCase() === "rest") {
      let url = this._createRestUrl(host, version, category1, ids1, category2, ids2, action);

      url = this._addQueryParams(url, _params);
      _options.data = _params.body;

      if (action === "upload") {
        _options["post-method"] = "form";
      } // console.log(`OpenCGA client calling to ${url}`);
      // if the URL query fails we try with next host


      return rest_client_xmlhttp_RestClientXmlhttp.call(url, _options);
    } else {
      console.error("rpc NON-REST");
    }
  }

  get(category, ids, action, params, options) {
    return this.extendedGet(category, ids, null, null, action, params, options);
  }

  extendedGet(category1, ids1, category2, ids2, action, params, options) {
    // we store the options from the parameter or from the default values in config
    const host = this._config.host;
    const version = this._config.version;
    const rpc = this._config.mode;
    let method = "GET";
    let _options = options;

    if (typeof _options === "undefined") {
      _options = {};
    }

    if (_options.hasOwnProperty("method")) {
      method = _options.method;
    }

    let _params = params;

    if (_params === undefined || _params === null || _params === "") {
      _params = {};
    } // Check that sessionId is being given


    if (!_params.hasOwnProperty("sid")) {
      const sid = this._getSessionId();

      if (typeof sid !== "undefined") {
        _options.sid = sid;
        _options.token = sid;
      }
    } // If category == users and userId is not given, we try to set it


    if (category1 === "users" && (ids1 === undefined || ids1 === null || ids1 === "")) {
      ids1 = this._getUserId();
    }

    if (rpc.toLowerCase() === "rest") {
      let url = this._createRestUrl(host, version, category1, ids1, category2, ids2, action); // if (method === "GET") {


      url = this._addQueryParams(url, _params);

      if (method === "POST") {
        _options.data = _params.body;

        if (action === "upload") {
          _options["post-method"] = "form";
        }
      } // console.log(`OpenCGA client calling to ${url}`);
      // if the URL query fails we try with next host


      return rest_client_xmlhttp_RestClientXmlhttp.call(url, _options);
    }
  }

  _createRestUrl(host, version, category1, ids1, category2, ids2, action) {
    let url = host + "/webservices/rest/".concat(version, "/").concat(category1, "/"); // By default we assume https protocol instead of http

    if (!url.startsWith("https://") && !url.startsWith("http://")) {
      url = "https://".concat(host, "/webservices/rest/").concat(version, "/").concat(category1, "/");
    } // Some web services do not need IDs


    if (typeof ids1 !== "undefined" && ids1 !== null) {
      url += "".concat(ids1, "/");
    } // Some web services do not need a second category


    if (typeof category2 !== "undefined" && category2 !== null) {
      url += "".concat(category2, "/");
    } // Some web services do not need the second category of ids


    if (typeof ids2 !== "undefined" && ids2 !== null && ids2 !== "") {
      url += "".concat(ids2, "/");
    }

    url += action;
    return url;
  }

  _addQueryParams(url, params) {
    // We add the query params formatted in URL
    const queryParamsUrl = this._createQueryParam(params);

    let _url = url;

    if (typeof queryParamsUrl !== "undefined" && queryParamsUrl !== null && queryParamsUrl !== "") {
      _url += "?".concat(queryParamsUrl);
    }

    return _url;
  }

  _createQueryParam(params) {
    // Do not remove the sort! we need to sort the array to ensure that the key of the cache will be correct
    const keyArray = _.keys(params);

    const keyValueArray = [];

    for (const i in keyArray) {
      // Whatever it is inside body will be sent hidden via POST
      if (keyArray[i] !== "body") {
        keyValueArray.push("".concat(keyArray[i], "=").concat(encodeURIComponent(params[keyArray[i]])));
      }
    }

    return keyValueArray.join("&");
  }

  _getUserId() {
    this._config.userId;
  }

  _getSessionId() {
    return this._config.token;
  }

  setToken(token) {
    // this.token = token;
    this._config.token = token;
  }

  getToken() {
    return this._config.token;
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/api/Admin.js
function Admin_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function Admin_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { Admin_ownKeys(Object(source), true).forEach(function (key) { Admin_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { Admin_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function Admin_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2020 OpenCB
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * WARNING: AUTOGENERATED CODE
 *
 * This code was generated by a tool.
 * Autogenerated on: 2020-02-27 10:51:26
 *
 * Manual changes to this file may cause unexpected behavior in your application.
 * Manual changes to this file will be overwritten if the code is regenerated.
 *
**/

/**
 * This class contains the methods for the "Admin" resource
 */

class Admin_Admin extends opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    super(config);
  }
  /** Group by operation
  * @param {String} fields - Comma separated list of fields by which to group by.
  * @param {String} entity - Entity to be grouped by.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {Boolean} [params.count] - Count the number of elements matching the group.
  * @param {Number} [params.limit = "50"] - Maximum number of documents (groups) to be returned. The default value is 50.
  * @param {String} [params.action] - Action performed.
  * @param {String} [params.before] - Object before update.
  * @param {String} [params.after] - Object after update.
  * @param {String} [params.date] - Date <,<=,>,>=(Format: yyyyMMddHHmmss) and yyyyMMddHHmmss-yyyyMMddHHmmss.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  groupByAudit(fields, entity, params) {
    return this._get("admin", null, "audit", null, "groupBy", Admin_objectSpread({
      fields,
      entity
    }, params));
  }
  /** Sync Catalog into the Solr
  *
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  indexStatsCatalog() {
    return this._post("admin", null, "catalog", null, "indexStats");
  }
  /** Install OpenCGA database
  * @param {Object} data - JSON containing the mandatory parameters.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  installCatalog(data) {
    return this._post("admin", null, "catalog", null, "install", data);
  }
  /** Change JWT secret key
  * @param {Object} data - JSON containing the parameters.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  jwtCatalog(data) {
    return this._post("admin", null, "catalog", null, "jwt", data);
  }
  /** Handle global panels
  * @param {Object} [data] - Panel parameters to be installed.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {Boolean} [params.panelApp = "false"] - Import panels from PanelApp (GEL). The default value is false.
  * @param {Boolean} [params.overwrite = "false"] - Flag indicating to overwrite installed panels in case of an ID conflict. The default
  *     value is false.
  * @param {String} [params.delete] - Comma separated list of global panel ids to delete.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  panelCatalog(data, params) {
    return this._post("admin", null, "catalog", null, "panel", data, params);
  }
  /** Create a new user
  * @param {Object} data - JSON containing the parameters.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  createUsers(data) {
    return this._post("admin", null, "users", null, "create", data);
  }
  /** Import users or a group of users from LDAP or AAD
  * @param {Object} data - JSON containing the parameters.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  importUsers(data) {
    return this._post("admin", null, "users", null, "import", data);
  }
  /** Synchronise groups of users with LDAP groups
  * @param {Object} data - JSON containing the parameters.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  syncUsers(data) {
    return this._post("admin", null, "users", null, "sync", data);
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/api/Alignment.js
function Alignment_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function Alignment_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { Alignment_ownKeys(Object(source), true).forEach(function (key) { Alignment_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { Alignment_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function Alignment_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2020 OpenCB
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * WARNING: AUTOGENERATED CODE
 *
 * This code was generated by a tool.
 * Autogenerated on: 2020-02-27 10:51:26
 *
 * Manual changes to this file may cause unexpected behavior in your application.
 * Manual changes to this file will be overwritten if the code is regenerated.
 *
**/

/**
 * This class contains the methods for the "Alignment" resource
 */

class Alignment_Alignment extends opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    super(config);
  }
  /** BWA is a software package for mapping low-divergent sequences against a large reference genome.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - study.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runBwa(params) {
    return this._post("analysis/alignment", null, "bwa", null, "run", params);
  }
  /** Query the coverage of an alignment file for regions or genes
  * @param {String} file - File ID.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.region] - Comma separated list of regions 'chr:start-end, e.g.: 2,3:63500-65000.
  * @param {String} [params.gene] - Comma separated list of genes, e.g.: BCRA2,TP53.
  * @param {Number} [params.offset] - Offset to extend the region, gene or exon at up and downstream.
  * @param {Boolean} [params.onlyExons] - Only exons are taking into account when genes are specified.
  * @param {String} [params.range] - Range of coverage values to be reported. Minimum and maximum values are separated by '-', e.g.: 20-40
  *     (for coverage values greater or equal to 20 and less or equal to 40). A single value means to report coverage values less or equal to
  *     that value.
  * @param {Number} [params.windowSize] - Window size for the region coverage (if a coverage range is provided, window size must be 1).
  * @param {Boolean} [params.splitResults] - Split results into regions (or gene/exon regions).
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  queryCoverage(file, params) {
    return this._get("analysis/alignment", null, "coverage", null, "query", Alignment_objectSpread({
      file
    }, params));
  }
  /** Compute coverage ratio from file #1 vs file #2, (e.g. somatic vs germline)
  * @param {String} file1 - Input file #1 (e.g. somatic file).
  * @param {String} file2 - Input file #2 (e.g. germline file).
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Boolean} [params.skipLog2] - Do not apply Log2 to normalise the coverage ratio.
  * @param {String} [params.region] - Comma separated list of regions 'chr:start-end, e.g.: 2,3:63500-65000.
  * @param {String} [params.gene] - Comma separated list of genes, e.g.: BCRA2,TP53.
  * @param {Number} [params.offset] - Offset to extend the region, gene or exon at up and downstream.
  * @param {Boolean} [params.onlyExons] - Only exons are taking into account when genes are specified.
  * @param {Number} [params.windowSize] - Window size for the region coverage (if a coverage range is provided, window size must be 1).
  * @param {Boolean} [params.splitResults] - Split results into regions (or gene/exon regions).
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  ratioCoverage(file1, file2, params) {
    return this._get("analysis/alignment", null, "coverage", null, "ratio", Alignment_objectSpread({
      file1,
      file2
    }, params));
  }
  /** Compute coverage for a list of alignment files
  * @param {String} file - File ID.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Number} [params.windowSize] - Window size for the region coverage (if a coverage range is provided, window size must be 1).
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runCoverage(file, params) {
    return this._post("analysis/alignment", null, "coverage", null, "run", Alignment_objectSpread({
      file
    }, params));
  }
  /** Deeptools is a suite of python tools particularly developed for the efficient analysis of high-throughput sequencing data, such as
  * ChIP-seq, RNA-seq or MNase-seq.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - study.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runDeeptools(params) {
    return this._post("analysis/alignment", null, "deeptools", null, "run", params);
  }
  /** A quality control tool for high throughput sequence data.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - study.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runFastqc(params) {
    return this._post("analysis/alignment", null, "fastqc", null, "run", params);
  }
  /** Index alignment file
  * @param {String} file - File ID.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  index(file, params) {
    return this._post("analysis/alignment", null, null, null, "index", Alignment_objectSpread({
      file
    }, params));
  }
  /** Search over indexed alignments
  * @param {String} file - File ID.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {Boolean} [params.count = "false"] - Get the total number of results matching the query. Deactivated by default. The default
  *     value is false.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.region] - Comma separated list of regions 'chr:start-end, e.g.: 2,3:63500-65000.
  * @param {String} [params.gene] - Comma separated list of genes, e.g.: BCRA2,TP53.
  * @param {Number} [params.offset] - Offset to extend the region, gene or exon at up and downstream.
  * @param {Boolean} [params.onlyExons] - Only exons are taking into account when genes are specified.
  * @param {Number} [params.minMappingQuality] - Minimum mapping quality.
  * @param {Number} [params.maxNumMismatches] - Maximum number of mismatches.
  * @param {Number} [params.maxNumHits] - Maximum number of hits.
  * @param {Boolean} [params.properlyPaired] - Return only properly paired alignments.
  * @param {Number} [params.maxInsertSize] - Maximum insert size.
  * @param {Boolean} [params.skipUnmapped] - Skip unmapped alignments.
  * @param {Boolean} [params.skipDuplicated] - Skip duplicated alignments.
  * @param {Boolean} [params.regionContained] - Return alignments contained within boundaries of region.
  * @param {Boolean} [params.forceMDField] - Force SAM MD optional field to be set with the alignments.
  * @param {Boolean} [params.binQualities] - Compress the nucleotide qualities by using 8 quality levels.
  * @param {Boolean} [params.splitResults] - Split results into regions (or gene/exon regions).
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  query(file, params) {
    return this._get("analysis/alignment", null, null, null, "query", Alignment_objectSpread({
      file
    }, params));
  }
  /** Samtools is a program for interacting with high-throughput sequencing data in SAM, BAM and CRAM formats.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - study.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runSamtools(params) {
    return this._post("analysis/alignment", null, "samtools", null, "run", params);
  }
  /** Show the stats for a given alignment file
  * @param {String} file - File ID.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  infoStats(file, params) {
    return this._get("analysis/alignment", null, "stats", null, "info", Alignment_objectSpread({
      file
    }, params));
  }
  /** Fetch alignment files according to their stats
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.rawTotalSequences] - Raw total sequences: [<|>|<=|>=]{number}, e.g. >=1000.
  * @param {String} [params.filteredSequences] - Filtered sequences: [<|>|<=|>=]{number}, e.g. <=500.
  * @param {String} [params.readsMapped] - Reads mapped: [<|>|<=|>=]{number}, e.g. >3000.
  * @param {String} [params.readsMappedAndPaired] - Reads mapped and paired: paired-end technology bit set + both mates mapped:
  *     [<|>|<=|>=]{number}, e.g. >=1000.
  * @param {String} [params.readsUnmapped] - Reads unmapped: [<|>|<=|>=]{number}, e.g. >=1000.
  * @param {String} [params.readsProperlyPaired] - Reads properly paired (proper-pair bit set: [<|>|<=|>=]{number}, e.g. >=1000.
  * @param {String} [params.readsPaired] - Reads paired: paired-end technology bit set: [<|>|<=|>=]{number}, e.g. >=1000.
  * @param {String} [params.readsDuplicated] - Reads duplicated: PCR or optical duplicate bit set: [<|>|<=|>=]{number}, e.g. >=1000.
  * @param {String} [params.readsMQ0] - Reads mapped and MQ = 0: [<|>|<=|>=]{number}, e.g. >=1000.
  * @param {String} [params.readsQCFailed] - Reads QC failed: [<|>|<=|>=]{number}, e.g. >=1000.
  * @param {String} [params.nonPrimaryAlignments] - Non-primary alignments: [<|>|<=|>=]{number}, e.g. <=100.
  * @param {String} [params.mismatches] - Mismatches from NM fields: [<|>|<=|>=]{number}, e.g. <=100.
  * @param {String} [params.errorRate] - Error rate: mismatches / bases mapped (cigar): [<|>|<=|>=]{number}, e.g. <=0.002.
  * @param {String} [params.averageLength] - Average_length: [<|>|<=|>=]{number}, e.g. >=90.0.
  * @param {String} [params.averageFirstFragmentLength] - Average first fragment length: [<|>|<=|>=]{number}, e.g. >=90.0.
  * @param {String} [params.averageLastFragmentLength] - Average_last_fragment_length: [<|>|<=|>=]{number}, e.g. >=90.0.
  * @param {String} [params.averageQuality] - Average quality: [<|>|<=|>=]{number}, e.g. >=35.5.
  * @param {String} [params.insertSizeAverage] - Insert size average: [<|>|<=|>=]{number}, e.g. >=100.0.
  * @param {String} [params.insertSizeStandardDeviation] - Insert size standard deviation: [<|>|<=|>=]{number}, e.g. <=1.5.
  * @param {String} [params.pairsWithOtherOrientation] - Pairs with other orientation: [<|>|<=|>=]{number}, e.g. >=1000.
  * @param {String} [params.pairsOnDifferentChromosomes] - Pairs on different chromosomes: [<|>|<=|>=]{number}, e.g. >=1000.
  * @param {String} [params.percentageOfProperlyPairedReads] - Percentage of properly paired reads: [<|>|<=|>=]{number}, e.g. >=96.5.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  queryStats(params) {
    return this._get("analysis/alignment", null, "stats", null, "query", params);
  }
  /** Compute stats for a given alignment file
  * @param {String} file - File ID.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runStats(file, params) {
    return this._post("analysis/alignment", null, "stats", null, "run", Alignment_objectSpread({
      file
    }, params));
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/api/Clinical.js
/**
 * Copyright 2015-2020 OpenCB
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * WARNING: AUTOGENERATED CODE
 *
 * This code was generated by a tool.
 * Autogenerated on: 2020-02-27 10:51:26
 *
 * Manual changes to this file may cause unexpected behavior in your application.
 * Manual changes to this file will be overwritten if the code is regenerated.
 *
**/

/**
 * This class contains the methods for the "Clinical" resource
 */

class Clinical_Clinical extends opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    super(config);
  }
  /** Update the set of permissions granted for the member
  * @param {String} members - Comma separated list of user or group ids.
  * @param {Object} data - JSON containing the parameters to add ACLs.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateAcl(members, data, params) {
    return this._post("analysis/clinical", members, null, null, "update", data, params);
  }
  /** Create a new clinical analysis
  * @param {Object} data - JSON containing clinical analysis information.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  create(data, params) {
    return this._post("analysis/clinical", null, null, null, "create", data, params);
  }
  /** Cancer Tiering interpretation analysis
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {Boolean} [params.includeLowCoverage = "false"] - Include low coverage regions. The default value is false.
  * @param {Number} [params.maxLowCoverage = "20"] - Max. low coverage. The default value is 20.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.clinicalAnalysisId] - Clinical analysis ID.
  * @param {String} [params.panelIds] - Comma separated list of variant IDs to discard.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runInterpretationCancerTiering(params) {
    return this._post("analysis/clinical", null, "interpretation/cancerTiering", null, "run", params);
  }
  /** Interpretation custom analysis
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {Boolean} [params.sort] - Sort the results.
  * @param {Boolean} [params.summary] - Fast fetch of main variant parameters.
  * @param {Boolean} [params.includeLowCoverage = "false"] - Include low coverage regions. The default value is false.
  * @param {Number} [params.maxLowCoverage = "20"] - Max. low coverage. The default value is 20.
  * @param {Boolean} [params.skipUntieredVariants = "false"] - Skip variants without tier assigned. The default value is false.
  * @param {String} [params.id] - List of IDs, these can be rs IDs (dbSNP) or variants in the format chrom:start:ref:alt, e.g.
  *     rs116600158,19:7177679:C:T.
  * @param {String} [params.region] - List of regions, these can be just a single chromosome name or regions in the format chr:start-end,
  *     e.g.: 2,3:100000-200000.
  * @param {String} [params.type] - List of types, accepted values are SNV, MNV, INDEL, SV, CNV, INSERTION, DELETION, e.g. SNV,INDEL.
  * @param {String} [params.reference] - Reference allele.
  * @param {String} [params.alternate] - Main alternate allele.
  * @param {String} [params.project] - Project [user@]project where project can be either the ID or the alias.
  * @param {String} [params.file] - Filter variants from the files specified. This will set includeFile parameter when not provided.
  * @param {String} [params.filter] - Specify the FILTER for any of the files. If 'file' filter is provided, will match the file and the
  *     filter. e.g.: PASS,LowGQX.
  * @param {String} [params.qual] - Specify the QUAL for any of the files. If 'file' filter is provided, will match the file and the qual.
  *     e.g.: >123.4.
  * @param {String} [params.info] - Filter by INFO attributes from file. [{file}:]{key}{op}{value}[,;]* . If no file is specified, will
  *     use all files from "file" filter. e.g. AN>200 or file_1.vcf:AN>200;file_2.vcf:AN<10 . Many INFO fields can be combined. e.g.
  *     file_1.vcf:AN>200;DB=true;file_2.vcf:AN<10.
  * @param {String} [params.sample] - Filter variants where the samples contain the variant (HET or HOM_ALT). Accepts AND (;) and OR (,)
  *     operators. This will automatically set 'includeSample' parameter when not provided.
  * @param {String} [params.genotype] - Samples with a specific genotype: {samp_1}:{gt_1}(,{gt_n})*(;{samp_n}:{gt_1}(,{gt_n})*)* e.g.
  *     HG0097:0/0;HG0098:0/1,1/1. Unphased genotypes (e.g. 0/1, 1/1) will also include phased genotypes (e.g. 0|1, 1|0, 1|1), but not vice
  *     versa. When filtering by multi-allelic genotypes, any secondary allele will match, regardless of its position e.g. 1/2 will match with
  *     genotypes 1/2, 1/3, 1/4, .... Genotype aliases accepted: HOM_REF, HOM_ALT, HET, HET_REF, HET_ALT and MISS  e.g.
  *     HG0097:HOM_REF;HG0098:HET_REF,HOM_ALT. This will automatically set 'includeSample' parameter when not provided.
  * @param {String} [params.format] - Filter by any FORMAT field from samples. [{sample}:]{key}{op}{value}[,;]* . If no sample is
  *     specified, will use all samples from "sample" or "genotype" filter. e.g. DP>200 or HG0097:DP>200,HG0098:DP<10 . Many FORMAT fields can
  *     be combined. e.g. HG0097:DP>200;GT=1/1,0/1,HG0098:DP<10.
  * @param {String} [params.sampleAnnotation] - Selects some samples using metadata information from Catalog. e.g.
  *     age>20;phenotype=hpo:123,hpo:456;name=smith.
  * @param {Boolean} [params.sampleMetadata] - Return the samples metadata group by study. Sample names will appear in the same order as
  *     their corresponding genotypes.
  * @param {String} [params.unknownGenotype] - Returned genotype for unknown genotypes. Common values: [0/0, 0|0, ./.].
  * @param {Number} [params.sampleLimit] - Limit the number of samples to be included in the result.
  * @param {Number} [params.sampleSkip] - Skip some samples from the result. Useful for sample pagination.
  * @param {String} [params.cohort] - Select variants with calculated stats for the selected cohorts.
  * @param {String} [params.cohortStatsRef] - Reference Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsAlt] - Alternate Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsMaf] - Minor Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsMgf] - Minor Genotype Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsPass] - Filter PASS frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL>0.8.
  * @param {String} [params.missingAlleles] - Number of missing alleles: [{study:}]{cohort}[<|>|<=|>=]{number}.
  * @param {String} [params.missingGenotypes] - Number of missing genotypes: [{study:}]{cohort}[<|>|<=|>=]{number}.
  * @param {String} [params.score] - Filter by variant score: [{study:}]{score}[<|>|<=|>=]{number}.
  * @param {String} [params.family] - Filter variants where any of the samples from the given family contains the variant (HET or
  *     HOM_ALT).
  * @param {String} [params.familyDisorder] - Specify the disorder to use for the family segregation.
  * @param {String} [params.familySegregation] - Filter by mode of inheritance from a given family. Accepted values: [ monoallelic,
  *     monoallelicIncompletePenetrance, biallelic, biallelicIncompletePenetrance, XlinkedBiallelic, XlinkedMonoallelic, Ylinked,
  *     MendelianError, DeNovo, CompoundHeterozygous ].
  * @param {String} [params.familyMembers] - Sub set of the members of a given family.
  * @param {String} [params.familyProband] - Specify the proband child to use for the family segregation.
  * @param {String} [params.penetrance = "COMPLETE"] - Penetrance. The default value is COMPLETE.
  * @param {String} [params.includeStudy] - List of studies to include in the result. Accepts 'all' and 'none'.
  * @param {String} [params.includeFile] - List of files to be returned. Accepts 'all' and 'none'.
  * @param {String} [params.includeSample] - List of samples to be included in the result. Accepts 'all' and 'none'.
  * @param {String} [params.includeFormat] - List of FORMAT names from Samples Data to include in the output. e.g: DP,AD. Accepts 'all'
  *     and 'none'.
  * @param {String} [params.includeGenotype] - Include genotypes, apart of other formats defined with includeFormat.
  * @param {Boolean} [params.annotationExists] - Return only annotated variants.
  * @param {String} [params.gene] - List of genes, most gene IDs are accepted (HGNC, Ensembl gene, ...). This is an alias to 'xref'
  *     parameter.
  * @param {String} [params.ct] - List of SO consequence types, e.g. missense_variant,stop_lost or SO:0001583,SO:0001578.
  * @param {String} [params.xref] - List of any external reference, these can be genes, proteins or variants. Accepted IDs include HGNC,
  *     Ensembl genes, dbSNP, ClinVar, HPO, Cosmic, ...
  * @param {String} [params.biotype] - List of biotypes, e.g. protein_coding.
  * @param {String} [params.proteinSubstitution] - Protein substitution scores include SIFT and PolyPhen. You can query using the score
  *     {protein_score}[<|>|<=|>=]{number} or the description {protein_score}[~=|=]{description} e.g. polyphen>0.1,sift=tolerant.
  * @param {String} [params.conservation] - Filter by conservation score: {conservation_score}[<|>|<=|>=]{number} e.g.
  *     phastCons>0.5,phylop<0.1,gerp>0.1.
  * @param {String} [params.populationFrequencyAlt] - Alternate Population Frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.populationFrequencyRef] - Reference Population Frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.populationFrequencyMaf] - Population minor allele frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.transcriptFlag] - List of transcript annotation flags. e.g. CCDS, basic, cds_end_NF, mRNA_end_NF,
  *     cds_start_NF, mRNA_start_NF, seleno.
  * @param {String} [params.geneTraitId] - List of gene trait association id. e.g. "umls:C0007222" , "OMIM:269600".
  * @param {String} [params.go] - List of GO (Gene Ontology) terms. e.g. "GO:0002020".
  * @param {String} [params.expression] - List of tissues of interest. e.g. "lung".
  * @param {String} [params.proteinKeyword] - List of Uniprot protein variant annotation keywords.
  * @param {String} [params.drug] - List of drug names.
  * @param {String} [params.functionalScore] - Functional score: {functional_score}[<|>|<=|>=]{number} e.g. cadd_scaled>5.2 ,
  *     cadd_raw<=0.3.
  * @param {String} [params.clinicalSignificance] - Clinical significance: benign, likely_benign, likely_pathogenic, pathogenic.
  * @param {String} [params.customAnnotation] - Custom annotation: {key}[<|>|<=|>=]{number} or {key}[~=|=]{text}.
  * @param {String} [params.panel] - Filter by genes from the given disease panel.
  * @param {String} [params.trait] - List of traits, based on ClinVar, HPO, COSMIC, i.e.: IDs, histologies, descriptions,...
  * @param {String} [params.clinicalAnalysisId] - Clinical analysis ID.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runInterpretationCustom(params) {
    return this._post("analysis/clinical", null, "interpretation/custom", null, "run", params);
  }
  /** Index clinical analysis interpretations in the clinical variant database
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.interpretationId] - Comma separated list of interpretation IDs to be indexed in the clinical variant database.
  * @param {String} [params.clinicalAnalysisId] - Comma separated list of clinical analysis IDs to be indexed in the clinical variant
  *     database.
  * @param {Boolean} [params.false] - Reset the clinical variant database and import the specified interpretations.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  indexInterpretation(params) {
    return this._get("analysis/clinical", null, "interpretation", null, "index", params);
  }
  /** Search for secondary findings for a given query
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {Boolean} [params.sort] - Sort the results.
  * @param {Boolean} [params.summary] - Fast fetch of main variant parameters.
  * @param {Boolean} [params.skipUntieredVariants = "false"] - Skip variants without tier assigned. The default value is false.
  * @param {String} [params.id] - List of IDs, these can be rs IDs (dbSNP) or variants in the format chrom:start:ref:alt, e.g.
  *     rs116600158,19:7177679:C:T.
  * @param {String} [params.region] - List of regions, these can be just a single chromosome name or regions in the format chr:start-end,
  *     e.g.: 2,3:100000-200000.
  * @param {String} [params.type] - List of types, accepted values are SNV, MNV, INDEL, SV, CNV, INSERTION, DELETION, e.g. SNV,INDEL.
  * @param {String} [params.reference] - Reference allele.
  * @param {String} [params.alternate] - Main alternate allele.
  * @param {String} [params.project] - Project [user@]project where project can be either the ID or the alias.
  * @param {String} [params.file] - Filter variants from the files specified. This will set includeFile parameter when not provided.
  * @param {String} [params.filter] - Specify the FILTER for any of the files. If 'file' filter is provided, will match the file and the
  *     filter. e.g.: PASS,LowGQX.
  * @param {String} [params.qual] - Specify the QUAL for any of the files. If 'file' filter is provided, will match the file and the qual.
  *     e.g.: >123.4.
  * @param {String} [params.info] - Filter by INFO attributes from file. [{file}:]{key}{op}{value}[,;]* . If no file is specified, will
  *     use all files from "file" filter. e.g. AN>200 or file_1.vcf:AN>200;file_2.vcf:AN<10 . Many INFO fields can be combined. e.g.
  *     file_1.vcf:AN>200;DB=true;file_2.vcf:AN<10.
  * @param {String} [params.sample] - Filter variants where the samples contain the variant (HET or HOM_ALT). Accepts AND (;) and OR (,)
  *     operators. This will automatically set 'includeSample' parameter when not provided.
  * @param {String} [params.genotype] - Samples with a specific genotype: {samp_1}:{gt_1}(,{gt_n})*(;{samp_n}:{gt_1}(,{gt_n})*)* e.g.
  *     HG0097:0/0;HG0098:0/1,1/1. Unphased genotypes (e.g. 0/1, 1/1) will also include phased genotypes (e.g. 0|1, 1|0, 1|1), but not vice
  *     versa. When filtering by multi-allelic genotypes, any secondary allele will match, regardless of its position e.g. 1/2 will match with
  *     genotypes 1/2, 1/3, 1/4, .... Genotype aliases accepted: HOM_REF, HOM_ALT, HET, HET_REF, HET_ALT and MISS  e.g.
  *     HG0097:HOM_REF;HG0098:HET_REF,HOM_ALT. This will automatically set 'includeSample' parameter when not provided.
  * @param {String} [params.format] - Filter by any FORMAT field from samples. [{sample}:]{key}{op}{value}[,;]* . If no sample is
  *     specified, will use all samples from "sample" or "genotype" filter. e.g. DP>200 or HG0097:DP>200,HG0098:DP<10 . Many FORMAT fields can
  *     be combined. e.g. HG0097:DP>200;GT=1/1,0/1,HG0098:DP<10.
  * @param {String} [params.sampleAnnotation] - Selects some samples using metadata information from Catalog. e.g.
  *     age>20;phenotype=hpo:123,hpo:456;name=smith.
  * @param {Boolean} [params.sampleMetadata] - Return the samples metadata group by study. Sample names will appear in the same order as
  *     their corresponding genotypes.
  * @param {String} [params.unknownGenotype] - Returned genotype for unknown genotypes. Common values: [0/0, 0|0, ./.].
  * @param {Number} [params.sampleLimit] - Limit the number of samples to be included in the result.
  * @param {Number} [params.sampleSkip] - Skip some samples from the result. Useful for sample pagination.
  * @param {String} [params.cohort] - Select variants with calculated stats for the selected cohorts.
  * @param {String} [params.cohortStatsRef] - Reference Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsAlt] - Alternate Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsMaf] - Minor Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsMgf] - Minor Genotype Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsPass] - Filter PASS frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL>0.8.
  * @param {String} [params.missingAlleles] - Number of missing alleles: [{study:}]{cohort}[<|>|<=|>=]{number}.
  * @param {String} [params.missingGenotypes] - Number of missing genotypes: [{study:}]{cohort}[<|>|<=|>=]{number}.
  * @param {String} [params.score] - Filter by variant score: [{study:}]{score}[<|>|<=|>=]{number}.
  * @param {String} [params.family] - Filter variants where any of the samples from the given family contains the variant (HET or
  *     HOM_ALT).
  * @param {String} [params.familyDisorder] - Specify the disorder to use for the family segregation.
  * @param {String} [params.familySegregation] - Filter by mode of inheritance from a given family. Accepted values: [ monoallelic,
  *     monoallelicIncompletePenetrance, biallelic, biallelicIncompletePenetrance, XlinkedBiallelic, XlinkedMonoallelic, Ylinked,
  *     MendelianError, DeNovo, CompoundHeterozygous ].
  * @param {String} [params.familyMembers] - Sub set of the members of a given family.
  * @param {String} [params.familyProband] - Specify the proband child to use for the family segregation.
  * @param {String} [params.penetrance = "COMPLETE"] - Penetrance. The default value is COMPLETE.
  * @param {String} [params.includeStudy] - List of studies to include in the result. Accepts 'all' and 'none'.
  * @param {String} [params.includeFile] - List of files to be returned. Accepts 'all' and 'none'.
  * @param {String} [params.includeSample] - List of samples to be included in the result. Accepts 'all' and 'none'.
  * @param {String} [params.includeFormat] - List of FORMAT names from Samples Data to include in the output. e.g: DP,AD. Accepts 'all'
  *     and 'none'.
  * @param {String} [params.includeGenotype] - Include genotypes, apart of other formats defined with includeFormat.
  * @param {Boolean} [params.annotationExists] - Return only annotated variants.
  * @param {String} [params.gene] - List of genes, most gene IDs are accepted (HGNC, Ensembl gene, ...). This is an alias to 'xref'
  *     parameter.
  * @param {String} [params.ct] - List of SO consequence types, e.g. missense_variant,stop_lost or SO:0001583,SO:0001578.
  * @param {String} [params.xref] - List of any external reference, these can be genes, proteins or variants. Accepted IDs include HGNC,
  *     Ensembl genes, dbSNP, ClinVar, HPO, Cosmic, ...
  * @param {String} [params.biotype] - List of biotypes, e.g. protein_coding.
  * @param {String} [params.proteinSubstitution] - Protein substitution scores include SIFT and PolyPhen. You can query using the score
  *     {protein_score}[<|>|<=|>=]{number} or the description {protein_score}[~=|=]{description} e.g. polyphen>0.1,sift=tolerant.
  * @param {String} [params.conservation] - Filter by conservation score: {conservation_score}[<|>|<=|>=]{number} e.g.
  *     phastCons>0.5,phylop<0.1,gerp>0.1.
  * @param {String} [params.populationFrequencyAlt] - Alternate Population Frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.populationFrequencyRef] - Reference Population Frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.populationFrequencyMaf] - Population minor allele frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.transcriptFlag] - List of transcript annotation flags. e.g. CCDS, basic, cds_end_NF, mRNA_end_NF,
  *     cds_start_NF, mRNA_start_NF, seleno.
  * @param {String} [params.geneTraitId] - List of gene trait association id. e.g. "umls:C0007222" , "OMIM:269600".
  * @param {String} [params.go] - List of GO (Gene Ontology) terms. e.g. "GO:0002020".
  * @param {String} [params.expression] - List of tissues of interest. e.g. "lung".
  * @param {String} [params.proteinKeyword] - List of Uniprot protein variant annotation keywords.
  * @param {String} [params.drug] - List of drug names.
  * @param {String} [params.functionalScore] - Functional score: {functional_score}[<|>|<=|>=]{number} e.g. cadd_scaled>5.2 ,
  *     cadd_raw<=0.3.
  * @param {String} [params.clinicalSignificance] - Clinical significance: benign, likely_benign, likely_pathogenic, pathogenic.
  * @param {String} [params.customAnnotation] - Custom annotation: {key}[<|>|<=|>=]{number} or {key}[~=|=]{text}.
  * @param {String} [params.panel] - Filter by genes from the given disease panel.
  * @param {String} [params.trait] - List of traits, based on ClinVar, HPO, COSMIC, i.e.: IDs, histologies, descriptions,...
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  primaryFindingsInterpretation(params) {
    return this._get("analysis/clinical", null, "interpretation", null, "primaryFindings", params);
  }
  /** Query for reported variants
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {Boolean} [params.count] - Get the total number of results matching the query. Deactivated by default.
  * @param {Boolean} [params.sort] - Sort the results.
  * @param {Boolean} [params.summary] - Fast fetch of main variant parameters.
  * @param {Boolean} [params.approximateCount] - Get an approximate count, instead of an exact total count. Reduces execution time.
  * @param {Number} [params.approximateCountSamplingSize] - Sampling size to get the approximate count. Larger values increase accuracy
  *     but also increase execution time.
  * @param {String} [params.id] - List of IDs, these can be rs IDs (dbSNP) or variants in the format chrom:start:ref:alt, e.g.
  *     rs116600158,19:7177679:C:T.
  * @param {String} [params.region] - List of regions, these can be just a single chromosome name or regions in the format chr:start-end,
  *     e.g.: 2,3:100000-200000.
  * @param {String} [params.type] - List of types, accepted values are SNV, MNV, INDEL, SV, CNV, INSERTION, DELETION, e.g. SNV,INDEL.
  * @param {String} [params.reference] - Reference allele.
  * @param {String} [params.alternate] - Main alternate allele.
  * @param {String} [params.project] - Project [user@]project where project can be either the ID or the alias.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.file] - Filter variants from the files specified. This will set includeFile parameter when not provided.
  * @param {String} [params.filter] - Specify the FILTER for any of the files. If 'file' filter is provided, will match the file and the
  *     filter. e.g.: PASS,LowGQX.
  * @param {String} [params.qual] - Specify the QUAL for any of the files. If 'file' filter is provided, will match the file and the qual.
  *     e.g.: >123.4.
  * @param {String} [params.info] - Filter by INFO attributes from file. [{file}:]{key}{op}{value}[,;]* . If no file is specified, will
  *     use all files from "file" filter. e.g. AN>200 or file_1.vcf:AN>200;file_2.vcf:AN<10 . Many INFO fields can be combined. e.g.
  *     file_1.vcf:AN>200;DB=true;file_2.vcf:AN<10.
  * @param {String} [params.sample] - Filter variants where the samples contain the variant (HET or HOM_ALT). Accepts AND (;) and OR (,)
  *     operators. This will automatically set 'includeSample' parameter when not provided.
  * @param {String} [params.genotype] - Samples with a specific genotype: {samp_1}:{gt_1}(,{gt_n})*(;{samp_n}:{gt_1}(,{gt_n})*)* e.g.
  *     HG0097:0/0;HG0098:0/1,1/1. Unphased genotypes (e.g. 0/1, 1/1) will also include phased genotypes (e.g. 0|1, 1|0, 1|1), but not vice
  *     versa. When filtering by multi-allelic genotypes, any secondary allele will match, regardless of its position e.g. 1/2 will match with
  *     genotypes 1/2, 1/3, 1/4, .... Genotype aliases accepted: HOM_REF, HOM_ALT, HET, HET_REF, HET_ALT and MISS  e.g.
  *     HG0097:HOM_REF;HG0098:HET_REF,HOM_ALT. This will automatically set 'includeSample' parameter when not provided.
  * @param {String} [params.format] - Filter by any FORMAT field from samples. [{sample}:]{key}{op}{value}[,;]* . If no sample is
  *     specified, will use all samples from "sample" or "genotype" filter. e.g. DP>200 or HG0097:DP>200,HG0098:DP<10 . Many FORMAT fields can
  *     be combined. e.g. HG0097:DP>200;GT=1/1,0/1,HG0098:DP<10.
  * @param {String} [params.sampleAnnotation] - Selects some samples using metadata information from Catalog. e.g.
  *     age>20;phenotype=hpo:123,hpo:456;name=smith.
  * @param {Boolean} [params.sampleMetadata] - Return the samples metadata group by study. Sample names will appear in the same order as
  *     their corresponding genotypes.
  * @param {String} [params.unknownGenotype] - Returned genotype for unknown genotypes. Common values: [0/0, 0|0, ./.].
  * @param {Number} [params.sampleLimit] - Limit the number of samples to be included in the result.
  * @param {Number} [params.sampleSkip] - Skip some samples from the result. Useful for sample pagination.
  * @param {String} [params.cohort] - Select variants with calculated stats for the selected cohorts.
  * @param {String} [params.cohortStatsRef] - Reference Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsAlt] - Alternate Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsMaf] - Minor Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsMgf] - Minor Genotype Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsPass] - Filter PASS frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL>0.8.
  * @param {String} [params.missingAlleles] - Number of missing alleles: [{study:}]{cohort}[<|>|<=|>=]{number}.
  * @param {String} [params.missingGenotypes] - Number of missing genotypes: [{study:}]{cohort}[<|>|<=|>=]{number}.
  * @param {String} [params.score] - Filter by variant score: [{study:}]{score}[<|>|<=|>=]{number}.
  * @param {String} [params.includeStudy] - List of studies to include in the result. Accepts 'all' and 'none'.
  * @param {String} [params.includeFile] - List of files to be returned. Accepts 'all' and 'none'.
  * @param {String} [params.includeSample] - List of samples to be included in the result. Accepts 'all' and 'none'.
  * @param {String} [params.includeFormat] - List of FORMAT names from Samples Data to include in the output. e.g: DP,AD. Accepts 'all'
  *     and 'none'.
  * @param {String} [params.includeGenotype] - Include genotypes, apart of other formats defined with includeFormat.
  * @param {Boolean} [params.annotationExists] - Return only annotated variants.
  * @param {String} [params.gene] - List of genes, most gene IDs are accepted (HGNC, Ensembl gene, ...). This is an alias to 'xref'
  *     parameter.
  * @param {String} [params.ct] - List of SO consequence types, e.g. missense_variant,stop_lost or SO:0001583,SO:0001578.
  * @param {String} [params.xref] - List of any external reference, these can be genes, proteins or variants. Accepted IDs include HGNC,
  *     Ensembl genes, dbSNP, ClinVar, HPO, Cosmic, ...
  * @param {String} [params.biotype] - List of biotypes, e.g. protein_coding.
  * @param {String} [params.proteinSubstitution] - Protein substitution scores include SIFT and PolyPhen. You can query using the score
  *     {protein_score}[<|>|<=|>=]{number} or the description {protein_score}[~=|=]{description} e.g. polyphen>0.1,sift=tolerant.
  * @param {String} [params.conservation] - Filter by conservation score: {conservation_score}[<|>|<=|>=]{number} e.g.
  *     phastCons>0.5,phylop<0.1,gerp>0.1.
  * @param {String} [params.populationFrequencyAlt] - Alternate Population Frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.populationFrequencyRef] - Reference Population Frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.populationFrequencyMaf] - Population minor allele frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.transcriptFlag] - List of transcript annotation flags. e.g. CCDS, basic, cds_end_NF, mRNA_end_NF,
  *     cds_start_NF, mRNA_start_NF, seleno.
  * @param {String} [params.geneTraitId] - List of gene trait association id. e.g. "umls:C0007222" , "OMIM:269600".
  * @param {String} [params.go] - List of GO (Gene Ontology) terms. e.g. "GO:0002020".
  * @param {String} [params.expression] - List of tissues of interest. e.g. "lung".
  * @param {String} [params.proteinKeyword] - List of Uniprot protein variant annotation keywords.
  * @param {String} [params.drug] - List of drug names.
  * @param {String} [params.functionalScore] - Functional score: {functional_score}[<|>|<=|>=]{number} e.g. cadd_scaled>5.2 ,
  *     cadd_raw<=0.3.
  * @param {String} [params.clinicalSignificance] - Clinical significance: benign, likely_benign, likely_pathogenic, pathogenic.
  * @param {String} [params.customAnnotation] - Custom annotation: {key}[<|>|<=|>=]{number} or {key}[~=|=]{text}.
  * @param {String} [params.trait] - List of traits, based on ClinVar, HPO, COSMIC, i.e.: IDs, histologies, descriptions,...
  * @param {String} [params.clinicalAnalysisId] - List of clinical analysis IDs.
  * @param {String} [params.clinicalAnalysisName] - List of clinical analysis names.
  * @param {String} [params.clinicalAnalysisDescr] - Clinical analysis description.
  * @param {String} [params.clinicalAnalysisFiles] - List of clinical analysis files.
  * @param {String} [params.clinicalAnalysisProbandId] - List of proband IDs.
  * @param {String} [params.clinicalAnalysisProbandDisorders] - List of proband disorders.
  * @param {String} [params.clinicalAnalysisProbandPhenotypes] - List of proband phenotypes.
  * @param {String} [params.clinicalAnalysisFamilyId] - List of family IDs.
  * @param {String} [params.clinicalAnalysisFamMemberIds] - List of clinical analysis family member IDs.
  * @param {String} [params.interpretationId] - List of interpretation IDs.
  * @param {String} [params.interpretationSoftwareName] - List of interpretation software names.
  * @param {String} [params.interpretationSoftwareVersion] - List of interpretation software versions.
  * @param {String} [params.interpretationAnalystName] - List of interpretation analysist names.
  * @param {String} [params.interpretationPanels] - List of interpretation panels.
  * @param {String} [params.interpretationDescription] - Interpretation description.
  * @param {String} [params.interpretationDependencies] - List of interpretation dependency, format: name:version, e.g. cellbase:4.0.
  * @param {String} [params.interpretationFilters] - List of interpretation filters.
  * @param {String} [params.interpretationComments] - List of interpretation comments.
  * @param {String} [params.interpretationCreationDate] - Iinterpretation creation date (including date ranges).
  * @param {String} [params.reportedVariantDeNovoQualityScore] - List of reported variant de novo quality scores.
  * @param {String} [params.reportedVariantComments] - List of reported variant comments.
  * @param {String} [params.reportedEventPhenotypeNames] - List of reported event phenotype names.
  * @param {String} [params.reportedEventConsequenceTypeIds] - List of reported event consequence type IDs.
  * @param {String} [params.reportedEventXrefs] - List of reported event phenotype xRefs.
  * @param {String} [params.reportedEventPanelIds] - List of reported event panel IDs.
  * @param {String} [params.reportedEventAcmg] - List of reported event ACMG.
  * @param {String} [params.reportedEventClinicalSignificance] - List of reported event clinical significance.
  * @param {String} [params.reportedEventDrugResponse] - List of reported event drug response.
  * @param {String} [params.reportedEventTraitAssociation] - List of reported event trait association.
  * @param {String} [params.reportedEventFunctionalEffect] - List of reported event functional effect.
  * @param {String} [params.reportedEventTumorigenesis] - List of reported event tumorigenesis.
  * @param {String} [params.reportedEventOtherClassification] - List of reported event other classification.
  * @param {String} [params.reportedEventRolesInCancer] - List of reported event roles in cancer.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  queryInterpretation(params) {
    return this._get("analysis/clinical", null, "interpretation", null, "query", params);
  }
  /** Search for secondary findings for a given sample
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.sample] - Sample id.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  secondaryFindingsInterpretation(params) {
    return this._get("analysis/clinical", null, "interpretation", null, "secondaryFindings", params);
  }
  /** Clinical interpretation analysis
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {Boolean} [params.count] - Get the total number of results matching the query. Deactivated by default.
  * @param {Boolean} [params.sort] - Sort the results.
  * @param {Boolean} [params.summary] - Fast fetch of main variant parameters.
  * @param {Boolean} [params.approximateCount] - Get an approximate count, instead of an exact total count. Reduces execution time.
  * @param {Number} [params.approximateCountSamplingSize] - Sampling size to get the approximate count. Larger values increase accuracy
  *     but also increase execution time.
  * @param {String} [params.id] - List of IDs, these can be rs IDs (dbSNP) or variants in the format chrom:start:ref:alt, e.g.
  *     rs116600158,19:7177679:C:T.
  * @param {String} [params.region] - List of regions, these can be just a single chromosome name or regions in the format chr:start-end,
  *     e.g.: 2,3:100000-200000.
  * @param {String} [params.type] - Clinical analysis type, e.g. DUO, TRIO, ...
  * @param {String} [params.reference] - Reference allele.
  * @param {String} [params.alternate] - Main alternate allele.
  * @param {String} [params.project] - Project [user@]project where project can be either the ID or the alias.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.file] - Filter variants from the files specified. This will set includeFile parameter when not provided.
  * @param {String} [params.filter] - Specify the FILTER for any of the files. If 'file' filter is provided, will match the file and the
  *     filter. e.g.: PASS,LowGQX.
  * @param {String} [params.qual] - Specify the QUAL for any of the files. If 'file' filter is provided, will match the file and the qual.
  *     e.g.: >123.4.
  * @param {String} [params.info] - Filter by INFO attributes from file. [{file}:]{key}{op}{value}[,;]* . If no file is specified, will
  *     use all files from "file" filter. e.g. AN>200 or file_1.vcf:AN>200;file_2.vcf:AN<10 . Many INFO fields can be combined. e.g.
  *     file_1.vcf:AN>200;DB=true;file_2.vcf:AN<10.
  * @param {String} [params.sample] - Filter variants where the samples contain the variant (HET or HOM_ALT). Accepts AND (;) and OR (,)
  *     operators. This will automatically set 'includeSample' parameter when not provided.
  * @param {String} [params.genotype] - Samples with a specific genotype: {samp_1}:{gt_1}(,{gt_n})*(;{samp_n}:{gt_1}(,{gt_n})*)* e.g.
  *     HG0097:0/0;HG0098:0/1,1/1. Unphased genotypes (e.g. 0/1, 1/1) will also include phased genotypes (e.g. 0|1, 1|0, 1|1), but not vice
  *     versa. When filtering by multi-allelic genotypes, any secondary allele will match, regardless of its position e.g. 1/2 will match with
  *     genotypes 1/2, 1/3, 1/4, .... Genotype aliases accepted: HOM_REF, HOM_ALT, HET, HET_REF, HET_ALT and MISS  e.g.
  *     HG0097:HOM_REF;HG0098:HET_REF,HOM_ALT. This will automatically set 'includeSample' parameter when not provided.
  * @param {String} [params.format] - Filter by any FORMAT field from samples. [{sample}:]{key}{op}{value}[,;]* . If no sample is
  *     specified, will use all samples from "sample" or "genotype" filter. e.g. DP>200 or HG0097:DP>200,HG0098:DP<10 . Many FORMAT fields can
  *     be combined. e.g. HG0097:DP>200;GT=1/1,0/1,HG0098:DP<10.
  * @param {String} [params.sampleAnnotation] - Selects some samples using metadata information from Catalog. e.g.
  *     age>20;phenotype=hpo:123,hpo:456;name=smith.
  * @param {Boolean} [params.sampleMetadata] - Return the samples metadata group by study. Sample names will appear in the same order as
  *     their corresponding genotypes.
  * @param {String} [params.unknownGenotype] - Returned genotype for unknown genotypes. Common values: [0/0, 0|0, ./.].
  * @param {Number} [params.sampleLimit] - Limit the number of samples to be included in the result.
  * @param {Number} [params.sampleSkip] - Skip some samples from the result. Useful for sample pagination.
  * @param {String} [params.cohort] - Select variants with calculated stats for the selected cohorts.
  * @param {String} [params.cohortStatsRef] - Reference Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsAlt] - Alternate Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsMaf] - Minor Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsMgf] - Minor Genotype Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsPass] - Filter PASS frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL>0.8.
  * @param {String} [params.missingAlleles] - Number of missing alleles: [{study:}]{cohort}[<|>|<=|>=]{number}.
  * @param {String} [params.missingGenotypes] - Number of missing genotypes: [{study:}]{cohort}[<|>|<=|>=]{number}.
  * @param {String} [params.score] - Filter by variant score: [{study:}]{score}[<|>|<=|>=]{number}.
  * @param {String} [params.includeStudy] - List of studies to include in the result. Accepts 'all' and 'none'.
  * @param {String} [params.includeFile] - List of files to be returned. Accepts 'all' and 'none'.
  * @param {String} [params.includeSample] - List of samples to be included in the result. Accepts 'all' and 'none'.
  * @param {String} [params.includeFormat] - List of FORMAT names from Samples Data to include in the output. e.g: DP,AD. Accepts 'all'
  *     and 'none'.
  * @param {String} [params.includeGenotype] - Include genotypes, apart of other formats defined with includeFormat.
  * @param {Boolean} [params.annotationExists] - Return only annotated variants.
  * @param {String} [params.gene] - List of genes, most gene IDs are accepted (HGNC, Ensembl gene, ...). This is an alias to 'xref'
  *     parameter.
  * @param {String} [params.ct] - List of SO consequence types, e.g. missense_variant,stop_lost or SO:0001583,SO:0001578.
  * @param {String} [params.xref] - List of any external reference, these can be genes, proteins or variants. Accepted IDs include HGNC,
  *     Ensembl genes, dbSNP, ClinVar, HPO, Cosmic, ...
  * @param {String} [params.biotype] - List of biotypes, e.g. protein_coding.
  * @param {String} [params.proteinSubstitution] - Protein substitution scores include SIFT and PolyPhen. You can query using the score
  *     {protein_score}[<|>|<=|>=]{number} or the description {protein_score}[~=|=]{description} e.g. polyphen>0.1,sift=tolerant.
  * @param {String} [params.conservation] - Filter by conservation score: {conservation_score}[<|>|<=|>=]{number} e.g.
  *     phastCons>0.5,phylop<0.1,gerp>0.1.
  * @param {String} [params.populationFrequencyAlt] - Alternate Population Frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.populationFrequencyRef] - Reference Population Frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.populationFrequencyMaf] - Population minor allele frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.transcriptFlag] - List of transcript annotation flags. e.g. CCDS, basic, cds_end_NF, mRNA_end_NF,
  *     cds_start_NF, mRNA_start_NF, seleno.
  * @param {String} [params.geneTraitId] - List of gene trait association id. e.g. "umls:C0007222" , "OMIM:269600".
  * @param {String} [params.go] - List of GO (Gene Ontology) terms. e.g. "GO:0002020".
  * @param {String} [params.expression] - List of tissues of interest. e.g. "lung".
  * @param {String} [params.proteinKeyword] - List of Uniprot protein variant annotation keywords.
  * @param {String} [params.drug] - List of drug names.
  * @param {String} [params.functionalScore] - Functional score: {functional_score}[<|>|<=|>=]{number} e.g. cadd_scaled>5.2 ,
  *     cadd_raw<=0.3.
  * @param {String} [params.clinicalSignificance] - Clinical significance: benign, likely_benign, likely_pathogenic, pathogenic.
  * @param {String} [params.customAnnotation] - Custom annotation: {key}[<|>|<=|>=]{number} or {key}[~=|=]{text}.
  * @param {String} [params.trait] - List of traits, based on ClinVar, HPO, COSMIC, i.e.: IDs, histologies, descriptions,...
  * @param {String} [params.field] - Facet field for categorical fields.
  * @param {String} [params.fieldRange] - Facet field range for continuous fields.
  * @param {String} [params.clinicalAnalysisId] - Clinical analysis ID.
  * @param {String} [params.disease] - Disease (HPO term).
  * @param {String} [params.familyId] - Family ID.
  * @param {Object} [params.subjectIds] - Comma separated list of subject IDs.
  * @param {String} [params.panelId] - Panel ID.
  * @param {String} [params.panelVersion] - Panel version.
  * @param {Boolean} [params.save] - Save interpretation in Catalog.
  * @param {String} [params.interpretationId] - ID of the stored interpretation.
  * @param {String} [params.interpretationName] - Name of the stored interpretation.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  statsInterpretation(params) {
    return this._get("analysis/clinical", null, "interpretation", null, "stats", params);
  }
  /** TEAM interpretation analysis
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {Boolean} [params.includeLowCoverage = "false"] - Include low coverage regions. The default value is false.
  * @param {Number} [params.maxLowCoverage = "20"] - Max. low coverage. The default value is 20.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.clinicalAnalysisId] - Clinical analysis ID.
  * @param {String} [params.panelIds] - Comma separated list of disease panel IDs.
  * @param {String} [params.familySegregation] - Filter by mode of inheritance from a given family. Accepted values: [ monoallelic,
  *     monoallelicIncompletePenetrance, biallelic, biallelicIncompletePenetrance, XlinkedBiallelic, XlinkedMonoallelic, Ylinked,
  *     MendelianError, DeNovo, CompoundHeterozygous ].
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runInterpretationTeam(params) {
    return this._post("analysis/clinical", null, "interpretation/team", null, "run", params);
  }
  /** GEL Tiering interpretation analysis
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {Boolean} [params.includeLowCoverage = "false"] - Include low coverage regions. The default value is false.
  * @param {Number} [params.maxLowCoverage = "20"] - Max. low coverage. The default value is 20.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.clinicalAnalysisId] - Clinical analysis ID.
  * @param {String} [params.panelIds] - Comma separated list of disease panel IDs.
  * @param {String} [params.penetrance = "COMPLETE"] - Penetrance. The default value is COMPLETE.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runInterpretationTiering(params) {
    return this._post("analysis/clinical", null, "interpretation/tiering", null, "run", params);
  }
  /** Clinical analysis search.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {Boolean} [params.count = "false"] - Get the total number of results matching the query. Deactivated by default. The default
  *     value is false.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.type] - Clinical analysis type.
  * @param {String} [params.priority] - Priority.
  * @param {String} [params.status] - Clinical analysis status.
  * @param {String} [params.creationDate] - Creation date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {String} [params.modificationDate] - Modification date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {String} [params.dueDate] - Due date (Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805...).
  * @param {String} [params.description] - Description.
  * @param {String} [params.family] - Family id.
  * @param {String} [params.proband] - Proband id.
  * @param {String} [params.sample] - Proband sample.
  * @param {String} [params.analystAssignee] - Clinical analyst assignee.
  * @param {String} [params.disorder] - Disorder id or name.
  * @param {String} [params.flags] - Flags.
  * @param {String} [params.release] - Release value.
  * @param {String} [params.attributes] - Text attributes (Format: sex=male,age>20 ...).
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  search(params) {
    return this._get("analysis/clinical", null, null, null, "search", params);
  }
  /** Returns the acl of the clinical analyses. If member is provided, it will only return the acl for the member.
  * @param {String} clinicalAnalyses - Comma separated list of clinical analysis IDs or names up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.member] - User or group id.
  * @param {Boolean} [params.silent = "false"] - Boolean to retrieve all possible entries that are queried for, false to raise an
  *     exception whenever one of the entries looked for cannot be shown for whichever reason. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  acl(clinicalAnalyses, params) {
    return this._get("analysis/clinical", clinicalAnalyses, null, null, "acl", params);
  }
  /** Clinical analysis info
  * @param {String} [clinicalAnalyses] - Comma separated list of clinical analysis IDs or names up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  info(clinicalAnalyses, params) {
    return this._get("analysis/clinical", clinicalAnalyses, null, null, "info", params);
  }
  /** Update clinical analysis attributes
  * @param {String} [clinicalAnalyses] - Comma separated list of clinical analysis ids.
  * @param {Object} data - JSON containing clinical analysis information.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  update(clinicalAnalyses, data, params) {
    return this._post("analysis/clinical", clinicalAnalyses, null, null, "update", data, params);
  }
  /** Add or remove Interpretations to/from a Clinical Analysis
  * @param {String} [clinicalAnalysis] - Clinical analysis ID.
  * @param {Object} data - JSON containing clinical analysis information.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.action = "ADD"] - Action to be performed if the array of interpretations is being updated. The default value
  *     is ADD.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateInterpretations(clinicalAnalysis, data, params) {
    return this._post("analysis/clinical", clinicalAnalysis, "interpretations", null, "update", data, params);
  }
  /** Update comments of an Interpretation
  * @param {String} [clinicalAnalysis] - Clinical analysis id.
  * @param {String} [interpretation] - Interpretation id.
  * @param {Object} data - JSON containing a list of comments.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - [[user@]project:]study id.
  * @param {String} [params.action = "ADD"] - Action to be performed. The default value is ADD.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateComments(clinicalAnalysis, interpretation, data, params) {
    return this._post("analysis/clinical", clinicalAnalysis, "interpretations", interpretation, "comments/update", data, params);
  }
  /** Update reported variants of an interpretation
  * @param {String} [clinicalAnalysis] - Clinical analysis id.
  * @param {String} [interpretation] - Interpretation id.
  * @param {Object} data - JSON containing a list of reported variants.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - [[user@]project:]study id.
  * @param {String} [params.action = "ADD"] - Action to be performed. The default value is ADD.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updatePrimaryFindings(clinicalAnalysis, interpretation, data, params) {
    return this._post("analysis/clinical", clinicalAnalysis, "interpretations", interpretation, "primaryFindings/update", data, params);
  }
  /** Update Interpretation fields
  * @param {String} [clinicalAnalysis] - Clinical analysis id.
  * @param {String} [interpretation] - Interpretation id.
  * @param {Object} data - JSON containing clinical interpretation information.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - [[user@]project:]study id.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateInterpretation(clinicalAnalysis, interpretation, data, params) {
    return this._post("analysis/clinical", clinicalAnalysis, "interpretations", interpretation, "update", data, params);
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/api/Cohort.js
function Cohort_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function Cohort_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { Cohort_ownKeys(Object(source), true).forEach(function (key) { Cohort_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { Cohort_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function Cohort_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2020 OpenCB
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * WARNING: AUTOGENERATED CODE
 *
 * This code was generated by a tool.
 * Autogenerated on: 2020-02-27 10:51:26
 *
 * Manual changes to this file may cause unexpected behavior in your application.
 * Manual changes to this file will be overwritten if the code is regenerated.
 *
**/

/**
 * This class contains the methods for the "Cohort" resource
 */

class Cohort_Cohort extends opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    super(config);
  }
  /** Update the set of permissions granted for the member
  * @param {String} members - Comma separated list of user or group ids.
  * @param {Object} data - JSON containing the parameters to add ACLs.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateAcl(members, data, params) {
    return this._post("cohorts", members, null, null, "update", data, params);
  }
  /** Fetch catalog cohort stats
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.type] - Type.
  * @param {String} [params.creationYear] - Creation year.
  * @param {String} [params.creationMonth] - Creation month (JANUARY, FEBRUARY...).
  * @param {String} [params.creationDay] - Creation day.
  * @param {String} [params.creationDayOfWeek] - Creation day of week (MONDAY, TUESDAY...).
  * @param {String} [params.numSamples] - Number of samples.
  * @param {String} [params.status] - Status.
  * @param {String} [params.release] - Release.
  * @param {String} [params.annotation] - Annotation, e.g: key1=value(,key2=value).
  * @param {Boolean} [params.default = "false"] - Calculate default stats. The default value is false.
  * @param {String} [params.field] - List of fields separated by semicolons, e.g.: studies;type. For nested fields use >>, e.g.:
  *     studies>>biotype;type;numSamples[0..10]:1.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  aggregationStats(params) {
    return this._get("cohorts", null, null, null, "aggregationStats", params);
  }
  /** Load annotation sets from a TSV file
  * @param {Object} [data] - JSON containing the 'content' of the TSV file if this has not yet been registered into OpenCGA.
  * @param {String} variableSetId - Variable set id or name.
  * @param {String} path - Path where the TSV file is located in OpenCGA or where it should be located.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Boolean} [params.parents] - Flag indicating whether to create parent directories if they don't exist (only when TSV file was
  *     not previously associated).
  * @param {String} [params.annotationSetId] - Annotation set id. If not provided, variableSetId will be used.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  loadAnnotationSets(variableSetId, path, data, params) {
    return this._post("cohorts", null, "annotationSets", null, "load", data, Cohort_objectSpread({
      variableSetId,
      path
    }, params));
  }
  /** Create a cohort
  * @param {Object} data - JSON containing cohort information.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.variableSet] - Variable set id or name.
  * @param {String} [params.variable] - Variable name.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  create(data, params) {
    return this._post("cohorts", null, null, null, "create", data, params);
  }
  /** Search cohorts
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {Boolean} [params.count = "false"] - Get the total number of results matching the query. Deactivated by default. The default
  *     value is false.
  * @param {Boolean} [params.flattenAnnotations = "false"] - Flatten the annotations?. The default value is false.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.name] - DEPRECATED: Name of the cohort.
  * @param {String} [params.type] - Cohort type.
  * @param {String} [params.creationDate] - Creation date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {String} [params.modificationDate] - Modification date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {Boolean} [params.deleted = "false"] - Boolean to retrieve deleted cohorts. The default value is false.
  * @param {String} [params.status] - Status.
  * @param {String} [params.annotation] - Annotation, e.g: key1=value(,key2=value).
  * @param {String} [params.acl] - Filter entries for which a user has the provided permissions. Format: acl={user}:{permissions}.
  *     Example: acl=john:WRITE,WRITE_ANNOTATIONS will return all entries for which user john has both WRITE and WRITE_ANNOTATIONS
  *     permissions. Only study owners or administrators can query by this field. .
  * @param {String} [params.samples] - Sample list.
  * @param {String} [params.release] - Release value.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  search(params) {
    return this._get("cohorts", null, null, null, "search", params);
  }
  /** Return the acl of the cohort. If member is provided, it will only return the acl for the member.
  * @param {String} cohorts - Comma separated list of cohort names or ids up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.member] - User or group id.
  * @param {Boolean} [params.silent = "false"] - Boolean to retrieve all possible entries that are queried for, false to raise an
  *     exception whenever one of the entries looked for cannot be shown for whichever reason. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  acl(cohorts, params) {
    return this._get("cohorts", cohorts, null, null, "acl", params);
  }
  /** Delete cohorts
  * @param {String} [cohorts] - Comma separated list of cohort ids.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  delete(cohorts, params) {
    return this._delete("cohorts", cohorts, null, null, "delete", params);
  }
  /** Get cohort information
  * @param {String} cohorts - Comma separated list of cohort names or ids up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Boolean} [params.flattenAnnotations = "false"] - Flatten the annotations?. The default value is false.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Boolean} [params.deleted = "false"] - Boolean to retrieve deleted cohorts. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  info(cohorts, params) {
    return this._get("cohorts", cohorts, null, null, "info", params);
  }
  /** Update some cohort attributes
  * @param {String} cohorts - Comma separated list of cohort ids.
  * @param {Object} [data] - params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {"ADD"|"SET"|"REMOVE"} [params.annotationSetsAction = "ADD"] - Action to be performed if the array of annotationSets is being
  *     updated. The default value is ADD.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  update(cohorts, data, params) {
    return this._post("cohorts", cohorts, null, null, "update", data, params);
  }
  /** Update annotations from an annotationSet
  * @param {String} cohort - Cohort id.
  * @param {String} [annotationSet] - AnnotationSet id to be updated.
  * @param {Object} [data] - Json containing the map of annotations when the action is ADD, SET or REPLACE, a json with only the key
  *     'remove' containing the comma separated variables to be removed as a value when the action is REMOVE or a json with only the key
  *     'reset' containing the comma separated variables that will be set to the default value when the action is RESET.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {"ADD"|"SET"|"REMOVE"|"RESET"|"REPLACE"} [params.action = "ADD"] - Action to be performed: ADD to add new annotations; REPLACE
  *     to replace the value of an already existing annotation; SET to set the new list of annotations removing any possible old annotations;
  *     REMOVE to remove some annotations; RESET to set some annotations to the default value configured in the corresponding variables of the
  *     VariableSet if any. The default value is ADD.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateAnnotations(cohort, annotationSet, data, params) {
    return this._post("cohorts", cohort, "annotationSets", annotationSet, "annotations/update", data, params);
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/api/DiseasePanel.js
/**
 * Copyright 2015-2020 OpenCB
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * WARNING: AUTOGENERATED CODE
 *
 * This code was generated by a tool.
 * Autogenerated on: 2020-02-27 10:51:26
 *
 * Manual changes to this file may cause unexpected behavior in your application.
 * Manual changes to this file will be overwritten if the code is regenerated.
 *
**/

/**
 * This class contains the methods for the "DiseasePanel" resource
 */

class DiseasePanel_DiseasePanel extends opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    super(config);
  }
  /** Update the set of permissions granted for the member
  * @param {String} members - Comma separated list of user or group ids.
  * @param {Object} data - JSON containing the parameters to update the permissions.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateAcl(members, data, params) {
    return this._post("panels", members, null, null, "update", data, params);
  }
  /** Create a panel
  * @param {Object} [data] - Panel parameters.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.import] - Comma separated list of installation panel ids to be imported. To import them all at once, write the
  *     special word 'ALL_GLOBAL_PANELS'.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  create(data, params) {
    return this._post("panels", null, null, null, "create", data, params);
  }
  /** Panel search
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {Boolean} [params.count = "false"] - Get the total number of results matching the query. Deactivated by default. The default
  *     value is false.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.name] - Panel name.
  * @param {String} [params.phenotypes] - Panel phenotypes.
  * @param {String} [params.variants] - Panel variants.
  * @param {String} [params.genes] - Panel genes.
  * @param {String} [params.regions] - Panel regions.
  * @param {String} [params.categories] - Panel categories.
  * @param {String} [params.tags] - Panel tags.
  * @param {String} [params.description] - Panel description.
  * @param {String} [params.author] - Panel author.
  * @param {Boolean} [params.deleted = "false"] - Boolean to retrieve deleted panels. The default value is false.
  * @param {String} [params.creationDate] - Creation date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {String} [params.modificationDate] - Modification date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {String} [params.acl] - Filter entries for which a user has the provided permissions. Format: acl={user}:{permissions}.
  *     Example: acl=john:WRITE,WRITE_ANNOTATIONS will return all entries for which user john has both WRITE and WRITE_ANNOTATIONS
  *     permissions. Only study owners or administrators can query by this field. .
  * @param {Boolean} [params.global = "false"] - Boolean indicating which panels are queried (installation or study specific panels). The
  *     default value is false.
  * @param {String} [params.release] - Release value (Current release from the moment the samples were first created).
  * @param {Number} [params.snapshot] - Snapshot value (Latest version of samples in the specified release).
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  search(params) {
    return this._get("panels", null, null, null, "search", params);
  }
  /** Returns the acl of the panels. If member is provided, it will only return the acl for the member.
  * @param {String} panels - Comma separated list of panel ids up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.member] - User or group id.
  * @param {Boolean} [params.silent = "false"] - Boolean to retrieve all possible entries that are queried for, false to raise an
  *     exception whenever one of the entries looked for cannot be shown for whichever reason. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  acl(panels, params) {
    return this._get("panels", panels, null, null, "acl", params);
  }
  /** Delete existing panels
  * @param {String} [panels] - Comma separated list of panel ids.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  delete(panels, params) {
    return this._delete("panels", panels, null, null, "delete", params);
  }
  /** Panel info
  * @param {String} [panels] - Comma separated list of panel ids up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Number} [params.version] - Panel  version.
  * @param {Boolean} [params.deleted = "false"] - Boolean to retrieve deleted panels. The default value is false.
  * @param {Boolean} [params.global = "false"] - Boolean indicating which panels are queried (installation or study specific panels). The
  *     default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  info(panels, params) {
    return this._get("panels", panels, null, null, "info", params);
  }
  /** Update panel attributes
  * @param {String} [panels] - Comma separated list of panel ids.
  * @param {Object} [data] - Panel parameters.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Boolean} [params.incVersion = "false"] - Create a new version of panel. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  update(panels, data, params) {
    return this._post("panels", panels, null, null, "update", data, params);
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/api/Family.js
function Family_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function Family_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { Family_ownKeys(Object(source), true).forEach(function (key) { Family_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { Family_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function Family_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2020 OpenCB
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * WARNING: AUTOGENERATED CODE
 *
 * This code was generated by a tool.
 * Autogenerated on: 2020-02-27 10:51:26
 *
 * Manual changes to this file may cause unexpected behavior in your application.
 * Manual changes to this file will be overwritten if the code is regenerated.
 *
**/

/**
 * This class contains the methods for the "Family" resource
 */

class Family_Family extends opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    super(config);
  }
  /** Update the set of permissions granted for the member
  * @param {String} members - Comma separated list of user or group ids.
  * @param {Object} data - JSON containing the parameters to add ACLs.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateAcl(members, data, params) {
    return this._post("families", members, null, null, "update", data, params);
  }
  /** Fetch catalog family stats
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.creationYear] - Creation year.
  * @param {String} [params.creationMonth] - Creation month (JANUARY, FEBRUARY...).
  * @param {String} [params.creationDay] - Creation day.
  * @param {String} [params.creationDayOfWeek] - Creation day of week (MONDAY, TUESDAY...).
  * @param {String} [params.status] - Status.
  * @param {String} [params.phenotypes] - Phenotypes.
  * @param {String} [params.release] - Release.
  * @param {String} [params.version] - Version.
  * @param {String} [params.numMembers] - Number of members.
  * @param {String} [params.expectedSize] - Expected size.
  * @param {String} [params.annotation] - Annotation, e.g: key1=value(,key2=value).
  * @param {Boolean} [params.default = "false"] - Calculate default stats. The default value is false.
  * @param {String} [params.field] - List of fields separated by semicolons, e.g.: studies;type. For nested fields use >>, e.g.:
  *     studies>>biotype;type;numSamples[0..10]:1.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  aggregationStats(params) {
    return this._get("families", null, null, null, "aggregationStats", params);
  }
  /** Load annotation sets from a TSV file
  * @param {Object} [data] - JSON containing the 'content' of the TSV file if this has not yet been registered into OpenCGA.
  * @param {String} variableSetId - Variable set id or name.
  * @param {String} path - Path where the TSV file is located in OpenCGA or where it should be located.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Boolean} [params.parents] - Flag indicating whether to create parent directories if they don't exist (only when TSV file was
  *     not previously associated).
  * @param {String} [params.annotationSetId] - Annotation set id. If not provided, variableSetId will be used.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  loadAnnotationSets(variableSetId, path, data, params) {
    return this._post("families", null, "annotationSets", null, "load", data, Family_objectSpread({
      variableSetId,
      path
    }, params));
  }
  /** Create family and the individual objects if they do not exist
  * @param {Object} data - JSON containing family information.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.members] - Comma separated list of member ids to be associated to the created family.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  create(data, params) {
    return this._post("families", null, null, null, "create", data, params);
  }
  /** Search families
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {Boolean} [params.count = "false"] - Get the total number of results matching the query. Deactivated by default. The default
  *     value is false.
  * @param {Boolean} [params.flattenAnnotations = "false"] - Flatten the annotations?. The default value is false.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the id or alias.
  * @param {String} [params.name] - Family name.
  * @param {Boolean} [params.parentalConsanguinity] - Parental consanguinity.
  * @param {String} [params.members] - Comma separated list of individual ids or names.
  * @param {String} [params.samples] - Comma separated list sample IDs or UUIDs up to a maximum of 100.
  * @param {String} [params.phenotypes] - Comma separated list of phenotype ids or names.
  * @param {String} [params.disorders] - Comma separated list of disorder ids or names.
  * @param {String} [params.creationDate] - Creation date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {String} [params.modificationDate] - Modification date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {Boolean} [params.deleted = "false"] - Boolean to retrieve deleted families. The default value is false.
  * @param {String} [params.annotationsetName] - DEPRECATED: Use annotation queryParam this way:
  *     annotationSet[=|==|!|!=]{annotationSetName}.
  * @param {String} [params.variableSet] - DEPRECATED: Use annotation queryParam this way: variableSet[=|==|!|!=]{variableSetId}.
  * @param {String} [params.annotation] - Annotation, e.g: key1=value(,key2=value).
  * @param {String} [params.acl] - Filter entries for which a user has the provided permissions. Format: acl={user}:{permissions}.
  *     Example: acl=john:WRITE,WRITE_ANNOTATIONS will return all entries for which user john has both WRITE and WRITE_ANNOTATIONS
  *     permissions. Only study owners or administrators can query by this field. .
  * @param {String} [params.release] - Release value (Current release from the moment the families were first created).
  * @param {Number} [params.snapshot] - Snapshot value (Latest version of families in the specified release).
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  search(params) {
    return this._get("families", null, null, null, "search", params);
  }
  /** Returns the acl of the families. If member is provided, it will only return the acl for the member.
  * @param {String} families - Comma separated list of family IDs or names up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.member] - User or group id.
  * @param {Boolean} [params.silent = "false"] - Boolean to retrieve all possible entries that are queried for, false to raise an
  *     exception whenever one of the entries looked for cannot be shown for whichever reason. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  acl(families, params) {
    return this._get("families", families, null, null, "acl", params);
  }
  /** Delete existing families
  * @param {String} [families] - Comma separated list of family ids.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  delete(families, params) {
    return this._delete("families", families, null, null, "delete", params);
  }
  /** Get family information
  * @param {String} families - Comma separated list of family IDs or names up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Boolean} [params.flattenAnnotations = "false"] - Flatten the annotations?. The default value is false.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Number} [params.version] - Family version.
  * @param {Boolean} [params.deleted = "false"] - Boolean to retrieve deleted families. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  info(families, params) {
    return this._get("families", families, null, null, "info", params);
  }
  /** Update some family attributes
  * @param {String} families - Comma separated list of family ids.
  * @param {Object} [data] - params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Boolean} [params.incVersion = "false"] - Create a new version of family. The default value is false.
  * @param {Boolean} [params.updateIndividualVersion = "false"] - Update all the individual references from the family to point to their
  *     latest versions. The default value is false.
  * @param {"ADD"|"SET"|"REMOVE"} [params.annotationSetsAction = "ADD"] - Action to be performed if the array of annotationSets is being
  *     updated. The default value is ADD.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  update(families, data, params) {
    return this._post("families", families, null, null, "update", data, params);
  }
  /** Update annotations from an annotationSet
  * @param {String} family - Family id.
  * @param {String} [annotationSet] - AnnotationSet id to be updated.
  * @param {Object} [data] - Json containing the map of annotations when the action is ADD, SET or REPLACE, a json with only the key
  *     'remove' containing the comma separated variables to be removed as a value when the action is REMOVE or a json with only the key
  *     'reset' containing the comma separated variables that will be set to the default value when the action is RESET.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {"ADD"|"SET"|"REMOVE"|"RESET"|"REPLACE"} [params.action = "ADD"] - Action to be performed: ADD to add new annotations; REPLACE
  *     to replace the value of an already existing annotation; SET to set the new list of annotations removing any possible old annotations;
  *     REMOVE to remove some annotations; RESET to set some annotations to the default value configured in the corresponding variables of the
  *     VariableSet if any. The default value is ADD.
  * @param {Boolean} [params.incVersion = "false"] - Create a new version of family. The default value is false.
  * @param {Boolean} [params.updateSampleVersion = "false"] - Update all the individual references from the family to point to their
  *     latest versions. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateAnnotations(family, annotationSet, data, params) {
    return this._post("families", family, "annotationSets", annotationSet, "annotations/update", data, params);
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/api/File.js
function File_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function File_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { File_ownKeys(Object(source), true).forEach(function (key) { File_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { File_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function File_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2020 OpenCB
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * WARNING: AUTOGENERATED CODE
 *
 * This code was generated by a tool.
 * Autogenerated on: 2020-02-27 10:51:26
 *
 * Manual changes to this file may cause unexpected behavior in your application.
 * Manual changes to this file will be overwritten if the code is regenerated.
 *
**/

/**
 * This class contains the methods for the "File" resource
 */

class File_File extends opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    super(config);
  }
  /** Update the set of permissions granted for the member
  * @param {String} members - Comma separated list of user or group ids.
  * @param {Object} data - JSON containing the parameters to add ACLs.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateAcl(members, data, params) {
    return this._post("files", members, null, null, "update", data, params);
  }
  /** Fetch catalog file stats
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.name] - Name.
  * @param {String} [params.type] - Type.
  * @param {String} [params.format] - Format.
  * @param {String} [params.bioformat] - Bioformat.
  * @param {String} [params.creationYear] - Creation year.
  * @param {String} [params.creationMonth] - Creation month (JANUARY, FEBRUARY...).
  * @param {String} [params.creationDay] - Creation day.
  * @param {String} [params.creationDayOfWeek] - Creation day of week (MONDAY, TUESDAY...).
  * @param {String} [params.status] - Status.
  * @param {String} [params.release] - Release.
  * @param {Boolean} [params.external] - External.
  * @param {String} [params.size] - Size.
  * @param {String} [params.software] - Software.
  * @param {String} [params.experiment] - Experiment.
  * @param {String} [params.numSamples] - Number of samples.
  * @param {String} [params.numRelatedFiles] - Number of related files.
  * @param {String} [params.annotation] - Annotation, e.g: key1=value(,key2=value).
  * @param {Boolean} [params.default = "false"] - Calculate default stats. The default value is false.
  * @param {String} [params.field] - List of fields separated by semicolons, e.g.: studies;type. For nested fields use >>, e.g.:
  *     studies>>biotype;type;numSamples[0..10]:1.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  aggregationStats(params) {
    return this._get("files", null, null, null, "aggregationStats", params);
  }
  /** Load annotation sets from a TSV file
  * @param {Object} [data] - JSON containing the 'content' of the TSV file if this has not yet been registered into OpenCGA.
  * @param {String} variableSetId - Variable set id or name.
  * @param {String} path - Path where the TSV file is located in OpenCGA or where it should be located.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Boolean} [params.parents] - Flag indicating whether to create parent directories if they don't exist (only when TSV file was
  *     not previously associated).
  * @param {String} [params.annotationSetId] - Annotation set id. If not provided, variableSetId will be used.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  loadAnnotationSets(variableSetId, path, data, params) {
    return this._post("files", null, "annotationSets", null, "load", data, File_objectSpread({
      variableSetId,
      path
    }, params));
  }
  /** List of accepted file bioformats
  *
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  bioformats() {
    return this._get("files", null, null, null, "bioformats");
  }
  /** Create file or folder
  * @param {Object} data - File parameters.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  create(data, params) {
    return this._post("files", null, null, null, "create", data, params);
  }
  /** Download an external file to catalog and register it
  * @param {Object} data - Fetch parameters.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  fetch(data, params) {
    return this._post("files", null, null, null, "fetch", data, params);
  }
  /** List of accepted file formats
  *
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  formats() {
    return this._get("files", null, null, null, "formats");
  }
  /** Link an external file into catalog.
  * @param {Object} data - File parameters.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Boolean} [params.parents] - Create the parent directories if they do not exist.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  link(data, params) {
    return this._post("files", null, null, null, "link", data, params);
  }
  /** File search method.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {Boolean} [params.count = "false"] - Get the total number of results matching the query. Deactivated by default. The default
  *     value is false.
  * @param {Boolean} [params.lazy = "true"] - False to return entire job and experiment object. The default value is true.
  * @param {Boolean} [params.flattenAnnotations = "false"] - Flatten the annotations?. The default value is false.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.name] - Comma separated list of file names.
  * @param {String} [params.path] - Comma separated list of paths.
  * @param {String} [params.type] - File type, either FILE or DIRECTORY.
  * @param {String} [params.bioformat] - Comma separated Bioformat values. For existing Bioformats see files/bioformats.
  * @param {String} [params.format] - Comma separated Format values. For existing Formats see files/formats.
  * @param {String} [params.status] - File status.
  * @param {String} [params.directory] - Directory under which we want to look for files or folders.
  * @param {String} [params.creationDate] - Creation date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {String} [params.modificationDate] - Modification date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {String} [params.description] - Description.
  * @param {String} [params.tags] - Tags.
  * @param {String} [params.size] - File size.
  * @param {String} [params.samples] - Comma separated list sample IDs or UUIDs up to a maximum of 100.
  * @param {String} [params.job.id] - Job id that created the file(s) or folder(s).
  * @param {String} [params.annotation] - Annotation, e.g: key1=value(,key2=value).
  * @param {String} [params.acl] - Filter entries for which a user has the provided permissions. Format: acl={user}:{permissions}.
  *     Example: acl=john:WRITE,WRITE_ANNOTATIONS will return all entries for which user john has both WRITE and WRITE_ANNOTATIONS
  *     permissions. Only study owners or administrators can query by this field. .
  * @param {Boolean} [params.deleted = "false"] - Boolean to retrieve deleted files. The default value is false.
  * @param {String} [params.attributes] - Text attributes (Format: sex=male,age>20 ...).
  * @param {String} [params.nattributes] - Numerical attributes (Format: sex=male,age>20 ...).
  * @param {String} [params.release] - Release value.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  search(params) {
    return this._get("files", null, null, null, "search", params);
  }
  /** Resource to upload a file by chunks
  *
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  upload() {
    return this._post("files", null, null, null, "upload");
  }
  /** Return the acl defined for the file or folder. If member is provided, it will only return the acl for the member.
  * @param {String} files - Comma separated list of file ids or names up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Comma separated list of Studies [[user@]project:]study where study and project can be either the ID
  *     or UUID up to a maximum of 100.
  * @param {String} [params.member] - User or group id.
  * @param {Boolean} [params.silent = "false"] - Boolean to retrieve all possible entries that are queried for, false to raise an
  *     exception whenever one of the entries looked for cannot be shown for whichever reason. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  acl(files, params) {
    return this._get("files", files, null, null, "acl", params);
  }
  /** Delete existing files and folders
  * @param {String} [files] - Comma separated list of file ids, names or paths.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Boolean} [params.skipTrash = "false"] - Skip trash and delete the files/folders from disk directly (CANNOT BE RECOVERED). The
  *     default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  delete(files, params) {
    return this._delete("files", files, null, null, "delete", params);
  }
  /** File info
  * @param {String} [files] - Comma separated list of file ids or names up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Boolean} [params.lazy = "true"] - False to return entire job and experiment object. The default value is true.
  * @param {Boolean} [params.flattenAnnotations = "false"] - Flatten the annotations?. The default value is false.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Boolean} [params.deleted = "false"] - Boolean to retrieve deleted files. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  info(files, params) {
    return this._get("files", files, null, null, "info", params);
  }
  /** Unlink linked files and folders
  * @param {String} [files] - Comma separated list of file ids, names or paths.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  unlink(files, params) {
    return this._delete("files", files, null, null, "unlink", params);
  }
  /** Update some file attributes
  * @param {String} [files] - Comma separated list of file ids, names or paths. Paths must be separated by : instead of /.
  * @param {Object} data - Parameters to modify.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {"ADD"|"SET"|"REMOVE"} [params.samplesAction = "ADD"] - Action to be performed if the array of samples is being updated. The
  *     default value is ADD.
  * @param {"ADD"|"SET"|"REMOVE"} [params.annotationSetsAction = "ADD"] - Action to be performed if the array of annotationSets is being
  *     updated. The default value is ADD.
  * @param {"ADD"|"SET"|"REMOVE"} [params.relatedFilesAction = "ADD"] - Action to be performed if the array of relatedFiles is being
  *     updated. The default value is ADD.
  * @param {"ADD"|"SET"|"REMOVE"} [params.tagsAction = "ADD"] - Action to be performed if the array of tags is being updated. The default
  *     value is ADD.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  update(files, data, params) {
    return this._post("files", files, null, null, "update", data, params);
  }
  /** Update annotations from an annotationSet
  * @param {String} file - File id, name or path. Paths must be separated by : instead of /.
  * @param {String} [annotationSet] - AnnotationSet id to be updated.
  * @param {Object} [data] - Json containing the map of annotations when the action is ADD, SET or REPLACE, a json with only the key
  *     'remove' containing the comma separated variables to be removed as a value when the action is REMOVE or a json with only the key
  *     'reset' containing the comma separated variables that will be set to the default value when the action is RESET.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {"ADD"|"SET"|"REMOVE"} [params.action = "ADD"] - Action to be performed: ADD to add new annotations; REPLACE to replace the
  *     value of an already existing annotation; SET to set the new list of annotations removing any possible old annotations; REMOVE to
  *     remove some annotations; RESET to set some annotations to the default value configured in the corresponding variables of the
  *     VariableSet if any. The default value is ADD.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateAnnotations(file, annotationSet, data, params) {
    return this._post("files", file, "annotationSets", annotationSet, "annotations/update", data, params);
  }
  /** Show the content of a file (up to a limit)
  * @param {String} [file] - File uuid, id, or name.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Number} [params.offset] - Starting byte from which the file will be read.
  * @param {Number} [params.lines] - Maximum number of lines to be returned.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  content(file, params) {
    return this._get("files", file, null, null, "content", params);
  }
  /** Download file
  * @param {String} [file] - File id, name or path. Paths must be separated by : instead of /.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  download(file, params) {
    return this._get("files", file, null, null, "download", params);
  }
  /** Filter lines of the file containing the pattern
  * @param {String} [file] - File uuid, id, or name.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.pattern] - String pattern.
  * @param {Boolean} [params.ignoreCase] - Flag to perform a case insensitive search.
  * @param {Number} [params.maxCount] - Stop reading a file after 'n' matching lines. 0 means no limit.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  grep(file, params) {
    return this._get("files", file, null, null, "grep", params);
  }
  /** Show the first lines of a file (up to a limit)
  * @param {String} [file] - File uuid, id, or name.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Number} [params.lines] - Maximum number of lines to be returned.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  head(file, params) {
    return this._get("files", file, null, null, "head", params);
  }
  /** Refresh metadata from the selected file or folder. Return updated files.
  * @param {String} [file] - File id, name or path. Paths must be separated by : instead of /.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  refresh(file, params) {
    return this._get("files", file, null, null, "refresh", params);
  }
  /** Show the last lines of a file (up to a limit)
  * @param {String} [file] - File uuid, id, or name.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Number} [params.lines] - Maximum number of lines to be returned.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  tail(file, params) {
    return this._get("files", file, null, null, "tail", params);
  }
  /** List all the files inside the folder
  * @param {String} [folder] - Folder id, name or path.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {Boolean} [params.count = "false"] - Get the total number of results matching the query. Deactivated by default. The default
  *     value is false.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  list(folder, params) {
    return this._get("files", folder, null, null, "list", params);
  }
  /** Obtain a tree view of the files and folders within a folder
  * @param {String} [folder] - Folder id, name or path. Paths must be separated by : instead of /.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - [PENDING] Number of results to be returned.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Number} [params.maxDepth] - Maximum depth to get files from.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  tree(folder, params) {
    return this._get("files", folder, null, null, "tree", params);
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/api/GA4GH.js
function GA4GH_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function GA4GH_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { GA4GH_ownKeys(Object(source), true).forEach(function (key) { GA4GH_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { GA4GH_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function GA4GH_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2020 OpenCB
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * WARNING: AUTOGENERATED CODE
 *
 * This code was generated by a tool.
 * Autogenerated on: 2020-02-27 10:51:26
 *
 * Manual changes to this file may cause unexpected behavior in your application.
 * Manual changes to this file will be overwritten if the code is regenerated.
 *
**/

/**
 * This class contains the methods for the "GA4GH" resource
 */

class GA4GH_GA4GH extends opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    super(config);
  }
  /** Description
  *
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  searchReads() {
    return this._post("ga4gh", null, "reads", null, "search");
  }
  /** Fetch alignment files using HTSget protocol
  * @param {String} [file] - File id, name or path.
  * @param {String} [study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.referenceName] - Reference sequence name (Example: 'chr1', '1' or 'chrX'.
  * @param {Number} [params.start] - The start position of the range on the reference, 0-based, inclusive.
  * @param {Number} [params.end] - The end position of the range on the reference, 0-based, exclusive.
  * @param {String} [params.referenceGenome] - Reference genome.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  fetchReads(study, file, params) {
    return this._get("ga4gh", study, null, file, null, params);
  }
  /** Beacon webservice
  * @param {String} chrom - Chromosome ID. Accepted values: 1-22, X, Y, MT. Note: For compatibility with conventions set by some of the
  *     existing beacons, an arbitrary prefix is accepted as well (e.g. chr1 is equivalent to chrom1 and 1).
  * @param {Number} pos - Coordinate within a chromosome. Position is a number and is 0-based.
  * @param {String} allele - Any string of nucleotides A,C,T,G or D, I for deletion and insertion, respectively. Note: For compatibility
  *     with conventions set by some of the existing beacons, DEL and INS identifiers are also accepted.
  * @param {String} beacon - Beacon IDs. If specified, only beacons with the given IDs are queried. Responses from all the supported
  *     beacons are obtained otherwise. Format: [id1,id2].
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.ref] - Genome ID. If not specified, all the genomes supported by the given beacons are queried. Note: For
  *     compatibility with conventions set by some of the existing beacons, both GRC or HG notation are accepted, case insensitive.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  responses(chrom, pos, allele, beacon, params) {
    return this._get("ga4gh", null, null, null, "responses", GA4GH_objectSpread({
      chrom,
      pos,
      allele,
      beacon
    }, params));
  }
  /** Description
  *
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  searchVariants() {
    return this._post("ga4gh", null, "variants", null, "search");
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/api/Individual.js
function Individual_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function Individual_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { Individual_ownKeys(Object(source), true).forEach(function (key) { Individual_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { Individual_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function Individual_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2020 OpenCB
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * WARNING: AUTOGENERATED CODE
 *
 * This code was generated by a tool.
 * Autogenerated on: 2020-02-27 10:51:26
 *
 * Manual changes to this file may cause unexpected behavior in your application.
 * Manual changes to this file will be overwritten if the code is regenerated.
 *
**/

/**
 * This class contains the methods for the "Individual" resource
 */

class Individual_Individual extends opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    super(config);
  }
  /** Update the set of permissions granted for the member
  * @param {String} members - Comma separated list of user or group ids.
  * @param {Object} data - JSON containing the parameters to update the permissions. If propagate flag is set to true, it will propagate
  *     the permissions defined to the samples that are associated to the matching individuals.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateAcl(members, data, params) {
    return this._post("individuals", members, null, null, "update", data, params);
  }
  /** Fetch catalog individual stats
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Boolean} [params.hasFather] - Has father.
  * @param {Boolean} [params.hasMother] - Has mother.
  * @param {String} [params.numMultiples] - Number of multiples.
  * @param {String} [params.multiplesType] - Multiples type.
  * @param {String} [params.sex] - Sex.
  * @param {String} [params.karyotypicSex] - Karyotypic sex.
  * @param {String} [params.ethnicity] - Ethnicity.
  * @param {String} [params.population] - Population.
  * @param {String} [params.creationYear] - Creation year.
  * @param {String} [params.creationMonth] - Creation month (JANUARY, FEBRUARY...).
  * @param {String} [params.creationDay] - Creation day.
  * @param {String} [params.creationDayOfWeek] - Creation day of week (MONDAY, TUESDAY...).
  * @param {String} [params.status] - Status.
  * @param {String} [params.lifeStatus] - Life status.
  * @param {String} [params.affectationStatus] - Affectation status.
  * @param {String} [params.phenotypes] - Phenotypes.
  * @param {String} [params.numSamples] - Number of samples.
  * @param {Boolean} [params.parentalConsanguinity] - Parental consanguinity.
  * @param {String} [params.release] - Release.
  * @param {String} [params.version] - Version.
  * @param {String} [params.annotation] - Annotation, e.g: key1=value(,key2=value).
  * @param {Boolean} [params.default = "false"] - Calculate default stats. The default value is false.
  * @param {String} [params.field] - List of fields separated by semicolons, e.g.: studies;type. For nested fields use >>, e.g.:
  *     studies>>biotype;type;numSamples[0..10]:1.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  aggregationStats(params) {
    return this._get("individuals", null, null, null, "aggregationStats", params);
  }
  /** Load annotation sets from a TSV file
  * @param {Object} [data] - JSON containing the 'content' of the TSV file if this has not yet been registered into OpenCGA.
  * @param {String} variableSetId - Variable set id or name.
  * @param {String} path - Path where the TSV file is located in OpenCGA or where it should be located.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Boolean} [params.parents] - Flag indicating whether to create parent directories if they don't exist (only when TSV file was
  *     not previously associated).
  * @param {String} [params.annotationSetId] - Annotation set id. If not provided, variableSetId will be used.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  loadAnnotationSets(variableSetId, path, data, params) {
    return this._post("individuals", null, "annotationSets", null, "load", data, Individual_objectSpread({
      variableSetId,
      path
    }, params));
  }
  /** Create individual
  * @param {Object} data - JSON containing individual information.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.samples] - Comma separated list of sample ids to be associated to the created individual.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  create(data, params) {
    return this._post("individuals", null, null, null, "create", data, params);
  }
  /** Search for individuals
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {Boolean} [params.count = "false"] - Get the total number of results matching the query. Deactivated by default. The default
  *     value is false.
  * @param {Boolean} [params.flattenAnnotations = "false"] - Flatten the annotations?. The default value is false.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the id or alias.
  * @param {String} [params.name] - name.
  * @param {String} [params.father] - father.
  * @param {String} [params.mother] - mother.
  * @param {String} [params.samples] - Comma separated list sample IDs or UUIDs up to a maximum of 100.
  * @param {String} [params.sex] - sex.
  * @param {String} [params.ethnicity] - ethnicity.
  * @param {String} [params.disorders] - Comma separated list of disorder ids or names.
  * @param {String} [params.population.name] - Population name.
  * @param {String} [params.population.subpopulation] - Subpopulation name.
  * @param {String} [params.population.description] - Population description.
  * @param {String} [params.phenotypes] - Comma separated list of phenotype ids or names.
  * @param {String} [params.karyotypicSex] - Karyotypic sex.
  * @param {String} [params.lifeStatus] - Life status.
  * @param {String} [params.affectationStatus] - Affectation status.
  * @param {Boolean} [params.deleted = "false"] - Boolean to retrieve deleted individuals. The default value is false.
  * @param {String} [params.creationDate] - Creation date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {String} [params.modificationDate] - Modification date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {String} [params.annotationsetName] - DEPRECATED: Use annotation queryParam this way:
  *     annotationSet[=|==|!|!=]{annotationSetName}.
  * @param {String} [params.variableSet] - DEPRECATED: Use annotation queryParam this way: variableSet[=|==|!|!=]{variableSetId}.
  * @param {String} [params.annotation] - Annotation, e.g: key1=value(,key2=value).
  * @param {String} [params.acl] - Filter entries for which a user has the provided permissions. Format: acl={user}:{permissions}.
  *     Example: acl=john:WRITE,WRITE_ANNOTATIONS will return all entries for which user john has both WRITE and WRITE_ANNOTATIONS
  *     permissions. Only study owners or administrators can query by this field. .
  * @param {String} [params.release] - Release value (Current release from the moment the individuals were first created).
  * @param {Number} [params.snapshot] - Snapshot value (Latest version of individuals in the specified release).
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  search(params) {
    return this._get("individuals", null, null, null, "search", params);
  }
  /** Return the acl of the individual. If member is provided, it will only return the acl for the member.
  * @param {String} individuals - Comma separated list of individual names or ids up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.member] - User or group id.
  * @param {Boolean} [params.silent = "false"] - Boolean to retrieve all possible entries that are queried for, false to raise an
  *     exception whenever one of the entries looked for cannot be shown for whichever reason. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  acl(individuals, params) {
    return this._get("individuals", individuals, null, null, "acl", params);
  }
  /** Delete existing individuals
  * @param {String} [individuals] - Comma separated list of individual ids.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {Boolean} [params.force = "false"] - Force the deletion of individuals that already belong to families. The default value is
  *     false.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  delete(individuals, params) {
    return this._delete("individuals", individuals, null, null, "delete", params);
  }
  /** Get individual information
  * @param {String} individuals - Comma separated list of individual names or ids up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Boolean} [params.flattenAnnotations = "false"] - Flatten the annotations?. The default value is false.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Number} [params.version] - Individual version.
  * @param {Boolean} [params.deleted = "false"] - Boolean to retrieve deleted individuals. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  info(individuals, params) {
    return this._get("individuals", individuals, null, null, "info", params);
  }
  /** Update some individual attributes
  * @param {String} individuals - Comma separated list of individual ids.
  * @param {Object} [data] - params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {"ADD"|"SET"|"REMOVE"} [params.samplesAction = "ADD"] - Action to be performed if the array of samples is being updated. The
  *     default value is ADD.
  * @param {"ADD"|"SET"|"REMOVE"} [params.annotationSetsAction = "ADD"] - Action to be performed if the array of annotationSets is being
  *     updated. The default value is ADD.
  * @param {Boolean} [params.incVersion = "false"] - Create a new version of individual. The default value is false.
  * @param {Boolean} [params.updateSampleVersion = "false"] - Update all the sample references from the individual to point to their
  *     latest versions. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  update(individuals, data, params) {
    return this._post("individuals", individuals, null, null, "update", data, params);
  }
  /** Update annotations from an annotationSet
  * @param {String} individual - Individual ID or name.
  * @param {String} [annotationSet] - AnnotationSet id to be updated.
  * @param {Object} [data] - Json containing the map of annotations when the action is ADD, SET or REPLACE, a json with only the key
  *     'remove' containing the comma separated variables to be removed as a value when the action is REMOVE or a json with only the key
  *     'reset' containing the comma separated variables that will be set to the default value when the action is RESET.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {"ADD"|"SET"|"REMOVE"|"RESET"|"REPLACE"} [params.action = "ADD"] - Action to be performed: ADD to add new annotations; REPLACE
  *     to replace the value of an already existing annotation; SET to set the new list of annotations removing any possible old annotations;
  *     REMOVE to remove some annotations; RESET to set some annotations to the default value configured in the corresponding variables of the
  *     VariableSet if any. The default value is ADD.
  * @param {Boolean} [params.incVersion = "false"] - Create a new version of individual. The default value is false.
  * @param {Boolean} [params.updateSampleVersion = "false"] - Update all the sample references from the individual to point to their
  *     latest versions. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateAnnotations(individual, annotationSet, data, params) {
    return this._post("individuals", individual, "annotationSets", annotationSet, "annotations/update", data, params);
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/api/Job.js
/**
 * Copyright 2015-2020 OpenCB
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * WARNING: AUTOGENERATED CODE
 *
 * This code was generated by a tool.
 * Autogenerated on: 2020-02-27 10:51:26
 *
 * Manual changes to this file may cause unexpected behavior in your application.
 * Manual changes to this file will be overwritten if the code is regenerated.
 *
**/

/**
 * This class contains the methods for the "Job" resource
 */

class Job_Job extends opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    super(config);
  }
  /** Update the set of permissions granted for the member
  * @param {String} members - Comma separated list of user or group ids.
  * @param {Object} data - JSON containing the parameters to add ACLs.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateAcl(members, data) {
    return this._post("jobs", members, null, null, "update", data);
  }
  /** Register an executed job with POST method
  * @param {Object} data - job.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  create(data, params) {
    return this._post("jobs", null, null, null, "create", data, params);
  }
  /** Job search method
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {Boolean} [params.count = "false"] - Get the total number of results matching the query. Deactivated by default. The default
  *     value is false.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.id] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.tool] - Tool executed by the job.
  * @param {String} [params.user] - User that created the job.
  * @param {String} [params.priority] - Priority of the job.
  * @param {String} [params.status] - Job status.
  * @param {String} [params.creationDate] - Creation date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {String} [params.modificationDate] - Modification date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {Boolean} [params.visited] - Visited status of job.
  * @param {String} [params.tags] - Job tags.
  * @param {String} [params.input] - Comma separated list of file ids used as input.
  * @param {String} [params.output] - Comma separated list of file ids used as output.
  * @param {String} [params.acl] - Filter entries for which a user has the provided permissions. Format: acl={user}:{permissions}.
  *     Example: acl=john:WRITE,WRITE_ANNOTATIONS will return all entries for which user john has both WRITE and WRITE_ANNOTATIONS
  *     permissions. Only study owners or administrators can query by this field. .
  * @param {String} [params.release] - Release when it was created.
  * @param {Boolean} [params.deleted = "false"] - Boolean to retrieve deleted jobs. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  search(params) {
    return this._get("jobs", null, null, null, "search", params);
  }
  /** Return the acl of the job. If member is provided, it will only return the acl for the member.
  * @param {String} jobs - Comma separated list of job IDs or UUIDs up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.member] - User or group id.
  * @param {Boolean} [params.silent = "false"] - Boolean to retrieve all possible entries that are queried for, false to raise an
  *     exception whenever one of the entries looked for cannot be shown for whichever reason. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  acl(jobs, params) {
    return this._get("jobs", jobs, null, null, "acl", params);
  }
  /** Delete existing jobs
  * @param {String} [jobs] - Comma separated list of job ids.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  delete(jobs, params) {
    return this._delete("jobs", jobs, null, null, "delete", params);
  }
  /** Get job information
  * @param {String} jobs - Comma separated list of job IDs or UUIDs up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Boolean} [params.deleted = "false"] - Boolean to retrieve deleted jobs. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  info(jobs, params) {
    return this._get("jobs", jobs, null, null, "info", params);
  }
  /** Update some job attributes
  * @param {String} jobs - Comma separated list of job IDs or UUIDs up to a maximum of 100.
  * @param {Object} [data] - params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  update(jobs, data, params) {
    return this._post("jobs", jobs, null, null, "update", data, params);
  }
  /** Get the log content of a job
  * @param {String} job - Job ID or UUID.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Number} [params.offset] - Starting byte from which the file will be read.
  * @param {Number} [params.lines] - Maximum number of lines to be returned.
  * @param {String} [params.type] - Log file to be shown (stdout or stderr).
  * @param {Boolean} [params.tail] - Flag indicating to output the last part of the file.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  log(job, params) {
    return this._get("jobs", job, null, null, "log", params);
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/api/Meta.js
/**
 * Copyright 2015-2020 OpenCB
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * WARNING: AUTOGENERATED CODE
 *
 * This code was generated by a tool.
 * Autogenerated on: 2020-02-27 10:51:26
 *
 * Manual changes to this file may cause unexpected behavior in your application.
 * Manual changes to this file will be overwritten if the code is regenerated.
 *
**/

/**
 * This class contains the methods for the "Meta" resource
 */

class Meta_Meta extends opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    super(config);
  }
  /** Returns info about current OpenCGA code.
  *
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  about() {
    return this._get("meta", null, null, null, "about");
  }
  /** API
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.category] - List of categories to get API from.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  api(params) {
    return this._get("meta", null, null, null, "api", params);
  }
  /** Ping Opencga webservices.
  *
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  fail() {
    return this._get("meta", null, null, null, "fail");
  }
  /** Ping Opencga webservices.
  *
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  ping() {
    return this._get("meta", null, null, null, "ping");
  }
  /** Database status.
  *
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  status() {
    return this._get("meta", null, null, null, "status");
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/api/Project.js
/**
 * Copyright 2015-2020 OpenCB
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * WARNING: AUTOGENERATED CODE
 *
 * This code was generated by a tool.
 * Autogenerated on: 2020-02-27 10:51:26
 *
 * Manual changes to this file may cause unexpected behavior in your application.
 * Manual changes to this file will be overwritten if the code is regenerated.
 *
**/

/**
 * This class contains the methods for the "Project" resource
 */

class Project_Project extends opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    super(config);
  }
  /** Create a new project
  * @param {Object} data - JSON containing the mandatory parameters.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  create(data) {
    return this._post("projects", null, null, null, "create", data);
  }
  /** Search projects
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {String} [params.owner] - Owner of the project.
  * @param {String} [params.id] - Project [user@]project where project can be either the ID or the alias.
  * @param {String} [params.name] - Project name.
  * @param {String} [params.fqn] - Project fqn.
  * @param {String} [params.alias] - DEPRECATED: Project alias.
  * @param {String} [params.organization] - Project organization.
  * @param {String} [params.description] - Project description.
  * @param {String} [params.study] - Study id or alias.
  * @param {String} [params.creationDate] - Creation date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {String} [params.modificationDate] - Modification date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {String} [params.status] - Status.
  * @param {String} [params.attributes] - Attributes.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  search(params) {
    return this._get("projects", null, null, null, "search", params);
  }
  /** Fetch catalog project stats
  * @param {String} projects - Comma separated list of projects [user@]project up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {Boolean} [params.default = "true"] - Calculate default stats. The default value is true.
  * @param {String} [params.fileFields] - List of file fields separated by semicolons, e.g.: studies;type. For nested fields use >>, e.g.:
  *     studies>>biotype;type.
  * @param {String} [params.individualFields] - List of individual fields separated by semicolons, e.g.: studies;type. For nested fields
  *     use >>, e.g.: studies>>biotype;type.
  * @param {String} [params.familyFields] - List of family fields separated by semicolons, e.g.: studies;type. For nested fields use >>,
  *     e.g.: studies>>biotype;type.
  * @param {String} [params.sampleFields] - List of sample fields separated by semicolons, e.g.: studies;type. For nested fields use >>,
  *     e.g.: studies>>biotype;type.
  * @param {String} [params.cohortFields] - List of cohort fields separated by semicolons, e.g.: studies;type. For nested fields use >>,
  *     e.g.: studies>>biotype;type.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  aggregationStats(projects, params) {
    return this._get("projects", projects, null, null, "aggregationStats", params);
  }
  /** Fetch project information
  * @param {String} projects - Comma separated list of projects [user@]project up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  info(projects, params) {
    return this._get("projects", projects, null, null, "info", params);
  }
  /** Increment current release number in the project
  * @param {String} project - Project [user@]project where project can be either the ID or the alias.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  incRelease(project) {
    return this._post("projects", project, null, null, "incRelease");
  }
  /** Fetch all the studies contained in the project
  * @param {String} project - Project [user@]project where project can be either the ID or the alias.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  studies(project, params) {
    return this._get("projects", project, null, null, "studies", params);
  }
  /** Update some project attributes
  * @param {String} project - Project [user@]project where project can be either the ID or the alias.
  * @param {Object} data - JSON containing the params to be updated. It will be only possible to update organism fields not previously
  *     defined.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  update(project, data) {
    return this._post("projects", project, null, null, "update", data);
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/api/Sample.js
function Sample_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function Sample_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { Sample_ownKeys(Object(source), true).forEach(function (key) { Sample_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { Sample_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function Sample_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2020 OpenCB
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * WARNING: AUTOGENERATED CODE
 *
 * This code was generated by a tool.
 * Autogenerated on: 2020-02-27 10:51:26
 *
 * Manual changes to this file may cause unexpected behavior in your application.
 * Manual changes to this file will be overwritten if the code is regenerated.
 *
**/

/**
 * This class contains the methods for the "Sample" resource
 */

class Sample_Sample extends opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    super(config);
  }
  /** Update the set of permissions granted for the member
  * @param {String} members - Comma separated list of user or group ids.
  * @param {Object} data - JSON containing the parameters to update the permissions. If propagate flag is set to true, it will propagate
  *     the permissions defined to the individuals that are associated to the matching samples.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateAcl(members, data, params) {
    return this._post("samples", members, null, null, "update", data, params);
  }
  /** Fetch catalog sample stats
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.source] - Source.
  * @param {String} [params.creationYear] - Creation year.
  * @param {String} [params.creationMonth] - Creation month (JANUARY, FEBRUARY...).
  * @param {String} [params.creationDay] - Creation day.
  * @param {String} [params.creationDayOfWeek] - Creation day of week (MONDAY, TUESDAY...).
  * @param {String} [params.status] - Status.
  * @param {String} [params.type] - Type.
  * @param {String} [params.phenotypes] - Phenotypes.
  * @param {String} [params.release] - Release.
  * @param {String} [params.version] - Version.
  * @param {Boolean} [params.somatic] - Somatic.
  * @param {String} [params.annotation] - Annotation, e.g: key1=value(,key2=value).
  * @param {Boolean} [params.default = "false"] - Calculate default stats. The default value is false.
  * @param {String} [params.field] - List of fields separated by semicolons, e.g.: studies;type. For nested fields use >>, e.g.:
  *     studies>>biotype;type;numSamples[0..10]:1.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  aggregationStats(params) {
    return this._get("samples", null, null, null, "aggregationStats", params);
  }
  /** Load annotation sets from a TSV file
  * @param {Object} [data] - JSON containing the 'content' of the TSV file if this has not yet been registered into OpenCGA.
  * @param {String} variableSetId - Variable set id or name.
  * @param {String} path - Path where the TSV file is located in OpenCGA or where it should be located.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Boolean} [params.parents] - Flag indicating whether to create parent directories if they don't exist (only when TSV file was
  *     not previously associated).
  * @param {String} [params.annotationSetId] - Annotation set id. If not provided, variableSetId will be used.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  loadAnnotationSets(variableSetId, path, data, params) {
    return this._post("samples", null, "annotationSets", null, "load", data, Sample_objectSpread({
      variableSetId,
      path
    }, params));
  }
  /** Create sample
  * @param {Object} data - JSON containing sample information.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.individual] - DEPRECATED: It should be passed in the body.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  create(data, params) {
    return this._post("samples", null, null, null, "create", data, params);
  }
  /** Load samples from a ped file [EXPERIMENTAL]
  * @param {String} file - file.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.variableSet] - variableSet.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  load(file, params) {
    return this._get("samples", null, null, null, "load", Sample_objectSpread({
      file
    }, params));
  }
  /** Sample search method
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {Boolean} [params.count = "false"] - Get the total number of results matching the query. Deactivated by default. The default
  *     value is false.
  * @param {Boolean} [params.includeIndividual = "false"] - Include Individual object as an attribute (this replaces old lazy parameter).
  *     The default value is false.
  * @param {Boolean} [params.flattenAnnotations = "false"] - Flatten the annotations?. The default value is false.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.name] - DEPRECATED: name.
  * @param {String} [params.source] - source.
  * @param {String} [params.type] - type.
  * @param {Boolean} [params.somatic] - somatic.
  * @param {String} [params.individual] - Individual ID or name.
  * @param {String} [params.creationDate] - Creation date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {String} [params.modificationDate] - Modification date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {Boolean} [params.deleted = "false"] - Boolean to retrieve deleted samples. The default value is false.
  * @param {String} [params.phenotypes] - Comma separated list of phenotype ids or names.
  * @param {String} [params.annotationsetName] - DEPRECATED: Use annotation queryParam this way:
  *     annotationSet[=|==|!|!=]{annotationSetName}.
  * @param {String} [params.variableSet] - DEPRECATED: Use annotation queryParam this way: variableSet[=|==|!|!=]{variableSetId}.
  * @param {String} [params.annotation] - Annotation, e.g: key1=value(,key2=value).
  * @param {String} [params.acl] - Filter entries for which a user has the provided permissions. Format: acl={user}:{permissions}.
  *     Example: acl=john:WRITE,WRITE_ANNOTATIONS will return all entries for which user john has both WRITE and WRITE_ANNOTATIONS
  *     permissions. Only study owners or administrators can query by this field. .
  * @param {String} [params.attributes] - Text attributes (Format: sex=male,age>20 ...).
  * @param {String} [params.nattributes] - Numerical attributes (Format: sex=male,age>20 ...).
  * @param {String} [params.release] - Release value (Current release from the moment the samples were first created).
  * @param {Number} [params.snapshot] - Snapshot value (Latest version of samples in the specified release).
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  search(params) {
    return this._get("samples", null, null, null, "search", params);
  }
  /** Returns the acl of the samples. If member is provided, it will only return the acl for the member.
  * @param {String} samples - Comma separated list sample IDs or UUIDs up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.member] - User or group id.
  * @param {Boolean} [params.silent = "false"] - Boolean to retrieve all possible entries that are queried for, false to raise an
  *     exception whenever one of the entries looked for cannot be shown for whichever reason. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  acl(samples, params) {
    return this._get("samples", samples, null, null, "acl", params);
  }
  /** Delete samples
  * @param {String} [samples] - Comma separated list sample IDs or UUIDs up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {Boolean} [params.force = "false"] - Force the deletion of samples even if they are associated to files, individuals or
  *     cohorts. The default value is false.
  * @param {String} [params.emptyFilesAction = "NONE"] - Action to be performed over files that were associated only to the sample to be
  *     deleted. Possible actions are NONE, TRASH, DELETE. The default value is NONE.
  * @param {Boolean} [params.deleteEmptyCohorts = "false"] - Boolean indicating if the cohorts associated only to the sample to be deleted
  *     should be also deleted. The default value is false.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  delete(samples, params) {
    return this._delete("samples", samples, null, null, "delete", params);
  }
  /** Get sample information
  * @param {String} samples - Comma separated list sample IDs or UUIDs up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Boolean} [params.includeIndividual = "false"] - Include Individual object as an attribute (this replaces old lazy parameter).
  *     The default value is false.
  * @param {Boolean} [params.flattenAnnotations = "false"] - Flatten the annotations?. The default value is false.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Number} [params.version] - Sample version.
  * @param {Boolean} [params.deleted = "false"] - Boolean to retrieve deleted samples. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  info(samples, params) {
    return this._get("samples", samples, null, null, "info", params);
  }
  /** Update some sample attributes
  * @param {String} samples - Comma separated list sample IDs or UUIDs up to a maximum of 100.
  * @param {Object} [data] - params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Boolean} [params.incVersion = "false"] - Create a new version of sample. The default value is false.
  * @param {"ADD"|"SET"|"REMOVE"} [params.annotationSetsAction = "ADD"] - Action to be performed if the array of annotationSets is being
  *     updated. The default value is ADD.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  update(samples, data, params) {
    return this._post("samples", samples, null, null, "update", data, params);
  }
  /** Update annotations from an annotationSet
  * @param {String} sample - Sample id.
  * @param {String} [annotationSet] - AnnotationSet id to be updated.
  * @param {Object} [data] - Json containing the map of annotations when the action is ADD, SET or REPLACE, a json with only the key
  *     'remove' containing the comma separated variables to be removed as a value when the action is REMOVE or a json with only the key
  *     'reset' containing the comma separated variables that will be set to the default value when the action is RESET.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {"ADD"|"SET"|"REMOVE"|"RESET"|"REPLACE"} [params.action = "ADD"] - Action to be performed: ADD to add new annotations; REPLACE
  *     to replace the value of an already existing annotation; SET to set the new list of annotations removing any possible old annotations;
  *     REMOVE to remove some annotations; RESET to set some annotations to the default value configured in the corresponding variables of the
  *     VariableSet if any. The default value is ADD.
  * @param {Boolean} [params.incVersion = "false"] - Create a new version of sample. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateAnnotations(sample, annotationSet, data, params) {
    return this._post("samples", sample, "annotationSets", annotationSet, "annotations/update", data, params);
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/api/Study.js
function Study_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function Study_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { Study_ownKeys(Object(source), true).forEach(function (key) { Study_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { Study_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function Study_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2020 OpenCB
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * WARNING: AUTOGENERATED CODE
 *
 * This code was generated by a tool.
 * Autogenerated on: 2020-02-27 10:51:26
 *
 * Manual changes to this file may cause unexpected behavior in your application.
 * Manual changes to this file will be overwritten if the code is regenerated.
 *
**/

/**
 * This class contains the methods for the "Study" resource
 */

class Study_Study extends opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    super(config);
  }
  /** Update the set of permissions granted for the member
  * @param {String} members - Comma separated list of user or group ids.
  * @param {Object} data - JSON containing the parameters to modify ACLs. 'template' could be either 'admin', 'analyst' or 'view_only'.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateAcl(members, data) {
    return this._post("studies", members, null, null, "update", data);
  }
  /** Create a new study
  * @param {Object} data - study.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.projectId] - Deprecated: Project id.
  * @param {String} [params.project] - Project [user@]project where project can be either the ID or the alias.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  create(data, params) {
    return this._post("studies", null, null, null, "create", data, params);
  }
  /** Search studies
  * @param {String} project - Project [user@]project where project can be either the ID or the alias.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {Boolean} [params.count] - Get the total number of results matching the query. Deactivated by default.
  * @param {String} [params.name] - Study name.
  * @param {String} [params.id] - Study id.
  * @param {String} [params.alias] - Study alias.
  * @param {String} [params.fqn] - Study full qualified name.
  * @param {String} [params.type] - Type of study: CASE_CONTROL, CASE_SET...
  * @param {String} [params.creationDate] - Creation date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {String} [params.modificationDate] - Modification date. Format: yyyyMMddHHmmss. Examples: >2018, 2017-2018, <201805.
  * @param {String} [params.status] - Status.
  * @param {String} [params.attributes] - Attributes.
  * @param {String} [params.nattributes] - Numerical attributes.
  * @param {Boolean} [params.battributes] - Boolean attributes.
  * @param {String} [params.release] - Release value.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  search(project, params) {
    return this._get("studies", null, null, null, "search", Study_objectSpread({
      project
    }, params));
  }
  /** Return the acl of the study. If member is provided, it will only return the acl for the member.
  * @param {String} studies - Comma separated list of Studies [[user@]project:]study where study and project can be either the ID or UUID
  *     up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.member] - User or group id.
  * @param {Boolean} [params.silent = "false"] - Boolean to retrieve all possible entries that are queried for, false to raise an
  *     exception whenever one of the entries looked for cannot be shown for whichever reason. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  acl(studies, params) {
    return this._get("studies", studies, null, null, "acl", params);
  }
  /** Fetch catalog study stats
  * @param {String} studies - Comma separated list of studies [[user@]project:]study up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {Boolean} [params.default = "true"] - Calculate default stats. The default value is true.
  * @param {String} [params.fileFields] - List of file fields separated by semicolons, e.g.: studies;type. For nested fields use >>, e.g.:
  *     studies>>biotype;type.
  * @param {String} [params.individualFields] - List of individual fields separated by semicolons, e.g.: studies;type. For nested fields
  *     use >>, e.g.: studies>>biotype;type.
  * @param {String} [params.familyFields] - List of family fields separated by semicolons, e.g.: studies;type. For nested fields use >>,
  *     e.g.: studies>>biotype;type.
  * @param {String} [params.sampleFields] - List of sample fields separated by semicolons, e.g.: studies;type. For nested fields use >>,
  *     e.g.: studies>>biotype;type.
  * @param {String} [params.cohortFields] - List of cohort fields separated by semicolons, e.g.: studies;type. For nested fields use >>,
  *     e.g.: studies>>biotype;type.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  aggregationStats(studies, params) {
    return this._get("studies", studies, null, null, "aggregationStats", params);
  }
  /** Fetch study information
  * @param {String} studies - Comma separated list of Studies [[user@]project:]study where study and project can be either the ID or UUID
  *     up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  info(studies, params) {
    return this._get("studies", studies, null, null, "info", params);
  }
  /** Return the groups present in the study
  * @param {String} study - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.id] - Group id. If provided, it will only fetch information for the provided group.
  * @param {String} [params.name] - [DEPRECATED] Replaced by id.
  * @param {Boolean} [params.silent = "false"] - Boolean to retrieve all possible entries that are queried for, false to raise an
  *     exception whenever one of the entries looked for cannot be shown for whichever reason. The default value is false.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  groups(study, params) {
    return this._get("studies", study, null, null, "groups", params);
  }
  /** Add or remove a group
  * @param {String} [study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Object} data - JSON containing the parameters.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {"ADD"|"REMOVE"} [params.action = "ADD"] - Action to be performed: ADD or REMOVE a group. The default value is ADD.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateGroups(study, data, params) {
    return this._post("studies", study, "groups", null, "update", data, params);
  }
  /** Add, set or remove users from an existing group
  * @param {String} [study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [group] - Group name.
  * @param {Object} data - JSON containing the parameters.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {"ADD"|"SET"|"REMOVE"} [params.action = "ADD"] - Action to be performed: ADD, SET or REMOVE users to/from a group. The default
  *     value is ADD.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateUsers(study, group, data, params) {
    return this._post("studies", study, "groups", group, "users/update", data, params);
  }
  /** Fetch permission rules
  * @param {String} study - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} entity - Entity where the permission rules should be applied to.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  permissionRules(study, entity) {
    return this._get("studies", study, null, null, "permissionRules", entity);
  }
  /** Add or remove a permission rule
  * @param {String} [study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Object} data - JSON containing the permission rule to be created or removed.
  * @param {String} entity - Entity where the permission rules should be applied to.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {"ADD"|"REMOVE"|"REVERT"|"NONE"} [params.action = "ADD"] - Action to be performed: ADD to add a new permission rule; REMOVE to
  *     remove all permissions assigned by an existing permission rule (even if it overlaps any manual permission); REVERT to remove all
  *     permissions assigned by an existing permission rule (keep manual overlaps); NONE to remove an existing permission rule without
  *     removing any permissions that could have been assigned already by the permission rule. The default value is ADD.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updatePermissionRules(study, entity, data, params) {
    return this._post("studies", study, "permissionRules", null, "update", data, Study_objectSpread({
      entity
    }, params));
  }
  /** Update some study attributes
  * @param {String} study - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Object} data - JSON containing the params to be updated.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  update(study, data) {
    return this._post("studies", study, null, null, "update", data);
  }
  /** Fetch variableSets from a study
  * @param {String} study - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.id] - Id of the variableSet to be retrieved. If no id is passed, it will show all the variableSets of the
  *     study.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  variableSets(study, params) {
    return this._get("studies", study, null, null, "variableSets", params);
  }
  /** Add or remove a variableSet
  * @param {String} [study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {Object} data - JSON containing the VariableSet to be created or removed.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {"ADD"|"REMOVE"} [params.action = "ADD"] - Action to be performed: ADD or REMOVE a variableSet. The default value is ADD.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateVariableSets(study, data, params) {
    return this._post("studies", study, "variableSets", null, "update", data, params);
  }
  /** Add or remove variables to a VariableSet
  * @param {String} [study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [variableSet] - VariableSet id of the VariableSet to be updated.
  * @param {Object} data - JSON containing the variable to be added or removed. For removing, only the variable id will be needed.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {"ADD"|"REMOVE"} [params.action = "ADD"] - Action to be performed: ADD or REMOVE a variable. The default value is ADD.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateVariables(study, variableSet, data, params) {
    return this._post("studies", study, "variableSets", variableSet, "variables/update", data, params);
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/api/User.js
/**
 * Copyright 2015-2020 OpenCB
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * WARNING: AUTOGENERATED CODE
 *
 * This code was generated by a tool.
 * Autogenerated on: 2020-02-27 10:51:26
 *
 * Manual changes to this file may cause unexpected behavior in your application.
 * Manual changes to this file will be overwritten if the code is regenerated.
 *
**/

/**
 * This class contains the methods for the "User" resource
 */

class User_User extends opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    super(config);
  }
  /** Create a new user
  * @param {Object} data - JSON containing the parameters.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  create(data) {
    return this._post("users", null, null, null, "create", data);
  }
  /** Fetch a user configuration
  * @param {String} user - User id.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.name] - Unique name (typically the name of the application).
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  configs(user, params) {
    return this._get("users", user, null, null, "configs", params);
  }
  /** Fetch user filters
  * @param {String} user - User id.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.name] - Filter name. If provided, it will only fetch the specified filter.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  filtersConfigs(user, params) {
    return this._get("users", user, "configs", null, "filters", params);
  }
  /** Add or remove a custom user filter
  * @param {String} user - User id.
  * @param {Object} data - Filter parameters. When removing, only the 'name' of the filter will be necessary.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {"ADD"|"REMOVE"} [params.action = "ADD"] - Action to be performed: ADD or REMOVE a group. The default value is ADD.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateFilters(user, data, params) {
    return this._post("users", user, "configs/filters", null, "update", data, params);
  }
  /** Update a custom filter
  * @param {String} user - User id.
  * @param {String} name - Filter name.
  * @param {Object} data - Filter parameters.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateFilter(user, name, data) {
    return this._post("users", user, "configs/filters", name, "update", data);
  }
  /** Add or remove a custom user configuration
  * @param {String} user - User id.
  * @param {Object} data - JSON containing anything useful for the application such as user or default preferences. When removing, only
  *     the id will be necessary.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {"ADD"|"REMOVE"} [params.action = "ADD"] - Action to be performed: ADD or REMOVE a group. The default value is ADD.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  updateConfigs(user, data, params) {
    return this._post("users", user, "configs", null, "update", data, params);
  }
  /** Return the user information including its projects and studies
  * @param {String} user - User id.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  info(user, params) {
    return this._get("users", user, null, null, "info", params);
  }
  /** Get identified and gain access to the system
  * @param {String} user - User id.
  * @param {Object} [data] - JSON containing the parameter 'password'.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  login(user, data) {
    return this._post("users", user, null, null, "login", data);
  }
  /** Change the password of a user
  * @param {String} user - User id.
  * @param {Object} data - JSON containing the params 'password' (old password) and 'newPassword' (new password).
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  password(user, data) {
    return this._post("users", user, null, null, "password", data);
  }
  /** Retrieve the projects of the user
  * @param {String} user - User id.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  projects(user, params) {
    return this._get("users", user, null, null, "projects", params);
  }
  /** Update some user attributes
  * @param {String} user - User id.
  * @param {Object} data - JSON containing the params to be updated.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  update(user, data) {
    return this._post("users", user, null, null, "update", data);
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/api/Variant.js
function Variant_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function Variant_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { Variant_ownKeys(Object(source), true).forEach(function (key) { Variant_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { Variant_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function Variant_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2020 OpenCB
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * WARNING: AUTOGENERATED CODE
 *
 * This code was generated by a tool.
 * Autogenerated on: 2020-02-27 10:51:26
 *
 * Manual changes to this file may cause unexpected behavior in your application.
 * Manual changes to this file will be overwritten if the code is regenerated.
 *
**/

/**
 * This class contains the methods for the "Variant" resource
 */

class Variant_Variant extends opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    super(config);
  }
  /** Calculate and fetch aggregation stats
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.region] - List of regions, these can be just a single chromosome name or regions in the format chr:start-end,
  *     e.g.: 2,3:100000-200000.
  * @param {String} [params.type] - List of types, accepted values are SNV, MNV, INDEL, SV, CNV, INSERTION, DELETION, e.g. SNV,INDEL.
  * @param {String} [params.project] - Project [user@]project where project can be either the ID or the alias.
  * @param {String} [params.study] - Filter variants from the given studies, these can be either the numeric ID or the alias with the
  *     format user@project:study.
  * @param {String} [params.file] - Filter variants from the files specified. This will set includeFile parameter when not provided.
  * @param {String} [params.filter] - Specify the FILTER for any of the files. If 'file' filter is provided, will match the file and the
  *     filter. e.g.: PASS,LowGQX.
  * @param {String} [params.sample] - Filter variants where the samples contain the variant (HET or HOM_ALT). Accepts AND (;) and OR (,)
  *     operators. This will automatically set 'includeSample' parameter when not provided.
  * @param {String} [params.genotype] - Samples with a specific genotype: {samp_1}:{gt_1}(,{gt_n})*(;{samp_n}:{gt_1}(,{gt_n})*)* e.g.
  *     HG0097:0/0;HG0098:0/1,1/1. Unphased genotypes (e.g. 0/1, 1/1) will also include phased genotypes (e.g. 0|1, 1|0, 1|1), but not vice
  *     versa. When filtering by multi-allelic genotypes, any secondary allele will match, regardless of its position e.g. 1/2 will match with
  *     genotypes 1/2, 1/3, 1/4, .... Genotype aliases accepted: HOM_REF, HOM_ALT, HET, HET_REF, HET_ALT and MISS  e.g.
  *     HG0097:HOM_REF;HG0098:HET_REF,HOM_ALT. This will automatically set 'includeSample' parameter when not provided.
  * @param {String} [params.sampleAnnotation] - Selects some samples using metadata information from Catalog. e.g.
  *     age>20;phenotype=hpo:123,hpo:456;name=smith.
  * @param {String} [params.cohort] - Select variants with calculated stats for the selected cohorts.
  * @param {String} [params.cohortStatsRef] - Reference Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsAlt] - Alternate Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsMaf] - Minor Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsMgf] - Minor Genotype Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsPass] - Filter PASS frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL>0.8.
  * @param {String} [params.missingAlleles] - Number of missing alleles: [{study:}]{cohort}[<|>|<=|>=]{number}.
  * @param {String} [params.missingGenotypes] - Number of missing genotypes: [{study:}]{cohort}[<|>|<=|>=]{number}.
  * @param {String} [params.score] - Filter by variant score: [{study:}]{score}[<|>|<=|>=]{number}.
  * @param {String} [params.family] - Filter variants where any of the samples from the given family contains the variant (HET or
  *     HOM_ALT).
  * @param {String} [params.familyDisorder] - Specify the disorder to use for the family segregation.
  * @param {String} [params.familySegregation] - Filter by mode of inheritance from a given family. Accepted values: [ monoallelic,
  *     monoallelicIncompletePenetrance, biallelic, biallelicIncompletePenetrance, XlinkedBiallelic, XlinkedMonoallelic, Ylinked,
  *     MendelianError, DeNovo, CompoundHeterozygous ].
  * @param {String} [params.familyMembers] - Sub set of the members of a given family.
  * @param {String} [params.familyProband] - Specify the proband child to use for the family segregation.
  * @param {Boolean} [params.annotationExists] - Return only annotated variants.
  * @param {String} [params.gene] - List of genes, most gene IDs are accepted (HGNC, Ensembl gene, ...). This is an alias to 'xref'
  *     parameter.
  * @param {String} [params.ct] - List of SO consequence types, e.g. missense_variant,stop_lost or SO:0001583,SO:0001578.
  * @param {String} [params.xref] - List of any external reference, these can be genes, proteins or variants. Accepted IDs include HGNC,
  *     Ensembl genes, dbSNP, ClinVar, HPO, Cosmic, ...
  * @param {String} [params.biotype] - List of biotypes, e.g. protein_coding.
  * @param {String} [params.proteinSubstitution] - Protein substitution scores include SIFT and PolyPhen. You can query using the score
  *     {protein_score}[<|>|<=|>=]{number} or the description {protein_score}[~=|=]{description} e.g. polyphen>0.1,sift=tolerant.
  * @param {String} [params.conservation] - Filter by conservation score: {conservation_score}[<|>|<=|>=]{number} e.g.
  *     phastCons>0.5,phylop<0.1,gerp>0.1.
  * @param {String} [params.populationFrequencyAlt] - Alternate Population Frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.populationFrequencyRef] - Reference Population Frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.populationFrequencyMaf] - Population minor allele frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.transcriptFlag] - List of transcript annotation flags. e.g. CCDS, basic, cds_end_NF, mRNA_end_NF,
  *     cds_start_NF, mRNA_start_NF, seleno.
  * @param {String} [params.geneTraitId] - List of gene trait association id. e.g. "umls:C0007222" , "OMIM:269600".
  * @param {String} [params.go] - List of GO (Gene Ontology) terms. e.g. "GO:0002020".
  * @param {String} [params.expression] - List of tissues of interest. e.g. "lung".
  * @param {String} [params.proteinKeyword] - List of Uniprot protein variant annotation keywords.
  * @param {String} [params.drug] - List of drug names.
  * @param {String} [params.functionalScore] - Functional score: {functional_score}[<|>|<=|>=]{number} e.g. cadd_scaled>5.2 ,
  *     cadd_raw<=0.3.
  * @param {String} [params.clinicalSignificance] - Clinical significance: benign, likely_benign, likely_pathogenic, pathogenic.
  * @param {String} [params.customAnnotation] - Custom annotation: {key}[<|>|<=|>=]{number} or {key}[~=|=]{text}.
  * @param {String} [params.trait] - List of traits, based on ClinVar, HPO, COSMIC, i.e.: IDs, histologies, descriptions,...
  * @param {String} [params.fields] - List of facet fields separated by semicolons, e.g.: studies;type. For nested faceted fields use >>,
  *     e.g.: chromosome>>type;percentile(gerp).
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  aggregationStats(params) {
    return this._get("analysis/variant", null, null, null, "aggregationStats", params);
  }
  /** Read variant annotations metadata from any saved versions
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.annotationId] - Annotation identifier.
  * @param {String} [params.project] - Project [user@]project where project can be either the ID or the alias.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  metadataAnnotation(params) {
    return this._get("analysis/variant", null, "annotation", null, "metadata", params);
  }
  /** Query variant annotations from any saved versions
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.id] - List of IDs, these can be rs IDs (dbSNP) or variants in the format chrom:start:ref:alt, e.g.
  *     rs116600158,19:7177679:C:T.
  * @param {String} [params.region] - List of regions, these can be just a single chromosome name or regions in the format chr:start-end,
  *     e.g.: 2,3:100000-200000.
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {String} [params.annotationId] - Annotation identifier.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  queryAnnotation(params) {
    return this._get("analysis/variant", null, "annotation", null, "query", params);
  }
  /** Delete cohort variant stats from a cohort.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - study.
  * @param {String} [params.cohort] - Cohort id or name.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  deleteCohortStats(params) {
    return this._delete("analysis/variant", null, "cohort/stats", null, "delete", params);
  }
  /** Read cohort variant stats from list of cohorts.
  * @param {String} cohort - Comma separated list of cohort names or ids up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - study.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  infoCohortStats(cohort, params) {
    return this._get("analysis/variant", null, "cohort/stats", null, "info", Variant_objectSpread({
      cohort
    }, params));
  }
  /** Compute cohort variant stats for the selected list of samples.
  * @param {Object} [data] - Cohort variant stats params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runCohortStats(data, params) {
    return this._post("analysis/variant", null, "cohort/stats", null, "run", data, params);
  }
  /** Filter and export variants from the variant storage to a file
  * @param {Object} [data] - Variant export params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  export(data, params) {
    return this._post("analysis/variant", null, null, null, "export", data, params);
  }
  /** Calculate the possible genotypes for the members of a family
  * @param {String} modeOfInheritance = "MONOALLELIC" - Mode of inheritance. The default value is MONOALLELIC.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.family] - Family id.
  * @param {String} [params.clinicalAnalysis] - Clinical analysis id.
  * @param {String} [params.penetrance = "COMPLETE"] - Penetrance. The default value is COMPLETE.
  * @param {String} [params.disorder] - Disorder id.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  genotypesFamily(modeOfInheritance, params) {
    return this._get("analysis/variant", null, "family", null, "genotypes", Variant_objectSpread({
      modeOfInheritance
    }, params));
  }
  /** Remove variant files from the variant storage
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.file] - Files to remove.
  * @param {Boolean} [params.resume] - Resume a previously failed indexation.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  deleteFile(params) {
    return this._delete("analysis/variant", null, "file", null, "delete", params);
  }
  /** GATK is a Genome Analysis Toolkit for variant discovery in high-throughput sequencing data.
  * @param {Object} [data] - gatk params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - study.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runGatk(data, params) {
    return this._post("analysis/variant", null, "gatk", null, "run", data, params);
  }
  /** Run genetic checks for sex, relatedness and mendelian errors (UDP).
  * @param {Object} [data] - Genetic checks analysis params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runGeneticChecks(data, params) {
    return this._post("analysis/variant", null, "geneticChecks", null, "run", data, params);
  }
  /** Run a Genome Wide Association Study between two cohorts.
  * @param {Object} [data] - Gwas analysis params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runGwas(data, params) {
    return this._post("analysis/variant", null, "gwas", null, "run", data, params);
  }
  /** Index variant files into the variant storage
  * @param {Object} [data] - Variant index params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  index(data, params) {
    return this._post("analysis/variant", null, null, null, "index", data, params);
  }
  /** Obtains the list of knocked out genes for each sample.
  * @param {Object} [data] - Gene knockout analysis params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - study.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runKnockout(data, params) {
    return this._post("analysis/variant", null, "knockout", null, "run", data, params);
  }
  /**
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.project] - Project [user@]project where project can be either the ID or the alias.
  * @param {String} [params.study] - Filter variants from the given studies, these can be either the numeric ID or the alias with the
  *     format user@project:study.
  * @param {String} [params.file] - Filter variants from the files specified. This will set includeFile parameter when not provided.
  * @param {String} [params.sample] - Filter variants where the samples contain the variant (HET or HOM_ALT). Accepts AND (;) and OR (,)
  *     operators. This will automatically set 'includeSample' parameter when not provided.
  * @param {String} [params.includeStudy] - List of studies to include in the result. Accepts 'all' and 'none'.
  * @param {String} [params.includeFile] - List of files to be returned. Accepts 'all' and 'none'.
  * @param {String} [params.includeSample] - List of samples to be included in the result. Accepts 'all' and 'none'.
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  metadata(params) {
    return this._get("analysis/variant", null, null, null, "metadata", params);
  }
  /** Run mutational signature analysis for a given sample.
  * @param {Object} [data] - Mutational signature analysis params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runMutationalSignature(data, params) {
    return this._post("analysis/variant", null, "mutationalSignature", null, "run", data, params);
  }
  /** Plink is a whole genome association analysis toolset, designed to perform a range of basic, large-scale analyses.
  * @param {Object} [data] - Plink params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - study.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runPlink(data, params) {
    return this._post("analysis/variant", null, "plink", null, "run", data, params);
  }
  /** Filter and fetch variants from indexed VCF files in the variant storage
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.include] - Fields included in the response, whole JSON path must be provided.
  * @param {String} [params.exclude] - Fields excluded in the response, whole JSON path must be provided.
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {Boolean} [params.count] - Get the total number of results matching the query. Deactivated by default.
  * @param {Boolean} [params.sort] - Sort the results.
  * @param {Boolean} [params.summary] - Fast fetch of main variant parameters.
  * @param {Boolean} [params.approximateCount] - Get an approximate count, instead of an exact total count. Reduces execution time.
  * @param {Number} [params.approximateCountSamplingSize] - Sampling size to get the approximate count. Larger values increase accuracy
  *     but also increase execution time.
  * @param {String} [params.id] - List of IDs, these can be rs IDs (dbSNP) or variants in the format chrom:start:ref:alt, e.g.
  *     rs116600158,19:7177679:C:T.
  * @param {String} [params.region] - List of regions, these can be just a single chromosome name or regions in the format chr:start-end,
  *     e.g.: 2,3:100000-200000.
  * @param {String} [params.type] - List of types, accepted values are SNV, MNV, INDEL, SV, CNV, INSERTION, DELETION, e.g. SNV,INDEL.
  * @param {String} [params.reference] - Reference allele.
  * @param {String} [params.alternate] - Main alternate allele.
  * @param {String} [params.project] - Project [user@]project where project can be either the ID or the alias.
  * @param {String} [params.study] - Filter variants from the given studies, these can be either the numeric ID or the alias with the
  *     format user@project:study.
  * @param {String} [params.file] - Filter variants from the files specified. This will set includeFile parameter when not provided.
  * @param {String} [params.filter] - Specify the FILTER for any of the files. If 'file' filter is provided, will match the file and the
  *     filter. e.g.: PASS,LowGQX.
  * @param {String} [params.qual] - Specify the QUAL for any of the files. If 'file' filter is provided, will match the file and the qual.
  *     e.g.: >123.4.
  * @param {String} [params.info] - Filter by INFO attributes from file. [{file}:]{key}{op}{value}[,;]* . If no file is specified, will
  *     use all files from "file" filter. e.g. AN>200 or file_1.vcf:AN>200;file_2.vcf:AN<10 . Many INFO fields can be combined. e.g.
  *     file_1.vcf:AN>200;DB=true;file_2.vcf:AN<10.
  * @param {String} [params.sample] - Filter variants where the samples contain the variant (HET or HOM_ALT). Accepts AND (;) and OR (,)
  *     operators. This will automatically set 'includeSample' parameter when not provided.
  * @param {String} [params.genotype] - Samples with a specific genotype: {samp_1}:{gt_1}(,{gt_n})*(;{samp_n}:{gt_1}(,{gt_n})*)* e.g.
  *     HG0097:0/0;HG0098:0/1,1/1. Unphased genotypes (e.g. 0/1, 1/1) will also include phased genotypes (e.g. 0|1, 1|0, 1|1), but not vice
  *     versa. When filtering by multi-allelic genotypes, any secondary allele will match, regardless of its position e.g. 1/2 will match with
  *     genotypes 1/2, 1/3, 1/4, .... Genotype aliases accepted: HOM_REF, HOM_ALT, HET, HET_REF, HET_ALT and MISS  e.g.
  *     HG0097:HOM_REF;HG0098:HET_REF,HOM_ALT. This will automatically set 'includeSample' parameter when not provided.
  * @param {String} [params.format] - Filter by any FORMAT field from samples. [{sample}:]{key}{op}{value}[,;]* . If no sample is
  *     specified, will use all samples from "sample" or "genotype" filter. e.g. DP>200 or HG0097:DP>200,HG0098:DP<10 . Many FORMAT fields can
  *     be combined. e.g. HG0097:DP>200;GT=1/1,0/1,HG0098:DP<10.
  * @param {String} [params.sampleAnnotation] - Selects some samples using metadata information from Catalog. e.g.
  *     age>20;phenotype=hpo:123,hpo:456;name=smith.
  * @param {Boolean} [params.sampleMetadata] - Return the samples metadata group by study. Sample names will appear in the same order as
  *     their corresponding genotypes.
  * @param {String} [params.unknownGenotype] - Returned genotype for unknown genotypes. Common values: [0/0, 0|0, ./.].
  * @param {Number} [params.sampleLimit] - Limit the number of samples to be included in the result.
  * @param {Number} [params.sampleSkip] - Skip some samples from the result. Useful for sample pagination.
  * @param {String} [params.cohort] - Select variants with calculated stats for the selected cohorts.
  * @param {String} [params.cohortStatsRef] - Reference Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsAlt] - Alternate Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsMaf] - Minor Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsMgf] - Minor Genotype Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4.
  * @param {String} [params.cohortStatsPass] - Filter PASS frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL>0.8.
  * @param {String} [params.missingAlleles] - Number of missing alleles: [{study:}]{cohort}[<|>|<=|>=]{number}.
  * @param {String} [params.missingGenotypes] - Number of missing genotypes: [{study:}]{cohort}[<|>|<=|>=]{number}.
  * @param {String} [params.score] - Filter by variant score: [{study:}]{score}[<|>|<=|>=]{number}.
  * @param {String} [params.family] - Filter variants where any of the samples from the given family contains the variant (HET or
  *     HOM_ALT).
  * @param {String} [params.familyDisorder] - Specify the disorder to use for the family segregation.
  * @param {String} [params.familySegregation] - Filter by mode of inheritance from a given family. Accepted values: [ monoallelic,
  *     monoallelicIncompletePenetrance, biallelic, biallelicIncompletePenetrance, XlinkedBiallelic, XlinkedMonoallelic, Ylinked,
  *     MendelianError, DeNovo, CompoundHeterozygous ].
  * @param {String} [params.familyMembers] - Sub set of the members of a given family.
  * @param {String} [params.familyProband] - Specify the proband child to use for the family segregation.
  * @param {String} [params.includeStudy] - List of studies to include in the result. Accepts 'all' and 'none'.
  * @param {String} [params.includeFile] - List of files to be returned. Accepts 'all' and 'none'.
  * @param {String} [params.includeSample] - List of samples to be included in the result. Accepts 'all' and 'none'.
  * @param {String} [params.includeFormat] - List of FORMAT names from Samples Data to include in the output. e.g: DP,AD. Accepts 'all'
  *     and 'none'.
  * @param {String} [params.includeGenotype] - Include genotypes, apart of other formats defined with includeFormat.
  * @param {Boolean} [params.annotationExists] - Return only annotated variants.
  * @param {String} [params.gene] - List of genes, most gene IDs are accepted (HGNC, Ensembl gene, ...). This is an alias to 'xref'
  *     parameter.
  * @param {String} [params.ct] - List of SO consequence types, e.g. missense_variant,stop_lost or SO:0001583,SO:0001578.
  * @param {String} [params.xref] - List of any external reference, these can be genes, proteins or variants. Accepted IDs include HGNC,
  *     Ensembl genes, dbSNP, ClinVar, HPO, Cosmic, ...
  * @param {String} [params.biotype] - List of biotypes, e.g. protein_coding.
  * @param {String} [params.proteinSubstitution] - Protein substitution scores include SIFT and PolyPhen. You can query using the score
  *     {protein_score}[<|>|<=|>=]{number} or the description {protein_score}[~=|=]{description} e.g. polyphen>0.1,sift=tolerant.
  * @param {String} [params.conservation] - Filter by conservation score: {conservation_score}[<|>|<=|>=]{number} e.g.
  *     phastCons>0.5,phylop<0.1,gerp>0.1.
  * @param {String} [params.populationFrequencyAlt] - Alternate Population Frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.populationFrequencyRef] - Reference Population Frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.populationFrequencyMaf] - Population minor allele frequency: {study}:{population}[<|>|<=|>=]{number}. e.g.
  *     1kG_phase3:ALL<0.01.
  * @param {String} [params.transcriptFlag] - List of transcript annotation flags. e.g. CCDS, basic, cds_end_NF, mRNA_end_NF,
  *     cds_start_NF, mRNA_start_NF, seleno.
  * @param {String} [params.geneTraitId] - List of gene trait association id. e.g. "umls:C0007222" , "OMIM:269600".
  * @param {String} [params.go] - List of GO (Gene Ontology) terms. e.g. "GO:0002020".
  * @param {String} [params.expression] - List of tissues of interest. e.g. "lung".
  * @param {String} [params.proteinKeyword] - List of Uniprot protein variant annotation keywords.
  * @param {String} [params.drug] - List of drug names.
  * @param {String} [params.functionalScore] - Functional score: {functional_score}[<|>|<=|>=]{number} e.g. cadd_scaled>5.2 ,
  *     cadd_raw<=0.3.
  * @param {String} [params.clinicalSignificance] - Clinical significance: benign, likely_benign, likely_pathogenic, pathogenic.
  * @param {String} [params.customAnnotation] - Custom annotation: {key}[<|>|<=|>=]{number} or {key}[~=|=]{text}.
  * @param {String} [params.panel] - Filter by genes from the given disease panel.
  * @param {String} [params.trait] - List of traits, based on ClinVar, HPO, COSMIC, i.e.: IDs, histologies, descriptions,...
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  query(params) {
    return this._get("analysis/variant", null, null, null, "query", params);
  }
  /** Compute a score to quantify relatedness between individuals.
  * @param {Object} [data] - Relatedness analysis params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runRelatedness(data, params) {
    return this._post("analysis/variant", null, "relatedness", null, "run", data, params);
  }
  /** Rvtests is a flexible software package for genetic association studies
  * @param {Object} [data] - rvtest params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - study.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runRvtests(data, params) {
    return this._post("analysis/variant", null, "rvtests", null, "run", data, params);
  }
  /** Filter samples by a complex query involving metadata and variants data
  * @param {Object} [data] - .
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runSampleEligibility(data, params) {
    return this._post("analysis/variant", null, "sample/eligibility", null, "run", data, params);
  }
  /** Get sample data of a given variant
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {Number} [params.limit] - Number of results to be returned.
  * @param {Number} [params.skip] - Number of results to skip.
  * @param {String} [params.variant] - Variant.
  * @param {String} [params.study] - Study where all the samples belong to.
  * @param {String} [params.genotype] - Genotypes that the sample must have to be selected.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  querySample(params) {
    return this._get("analysis/variant", null, "sample", null, "query", params);
  }
  /** Get samples given a set of variants
  * @param {Object} [data] - Sample variant filter params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runSample(data, params) {
    return this._post("analysis/variant", null, "sample", null, "run", data, params);
  }
  /** Delete sample variant stats from a sample.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - study.
  * @param {String} [params.sample] - Sample.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  deleteSampleStats(params) {
    return this._delete("analysis/variant", null, "sample/stats", null, "delete", params);
  }
  /** Read sample variant stats from list of samples.
  * @param {String} sample - Comma separated list sample IDs or UUIDs up to a maximum of 100.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study where all the samples belong to.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  infoSampleStats(sample, params) {
    return this._get("analysis/variant", null, "sample/stats", null, "info", Variant_objectSpread({
      sample
    }, params));
  }
  /** Compute sample variant stats for the selected list of samples.
  * @param {Object} [data] - Sample variant stats params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runSampleStats(data, params) {
    return this._post("analysis/variant", null, "sample/stats", null, "run", data, params);
  }
  /** Export calculated variant stats and frequencies
  * @param {Object} [data] - Variant stats export params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  exportStats(data, params) {
    return this._post("analysis/variant", null, "stats", null, "export", data, params);
  }
  /** Compute variant stats for any cohort and any set of variants. Optionally, index the result in the variant storage database.
  * @param {Object} [data] - Variant stats params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  runStats(data, params) {
    return this._post("analysis/variant", null, "stats", null, "run", data, params);
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/api/VariantOperation.js
/**
 * Copyright 2015-2020 OpenCB
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * WARNING: AUTOGENERATED CODE
 *
 * This code was generated by a tool.
 * Autogenerated on: 2020-02-27 10:51:26
 *
 * Manual changes to this file may cause unexpected behavior in your application.
 * Manual changes to this file will be overwritten if the code is regenerated.
 *
**/

/**
 * This class contains the methods for the "VariantOperation" resource
 */

class VariantOperation_VariantOperation extends opencga_parent_class_OpenCGAParentClass {
  constructor(config) {
    super(config);
  }
  /** Find variants where not all the samples are present, and fill the empty values, excluding HOM-REF (0/0) values.
  * @param {Object} [data] - Variant aggregate params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  aggregateVariant(data, params) {
    return this._post("operation", null, "variant", null, "aggregate", data, params);
  }
  /** Deletes a saved copy of variant annotation
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @param {String} [params.project] - Project [user@]project where project can be either the ID or the alias.
  * @param {String} [params.annotationId] - Annotation identifier.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  deleteVariantAnnotation(params) {
    return this._delete("operation", null, "variant/annotation", null, "delete", params);
  }
  /** Create and load variant annotations into the database
  * @param {Object} [data] - Variant annotation index params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @param {String} [params.project] - Project [user@]project where project can be either the ID or the alias.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  indexVariantAnnotation(data, params) {
    return this._post("operation", null, "variant/annotation", null, "index", data, params);
  }
  /** Save a copy of the current variant annotation at the database
  * @param {Object} [data] - Variant annotation save params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @param {String} [params.project] - Project [user@]project where project can be either the ID or the alias.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  saveVariantAnnotation(data, params) {
    return this._post("operation", null, "variant/annotation", null, "save", data, params);
  }
  /** Find variants where not all the samples are present, and fill the empty values.
  * @param {Object} [data] - Variant aggregate family params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  aggregateVariantFamily(data, params) {
    return this._post("operation", null, "variant/family", null, "aggregate", data, params);
  }
  /** Build the family index
  * @param {Object} [data] - Variant family index params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  indexFamilyGenotype(data, params) {
    return this._post("operation", null, "variant/family/genotype", null, "index", data, params);
  }
  /** Build and annotate the sample index
  * @param {Object} [data] - Variant sample index params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  indexSampleGenotype(data, params) {
    return this._post("operation", null, "variant/sample/genotype", null, "index", data, params);
  }
  /** Remove a variant score in the database
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.name] - Unique name of the score within the study.
  * @param {Boolean} [params.resume] - Resume a previously failed remove.
  * @param {Boolean} [params.force] - Force remove of partially indexed scores.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  deleteVariantScore(params) {
    return this._delete("operation", null, "variant/score", null, "delete", params);
  }
  /** Index a variant score in the database.
  * @param {Object} [data] - Variant score index params. scoreName: Unique name of the score within the study. cohort1: Cohort used to
  *     compute the score. Use the cohort 'ALL' if all samples from the study where used to compute the score. cohort2: Second cohort used to
  *     compute the score, typically to compare against the first cohort. If only one cohort was used to compute the score, leave empty.
  *     inputColumns: Indicate which columns to load from the input file. Provide the column position (starting in 0) for the column with the
  *     score with 'SCORE=n'. Optionally, the PValue column with 'PVALUE=n'. The, to indicate the variant associated with the score, provide
  *     either the columns ['CHROM', 'POS', 'REF', 'ALT'], or the column 'VAR' containing a variant representation with format
  *     'chr:start:ref:alt'. e.g. 'CHROM=0,POS=1,REF=3,ALT=4,SCORE=5,PVALUE=6' or 'VAR=0,SCORE=1,PVALUE=2'. resume: Resume a previously failed
  *     indexation.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  indexVariantScore(data, params) {
    return this._post("operation", null, "variant/score", null, "index", data, params);
  }
  /** Creates a secondary index using a search engine. If samples are provided, sample data will be added to the secondary index.
  * @param {Object} [data] - Variant secondary index params.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @param {String} [params.project] - Project [user@]project where project can be either the ID or the alias.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  secondaryIndexVariant(data, params) {
    return this._post("operation", null, "variant", null, "secondaryIndex", data, params);
  }
  /** Remove a secondary index from the search engine for a specific set of samples.
  * @param {Object} [params] - The Object containing the following optional parameters:
  * @param {String} [params.jobId] - Job ID. It must be a unique string within the study. An id will be autogenerated automatically if not
  *     provided.
  * @param {String} [params.jobDescription] - Job description.
  * @param {String} [params.jobDependsOn] - Comma separated list of existing job ids the job will depend on.
  * @param {String} [params.jobTags] - Job tags.
  * @param {String} [params.study] - Study [[user@]project:]study where study and project can be either the ID or UUID.
  * @param {String} [params.samples] - Samples to remove. Needs to provide all the samples in the secondary index.
  * @returns {Promise} Promise object in the form of RestResponse instance.
  */


  deleteVariantSecondaryIndex(params) {
    return this._delete("operation", null, "variant/secondaryIndex", null, "delete", params);
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/opencga/opencga-client.js
function opencga_client_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_client_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_client_ownKeys(Object(source), true).forEach(function (key) { opencga_client_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_client_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_client_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/*
 * Copyright 2016 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */




















 // export class OpenCGAClientConfig {
//
//     constructor(host = "172.24.193.208:8080/opencga", version = "v1", useCookies = true, cookiePrefix = "catalog") {
//         this.host = host;
//         this.version = version;
//         this.useCookies = useCookies;
//         this.cookiePrefix = cookiePrefix;
//
//         if (this.useCookies) {
//             this.setPrefix(cookiePrefix);
//         } else {
//             this.userId = "";
//             this.sessionId = "";
//         }
//         // default values
//         this.rpc = "rest";
//     }
//
//     // to allow multiple sessions of IVA
//     setPrefix(prefix) {
//         this.cookieSessionId = `${prefix}_sid`;
//         this.cookieUserId = `${prefix}_userId`;
//         // this.cookiePassword = `${prefix}_password`;
//         // this.cookieLoginResponse = `${prefix}_loginResponse`;
//     }
//
// }

class opencga_client_OpenCGAClient {
  constructor(config) {
    this._config = opencga_client_objectSpread({}, this.getDefaultConfig(), {}, config);
    this.clients = new Map();
  }

  getDefaultConfig() {
    return {
      host: "",
      version: "",
      userId: "",
      token: "",
      mode: "rest",
      query: {
        batchSize: "",
        limit: 10
      },
      cookies: {
        active: true,
        prefix: "" // expirationTime: ""

      }
    };
  } // TODO check OpeCGA URL and other variables.


  check() {}
  /*
   * Client singleton functions
   */


  users() {
    if (!this.clients.has("users")) {
      this.clients.set("users", new User_User(this._config));
    }

    return this.clients.get("users");
  }
  /* users() {
      if (typeof this._users === "undefined") {
          console.log("user client config",this._config)
          this._users = new Users(this._config);
      }
      return this._users;
  }*/


  projects() {
    if (!this.clients.has("projects")) {
      this.clients.set("projects", new Project_Project(this._config));
    }

    return this.clients.get("projects");
  }

  studies() {
    if (!this.clients.has("studies")) {
      this.clients.set("studies", new Study_Study(this._config));
    }

    return this.clients.get("studies");
  }

  files() {
    if (!this.clients.has("files")) {
      this.clients.set("files", new File_File(this._config));
    }

    return this.clients.get("files");
  }

  jobs() {
    if (!this.clients.has("jobs")) {
      this.clients.set("jobs", new Job_Job(this._config));
    }

    return this.clients.get("jobs");
  }

  samples() {
    if (!this.clients.has("samples")) {
      this.clients.set("samples", new Sample_Sample(this._config));
    }

    return this.clients.get("samples");
  }

  cohorts() {
    if (!this.clients.has("cohorts")) {
      this.clients.set("cohorts", new Cohort_Cohort(this._config));
    }

    return this.clients.get("cohorts");
  }

  individuals() {
    if (!this.clients.has("individuals")) {
      this.clients.set("individuals", new Individual_Individual(this._config));
    }

    return this.clients.get("individuals");
  }

  families() {
    if (!this.clients.has("families")) {
      this.clients.set("families", new Family_Family(this._config));
    }

    return this.clients.get("families");
  }

  panels() {
    if (!this.clients.has("panels")) {
      this.clients.set("panels", new DiseasePanel_DiseasePanel(this._config));
    }

    return this.clients.get("panels");
  }

  meta() {
    if (!this.clients.has("meta")) {
      this.clients.set("meta", new Meta_Meta(this._config));
    }

    return this.clients.get("meta");
  }

  admin() {
    if (!this.clients.has("admin")) {
      this.clients.set("admin", new Admin_Admin(this._config));
    }

    return this.clients.get("admin");
  } // interpretations() {
  //     if (typeof this._interpretations === "undefined") {
  //         this._interpretations = new Interpretation(this._config);
  //     }
  //     return this._interpretations;
  // }
  // variables() {
  //     if (typeof this._variables === "undefined") {
  //         this._variables = new Variables(this._config);
  //     }
  //     return this._variables;
  // }
  // Analysis


  alignments() {
    if (!this.clients.has("alignments")) {
      this.clients.set("alignments", new Alignment_Alignment(this._config));
    }

    return this.clients.get("alignments");
  }

  variants() {
    if (!this.clients.has("variants")) {
      this.clients.set("variants", new Variant_Variant(this._config));
    }

    return this.clients.get("variants");
  }

  clinical() {
    if (!this.clients.has("clinical")) {
      this.clients.set("clinical", new Clinical_Clinical(this._config));
    }

    return this.clients.get("clinical");
  }

  variantOperations() {
    if (!this.clients.has("variantOperations")) {
      this.clients.set("variantOperations", new VariantOperation_VariantOperation(this._config));
    }

    return this.clients.get("variantOperations");
  }

  ga4gh() {
    if (!this.clients.has("ga4gh")) {
      this.clients.set("ga4gh", new GA4GH_GA4GH(this._config));
    }

    return this.clients.get("ga4gh");
  }

  async login(userId, password) {
    try {
      /* if (this._config.useCookies) {
          let cookieSession = Cookies.get(this._config.cookieSessionId);
          let cookieUser = Cookies.get(this._config.cookieUserId);
          let cookiePass = Cookies.get(this._config.cookiePassword);
          let loginResponse = Cookies.get(this._config.cookieLoginResponse);
           if (cookieUser !== undefined && cookieUser === userId && cookiePass !== undefined && cookiePass === encryptedPass
              && cookieSession !== undefined && loginResponse !== undefined) {
              console.log("Credentials taken from cookies");
              return Promise.resolve(JSON.parse(loginResponse));
          }
      }*/
      const response = await this.users().login(userId, {
        password: password
      });
      const restResponse = new RestResponse(response); // const encryptedPass = CryptoJS.SHA256(password).toString();
      // TODO search for Errors in restResponse.events
      // TODO if password is not defined use token?

      this._config.userId = userId;
      this._config.token = restResponse.getResult(0).token; // Cookies being used

      if (this._config.cookies.active) {
        console.log("Cookies being used"); // Cookies.set(this._config.cookies.prefix + "_userId", userId);
        // Cookies.set(this._config.cookies.prefix + "_sid", this._config.token);
        // Cookies.set(this._config.cookiePassword, encryptedPass);
        // Cookies.set(this._config.cookieLoginResponse, JSON.stringify(response));

        this.setCookies(userId, this._config.token);
      }

      this.clients.forEach(client => client.setToken(this._config.token));
      return restResponse;
    } catch (e) {
      console.error(e);
    }
  }

  setCookies(userId, token) {
    if (userId && token) {
      Cookies.set(this._config.cookies.prefix + "_userId", userId);
      Cookies.set(this._config.cookies.prefix + "_sid", this._config.token);
    } else {
      Cookies.expire(this._config.cookies.prefix + "_userId");
      Cookies.expire(this._config.cookies.prefix + "_sid");
    }
  } // refresh only works if cookies are enabled


  async refresh() {
    const userId = this._config.userId;
    const response = await this.users().login(userId);
    const restResponse = new RestResponse(response);

    if (this._config.cookies.active) {
      this._config.token = restResponse.getResult(0).token; // Cookies.set(this._config.cookieSessionId, this._config.sessionId);
      // Cookies.set(this._config.cookieUserId, userId);
      // Cookies.set(this._config.cookiePassword, encryptedPass);
      // Cookies.set(this._config.cookieLoginResponse, JSON.stringify(response));

      this.setCookies(userId, this._config.token);
    }

    this.clients.forEach(client => client.setToken(this._config.token));
    return restResponse;
  }

  logout() {
    this._config.userId = null;
    this._config.token = null; // Remove cookies

    if (this._config.cookies.active) {
      // delete this._config.userId;
      // delete this._config.token;
      this.setCookies();
    }

    return Promise.resolve();
  }
  /**
   * Creates and return an anonymous session object, it is a sync function.
   */


  createAnonymousSession() {
    const opencgaSession = {};
    opencgaSession.user = {
      id: "anonymous",
      projects: []
    };
    opencgaSession.token = "";
    opencgaSession.date = new Date().toISOString();
    opencgaSession.server = {
      host: this._config.host,
      version: this._config.version
    };
    opencgaSession.opencgaClient = this;
    return opencgaSession;
  }
  /**
   * Creates an authenticated session for the user and token of the current OpenCGAClient. The token is taken from the
   * opencgaClient object itself.
   * @returns {Promise<any>}
   */
  // TODO refactor


  createSession() {
    const _this = this;

    return new Promise(function (resolve, reject) {
      // check that a session exists
      // TODO should we check the session has not expired?
      console.log("_this._config", _this._config); // ------------ TODO refreshing a page userId is empty

      if (utilsNew_UtilsNew.isNotUndefined(_this._config.token)) {
        _this.users().info(_this._config.userId).then(function (response) {
          const session = {};
          console.log("response", response);
          session.user = response.response[0].result[0];
          session.token = _this._config.token;
          session.date = new Date().toISOString();
          session.server = {
            host: _this._config.host,
            version: _this._config.version,
            serverVersion: _this._config.serverVersion
          };
          session.opencgaClient = _this; // Fetch authorised Projects and Studies

          _this.projects().search({}).then(function (response) {
            console.log("response", response);
            const res = new RestResponse(response);
            session.projects = response.response[0].result;

            if (utilsNew_UtilsNew.isNotEmptyArray(session.projects) && utilsNew_UtilsNew.isNotEmptyArray(session.projects[0].studies)) {
              const studies = []; // FIXME This is needed to keep backward compatibility with OpenCGA 1.3.x

              for (const project of session.projects) {
                project.alias = project.alias || project.fqn || null;

                if (project.studies !== undefined) {
                  for (const study of project.studies) {
                    // If study.alias does not exist we are NOT in version 1.3, we set fqn from 1.4
                    if (study.alias === undefined || study.alias === "") {
                      if (study.fqn.includes(":")) {
                        study.alias = study.fqn.split(":")[1];
                      } else {
                        study.alias = study.fqn;
                      }
                    } // Keep track of the studies to fetch Disease Panels


                    studies.push(project.id + ":" + study.id);
                  }
                }
              } // this sets the current active project and study


              session.project = session.projects[0];
              session.study = session.projects[0].studies[0]; // Fetch the Disease Panels for each Study

              const panelPromises = [];

              for (const study of studies) {
                const promise = _this.panels().search({
                  study: study,
                  include: "id,name,stats,source,genes.id,genes.name,regions.id"
                }).then(function (response) {
                  return new RestResponse(response).getResult(0);
                });

                panelPromises.push(promise);
              }

              Promise.all(panelPromises).then(function (values) {
                const studiesMap = {};

                for (let i = 0; i < studies.length; i++) {
                  studiesMap[studies[i]] = values[i];
                } // This set the panels in the object reference of the session object


                for (const project of session.projects) {
                  for (const study of project.studies) {
                    study.panels = studiesMap[project.id + ":" + study.id];
                  }
                }
              });
            }

            resolve(session);
          }).catch(function (response) {
            reject({
              message: "An error when getting projects",
              value: response
            });
          });
        }).catch(function (response) {
          reject({
            message: "An error when getting projects",
            value: response
          });
        });
      } else {
        reject({
          message: "No valid token",
          value: _this._config.token
        });
      }
    });
  } // TODO remove setter


  getConfig() {
    return this._config;
  }

  setConfig(config) {
    this._config = config;
  }

} // TODO OpenCGAClient maybe should be a singleton exported module..
// Object.freeze(OpenCGAClient);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/cellbase-client.js
/*
 * Copyright 2015 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

class CellBaseClientConfig {
  constructor(hosts = ["bioinfo.hpc.cam.ac.uk/cellbase", "www.ebi.ac.uk/cellbase"], version = "v3", species = "hsapiens") {
    this.setHosts(hosts);
    this.version = version;
    this.species = species; // default values

    this.rpc = "rest";
    this.cache = {
      active: false,
      database: "".concat(this.species, "_").concat(this.version, "_cellbase_cache"),
      subcategories: ["genomic_chromosome", "genomic_region", "genomic_variant", "feature_gene", "feature_variation", "feature_clinical", "feature_id", "feature_protein", "feature_transcript"]
    };
  }

  setHosts(hosts) {
    if (typeof hosts === "string") {
      this.hosts = hosts.split(",");
    } else {
      this.hosts = hosts;
    }
  }

}
class cellbase_client_CellBaseClient {
  constructor(config) {
    if (typeof config === "undefined") {
      this._config = new CellBaseClientConfig();
    } else {
      this._config = config;
    }

    if (this._config.cache.active) {
      this.indexedDBCache = new IndexedDBCache(this._config.cache.database);

      this._initCache();
    }
  }

  _initCache() {
    this.indexedDBCache.createObjectStores(this._config.cache.subcategories);
  }

  setHosts(hosts) {
    if (typeof hosts !== "undefined") {
      this._config.setHosts(hosts);
    }
  }

  setVersion(version) {
    this._config.version = version;
  }
  /**
   * This method has been implemented to be backword compatible with old cellbase-manager.js
   */


  getOldWay(args) {
    return this.get(args.category, args.subcategory, args.id, args.resource, args.params, args.options);
  }

  getMeta(param, options) {
    if (options === undefined) {
      options = {};
    }

    let hosts = options.hosts || this._config.hosts;
    let version = options.version || this._config.version;
    let count = 0; // let response;

    let url = "".concat(hosts[count], "/webservices/rest/").concat(version, "/") + "meta" + "/".concat(param); // By default we assume https protocol instead of http

    if (!url.startsWith("https://") && !url.startsWith("http://")) {
      url = "https://".concat(url);
    } // options.error = function() {
    //     if (++count < hosts.length) {
    //         // we need a new URL
    //         url = "http://" + hosts[count] + "/webservices/rest/" + version + "/" + "meta" + "/" + param;
    //         response = RestClient.call(url, options);
    //     } else {
    //         userError(this);
    //     }
    // };
    // response = RestClient.call(url, options);


    return rest_client_xmlhttp_RestClientXmlhttp.call(url, options);
  }

  getFiles(folderId, resource, params, options) {
    if (options === undefined) {
      options = {};
    }

    let hosts = options.hosts || this._config.hosts;
    let version = options.version || this._config.version;
    let species = options.species || this._config.species;
    let url = "http://".concat(hosts[count], "/webservices/rest/").concat(version, "/").concat(species, "/") + "files";

    if (typeof folderId !== "undefined" && folderId !== null && folderId !== "") {
      url += "/".concat(folderId, "/").concat(resource);
    } else {
      url += "/".concat(resource);
    } // We add the query params formatted in URL


    let queryParamsUrl = this._createSuffixKey(params, false);

    if (typeof queryParamsUrl !== "undefined" && queryParamsUrl !== null && queryParamsUrl !== "") {
      url += "?".concat(queryParamsUrl);
    }

    return rest_client_xmlhttp_RestClientXmlhttp.call(url, options);
  }

  getGeneClient(id, resource, params, options) {
    return this.get("feature", "gene", id, resource, params, options);
  }

  getTranscriptClient(id, resource, params, options) {
    return this.get("feature", "transcript", id, resource, params, options);
  }

  getProteinClient(id, resource, params, options) {
    return this.get("feature", "protein", id, resource, params, options);
  }

  getVariationClient(id, resource, params, options) {
    return this.get("feature", "variation", id, resource, params, options);
  }

  getRegulatoryClient(id, resource, params, options) {
    return this.get("feature", "regulatory", id, resource, params, options);
  }

  get(category, subcategory, ids, resource, params, options) {
    if (options === undefined) {
      options = {};
    } // we store the options from the parameter or from the default values in config


    let hosts = options.hosts || this._config.hosts;

    if (typeof hosts === "string") {
      hosts = hosts.split(",");
    }

    let rpc = options.rpc || this._config.rpc;
    let cache = options.cache || this._config.cache;
    let response;

    if (cache.active) {
      let os = "".concat(category, "_").concat(subcategory);
      let nonCachedIds = [];
      let cacheKeys = [];

      let suffixKey = this._createSuffixKey(params, true);

      let idArray = [];

      if (ids !== undefined && ids !== null) {
        idArray = ids.split(",");

        for (let i = 0; i < idArray.length; i++) {
          cacheKeys.push("".concat(idArray[i], "_").concat(resource).concat(suffixKey));
        }
      } else {
        cacheKeys.push(resource + suffixKey);
      }

      console.time("Cache time:");

      let _this = this;

      response = new Promise(function (resolve, reject) {
        _this.indexedDBCache.getAll(os, cacheKeys, function (results) {
          let uncachedQueries = false;

          for (let i = 0; i < results.length; i++) {
            if (results[i] === undefined) {
              uncachedQueries = true;

              if (idArray.length > 0) {
                nonCachedIds.push(idArray[i]);
              }
            }
          }

          if (rpc.toLowerCase() === "rest") {
            options.cacheFn = function (dataResponse) {
              // we add the new fetched data to the cache
              let suffixKey = _this._createSuffixKey(params, true); // We make a copy of dataResponse


              let query = {};

              for (let i in dataResponse) {
                query[i] = dataResponse[i];
              } // And remove the key response


              delete query["response"];

              if (idArray.length > 0) {
                for (let i = 0; i < dataResponse.response.length; i++) {
                  let result = {
                    query: query,
                    data: dataResponse.response[i]
                  }; // result['data'] = dataResponse.response[i];
                  // // Update the data time to 0

                  result.data.dbTime = 0;

                  _this.indexedDBCache.add(os, "".concat(idArray[i], "_").concat(resource).concat(suffixKey), result);
                }
              } else {
                for (let i = 0; i < dataResponse.response.length; i++) {
                  let result = {
                    query: query,
                    data: dataResponse.response[i]
                  }; // Update the data time to 0

                  result.data.dbTime = 0;

                  _this.indexedDBCache.add(os, resource + suffixKey, result);
                }
              } // debugger
              // console.log(dataResponse);
              // response = {response: []};
              // let responses = [];
              // for (let i = 0, j = 0; i < results.length; i++) {
              //     if (results[i] == undefined) {
              //         results[i] = dataResponse.response[j++].result;
              //     }
              //     responses.push({result: results[i]});
              // }
              // response.response = responses;
              //
              // console.log(response)
              // // If the call is OK then we execute the success function from the user
              // if (typeof options != "undefined" && typeof options.success === "function") {
              //     options.success(response);
              // }

            };

            if (uncachedQueries) {
              // response = _this._callRestWebService(hosts, category, subcategory, nonCachedIds, resource, params, options);
              resolve(_this._callRestWebService(hosts, category, subcategory, nonCachedIds, resource, params, options));
            } else {
              let queryResponse = results[0].query;
              queryResponse["response"] = []; // if (results.length > 1) {
              //     debugger;
              // }

              for (let i = 0; i < results.length; i++) {
                queryResponse.response.push(results[i].data);
              } // response.response = responses;
              // response = Promise.resolve(queryResponse);


              resolve(queryResponse); // If the call is OK then we execute the success function from the user

              if (typeof options !== "undefined" && typeof options.success === "function") {
                options.success(response);
              }
            }
          } else {
            if (rpc.toLowerCase() === "grpc") {
              response = _this._callGrpcService(hosts, category, subcategory, nonCachedIds, resource, params, options);
            } else {
              console.error("No valid RPC method: ".concat(rpc, ". Accepted values are 'rest' and 'grpc'"));
            }
          }

          console.timeEnd("Cache time:");
        });
      });
    } else {
      // let response;
      if (rpc.toLowerCase() === "rest") {
        response = this._callRestWebService(hosts, category, subcategory, ids, resource, params, options);
      } else {
        if (rpc.toLowerCase() === "grpc") {
          response = this._callGrpcService(hosts, category, subcategory, ids, resource, params, options);
        } else {
          console.error("No valid RPC method: ".concat(rpc, ". Accepted values are 'rest' and 'grpc'"));
        }
      }
    }

    return response;
  }

  _callRestWebService(hosts, category, subcategory, ids, resource, params, options) {
    let version = options.version || this._config.version;
    let species = options.species || this._config.species;
    let count = 0;
    let response;

    let url = this._createRestUrl(hosts[count], version, species, category, subcategory, ids, resource, params);

    let userError = options.error;

    let _this = this; // if the URL query fails we try with next host


    options.error = function () {
      if (++count < hosts.length) {
        // we need a new URL
        url = _this._createRestUrl(hosts[count], version, species, category, subcategory, ids, resource, params);
        response = rest_client_xmlhttp_RestClientXmlhttp.call(url, options);
      } else {
        userError(this);
      }
    }; // response = RestClient.call(url, options);


    response = rest_client_xmlhttp_RestClientXmlhttp.call(url, options);
    return response;
  }

  _createRestUrl(host, version, species, category, subcategory, ids, resource, params) {
    let _host = host; // Remove trailing '/'

    if (_host.endsWith("/")) {
      _host = _host.slice(0, -1);
    }

    let url = _host + "/webservices/rest/".concat(version, "/").concat(species, "/"); // By default we assume https protocol instead of http


    if (!url.startsWith("https://") && !url.startsWith("http://")) {
      url = "https://".concat(_host, "/webservices/rest/").concat(version, "/").concat(species, "/");
    } // Some web services do not need IDs


    if (typeof ids !== "undefined" && ids !== null && ids.length > 0) {
      url += "".concat(category, "/").concat(subcategory, "/").concat(ids, "/").concat(resource);
    } else {
      url += "".concat(category, "/").concat(subcategory, "/").concat(resource);
    } // We add the query params formatted in URL


    let queryParamsUrl = this._createSuffixKey(params, false);

    if (typeof queryParamsUrl !== "undefined" && queryParamsUrl != null && queryParamsUrl !== "") {
      url += "?".concat(queryParamsUrl);
    }

    return url;
  }

  _createSuffixKey(params, suffix) {
    // Do not remove the sort! we need to sort the array to ensure that the key of the cache will be correct
    let keyArray = _.keys(params).sort();

    let keyValueArray = [];

    for (let i in keyArray) {
      keyValueArray.push("".concat(keyArray[i], "=").concat(encodeURIComponent(params[keyArray[i]])));
    }

    let suffixKey = keyValueArray.join("&"); // suffixKey is preceded by '_' if suffix is true. Else it is treated as queryParam that needs to be sorted

    if (suffix && suffixKey !== "") {
      suffixKey = "_".concat(suffixKey);
    }

    return suffixKey;
  }

  _callGrpcService(params) {
    console.warn("Not implemented yet, params: " + params);
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/clients/reactome-client.js
/*
 * Copyright 2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

class ReactomeClient {
  constructor() {
    this.host = "https://reactome.org";
  }
  /*
   * Client factory functions
   */


  contentServiceClient() {
    if (typeof this._contentService === "undefined") {
      this._contentService = new ContentService(this.host + "/ContentService");
    }

    return this._contentService;
  }

}
class ContentService {
  constructor(host) {
    this.host = host;
  }
  /*
   * Client factory functions
   */


  mappingClient() {
    if (typeof this._mapping === "undefined") {
      this._mapping = new MappingClient(this.host + "/data/mapping");
    }

    return this._mapping;
  }

} // parent class

class reactome_client_ReactomeParentClass {
  constructor(host) {
    this.host = host;
  } // post(category, ids, action, params, body, options) {
  //     return this.extendedPost(category, ids, null, null, action, params, body, options);
  // }
  //
  // extendedPost(category1, ids1, category2, ids2, action, params, body, options) {
  //     let _options = options;
  //     if (typeof _options === "undefined") {
  //         _options = {};
  //     }
  //     _options.method = "POST";
  //     let _params = params;
  //
  //     if (typeof _params === "undefined") {
  //         _params = {};
  //     }
  //     _params.body = body;
  //     return this.extendedGet(category1, ids1, category2, ids2, action, _params, _options);
  // }


  get(category, ids, action, params, options) {
    return this.extendedGet(category, ids, null, null, action, params, options);
  }

  extendedGet(category1, ids1, category2, ids2, action, params, options) {
    // we store the options from the parameter or from the default values in config
    const host = this.host;
    const rpc = "rest";
    let method = "GET";
    let _options = options;

    if (typeof _options === "undefined") {
      _options = {};
    }

    if (_options.hasOwnProperty("method")) {
      method = _options.method;
    }

    let _params = params;

    if (_params === undefined || _params === null || _params === "") {
      _params = {};
    }

    if (rpc.toLowerCase() === "rest") {
      let url = this._createRestUrl(host, category1, ids1, category2, ids2, action);

      url = this._addQueryParams(url, _params);

      if (method === "POST") {
        _options.data = _params.body;
      }

      return rest_client_xmlhttp_RestClientXmlhttp.call(url, _options);
    }
  }

  _createRestUrl(host, category1, ids1, category2, ids2, action) {
    let url = host + "/" + category1 + "/"; // Some web services do not need IDs

    if (typeof ids1 !== "undefined" && ids1 !== null) {
      url += "".concat(ids1, "/");
    } // Some web services do not need a second category


    if (typeof category2 !== "undefined" && category2 !== null) {
      url += "".concat(category2, "/");
    } // Some web services do not need the second category of ids


    if (typeof ids2 !== "undefined" && ids2 !== null && ids2 !== "") {
      url += "".concat(ids2, "/");
    } // Some web services do not have action


    if (typeof action !== "undefined" && action !== null && action !== "") {
      url += action;
    }

    return url;
  }

  _addQueryParams(url, params) {
    // We add the query params formatted in URL
    const queryParamsUrl = this._createQueryParam(params);

    let _url = url;

    if (typeof queryParamsUrl !== "undefined" && queryParamsUrl !== null && queryParamsUrl !== "") {
      _url += "?".concat(queryParamsUrl);
    }

    return _url;
  }

  _createQueryParam(params) {
    // Do not remove the sort! we need to sort the array to ensure that the key of the cache will be correct
    let keyArray = _.keys(params);

    let keyValueArray = [];

    for (let i in keyArray) {
      // Whatever it is inside body will be sent hidden via POST
      if (keyArray[i] !== "body") {
        keyValueArray.push("".concat(keyArray[i], "=").concat(encodeURIComponent(params[keyArray[i]])));
      }
    }

    return keyValueArray.join("&");
  }

}
class MappingClient extends reactome_client_ReactomeParentClass {
  constructor(host) {
    super(host);
  } // The lower level pathways where an identifier can be mapped to


  pathways(resource, identifier, params) {
    return this.get(resource, identifier, "pathways", params);
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/lit-html/lib/directive.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const directive_directives = new WeakMap();
/**
 * Brands a function as a directive factory function so that lit-html will call
 * the function during template rendering, rather than passing as a value.
 *
 * A _directive_ is a function that takes a Part as an argument. It has the
 * signature: `(part: Part) => void`.
 *
 * A directive _factory_ is a function that takes arguments for data and
 * configuration and returns a directive. Users of directive usually refer to
 * the directive factory as the directive. For example, "The repeat directive".
 *
 * Usually a template author will invoke a directive factory in their template
 * with relevant arguments, which will then return a directive function.
 *
 * Here's an example of using the `repeat()` directive factory that takes an
 * array and a function to render an item:
 *
 * ```js
 * html`<ul><${repeat(items, (item) => html`<li>${item}</li>`)}</ul>`
 * ```
 *
 * When `repeat` is invoked, it returns a directive function that closes over
 * `items` and the template function. When the outer template is rendered, the
 * return directive function is called with the Part for the expression.
 * `repeat` then performs it's custom logic to render multiple items.
 *
 * @param f The directive factory function. Must be a function that returns a
 * function of the signature `(part: Part) => void`. The returned function will
 * be called with the part object.
 *
 * @example
 *
 * import {directive, html} from 'lit-html';
 *
 * const immutable = directive((v) => (part) => {
 *   if (part.value !== v) {
 *     part.setValue(v)
 *   }
 * });
 */
const lib_directive_directive = (f) => ((...args) => {
    const d = f(...args);
    directive_directives.set(d, true);
    return d;
});
const directive_isDirective = (o) => {
    return typeof o === 'function' && directive_directives.has(o);
};
//# sourceMappingURL=directive.js.map
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/lit-html/lib/dom.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * True if the custom elements polyfill is in use.
 */
const dom_isCEPolyfill = window.customElements !== undefined &&
    window.customElements.polyfillWrapFlushCallback !==
        undefined;
/**
 * Reparents nodes, starting from `start` (inclusive) to `end` (exclusive),
 * into another container (could be the same container), before `before`. If
 * `before` is null, it appends the nodes to the container.
 */
const dom_reparentNodes = (container, start, end = null, before = null) => {
    while (start !== end) {
        const n = start.nextSibling;
        container.insertBefore(start, before);
        start = n;
    }
};
/**
 * Removes nodes, starting from `start` (inclusive) to `end` (exclusive), from
 * `container`.
 */
const dom_removeNodes = (container, start, end = null) => {
    while (start !== end) {
        const n = start.nextSibling;
        container.removeChild(start);
        start = n;
    }
};
//# sourceMappingURL=dom.js.map
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/lit-html/lib/part.js
/**
 * @license
 * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * A sentinel value that signals that a value was handled by a directive and
 * should not be written to the DOM.
 */
const part_noChange = {};
/**
 * A sentinel value that signals a NodePart to fully clear its content.
 */
const part_nothing = {};
//# sourceMappingURL=part.js.map
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/lit-html/lib/template.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * An expression marker with embedded unique key to avoid collision with
 * possible text in templates.
 */
const template_marker = `{{lit-${String(Math.random()).slice(2)}}}`;
/**
 * An expression marker used text-positions, multi-binding attributes, and
 * attributes with markup-like text values.
 */
const template_nodeMarker = `<!--${template_marker}-->`;
const template_markerRegex = new RegExp(`${template_marker}|${template_nodeMarker}`);
/**
 * Suffix appended to all bound attribute names.
 */
const template_boundAttributeSuffix = '$lit$';
/**
 * An updateable Template that tracks the location of dynamic parts.
 */
class template_Template {
    constructor(result, element) {
        this.parts = [];
        this.element = element;
        const nodesToRemove = [];
        const stack = [];
        // Edge needs all 4 parameters present; IE11 needs 3rd parameter to be null
        const walker = document.createTreeWalker(element.content, 133 /* NodeFilter.SHOW_{ELEMENT|COMMENT|TEXT} */, null, false);
        // Keeps track of the last index associated with a part. We try to delete
        // unnecessary nodes, but we never want to associate two different parts
        // to the same index. They must have a constant node between.
        let lastPartIndex = 0;
        let index = -1;
        let partIndex = 0;
        const { strings, values: { length } } = result;
        while (partIndex < length) {
            const node = walker.nextNode();
            if (node === null) {
                // We've exhausted the content inside a nested template element.
                // Because we still have parts (the outer for-loop), we know:
                // - There is a template in the stack
                // - The walker will find a nextNode outside the template
                walker.currentNode = stack.pop();
                continue;
            }
            index++;
            if (node.nodeType === 1 /* Node.ELEMENT_NODE */) {
                if (node.hasAttributes()) {
                    const attributes = node.attributes;
                    const { length } = attributes;
                    // Per
                    // https://developer.mozilla.org/en-US/docs/Web/API/NamedNodeMap,
                    // attributes are not guaranteed to be returned in document order.
                    // In particular, Edge/IE can return them out of order, so we cannot
                    // assume a correspondence between part index and attribute index.
                    let count = 0;
                    for (let i = 0; i < length; i++) {
                        if (template_endsWith(attributes[i].name, template_boundAttributeSuffix)) {
                            count++;
                        }
                    }
                    while (count-- > 0) {
                        // Get the template literal section leading up to the first
                        // expression in this attribute
                        const stringForPart = strings[partIndex];
                        // Find the attribute name
                        const name = template_lastAttributeNameRegex.exec(stringForPart)[2];
                        // Find the corresponding attribute
                        // All bound attributes have had a suffix added in
                        // TemplateResult#getHTML to opt out of special attribute
                        // handling. To look up the attribute value we also need to add
                        // the suffix.
                        const attributeLookupName = name.toLowerCase() + template_boundAttributeSuffix;
                        const attributeValue = node.getAttribute(attributeLookupName);
                        node.removeAttribute(attributeLookupName);
                        const statics = attributeValue.split(template_markerRegex);
                        this.parts.push({ type: 'attribute', index, name, strings: statics });
                        partIndex += statics.length - 1;
                    }
                }
                if (node.tagName === 'TEMPLATE') {
                    stack.push(node);
                    walker.currentNode = node.content;
                }
            }
            else if (node.nodeType === 3 /* Node.TEXT_NODE */) {
                const data = node.data;
                if (data.indexOf(template_marker) >= 0) {
                    const parent = node.parentNode;
                    const strings = data.split(template_markerRegex);
                    const lastIndex = strings.length - 1;
                    // Generate a new text node for each literal section
                    // These nodes are also used as the markers for node parts
                    for (let i = 0; i < lastIndex; i++) {
                        let insert;
                        let s = strings[i];
                        if (s === '') {
                            insert = template_createMarker();
                        }
                        else {
                            const match = template_lastAttributeNameRegex.exec(s);
                            if (match !== null && template_endsWith(match[2], template_boundAttributeSuffix)) {
                                s = s.slice(0, match.index) + match[1] +
                                    match[2].slice(0, -template_boundAttributeSuffix.length) + match[3];
                            }
                            insert = document.createTextNode(s);
                        }
                        parent.insertBefore(insert, node);
                        this.parts.push({ type: 'node', index: ++index });
                    }
                    // If there's no text, we must insert a comment to mark our place.
                    // Else, we can trust it will stick around after cloning.
                    if (strings[lastIndex] === '') {
                        parent.insertBefore(template_createMarker(), node);
                        nodesToRemove.push(node);
                    }
                    else {
                        node.data = strings[lastIndex];
                    }
                    // We have a part for each match found
                    partIndex += lastIndex;
                }
            }
            else if (node.nodeType === 8 /* Node.COMMENT_NODE */) {
                if (node.data === template_marker) {
                    const parent = node.parentNode;
                    // Add a new marker node to be the startNode of the Part if any of
                    // the following are true:
                    //  * We don't have a previousSibling
                    //  * The previousSibling is already the start of a previous part
                    if (node.previousSibling === null || index === lastPartIndex) {
                        index++;
                        parent.insertBefore(template_createMarker(), node);
                    }
                    lastPartIndex = index;
                    this.parts.push({ type: 'node', index });
                    // If we don't have a nextSibling, keep this node so we have an end.
                    // Else, we can remove it to save future costs.
                    if (node.nextSibling === null) {
                        node.data = '';
                    }
                    else {
                        nodesToRemove.push(node);
                        index--;
                    }
                    partIndex++;
                }
                else {
                    let i = -1;
                    while ((i = node.data.indexOf(template_marker, i + 1)) !== -1) {
                        // Comment node has a binding marker inside, make an inactive part
                        // The binding won't work, but subsequent bindings will
                        // TODO (justinfagnani): consider whether it's even worth it to
                        // make bindings in comments work
                        this.parts.push({ type: 'node', index: -1 });
                        partIndex++;
                    }
                }
            }
        }
        // Remove text binding nodes after the walk to not disturb the TreeWalker
        for (const n of nodesToRemove) {
            n.parentNode.removeChild(n);
        }
    }
}
const template_endsWith = (str, suffix) => {
    const index = str.length - suffix.length;
    return index >= 0 && str.slice(index) === suffix;
};
const template_isTemplatePartActive = (part) => part.index !== -1;
// Allows `document.createComment('')` to be renamed for a
// small manual size-savings.
const template_createMarker = () => document.createComment('');
/**
 * This regex extracts the attribute name preceding an attribute-position
 * expression. It does this by matching the syntax allowed for attributes
 * against the string literal directly preceding the expression, assuming that
 * the expression is in an attribute-value position.
 *
 * See attributes in the HTML spec:
 * https://www.w3.org/TR/html5/syntax.html#elements-attributes
 *
 * " \x09\x0a\x0c\x0d" are HTML space characters:
 * https://www.w3.org/TR/html5/infrastructure.html#space-characters
 *
 * "\0-\x1F\x7F-\x9F" are Unicode control characters, which includes every
 * space character except " ".
 *
 * So an attribute is:
 *  * The name: any character except a control character, space character, ('),
 *    ("), ">", "=", or "/"
 *  * Followed by zero or more space characters
 *  * Followed by "="
 *  * Followed by zero or more space characters
 *  * Followed by:
 *    * Any character except space, ('), ("), "<", ">", "=", (`), or
 *    * (") then any non-("), or
 *    * (') then any non-(')
 */
const template_lastAttributeNameRegex = /([ \x09\x0a\x0c\x0d])([^\0-\x1F\x7F-\x9F "'>=/]+)([ \x09\x0a\x0c\x0d]*=[ \x09\x0a\x0c\x0d]*(?:[^ \x09\x0a\x0c\x0d"'`<>=]*|"[^"]*|'[^']*))$/;
//# sourceMappingURL=template.js.map
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/lit-html/lib/template-instance.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * @module lit-html
 */


/**
 * An instance of a `Template` that can be attached to the DOM and updated
 * with new values.
 */
class lib_template_instance_TemplateInstance {
    constructor(template, processor, options) {
        this.__parts = [];
        this.template = template;
        this.processor = processor;
        this.options = options;
    }
    update(values) {
        let i = 0;
        for (const part of this.__parts) {
            if (part !== undefined) {
                part.setValue(values[i]);
            }
            i++;
        }
        for (const part of this.__parts) {
            if (part !== undefined) {
                part.commit();
            }
        }
    }
    _clone() {
        // There are a number of steps in the lifecycle of a template instance's
        // DOM fragment:
        //  1. Clone - create the instance fragment
        //  2. Adopt - adopt into the main document
        //  3. Process - find part markers and create parts
        //  4. Upgrade - upgrade custom elements
        //  5. Update - set node, attribute, property, etc., values
        //  6. Connect - connect to the document. Optional and outside of this
        //     method.
        //
        // We have a few constraints on the ordering of these steps:
        //  * We need to upgrade before updating, so that property values will pass
        //    through any property setters.
        //  * We would like to process before upgrading so that we're sure that the
        //    cloned fragment is inert and not disturbed by self-modifying DOM.
        //  * We want custom elements to upgrade even in disconnected fragments.
        //
        // Given these constraints, with full custom elements support we would
        // prefer the order: Clone, Process, Adopt, Upgrade, Update, Connect
        //
        // But Safari dooes not implement CustomElementRegistry#upgrade, so we
        // can not implement that order and still have upgrade-before-update and
        // upgrade disconnected fragments. So we instead sacrifice the
        // process-before-upgrade constraint, since in Custom Elements v1 elements
        // must not modify their light DOM in the constructor. We still have issues
        // when co-existing with CEv0 elements like Polymer 1, and with polyfills
        // that don't strictly adhere to the no-modification rule because shadow
        // DOM, which may be created in the constructor, is emulated by being placed
        // in the light DOM.
        //
        // The resulting order is on native is: Clone, Adopt, Upgrade, Process,
        // Update, Connect. document.importNode() performs Clone, Adopt, and Upgrade
        // in one step.
        //
        // The Custom Elements v1 polyfill supports upgrade(), so the order when
        // polyfilled is the more ideal: Clone, Process, Adopt, Upgrade, Update,
        // Connect.
        const fragment = dom_isCEPolyfill ?
            this.template.element.content.cloneNode(true) :
            document.importNode(this.template.element.content, true);
        const stack = [];
        const parts = this.template.parts;
        // Edge needs all 4 parameters present; IE11 needs 3rd parameter to be null
        const walker = document.createTreeWalker(fragment, 133 /* NodeFilter.SHOW_{ELEMENT|COMMENT|TEXT} */, null, false);
        let partIndex = 0;
        let nodeIndex = 0;
        let part;
        let node = walker.nextNode();
        // Loop through all the nodes and parts of a template
        while (partIndex < parts.length) {
            part = parts[partIndex];
            if (!template_isTemplatePartActive(part)) {
                this.__parts.push(undefined);
                partIndex++;
                continue;
            }
            // Progress the tree walker until we find our next part's node.
            // Note that multiple parts may share the same node (attribute parts
            // on a single element), so this loop may not run at all.
            while (nodeIndex < part.index) {
                nodeIndex++;
                if (node.nodeName === 'TEMPLATE') {
                    stack.push(node);
                    walker.currentNode = node.content;
                }
                if ((node = walker.nextNode()) === null) {
                    // We've exhausted the content inside a nested template element.
                    // Because we still have parts (the outer for-loop), we know:
                    // - There is a template in the stack
                    // - The walker will find a nextNode outside the template
                    walker.currentNode = stack.pop();
                    node = walker.nextNode();
                }
            }
            // We've arrived at our part's node.
            if (part.type === 'node') {
                const part = this.processor.handleTextExpression(this.options);
                part.insertAfterNode(node.previousSibling);
                this.__parts.push(part);
            }
            else {
                this.__parts.push(...this.processor.handleAttributeExpressions(node, part.name, part.strings, this.options));
            }
            partIndex++;
        }
        if (dom_isCEPolyfill) {
            document.adoptNode(fragment);
            customElements.upgrade(fragment);
        }
        return fragment;
    }
}
//# sourceMappingURL=template-instance.js.map
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/lit-html/lib/template-result.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * @module lit-html
 */


const template_result_commentMarker = ` ${template_marker} `;
/**
 * The return type of `html`, which holds a Template and the values from
 * interpolated expressions.
 */
class lib_template_result_TemplateResult {
    constructor(strings, values, type, processor) {
        this.strings = strings;
        this.values = values;
        this.type = type;
        this.processor = processor;
    }
    /**
     * Returns a string of HTML used to create a `<template>` element.
     */
    getHTML() {
        const l = this.strings.length - 1;
        let html = '';
        let isCommentBinding = false;
        for (let i = 0; i < l; i++) {
            const s = this.strings[i];
            // For each binding we want to determine the kind of marker to insert
            // into the template source before it's parsed by the browser's HTML
            // parser. The marker type is based on whether the expression is in an
            // attribute, text, or comment poisition.
            //   * For node-position bindings we insert a comment with the marker
            //     sentinel as its text content, like <!--{{lit-guid}}-->.
            //   * For attribute bindings we insert just the marker sentinel for the
            //     first binding, so that we support unquoted attribute bindings.
            //     Subsequent bindings can use a comment marker because multi-binding
            //     attributes must be quoted.
            //   * For comment bindings we insert just the marker sentinel so we don't
            //     close the comment.
            //
            // The following code scans the template source, but is *not* an HTML
            // parser. We don't need to track the tree structure of the HTML, only
            // whether a binding is inside a comment, and if not, if it appears to be
            // the first binding in an attribute.
            const commentOpen = s.lastIndexOf('<!--');
            // We're in comment position if we have a comment open with no following
            // comment close. Because <-- can appear in an attribute value there can
            // be false positives.
            isCommentBinding = (commentOpen > -1 || isCommentBinding) &&
                s.indexOf('-->', commentOpen + 1) === -1;
            // Check to see if we have an attribute-like sequence preceeding the
            // expression. This can match "name=value" like structures in text,
            // comments, and attribute values, so there can be false-positives.
            const attributeMatch = template_lastAttributeNameRegex.exec(s);
            if (attributeMatch === null) {
                // We're only in this branch if we don't have a attribute-like
                // preceeding sequence. For comments, this guards against unusual
                // attribute values like <div foo="<!--${'bar'}">. Cases like
                // <!-- foo=${'bar'}--> are handled correctly in the attribute branch
                // below.
                html += s + (isCommentBinding ? template_result_commentMarker : template_nodeMarker);
            }
            else {
                // For attributes we use just a marker sentinel, and also append a
                // $lit$ suffix to the name to opt-out of attribute-specific parsing
                // that IE and Edge do for style and certain SVG attributes.
                html += s.substr(0, attributeMatch.index) + attributeMatch[1] +
                    attributeMatch[2] + template_boundAttributeSuffix + attributeMatch[3] +
                    template_marker;
            }
        }
        html += this.strings[l];
        return html;
    }
    getTemplateElement() {
        const template = document.createElement('template');
        template.innerHTML = this.getHTML();
        return template;
    }
}
/**
 * A TemplateResult for SVG fragments.
 *
 * This class wraps HTML in an `<svg>` tag in order to parse its contents in the
 * SVG namespace, then modifies the template to remove the `<svg>` tag so that
 * clones only container the original fragment.
 */
class lib_template_result_SVGTemplateResult extends lib_template_result_TemplateResult {
    getHTML() {
        return `<svg>${super.getHTML()}</svg>`;
    }
    getTemplateElement() {
        const template = super.getTemplateElement();
        const content = template.content;
        const svgElement = content.firstChild;
        content.removeChild(svgElement);
        dom_reparentNodes(content, svgElement.firstChild);
        return template;
    }
}
//# sourceMappingURL=template-result.js.map
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/lit-html/lib/parts.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * @module lit-html
 */






const parts_isPrimitive = (value) => {
    return (value === null ||
        !(typeof value === 'object' || typeof value === 'function'));
};
const parts_isIterable = (value) => {
    return Array.isArray(value) ||
        // tslint:disable-next-line:no-any
        !!(value && value[Symbol.iterator]);
};
/**
 * Writes attribute values to the DOM for a group of AttributeParts bound to a
 * single attibute. The value is only set once even if there are multiple parts
 * for an attribute.
 */
class parts_AttributeCommitter {
    constructor(element, name, strings) {
        this.dirty = true;
        this.element = element;
        this.name = name;
        this.strings = strings;
        this.parts = [];
        for (let i = 0; i < strings.length - 1; i++) {
            this.parts[i] = this._createPart();
        }
    }
    /**
     * Creates a single part. Override this to create a differnt type of part.
     */
    _createPart() {
        return new lib_parts_AttributePart(this);
    }
    _getValue() {
        const strings = this.strings;
        const l = strings.length - 1;
        let text = '';
        for (let i = 0; i < l; i++) {
            text += strings[i];
            const part = this.parts[i];
            if (part !== undefined) {
                const v = part.value;
                if (parts_isPrimitive(v) || !parts_isIterable(v)) {
                    text += typeof v === 'string' ? v : String(v);
                }
                else {
                    for (const t of v) {
                        text += typeof t === 'string' ? t : String(t);
                    }
                }
            }
        }
        text += strings[l];
        return text;
    }
    commit() {
        if (this.dirty) {
            this.dirty = false;
            this.element.setAttribute(this.name, this._getValue());
        }
    }
}
/**
 * A Part that controls all or part of an attribute value.
 */
class lib_parts_AttributePart {
    constructor(committer) {
        this.value = undefined;
        this.committer = committer;
    }
    setValue(value) {
        if (value !== part_noChange && (!parts_isPrimitive(value) || value !== this.value)) {
            this.value = value;
            // If the value is a not a directive, dirty the committer so that it'll
            // call setAttribute. If the value is a directive, it'll dirty the
            // committer if it calls setValue().
            if (!directive_isDirective(value)) {
                this.committer.dirty = true;
            }
        }
    }
    commit() {
        while (directive_isDirective(this.value)) {
            const directive = this.value;
            this.value = part_noChange;
            directive(this);
        }
        if (this.value === part_noChange) {
            return;
        }
        this.committer.commit();
    }
}
/**
 * A Part that controls a location within a Node tree. Like a Range, NodePart
 * has start and end locations and can set and update the Nodes between those
 * locations.
 *
 * NodeParts support several value types: primitives, Nodes, TemplateResults,
 * as well as arrays and iterables of those types.
 */
class lib_parts_NodePart {
    constructor(options) {
        this.value = undefined;
        this.__pendingValue = undefined;
        this.options = options;
    }
    /**
     * Appends this part into a container.
     *
     * This part must be empty, as its contents are not automatically moved.
     */
    appendInto(container) {
        this.startNode = container.appendChild(template_createMarker());
        this.endNode = container.appendChild(template_createMarker());
    }
    /**
     * Inserts this part after the `ref` node (between `ref` and `ref`'s next
     * sibling). Both `ref` and its next sibling must be static, unchanging nodes
     * such as those that appear in a literal section of a template.
     *
     * This part must be empty, as its contents are not automatically moved.
     */
    insertAfterNode(ref) {
        this.startNode = ref;
        this.endNode = ref.nextSibling;
    }
    /**
     * Appends this part into a parent part.
     *
     * This part must be empty, as its contents are not automatically moved.
     */
    appendIntoPart(part) {
        part.__insert(this.startNode = template_createMarker());
        part.__insert(this.endNode = template_createMarker());
    }
    /**
     * Inserts this part after the `ref` part.
     *
     * This part must be empty, as its contents are not automatically moved.
     */
    insertAfterPart(ref) {
        ref.__insert(this.startNode = template_createMarker());
        this.endNode = ref.endNode;
        ref.endNode = this.startNode;
    }
    setValue(value) {
        this.__pendingValue = value;
    }
    commit() {
        while (directive_isDirective(this.__pendingValue)) {
            const directive = this.__pendingValue;
            this.__pendingValue = part_noChange;
            directive(this);
        }
        const value = this.__pendingValue;
        if (value === part_noChange) {
            return;
        }
        if (parts_isPrimitive(value)) {
            if (value !== this.value) {
                this.__commitText(value);
            }
        }
        else if (value instanceof lib_template_result_TemplateResult) {
            this.__commitTemplateResult(value);
        }
        else if (value instanceof Node) {
            this.__commitNode(value);
        }
        else if (parts_isIterable(value)) {
            this.__commitIterable(value);
        }
        else if (value === part_nothing) {
            this.value = part_nothing;
            this.clear();
        }
        else {
            // Fallback, will render the string representation
            this.__commitText(value);
        }
    }
    __insert(node) {
        this.endNode.parentNode.insertBefore(node, this.endNode);
    }
    __commitNode(value) {
        if (this.value === value) {
            return;
        }
        this.clear();
        this.__insert(value);
        this.value = value;
    }
    __commitText(value) {
        const node = this.startNode.nextSibling;
        value = value == null ? '' : value;
        // If `value` isn't already a string, we explicitly convert it here in case
        // it can't be implicitly converted - i.e. it's a symbol.
        const valueAsString = typeof value === 'string' ? value : String(value);
        if (node === this.endNode.previousSibling &&
            node.nodeType === 3 /* Node.TEXT_NODE */) {
            // If we only have a single text node between the markers, we can just
            // set its value, rather than replacing it.
            // TODO(justinfagnani): Can we just check if this.value is primitive?
            node.data = valueAsString;
        }
        else {
            this.__commitNode(document.createTextNode(valueAsString));
        }
        this.value = value;
    }
    __commitTemplateResult(value) {
        const template = this.options.templateFactory(value);
        if (this.value instanceof lib_template_instance_TemplateInstance &&
            this.value.template === template) {
            this.value.update(value.values);
        }
        else {
            // Make sure we propagate the template processor from the TemplateResult
            // so that we use its syntax extension, etc. The template factory comes
            // from the render function options so that it can control template
            // caching and preprocessing.
            const instance = new lib_template_instance_TemplateInstance(template, value.processor, this.options);
            const fragment = instance._clone();
            instance.update(value.values);
            this.__commitNode(fragment);
            this.value = instance;
        }
    }
    __commitIterable(value) {
        // For an Iterable, we create a new InstancePart per item, then set its
        // value to the item. This is a little bit of overhead for every item in
        // an Iterable, but it lets us recurse easily and efficiently update Arrays
        // of TemplateResults that will be commonly returned from expressions like:
        // array.map((i) => html`${i}`), by reusing existing TemplateInstances.
        // If _value is an array, then the previous render was of an
        // iterable and _value will contain the NodeParts from the previous
        // render. If _value is not an array, clear this part and make a new
        // array for NodeParts.
        if (!Array.isArray(this.value)) {
            this.value = [];
            this.clear();
        }
        // Lets us keep track of how many items we stamped so we can clear leftover
        // items from a previous render
        const itemParts = this.value;
        let partIndex = 0;
        let itemPart;
        for (const item of value) {
            // Try to reuse an existing part
            itemPart = itemParts[partIndex];
            // If no existing part, create a new one
            if (itemPart === undefined) {
                itemPart = new lib_parts_NodePart(this.options);
                itemParts.push(itemPart);
                if (partIndex === 0) {
                    itemPart.appendIntoPart(this);
                }
                else {
                    itemPart.insertAfterPart(itemParts[partIndex - 1]);
                }
            }
            itemPart.setValue(item);
            itemPart.commit();
            partIndex++;
        }
        if (partIndex < itemParts.length) {
            // Truncate the parts array so _value reflects the current state
            itemParts.length = partIndex;
            this.clear(itemPart && itemPart.endNode);
        }
    }
    clear(startNode = this.startNode) {
        dom_removeNodes(this.startNode.parentNode, startNode.nextSibling, this.endNode);
    }
}
/**
 * Implements a boolean attribute, roughly as defined in the HTML
 * specification.
 *
 * If the value is truthy, then the attribute is present with a value of
 * ''. If the value is falsey, the attribute is removed.
 */
class lib_parts_BooleanAttributePart {
    constructor(element, name, strings) {
        this.value = undefined;
        this.__pendingValue = undefined;
        if (strings.length !== 2 || strings[0] !== '' || strings[1] !== '') {
            throw new Error('Boolean attributes can only contain a single expression');
        }
        this.element = element;
        this.name = name;
        this.strings = strings;
    }
    setValue(value) {
        this.__pendingValue = value;
    }
    commit() {
        while (directive_isDirective(this.__pendingValue)) {
            const directive = this.__pendingValue;
            this.__pendingValue = part_noChange;
            directive(this);
        }
        if (this.__pendingValue === part_noChange) {
            return;
        }
        const value = !!this.__pendingValue;
        if (this.value !== value) {
            if (value) {
                this.element.setAttribute(this.name, '');
            }
            else {
                this.element.removeAttribute(this.name);
            }
            this.value = value;
        }
        this.__pendingValue = part_noChange;
    }
}
/**
 * Sets attribute values for PropertyParts, so that the value is only set once
 * even if there are multiple parts for a property.
 *
 * If an expression controls the whole property value, then the value is simply
 * assigned to the property under control. If there are string literals or
 * multiple expressions, then the strings are expressions are interpolated into
 * a string first.
 */
class parts_PropertyCommitter extends parts_AttributeCommitter {
    constructor(element, name, strings) {
        super(element, name, strings);
        this.single =
            (strings.length === 2 && strings[0] === '' && strings[1] === '');
    }
    _createPart() {
        return new parts_PropertyPart(this);
    }
    _getValue() {
        if (this.single) {
            return this.parts[0].value;
        }
        return super._getValue();
    }
    commit() {
        if (this.dirty) {
            this.dirty = false;
            // tslint:disable-next-line:no-any
            this.element[this.name] = this._getValue();
        }
    }
}
class parts_PropertyPart extends lib_parts_AttributePart {
}
// Detect event listener options support. If the `capture` property is read
// from the options object, then options are supported. If not, then the thrid
// argument to add/removeEventListener is interpreted as the boolean capture
// value so we should only pass the `capture` property.
let parts_eventOptionsSupported = false;
try {
    const options = {
        get capture() {
            parts_eventOptionsSupported = true;
            return false;
        }
    };
    // tslint:disable-next-line:no-any
    window.addEventListener('test', options, options);
    // tslint:disable-next-line:no-any
    window.removeEventListener('test', options, options);
}
catch (_e) {
}
class lib_parts_EventPart {
    constructor(element, eventName, eventContext) {
        this.value = undefined;
        this.__pendingValue = undefined;
        this.element = element;
        this.eventName = eventName;
        this.eventContext = eventContext;
        this.__boundHandleEvent = (e) => this.handleEvent(e);
    }
    setValue(value) {
        this.__pendingValue = value;
    }
    commit() {
        while (directive_isDirective(this.__pendingValue)) {
            const directive = this.__pendingValue;
            this.__pendingValue = part_noChange;
            directive(this);
        }
        if (this.__pendingValue === part_noChange) {
            return;
        }
        const newListener = this.__pendingValue;
        const oldListener = this.value;
        const shouldRemoveListener = newListener == null ||
            oldListener != null &&
                (newListener.capture !== oldListener.capture ||
                    newListener.once !== oldListener.once ||
                    newListener.passive !== oldListener.passive);
        const shouldAddListener = newListener != null && (oldListener == null || shouldRemoveListener);
        if (shouldRemoveListener) {
            this.element.removeEventListener(this.eventName, this.__boundHandleEvent, this.__options);
        }
        if (shouldAddListener) {
            this.__options = parts_getOptions(newListener);
            this.element.addEventListener(this.eventName, this.__boundHandleEvent, this.__options);
        }
        this.value = newListener;
        this.__pendingValue = part_noChange;
    }
    handleEvent(event) {
        if (typeof this.value === 'function') {
            this.value.call(this.eventContext || this.element, event);
        }
        else {
            this.value.handleEvent(event);
        }
    }
}
// We copy options because of the inconsistent behavior of browsers when reading
// the third argument of add/removeEventListener. IE11 doesn't support options
// at all. Chrome 41 only reads `capture` if the argument is an object.
const parts_getOptions = (o) => o &&
    (parts_eventOptionsSupported ?
        { capture: o.capture, passive: o.passive, once: o.once } :
        o.capture);
//# sourceMappingURL=parts.js.map
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/lit-html/lib/default-template-processor.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */

/**
 * Creates Parts when a template is instantiated.
 */
class lib_default_template_processor_DefaultTemplateProcessor {
    /**
     * Create parts for an attribute-position binding, given the event, attribute
     * name, and string literals.
     *
     * @param element The element containing the binding
     * @param name  The attribute name
     * @param strings The string literals. There are always at least two strings,
     *   event for fully-controlled bindings with a single expression.
     */
    handleAttributeExpressions(element, name, strings, options) {
        const prefix = name[0];
        if (prefix === '.') {
            const committer = new parts_PropertyCommitter(element, name.slice(1), strings);
            return committer.parts;
        }
        if (prefix === '@') {
            return [new lib_parts_EventPart(element, name.slice(1), options.eventContext)];
        }
        if (prefix === '?') {
            return [new lib_parts_BooleanAttributePart(element, name.slice(1), strings)];
        }
        const committer = new parts_AttributeCommitter(element, name, strings);
        return committer.parts;
    }
    /**
     * Create parts for a text-position binding.
     * @param templateFactory
     */
    handleTextExpression(options) {
        return new lib_parts_NodePart(options);
    }
}
const default_template_processor_defaultTemplateProcessor = new lib_default_template_processor_DefaultTemplateProcessor();
//# sourceMappingURL=default-template-processor.js.map
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/lit-html/lib/template-factory.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */

/**
 * The default TemplateFactory which caches Templates keyed on
 * result.type and result.strings.
 */
function template_factory_templateFactory(result) {
    let templateCache = template_factory_templateCaches.get(result.type);
    if (templateCache === undefined) {
        templateCache = {
            stringsArray: new WeakMap(),
            keyString: new Map()
        };
        template_factory_templateCaches.set(result.type, templateCache);
    }
    let template = templateCache.stringsArray.get(result.strings);
    if (template !== undefined) {
        return template;
    }
    // If the TemplateStringsArray is new, generate a key from the strings
    // This key is shared between all templates with identical content
    const key = result.strings.join(template_marker);
    // Check if we already have a Template for this key
    template = templateCache.keyString.get(key);
    if (template === undefined) {
        // If we have not seen this key before, create a new Template
        template = new template_Template(result, result.getTemplateElement());
        // Cache the Template for this key
        templateCache.keyString.set(key, template);
    }
    // Cache all future queries for this TemplateStringsArray
    templateCache.stringsArray.set(result.strings, template);
    return template;
}
const template_factory_templateCaches = new Map();
//# sourceMappingURL=template-factory.js.map
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/lit-html/lib/render.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * @module lit-html
 */



const lib_render_parts = new WeakMap();
/**
 * Renders a template result or other value to a container.
 *
 * To update a container with new values, reevaluate the template literal and
 * call `render` with the new result.
 *
 * @param result Any value renderable by NodePart - typically a TemplateResult
 *     created by evaluating a template tag like `html` or `svg`.
 * @param container A DOM parent to render to. The entire contents are either
 *     replaced, or efficiently updated if the same result type was previous
 *     rendered there.
 * @param options RenderOptions for the entire render tree rendered to this
 *     container. Render options must *not* change between renders to the same
 *     container, as those changes will not effect previously rendered DOM.
 */
const render_render = (result, container, options) => {
    let part = lib_render_parts.get(container);
    if (part === undefined) {
        dom_removeNodes(container, container.firstChild);
        lib_render_parts.set(container, part = new lib_parts_NodePart(Object.assign({ templateFactory: template_factory_templateFactory }, options)));
        part.appendInto(container);
    }
    part.setValue(result);
    part.commit();
};
//# sourceMappingURL=render.js.map
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/lit-html/lit-html.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 *
 * Main lit-html module.
 *
 * Main exports:
 *
 * -  [[html]]
 * -  [[svg]]
 * -  [[render]]
 *
 * @module lit-html
 * @preferred
 */
/**
 * Do not remove this comment; it keeps typedoc from misplacing the module
 * docs.
 */




// TODO(justinfagnani): remove line when we get NodePart moving methods








// IMPORTANT: do not change the property name or the assignment expression.
// This line will be used in regexes to search for lit-html usage.
// TODO(justinfagnani): inject version number at build time
(window['litHtmlVersions'] || (window['litHtmlVersions'] = [])).push('1.1.2');
/**
 * Interprets a template literal as an HTML template that can efficiently
 * render to and update a container.
 */
const lit_html_lit_html_html = (strings, ...values) => new lib_template_result_TemplateResult(strings, values, 'html', default_template_processor_defaultTemplateProcessor);
/**
 * Interprets a template literal as an SVG template that can efficiently
 * render to and update a container.
 */
const lit_html_lit_html_svg = (strings, ...values) => new lib_template_result_SVGTemplateResult(strings, values, 'svg', default_template_processor_defaultTemplateProcessor);
//# sourceMappingURL=lit-html.js.map
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/lit-html/lib/modify-template.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * @module shady-render
 */

const modify_template_walkerNodeFilter = 133 /* NodeFilter.SHOW_{ELEMENT|COMMENT|TEXT} */;
/**
 * Removes the list of nodes from a Template safely. In addition to removing
 * nodes from the Template, the Template part indices are updated to match
 * the mutated Template DOM.
 *
 * As the template is walked the removal state is tracked and
 * part indices are adjusted as needed.
 *
 * div
 *   div#1 (remove) <-- start removing (removing node is div#1)
 *     div
 *       div#2 (remove)  <-- continue removing (removing node is still div#1)
 *         div
 * div <-- stop removing since previous sibling is the removing node (div#1,
 * removed 4 nodes)
 */
function modify_template_removeNodesFromTemplate(template, nodesToRemove) {
    const { element: { content }, parts } = template;
    const walker = document.createTreeWalker(content, modify_template_walkerNodeFilter, null, false);
    let partIndex = modify_template_nextActiveIndexInTemplateParts(parts);
    let part = parts[partIndex];
    let nodeIndex = -1;
    let removeCount = 0;
    const nodesToRemoveInTemplate = [];
    let currentRemovingNode = null;
    while (walker.nextNode()) {
        nodeIndex++;
        const node = walker.currentNode;
        // End removal if stepped past the removing node
        if (node.previousSibling === currentRemovingNode) {
            currentRemovingNode = null;
        }
        // A node to remove was found in the template
        if (nodesToRemove.has(node)) {
            nodesToRemoveInTemplate.push(node);
            // Track node we're removing
            if (currentRemovingNode === null) {
                currentRemovingNode = node;
            }
        }
        // When removing, increment count by which to adjust subsequent part indices
        if (currentRemovingNode !== null) {
            removeCount++;
        }
        while (part !== undefined && part.index === nodeIndex) {
            // If part is in a removed node deactivate it by setting index to -1 or
            // adjust the index as needed.
            part.index = currentRemovingNode !== null ? -1 : part.index - removeCount;
            // go to the next active part.
            partIndex = modify_template_nextActiveIndexInTemplateParts(parts, partIndex);
            part = parts[partIndex];
        }
    }
    nodesToRemoveInTemplate.forEach((n) => n.parentNode.removeChild(n));
}
const modify_template_countNodes = (node) => {
    let count = (node.nodeType === 11 /* Node.DOCUMENT_FRAGMENT_NODE */) ? 0 : 1;
    const walker = document.createTreeWalker(node, modify_template_walkerNodeFilter, null, false);
    while (walker.nextNode()) {
        count++;
    }
    return count;
};
const modify_template_nextActiveIndexInTemplateParts = (parts, startIndex = -1) => {
    for (let i = startIndex + 1; i < parts.length; i++) {
        const part = parts[i];
        if (template_isTemplatePartActive(part)) {
            return i;
        }
    }
    return -1;
};
/**
 * Inserts the given node into the Template, optionally before the given
 * refNode. In addition to inserting the node into the Template, the Template
 * part indices are updated to match the mutated Template DOM.
 */
function modify_template_insertNodeIntoTemplate(template, node, refNode = null) {
    const { element: { content }, parts } = template;
    // If there's no refNode, then put node at end of template.
    // No part indices need to be shifted in this case.
    if (refNode === null || refNode === undefined) {
        content.appendChild(node);
        return;
    }
    const walker = document.createTreeWalker(content, modify_template_walkerNodeFilter, null, false);
    let partIndex = modify_template_nextActiveIndexInTemplateParts(parts);
    let insertCount = 0;
    let walkerIndex = -1;
    while (walker.nextNode()) {
        walkerIndex++;
        const walkerNode = walker.currentNode;
        if (walkerNode === refNode) {
            insertCount = modify_template_countNodes(node);
            refNode.parentNode.insertBefore(node, refNode);
        }
        while (partIndex !== -1 && parts[partIndex].index === walkerIndex) {
            // If we've inserted the node, simply adjust all subsequent parts
            if (insertCount > 0) {
                while (partIndex !== -1) {
                    parts[partIndex].index += insertCount;
                    partIndex = modify_template_nextActiveIndexInTemplateParts(parts, partIndex);
                }
                return;
            }
            partIndex = modify_template_nextActiveIndexInTemplateParts(parts, partIndex);
        }
    }
}
//# sourceMappingURL=modify-template.js.map
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/lit-html/lib/shady-render.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
/**
 * Module to add shady DOM/shady CSS polyfill support to lit-html template
 * rendering. See the [[render]] method for details.
 *
 * @module shady-render
 * @preferred
 */
/**
 * Do not remove this comment; it keeps typedoc from misplacing the module
 * docs.
 */







// Get a key to lookup in `templateCaches`.
const shady_render_getTemplateCacheKey = (type, scopeName) => `${type}--${scopeName}`;
let shady_render_compatibleShadyCSSVersion = true;
if (typeof window.ShadyCSS === 'undefined') {
    shady_render_compatibleShadyCSSVersion = false;
}
else if (typeof window.ShadyCSS.prepareTemplateDom === 'undefined') {
    console.warn(`Incompatible ShadyCSS version detected. ` +
        `Please update to at least @webcomponents/webcomponentsjs@2.0.2 and ` +
        `@webcomponents/shadycss@1.3.1.`);
    shady_render_compatibleShadyCSSVersion = false;
}
/**
 * Template factory which scopes template DOM using ShadyCSS.
 * @param scopeName {string}
 */
const shady_render_shadyTemplateFactory = (scopeName) => (result) => {
    const cacheKey = shady_render_getTemplateCacheKey(result.type, scopeName);
    let templateCache = template_factory_templateCaches.get(cacheKey);
    if (templateCache === undefined) {
        templateCache = {
            stringsArray: new WeakMap(),
            keyString: new Map()
        };
        template_factory_templateCaches.set(cacheKey, templateCache);
    }
    let template = templateCache.stringsArray.get(result.strings);
    if (template !== undefined) {
        return template;
    }
    const key = result.strings.join(template_marker);
    template = templateCache.keyString.get(key);
    if (template === undefined) {
        const element = result.getTemplateElement();
        if (shady_render_compatibleShadyCSSVersion) {
            window.ShadyCSS.prepareTemplateDom(element, scopeName);
        }
        template = new template_Template(result, element);
        templateCache.keyString.set(key, template);
    }
    templateCache.stringsArray.set(result.strings, template);
    return template;
};
const shady_render_TEMPLATE_TYPES = ['html', 'svg'];
/**
 * Removes all style elements from Templates for the given scopeName.
 */
const shady_render_removeStylesFromLitTemplates = (scopeName) => {
    shady_render_TEMPLATE_TYPES.forEach((type) => {
        const templates = template_factory_templateCaches.get(shady_render_getTemplateCacheKey(type, scopeName));
        if (templates !== undefined) {
            templates.keyString.forEach((template) => {
                const { element: { content } } = template;
                // IE 11 doesn't support the iterable param Set constructor
                const styles = new Set();
                Array.from(content.querySelectorAll('style')).forEach((s) => {
                    styles.add(s);
                });
                modify_template_removeNodesFromTemplate(template, styles);
            });
        }
    });
};
const shady_render_shadyRenderSet = new Set();
/**
 * For the given scope name, ensures that ShadyCSS style scoping is performed.
 * This is done just once per scope name so the fragment and template cannot
 * be modified.
 * (1) extracts styles from the rendered fragment and hands them to ShadyCSS
 * to be scoped and appended to the document
 * (2) removes style elements from all lit-html Templates for this scope name.
 *
 * Note, <style> elements can only be placed into templates for the
 * initial rendering of the scope. If <style> elements are included in templates
 * dynamically rendered to the scope (after the first scope render), they will
 * not be scoped and the <style> will be left in the template and rendered
 * output.
 */
const shady_render_prepareTemplateStyles = (scopeName, renderedDOM, template) => {
    shady_render_shadyRenderSet.add(scopeName);
    // If `renderedDOM` is stamped from a Template, then we need to edit that
    // Template's underlying template element. Otherwise, we create one here
    // to give to ShadyCSS, which still requires one while scoping.
    const templateElement = !!template ? template.element : document.createElement('template');
    // Move styles out of rendered DOM and store.
    const styles = renderedDOM.querySelectorAll('style');
    const { length } = styles;
    // If there are no styles, skip unnecessary work
    if (length === 0) {
        // Ensure prepareTemplateStyles is called to support adding
        // styles via `prepareAdoptedCssText` since that requires that
        // `prepareTemplateStyles` is called.
        //
        // ShadyCSS will only update styles containing @apply in the template
        // given to `prepareTemplateStyles`. If no lit Template was given,
        // ShadyCSS will not be able to update uses of @apply in any relevant
        // template. However, this is not a problem because we only create the
        // template for the purpose of supporting `prepareAdoptedCssText`,
        // which doesn't support @apply at all.
        window.ShadyCSS.prepareTemplateStyles(templateElement, scopeName);
        return;
    }
    const condensedStyle = document.createElement('style');
    // Collect styles into a single style. This helps us make sure ShadyCSS
    // manipulations will not prevent us from being able to fix up template
    // part indices.
    // NOTE: collecting styles is inefficient for browsers but ShadyCSS
    // currently does this anyway. When it does not, this should be changed.
    for (let i = 0; i < length; i++) {
        const style = styles[i];
        style.parentNode.removeChild(style);
        condensedStyle.textContent += style.textContent;
    }
    // Remove styles from nested templates in this scope.
    shady_render_removeStylesFromLitTemplates(scopeName);
    // And then put the condensed style into the "root" template passed in as
    // `template`.
    const content = templateElement.content;
    if (!!template) {
        modify_template_insertNodeIntoTemplate(template, condensedStyle, content.firstChild);
    }
    else {
        content.insertBefore(condensedStyle, content.firstChild);
    }
    // Note, it's important that ShadyCSS gets the template that `lit-html`
    // will actually render so that it can update the style inside when
    // needed (e.g. @apply native Shadow DOM case).
    window.ShadyCSS.prepareTemplateStyles(templateElement, scopeName);
    const style = content.querySelector('style');
    if (window.ShadyCSS.nativeShadow && style !== null) {
        // When in native Shadow DOM, ensure the style created by ShadyCSS is
        // included in initially rendered output (`renderedDOM`).
        renderedDOM.insertBefore(style.cloneNode(true), renderedDOM.firstChild);
    }
    else if (!!template) {
        // When no style is left in the template, parts will be broken as a
        // result. To fix this, we put back the style node ShadyCSS removed
        // and then tell lit to remove that node from the template.
        // There can be no style in the template in 2 cases (1) when Shady DOM
        // is in use, ShadyCSS removes all styles, (2) when native Shadow DOM
        // is in use ShadyCSS removes the style if it contains no content.
        // NOTE, ShadyCSS creates its own style so we can safely add/remove
        // `condensedStyle` here.
        content.insertBefore(condensedStyle, content.firstChild);
        const removes = new Set();
        removes.add(condensedStyle);
        modify_template_removeNodesFromTemplate(template, removes);
    }
};
/**
 * Extension to the standard `render` method which supports rendering
 * to ShadowRoots when the ShadyDOM (https://github.com/webcomponents/shadydom)
 * and ShadyCSS (https://github.com/webcomponents/shadycss) polyfills are used
 * or when the webcomponentsjs
 * (https://github.com/webcomponents/webcomponentsjs) polyfill is used.
 *
 * Adds a `scopeName` option which is used to scope element DOM and stylesheets
 * when native ShadowDOM is unavailable. The `scopeName` will be added to
 * the class attribute of all rendered DOM. In addition, any style elements will
 * be automatically re-written with this `scopeName` selector and moved out
 * of the rendered DOM and into the document `<head>`.
 *
 * It is common to use this render method in conjunction with a custom element
 * which renders a shadowRoot. When this is done, typically the element's
 * `localName` should be used as the `scopeName`.
 *
 * In addition to DOM scoping, ShadyCSS also supports a basic shim for css
 * custom properties (needed only on older browsers like IE11) and a shim for
 * a deprecated feature called `@apply` that supports applying a set of css
 * custom properties to a given location.
 *
 * Usage considerations:
 *
 * * Part values in `<style>` elements are only applied the first time a given
 * `scopeName` renders. Subsequent changes to parts in style elements will have
 * no effect. Because of this, parts in style elements should only be used for
 * values that will never change, for example parts that set scope-wide theme
 * values or parts which render shared style elements.
 *
 * * Note, due to a limitation of the ShadyDOM polyfill, rendering in a
 * custom element's `constructor` is not supported. Instead rendering should
 * either done asynchronously, for example at microtask timing (for example
 * `Promise.resolve()`), or be deferred until the first time the element's
 * `connectedCallback` runs.
 *
 * Usage considerations when using shimmed custom properties or `@apply`:
 *
 * * Whenever any dynamic changes are made which affect
 * css custom properties, `ShadyCSS.styleElement(element)` must be called
 * to update the element. There are two cases when this is needed:
 * (1) the element is connected to a new parent, (2) a class is added to the
 * element that causes it to match different custom properties.
 * To address the first case when rendering a custom element, `styleElement`
 * should be called in the element's `connectedCallback`.
 *
 * * Shimmed custom properties may only be defined either for an entire
 * shadowRoot (for example, in a `:host` rule) or via a rule that directly
 * matches an element with a shadowRoot. In other words, instead of flowing from
 * parent to child as do native css custom properties, shimmed custom properties
 * flow only from shadowRoots to nested shadowRoots.
 *
 * * When using `@apply` mixing css shorthand property names with
 * non-shorthand names (for example `border` and `border-width`) is not
 * supported.
 */
const lib_shady_render_render = (result, container, options) => {
    if (!options || typeof options !== 'object' || !options.scopeName) {
        throw new Error('The `scopeName` option is required.');
    }
    const scopeName = options.scopeName;
    const hasRendered = lib_render_parts.has(container);
    const needsScoping = shady_render_compatibleShadyCSSVersion &&
        container.nodeType === 11 /* Node.DOCUMENT_FRAGMENT_NODE */ &&
        !!container.host;
    // Handle first render to a scope specially...
    const firstScopeRender = needsScoping && !shady_render_shadyRenderSet.has(scopeName);
    // On first scope render, render into a fragment; this cannot be a single
    // fragment that is reused since nested renders can occur synchronously.
    const renderContainer = firstScopeRender ? document.createDocumentFragment() : container;
    render_render(result, renderContainer, Object.assign({ templateFactory: shady_render_shadyTemplateFactory(scopeName) }, options));
    // When performing first scope render,
    // (1) We've rendered into a fragment so that there's a chance to
    // `prepareTemplateStyles` before sub-elements hit the DOM
    // (which might cause them to render based on a common pattern of
    // rendering in a custom element's `connectedCallback`);
    // (2) Scope the template with ShadyCSS one time only for this scope.
    // (3) Render the fragment into the container and make sure the
    // container knows its `part` is the one we just rendered. This ensures
    // DOM will be re-used on subsequent renders.
    if (firstScopeRender) {
        const part = lib_render_parts.get(renderContainer);
        lib_render_parts.delete(renderContainer);
        // ShadyCSS might have style sheets (e.g. from `prepareAdoptedCssText`)
        // that should apply to `renderContainer` even if the rendered value is
        // not a TemplateInstance. However, it will only insert scoped styles
        // into the document if `prepareTemplateStyles` has already been called
        // for the given scope name.
        const template = part.value instanceof lib_template_instance_TemplateInstance ?
            part.value.template :
            undefined;
        shady_render_prepareTemplateStyles(scopeName, renderContainer, template);
        dom_removeNodes(container, container.firstChild);
        container.appendChild(renderContainer);
        lib_render_parts.set(container, part);
    }
    // After elements have hit the DOM, update styling if this is the
    // initial render to this container.
    // This is needed whenever dynamic changes are made so it would be
    // safest to do every render; however, this would regress performance
    // so we leave it up to the user to call `ShadyCSS.styleElement`
    // for dynamic changes.
    if (!hasRendered && needsScoping) {
        window.ShadyCSS.styleElement(container.host);
    }
};
//# sourceMappingURL=shady-render.js.map
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/lit-element/lib/updating-element.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
var updating_element_a;
/**
 * When using Closure Compiler, JSCompiler_renameProperty(property, object) is
 * replaced at compile time by the munged name for object[property]. We cannot
 * alias this function, so we have to use a small shim that has the same
 * behavior when not compiling.
 */
window.JSCompiler_renameProperty =
    (prop, _obj) => prop;
const updating_element_defaultConverter = {
    toAttribute(value, type) {
        switch (type) {
            case Boolean:
                return value ? '' : null;
            case Object:
            case Array:
                // if the value is `null` or `undefined` pass this through
                // to allow removing/no change behavior.
                return value == null ? value : JSON.stringify(value);
        }
        return value;
    },
    fromAttribute(value, type) {
        switch (type) {
            case Boolean:
                return value !== null;
            case Number:
                return value === null ? null : Number(value);
            case Object:
            case Array:
                return JSON.parse(value);
        }
        return value;
    }
};
/**
 * Change function that returns true if `value` is different from `oldValue`.
 * This method is used as the default for a property's `hasChanged` function.
 */
const updating_element_notEqual = (value, old) => {
    // This ensures (old==NaN, value==NaN) always returns false
    return old !== value && (old === old || value === value);
};
const updating_element_defaultPropertyDeclaration = {
    attribute: true,
    type: String,
    converter: updating_element_defaultConverter,
    reflect: false,
    hasChanged: updating_element_notEqual
};
const updating_element_microtaskPromise = Promise.resolve(true);
const updating_element_STATE_HAS_UPDATED = 1;
const updating_element_STATE_UPDATE_REQUESTED = 1 << 2;
const updating_element_STATE_IS_REFLECTING_TO_ATTRIBUTE = 1 << 3;
const updating_element_STATE_IS_REFLECTING_TO_PROPERTY = 1 << 4;
const updating_element_STATE_HAS_CONNECTED = 1 << 5;
/**
 * The Closure JS Compiler doesn't currently have good support for static
 * property semantics where "this" is dynamic (e.g.
 * https://github.com/google/closure-compiler/issues/3177 and others) so we use
 * this hack to bypass any rewriting by the compiler.
 */
const updating_element_finalized = 'finalized';
/**
 * Base element class which manages element properties and attributes. When
 * properties change, the `update` method is asynchronously called. This method
 * should be supplied by subclassers to render updates as desired.
 */
class updating_element_UpdatingElement extends HTMLElement {
    constructor() {
        super();
        this._updateState = 0;
        this._instanceProperties = undefined;
        this._updatePromise = updating_element_microtaskPromise;
        this._hasConnectedResolver = undefined;
        /**
         * Map with keys for any properties that have changed since the last
         * update cycle with previous values.
         */
        this._changedProperties = new Map();
        /**
         * Map with keys of properties that should be reflected when updated.
         */
        this._reflectingProperties = undefined;
        this.initialize();
    }
    /**
     * Returns a list of attributes corresponding to the registered properties.
     * @nocollapse
     */
    static get observedAttributes() {
        // note: piggy backing on this to ensure we're finalized.
        this.finalize();
        const attributes = [];
        // Use forEach so this works even if for/of loops are compiled to for loops
        // expecting arrays
        this._classProperties.forEach((v, p) => {
            const attr = this._attributeNameForProperty(p, v);
            if (attr !== undefined) {
                this._attributeToPropertyMap.set(attr, p);
                attributes.push(attr);
            }
        });
        return attributes;
    }
    /**
     * Ensures the private `_classProperties` property metadata is created.
     * In addition to `finalize` this is also called in `createProperty` to
     * ensure the `@property` decorator can add property metadata.
     */
    /** @nocollapse */
    static _ensureClassProperties() {
        // ensure private storage for property declarations.
        if (!this.hasOwnProperty(JSCompiler_renameProperty('_classProperties', this))) {
            this._classProperties = new Map();
            // NOTE: Workaround IE11 not supporting Map constructor argument.
            const superProperties = Object.getPrototypeOf(this)._classProperties;
            if (superProperties !== undefined) {
                superProperties.forEach((v, k) => this._classProperties.set(k, v));
            }
        }
    }
    /**
     * Creates a property accessor on the element prototype if one does not exist.
     * The property setter calls the property's `hasChanged` property option
     * or uses a strict identity check to determine whether or not to request
     * an update.
     * @nocollapse
     */
    static createProperty(name, options = updating_element_defaultPropertyDeclaration) {
        // Note, since this can be called by the `@property` decorator which
        // is called before `finalize`, we ensure storage exists for property
        // metadata.
        this._ensureClassProperties();
        this._classProperties.set(name, options);
        // Do not generate an accessor if the prototype already has one, since
        // it would be lost otherwise and that would never be the user's intention;
        // Instead, we expect users to call `requestUpdate` themselves from
        // user-defined accessors. Note that if the super has an accessor we will
        // still overwrite it
        if (options.noAccessor || this.prototype.hasOwnProperty(name)) {
            return;
        }
        const key = typeof name === 'symbol' ? Symbol() : `__${name}`;
        Object.defineProperty(this.prototype, name, {
            // tslint:disable-next-line:no-any no symbol in index
            get() {
                return this[key];
            },
            set(value) {
                const oldValue = this[name];
                this[key] = value;
                this._requestUpdate(name, oldValue);
            },
            configurable: true,
            enumerable: true
        });
    }
    /**
     * Creates property accessors for registered properties and ensures
     * any superclasses are also finalized.
     * @nocollapse
     */
    static finalize() {
        // finalize any superclasses
        const superCtor = Object.getPrototypeOf(this);
        if (!superCtor.hasOwnProperty(updating_element_finalized)) {
            superCtor.finalize();
        }
        this[updating_element_finalized] = true;
        this._ensureClassProperties();
        // initialize Map populated in observedAttributes
        this._attributeToPropertyMap = new Map();
        // make any properties
        // Note, only process "own" properties since this element will inherit
        // any properties defined on the superClass, and finalization ensures
        // the entire prototype chain is finalized.
        if (this.hasOwnProperty(JSCompiler_renameProperty('properties', this))) {
            const props = this.properties;
            // support symbols in properties (IE11 does not support this)
            const propKeys = [
                ...Object.getOwnPropertyNames(props),
                ...(typeof Object.getOwnPropertySymbols === 'function') ?
                    Object.getOwnPropertySymbols(props) :
                    []
            ];
            // This for/of is ok because propKeys is an array
            for (const p of propKeys) {
                // note, use of `any` is due to TypeSript lack of support for symbol in
                // index types
                // tslint:disable-next-line:no-any no symbol in index
                this.createProperty(p, props[p]);
            }
        }
    }
    /**
     * Returns the property name for the given attribute `name`.
     * @nocollapse
     */
    static _attributeNameForProperty(name, options) {
        const attribute = options.attribute;
        return attribute === false ?
            undefined :
            (typeof attribute === 'string' ?
                attribute :
                (typeof name === 'string' ? name.toLowerCase() : undefined));
    }
    /**
     * Returns true if a property should request an update.
     * Called when a property value is set and uses the `hasChanged`
     * option for the property if present or a strict identity check.
     * @nocollapse
     */
    static _valueHasChanged(value, old, hasChanged = updating_element_notEqual) {
        return hasChanged(value, old);
    }
    /**
     * Returns the property value for the given attribute value.
     * Called via the `attributeChangedCallback` and uses the property's
     * `converter` or `converter.fromAttribute` property option.
     * @nocollapse
     */
    static _propertyValueFromAttribute(value, options) {
        const type = options.type;
        const converter = options.converter || updating_element_defaultConverter;
        const fromAttribute = (typeof converter === 'function' ? converter : converter.fromAttribute);
        return fromAttribute ? fromAttribute(value, type) : value;
    }
    /**
     * Returns the attribute value for the given property value. If this
     * returns undefined, the property will *not* be reflected to an attribute.
     * If this returns null, the attribute will be removed, otherwise the
     * attribute will be set to the value.
     * This uses the property's `reflect` and `type.toAttribute` property options.
     * @nocollapse
     */
    static _propertyValueToAttribute(value, options) {
        if (options.reflect === undefined) {
            return;
        }
        const type = options.type;
        const converter = options.converter;
        const toAttribute = converter && converter.toAttribute ||
            updating_element_defaultConverter.toAttribute;
        return toAttribute(value, type);
    }
    /**
     * Performs element initialization. By default captures any pre-set values for
     * registered properties.
     */
    initialize() {
        this._saveInstanceProperties();
        // ensures first update will be caught by an early access of
        // `updateComplete`
        this._requestUpdate();
    }
    /**
     * Fixes any properties set on the instance before upgrade time.
     * Otherwise these would shadow the accessor and break these properties.
     * The properties are stored in a Map which is played back after the
     * constructor runs. Note, on very old versions of Safari (<=9) or Chrome
     * (<=41), properties created for native platform properties like (`id` or
     * `name`) may not have default values set in the element constructor. On
     * these browsers native properties appear on instances and therefore their
     * default value will overwrite any element default (e.g. if the element sets
     * this.id = 'id' in the constructor, the 'id' will become '' since this is
     * the native platform default).
     */
    _saveInstanceProperties() {
        // Use forEach so this works even if for/of loops are compiled to for loops
        // expecting arrays
        this.constructor
            ._classProperties.forEach((_v, p) => {
            if (this.hasOwnProperty(p)) {
                const value = this[p];
                delete this[p];
                if (!this._instanceProperties) {
                    this._instanceProperties = new Map();
                }
                this._instanceProperties.set(p, value);
            }
        });
    }
    /**
     * Applies previously saved instance properties.
     */
    _applyInstanceProperties() {
        // Use forEach so this works even if for/of loops are compiled to for loops
        // expecting arrays
        // tslint:disable-next-line:no-any
        this._instanceProperties.forEach((v, p) => this[p] = v);
        this._instanceProperties = undefined;
    }
    connectedCallback() {
        this._updateState = this._updateState | updating_element_STATE_HAS_CONNECTED;
        // Ensure first connection completes an update. Updates cannot complete
        // before connection and if one is pending connection the
        // `_hasConnectionResolver` will exist. If so, resolve it to complete the
        // update, otherwise requestUpdate.
        if (this._hasConnectedResolver) {
            this._hasConnectedResolver();
            this._hasConnectedResolver = undefined;
        }
    }
    /**
     * Allows for `super.disconnectedCallback()` in extensions while
     * reserving the possibility of making non-breaking feature additions
     * when disconnecting at some point in the future.
     */
    disconnectedCallback() {
    }
    /**
     * Synchronizes property values when attributes change.
     */
    attributeChangedCallback(name, old, value) {
        if (old !== value) {
            this._attributeToProperty(name, value);
        }
    }
    _propertyToAttribute(name, value, options = updating_element_defaultPropertyDeclaration) {
        const ctor = this.constructor;
        const attr = ctor._attributeNameForProperty(name, options);
        if (attr !== undefined) {
            const attrValue = ctor._propertyValueToAttribute(value, options);
            // an undefined value does not change the attribute.
            if (attrValue === undefined) {
                return;
            }
            // Track if the property is being reflected to avoid
            // setting the property again via `attributeChangedCallback`. Note:
            // 1. this takes advantage of the fact that the callback is synchronous.
            // 2. will behave incorrectly if multiple attributes are in the reaction
            // stack at time of calling. However, since we process attributes
            // in `update` this should not be possible (or an extreme corner case
            // that we'd like to discover).
            // mark state reflecting
            this._updateState = this._updateState | updating_element_STATE_IS_REFLECTING_TO_ATTRIBUTE;
            if (attrValue == null) {
                this.removeAttribute(attr);
            }
            else {
                this.setAttribute(attr, attrValue);
            }
            // mark state not reflecting
            this._updateState = this._updateState & ~updating_element_STATE_IS_REFLECTING_TO_ATTRIBUTE;
        }
    }
    _attributeToProperty(name, value) {
        // Use tracking info to avoid deserializing attribute value if it was
        // just set from a property setter.
        if (this._updateState & updating_element_STATE_IS_REFLECTING_TO_ATTRIBUTE) {
            return;
        }
        const ctor = this.constructor;
        const propName = ctor._attributeToPropertyMap.get(name);
        if (propName !== undefined) {
            const options = ctor._classProperties.get(propName) || updating_element_defaultPropertyDeclaration;
            // mark state reflecting
            this._updateState = this._updateState | updating_element_STATE_IS_REFLECTING_TO_PROPERTY;
            this[propName] =
                // tslint:disable-next-line:no-any
                ctor._propertyValueFromAttribute(value, options);
            // mark state not reflecting
            this._updateState = this._updateState & ~updating_element_STATE_IS_REFLECTING_TO_PROPERTY;
        }
    }
    /**
     * This private version of `requestUpdate` does not access or return the
     * `updateComplete` promise. This promise can be overridden and is therefore
     * not free to access.
     */
    _requestUpdate(name, oldValue) {
        let shouldRequestUpdate = true;
        // If we have a property key, perform property update steps.
        if (name !== undefined) {
            const ctor = this.constructor;
            const options = ctor._classProperties.get(name) || updating_element_defaultPropertyDeclaration;
            if (ctor._valueHasChanged(this[name], oldValue, options.hasChanged)) {
                if (!this._changedProperties.has(name)) {
                    this._changedProperties.set(name, oldValue);
                }
                // Add to reflecting properties set.
                // Note, it's important that every change has a chance to add the
                // property to `_reflectingProperties`. This ensures setting
                // attribute + property reflects correctly.
                if (options.reflect === true &&
                    !(this._updateState & updating_element_STATE_IS_REFLECTING_TO_PROPERTY)) {
                    if (this._reflectingProperties === undefined) {
                        this._reflectingProperties = new Map();
                    }
                    this._reflectingProperties.set(name, options);
                }
            }
            else {
                // Abort the request if the property should not be considered changed.
                shouldRequestUpdate = false;
            }
        }
        if (!this._hasRequestedUpdate && shouldRequestUpdate) {
            this._enqueueUpdate();
        }
    }
    /**
     * Requests an update which is processed asynchronously. This should
     * be called when an element should update based on some state not triggered
     * by setting a property. In this case, pass no arguments. It should also be
     * called when manually implementing a property setter. In this case, pass the
     * property `name` and `oldValue` to ensure that any configured property
     * options are honored. Returns the `updateComplete` Promise which is resolved
     * when the update completes.
     *
     * @param name {PropertyKey} (optional) name of requesting property
     * @param oldValue {any} (optional) old value of requesting property
     * @returns {Promise} A Promise that is resolved when the update completes.
     */
    requestUpdate(name, oldValue) {
        this._requestUpdate(name, oldValue);
        return this.updateComplete;
    }
    /**
     * Sets up the element to asynchronously update.
     */
    async _enqueueUpdate() {
        // Mark state updating...
        this._updateState = this._updateState | updating_element_STATE_UPDATE_REQUESTED;
        let resolve;
        let reject;
        const previousUpdatePromise = this._updatePromise;
        this._updatePromise = new Promise((res, rej) => {
            resolve = res;
            reject = rej;
        });
        try {
            // Ensure any previous update has resolved before updating.
            // This `await` also ensures that property changes are batched.
            await previousUpdatePromise;
        }
        catch (e) {
            // Ignore any previous errors. We only care that the previous cycle is
            // done. Any error should have been handled in the previous update.
        }
        // Make sure the element has connected before updating.
        if (!this._hasConnected) {
            await new Promise((res) => this._hasConnectedResolver = res);
        }
        try {
            const result = this.performUpdate();
            // If `performUpdate` returns a Promise, we await it. This is done to
            // enable coordinating updates with a scheduler. Note, the result is
            // checked to avoid delaying an additional microtask unless we need to.
            if (result != null) {
                await result;
            }
        }
        catch (e) {
            reject(e);
        }
        resolve(!this._hasRequestedUpdate);
    }
    get _hasConnected() {
        return (this._updateState & updating_element_STATE_HAS_CONNECTED);
    }
    get _hasRequestedUpdate() {
        return (this._updateState & updating_element_STATE_UPDATE_REQUESTED);
    }
    get hasUpdated() {
        return (this._updateState & updating_element_STATE_HAS_UPDATED);
    }
    /**
     * Performs an element update. Note, if an exception is thrown during the
     * update, `firstUpdated` and `updated` will not be called.
     *
     * You can override this method to change the timing of updates. If this
     * method is overridden, `super.performUpdate()` must be called.
     *
     * For instance, to schedule updates to occur just before the next frame:
     *
     * ```
     * protected async performUpdate(): Promise<unknown> {
     *   await new Promise((resolve) => requestAnimationFrame(() => resolve()));
     *   super.performUpdate();
     * }
     * ```
     */
    performUpdate() {
        // Mixin instance properties once, if they exist.
        if (this._instanceProperties) {
            this._applyInstanceProperties();
        }
        let shouldUpdate = false;
        const changedProperties = this._changedProperties;
        try {
            shouldUpdate = this.shouldUpdate(changedProperties);
            if (shouldUpdate) {
                this.update(changedProperties);
            }
        }
        catch (e) {
            // Prevent `firstUpdated` and `updated` from running when there's an
            // update exception.
            shouldUpdate = false;
            throw e;
        }
        finally {
            // Ensure element can accept additional updates after an exception.
            this._markUpdated();
        }
        if (shouldUpdate) {
            if (!(this._updateState & updating_element_STATE_HAS_UPDATED)) {
                this._updateState = this._updateState | updating_element_STATE_HAS_UPDATED;
                this.firstUpdated(changedProperties);
            }
            this.updated(changedProperties);
        }
    }
    _markUpdated() {
        this._changedProperties = new Map();
        this._updateState = this._updateState & ~updating_element_STATE_UPDATE_REQUESTED;
    }
    /**
     * Returns a Promise that resolves when the element has completed updating.
     * The Promise value is a boolean that is `true` if the element completed the
     * update without triggering another update. The Promise result is `false` if
     * a property was set inside `updated()`. If the Promise is rejected, an
     * exception was thrown during the update.
     *
     * To await additional asynchronous work, override the `_getUpdateComplete`
     * method. For example, it is sometimes useful to await a rendered element
     * before fulfilling this Promise. To do this, first await
     * `super._getUpdateComplete()`, then any subsequent state.
     *
     * @returns {Promise} The Promise returns a boolean that indicates if the
     * update resolved without triggering another update.
     */
    get updateComplete() {
        return this._getUpdateComplete();
    }
    /**
     * Override point for the `updateComplete` promise.
     *
     * It is not safe to override the `updateComplete` getter directly due to a
     * limitation in TypeScript which means it is not possible to call a
     * superclass getter (e.g. `super.updateComplete.then(...)`) when the target
     * language is ES5 (https://github.com/microsoft/TypeScript/issues/338).
     * This method should be overridden instead. For example:
     *
     *   class MyElement extends LitElement {
     *     async _getUpdateComplete() {
     *       await super._getUpdateComplete();
     *       await this._myChild.updateComplete;
     *     }
     *   }
     */
    _getUpdateComplete() {
        return this._updatePromise;
    }
    /**
     * Controls whether or not `update` should be called when the element requests
     * an update. By default, this method always returns `true`, but this can be
     * customized to control when to update.
     *
     * * @param _changedProperties Map of changed properties with old values
     */
    shouldUpdate(_changedProperties) {
        return true;
    }
    /**
     * Updates the element. This method reflects property values to attributes.
     * It can be overridden to render and keep updated element DOM.
     * Setting properties inside this method will *not* trigger
     * another update.
     *
     * * @param _changedProperties Map of changed properties with old values
     */
    update(_changedProperties) {
        if (this._reflectingProperties !== undefined &&
            this._reflectingProperties.size > 0) {
            // Use forEach so this works even if for/of loops are compiled to for
            // loops expecting arrays
            this._reflectingProperties.forEach((v, k) => this._propertyToAttribute(k, this[k], v));
            this._reflectingProperties = undefined;
        }
    }
    /**
     * Invoked whenever the element is updated. Implement to perform
     * post-updating tasks via DOM APIs, for example, focusing an element.
     *
     * Setting properties inside this method will trigger the element to update
     * again after this update cycle completes.
     *
     * * @param _changedProperties Map of changed properties with old values
     */
    updated(_changedProperties) {
    }
    /**
     * Invoked when the element is first updated. Implement to perform one time
     * work on the element after update.
     *
     * Setting properties inside this method will trigger the element to update
     * again after this update cycle completes.
     *
     * * @param _changedProperties Map of changed properties with old values
     */
    firstUpdated(_changedProperties) {
    }
}
updating_element_a = updating_element_finalized;
/**
 * Marks class as having finished creating properties.
 */
updating_element_UpdatingElement[updating_element_a] = true;
//# sourceMappingURL=updating-element.js.map
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/lit-element/lib/decorators.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const decorators_legacyCustomElement = (tagName, clazz) => {
    window.customElements.define(tagName, clazz);
    // Cast as any because TS doesn't recognize the return type as being a
    // subtype of the decorated class when clazz is typed as
    // `Constructor<HTMLElement>` for some reason.
    // `Constructor<HTMLElement>` is helpful to make sure the decorator is
    // applied to elements however.
    // tslint:disable-next-line:no-any
    return clazz;
};
const decorators_standardCustomElement = (tagName, descriptor) => {
    const { kind, elements } = descriptor;
    return {
        kind,
        elements,
        // This callback is called once the class is otherwise fully defined
        finisher(clazz) {
            window.customElements.define(tagName, clazz);
        }
    };
};
/**
 * Class decorator factory that defines the decorated class as a custom element.
 *
 * @param tagName the name of the custom element to define
 */
const decorators_customElement = (tagName) => (classOrDescriptor) => (typeof classOrDescriptor === 'function') ?
    decorators_legacyCustomElement(tagName, classOrDescriptor) :
    decorators_standardCustomElement(tagName, classOrDescriptor);
const decorators_standardProperty = (options, element) => {
    // When decorating an accessor, pass it through and add property metadata.
    // Note, the `hasOwnProperty` check in `createProperty` ensures we don't
    // stomp over the user's accessor.
    if (element.kind === 'method' && element.descriptor &&
        !('value' in element.descriptor)) {
        return Object.assign({}, element, { finisher(clazz) {
                clazz.createProperty(element.key, options);
            } });
    }
    else {
        // createProperty() takes care of defining the property, but we still
        // must return some kind of descriptor, so return a descriptor for an
        // unused prototype field. The finisher calls createProperty().
        return {
            kind: 'field',
            key: Symbol(),
            placement: 'own',
            descriptor: {},
            // When @babel/plugin-proposal-decorators implements initializers,
            // do this instead of the initializer below. See:
            // https://github.com/babel/babel/issues/9260 extras: [
            //   {
            //     kind: 'initializer',
            //     placement: 'own',
            //     initializer: descriptor.initializer,
            //   }
            // ],
            initializer() {
                if (typeof element.initializer === 'function') {
                    this[element.key] = element.initializer.call(this);
                }
            },
            finisher(clazz) {
                clazz.createProperty(element.key, options);
            }
        };
    }
};
const decorators_legacyProperty = (options, proto, name) => {
    proto.constructor
        .createProperty(name, options);
};
/**
 * A property decorator which creates a LitElement property which reflects a
 * corresponding attribute value. A `PropertyDeclaration` may optionally be
 * supplied to configure property features.
 *
 * @ExportDecoratedItems
 */
function decorators_property(options) {
    // tslint:disable-next-line:no-any decorator
    return (protoOrDescriptor, name) => (name !== undefined) ?
        decorators_legacyProperty(options, protoOrDescriptor, name) :
        decorators_standardProperty(options, protoOrDescriptor);
}
/**
 * A property decorator that converts a class property into a getter that
 * executes a querySelector on the element's renderRoot.
 *
 * @ExportDecoratedItems
 */
function lib_decorators_query(selector) {
    return (protoOrDescriptor, 
    // tslint:disable-next-line:no-any decorator
    name) => {
        const descriptor = {
            get() {
                return this.renderRoot.querySelector(selector);
            },
            enumerable: true,
            configurable: true,
        };
        return (name !== undefined) ?
            decorators_legacyQuery(descriptor, protoOrDescriptor, name) :
            decorators_standardQuery(descriptor, protoOrDescriptor);
    };
}
/**
 * A property decorator that converts a class property into a getter
 * that executes a querySelectorAll on the element's renderRoot.
 *
 * @ExportDecoratedItems
 */
function decorators_queryAll(selector) {
    return (protoOrDescriptor, 
    // tslint:disable-next-line:no-any decorator
    name) => {
        const descriptor = {
            get() {
                return this.renderRoot.querySelectorAll(selector);
            },
            enumerable: true,
            configurable: true,
        };
        return (name !== undefined) ?
            decorators_legacyQuery(descriptor, protoOrDescriptor, name) :
            decorators_standardQuery(descriptor, protoOrDescriptor);
    };
}
const decorators_legacyQuery = (descriptor, proto, name) => {
    Object.defineProperty(proto, name, descriptor);
};
const decorators_standardQuery = (descriptor, element) => ({
    kind: 'method',
    placement: 'prototype',
    key: element.key,
    descriptor,
});
const decorators_standardEventOptions = (options, element) => {
    return Object.assign({}, element, { finisher(clazz) {
            Object.assign(clazz.prototype[element.key], options);
        } });
};
const decorators_legacyEventOptions = 
// tslint:disable-next-line:no-any legacy decorator
(options, proto, name) => {
    Object.assign(proto[name], options);
};
/**
 * Adds event listener options to a method used as an event listener in a
 * lit-html template.
 *
 * @param options An object that specifis event listener options as accepted by
 * `EventTarget#addEventListener` and `EventTarget#removeEventListener`.
 *
 * Current browsers support the `capture`, `passive`, and `once` options. See:
 * https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener#Parameters
 *
 * @example
 *
 *     class MyElement {
 *
 *       clicked = false;
 *
 *       render() {
 *         return html`<div @click=${this._onClick}`><button></button></div>`;
 *       }
 *
 *       @eventOptions({capture: true})
 *       _onClick(e) {
 *         this.clicked = true;
 *       }
 *     }
 */
const decorators_eventOptions = (options) => 
// Return value typed as any to prevent TypeScript from complaining that
// standard decorator function signature does not match TypeScript decorator
// signature
// TODO(kschaaf): unclear why it was only failing on this decorator and not
// the others
((protoOrDescriptor, name) => (name !== undefined) ?
    decorators_legacyEventOptions(options, protoOrDescriptor, name) :
    decorators_standardEventOptions(options, protoOrDescriptor));
//# sourceMappingURL=decorators.js.map
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/lit-element/lib/css-tag.js
/**
@license
Copyright (c) 2019 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at
http://polymer.github.io/LICENSE.txt The complete set of authors may be found at
http://polymer.github.io/AUTHORS.txt The complete set of contributors may be
found at http://polymer.github.io/CONTRIBUTORS.txt Code distributed by Google as
part of the polymer project is also subject to an additional IP rights grant
found at http://polymer.github.io/PATENTS.txt
*/
const css_tag_supportsAdoptingStyleSheets = ('adoptedStyleSheets' in Document.prototype) &&
    ('replace' in CSSStyleSheet.prototype);
const css_tag_constructionToken = Symbol();
class css_tag_CSSResult {
    constructor(cssText, safeToken) {
        if (safeToken !== css_tag_constructionToken) {
            throw new Error('CSSResult is not constructable. Use `unsafeCSS` or `css` instead.');
        }
        this.cssText = cssText;
    }
    // Note, this is a getter so that it's lazy. In practice, this means
    // stylesheets are not created until the first element instance is made.
    get styleSheet() {
        if (this._styleSheet === undefined) {
            // Note, if `adoptedStyleSheets` is supported then we assume CSSStyleSheet
            // is constructable.
            if (css_tag_supportsAdoptingStyleSheets) {
                this._styleSheet = new CSSStyleSheet();
                this._styleSheet.replaceSync(this.cssText);
            }
            else {
                this._styleSheet = null;
            }
        }
        return this._styleSheet;
    }
    toString() {
        return this.cssText;
    }
}
/**
 * Wrap a value for interpolation in a css tagged template literal.
 *
 * This is unsafe because untrusted CSS text can be used to phone home
 * or exfiltrate data to an attacker controlled site. Take care to only use
 * this with trusted input.
 */
const css_tag_unsafeCSS = (value) => {
    return new css_tag_CSSResult(String(value), css_tag_constructionToken);
};
const css_tag_textFromCSSResult = (value) => {
    if (value instanceof css_tag_CSSResult) {
        return value.cssText;
    }
    else if (typeof value === 'number') {
        return value;
    }
    else {
        throw new Error(`Value passed to 'css' function must be a 'css' function result: ${value}. Use 'unsafeCSS' to pass non-literal values, but
            take care to ensure page security.`);
    }
};
/**
 * Template tag which which can be used with LitElement's `style` property to
 * set element styles. For security reasons, only literal string values may be
 * used. To incorporate non-literal values `unsafeCSS` may be used inside a
 * template string part.
 */
const css_tag_css = (strings, ...values) => {
    const cssText = values.reduce((acc, v, idx) => acc + css_tag_textFromCSSResult(v) + strings[idx + 1], strings[0]);
    return new css_tag_CSSResult(cssText, css_tag_constructionToken);
};
//# sourceMappingURL=css-tag.js.map
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/lit-element/lit-element.js
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */








// IMPORTANT: do not change the property name or the assignment expression.
// This line will be used in regexes to search for LitElement usage.
// TODO(justinfagnani): inject version number at build time
(window['litElementVersions'] || (window['litElementVersions'] = []))
    .push('2.2.1');
/**
 * Minimal implementation of Array.prototype.flat
 * @param arr the array to flatten
 * @param result the accumlated result
 */
function lit_element_arrayFlat(styles, result = []) {
    for (let i = 0, length = styles.length; i < length; i++) {
        const value = styles[i];
        if (Array.isArray(value)) {
            lit_element_arrayFlat(value, result);
        }
        else {
            result.push(value);
        }
    }
    return result;
}
/** Deeply flattens styles array. Uses native flat if available. */
const lit_element_flattenStyles = (styles) => styles.flat ? styles.flat(Infinity) : lit_element_arrayFlat(styles);
class lit_element_lit_element_LitElement extends updating_element_UpdatingElement {
    /** @nocollapse */
    static finalize() {
        // The Closure JS Compiler does not always preserve the correct "this"
        // when calling static super methods (b/137460243), so explicitly bind.
        super.finalize.call(this);
        // Prepare styling that is stamped at first render time. Styling
        // is built from user provided `styles` or is inherited from the superclass.
        this._styles =
            this.hasOwnProperty(JSCompiler_renameProperty('styles', this)) ?
                this._getUniqueStyles() :
                this._styles || [];
    }
    /** @nocollapse */
    static _getUniqueStyles() {
        // Take care not to call `this.styles` multiple times since this generates
        // new CSSResults each time.
        // TODO(sorvell): Since we do not cache CSSResults by input, any
        // shared styles will generate new stylesheet objects, which is wasteful.
        // This should be addressed when a browser ships constructable
        // stylesheets.
        const userStyles = this.styles;
        const styles = [];
        if (Array.isArray(userStyles)) {
            const flatStyles = lit_element_flattenStyles(userStyles);
            // As a performance optimization to avoid duplicated styling that can
            // occur especially when composing via subclassing, de-duplicate styles
            // preserving the last item in the list. The last item is kept to
            // try to preserve cascade order with the assumption that it's most
            // important that last added styles override previous styles.
            const styleSet = flatStyles.reduceRight((set, s) => {
                set.add(s);
                // on IE set.add does not return the set.
                return set;
            }, new Set());
            // Array.from does not work on Set in IE
            styleSet.forEach((v) => styles.unshift(v));
        }
        else if (userStyles) {
            styles.push(userStyles);
        }
        return styles;
    }
    /**
     * Performs element initialization. By default this calls `createRenderRoot`
     * to create the element `renderRoot` node and captures any pre-set values for
     * registered properties.
     */
    initialize() {
        super.initialize();
        this.renderRoot =
            this.createRenderRoot();
        // Note, if renderRoot is not a shadowRoot, styles would/could apply to the
        // element's getRootNode(). While this could be done, we're choosing not to
        // support this now since it would require different logic around de-duping.
        if (window.ShadowRoot && this.renderRoot instanceof window.ShadowRoot) {
            this.adoptStyles();
        }
    }
    /**
     * Returns the node into which the element should render and by default
     * creates and returns an open shadowRoot. Implement to customize where the
     * element's DOM is rendered. For example, to render into the element's
     * childNodes, return `this`.
     * @returns {Element|DocumentFragment} Returns a node into which to render.
     */
    createRenderRoot() {
        return this.attachShadow({ mode: 'open' });
    }
    /**
     * Applies styling to the element shadowRoot using the `static get styles`
     * property. Styling will apply using `shadowRoot.adoptedStyleSheets` where
     * available and will fallback otherwise. When Shadow DOM is polyfilled,
     * ShadyCSS scopes styles and adds them to the document. When Shadow DOM
     * is available but `adoptedStyleSheets` is not, styles are appended to the
     * end of the `shadowRoot` to [mimic spec
     * behavior](https://wicg.github.io/construct-stylesheets/#using-constructed-stylesheets).
     */
    adoptStyles() {
        const styles = this.constructor._styles;
        if (styles.length === 0) {
            return;
        }
        // There are three separate cases here based on Shadow DOM support.
        // (1) shadowRoot polyfilled: use ShadyCSS
        // (2) shadowRoot.adoptedStyleSheets available: use it.
        // (3) shadowRoot.adoptedStyleSheets polyfilled: append styles after
        // rendering
        if (window.ShadyCSS !== undefined && !window.ShadyCSS.nativeShadow) {
            window.ShadyCSS.ScopingShim.prepareAdoptedCssText(styles.map((s) => s.cssText), this.localName);
        }
        else if (css_tag_supportsAdoptingStyleSheets) {
            this.renderRoot.adoptedStyleSheets =
                styles.map((s) => s.styleSheet);
        }
        else {
            // This must be done after rendering so the actual style insertion is done
            // in `update`.
            this._needsShimAdoptedStyleSheets = true;
        }
    }
    connectedCallback() {
        super.connectedCallback();
        // Note, first update/render handles styleElement so we only call this if
        // connected after first update.
        if (this.hasUpdated && window.ShadyCSS !== undefined) {
            window.ShadyCSS.styleElement(this);
        }
    }
    /**
     * Updates the element. This method reflects property values to attributes
     * and calls `render` to render DOM via lit-html. Setting properties inside
     * this method will *not* trigger another update.
     * * @param _changedProperties Map of changed properties with old values
     */
    update(changedProperties) {
        super.update(changedProperties);
        const templateResult = this.render();
        if (templateResult instanceof lib_template_result_TemplateResult) {
            this.constructor
                .render(templateResult, this.renderRoot, { scopeName: this.localName, eventContext: this });
        }
        // When native Shadow DOM is used but adoptedStyles are not supported,
        // insert styling after rendering to ensure adoptedStyles have highest
        // priority.
        if (this._needsShimAdoptedStyleSheets) {
            this._needsShimAdoptedStyleSheets = false;
            this.constructor._styles.forEach((s) => {
                const style = document.createElement('style');
                style.textContent = s.cssText;
                this.renderRoot.appendChild(style);
            });
        }
    }
    /**
     * Invoked on each update to perform rendering tasks. This method must return
     * a lit-html TemplateResult. Setting properties inside this method will *not*
     * trigger the element to update.
     */
    render() {
    }
}
/**
 * Ensure this class is marked as `finalized` as an optimization ensuring
 * it will not needlessly try to `finalize`.
 *
 * Note this property name is a string to prevent breaking Closure JS Compiler
 * optimizations. See updating-element.ts for more information.
 */
lit_element_lit_element_LitElement['finalized'] = true;
/**
 * Render method used to render the lit-html TemplateResult to the element's
 * DOM.
 * @param {TemplateResult} Template to render.
 * @param {Element|DocumentFragment} Node into which to render.
 * @param {String} Element name.
 * @nocollapse
 */
lit_element_lit_element_LitElement.render = lib_shady_render_render;
//# sourceMappingURL=lit-element.js.map
// CONCATENATED MODULE: ./lib/jsorolla/src/core/NotificationUtils.js

 //TODO evaluate turning this to a WC and the render would show the notifcation

class NotificationUtils_NotificationUtils {
  constructor() {} //this.notifications = [];
  // Notify api: http://bootstrap-notify.remabledesigns.com/


  static showNotify(message = "", type = "INFO", options = {}, settings = {}, opencgaClient = null, notifyInstance = null) {
    const types = {
      "ERROR": "danger",
      "SUCCESS": "success",
      "WARNING": "warning",
      "INFO": "info"
    };
    const defaultIcons = {
      "ERROR": "fa fa-times-circle",
      "SUCCESS": "fa fa-check-circle",
      "WARNING": "fa fa-exclamation-triangle",
      "INFO": "fa fa-info-circle"
    };
    let settingsDefault = {
      placement: {
        from: "top",
        align: "center"
      },
      type: types[type] || types["INFO"],
      animate: {
        enter: 'zoomInDown',
        exit: 'zoomInDown'
      },
      delay: 2000
    };
    const icon = defaultIcons[type];
    let optionsDefault = {
      message: message,
      icon: icon //url: document.location.href + "?reload",
      //target: "_self"

    };
    settingsDefault = Object.assign({}, settingsDefault, settings);
    optionsDefault = Object.assign({}, optionsDefault, options);

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(notifyInstance)) {
      notifyInstance.update("message", message);
      return notifyInstance;
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(opencgaClient)) {
      this.opencgaClient = opencgaClient;
    } //this.notifications.push(message)


    return $.notify(optionsDefault, settingsDefault);
  }

  static closeNotify(notifyInstance) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(notifyInstance)) {
      notifyInstance.close();
    }
  } //TODO check why this method is here...


  static refreshToken(event) {
    console.log("refreshtoken");

    const _this = this;

    this.opencgaClient.refresh().then(response => {
      const sessionId = response.getResult(0).token;
      const decoded = jwt_decode(sessionId);
      const dateExpired = new Date(decoded.exp * 1000);
      const validTimeSessionId = moment(dateExpired, "YYYYMMDDHHmmss").format("D MMM YY HH:mm:ss");

      const _message = "Your session is now valid until " + validTimeSessionId;

      $.notifyClose();

      _this.showNotify(_message);
    });
  }
  /*render() {
      return html`<div>
          Notification!
          <div data-notify="container" class="col-xs-11 col-sm-4 alert alert-info" role="alert" data-notify-position="top-center" style="display: inline-block; margin: 0px auto; position: fixed; transition: all 0.5s ease-in-out 0s; z-index: 1031; top: 20px; left: 0px; right: 0px;"><button type="button" aria-hidden="true" class="close" data-notify="dismiss" style="position: absolute; right: 10px; top: 5px; z-index: 1033;"></button><span data-notify="icon" class="fa fa-info-circle"></span> <span data-notify="title"></span> <span data-notify="message">Your session is close to expire. <strong>27 minutes remaining</strong>. <a>Click here to refresh</a></span><a href="#" target="_blank" data-notify="url"></a></div>
           ${this.notifications.length ? this.notifications.map( notification => html`-- ${notification} -- `) : null}
      </div>`;
  }*/


}
customElements.define("notification-utils", NotificationUtils_NotificationUtils);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/variant-modal-ontology.js
function variant_modal_ontology_templateObject3() {
  const data = variant_modal_ontology_taggedTemplateLiteral(["\n                                                <li class=\"list-group-item\">", "(", ") <button type=\"button\" class=\"btn danger\" @click=\"", "\" data-selected-term-id=\"", "\">X</button></li>\n                                            "]);

  variant_modal_ontology_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function variant_modal_ontology_templateObject2() {
  const data = variant_modal_ontology_taggedTemplateLiteral(["\n                                            <ul class=\"list-group infoHpo\">\n                                                <li class=\"list-group-item\"><strong>Label: </strong>", "</li>\n                                                <li class=\"list-group-item\"><strong>Short form: </strong>", "</li>\n                                                <li class=\"list-group-item\"><strong>Obo Id: </strong>", "</li>\n                                                <li class=\"list-group-item\"><strong>IRI: </strong>", "</li>\n                                                <li class=\"list-group-item\"><strong>Description: </strong>", "</li>\n                                                <li class=\"list-group-item\"><button type=\"button\" class=\"btn btn-info\" @click=\"", "\">Add Term</button></li>\n                                            </ul>\n                                        "]);

  variant_modal_ontology_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function variant_modal_ontology_templateObject() {
  const data = variant_modal_ontology_taggedTemplateLiteral(["\n            <style include=\"jso-styles\"></style>\n            <div class=\"modal fade\" id=\"", "ontologyModal\" tabindex=\"-1\" role=\"dialog\"\n                 aria-labelledby=\"ontologyLabel\" data-backdrop=\"static\" data-keyboard=\"false\">\n                <div class=\"modal-dialog modal-sm\" role=\"document\" style=\"width: 1300px;\">\n                    <div class=\"modal-content\">\n                        <div class=\"modal-header\">\n                            <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                                <span aria-hidden=\"true\">&times;</span>\n                            </button>\n                            <h4 class=\"modal-title\" id=\"", "EditorLabel\">", " terms selector</h4>\n                        </div>\n                        <div class=\"modal-body\">\n                            <div class=\"container-fluid\">\n                                <div class=\"row\">\n                                    <div class=\"col-sm-12\">\n                                        <label>Introduce an ", " term</label>\n                                    </div>\n                                    <div class=\"col-sm-6\" style=\"overflow-y: auto; height:400px;\" id=\"", "divDatalist\">\n                                        <form>\n                                            <fieldset>\n                                                <div class=\"form-group\">\n                                                    <input matcher=\"", "\" class=\"form-control typeahead\" name=\"query\"\n                                                           id=\"", "typeahead\" data-provide=\"typeahead\"\n                                                           placeholder=\"Start typing something to search...\" type=\"text\"\n                                                           autocomplete=\"off\">\n                                                </div>\n                                            </fieldset>\n                                        </form>\n                                        ", "\n            \n                                        <ul class=\"list-group\">\n                                            ", "\n                                        </ul>\n                                    </div>\n            \n                                    <div class=\"col-sm-6\" style=\"overflow-y: auto; height:400px;\">\n                                        <div id=\"", "TermsTree\"></div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n            \n                        <div class=\"modal-footer\">\n                            <button type=\"button\" class=\"btn btn-primary\" @click=\"", "\">OK</button>\n                        </div>\n                    </div>\n                </div>\n            </div>"]);

  variant_modal_ontology_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function variant_modal_ontology_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



 //TODO FIXME selectedTerms: reopening the modal they are wrong (array of strings)

class variant_modal_ontology_VariantModalOntology extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      //there will be 2 instances of this component, so it inherit the prefix from the related father (hpo-accessions-filter/go-accessions-filter)
      _prefix: {
        type: String
      },
      ontologyFilter: {
        type: String
      },
      term: {
        type: String
      },
      selectedTerms: {
        type: Array
      }
    };
  }

  updated(changedProperties) {
    if (changedProperties.has("selectedTerms")) {//selectedTerm observer to handle subsequent reopening of the modal after a first selection
    }

    if (changedProperties.has("ontologyFilter")) {
      this.ontologyFilterObserver();
    }
  }

  firstUpdated() {
    const _this = this;

    const typeaheadField = $("#" + this._prefix + "typeahead");
    typeaheadField.typeahead("destroy");
    typeaheadField.typeahead({
      source: function source(query, process) {
        return _this.searchTerm(query, process);
      },
      hint: true,
      highlight: true,
      minLength: 1,
      autoSelect: true,
      items: 15,
      afterSelect: this.selectTerm.bind(_this)
    });
  }

  process(data) {
    return data;
  }

  _init() {
    // this._prefix = "vmo-" + Utils.randomString(6) + "_";
    this.ebiConfig = {
      root: "https://www.ebi.ac.uk/ols/api",
      tree: {
        "hp": ["/ontologies/hp/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252FHP_0012823", "/ontologies/hp/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252FHP_0040279", "/ontologies/hp/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252FHP_0000005", "/ontologies/hp/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252FHP_0040006", "/ontologies/hp/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252FHP_0000118", "/ontologies/hp/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252FUPHENO_0001002"],
        "go": ["/ontologies/go/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252FGO_0008150", "/ontologies/go/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252FGO_0005575", "/ontologies/go/terms/http%253A%252F%252Fpurl.obolibrary.org%252Fobo%252FGO_0003674"]
      },
      search: "/search"
    };
    this.selectedTerms = [];
    this.selectedTermsFull = [];
  }

  ontologyFilterObserver() {
    this.loadTermsTree();
    this.selectedTerm = {};
    this.listCurrentSelected = [];
    PolymerUtils_PolymerUtils.setValue(this._prefix + "typeahead", "");
    /*if (UtilsNew.isNotEmptyArray(this.selectedTerms)) {
        this.listCurrentSelected = this.selectedTerms.slice();
    }*/

    this.requestUpdate();
  }

  selectTerm(selected) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.fullTerms)) {
      this.selectedTerm = this.fullTerms.find(elem => elem.label === selected.label);
    }

    this.requestUpdate();
  }

  addSelectedTermToList(e) {
    // const selectedTerm = e.target.getAttribute("data-selected-term");
    const selectedTerm = this.selectedTerm;
    const isPresent = this.selectedTerms.find(id => id === selectedTerm.obo_id);

    if (!isPresent) {
      this.selectedTerms.push(selectedTerm.obo_id);
      this.selectedTermsFull.push(selectedTerm);
    }

    this.requestUpdate();
  }

  deleteTermFromList(e) {
    const deletedTermId = e.target.getAttribute("data-selected-term-id");
    const index = this.selectedTerms.indexOf(deletedTermId);

    if (index > -1) {
      this.selectedTerms.splice(index, 1);
      this.selectedTermsFull.splice(index, 1);
      this.selectedTerms = [...this.selectedTerms];
    }

    this.requestUpdate();
  }

  clickOkModal(e) {
    this.dispatchEvent(new CustomEvent("clickOkModal", {
      detail: {
        result: this.selectedTerms,
        resultFull: this.selectedTermsFull
      },
      bubbles: true,
      composed: true
    }));
  }

  searchTerm(query, process) {
    const rowsPerPage = 15;

    const _this = this;

    const queryEncoded = query; // TODO shouldn't this use encodeURIComponent()?

    return fetch(this.ebiConfig.root + this.ebiConfig.search + "?q=*" + queryEncoded + "*&ontology=" + this.ontologyFilter + "&rows=" + rowsPerPage + "&queryFields=label,obo_id").then(response => {
      return response.json().then(json => {
        _this.fullTerms = json.response.docs;
        const arraySearch = [];
        json.response.docs.forEach(elem => {
          arraySearch.push({
            name: elem.label + " - (" + elem.obo_id + ")",
            label: elem.label,
            id: elem.obo_id
          });
        });
        process(arraySearch);
      });
    }).catch(error => {
      console.error(error);
    });
  }

  drawTree(data) {
    const _this = this;

    $(PolymerUtils_PolymerUtils.getElementById(this._prefix + "TermsTree")).treeview({
      data: data,
      onNodeSelected: function onNodeSelected(event, node) {
        _this.selectedTerm = _this.fullTree.find(elem => {
          return elem.label === node.text;
        });

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(_this.selectedTerm)) {
          PolymerUtils_PolymerUtils.setValue(_this._prefix + "typeahead", node.text);

          _this.requestUpdate();
        }
      },
      onNodeUnselected: function onNodeUnselected(event, node) {},
      onNodeExpanded: function onNodeExpanded(event, node) {
        if (utilsNew_UtilsNew.isEmptyArray(node.nodes)) {
          let currentNodeInTree = _this.rootTree[0];
          node.path.forEach(elem => {
            currentNodeInTree = currentNodeInTree.nodes[elem];
          });
          fetch(node.children).then(response => {
            response.json().then(json => {
              json._embedded.terms.forEach(elem => {
                _this.fullTree.push(elem);

                const path = currentNodeInTree.path.slice();
                path.push(currentNodeInTree.nodes.length);
                currentNodeInTree.nodes.push({
                  text: elem.label,
                  selectable: true,
                  iri: elem.iri,
                  has_children: elem.has_children,
                  children: elem.has_children ? elem._links.children.href : "",
                  nodes: elem.has_children ? [] : null,
                  path: path,
                  state: {
                    expanded: false
                  }
                });
              });

              currentNodeInTree.state.expanded = true;

              _this.drawTree(data);
            });
          }).catch(error => {
            console.error("Error fetching Tree data: ", error);
          });
        }
      }
    });
  }

  loadTermsTree() {
    this.rootTree = [{
      text: "All",
      nodes: [],
      selectable: false
    }];
    this.fullTree = [];

    const _this = this;

    const defaultsNodes = this.ebiConfig.tree[this.ontologyFilter];

    if (utilsNew_UtilsNew.isNotEmptyArray(defaultsNodes)) {
      defaultsNodes.forEach(nodeUrl => {
        fetch(this.ebiConfig.root + nodeUrl).then(response => {
          response.json().then(json => {
            console.log(json); //                                json._embedded.terms.forEach((elem) => {

            _this.fullTree.push(json);

            _this.rootTree[0].nodes.push({
              text: json.label,
              selectable: true,
              iri: json.iri,
              has_children: json.has_children,
              children: json.has_children ? json._links.children.href : "",
              nodes: json.has_children ? [] : null,
              path: [_this.rootTree[0].nodes.length],
              state: {
                expanded: false
              }
            }); //                            });


            _this.drawTree(_this.rootTree);
          });
        }).catch(error => {
          console.error("ERROR: ", error);
        });
      });
    }

    return [];
  }

  render() {
    return lit_html_lit_html_html(variant_modal_ontology_templateObject(), this._prefix, this._prefix, this.term, this.term, this._prefix, this.searchTerm, this._prefix, this.selectedTerm ? lit_html_lit_html_html(variant_modal_ontology_templateObject2(), this.selectedTerm.label, this.selectedTerm.short_form, this.selectedTerm.obo_id, this.selectedTerm.iri, this.selectedTerm.description, this.addSelectedTermToList) : null, this.selectedTermsFull && this.selectedTermsFull.length ? this.selectedTermsFull.map(item => lit_html_lit_html_html(variant_modal_ontology_templateObject3(), item.label, item.obo_id, this.deleteTermFromList, item.obo_id)) : null, this._prefix, this.clickOkModal);
  }

}
customElements.define("variant-modal-ontology", variant_modal_ontology_VariantModalOntology);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/cadd-filter.js
function cadd_filter_templateObject() {
  const data = cadd_filter_taggedTemplateLiteral(["\n            <div style=\"padding-top: 10px\">\n                <div class=\"row\">\n                    <div class=\"col-md-5 form-group\" style=\"padding-right: 5px\">\n                        <span class=\"control-label\">Raw</span>\n                    </div>\n                    <div class=\"col-md-3\" style=\"padding: 0px 5px\">\n                        <select name=\"caddRawOperator\" id=\"", "CaddRawOperator\"\n                                class=\"", "FilterSelect form-control input-sm\" style=\"padding: 0px 5px\"\n                                @change=\"", "\">\n                            <option value=\"<\">&lt;</option>\n                            <option value=\"<=\">&le;</option>\n                            <option value=\">\" selected>&gt;</option>\n                            <option value=\">=\">&ge;</option>\n                        </select>\n                    </div>\n                    <div class=\"col-md-4\" style=\"padding-left: 5px\">\n                        <input type=\"number\" value=\"\" class=\"", "FilterTextInput form-control input-sm\"\n                               id=\"", "CaddRawInput\" name=\"caddRaw\" @input=\"", "\">\n                    </div>\n            \n                </div>\n            </div>\n            \n            <div style=\"padding-top: 10px\">\n                <div class=\"row\">\n                    <span class=\"col-md-5 control-label\" style=\"padding-right: 5px\">Scaled</span>\n                    <div class=\"col-md-3\" style=\"padding: 0px 5px\">\n                        <select name=\"caddRScaledOperator\" id=\"", "CaddScaledOperator\"\n                                class=\"", "FilterSelect form-control input-sm\" style=\"padding: 0px 5px\"\n                                @change=\"", "\">\n                            <option value=\"<\" selected>&lt;</option>\n                            <option value=\"<=\">&le;</option>\n                            <option value=\">\">&gt;</option>\n                            <option value=\">=\">&ge;</option>\n                        </select>\n                    </div>\n                    <div class=\"col-md-4\" style=\"padding-left: 5px\">\n                        <input type=\"number\" value=\"\" class=\"", "FilterTextInput form-control input-sm\"\n                               id=\"", "CaddScaledInput\" name=\"caddScaled\" @input=\"", "\">\n                    </div>\n                </div>\n            </div>\n        "]);

  cadd_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function cadd_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */




class cadd_filter_CaddFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      "opencgaSession": {
        type: Object
      },
      "annot-functional-score": {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "caddf-" + utils.randomString(6) + "_";
  }

  updated(_changedProperties) {
    if (_changedProperties.has("annot-functional-score")) {
      if (this["annot-functional-score"]) {
        const fields = this["annot-functional-score"].split(new RegExp("[,;]"));
        const cadd_raw = fields.find(el => el.startsWith("cadd_raw"));

        if (cadd_raw) {
          this.querySelector("#" + this._prefix + "CaddRawInput").value = cadd_raw.split(/[<=>]+/)[1];
          this.querySelector("#" + this._prefix + "CaddRawOperator").value = cadd_raw.split(/[-A-Za-z0-9_]+/)[1];
        } else {
          this.querySelector("#" + this._prefix + "CaddRawInput").value = "";
        }

        const cadd_scaled = fields.find(el => el.startsWith("cadd_scaled"));

        if (cadd_scaled) {
          this.querySelector("#" + this._prefix + "CaddScaledInput").value = cadd_scaled.split(/[<=>]+/)[1];
          this.querySelector("#" + this._prefix + "CaddScaledOperator").value = cadd_scaled.split(/[-A-Za-z0-9_]+/)[1];
        } else {
          this.querySelector("#" + this._prefix + "CaddScaledInput").value = "";
        }
        /*
        for (let i = 0; i < fields.length; i++) {
            let source = fields[i].split(/[<=>]+/)[0];
            switch (source) {
            case "cadd_raw":
                PolymerUtils.setValue(this._prefix + "CaddRawInput", fields[i].split(/[<=>]+/)[1]);
                PolymerUtils.setValue(this._prefix + "CaddRawOperator", fields[i].split(/[-A-Za-z0-9_]+/)[1]);
                break;
            case "cadd_scaled":
                PolymerUtils.setValue(this._prefix + "CaddScaledInput", fields[i].split(/[<=>]+/)[1]);
                PolymerUtils.setValue(this._prefix + "CaddScaledOperator", fields[i].split(/[-A-Za-z0-9_]+/)[1]);
                break;
            }
        }*/

      } else {
        $("." + this._prefix + "FilterTextInput").val("");
        $("." + this._prefix + "FilterTextInput").prop("disabled", false);
      }
    }
  } // TODO refactor


  filterChange(e) {
    const cadd = [];
    const caddRawInput = PolymerUtils_PolymerUtils.getElementById(this._prefix + "CaddRawInput");
    const caddScaledInput = PolymerUtils_PolymerUtils.getElementById(this._prefix + "CaddScaledInput");

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(caddRawInput) && utilsNew_UtilsNew.isNotUndefinedOrNull(caddScaledInput)) {
      if (utilsNew_UtilsNew.isNotEmpty(caddRawInput.value)) {
        cadd.push("cadd_raw" + PolymerUtils_PolymerUtils.getElementById(this._prefix + "CaddRawOperator").value + caddRawInput.value);
      }

      if (utilsNew_UtilsNew.isNotEmpty(caddScaledInput.value)) {
        cadd.push("cadd_scaled" + PolymerUtils_PolymerUtils.getElementById(this._prefix + "CaddScaledOperator").value + caddScaledInput.value);
      }
    }

    console.log("filterChange", cadd && cadd.length ? cadd.join(",") : null);
    const event = new CustomEvent("filterChange", {
      detail: {
        value: cadd && cadd.length ? cadd.join(",") : null
      }
    });
    this.dispatchEvent(event);
  }

  render() {
    return lit_html_lit_html_html(cadd_filter_templateObject(), this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.filterChange);
  }

}
customElements.define("cadd-filter", cadd_filter_CaddFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/biotype-filter.js
function biotype_filter_templateObject2() {
  const data = biotype_filter_taggedTemplateLiteral(["\n                                <option value=\"", "\">", "</option>\n                            "]);

  biotype_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function biotype_filter_templateObject() {
  const data = biotype_filter_taggedTemplateLiteral(["\n            <select class=\"selectpicker\" id=\"", "GeneBiotypes\" data-size=\"10\" data-live-search=\"true\"\n                            data-selected-text-format=\"count\" multiple @change=\"", "\"\n                            >\n                            ", "\n            </select>\n        "]);

  biotype_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function biotype_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


class biotype_filter_BiotypeFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      query: {
        type: Object
      },
      biotypes: {
        type: Array
      },
      biotype: {
        type: Array
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "crf-" + utils.randomString(6) + "_";
    this._config = this.getDefaultConfig();
  }

  getDefaultConfig() {
    return {
      biotypes: ["3prime_overlapping_ncrna", "IG_C_gene", "IG_C_pseudogene", "IG_D_gene", "IG_J_gene", "IG_J_pseudogene", "IG_V_gene", "IG_V_pseudogene", "Mt_rRNA", "Mt_tRNA", "TR_C_gene", "TR_D_gene", "TR_J_gene", "TR_J_pseudogene", "TR_V_gene", "TR_V_pseudogene", "antisense", "lincRNA", "miRNA", "misc_RNA", "non_stop_decay", "nonsense_mediated_decay", "polymorphic_pseudogene", "processed_pseudogene", "processed_transcript", "protein_coding", "pseudogene", "rRNA", "retained_intron", "sense_intronic", "sense_overlapping", "snRNA", "snoRNA", "transcribed_processed_pseudogene", "transcribed_unprocessed_pseudogene", "translated_processed_pseudogene", "unitary_pseudogene", "unprocessed_pseudogene"]
    };
  }

  firstUpdated(_changedProperties) {
    $("#" + this._prefix + "GeneBiotypes").selectpicker("val", []);
  }

  updated(_changedProperties) {
    if (_changedProperties.has("biotype")) {
      if (this.biotype) {
        $("#" + this._prefix + "GeneBiotypes").selectpicker("val", this.biotype.split(","));
      } else {
        $("#" + this._prefix + "GeneBiotypes").selectpicker("val", []);
      }
    }
  }

  filterChange(e) {
    const value = $(e.target).val() ? $(e.target).val().join(",") : null;
    const event = new CustomEvent("filterChange", {
      detail: {
        value: value
      }
    });
    this.dispatchEvent(event);
  }

  render() {
    return lit_html_lit_html_html(biotype_filter_templateObject(), this._prefix, this.filterChange, this._config.biotypes.length && this._config.biotypes.map(biotype => lit_html_lit_html_html(biotype_filter_templateObject2(), biotype, biotype)));
  }

}
customElements.define("biotype-filter", biotype_filter_BiotypeFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/region-filter.js
function region_filter_templateObject() {
  const data = region_filter_taggedTemplateLiteral(["\n                    <textarea id=\"", "LocationTextarea\" name=\"location\" \n                        class=\"form-control clearable ", "FilterTextInput\"\n                        rows=\"", "\" placeholder=\"", "\"\n                        .value=\"", "\"\n                        @input=\"", "\"></textarea>\n                "]);

  region_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function region_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function region_filter_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function region_filter_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { region_filter_ownKeys(Object(source), true).forEach(function (key) { region_filter_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { region_filter_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function region_filter_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/*
 * Copyright 2015-2016 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


class region_filter_RegionFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      cellbaseClient: {
        type: Object
      },
      region: {
        type: String
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "crf-" + utils.randomString(6) + "_"; // FIXME in case of region as a prop (with value = this.query.region from variant-filter) in case opencga-active-filter deletes a region filter this component is not updated.
    // A temp solution is to add query as prop and watch for its edits in updated() [this.region as prop is not used anymore].
    // this.region = "";

    this.separator = ",";
    this._config = this.getDefaultConfig();
  }

  firstUpdated(_changedProperties) {
    this._config = region_filter_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  updated(_changedProperties) {// "this.region" are automatically reflected on the template, we don't needto watch it

    /*if (_changedProperties.has("region")) {
        if (this.region) {
            this.querySelector("#" + this._prefix + "LocationTextarea").value = this.region;
        } else {
            this.querySelector("#" + this._prefix + "LocationTextarea").value = "";
        }
    }*/
  }

  filterChange(e) {
    // Process the textarea: remove newline chars, empty chars, leading/trailing commas
    const _region = e.target.value.trim().replace(/\r?\n/g, this.separator).replace(/\s/g, "").split(this.separator).filter(_ => _).join(this.separator);

    const event = new CustomEvent("filterChange", {
      detail: {
        value: _region
      },
      bubbles: true,
      composed: true
    });
    this.dispatchEvent(event);
  }

  getDefaultConfig() {
    return {
      rows: 3,
      placeholder: "3:444-55555,1:1-100000"
    };
  }

  render() {
    return lit_html_lit_html_html(region_filter_templateObject(), this._prefix, this._prefix, this._config.rows, this._config.placeholder, this.region || "", e => this.filterChange(e));
  }

}
customElements.define("region-filter", region_filter_RegionFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/clinvar-accessions-filter.js
function clinvar_accessions_filter_templateObject() {
  const data = clinvar_accessions_filter_taggedTemplateLiteral(["<textarea id=\"", "ClinVarTextarea\" class=\"form-control clearable ", "FilterTextInput\" rows=\"3\" name=\"clinvar\" placeholder=\"", "\" @keyup=\"", "\"></textarea>"]);

  clinvar_accessions_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function clinvar_accessions_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */




class clinvar_accessions_filter_ClinvarAccessionsFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      placeholder: {
        type: String
      },
      clinvar: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "cvaf-" + utils.randomString(6) + "_";
    this.placeholder = "RCV000058226";
  }

  updated(_changedProperties) {
    if (_changedProperties.has("clinvar")) {
      this.querySelector("#" + this._prefix + "ClinVarTextarea").value = this.clinvar || "";
    }
  }

  filterChange(e) {
    let _clinvar;

    const inputTextArea = PolymerUtils_PolymerUtils.getElementById(this._prefix + "ClinVarTextarea");

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(inputTextArea) && utilsNew_UtilsNew.isNotEmpty(inputTextArea.value)) {
      _clinvar = inputTextArea.value.trim();
      _clinvar = _clinvar.replace(/\r?\n/g, ",").replace(/\s/g, "");
    }

    console.log("filterChange", _clinvar);
    const event = new CustomEvent("filterChange", {
      detail: {
        value: _clinvar || null
      }
    });
    this.dispatchEvent(event);
  }

  render() {
    return lit_html_lit_html_html(clinvar_accessions_filter_templateObject(), this._prefix, this._prefix, this.placeholder, this.filterChange);
  }

}
customElements.define("clinvar-accessions-filter", clinvar_accessions_filter_ClinvarAccessionsFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/cohort-filter.js
function cohort_filter_templateObject4() {
  const data = cohort_filter_taggedTemplateLiteral(["\n            <span>Project not found</span>\n        "]);

  cohort_filter_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function cohort_filter_templateObject3() {
  const data = cohort_filter_taggedTemplateLiteral(["\n                            <div class=\"form-group\" style=\"margin: 5px 0px\">\n                                <span class=\"col-md-4 control-label\">", "</span>\n                                <div class=\"col-md-4\" style=\"padding: 0px 10px\">\n                                    <select id=\"", "", "", "CohortOperator\" name=\"", "Operator\"\n                                            class=\"form-control input-sm ", "FilterSelect\" style=\"padding: 0px 5px\" @change=\"", "\">\n                                        <option value=\"<\" selected>&lt;</option>\n                                        <option value=\"<=\">&le;</option>\n                                        <option value=\">\">&gt;</option>\n                                        <option value=\">=\">&ge;</option>\n                                    </select>\n                                </div>\n                                <div class=\"col-md-4\" style=\"padding: 0px 10px\">\n                                    <input type=\"text\" value=\"\" class=\"form-control input-sm ", "FilterTextInput\"\n                                           name=\"", "_", "\" id=\"", "", "", "Cohort\" @input=\"", "\">\n                                </div>\n                            </div>\n                        "]);

  cohort_filter_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function cohort_filter_templateObject2() {
  const data = cohort_filter_taggedTemplateLiteral(["\n                <div style=\"padding: 5px 0px\">\n                    <div style=\"padding-bottom: 5px\">\n                        <span style=\"font-style: italic\">", "</span> study:\n                    </div>\n                    <div class=\"form-horizontal\">\n                        ", "\n                    </div>\n                </div>"]);

  cohort_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function cohort_filter_templateObject() {
  const data = cohort_filter_taggedTemplateLiteral(["\n            ", "\n        "]);

  cohort_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function cohort_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



 // TODO Refactor needed it needs updated() [never saw how does it looks in IVA]

class cohort_filter_CohortFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      cohorts: {
        type: Object
      },
      config: {
        type: Object
      },
      cohortStatsAlt: {
        type: String
      },
      // TODO temp fix (should it be defined from config in component itself?)
      _cohorts: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "cf-" + utils.randomString(6) + "_";
  }

  connectedCallback() {
    super.connectedCallback();
    this.cohortsPerStudy = this.cohorts ? this.cohorts[this.opencgaSession.project.id] : null;
  }

  updated(_changedProperties) {
    if (_changedProperties.has("cohortStatsAlt")) {
      let cohortArray = []; // reset fields

      $(".".concat(this._prefix, "FilterTextInput"), this).val("");
      $(".".concat(this._prefix, "FilterSelect"), this).val("<");

      if (this.cohortStatsAlt && this.cohortStatsAlt.length) {
        cohortArray = this.cohortStatsAlt.split(new RegExp("[,;]"));

        for (let i = 0; i < cohortArray.length; i++) {
          const [study, cohortFreq] = cohortArray[i].split(":");
          const [cohort, freq] = cohortFreq.split(/[<=>]+/);
          const operator = cohortFreq.split(/[-A-Za-z0-9._:]+/)[1];
          this.querySelector("#" + this._prefix + study + cohort + "Cohort").value = freq;
          this.querySelector("#" + this._prefix + study + cohort + "CohortOperator").value = operator;
        }
      }
    }
  } // TODO refactor!


  filterChange(e) {
    const cohortFreq = [];
    let cohortStatsAlt;
    console.log("this._cohorts", this._cohorts);
    console.log("this.cohorts", this.cohorts);

    if (utilsNew_UtilsNew.isNotEmpty(this._cohorts)) {
      for (let studyId in this._cohorts) {
        for (const cohort of this._cohorts[studyId]) {
          const cohortInput = PolymerUtils_PolymerUtils.getElementById(this._prefix + studyId + cohort.id + "Cohort");
          let operator = PolymerUtils_PolymerUtils.getElementById(this._prefix + studyId + cohort.id + "CohortOperator");

          if (cohortInput !== null && utilsNew_UtilsNew.isNotEmpty(cohortInput.value)) {
            operator = operator.value; // FIXME to be removed!!

            if (studyId === "BRIDGE") {
              studyId = "bridge";
            }

            const pf = studyId + ":" + cohort.id + operator + cohortInput.value;
            cohortFreq.push(pf);
          }
        }
      }
    }

    if (cohortFreq.length > 0) {
      // _filters["cohortStatsMaf"] = cohortFreq.join(';');
      cohortStatsAlt = cohortFreq.join(";");
    }

    const event = new CustomEvent("filterChange", {
      detail: {
        value: cohortStatsAlt ? cohortStatsAlt : null
      }
    });
    this.dispatchEvent(event);
  }

  render() {
    return this.cohortsPerStudy ? lit_html_lit_html_html(cohort_filter_templateObject(), Object.keys(this.cohortsPerStudy).map(study => lit_html_lit_html_html(cohort_filter_templateObject2(), study, this.cohortsPerStudy[study] && this.cohortsPerStudy[study].map(cohort => lit_html_lit_html_html(cohort_filter_templateObject3(), cohort.name, this._prefix, study, cohort.id, cohort.id, this._prefix, this.filterChange, this._prefix, study, cohort.id, this._prefix, study, cohort.id, this.filterChange))))) : lit_html_lit_html_html(cohort_filter_templateObject4());
  }

}
customElements.define("cohort-filter", cohort_filter_CohortFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/consequence-type-filter.js
function consequence_type_filter_templateObject5() {
  const data = consequence_type_filter_taggedTemplateLiteral(["\n                                    <input id=\"", "", "Checkbox\" type=\"checkbox\"\n                                        data-id=\"", "\" class=\"soTermCheckBox ", "FilterCheckBox\" @change=\"", "\" ?checked=\"", "\">\n                                    <label for=\"", "", "Checkbox\" style=\"text-decoration-color: ", "\">\n                                        <span title=\"", "\">\n                                            ", "\n                                        </span>\n                                    </label>\n                                    (<a href=\"http://www.sequenceontology.org/browser/current_svn/term/", "\" target=\"_blank\">", "</a>)\n                                "]);

  consequence_type_filter_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function consequence_type_filter_templateObject4() {
  const data = consequence_type_filter_taggedTemplateLiteral(["\n                                    <li class=\"form-check\">\n                                        <input id=\"", "", "Checkbox\" type=\"checkbox\" data-id=\"", "\"\n                                                   class=\"soTermCheckBox ", "FilterCheckBox\" @change=\"", "\" ?checked=\"", "\">\n                                        <label for=\"", "", "Checkbox\" class=\"form-check-label notbold\" style=\"text-decoration-color: ", "\">\n                                            <span title=\"", "\">\n                                                ", "\n                                            </span>\n                                        </label>\n                                        (<a href=\"http://www.sequenceontology.org/browser/current_svn/term/", "\" target=\"_blank\">", "</a>)\n                                    </li>\n                                    "]);

  consequence_type_filter_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function consequence_type_filter_templateObject3() {
  const data = consequence_type_filter_taggedTemplateLiteral(["\n                                <input id=\"", "", "Input\" type=\"checkbox\" class=\"", "FilterCheckBox\" data-category=\"", "\" @change=\"", "\">\n                                <label for=\"", "", "Input\" class=\"form-check-label category\">", "</label>\n                                <ul>\n                                    ", "\n                                </ul>\n                                "]);

  consequence_type_filter_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function consequence_type_filter_templateObject2() {
  const data = consequence_type_filter_taggedTemplateLiteral(["\n                        <li id=\"", "\" class=\"form-check\" style=\"margin-top: 10px;\">\n                            ", "\n                            </li>\n                    "]);

  consequence_type_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function consequence_type_filter_templateObject() {
  const data = consequence_type_filter_taggedTemplateLiteral(["\n            <style>\n                .browser-ct-tree-view ul > li > ul label {\n                    font-weight: normal;\n                }\n                consequence-type-filter label:not(.category){\n                    text-decoration: underline;\n                }\n            </style>\n            <button class=\"btn btn-sm\" @click=\"", "\">clear</button>\n            <div style=\"padding-top: 15px\">Loss-of-Function (LoF) terms:</div>\n            <div class=\"form-check\" style=\"margin-top: 5px;\">\n                <div class=\"form-check-label checkbox-container\">\n                    <input id=\"", "LossOfFunctionCheckBox\" type=\"checkbox\" class=\"", "FilterCheckBox\"\n                               style=\"cursor: pointer\" @change=\"", "\"/>\n                    <label for=\"", "LossOfFunctionCheckBox\" class=\"\">LoF terms</label>\n                </div>\n            </div>\n            <div style=\"padding-top: 15px\">Consequence Type terms:</div>\n            <div class=\"browser-ct-tree-view browser-ct-item\">\n                <ul id=\"", "consequenceTypeFilter\" class=\"checkbox-container\">\n                    ", "\n                </ul>\n            </div>\n            </div>\n        "]);

  consequence_type_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function consequence_type_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


 //TODO refactor

class consequence_type_filter_ConsequenceTypeFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      ct: {
        type: String
      }
    };
  }

  _init() {
    this._prefix = "ctf-" + utils.randomString(6) + "_";
    this.selectedCt = [];
    $("select.selectpicker", this).selectpicker("render");
    $('.select.selectpicker', this).on('changed.bs.select', function (e, clickedIndex, isSelected, previousValue) {
      console.log(e, clickedIndex, isSelected, previousValue);
    });
  }

  updated(_changedProperties) {
    if (_changedProperties.has("ct")) {
      if (this.ct) {
        this.selectedCt = this.ct.split(",");
      } else {
        $("input[type=checkbox]", this).prop("checked", false);
      }

      this.requestUpdate();
    }
  }

  filterChange(e) {
    const ct = this.ct ? this.ct : null;
    console.log("filterChange", ct);
    const event = new CustomEvent("filterChange", {
      detail: {
        value: ct
      }
    });
    this.dispatchEvent(event);
  }

  clearSelection() {
    $("input[type=checkbox]", this).prop("checked", false);
    this.ct = "";
    this.filterChange();
  }

  onChange(e) {
    // TODO refactor!
    const lofCheckBox = this.querySelector("#" + this._prefix + "LossOfFunctionCheckBox");
    console.log("e.currentTarget", e.currentTarget.id);

    if (e.currentTarget.id === this._prefix + "LossOfFunctionCheckBox") {
      for (const ct of this.consequenceTypes.lof) {
        const checkbox = this.querySelector("#" + this._prefix + ct + "Checkbox");

        if (checkbox) {
          checkbox.checked = e.currentTarget.checked;
        }
      }
    }

    console.log("currentTarget.dataset.category", e.currentTarget.dataset.category); // Select/Unselect the items from one category

    if (e.currentTarget.dataset.category) {
      $("#" + e.currentTarget.dataset.category + " ul li input").each(function () {
        $(this).prop("checked", e.target.checked);
      });
    }

    const soTerms = [];
    const selected = this.querySelector("#" + this._prefix + "consequenceTypeFilter").querySelectorAll("li input");
    selected.forEach(sel => {
      if (sel.checked && typeof sel.dataset !== "undefined" && typeof sel.dataset.id !== "undefined") {
        soTerms.push(sel.dataset.id);
      } else {
        // If one term from LoF array is not selected we remove LoF check
        const dataId = sel.getAttribute("data-id");

        if (lofCheckBox.checked && utilsNew_UtilsNew.isNotUndefinedOrNull(dataId) && this.consequenceTypes.lof.includes(dataId)) {
          lofCheckBox.checked = false;
        }
      }
    });
    this.ct = soTerms.join(",");
    this.selectedCt = soTerms;
    this.filterChange(); // TODO onSelect an item, this refers to the whole category and to the the title of the category
    // this will be useful to automatially select the category checkbox when all the items in it are selected (useful with saved filters as well)
    // console.log("checked: ", $("input[type=checkbox]", e.target.parentNode.parentNode.parentNode).length)
    // console.log("total: ", $("input[type=checkbox]:checked", e.target.parentNode.parentNode.parentNode).length)
    // console.log("title", e.target.parentNode.parentNode.parentNode.parentNode.id)
  }

  render() {
    return lit_html_lit_html_html(consequence_type_filter_templateObject(), this.clearSelection, this._prefix, this._prefix, this.onChange, this._prefix, this._prefix, this.consequenceTypes.categories && this.consequenceTypes.categories.length && this.consequenceTypes.categories.map(category => lit_html_lit_html_html(consequence_type_filter_templateObject2(), category.title ? category.title : category.name, category.terms && category.terms.length ? lit_html_lit_html_html(consequence_type_filter_templateObject3(), this._prefix, category.title, this._prefix, category.title, this.onChange, this._prefix, category.title, category.title, category.terms.map(item => lit_html_lit_html_html(consequence_type_filter_templateObject4(), this._prefix, item.name, item.name, this._prefix, this.onChange, ~this.selectedCt.indexOf(item.name), this._prefix, item.name, this.consequenceTypes.color[item.impact], item.description, item.name, item.id, item.id))) : lit_html_lit_html_html(consequence_type_filter_templateObject5(), this._prefix, category.name, category.name, this._prefix, this.onChange, ~this.selectedCt.indexOf(category.name), this._prefix, category.name, this.consequenceTypes.color[category.impact], category.description, category.name, category.id, category.id))));
  }

}
customElements.define("consequence-type-filter", consequence_type_filter_ConsequenceTypeFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/conservation-filter.js
function conservation_filter_templateObject() {
  const data = conservation_filter_taggedTemplateLiteral(["\n            <div style=\"padding-top: 10px\">\n                <div class=\"row\">\n                    <span class=\"col-md-5 control-label\" style=\"padding-right: 5px\"> PhyloP</span>\n                    <div class=\"col-md-3\" style=\"padding: 0px 5px\">\n                        <select name=\"phylopOperator\" id=\"", "PhylopOperator\"\n                                class=\"", "FilterSelect form-control input-sm\" style=\"padding: 0px 5px\"\n                                @change=\"", "\">                            \n                            <option value=\"<\">&lt;</option>\n                            <option value=\"<=\">&le;</option>\n                            <option value=\">\" selected>&gt;</option>\n                            <option value=\">=\">&ge;</option>\n                        </select>\n                    </div>\n                    <div class=\"col-md-4\" style=\"padding-left: 5px\">\n                        <input type=\"number\" value=\"\" class=\"", "FilterTextInput form-control input-sm\"\n                               id=\"", "PhylopInput\" name=\"phylop\" @input=\"", "\">\n                    </div>\n                </div>\n            </div>\n            \n            <div style=\"padding-top: 10px\">\n                <div class=\"row\">\n                    <span class=\"col-md-5 control-label\" style=\"padding-right: 5px\">PhastCons</span>\n                    <div class=\"col-md-3\" style=\"padding: 0px 5px\">\n                        <select name=\"phastconsOperator\" id=\"", "PhastconsOperator\"\n                                class=\"", "FilterSelect form-control input-sm\" style=\"padding: 0px 5px\"\n                                @change=\"", "\">                            \n                            <option value=\"<\">&lt;</option>\n                            <option value=\"<=\">&le;</option>\n                            <option value=\">\" selected>&gt;</option>\n                            <option value=\">=\">&ge;</option>\n                        </select>\n                    </div>\n                    <div class=\"col-md-4\" style=\"padding-left: 5px\">\n                        <input type=\"number\" value=\"\" class=\"", "FilterTextInput form-control input-sm\"\n                               id=\"", "PhastconsInput\" name=\"phastCons\" @input=\"", "\">\n                    </div>\n                </div>\n            </div>\n            \n            <div style=\"padding-top: 10px\">\n                <div class=\"row\">\n                    <span class=\"col-md-5 control-label\" style=\"padding-right: 5px\">Gerp</span>\n                    <div class=\"col-md-3\" style=\"padding: 0px 5px\">\n                        <select name=\"gerpOperator\" id=\"", "GerpOperator\"\n                                class=\"", "FilterSelect form-control input-sm\" style=\"padding: 0px 5px\"\n                                @change=\"", "\">\n                            <option value=\"<\">&lt;</option>\n                            <option value=\"<=\">&le;</option>\n                            <option value=\">\" selected>&gt;</option>\n                            <option value=\">=\">&ge;</option>\n                        </select>\n                    </div>\n                    <div class=\"col-md-4\" style=\"padding-left: 5px\">\n                        <input type=\"number\" value=\"\" class=\"", "FilterTextInput form-control input-sm\"\n                               id=\"", "GerpInput\" name=\"gerp\" @input=\"", "\">\n                    </div>\n                </div>\n              \n                <!-- <form style=\"padding-top: 15px\">\n                        <label style=\"font-weight: normal;\">Logical Operator</label>\n                        <input type=\"radio\" name=\"conservation\" id=\"", "conservationOrRadio\" value=\"or\"\n                               class=\"", "FilterRadio\" checked disabled style=\"margin-left: 10px\"\n                               @change=\"", "\"> OR<br>\n                        <input type=\"radio\" name=\"conservation\" id=\"", "conservationAndRadio\" value=\"and\"\n                               class=\"", "FilterRadio\" disabled style=\"margin-left: 102px\" @change=\"", "\"> AND<br>\n                    </form>\n                -->\n   \n                <fieldset class=\"switch-toggle-wrapper\">\n                    <label style=\"font-weight: normal;\">Logical Operator</label>\n                    <div class=\"switch-toggle text-white alert alert-light\">\n                        <input id=\"", "conservationOrRadio\" name=\"conservation\" type=\"radio\" value=\"or\"\n                                   class=\"radio-or ", "FilterRadio\" checked disabled\n                                   @change=\"", "\">\n                            <label for=\"", "conservationOrRadio\"\n                                   class=\"rating-label rating-label-or\">OR</label>\n                        <input id=\"", "conservationAndRadio\" name=\"conservation\" type=\"radio\" value=\"and\"\n                                   class=\"radio-and ", "FilterRadio\" disabled @change=\"", "\">\n                            <label for=\"", "conservationAndRadio\"\n                                   class=\"rating-label rating-label-and\">AND</label>\n                        <a class=\"btn btn-primary ripple btn-small\"></a>\n                    </div>\n                </fieldset>\n            \n            \n                <!-- <div class=\"switch-container\">\n                    <div class=\"rating-toggle-container\">\n                        <label style=\"font-weight: normal;\">Logical Operator</label>\n                        <form class=\"flex-center\">\n                            <input id=\"", "conservationOrRadio\" name=\"conservation\" type=\"radio\" value=\"or\"\n                                   class=\"radio-or ", "FilterRadio\" checked disabled\n                                   @change=\"", "\"/>\n                            <input id=\"", "conservationAndRadio\" name=\"conservation\" type=\"radio\" value=\"and\"\n                                   class=\"radio-and ", "FilterRadio\" disabled @change=\"", "\"/>\n                            <label for=\"", "conservationOrRadio\"\n                                   class=\"rating-label rating-label-or\">OR</label>\n                            <div class=\"rating-toggle\"></div>\n                            <div class=\"toggle-rating-pill\"></div>\n                            <label for=\"", "conservationAndRadio\"\n                                   class=\"rating-label rating-label-and\">AND</label>\n                        </form>\n                    </div>\n                </div> -->\n            </div>\n        "]);

  conservation_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function conservation_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



 //import {switchWidget} from "/src/styles/styles.js";

class conservation_filter_ConservationFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      conservation: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ff-" + utils.randomString(6) + "_";
  }

  updated(_changedProperties) {
    if (_changedProperties.has("conservation")) {
      if (this.conservation) {
        let operator; // TODO create an Util function getOperator(str) to discriminate the operator in a query filter string

        const or = this.conservation.split(",");
        const and = this.conservation.split(";");

        if (or.length >= and.length) {
          operator = "or";
        } else {
          operator = "and";
        }

        const fields = this.conservation.split(new RegExp("[,;]"));

        if (fields && fields.length) {
          const phylop = fields.find(el => el.startsWith("phylop"));

          if (phylop) {
            this.querySelector("#" + this._prefix + "PhylopInput").value = phylop.split(/[<=>]+/)[1];
            this.querySelector("#" + this._prefix + "PhylopOperator").value = phylop.split(/[-A-Za-z0-9]+/)[1];
          } else {
            this.querySelector("#" + this._prefix + "PhylopInput").value = "";
          }

          const phastCons = fields.find(el => el.startsWith("phastCons"));

          if (phastCons) {
            this.querySelector("#" + this._prefix + "PhastconsInput").value = phastCons.split(/[<=>]+/)[1];
            this.querySelector("#" + this._prefix + "PhastconsOperator").value = phastCons.split(/[-A-Za-z0-9]+/)[1];
          } else {
            this.querySelector("#" + this._prefix + "PhastconsInput").value = "";
          }

          const gerp = fields.find(el => el.startsWith("gerp"));

          if (gerp) {
            this.querySelector("#" + this._prefix + "GerpInput").value = gerp.split(/[<=>]+/)[1];
            this.querySelector("#" + this._prefix + "GerpOperator").value = gerp.split(/[-A-Za-z0-9]+/)[1];
          } else {
            this.querySelector("#" + this._prefix + "GerpInput").value = "";
          }

          if (fields.length > 1) {
            $("." + this._prefix + "FilterRadio").prop("disabled", false);
            $("." + this._prefix + "FilterRadio[value=" + operator + "]").prop("checked", true);
          } else {
            $("." + this._prefix + "FilterRadio").prop("disabled", true);
            $("." + this._prefix + "FilterRadio").filter("[value=or]").prop("checked", true);
          }
          /* for (let i = 0; i < fields.length; i++) {
              let source = fields[i].split(/[<=>]+/)[0];
              switch (source) {
              case "phylop":
                  PolymerUtils.setValue(this._prefix + "PhylopInput", fields[i].split(/[<=>]+/)[1]);
                  PolymerUtils.setValue(this._prefix + "PhylopOperator", fields[i].split(/[-A-Za-z0-9]+/)[1]);
                  break;
              case "phastCons":
                  PolymerUtils.setValue(this._prefix + "PhastconsInput", fields[i].split(/[<=>]+/)[1]);
                  PolymerUtils.setValue(this._prefix + "PhastconsOperator", fields[i].split(/[-A-Za-z0-9]+/)[1]);
                  break;
              case "gerp":
                  PolymerUtils.setValue(this._prefix + "GerpInput", fields[i].split(/[<=>]+/)[1]);
                  PolymerUtils.setValue(this._prefix + "GerpOperator", fields[i].split(/[-A-Za-z0-9]+/)[1]);
                  break;
              }
          }*/

        }
      } else {
        //reset all and disable radio button
        $("." + this._prefix + "FilterTextInput").val("");
        $("." + this._prefix + "FilterTextInput").prop("disabled", false);
        $("." + this._prefix + "FilterRadio").prop("disabled", true);
        $("." + this._prefix + "FilterRadio").filter("[value=or]").prop("checked", true);
      }
    }
  } // TODO refactor


  filterChange(e) {
    const arr = {
      "Phylop": "phylop",
      "Phastcons": "phastCons",
      "Gerp": "gerp"
    };
    const conserArr = [];
    let conservation;

    for (const key of Object.keys(arr)) {
      const inputTextArea = PolymerUtils_PolymerUtils.getElementById(this._prefix + key + "Input");

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(inputTextArea) && utilsNew_UtilsNew.isNotEmpty(inputTextArea.value)) {
        const operator = PolymerUtils_PolymerUtils.getElementById(this._prefix + key + "Operator");
        conserArr.push(arr[key] + operator.value + inputTextArea.value);
      }
    } // Disable OR/AND logical operator


    if (conserArr.length > 1) {
      $("input:radio[name=conservation]").attr("disabled", false);
    } else {
      $("input:radio[name=conservation]").attr("disabled", true);
    }

    if (conserArr.length > 0) {
      const filter = $("input:radio[name=conservation]:checked").val();

      if (filter === "and") {
        conservation = conserArr.join(";");
      } else {
        conservation = conserArr.join(",");
      }
    }

    const event = new CustomEvent("filterChange", {
      detail: {
        value: conservation ? conservation : null
      }
    });
    this.dispatchEvent(event);
  }

  render() {
    return lit_html_lit_html_html(conservation_filter_templateObject(), this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix);
  }

}
customElements.define("conservation-filter", conservation_filter_ConservationFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/disease-filter.js
function disease_filter_templateObject2() {
  const data = disease_filter_taggedTemplateLiteral(["\n                        <option value=\"", "\">\n                            ", "\n                            ", "\n                            ( ", ")\n                        </option>\n                    "]);

  disease_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function disease_filter_templateObject() {
  const data = disease_filter_taggedTemplateLiteral(["\n            <div>\n                <select id=\"", "DiseasePanels\" class=\"selectpicker\" data-size=\"10\" data-live-search=\"true\" data-selected-text-format=\"count\" multiple @change=\"", "\">\n                    ", "\n                </select>\n                <textarea id=\"", "DiseasePanelsTextarea\" class=\"form-control\" rows=\"4\" style=\"margin-top: 5px;background: #f7f7f7\" disabled> </textarea>\n            </div>\n        "]);

  disease_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function disease_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


 // TODO proper functionality check

class disease_filter_DiseaseFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      // panels: {
      //     type: Array
      // },
      config: {
        type: Object
      },
      panel: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ff-" + utils.randomString(6) + "_";
    this._panel = [];
  }

  firstUpdated(_changedProperties) {
    $("select#".concat(this._prefix, "DiseasePanels")).selectpicker("render");
    $("select#".concat(this._prefix, "DiseasePanels")).selectpicker({
      iconBase: "fa",
      tickIcon: "fa-check"
    });
  }

  updated(_changedProperties) {
    if (_changedProperties.has("panel")) {
      if (this.panel) {
        this._panel = this.panel.split(",");
      } else {
        this._panel = [];
      }

      $("select#".concat(this._prefix, "DiseasePanels")).selectpicker("val", this._panel);
      this.showPanelGenes(this._panel);
    }
  }

  showPanelGenes(panels) {
    PolymerUtils_PolymerUtils.getElementById(this._prefix + "DiseasePanelsTextarea").value = "";

    const _this = this;

    if (panels && panels.length) {
      this.opencgaSession.opencgaClient.panels().info(panels.join(","), {
        study: _this.opencgaSession.study.fqn,
        include: "id,name,genes.id,genes.name,regions.id"
      }).then(function (response) {
        let text = "";

        for (const panelResponse of response.response) {
          const panel = panelResponse.result[0];
          const geneNames = panel.genes.map(gene => gene.name);
          const regions = panel.regions.map(region => region.id);
          text += "".concat(panel.name, " (").concat(geneNames.length, " genes and ").concat(regions.length, " regions): ").concat(geneNames.join(","), " \n");
          text += "".concat(geneNames.join(","), " \n");
          text += "".concat(regions.join(","), " \n\n");
        }

        PolymerUtils_PolymerUtils.getElementById(_this._prefix + "DiseasePanelsTextarea").value = text;
      }).catch(function (response) {
        console.error(response);
      });
    } else {
      PolymerUtils_PolymerUtils.getElementById(_this._prefix + "DiseasePanelsTextarea").value = "";
    }
  }

  filterChange(e) {
    const select_vals = $("#" + this._prefix + "DiseasePanels").val() || [];
    const value = select_vals && select_vals.length ? select_vals.join(",") : null;
    console.log("FilterChange disease-filter", value);
    this.showPanelGenes(select_vals);
    const event = new CustomEvent("filterChange", {
      detail: {
        value: value // value: panelObjects,
        // toString: panelId

      },
      bubbles: true,
      composed: true
    });
    this.dispatchEvent(event);
  }

  render() {
    return lit_html_lit_html_html(disease_filter_templateObject(), this._prefix, e => this.filterChange(e), this.opencgaSession.study.panels && this.opencgaSession.study.panels.length && this.opencgaSession.study.panels.map(panel => lit_html_lit_html_html(disease_filter_templateObject2(), panel.id, panel.name, panel.source ? "v" + panel.source.version : "", panel.stats ? panel.stats.numberOfGenes + "genes, " + panel.stats.numberOfRegions + "regions" : "0 genes, 0 regions")), this._prefix);
  }

}
customElements.define("disease-filter", disease_filter_DiseaseFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/feature-filter.js
function feature_filter_templateObject2() {
  const data = feature_filter_taggedTemplateLiteral(["<option value=\"", "\">", "</option>"]);

  feature_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function feature_filter_templateObject() {
  const data = feature_filter_taggedTemplateLiteral(["\n            <div class=\"form-group\">\n                <div class=\"input-group\">\n                    <input id=\"", "FeatureIdText\" type=\"text\" class=\"form-control\"\n                                       list=\"", "FeatureDatalist\"\n                                       placeholder=\"Search for Gene Symbols\" value=\"\" @input=\"", "\">\n                    <datalist id=\"", "FeatureDatalist\">\n                                    ", "\n                    </datalist>\n                <div class=\"input-group-addon btn\" @click=\"", "\"> <i class=\"fa fa-plus\"></i> </div>\n                </div>\n            </div>\n  \n            <div class=\"form-group\">\n                <textarea id=\"", "FeatureTextarea\" name=\"geneSnp\"\n                    class=\"form-control clearable ", "FilterTextInput\"\n                    rows=\"3\" placeholder=\"BRCA2,ENSG00000139618,ENST00000544455,rs28897700\"\n                    style=\"margin-top: 5px\" @input=\"", "\">", "</textarea>\n            </div>\n        "]);

  feature_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function feature_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


/*
* TODO handle GENES
* TODO UX improvement: turn textarea in a tag input with autocomplete
* **/

class feature_filter_FeatureFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      cellbaseClient: {
        type: Object
      },
      query: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "feaf-" + utils.randomString(6) + "_";
    this.featureDatalist = []; // TODO check why there are 2 fields in query object..
    // this.featureIds = this.query && this.query.ids || [];

    this.featureIds = [];
    this.separator = ",";
    this.featureTextArea = "";
  }

  updated(_changedProperties) {
    // XRefs, Gene and Variant Ids
    if (_changedProperties.has("query")) {
      if (this.query["xref"]) {
        this.featureTextArea = this.query["xref"];
      } else if (this.query.ids) {
        this.featureTextArea = this.query.ids;
      } else if (this.query.gene) {
        this.featureTextArea = this.query.gene;
      } else {
        // this block covers the case of opencga-active-filters deletes all features filters
        this.featureTextArea = "";
      }

      this.featureIds = this.featureTextArea.split(this.separator).filter(_ => _);
      this.querySelector("#" + this._prefix + "FeatureTextarea").value = this.featureTextArea;
    }
  }

  autocomplete(e) {
    // Only gene symbols are going to be searched and not Ensembl IDs
    const featureId = e.target.value.trim();

    if (featureId && featureId.length >= 3 && !featureId.startsWith("ENS")) {
      this.cellbaseClient.get("feature", "id", featureId.toUpperCase(), "starts_with", {
        limit: 50
      }, {}).then(response => {
        this.featureDatalist = response.response[0].result;
        this.requestUpdate();
      });
    }
  } // TODO it needs a proper input validation..


  addFeatureId(e) {
    // split by comma and filters empty strings
    // let ids = this.featureTextArea.split(",").filter(id => id ? id : false);
    const featureIdText = this.querySelector("#" + this._prefix + "FeatureIdText");
    console.log("addFeatureId", featureIdText.value);

    if (featureIdText.value) {
      if (!~this.featureIds.indexOf(featureIdText.value)) {
        this.featureIds.push(featureIdText.value);
      }

      featureIdText.value = ""; // let featureTextArea = this.querySelector("#" + this._prefix + "FeatureTextarea");

      this.featureTextArea = this.featureIds.join(this.separator); // FIXME the below line shouldn't be necessary!
      // TODO Isolate the issue
      // Step to reproduce: 1. add a value using the select 2. edit manually the textarea 3. add a value from the select.
      // The last one will be in this.featureTextArea and this.featureIds, but the textArea won't reflect the update.

      this.querySelector("#" + this._prefix + "FeatureTextarea").value = this.featureTextArea;
      this.requestUpdate();
      this.filterChange();
    }
  }

  onInput(e) {
    this.featureTextArea = e.target.value;
    this.featureIds = this.featureTextArea.split(this.separator).filter(_ => _);
    this.filterChange();
  }

  filterChange() {
    console.log("this.featureTextArea", this.featureTextArea, "this.featureIds", this.featureIds);
    let xref; // let featureTextArea = this.querySelector("#" + this._prefix + "FeatureTextarea");
    // console.log("featureTextArea selector", featureTextArea)

    if (this.featureTextArea) {
      let features = this.featureTextArea.trim();
      features = features.replace(/\r?\n/g, this.separator).replace(/\s/g, "");
      const featureArray = [];

      for (const feature of features.split(this.separator)) {
        if (feature.startsWith("rs") || feature.split(":").length > 2) {
          featureArray.push(feature);
        } else {
          // Genes must be uppercase
          featureArray.push(feature.toUpperCase());
        }
      }

      xref = featureArray.filter(_ => _).join(this.separator);
    }

    const event = new CustomEvent("filterChange", {
      detail: {
        value: xref,
        // xref, ids, gene
        featureIds: this.featureIds
      }
    });
    this.requestUpdate();
    this.dispatchEvent(event);
  }

  render() {
    return lit_html_lit_html_html(feature_filter_templateObject(), this._prefix, this._prefix, this.autocomplete, this._prefix, this.featureDatalist.map(feature => lit_html_lit_html_html(feature_filter_templateObject2(), feature.name, feature.name)), this.addFeatureId, this._prefix, this._prefix, this.onInput, this.featureTextArea);
  }

}
customElements.define("feature-filter", feature_filter_FeatureFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/file-filter.js
function file_filter_templateObject() {
  const data = file_filter_taggedTemplateLiteral(["\n            <div class=\"row\">\n                <div class=\"col-md-12\">\n                    <input id=\"", "FilePassCheckbox\" type=\"checkbox\" class=\"", "FilterCheckBox\" @change=\"", "\" .checked=\"", "\"><span\n                        style=\"padding-left: 5px\">Only include <span style=\"font-weight: bold;\">PASS</span> variants</span>\n                </div>\n                <form class=\"form-horizontal\">\n                    <div class=\"form-group col-md-12\">\n                        <div class=\"col-md-8\">\n                            <input id=\"", "FileQualCheckbox\" type=\"checkbox\"\n                                   class=\"", "FilterCheckBox\" @change=\"", "\" .checked=\"", "\"><span style=\"padding-left: 5px\">Introduce min. <span\n                                style=\"font-weight: bold;\">QUAL</span></span>\n                        </div>\n                        <div class=\"col-md-4\">\n                            <input id=\"", "FileQualInput\" type=\"text\" class=\"form-control input-sm ", "FilterTextInput\" .disabled=\"", "\" value=\"", "\" @change=\"", "\">\n                        </div>\n                    </div>\n                </form>\n            </div>\n        "]);

  file_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function file_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/** @deprecated
 * use file-pass-filter and file-qual-filter instead
* */


class file_filter_FileFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ff-" + utils.randomString(6) + "_";
  }

  updated(_changedProperties) {}

  filterChange() {
    console.warn("split in 2 filter 'qual' and 'filter'");
    const value = "".concat(this.qual ? "qual=".concat(this.qual, ",") : "").concat(this.filter ? "filter=".concat(this.filter) : "");
    console.log("filterChange", value);
    const event = new CustomEvent("filterChange", {
      detail: {
        value: value || null
      }
    });
    this.dispatchEvent(event);
  }

  onChangePass(e) {
    this.filter = e.target.checked ? "PASS" : null;
  }

  onChangeQual(e) {
    this.qual = ">=" + e.target.value;
  }

  onChangeQualCheckBox(e) {
    this.qualEnabled = e.target.checked;
  }

  render() {
    return lit_html_lit_html_html(file_filter_templateObject(), this._prefix, this._prefix, this.onChangePass, this.query.filter === "PASS", this._prefix, this._prefix, this.onChangeQualCheckBox, this.qualEnabled && this.query.qual > 0, this._prefix, this._prefix, this.query.qual > 0, this.query.qual, this.onChangeQual);
  }

}
customElements.define("file-filter", file_filter_FileFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/file-pass-filter.js
function file_pass_filter_templateObject() {
  const data = file_pass_filter_taggedTemplateLiteral(["\n            <div id=\"", "-wrapper\" class=\"subsection-content form-group\">\n                <input id=\"", "FilePassCheckbox\" type=\"checkbox\" class=\"", "FilterCheckBox\" @change=\"", "\" .checked=\"", "\"><span\n                        style=\"padding-left: 5px\">Only include <span style=\"font-weight: bold;\">PASS</span> variants</span>\n            </div>\n        "]);

  file_pass_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function file_pass_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


class file_pass_filter_FilePassFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      filter: {
        type: String
      }
    };
  }

  _init() {
    this._prefix = "fpf-" + utils.randomString(6) + "_";
  }

  updated(_changedProperties) {
    if (_changedProperties.has("filter")) {
      this.querySelector("#" + this._prefix + "FilePassCheckbox").checked = this.filter === "PASS";
    }
  }

  filterChange(e) {
    console.log("filterChange", e.target.checked);
    const event = new CustomEvent("filterChange", {
      detail: {
        value: e.target.checked ? "PASS" : null
      }
    });
    this.dispatchEvent(event);
  }

  render() {
    return lit_html_lit_html_html(file_pass_filter_templateObject(), this._prefix, this._prefix, this._prefix, this.filterChange, this.filter === "PASS");
  }

}
customElements.define("file-pass-filter", file_pass_filter_FilePassFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/file-qual-filter.js
function file_qual_filter_templateObject() {
  const data = file_qual_filter_taggedTemplateLiteral(["\n                <form class=\"form-horizontal subsection-content \">\n                    <div class=\"form-group row\">\n                        <div class=\"col-md-8\">\n                            <input id=\"", "FileQualCheckbox\" type=\"checkbox\"\n                                   class=\"", "FilterCheckBox\" @change=\"", "\" .checked=\"", "\"><span style=\"padding-left: 5px\">Introduce min. <span\n                                style=\"font-weight: bold;\">QUAL</span></span>\n                        </div>\n                        <div class=\"col-md-4\">\n                            <input id=\"", "FileQualInput\" type=\"number\" class=\"form-control input-sm ", "FilterTextInput\" .disabled=\"", "\" @input=\"", "\">\n                        </div>\n                    </div>\n                </form>\n        "]);

  file_qual_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function file_qual_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


class file_qual_filter_FileQualFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      qual: {
        type: String
      }
    };
  }

  _init() {
    this._prefix = "fqf-" + utils.randomString(6) + "_";
    this.qual = "";
  }

  updated(_changedProperties) {
    if (_changedProperties.has("qual")) {
      if (this.qual && this.qual > 0) {
        this.querySelector("#" + this._prefix + "FileQualCheckbox").checked = true;
        this.querySelector("#" + this._prefix + "FileQualInput").value = this.qual;
      } else {
        this.querySelector("#" + this._prefix + "FileQualCheckbox").checked = false;
        this.querySelector("#" + this._prefix + "FileQualInput").value = "";
        this.qualEnabled = false;
        this.requestUpdate();
      }
    }
  } //NOTE filterChange is called both on checkbox and text field


  filterChange(e) {
    let checked = this.querySelector("#" + this._prefix + "FileQualCheckbox").checked;
    let value = this.querySelector("#" + this._prefix + "FileQualInput").value;
    const event = new CustomEvent("filterChange", {
      detail: {
        value: checked && value > 0 ? value : null
      }
    });
    this.dispatchEvent(event);
  }

  onChangeQualCheckBox(e) {
    this.qualEnabled = e.target.checked;
    this.filterChange(e);
    this.requestUpdate();
  }

  render() {
    return lit_html_lit_html_html(file_qual_filter_templateObject(), this._prefix, this._prefix, this.onChangeQualCheckBox, this.qualEnabled, this._prefix, this._prefix, !this.qualEnabled, this.filterChange);
  }

}
customElements.define("file-qual-filter", file_qual_filter_FileQualFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/fulltext-search-accessions-filter.js
function fulltext_search_accessions_filter_templateObject() {
  const data = fulltext_search_accessions_filter_taggedTemplateLiteral(["\n            <textarea id=\"", "TraitsTextarea\" class=\"form-control clearable ", "FilterTextInput\" \n                rows=\"", "\" name=\"traits\" placeholder=\"", "\" @keyup=\"", "\"></textarea>\n        "]);

  fulltext_search_accessions_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function fulltext_search_accessions_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function fulltext_search_accessions_filter_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function fulltext_search_accessions_filter_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { fulltext_search_accessions_filter_ownKeys(Object(source), true).forEach(function (key) { fulltext_search_accessions_filter_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { fulltext_search_accessions_filter_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function fulltext_search_accessions_filter_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



class fulltext_search_accessions_filter_FulltextSearchAccessionsFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      traits: {
        type: String
      },
      // query: {
      //     type: Object
      // },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "fsaf-" + utils.randomString(6) + "_";
    this._config = this.getDefaultConfig();
  }

  firstUpdated(_changedProperties) {
    this._config = fulltext_search_accessions_filter_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  updated(_changedProperties) {
    // if (_changedProperties.has("query")) {
    //     let _traits = this.query && this.query.traits ? this.query.traits : "";
    //     this.querySelector("#" + this._prefix + "TraitsTextarea").value = _traits;
    //     // FIXME The preferred way of updating should be requestUpdate, but for any reason is not working now
    //     // this.requestUpdate();
    //     debugger
    // }
    let _traits = _changedProperties.has("traits") && this.traits ? this.traits : "";

    this.querySelector("#" + this._prefix + "TraitsTextarea").value = _traits; // FIXME The preferred way of updating should be requestUpdate, but for any reason is not working now
    // this.requestUpdate();
  }

  filterChange(e) {
    let traits;
    let inputTextArea = document.getElementById(this._prefix + "TraitsTextarea");

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(inputTextArea) && utilsNew_UtilsNew.isNotEmpty(inputTextArea.value)) {
      traits = inputTextArea.value;
    }

    let event = new CustomEvent('filterChange', {
      detail: {
        value: traits || null
      }
    });
    this.dispatchEvent(event);
  }

  getDefaultConfig() {
    return {
      rows: 5,
      placeholder: "Full-text search, e.g. melanoma"
    };
  }

  render() {
    return lit_html_lit_html_html(fulltext_search_accessions_filter_templateObject(), this._prefix, this._prefix, this._config.rows, this._config.placeholder, this.filterChange);
  }

}
customElements.define("fulltext-search-accessions-filter", fulltext_search_accessions_filter_FulltextSearchAccessionsFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/go-accessions-filter.js
function go_accessions_filter_templateObject() {
  const data = go_accessions_filter_taggedTemplateLiteral(["\n            <style>\n            .geneOntologyMonitor {\n                padding: 10px;\n                font-weight: bold;\n                display: none;\n                text-align: center;\n            }\n\n            .geneOntologyMonitor span {\n                display: block;\n            }\n            \n           \n            </style>\n            <textarea id=\"", "GeneOntologyTextarea\" class=\"form-control clearable ", "FilterTextInput\"\n                                rows=\"3\" name=\"geneOntology\" placeholder=\"GO:0000145\" @input=\"", "\"></textarea>\n            <button class=\"btn btn-primary ripple full-width\" id=\"", "buttonOpenGoAccesions\" @click=\"", "\">\n                <i class=\"fa fa-search\" aria-hidden=\"true\"></i>  Add GO Term\n                \n            </button>\n            <p class=\"bg-warning geneOntologyMonitor\" id=\"", "GeneOntologyMonitor\"></p>\n\n            <variant-modal-ontology _prefix=", "\n                                ontologyFilter=\"", "\"\n                                term=\"", "\"\n                                .selectedTerms=\"", "\"\n                                @clickOkModal=\"", "\">\n            </variant-modal-ontology>\n        "]);

  go_accessions_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function go_accessions_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */




class go_accessions_filter_GoAccessionsFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      go: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "gaf-" + utils.randomString(6) + "_";
    this.selectedTerms = [];
  }

  updated(_changedProperties) {
    if (_changedProperties.has("go")) {
      if (this.go) {
        this.querySelector("#" + this._prefix + "GeneOntologyTextarea").value = this.go;
        const q = this.go.replace(/\r?\n/g, ",").replace(/\s/g, "");
        this.selectedTerms = q.split(",");
      } else {
        this.selectedTerms = [];
        this.querySelector("#" + this._prefix + "GeneOntologyTextarea").value = "";
      }
    }
  }

  filterChange() {
    const inputTextArea = PolymerUtils_PolymerUtils.getElementById(this._prefix + "GeneOntologyTextarea");
    const go_message = this.querySelector("#" + this._prefix + "GeneOntologyMonitor");

    if (inputTextArea && inputTextArea.value) {
      // Process the textarea: remove newline chars, empty chars, leading/trailing commas
      let _go = inputTextArea.value.trim().replace(/\r?\n/g, ",").replace(/\s/g, "").split(",").filter(_ => _); //console.log("_go", _go)
      //console.log("length", _go.length)


      if (_go.length < 100) {
        go_message.innerHTML = "";
        go_message.style.display = "none";
        _go = _go.join(",");
      } else {
        const msg = "".concat(_go.length, " has been selected. Only the first 100 will be taken into account."); // NotificationUtils.showNotify(msg, "WARNING");

        go_message.style.display = "block";
        go_message.innerHTML = "<i class=\"fa fa-exclamation-triangle fa-2x\"></i><span>".concat(msg, "</span>");
        _go = _go.slice(0, 99).join(",");
      }

      console.log("filterChange", _go || null);
      const event = new CustomEvent("filterChange", {
        detail: {
          value: _go || null
        }
      });
      this.dispatchEvent(event);
    }
  }

  onClickOkModal(e) {
    this.selectedTerms = e.detail.result;
    this.querySelector("#" + this._prefix + "GeneOntologyTextarea").value = e.detail.result.join(","); // join by comma no matter the operator (in textarea only)

    this.filterChange();
    $("#" + this._prefix + "ontologyModal").modal("hide");
  }

  onOntologyModalOpen(e) {
    console.log("onOntologyModalOpen variant-filter", e.detail); // modal window from variant-modal-ontology

    this.openHPO = false;
    this.ontologyTerm = "GO";
    this.ontologyFilter = "go";
    this.requestUpdate();
    $("#" + this._prefix + "ontologyModal").modal("show"); // this.openModal = true;
  }

  render() {
    return lit_html_lit_html_html(go_accessions_filter_templateObject(), this._prefix, this._prefix, this.filterChange, this._prefix, this.onOntologyModalOpen, this._prefix, this._prefix, this.ontologyFilter, this.ontologyTerm, this.selectedTerms, this.onClickOkModal);
  }

}
customElements.define("go-accessions-filter", go_accessions_filter_GoAccessionsFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/hpo-accessions-filter.js
function hpo_accessions_filter_templateObject() {
  const data = hpo_accessions_filter_taggedTemplateLiteral(["\n            <textarea id=\"", "HumanPhenotypeOntologyTextarea\"\n                      class=\"form-control clearable ", "FilterTextInput\"\n                      rows=\"3\" name=\"hpo\" placeholder=\"HP:0000001, HP:3000079\" @input=\"", "\"></textarea>\n            <button class=\"btn btn-primary ripple full-width\" id=\"", "buttonOpenHpoAccesions\" @click=\"", "\">\n                <i class=\"fa fa-search searchingButton\" aria-hidden=\"true\"></i>\n                Add HPO Term\n            </button>\n            \n            <fieldset class=\"switch-toggle-wrapper\">\n                    <label style=\"font-weight: normal;\">Logical Operator</label>\n                    <div class=\"switch-toggle text-white alert alert-light\">\n                        <input id=\"", "hpoOrRadio\" name=\"hpoRadio\" type=\"radio\" value=\"or\"\n                                   class=\"radio-or ", "FilterRadio\" checked disabled\n                                   @change=\"", "\">\n                            <label for=\"", "hpoOrRadio\"\n                                   class=\"rating-label rating-label-or\">OR</label>\n                        <input id=\"", "hpoAndRadio\" name=\"hpoRadio\" type=\"radio\" value=\"and\"\n                                   class=\"radio-and ", "FilterRadio\" disabled @change=\"", "\">\n                            <label for=\"", "hpoAndRadio\"\n                                   class=\"rating-label rating-label-and\">AND</label>\n                        <a class=\"btn btn-primary ripple btn-small\"></a>\n                    </div>\n            </fieldset>\n                \n            <variant-modal-ontology _prefix=", "\n                                ontologyFilter=\"", "\"\n                                term=\"", "\"\n                                .selectedTerms=\"", "\"\n                                @clickOkModal=\"", "\">\n            </variant-modal-ontology>\n        "]);

  hpo_accessions_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function hpo_accessions_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


 //TODO FIX in textarea is always used a comma as separator, but in case of loading a saved filter this component could receive a text with semicolon as separator.

class hpo_accessions_filter_HpoAccessionsFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      "opencgaSession": {
        type: Object
      },
      "annot-hpo": {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "hpof-" + utils.randomString(6) + "_";
    this.selectedTerms = [];
  }

  updated(_changedProperties) {
    if (_changedProperties.has("annot-hpo")) {
      if (this["annot-hpo"]) {
        this.querySelector("#" + this._prefix + "HumanPhenotypeOntologyTextarea").value = this["annot-hpo"]; // parse operator

        if (this["annot-hpo"].split(",").length > 2) {
          let operator; // TODO create an Util function getOperator(str) to discriminate the operator in a query filter string

          const or = this["annot-hpo"].split(",");
          const and = this["annot-hpo"].split(";");

          if (or.length >= and.length) {
            operator = "or";
          } else {
            operator = "and";
          }

          $("input:radio[value=" + operator + "]").attr("disabled", false);
          $("input:radio[value=" + operator + "]").checked = true;
          this.selectedTerms = this["annot-hpo"].split(operator);
        } else {
          // disable radio buttons if there are less than 2 values
          $("input:radio").attr("disabled", true);
        }
      } else {
        this.selectedTerms = [];
        this.querySelector("#" + this._prefix + "HumanPhenotypeOntologyTextarea").value = "";
        $("input:radio").attr("disabled", true);
      }
    }
  }

  filterChange(e) {
    let annotHpo;
    const inputTextArea = this.querySelector("#" + this._prefix + "HumanPhenotypeOntologyTextarea");

    if (inputTextArea && inputTextArea.value) {
      const hpoValues = inputTextArea.value.split(",");

      if (utilsNew_UtilsNew.isNotEmptyArray(hpoValues)) {
        $("input:radio[name=hpoRadio]").attr("disabled", false);
        const filter = $("input:radio[name=hpoRadio]:checked").val();

        if (filter === "and") {
          annotHpo = hpoValues.join(";");
        } else {
          annotHpo = hpoValues.join(",");
        }
      }
    }

    console.log("filterChange", annotHpo);
    const event = new CustomEvent("filterChange", {
      detail: {
        value: annotHpo || null
      }
    });
    this.dispatchEvent(event);
  }

  onClickOkModal(e) {
    this.selectedTerms = e.detail.result;
    this.querySelector("#" + this._prefix + "HumanPhenotypeOntologyTextarea").value = e.detail.result.join(","); // join by comma no matter the operator (in textarea only)

    this.filterChange();
    $("#" + this._prefix + "ontologyModal").modal("hide");
  } // from variant-filter


  openModal(e) {
    console.log("onOntologyModalOpen variant-filter", e.detail); // modal window from variant-modal-ontology

    this.openHPO = true;
    this.ontologyTerm = "HPO";
    this.ontologyFilter = "hp";
    this.requestUpdate();
    $("#" + this._prefix + "ontologyModal").modal("show");
  }

  render() {
    return lit_html_lit_html_html(hpo_accessions_filter_templateObject(), this._prefix, this._prefix, this.filterChange, this._prefix, this.openModal, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.ontologyFilter, this.ontologyTerm, this.selectedTerms, this.onClickOkModal);
  }

}
customElements.define("hpo-accessions-filter", hpo_accessions_filter_HpoAccessionsFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/population-frequency-filter.js
function population_frequency_filter_templateObject4() {
  const data = population_frequency_filter_taggedTemplateLiteral(["\n                            <div class=\"form-group\" style=\"margin: 5px 0px\">\n                                <span class=\"col-md-3 control-label\" data-toggle=\"tooltip\" data-placement=\"top\" title=\"", "\">", "</span>\n                                <div class=\"col-md-4\" style=\"padding: 0px 10px\">\n                                    <select id=\"", "", "", "Operator\" name=\"", "Operator\"\n                                            class=\"form-control input-sm ", "FilterSelect\" style=\"padding: 0px 5px\"\n                                            @change=\"", "\">\n                                        <option value=\"<\" selected>&lt;</option>\n                                        <option value=\"<=\">&le;</option>\n                                        <option value=\">\">&gt;</option>\n                                        <option value=\">=\">&ge;</option>\n                                    </select>\n                                </div>\n                                <div class=\"col-md-5\" style=\"padding: 0px 10px\">\n                                    <input id=\"", "", "", "\" type=\"number\"\n                                           class=\"form-control input-sm ", "FilterTextInput\"\n                                           name=\"", "_", "\" @input=\"", "\">\n                                </div>\n                            </div>\n                        "]);

  population_frequency_filter_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function population_frequency_filter_templateObject3() {
  const data = population_frequency_filter_taggedTemplateLiteral(["\n                            <div class=\"form-group\" style=\"margin: 5px 0px\">\n                                <span class=\"col-md-7 control-label\" data-toggle=\"tooltip\" data-placement=\"top\"\n                                      style=\"text-align: left;\">Set all</span>\n                                <div class=\"col-md-5\" style=\"padding: 0px 10px\">\n                                    <input id=\"", "", "Input\" type=\"number\" data-study=\"", "\"\n                                           class=\"form-control input-sm ", "FilterTextInput\"\n                                           name=\"", "Input\" @input=\"", "\">\n                                </div>\n                            </div>\n                        "]);

  population_frequency_filter_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function population_frequency_filter_templateObject2() {
  const data = population_frequency_filter_taggedTemplateLiteral(["\n                <div style=\"padding-top: 10px\">\n                    <i id=\"", "", "Icon\" data-id=\"", "", "\" class=\"fa fa-plus\"\n                       style=\"cursor: pointer;padding-right: 10px\" @click=\"", "\"></i>\n                    <strong>", "</strong>\n                    <div id=\"", "", "\" class=\"form-horizontal\" hidden>\n                        ", "\n                        ", "\n                    </div>\n                </div>\n            "]);

  population_frequency_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function population_frequency_filter_templateObject() {
  const data = population_frequency_filter_taggedTemplateLiteral(["\n            ", "\n        "]);

  population_frequency_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function population_frequency_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


/*
* UX improvement: mouse drag for the numeric fields (e.g. jquery.stepper.js)
*
* */

class population_frequency_filter_PopulationFrequencyFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      populationFrequencies: {
        type: Object
      },
      showSetAll: {
        type: Boolean
      },
      populationFrequencyAlt: {
        type: String
      }
    };
  }

  _init() {
    this._prefix = "pff-" + utils.randomString(6) + "_";
    this.populationFrequenciesQuery = [];
  }

  updated(_changedProperties) {
    let pfArray = [];

    if (this.populationFrequencyAlt) {
      pfArray = this.populationFrequencyAlt.split(new RegExp("[,;]")); // reset and update input fields and select fields
      //$("." + this._prefix + "FilterTextInput").val(""); //it is useless and it causes a bug when you use the set all field
      //$("." + this._prefix + "FilterTextInput").prop("disabled", false);

      if (typeof this.populationFrequencies !== "undefined" && typeof this.populationFrequencies.studies !== "undefined" && this.populationFrequencies.studies.length > 0) {
        pfArray.forEach(queryElm => {
          const popFreq = queryElm.split(/[<=>]+/);
          const [study, population] = popFreq[0].split(":");
          const value = popFreq[1];
          const operator = queryElm.split(/[-A-Za-z0-9._:]+/)[1];
          this.querySelector("#" + this._prefix + study + population).value = value;
          $("#" + this._prefix + study + population + "Operator").val(operator);
        });
      }
    } else {
      // this covers the case of opencga-active-filters deletes all populationFrequencyAlt filters
      $("." + this._prefix + "FilterTextInput").val(""); //$("." + this._prefix + "FilterTextInput").prop("disabled", false);
    }
  }

  filterChange(e) {
    // TODO refactor!
    const popFreq = [];

    if (this.populationFrequencies.studies && this.populationFrequencies.studies.length) {
      this.populationFrequencies.studies.forEach(study => {
        const study_id = study.id;

        if (study.populations && study.populations.length) {
          study.populations.forEach(population => {
            const population_id = population.id;
            const studyTextbox = this.querySelector("#" + this._prefix + study_id + population_id);

            if (studyTextbox && studyTextbox.value) {
              const operator = this.querySelector("#" + this._prefix + study_id + population_id + "Operator");
              const pf = study_id + ":" + population_id + operator.value + studyTextbox.value;
              popFreq.push(pf);
            }
          });
        }
      });
    }

    const event = new CustomEvent("filterChange", {
      detail: {
        value: popFreq ? popFreq.join(";") : null
      }
    });
    this.dispatchEvent(event);
  }

  handleCollapseAction(e) {
    const id = e.target.dataset.id;
    const elem = $("#" + id)[0];
    elem.hidden = !elem.hidden;

    if (elem.hidden) {
      e.target.className = "fa fa-plus";
    } else {
      e.target.className = "fa fa-minus";
    }
  }

  keyUpAllPopFreq(e) {
    const studyId = e.target.getAttribute("data-study");
    const study = this.populationFrequencies.studies.find(study => study.id === studyId);
    study.populations.forEach(popFreq => {
      this.querySelector("#" + this._prefix + studyId + popFreq.id).value = e.target.value;
    });
    this.filterChange();
  }

  render() {
    return lit_html_lit_html_html(population_frequency_filter_templateObject(), this.populationFrequencies.studies && this.populationFrequencies.studies.length && this.populationFrequencies.studies.map(study => lit_html_lit_html_html(population_frequency_filter_templateObject2(), this._prefix, study.id, this._prefix, study.id, this.handleCollapseAction, study.title, this._prefix, study.id, this.showSetAll ? lit_html_lit_html_html(population_frequency_filter_templateObject3(), this._prefix, study.id, study.id, this._prefix, study.id, this.keyUpAllPopFreq) : "", study.populations && study.populations.length && study.populations.map(popFreq => lit_html_lit_html_html(population_frequency_filter_templateObject4(), popFreq.title, popFreq.id, this._prefix, study.id, popFreq.id, popFreq.id, this._prefix, this.filterChange, this._prefix, study.id, popFreq.id, this._prefix, study.id, popFreq.id, this.filterChange)))));
  }

}
customElements.define("population-frequency-filter", population_frequency_filter_PopulationFrequencyFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/protein-substitution-score-filter.js
function protein_substitution_score_filter_templateObject() {
  const data = protein_substitution_score_filter_taggedTemplateLiteral(["\n            <div style=\"padding-top: 10px\">\n                <span style=\"padding-left: 0px;\">SIFT</span>\n                <div class=\"row\">\n                    <div class=\"col-md-5\" style=\"padding-right: 5px\">\n                        <select name=\"Sift\" id=\"", "SiftValues\"\n                                class=\"", "FilterSelect form-control input-sm options\" @change=\"", "\">\n                            <option value=\"score\" selected>Score...</option>\n                            <option value=\"tolerated\">Tolerated</option>\n                            <option value=\"deleterious\">Deleterious</option>\n                        </select>\n                    </div>\n                    <div class=\"col-md-3\" style=\"padding: 0px 5px\">\n                        <select name=\"siftOperator\" id=\"", "SiftOperator\"\n                                class=\"", "FilterSelect form-control input-sm\" style=\"padding: 0px 5px\"\n                                @change=\"", "\">                            \n                            <option value=\"<\">&lt;</option>\n                            <option value=\"<=\">&le;</option>\n                            <option value=\">\" selected>&gt;</option>\n                            <option value=\">=\">&ge;</option>\n                        </select>\n                    </div>\n                    <div class=\"col-md-4\" style=\"padding-left: 5px\">\n                        <input id=\"", "SiftInput\" name=\"Sift\" type=\"number\" value=\"\"\n                               class=\"", "FilterTextInput form-control input-sm\" @input=\"", "\">\n                    </div>\n                </div>\n            </div>\n            \n            <div style=\"padding-top: 15px\">\n                <span style=\"padding-top: 10px;padding-left: 0px;\">Polyphen</span>\n                <div class=\"row\">\n                    <div class=\"col-sm-5\" style=\"padding-right: 5px\">\n                        <select name=\"Polyphen\" id=\"", "PolyphenValues\"\n                                class=\"", "FilterSelect form-control input-sm options\" @change=\"", "\">\n                            <option value=\"score\" selected>Score...</option>\n                            <option value=\"benign\">Benign</option>\n                            <option value=\"unknown\">Unknown</option>\n                            <option value=\"possibly damaging\">Possibly damaging</option>\n                            <option value=\"probably damaging\">Probably damaging</option>\n                            <option value=\"possibly damaging,probably damaging\">Possibly & Probably damaging</option>\n                        </select>\n                    </div>\n                    <div class=\"col-sm-3\" style=\"padding: 0px 5px\">\n                        <select name=\"polyphenOperator\" id=\"", "PolyphenOperator\"\n                                class=\"", "FilterSelect form-control input-sm\" style=\"padding: 0px 5px\"\n                                @change=\"", "\">\n                            <option value=\"<\">&lt;</option>\n                            <option value=\"<=\">&le;</option>\n                            <option value=\">\" selected>&gt;</option>\n                            <option value=\">=\">&ge;</option>\n                        </select>\n                    </div>\n                    <div class=\"col-sm-4\" style=\"padding-left: 5px\">\n                        <input type=\"number\" value=\"\" class=\"", "FilterTextInput form-control input-sm\"\n                               id=\"", "PolyphenInput\" name=\"Polyphen\" @input=\"", "\">\n                    </div>\n                </div>\n                \n                <!-- <div class=\"switch-container\">\n                    <div class=\"rating-toggle-container\">\n                        <label style=\"font-weight: normal;\">Logical Operator</label>\n                        <form class=\"flex-center\">\n                            <input id=\"", "pssOrRadio\" name=\"pss\" type=\"radio\" value=\"or\"\n                                   class=\"radio-or ", "FilterRadio\" checked disabled\n                                   @change=\"", "\"/>\n                            <input id=\"", "pssAndRadio\" name=\"pss\" type=\"radio\" value=\"and\"\n                                   class=\"radio-and ", "FilterRadio\" disabled @change=\"", "\"/>\n                            <label for=\"", "pssOrRadio\"\n                                   class=\"rating-label rating-label-or\">OR</label>\n                            <div class=\"rating-toggle\"></div>\n                            <div class=\"toggle-rating-pill\"></div>\n                            <label for=\"", "pssAndRadio\"\n                                   class=\"rating-label rating-label-and\">AND</label>\n                        </form>\n                    </div>\n                </div> -->\n                \n                <fieldset class=\"switch-toggle-wrapper\">\n                    <label style=\"font-weight: normal;\">Logical Operator</label>\n                    <div class=\"switch-toggle text-white alert alert-light\">\n                        <input id=\"", "pssOrRadio\" name=\"pss\" type=\"radio\" value=\"or\"\n                                   class=\"radio-or ", "FilterRadio\" checked disabled\n                                   @change=\"", "\"/>\n                            <label for=\"", "pssOrRadio\"\n                                   class=\"rating-label rating-label-or\">OR</label>\n                        <input id=\"", "pssAndRadio\" name=\"pss\" type=\"radio\" value=\"and\"\n                                   class=\"radio-and ", "FilterRadio\" disabled @change=\"", "\"/>\n                            <label for=\"", "pssAndRadio\"\n                                   class=\"rating-label rating-label-and\">AND</label>\n                        <a class=\"btn btn-primary ripple btn-small\"></a>\n                    </div>\n                </fieldset>\n                \n                <br>\n            </div>\n            "]);

  protein_substitution_score_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function protein_substitution_score_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */




class protein_substitution_score_filter_ProteinSubstitutionScoreFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      protein_substitution: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "pssf-" + utils.randomString(6) + "_";
  } //TODO proper refactor


  updated(_changedProperties) {
    if (_changedProperties.has("protein_substitution")) {
      if (this.protein_substitution) {
        let pss = this.protein_substitution.split(new RegExp("[,;]"));
        console.log("PSS", pss);

        if (pss.length > 0) {
          let sift = pss.find(el => el.startsWith("sift"));

          if (sift) {
            let value = sift.split("sift")[1];

            if (value.startsWith("<") || value.startsWith(">")) {
              this.querySelector("#" + this._prefix + "SiftInput").value = value.split(/[<=>]+/)[1]; //PolymerUtils.setValue(this._prefix + "SiftInput", value.split(/[<=>]+/)[1]);

              this.querySelector("#" + this._prefix + "SiftOperator").value = value.split(/[-0-9.]+/)[0]; //PolymerUtils.setValue(this._prefix + "SiftOperator", value.split(/[-0-9.]+/)[0]);
            } else {
              //PolymerUtils.setValue(this._prefix + "SiftValues", value.split("==")[1]);
              this.querySelector("#" + this._prefix + "SiftValues").value = value.split("==")[1];
            }

            this.querySelector("#" + this._prefix + "SiftInput").disabled = !(value.startsWith("<") || value.startsWith(">"));
            this.querySelector("#" + this._prefix + "SiftOperator").disabled = !(value.startsWith("<") || value.startsWith(">"));
          } else {
            //PolymerUtils.setValue(this._prefix + "SiftInput", "");
            this.querySelector("#" + this._prefix + "SiftInput").value = "";
          }

          let polyphen = pss.find(el => el.startsWith("polyphen"));

          if (polyphen) {
            let value = polyphen.split("polyphen")[1];

            if (value.startsWith("<") || value.startsWith(">")) {
              this.querySelector("#" + this._prefix + "PolyphenInput").value = value.split(/[<=>]+/)[1];
              this.querySelector("#" + this._prefix + "PolyphenOperator").value = value.split(/[-0-9.]+/)[0];
            } else {
              this.querySelector("#" + this._prefix + "PolyphenValues").value = value.split("==")[1];
            }

            this.querySelector("#" + this._prefix + "PolyphenInput").disabled = !(value.startsWith("<") || value.startsWith(">"));
            this.querySelector("#" + this._prefix + "PolyphenOperator").disabled = !(value.startsWith("<") || value.startsWith(">"));
          } else {
            this.querySelector("#" + this._prefix + "PolyphenInput").value = "";
          }
          /*for (let i = 0; i < pss.length; i++) {
              if (pss[i].startsWith("sift")) {
                  let value = pss[i].split("sift")[1];
                  if (value.startsWith("<") || value.startsWith(">")) {
                      PolymerUtils.setValue(this._prefix + "SiftInput", value.split(/[<=>]+/)[1]);
                      PolymerUtils.setValue(this._prefix + "SiftOperator", value.split(/[-0-9.]+/)[0]);
                  } else {
                      PolymerUtils.setValue(this._prefix + "SiftValues", value.split("==")[1]);
                  }
                  this.querySelector("#" + this._prefix + "SiftInput").disabled = !(value.startsWith("<") || value.startsWith(">"));
                  this.querySelector("#" + this._prefix + "SiftOperator").disabled = !(value.startsWith("<") || value.startsWith(">"));
              } else if (pss[i].startsWith("polyphen")) {
                  let value = pss[i].split("polyphen")[1];
                  if (value.startsWith("<") || value.startsWith(">")) {
                      PolymerUtils.setValue(this._prefix + "PolyphenInput", value.split(/[<=>]+/)[1]);
                      PolymerUtils.setValue(this._prefix + "PolyphenOperator", value.split(/[-0-9.]+/)[0]);
                  } else {
                      PolymerUtils.setValue(this._prefix + "PolyphenValues", value.split("==")[1]);
                  }
                  this.querySelector("#" + this._prefix + "PolyphenInput").disabled = !(value.startsWith("<") || value.startsWith(">"));
                  this.querySelector("#" + this._prefix + "PolyphenOperator").disabled = !(value.startsWith("<") || value.startsWith(">"));
              }
          }*/

        }

        if (pss.length === 2) {
          $("input:radio[name=pss]").attr("disabled", false);

          if (this.protein_substitution.includes(";")) {
            $("input:radio[name=pss][value=and]").prop("checked", true);
          }
        } else {
          $("input:radio[name=pss]").attr("disabled", true);
        }
      } else {
        $("." + this._prefix + "FilterTextInput").val("");
        $("." + this._prefix + "FilterTextInput").prop("disabled", false);
        $("." + this._prefix + "FilterRadio").prop("checked", false);
        $("." + this._prefix + "FilterRadio").filter("[value=or]").prop("checked", true);
        $("." + this._prefix + "FilterRadio").prop("disabled", true);
      }
    }
  }

  checkScore(e) {
    let inputElement = $("#" + this._prefix + e.target.name + "Input");
    let operatorElement = $("#" + this._prefix + e.target.name + "Operator");

    if (e.target.value === "score") {
      inputElement.prop("disabled", false);
      operatorElement.prop("disabled", false);
    } else {
      inputElement.val("");
      operatorElement.val("<");
      inputElement.prop("disabled", true);
      operatorElement.prop("disabled", true);
    }

    this.filterChange();
  } //TODO refactor


  filterChange(e) {
    let pss = [];
    let protein_substitution;
    let numFilters = 0;
    let subsScores = ["Sift", "Polyphen"];
    subsScores.forEach(subsScore => {
      let dropdownValues = PolymerUtils_PolymerUtils.getElementById(this._prefix + subsScore + "Values");
      let textboxInput = PolymerUtils_PolymerUtils.getElementById(this._prefix + subsScore + "Input");
      let operator = PolymerUtils_PolymerUtils.getElementById(this._prefix + subsScore + "Operator");

      if (dropdownValues !== null && dropdownValues.value === "score" && utilsNew_UtilsNew.isNotEmpty(textboxInput.value)) {
        pss.push(subsScore.toLowerCase() + operator.value + textboxInput.value);
        numFilters++;
      } else if (dropdownValues !== null && dropdownValues.value !== "score") {
        pss.push(subsScore.toLowerCase() + "==" + dropdownValues.value);
        numFilters++;
      }
    }); // If both Sift and Polyphen are selected then we activate the AND/OR control

    if (numFilters === 2) {
      $("input:radio[name=pss]").attr("disabled", false);
    } else {
      $("input:radio[name=pss]").attr("disabled", true);
    }

    if (pss.length > 0) {
      let filter = $("input:radio[name=pss]:checked").val();

      if (filter === "and") {
        protein_substitution = pss.join(";");
      } else {
        protein_substitution = pss.join(",");
      }
    }

    console.log("filterChange", protein_substitution);
    let event = new CustomEvent("filterChange", {
      detail: {
        value: protein_substitution
      }
    });
    this.dispatchEvent(event);
  }

  render() {
    return lit_html_lit_html_html(protein_substitution_score_filter_templateObject(), this._prefix, this._prefix, this.checkScore, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.checkScore, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this._prefix, this.filterChange, this._prefix);
  }

}
customElements.define("protein-substitution-score-filter", protein_substitution_score_filter_ProteinSubstitutionScoreFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/opencga-variant-filter-clinical.js
function _templateObject7() {
  const data = opencga_variant_filter_clinical_taggedTemplateLiteral(["\n                <div class=\"col-md-12\" style=\"padding: 10px 20px\">\n                    <div class=\"col-md-2\" style=\"padding: 10px 25px 5px 25px\">\n                        <label>Mode of Inheritance</label>\n                    </div>\n                    <div class=\"col-md-3\">\n                        <select class=\"selectpicker\" id=\"", "ModeOfInheritance\" data-size=\"8\" style=\"font-size: 12px\"\n                                @change=\"", "\">\n                            <option value=\"none\">None</option>\n                            <option value=\"MONOALLELIC\">Autosomal Dominant</option>\n                            <option value=\"BIALLELIC\">Autosomal Recessive</option>\n                            <!--<option value=\"COMPOUND_HETEROZYGOUS\">Compound Heterozygous (AR) </option>-->\n                            <option value=\"XLINKED_MONOALLELIC\">X-linked Dominant</option>\n                            <option value=\"XLINKED_BIALLELIC\">X-linked Recessive</option>\n                            <option value=\"YLINKED\">Y-linked</option>\n                        </select>\n                    </div>\n                    <div class=\"col-md-7\">\n                        <div class=\"alert alert-warning\" role=\"alert\" id=\"", "Warning\" style=\"display: none;padding: 10px\">\n                            <span style=\"font-weight: bold;font-size: 1.20em\">Warning:</span>&nbsp;The selected Mode of Inheritance is not compatible with the family pedigree .\n                        </div>\n                    </div>\n                </div>    \n            "]);

  _templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function _templateObject6() {
  const data = opencga_variant_filter_clinical_taggedTemplateLiteral(["\n                                            <span><i class='fa fa-times' style='color: red'></i></span>"]);

  _templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_variant_filter_clinical_templateObject5() {
  const data = opencga_variant_filter_clinical_taggedTemplateLiteral(["\n                                            <span data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Affected\"><i class='fa fa-check' style='color: green'></i></span>"]);

  opencga_variant_filter_clinical_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_variant_filter_clinical_templateObject4() {
  const data = opencga_variant_filter_clinical_taggedTemplateLiteral(["\n                                            <span><i class='fa fa-times' style='color: red'></i></span>\n                                        "]);

  opencga_variant_filter_clinical_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_variant_filter_clinical_templateObject3() {
  const data = opencga_variant_filter_clinical_taggedTemplateLiteral(["\n                                            <span data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Proband\">\n                                                <i class='fa fa-check' style='color: green'></i>\n                                            </span>"]);

  opencga_variant_filter_clinical_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_variant_filter_clinical_templateObject2() {
  const data = opencga_variant_filter_clinical_taggedTemplateLiteral(["\n                                <tr data-sample=\"", "\">\n                                    <td style=\"vertical-align: middle\">\n                                        <div>\n                                            <span   style=\"", "", "\"\n                                                    data-toggle=\"tooltip\"\n                                                    data-placement=\"bottom\"\n                                                    title=\"\">\n                                                        ", "\n                                                        <i class='fa ", " fa-lg' style='padding-left: 5px'></i>\n                                            </span>\n                                        </div>\n                                    </td>\n                                    <td style=\"padding-left: 20px\">\n                                        ", "\n                                    </td>\n                                    <td style=\"padding-left: 20px\">\n                                        ", "\n                                    </td>\n                                    <td style=\"padding-left: 20px\">\n                                        <span>", "</span>\n                                    </td>\n                                    <td style=\"padding-left: 20px\">\n                                        <span>", "</span>\n                                    </td>\n                                    <td style=\"padding-left: 20px\">\n                                        <input id=\"", "", "00\" type=\"checkbox\" class=\"sample-checkbox\" aria-label=\"...\" data-gt=\"0/0\"\n                                               .checked=\"", "\" @change=\"", "\">\n                                    </td>\n                                    <td style=\"padding-left: 20px\">\n                                        <input id=\"", "", "01\" type=\"checkbox\" class=\"sample-checkbox\" aria-label=\"...\" data-gt=\"0/1\"\n                                               .checked=\"", "\" @change=\"", "\">\n                                    </td>\n                                    <td style=\"padding-left: 20px\">\n                                        <input id=\"", "", "11\" type=\"checkbox\" class=\"sample-checkbox\" aria-label=\"...\" data-gt=\"1/1\"\n                                               .checked=\"", "\" @change=\"", "\">\n                                    </td>\n                                    <td style=\"padding-left: 10px\">\n                                        <input id=\"", "", "DP\" type=\"text\" value=\"", "\"\n                                               class=\"form-control input-sm sample-dp-textbox\" aria-label=\"...\" placeholder=\"e.g. 15\"\n                                               style=\"width: 60px\" @input=\"", "\">\n                                    </td>\n                                </tr>\n                             "]);

  opencga_variant_filter_clinical_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_variant_filter_clinical_templateObject() {
  const data = opencga_variant_filter_clinical_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            #opencga-variant-filter-clinical {\n                font-size: 12px;\n            }\n        </style>\n\n        <div id=\"opencga-variant-filter-clinical\" class=\"row\">\n\n            <div class=\"col-md-12\" style=\"padding: 0px 20px\">\n                <h4>Select Sample Filters</h4>\n                <div style=\"padding: 5px 20px\">\n                    You can select the sample genotypes manually or select a <span style=\"font-weight: bold;margin: 0px\">Mode of Inheritance</span>\n                    in the dropdown below the table, this option is only available for Family analysis. Please, notice that if you want to execute a\n                    <span style=\"font-weight: bold;margin: 0px\">Compound Heterozygous</span> or <span style=\"font-weight: bold;margin: 0px\">de Novo</span>\n                    analysis you can go to the corresponding tools in the analysis toolbar.\n                </div>\n                <div style=\"padding: 0px 20px\">\n                    <table id=\"", "BasicTable\" class=\"table table-hover table-no-bordered\">\n                        <thead>\n                        <tr>\n                            <th rowspan=\"2\">Sample</th>\n                            <th rowspan=\"2\">Proband</th>\n                            <th rowspan=\"2\">Affected</th>\n                            <th rowspan=\"2\">Father</th>\n                            <th rowspan=\"2\">Mother</th>\n                            <th rowspan=\"1\" colspan=\"3\" style=\"text-align: center\">Genotypes</th>\n                            <th rowspan=\"2\">Min. Depth</th>\n                        </tr>\n                        <tr>\n                            <th scope=\"col\" rowspan=\"2\">HOM_REF</th>\n                            <th scope=\"col\" rowspan=\"2\">HET</th>\n                            <th scope=\"col\" rowspan=\"2\">HOM_ALT</th>\n                        </tr>\n                        </thead>\n                        <tbody id=\"", "BasicTBody\">\n                           <!-- renderSampleTable() -->\n                            ", "\n                           \n                           \n                        </tbody>\n                    </table>\n                </div>\n                <div id=\"", "BasicTableMessage\" style=\"text-align: center\"><span style=\"font-weight: bold\">No Samples selected</span></div>\n            </div>\n\n            ", "\n            \n            \n            <div class=\"col-md-12\" style=\"padding: 10px 20px\">\n                <div style=\"padding: 0 25px\">\n                    <label>Other options</label>\n                </div>\n                <div style=\"padding: 5px 30px\">\n                    <input id=\"", "MissingCheckbox\" type=\"checkbox\" @click=\"", "\"><span style=\"padding-left: 5px\">Include parent missing (non-ref) allele calls</span>\n                </div>\n            </div>\n        </div>\n        "]);

  opencga_variant_filter_clinical_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_variant_filter_clinical_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_variant_filter_clinical_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_variant_filter_clinical_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_variant_filter_clinical_ownKeys(Object(source), true).forEach(function (key) { opencga_variant_filter_clinical_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_variant_filter_clinical_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_variant_filter_clinical_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */




class opencga_variant_filter_clinical_OpencgaVariantFilterClinical extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      clinicalAnalysis: {
        type: Object
      },
      query: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ovfc" + utils.randomString(6);
    this.sampleFilters = [];
    this.fileFilters = [];
    this.modeOfInheritance = "none";
    this.showModeOfInheritance = true;
    this._query = {};
  }

  connectedCallback() {
    super.connectedCallback();
    this._config = opencga_variant_filter_clinical_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  updated(changedProperties) {
    if (changedProperties.has("clinicalAnalysis")) {
      this.clinicalAnalysisObserver();
    }

    if (changedProperties.has("query")) {//this.queryObserver();
    }

    if (changedProperties.has("config")) {
      this.configObserver();
    }
  }

  firstUpdated(_changedProperties) {
    // Render the first time after preparing the DOM
    //this.clinicalAnalysisObserver();
    $("select.selectpicker", this).selectpicker("render");
  }

  clinicalAnalysisObserver() {
    console.log("clinicalAnalysisObserver ", this.sampleFilters);

    if (utilsNew_UtilsNew.isUndefinedOrNull(this.clinicalAnalysis)) {
      console.log("clinicalAnalysis is undefined or null: ", this.clinicalAnalysis);
      return;
    }
    /*
     * First, get and render individual options
     * Second, get and render files options
     */
    // We read Individuals from Clinical Analysis


    let individuals = [];

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis.family) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis.family.members)) {
      individuals = this.clinicalAnalysis.family.members;
      this.showModeOfInheritance = true;
    } else {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.proband)) {
        individuals = [this.clinicalAnalysis.proband];
      }

      this.showModeOfInheritance = false;
    } // Set new individuals setting the previous values selected


    if (utilsNew_UtilsNew.isNotEmptyArray(individuals)) {
      // Prepare data to be easier to query
      const _sampleFiltersMap = {};

      if (utilsNew_UtilsNew.isNotEmptyArray(this.sampleFilters)) {
        for (const sampleFilter of this.sampleFilters) {
          _sampleFiltersMap[sampleFilter.id] = sampleFilter;
        }
      } // We iterate the individuals copying the previous values


      const _sampleFilters = [];

      for (const individual of individuals) {
        if (utilsNew_UtilsNew.isNotEmptyArray(individual.samples)) {
          let fatherId = "-"; // If possible we use sample ID

          if (individual.father !== undefined && individual.father.id !== undefined) {
            fatherId = individual.father.id;

            for (const ind of individuals) {
              if (individual.father.id === ind.id) {
                fatherId = utilsNew_UtilsNew.isNotEmptyArray(ind.samples) ? ind.samples[0].id : ind.id;
                break;
              }
            }
          }

          let motherId = "-"; // If possible we use sample ID

          if (individual.mother !== undefined && individual.mother.id !== undefined) {
            motherId = individual.mother.id;

            for (const ind of individuals) {
              if (individual.mother.id === ind.id) {
                motherId = utilsNew_UtilsNew.isNotEmptyArray(ind.samples) ? ind.samples[0].id : ind.id;
                break;
              }
            }
          } // There should be just one sample per individual in the Clinical Analysis


          const sample = individual.samples[0];
          const _sampleFilter = {
            id: sample.id,
            proband: false,
            affected: false,
            sex: individual.sex,
            // father: (individual.father !== undefined && individual.father.id !== undefined) ? individual.father.id : "-",
            // mother: (individual.mother !== undefined && individual.mother.id !== undefined) ? individual.mother.id : "-",
            father: fatherId,
            mother: motherId,
            genotypes: utilsNew_UtilsNew.isNotUndefinedOrNull(_sampleFiltersMap[sample.id]) ? _sampleFiltersMap[sample.id].genotypes : this._config.defaultGenotypes,
            dp: utilsNew_UtilsNew.isNotUndefinedOrNull(_sampleFiltersMap[sample.id]) ? _sampleFiltersMap[sample.id].dp : ""
          };

          if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis.proband) && individual.id === this.clinicalAnalysis.proband.id) {
            _sampleFilter.proband = true;
          }

          if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis.disorder) && utilsNew_UtilsNew.isNotEmptyArray(individual.disorders)) {
            for (const disorder of individual.disorders) {
              if (disorder.id === this.clinicalAnalysis.disorder.id) {
                _sampleFilter.affected = true;
              }
            }
          }

          _sampleFilters.push(_sampleFilter);
        }
      }

      this.sampleFilters = _sampleFilters;
    } else {
      // There is an event and no individuals have been found
      this.sampleFilters = [];
    } // this.renderSampleTable();


    this.sampleFilters = $.extend([], this.sampleFilters); //this.requestUpdate();

    this.sampleFiltersChange();
  }
  /**
   * This function can not add or remove samples or file, this just changes the filters applied, if not present then is left empty.
   * @param query
   */


  queryObserver(query) {
    if (utilsNew_UtilsNew.isEmptyArray(this.sampleFilters) && utilsNew_UtilsNew.isEmptyArray(this.fileFilters)) {
      console.error("this.sampleFilters or this.fileFilters is empty");
      return;
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query)) {
      // Reset all genotypes
      for (const sampleFilter of this.sampleFilters) {
        sampleFilter.genotypes = [];
      }

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query.genotype)) {
        // Assign new passed genotypes to EXISTING samples
        const genotypes = this.query.genotype.split(";");

        for (const genotype of genotypes) {
          const sampleAndGenotype = genotype.split(":");

          for (const sampleFilter of this.sampleFilters) {
            if (sampleFilter.id === sampleAndGenotype[0]) {
              sampleFilter.genotypes = sampleAndGenotype[1].split(",");
              break;
            }
          }
        }

        delete this._query.sample;
      } else {// let _sampleIds = [];
        // for (let sampleFilter of this.sampleFilters) {
        //     _sampleIds.push(sampleFilter.id);
        // }
        // debugger
        // this._query.sample = _sampleIds.join(",");
        // debugger
      }

      this.sampleFilters = $.extend([], this.sampleFilters); //console.error("queryObserver in modal", this.sampleFilters)

      this.requestUpdate();
    }
  }

  sampleFiltersChange() {
    // let compHet = false;
    let missing = this.querySelector("#" + this._prefix + "MissingCheckbox").checked; // File Filters
    // let _qual = undefined;
    // if (UtilsNew.isNotUndefinedOrNull(PolymerUtils.getElementById(this._prefix + "FileFilterQualCheckbox"))
    //     && PolymerUtils.getElementById(this._prefix + "FileFilterQualCheckbox").checked) {
    //     _qual = PolymerUtils.getElementById(this._prefix + "FileFilterQualInput").value;
    // }
    // let _filter = undefined;
    // if (UtilsNew.isNotUndefinedOrNull(PolymerUtils.getElementById(this._prefix + "FileFilterPass"))
    //     && PolymerUtils.getElementById(this._prefix + "FileFilterPass").checked) {
    //     _filter = "PASS";
    // }
    // Notify the sample change

    this.dispatchEvent(new CustomEvent("sampleFiltersChange", {
      detail: {
        sampleFilters: this.sampleFilters,
        modeOfInheritance: this.modeOfInheritance,
        // compoundHeterozygous: compHet,
        missing: missing // fileFilters: this.fileFilters,
        // qual: _qual,
        // filter: _filter

      },
      bubbles: true,
      composed: true
    }));
  }

  onModeOfInheritance(e) {
    this.modeOfInheritance = e.target.value;

    const _this = this;

    this.opencgaSession.opencgaClient.variants().genotypesFamily({
      study: this.opencgaSession.study.fqn,
      family: this.clinicalAnalysis.family.id,
      disorder: this.clinicalAnalysis.disorder.id,
      modeOfInheritance: this.modeOfInheritance,
      completePenetrance: true
    }).then(function (response) {
      const genotypeResults = response.response[0].result[0];

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(genotypeResults)) {
        const individualToSampleMap = {};

        for (const member of _this.clinicalAnalysis.family.members) {
          if (utilsNew_UtilsNew.isNotEmptyArray(member.samples)) {
            individualToSampleMap[member.samples[0].id] = member.id;
          }
        }

        let countGenoypes = 0;

        for (const sampleFilter of _this.sampleFilters) {
          // sampleFilter.genotypes = genotypeResults[sampleFilter.id];
          sampleFilter.genotypes = genotypeResults[individualToSampleMap[sampleFilter.id]];
          console.log("genotypes", sampleFilter.genotypes);
          countGenoypes += sampleFilter.genotypes.length;
        } // _this.renderSampleTable()


        _this.sampleFilters = $.extend([], _this.sampleFilters);

        _this.requestUpdate();

        if (countGenoypes > 0) {
          PolymerUtils_PolymerUtils.hide(_this._prefix + "Warning");
        } else {
          PolymerUtils_PolymerUtils.show(_this._prefix + "Warning");
        }

        _this.sampleFiltersChange();
      }
    }).catch(function (response) {
      console.error(response);
    });
  }

  async onSampleTableChange(e) {
    const table = PolymerUtils_PolymerUtils.getElementById(this._prefix + "BasicTable");
    let counter = 0;

    for (const row of table.rows) {
      if (row.dataset.sample !== undefined) {
        // Set GT values reading columns 5, 6 and 7
        this.sampleFilters[counter].genotypes = [];

        for (let i = 5; i <= 7; i++) {
          if (row.children[i].children[0].checked) {
            this.sampleFilters[counter].genotypes.push(row.children[i].children[0].dataset.gt);
          } else {//console.log("Check", row.children[i].children[0].checked)
          }
        } // Set DP value


        this.sampleFilters[counter].dp = row.children[8].children[0].value;
        counter++;
      }
    }

    this.sampleFilters = $.extend([], this.sampleFilters); //console.log("this.sampleFilters", this.sampleFilters);
    //this.requestUpdate();
    // Set MoI select to 'none' when clicked in GT

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(e.currentTarget.dataset.gt)) {
      this.modeOfInheritance = "none";
      $("#" + this._prefix + "ModeOfInheritance").selectpicker("val", "none");
      PolymerUtils_PolymerUtils.hide(this._prefix + "Warning");
    } //'console.log("this.sampleFilters",this.sampleFilters);


    await this.requestUpdate();
    this.sampleFiltersChange();
  }

  getDefaultConfig() {
    return {
      // defaultGenotypes: ["0/1", "1/1"],
      defaultGenotypes: [],
      sexIConMap: {
        MALE: "fa-mars",
        FEMALE: "fa-venus",
        UNKNOWN: "fa-genderless"
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_variant_filter_clinical_templateObject(), this._prefix, this._prefix, this.sampleFilters && this.sampleFilters.length ? this.sampleFilters.map(sampleFilter => lit_html_lit_html_html(opencga_variant_filter_clinical_templateObject2(), sampleFilter.id, sampleFilter.affected ? "color: darkred;" : "font-weight: normal;", sampleFilter.proband ? "font-weight: bold" : "", sampleFilter.id, this._config.sexIConMap[sampleFilter.sex], sampleFilter.proband ? lit_html_lit_html_html(opencga_variant_filter_clinical_templateObject3()) : lit_html_lit_html_html(opencga_variant_filter_clinical_templateObject4()), sampleFilter.affected ? lit_html_lit_html_html(opencga_variant_filter_clinical_templateObject5()) : lit_html_lit_html_html(_templateObject6()), sampleFilter.father, sampleFilter.mother, this._prefix, sampleFilter.id, sampleFilter.genotypes.includes("0/0"), this.onSampleTableChange, this._prefix, sampleFilter.id, sampleFilter.genotypes.includes("0/1"), this.onSampleTableChange, this._prefix, sampleFilter.id, sampleFilter.genotypes.includes("1/1"), this.onSampleTableChange, this._prefix, sampleFilter.id, sampleFilter.dp !== undefined && sampleFilter.dp > 0 ? sampleFilter.dp : "", this.onSampleTableChange)) : "", this._prefix, this.showModeOfInheritance ? lit_html_lit_html_html(_templateObject7(), this._prefix, this.onModeOfInheritance, this._prefix) : null, this._prefix, this.sampleFiltersChange);
  }

}
customElements.define("opencga-variant-filter-clinical", opencga_variant_filter_clinical_OpencgaVariantFilterClinical);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/sample-filter.js
function sample_filter_templateObject5() {
  const data = sample_filter_taggedTemplateLiteral(["\n                            <tr>\n                                <td>No samples selected</td>\n                                <td></td>\n                            </tr>\n                        "]);

  sample_filter_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function sample_filter_templateObject4() {
  const data = sample_filter_taggedTemplateLiteral(["<span class=\"badge\">", "</span>"]);

  sample_filter_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function sample_filter_templateObject3() {
  const data = sample_filter_taggedTemplateLiteral(["\n                                                <tr data-sample=\"", "\">\n                                                    <td>\n                                                        <span style=\"color: ", "\">", "</span>\n                                                    </td>\n                                                    <td>\n                                                        ", "\n                                                    </td>\n                                                </tr>\n                                        "]);

  sample_filter_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function sample_filter_templateObject2() {
  const data = sample_filter_taggedTemplateLiteral(["\n                            ", "\n                        "]);

  sample_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function sample_filter_templateObject() {
  const data = sample_filter_taggedTemplateLiteral(["\n            <style>\n                .sample-genotype-table .badge {\n                    background-color: #b9b9b9;\n                    margin: 0 4px 0 0;\n                }\n            </style>\n            <div>\n                <div style=\"padding: 10px 0px\">Select Genotype Filter:</div>\n                <div style=\"padding-left: 20px\">\n                    <button id=\"", "SampleFilterModalButton\" type=\"button\" class=\"btn btn-default\" @click=\"", "\">\n                        Sample Filters...\n                    </button>\n                </div>\n            </div>\n            <div style=\"padding: 10px 0px 5px 0px\">\n                <div style=\"padding: 15px 0px;\">\n                    <span>Sample Genotype Summary</span>\n                </div>\n                <table class=\"table sample-genotype-table\" style=\"margin-bottom: 10px\">\n                    <thead>\n                    <tr>\n                        <th scope=\"col\">Sample ID</th>\n                        <th scope=\"col\">GT</th>\n                    </tr>\n                    </thead>\n                    <tbody>\n                        ", "\n                    </tbody>\n                </table>\n            </div>\n            \n            <div class=\"modal fade\" id=\"", "SampleFilterModal\" data-backdrop=\"static\" data-keyboard=\"false\"\n                 tabindex=\"-1\"\n                 role=\"dialog\" aria-hidden=\"true\" style=\"padding-top: 0%; overflow-y: visible\">\n                <div class=\"modal-dialog\" style=\"width: 1280px\">\n                    <div class=\"modal-content\">\n                        <div class=\"modal-header\" style=\"padding: 5px 15px\">\n                            <h3>Sample and File Filters</h3>\n                        </div>\n                        <div class=\"modal-body\">\n                            <opencga-variant-filter-clinical .opencgaSession=\"", "\"\n                                                             .clinicalAnalysis=\"", "\"\n                                                             .query=\"", "\"\n                                                             @sampleFiltersChange=\"", "\">\n                            </opencga-variant-filter-clinical>\n                        </div>\n                        <div class=\"modal-footer\">\n                            <button type=\"button\" class=\"btn btn-primary\" data-dismiss=\"modal\">OK</button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        "]);

  sample_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function sample_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function sample_filter_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function sample_filter_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { sample_filter_ownKeys(Object(source), true).forEach(function (key) { sample_filter_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { sample_filter_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function sample_filter_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */




class sample_filter_SampleFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      enabled: {
        type: Boolean
      },
      clinicalAnalysis: {
        type: Object
      },
      query: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "saf-" + utils.randomString(6) + "_";
    this._query = {}; //this refer and it is used just for the 3 fields of sample-filter (sample, genotype, format)
  }

  updated(changedProperties) {
    if (changedProperties.has("query")) {
      this.queryObserver();
    }
  }

  firstUpdated(_changedProperties) {
    //this.renderClinicalQuerySummary();
    this.updateClinicalQueryTable();
  }
  /*
      filterChange(e) {
          console.log("filterChange", e.target);
          const event = new CustomEvent("filterChange", {
              detail: {
                  sample: e.target.value
  
              }
          });
          this.dispatchEvent(event);
      }
  */


  queryObserver() {
    this.updateClinicalQueryTable(); //this.clinicalFilterQuery = $.extend(true, {}, this.query);  //updates the table opencga-variant-filter-clinical (in the modal)
    //console.warn("query changed", this.query)
    //console.error("renderClinicalQuerySummary is the problem for the not updating sample-filter table after active-filter change")
    //console.log("clinicalFilterQuery", this.clinicalFilterQuery)
    //this.requestUpdate();
  }

  showModal() {
    $("#" + this._prefix + "SampleFilterModal").modal("show");
  } //TODO needs refactor. it comes from variant-filter


  onClinicalFilterChange(e) {
    console.log("sample-filter onClinicalFilterChange", e); //console.warn("onClinicalFilterChange is commented")
    //return;
    // Process Sample filters

    let _genotypeFilters = [];
    let _sampleIds = [];
    let _dpFormatFilter = [];

    for (let sampleFilter of e.detail.sampleFilters) {
      // let color = (sampleFilter.affected) ? "red" : "black";
      let genotypes = sampleFilter.genotypes.length > 0 ? sampleFilter.genotypes.join(",") : "none";
      console.log("genotypes", genotypes);
      let dp = utilsNew_UtilsNew.isNotEmpty(sampleFilter.dp) ? Number(sampleFilter.dp) : -1; //TODO this keeps adding missing gt, if you keep clicking

      if (genotypes !== "none") {
        if (e.detail.missing && !sampleFilter.proband) {
          genotypes += ",./0,./1,./.";
        }

        _genotypeFilters.push(sampleFilter.id + ":" + genotypes);
      }

      if (dp !== -1) {
        _dpFormatFilter.push(sampleFilter.id + ":DP>=" + dp);
      }

      _sampleIds.push(sampleFilter.id);
    } // Process File filters
    // let _files = [];
    // let _qual = e.detail.qual;
    // let _filter = e.detail.filter;
    // for (let fileFilter of e.detail.fileFilters) {
    //     if (fileFilter.selected) {
    //         // _files.push(fileFilter.name);
    //         _files.push(fileFilter.id);
    //     }
    // }
    // Add sample filters to query


    let _query = sample_filter_objectSpread({}, this.query);

    if (_genotypeFilters !== undefined && _genotypeFilters.length > 0) {
      _query.genotype = _genotypeFilters.join(";");
      delete _query.sample;
    } else {
      // debugger
      _query.sample = _sampleIds.join(",");
      delete _query.genotype;
    }

    if (_dpFormatFilter !== undefined && _dpFormatFilter.length > 0) {
      _query.format = _dpFormatFilter.join(";");
    } else {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(_query.format)) {
        delete _query.format;
      }
    } // Add file filters to query
    // if (_files.length > 0) {
    //     _query.file = _files.join(";");
    //     if (UtilsNew.isNotEmpty(_qual)) {
    //         _query.qual = ">=" + _qual;
    //     }
    //     if (UtilsNew.isNotEmpty(_filter)) {
    //         _query.filter = _filter;
    //     }
    //     needUpdateQuery = true;
    // } else {
    //     // If no files are selected we remove all files-related filters
    //     delete _query.file;
    //     delete _query.qual;
    //     delete _query.filter;
    // }
    //Only update query if really needed, this avoids unneeded web refresh


    this.query = sample_filter_objectSpread({}, this.query, {}, _query); //this.renderClinicalQuerySummary();

    this.updateClinicalQueryTable(); //this.requestUpdate();

    this.sampleFilterChange(_query);
  }

  sampleFilterChange(_query) {
    console.log("sampleFilterChange", _query);
    const event = new CustomEvent("sampleFilterChange", {
      detail: {
        value: _query
      }
    });
    this.dispatchEvent(event);
  } // TODO this method has been refactored, the render block has been moved in template. Move the block in more convenient method.
  //renderClinicalQuerySummary() {


  updateClinicalQueryTable() {
    if (this.clinicalAnalysis) {
      // Get Individuals (and samples) from Clinical Analysis
      this.individuals = [];

      if (this.clinicalAnalysis.family && this.clinicalAnalysis.family.members) {
        this.individuals = this.clinicalAnalysis.family.members;
      } else if (this.clinicalAnalysis.proband) {
        this.individuals = this.clinicalAnalysis.proband;
      } // First, render Genotype table


      this.sampleGenotypeMap = {};

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query.genotype)) {
        for (const genotype of this.query.genotype.split(";")) {
          const sampleGt = genotype.split(":");
          this.sampleGenotypeMap[sampleGt[0]] = sampleGt[1].split(",");
        }
      } else {
        if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query.sample)) {
          for (const sample of this.query.sample.split(",")) {
            this.sampleGenotypeMap[sample] = ["0/1", "1/1"];
          }
        }
      } //TODO this cause a bug (variant-filter-clinical table is not updated correctly changing GT), but commenting this line the table in sample-filter is not updated on its end (changing active-filters)
      //this.requestUpdate();

    }
  }

  render() {
    return this.enabled ? lit_html_lit_html_html(sample_filter_templateObject(), this._prefix, this.showModal, this.clinicalAnalysis ? lit_html_lit_html_html(sample_filter_templateObject2(), this.individuals ? this.individuals.map(individual => {
      if (utilsNew_UtilsNew.isNotEmptyArray(individual.samples)) {
        console.log("sampleGenotypeMap", this.sampleGenotypeMap[individual.samples[0].id]); //const genotype = this.sampleGenotypeMap[individual.samples[0].id] ? this.sampleGenotypeMap[individual.samples[0].id].join(", ") : "any";

        return lit_html_lit_html_html(sample_filter_templateObject3(), individual.samples[0].id, this.clinicalAnalysis.proband && individual.id === this.clinicalAnalysis.proband.id ? "darkred" : "black", individual.samples[0].id, this.sampleGenotypeMap[individual.samples[0].id] ? this.sampleGenotypeMap[individual.samples[0].id].map(gt => lit_html_lit_html_html(sample_filter_templateObject4(), gt)) : "any");
      }
    }) : null) : lit_html_lit_html_html(sample_filter_templateObject5()), this._prefix, this.opencgaSession, this.clinicalAnalysis, this.query, this.onClinicalFilterChange) : "";
  }

}
customElements.define("sample-filter", sample_filter_SampleFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/select-field-filter.js
function _templateObject9() {
  const data = select_field_filter_taggedTemplateLiteral(["\n                                    <option>", "</option>\n                            "]);

  _templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function _templateObject8() {
  const data = select_field_filter_taggedTemplateLiteral(["\n                                    <option ?disabled=\"", "\" ?selected=\"", "\" .value=\"", "\">", "</option>\n                                "]);

  _templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function select_field_filter_templateObject7() {
  const data = select_field_filter_taggedTemplateLiteral([" \n                                ", "\n                        "]);

  select_field_filter_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function select_field_filter_templateObject6() {
  const data = select_field_filter_taggedTemplateLiteral(["\n                                    <option>", "</option>\n                                "]);

  select_field_filter_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function select_field_filter_templateObject5() {
  const data = select_field_filter_taggedTemplateLiteral(["\n                                    <option ?disabled=\"", "\" ?selected=\"", "\" .value=\"", "\">", "</option>    \n                                "]);

  select_field_filter_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function select_field_filter_templateObject4() {
  const data = select_field_filter_taggedTemplateLiteral(["\n                                ", "\n                                "]);

  select_field_filter_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function select_field_filter_templateObject3() {
  const data = select_field_filter_taggedTemplateLiteral(["\n                            <optgroup label=\"", "\">", "\n                            </optgroup>\n                            "]);

  select_field_filter_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function select_field_filter_templateObject2() {
  const data = select_field_filter_taggedTemplateLiteral(["\n                        ", "\n                    "]);

  select_field_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function select_field_filter_templateObject() {
  const data = select_field_filter_taggedTemplateLiteral(["\n            <div id=\"", "-select-field-filter-wrapper\" class=\"form-group\">\n                <select id=\"", "-select\"\n                        class=\"selectpicker\"\n                        multiple\n                        .disabled=", "\n                        .required=", "\n                        title=\"", "\"\n                        data-max-options=\"", "\"  \n                        @change=\"", "\" data-width=\"100%\">\n                    ", "\n                </select>\n            </div>\n        "]);

  select_field_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function select_field_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


/** NOTE - Design choice: in case of single mode (this.multiple=false), in order to show the placeholder ("Select an option") and NOT adding a dummy option to allow null selection,
 *  the single selection mode is implemented still with the multiple flag in bootstrap-select, but forcing 1 selection with data-max-options=1
 *  (this has no consequences for the developer point of view)
 */

class select_field_filter_SelectFieldFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      placeholder: {
        type: String
      },
      // NOTE value (default Values) is either a single value as string or a comma separated list (this decision is due to easily manage default values in case of array of objects)
      value: {
        type: String
      },
      multiple: {
        type: Boolean
      },
      disabled: {
        type: Boolean
      },
      maxOptions: {
        type: Number
      },
      required: {
        type: Boolean
      },
      //the expected format is either an array of string or an array of objects {id, name}
      data: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "sff-" + utils.randomString(6) + "_";
    this.multiple = false;
    this.data = [];
  }

  firstUpdated() {
    $(".selectpicker", this).selectpicker("val", "");
  }

  updated(_changedProperties) {
    if (_changedProperties.has("data")) {
      // TODO check why lit-element execute this for all existing select-field-filter instances..wtf
      // console.log("data",this.data)
      $(".selectpicker", this).selectpicker("refresh");
    }

    if (_changedProperties.has("value")) {
      $(".selectpicker", this).selectpicker("val", this.value ? this.multiple ? this.value.split(",") : this.value : "");
    }

    if (_changedProperties.has("disabled")) {
      $(".selectpicker", this).selectpicker("refresh");
    }
  }

  filterChange(e) {
    const selection = $(".selectpicker", this).selectpicker("val");
    let val;

    if (selection && selection.length) {
      val = this.multiple ? selection.join(",") : selection[0];
    }

    this.value = val ? val : null; // this allow users to get the selected values using DOMElement.value

    console.log("select filterChange", val);
    const event = new CustomEvent("filterChange", {
      detail: {
        value: this.value
      }
    });
    this.dispatchEvent(event);
  } // safe check if the field is an object (NOTE null is an object, so the constructor check is not enough)
  // TODO add safe check if is a plain string


  isObject(obj) {
    return obj != null && obj.constructor.name === "Object";
  }

  render() {
    return lit_html_lit_html_html(select_field_filter_templateObject(), this._prefix, this._prefix, this.disabled, this.required, this.placeholder ? this.placeholder : "Select an option", !this.multiple ? 1 : this.maxOptions ? this.maxOptions : false, this.filterChange, this.data.map(opt => lit_html_lit_html_html(select_field_filter_templateObject2(), opt.fields ? lit_html_lit_html_html(select_field_filter_templateObject3(), opt.name, opt.fields.map(subopt => lit_html_lit_html_html(select_field_filter_templateObject4(), this.isObject(subopt) ? lit_html_lit_html_html(select_field_filter_templateObject5(), subopt.disabled, subopt.selected, subopt.id ? subopt.id : subopt.name, subopt.name) : lit_html_lit_html_html(select_field_filter_templateObject6(), subopt)))) : lit_html_lit_html_html(select_field_filter_templateObject7(), this.isObject(opt) ? lit_html_lit_html_html(_templateObject8(), opt.disabled, opt.selected, opt.id ? opt.id : opt.name, opt.name) : lit_html_lit_html_html(_templateObject9(), opt)))));
  }

}
customElements.define("select-field-filter", select_field_filter_SelectFieldFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/study-filter.js
function study_filter_templateObject3() {
  const data = study_filter_taggedTemplateLiteral(["\n                        <option value=\"", "\">", "</option>\n                    "]);

  study_filter_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function study_filter_templateObject2() {
  const data = study_filter_taggedTemplateLiteral(["\n                    <br>\n                    <input id=\"", "", "Checkbox\" type=\"checkbox\" @change=\"", "\" value=\"", "\" data-id=\"", "\" class=\"", "FilterCheckBox\" .checked=\"", "\" >\n                     ", "\n                 "]);

  study_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function study_filter_templateObject() {
  const data = study_filter_taggedTemplateLiteral(["\n           <!-- <select class=\"form-control input-sm ", "FilterSelect\" id=\"", "includeOtherStudy\"\n                    @change=\"", "\">\n                    <option value=\"in\" selected>In all (AND)</option>\n                    <option value=\"atleast\">In any of (OR)</option>\n                </select>\n            \n                <input type=\"checkbox\" value=\"", "\" data-id=\"", "\" checked disabled>\n                <span style=\"font-weight: bold;font-style: italic;color: darkred\">", "</span>\n                ", "\n                \n           --> \n                \n                \n            <div id=\"", "DifferentStudies\" class=\"form-group\">\n                <br>\n                <select multiple class=\"form-control input-sm selectpicker\" id=\"", "includeOtherStudy\"\n                    @change=\"", "\">\n                    <option value=\"", "\" disabled>", "</option>\n                    ", "\n                </select>\n                <fieldset class=\"switch-toggle-wrapper\">\n                    <div class=\"switch-toggle text-white alert alert-light\">\n                        <input id=\"", "orInput\" name=\"pss\" type=\"radio\" value=\",\" checked ?disabled=\"", "\" @change=\"", "\" />\n                        <label for=\"", "orInput\" class=\"rating-label rating-label-or\">In any of (OR)</label>\n                        <input id=\"", "andInput\" name=\"pss\" type=\"radio\" value=\";\" ?disabled=\"", "\" @change=\"", "\"/>\n                        <label for=\"", "andInput\" class=\"rating-label rating-label-and\">In all (AND)</label>\n                        <a class=\"btn btn-primary ripple btn-small\"></a>\n                    </div>\n                </fieldset>\n            </div>\n        "]);

  study_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function study_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


 //TODO continue, bootstrap-select doesn't evaluate as selected a disabled option, but in case of AND/OR operator selected we need both

class study_filter_StudyFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      differentStudies: {
        type: Object
      },
      //part of the query object
      studies: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "sf-" + utils.randomString(6) + "_";
    this.operator = ";";
    this.differentStudies = []; //this._selectStudies = [];

    this._studies = [];
  }

  connectedCallback() {
    super.connectedCallback();
    this.primaryProject = this.opencgaSession.study.fqn; //this._selectStudies = [this.primaryProject];

    this._studies = [this.primaryProject];
  }

  firstUpdated(_changedProperties) {
    $(".selectpicker", this).selectpicker("val", this.opencgaSession.study.fqn);
  }

  updated(_changedProperties) {
    if (_changedProperties.has("differentStudies")) {
      //this._selectStudies = [{id: this.opencgaSession.study.fqn, name: this.opencgaSession.study.name}, ...this.differentStudies.map( _ => ({id: _.fqn, name: _.name}))];
      this.requestUpdate().then(() => $(".selectpicker", this).selectpicker("refresh"));
    }

    if (_changedProperties.has("studies")) {
      this._studies = this.studies ? this.studies.split(new RegExp("[,;]")) : [this.primaryProject];
      $(".selectpicker", this).selectpicker("val", this._studies);
      this.requestUpdate(); // this shouldn't be necessary since this.studies is being updated..
      // this.requestUpdate();
      // NOTE Do NOT fire filterChange in updated(), it would interferes with other filters changes and active-filters
    }
  }

  filterChange() {
    let querystring; // AND or OR operators

    if (this.operator !== "!") {
      querystring = [...this._studies.map(study => "".concat(study))].join(this.operator);
    } else {
      // NOT operator (not visible/not implemented)
      querystring = [...this._studies.map(study => "".concat(this.operator).concat(study))].join(";");
    }

    const event = new CustomEvent("filterChange", {
      detail: {
        value: querystring
      }
    });
    this.dispatchEvent(event); // this.requestUpdate();
  }

  onChangeOperator(e) {
    this.operator = e.target.value;
    this.filterChange();
  }

  onChangeStudy(e) {
    console.log(e);
    console.log($(".selectpicker", this).selectpicker("val"));
    const study = e.target.dataset.id;

    if (e.target.checked) {
      this._studies.push(study);
    } else {
      const indx = this._studies.indexOf(study);

      if (!~indx) {
        console.error("Trying to remove non active study");
      } else {
        this._studies.splice(indx);
      }
    }

    this.filterChange();
  }

  onChangeSelectedStudy(e) {
    const selected = $(".selectpicker", this).selectpicker("val");
    this._studies = [this.primaryProject, ...selected];
    this.requestUpdate();
    this.filterChange();
  }

  render() {
    return lit_html_lit_html_html(study_filter_templateObject(), this._prefix, this._prefix, this.onChangeOperator, this.opencgaSession.study.alias, this.opencgaSession.study.id, this.opencgaSession.study.alias, this.differentStudies && this.differentStudies.length ? this.differentStudies.map(study => lit_html_lit_html_html(study_filter_templateObject2(), this._prefix, study.alias, this.onChangeStudy, study.alias, study.fqn, this._prefix, ~this._studies.indexOf(study.fqn), study.alias)) : null, this._prefix, this._prefix, this.onChangeSelectedStudy, this.opencgaSession.study.fqn, this.opencgaSession.study.name, this.differentStudies && this.differentStudies.length ? this.differentStudies.map(study => lit_html_lit_html_html(study_filter_templateObject3(), study.fqn, study.alias)) : null, this._prefix, this._studies.length < 2, this.onChangeOperator, this._prefix, this._prefix, this._studies.length < 2, this.onChangeOperator, this._prefix);
  }

}
customElements.define("study-filter", study_filter_StudyFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/variant-type-filter.js
function variant_type_filter_templateObject2() {
  const data = variant_type_filter_taggedTemplateLiteral(["\n                    <li>\n                            <input type=\"checkbox\" value=\"", "\" .checked=\"", "\" class=\"", "FilterCheckBox\"/>\n                            <label class=\"checkmark-label\" @click=\"", "\">", "</label>\n                            \n                    </li>\n                "]);

  variant_type_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function variant_type_filter_templateObject() {
  const data = variant_type_filter_taggedTemplateLiteral(["\n            <div id=\"", "Type\">\n             <ul class=\"checkbox-container\">\n                ", "\n             </ul>\n            </div>\n        "]);

  variant_type_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function variant_type_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/*
 * Copyright 2015-2016 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


class variant_type_filter_VariantTypeFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      cellbaseClient: {
        type: Object
      },
      type: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "crf-" + utils.randomString(6) + "_";
    this._config = this.getDefaultConfig();
    this.selectedVariantTypes = [];
    this.requestUpdate();
  }

  updated(_changedProperties) {
    if (_changedProperties.has("type")) {
      if (this.type) {
        this.selectedVariantTypes = this.type.split(",");
      } else {
        this.selectedVariantTypes = [];
      }

      this.requestUpdate();
    }
  }

  filterChange(e) {
    console.log("filterChange", this.selectedVariantTypes.join(",") || null);
    const event = new CustomEvent("filterChange", {
      detail: {
        value: this.selectedVariantTypes.join(",") || null
      }
    });
    this.dispatchEvent(event);
  }

  getDefaultConfig() {
    return {
      types: ["SNV", "INDEL", "CNV", "INSERTION", "DELETION", "MNV"]
    };
  }

  toggle(type) {
    const checkbox = this.querySelector("input[value=".concat(type, "]"));

    if (!~this.selectedVariantTypes.indexOf(type)) {
      this.selectedVariantTypes.push(type);
      checkbox.checked = true;
    } else {
      this.selectedVariantTypes.splice(this.selectedVariantTypes.indexOf(type), 1);
      checkbox.checked = false;
    }

    this.filterChange();
  }

  render() {
    return lit_html_lit_html_html(variant_type_filter_templateObject(), this._prefix, this._config.types && this._config.types.length && this._config.types.map(type => lit_html_lit_html_html(variant_type_filter_templateObject2(), type, ~this.selectedVariantTypes.indexOf(type), this._prefix, _ => this.toggle(type), type)));
  }

}
customElements.define("variant-type-filter", variant_type_filter_VariantTypeFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/opencga-variant-filter.js
function _templateObject25() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["\n            <div class=\"search-button-wrapper\">\n                <button type=\"button\" class=\"btn btn-primary ripple\" @click=\"", "\">\n                    <i class=\"fa fa-search\" aria-hidden=\"true\"></i> ", "\n                </button>\n            </div>\n            "]);

  _templateObject25 = function _templateObject25() {
    return data;
  };

  return data;
}

function _templateObject24() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["\n            <style include=\"jso-styles\">\n            .browser-ct-scroll {\n                /*max-height: 450px;*/\n                /*overflow-y: scroll;*/\n                overflow-x: scroll;\n            }\n\n            .browser-ct-tree-view,\n            .browser-ct-tree-view * {\n                padding: 0;\n                margin: 0;\n                list-style: none;\n            }\n\n            .browser-ct-tree-view li ul {\n                margin: 0 0 0 22px;\n            }\n\n            .browser-ct-tree-view * {\n                vertical-align: middle;\n            }\n\n            .browser-ct-tree-view {\n                /*font-size: 14px;*/\n            }\n\n            .browser-ct-tree-view input[type=\"checkbox\"] {\n                cursor: pointer;\n            }\n\n            .browser-ct-item {\n                white-space: nowrap;\n                display: inline\n            }\n\n            div.block {\n                overflow: hidden;\n            }\n\n            div.block label {\n                width: 80px;\n                display: block;\n                float: left;\n                text-align: left;\n                font-weight: normal;\n            }\n        </style>\n        <div>\n            ", "\n\n            <div class=\"panel-group\" id=\"", "Accordion\" role=\"tablist\" aria-multiselectable=\"true\" style=\"padding-top: 20px\">\n                <div id=\"FilterMenu\">\n                ", "\n                </div>\n            </div>\n        </div>\n        <!--\n        <variant-modal-ontology prefix=", " @propagateok=\"", "\" ontologyFilter=\"", "\" term=\"", "\"\n                                selectedTerms=\"", "\">\n        </variant-modal-ontology>\n        -->\n        "]);

  _templateObject24 = function _templateObject24() {
    return data;
  };

  return data;
}

function _templateObject23() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["\n                    <div class=\"form-group\">\n                        <div class=\"browser-subsection\" id=\"", "\" name=\"", "\">", "\n                            <div class=\"tooltip-div pull-right\">\n                                <a><i class=\"fa fa-info-circle\" aria-hidden=\"true\" id=\"", "", "Tooltip\"></i></a>\n                            </div>\n                        </div>\n                        <div id=\"", "", "\" class=\"subsection-content ", "\">\n                            ", "\n                         </div>\n                    </div>\n                "]);

  _templateObject23 = function _templateObject23() {
    return data;
  };

  return data;
}

function _templateObject22() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<fulltext-search-accessions-filter .traits=\"", "\" @filterChange=\"", "\"></fulltext-search-accessions-filter>"]);

  _templateObject22 = function _templateObject22() {
    return data;
  };

  return data;
}

function _templateObject21() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<clinvar-accessions-filter .clinvar=\"", "\" @filterChange=\"", "\"></clinvar-accessions-filter>"]);

  _templateObject21 = function _templateObject21() {
    return data;
  };

  return data;
}

function _templateObject20() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<hpo-accessions-filter .annot-hpo=\"", "\" @ontologyModalOpen=\"", "\" @filterChange=\"", "\"></hpo-accessions-filter>"]);

  _templateObject20 = function _templateObject20() {
    return data;
  };

  return data;
}

function _templateObject19() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<go-accessions-filter .go=\"", "\" @ontologyModalOpen=\"", "\" @filterChange=\"", "\"></go-accessions-filter>"]);

  _templateObject19 = function _templateObject19() {
    return data;
  };

  return data;
}

function _templateObject18() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<conservation-filter .conservation=\"", "\" @filterChange=\"", "\"></conservation-filter>"]);

  _templateObject18 = function _templateObject18() {
    return data;
  };

  return data;
}

function _templateObject17() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<cadd-filter .annot-functional-score=\"", "\" @filterChange=\"", "\"></cadd-filter>"]);

  _templateObject17 = function _templateObject17() {
    return data;
  };

  return data;
}

function _templateObject16() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<protein-substitution-score-filter .protein_substitution=\"", "\" @filterChange=\"", "\"></protein-substitution-score-filter>"]);

  _templateObject16 = function _templateObject16() {
    return data;
  };

  return data;
}

function _templateObject15() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<consequence-type-filter .consequenceTypes=\"", "\" .ct=\"", "\"  @filterChange=\"", "\"></consequence-type-filter>"]);

  _templateObject15 = function _templateObject15() {
    return data;
  };

  return data;
}

function _templateObject14() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<population-frequency-filter .populationFrequencies=\"", "\" ?showSetAll=\"", "\" .populationFrequencyAlt=\"", "\" @filterChange=\"", "\"></population-frequency-filter>"]);

  _templateObject14 = function _templateObject14() {
    return data;
  };

  return data;
}

function _templateObject13() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<variant-type-filter .config=\"", "\" .type=\"", "\" .cellbaseClient=\"", "\" @filterChange=\"", "\"></variant-type-filter>"]);

  _templateObject13 = function _templateObject13() {
    return data;
  };

  return data;
}

function _templateObject12() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<biotype-filter .config=\"", "\" .biotype=", " @filterChange=\"", "\"></biotype-filter>"]);

  _templateObject12 = function _templateObject12() {
    return data;
  };

  return data;
}

function _templateObject11() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<disease-filter .opencgaSession=\"", "\" .config=\"", "\" .panel=\"", "\" \n                                @filterChange=\"", "\"></disease-filter>"]);

  _templateObject11 = function _templateObject11() {
    return data;
  };

  return data;
}

function _templateObject10() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<feature-filter .cellbaseClient=\"", "\" .query=", "\n                                            @filterChange=\"", "\"></feature-filter>"]);

  _templateObject10 = function _templateObject10() {
    return data;
  };

  return data;
}

function opencga_variant_filter_templateObject9() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<region-filter .cellbaseClient=\"", "\" .region=\"", "\" \n                                           @filterChange=\"", "\"></region-filter>"]);

  opencga_variant_filter_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function opencga_variant_filter_templateObject8() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<file-qual-filter .qual=\"", "\" @filterChange=\"", "\"></file-qual-filter>"]);

  opencga_variant_filter_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_variant_filter_templateObject7() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<file-pass-filter .filter=\"", "\" @filterChange=\"", "\"></file-pass-filter>"]);

  opencga_variant_filter_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_variant_filter_templateObject6() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<file-filter .query=\"", "\" @filterChange=\"", "\"></file-filter>"]);

  opencga_variant_filter_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_variant_filter_templateObject5() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<sample-filter ?enabled=\"", "\" .opencgaSession=\"", "\" .clinicalAnalysis=\"", "\" .query=\"", "\" @sampleFilterChange=\"", "\"></sample-filter>"]);

  opencga_variant_filter_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_variant_filter_templateObject4() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<cohort-filter .opencgaSession=\"", "\" .cohorts=\"", "\" ._cohorts=\"", "\" .cohortStatsAlt=\"", "\" @filterChange=\"", "\"> </cohort-filter>"]);

  opencga_variant_filter_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_variant_filter_templateObject3() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["<study-filter .opencgaSession=\"", "\" .differentStudies=\"", "\" .studies=\"", "\" @filterChange=\"", "\">BLABLA</study-filter>"]);

  opencga_variant_filter_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_variant_filter_templateObject2() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["\n                                    ", "\n                                "]);

  opencga_variant_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_variant_filter_templateObject() {
  const data = opencga_variant_filter_taggedTemplateLiteral(["\n                    <div class=\"panel panel-default filter-section shadow-sm\">\n                        <div class=\"panel-heading\" role=\"tab\" id=\"", "", "Heading\">\n                            <h4 class=\"panel-title\">\n                                <a class=\"collapsed\" role=\"button\" data-toggle=\"collapse\" data-parent=\"#", "Accordion\"\n                                    href=\"#", "", "\" aria-expanded=\"true\" aria-controls=\"", "", "\">\n                                    ", "\n                                </a>\n                            </h4>\n                        </div>\n                        <div id=\"", "", "\" class=\"panel-collapse collapse ", "\" role=\"tabpanel\" aria-labelledby=\"", "", "Heading\">\n                            <div class=\"panel-body\">\n                                <!--TODO verify if cadd condition works-->\n                                \n                                ", "\n                            \n                             </div>\n                        </div>\n                    </div>\n                "]);

  opencga_variant_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_variant_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_variant_filter_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_variant_filter_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_variant_filter_ownKeys(Object(source), true).forEach(function (key) { opencga_variant_filter_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_variant_filter_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_variant_filter_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
























 //TODO complete lit-html refactor

class opencga_variant_filter_OpencgaVariantFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      query: {
        type: Object
      },
      // TODO variant-browser doesn't send this prop..
      clinicalAnalysis: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      config: {
        type: Object
      },
      searchButton: {
        type: Boolean
      } // samples: {
      //     type: Array
      // }

    };
  }

  _init() {
    this._prefix = "ovf".concat(utils.randomString(6), "_");
    this._initialised = false; // this._reset = true;

    if (PANELS) {
      this.panelList = PANELS; //todo check if have to be managed by litelement
    }

    this.query = {}; // NOTE when no query param (or undefined) is passed to this component, this initialization is replaced with undefined value

    this.preparedQuery = {};
    this.modalHpoActive = false;
    this.modalGoActive = false; // this.samples = [];

    this.updateClinicalFilterQuery = true;
    this.searchButton = true;
  }

  connectedCallback() {
    super.connectedCallback(); //Ctrl+Enter to fire the Search
    //TODO FIXME since it relies on keyup/keydown events it will work on input fields only.

    let isCtrl = false;
    $(this).keyup(function (e) {
      if (e.which === 17) {
        isCtrl = false;
      }
    });
    $(this).keydown(function (e) {
      if (e.which === 17) {
        isCtrl = true;
      }

      if (e.which === 13 && isCtrl) {
        this.onSearch();
      }
    });
    this.preparedQuery = opencga_variant_filter_objectSpread({}, this.query); // propagates here the iva-app query object
  } //it was connectedCallback() in polymer 2


  firstUpdated() {
    // Render filter menu and add event and tooltips
    //this now returns html
    //this._renderFilterMenu();
    this._addAllTooltips();

    this._initialised = true;
    this.opencgaSessionObserver(); // this.queryObserver();
    //this.setQueryFilters();
    //this.clinicalObserver();
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession")) {
      this.opencgaSessionObserver();
    }

    if (changedProperties.has("query")) {
      this.queryObserver();
    }

    if (changedProperties.has("clinicalAnalysis")) {
      this.clinicalObserver();
    } // if (changedProperties.has("samples")) {
    //this.samplesObserver();
    // }

  } // static get observers() {
  //     return [
  //         "propertyObserver(opencgaSession, query)"
  //     ];
  // }
  //
  // propertyObserver(opencgaSession, query) {
  //     this.opencgaSessionObserver();
  //     this.queryObserver();
  // }


  opencgaSessionObserver() {
    //TODO do not move in connectedCallback (it handle the switch between default studies)
    if (this.opencgaSession.study) {
      // Update the study list of studies and the selected one
      if (this.opencgaSession.project.studies) {
        this.differentStudies = this.opencgaSession.project.studies.filter(study => this.opencgaSession.study.alias !== study.alias); // Insert study checkboxes HTML, this only happens if the Study subsection has been added

        /* NOTE listener moved in _getStudyHtml()
         PolymerUtils.innerHTML(this._prefix + "study", this._getStudyHtml(this._prefix));
        for (let study of this.differentStudies) {
            let element = PolymerUtils.getElementById(this._prefix + study.alias + "Checkbox");
            if (UtilsNew.isNotUndefinedOrNull(element)) {
                element.addEventListener('change', this.updateQueryFilters.bind(this));
            }
        }*/
      } //TODO should it be moved in cohort-filter?
      // Update cohorts from config, this updates the Cohort filter ALT


      if (typeof this.config !== "undefined" && typeof this.config.sections !== "undefined") {
        this._cohorts = [];

        for (let section of this.config.sections) {
          for (let subsection of section.subsections) {
            if (subsection.id === "cohort") {
              let projectId = this.opencgaSession.project.id;

              if (utilsNew_UtilsNew.isNotUndefinedOrNull(subsection.cohorts[projectId])) {
                for (let study of Object.keys(subsection.cohorts[projectId])) {
                  // Array.prototype.push.apply(this._cohorts, subsection.cohorts[projectId][study]);
                  this._cohorts = subsection.cohorts[projectId];
                }
              }
            }
          }
        }
      } // this.query = {
      //     study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias
      // };
      // this.notifySearch(this.query);
      // Render filter menu and add event and tooltips


      if (this._initialised) {
        this._renderFilterMenu();
      }
    }
  }

  queryObserver() {
    //the following line FIX the "silent" persistence of active filters once 1 is deleted, due to an inconsistence between query and preparedQuery. Step to reproduce:
    // 0. comment the line `this.preparedQuery = this.query;`
    // 1. add some filters from variant=filter
    // 2. delete 1 filter from active-filter
    // 3. add another filter from variant-filter
    // 4. you will see again the deleted filter in active-filters
    this.preparedQuery = this.query || {}; // TODO quick fix in case the component gets an undefined value as prop

    if (this.updateClinicalFilterQuery) {
      this.clinicalFilterQuery = this.query;
    } else {
      this.skipClinicalFilterQueryUpdate = true;
    }

    if (this._reset) {
      //console.trace(this.query)
      this.setQueryFilters();
    } else {
      this._reset = true;
    }

    this.requestUpdate();
  }

  clinicalObserver(clinicalAnalysis) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis)) {// this.clinicalAnalysis = Object.assign({}, clinicalAnalysis);
    }
  }

  onSearch() {
    this.notifySearch(this.preparedQuery);
  } //TODO rename to filterChange


  notifyQuery(query) {
    this.dispatchEvent(new CustomEvent("queryChange", {
      detail: {
        query: query
      },
      bubbles: true,
      composed: true
    }));
  }

  notifySearch(query) {
    this.dispatchEvent(new CustomEvent("querySearch", {
      detail: {
        query: query
      },
      bubbles: true,
      composed: true
    }));
  } //moved on sample-filter

  /*onSampleFilterClick() {
      $("#" + this._prefix + "SampleFilterModal").modal("show");
  }*/
  //TODO moved in sample-filter still not completed

  /*onClinicalFilterChange(e) {
      // Process Sample filters
      let _genotypeFilters = [];
      let _sampleIds = [];
      let _dpFormatFilter = [];
      for (let sampleFilter of e.detail.sampleFilters) {
          // let color = (sampleFilter.affected) ? "red" : "black";
          let genotypes = (sampleFilter.genotypes.length > 0) ? sampleFilter.genotypes.join(",") : "none";
          let dp = (UtilsNew.isNotEmpty(sampleFilter.dp)) ? Number(sampleFilter.dp) : -1;
           if (genotypes !== "none") {
              if (e.detail.missing && !sampleFilter.proband) {
                  genotypes += ",./0,./1,./.";
              }
              _genotypeFilters.push(sampleFilter.id + ":" + genotypes);
          }
          if (dp !== -1) {
              _dpFormatFilter.push(sampleFilter.id + ":DP>=" + dp);
          }
          _sampleIds.push(sampleFilter.id)
      }
       // Process File filters
      // let _files = [];
      // let _qual = e.detail.qual;
      // let _filter = e.detail.filter;
      // for (let fileFilter of e.detail.fileFilters) {
      //     if (fileFilter.selected) {
      //         // _files.push(fileFilter.name);
      //         _files.push(fileFilter.id);
      //     }
      // }
       let needUpdateQuery = false;
      // Add sample filters to query
      let _query = {...this.query};
      if (_genotypeFilters !== undefined && _genotypeFilters.length > 0) {
          _query.genotype = _genotypeFilters.join(";");
          delete _query.sample;
          needUpdateQuery = true;
      } else {
          // debugger
          _query.sample = _sampleIds.join(",");
          delete _query.genotype;
      }
      if (_dpFormatFilter !== undefined && _dpFormatFilter.length > 0) {
          _query.format = _dpFormatFilter.join(";");
          needUpdateQuery = true;
      } else {
          if (UtilsNew.isNotUndefinedOrNull(_query.format)) {
              delete _query.format;
              needUpdateQuery = true;
          }
      }
       // Add file filters to query
      // if (_files.length > 0) {
      //     _query.file = _files.join(";");
      //     if (UtilsNew.isNotEmpty(_qual)) {
      //         _query.qual = ">=" + _qual;
      //     }
      //     if (UtilsNew.isNotEmpty(_filter)) {
      //         _query.filter = _filter;
      //     }
      //     needUpdateQuery = true;
      // } else {
      //     // If no files are selected we remove all files-related filters
      //     delete _query.file;
      //     delete _query.qual;
      //     delete _query.filter;
      // }
       //Only update query if really needed, this avoids unneeded web refresh
      if (needUpdateQuery) {
          this.updateClinicalFilterQuery = false;
          this.preparedQuery = _query;
          this.updateClinicalFilterQuery = true;
      }
       this.notifyQuery(this.preparedQuery);
  }*/

  /*
  //refactored and moved in go-accessions-filter and hpo-accessions-filter
  propagateOkHPO(e) {
      if (this.openHPO) {
          PolymerUtils.setValue(this._prefix + "HumanPhenotypeOntologyTextarea", e.detail.result.join(","));
          this.selectedTermsHPO = e.detail.originalResult;
      } else {
          PolymerUtils.setValue(this._prefix + "GeneOntologyTextarea", e.detail.result.join(","));
          this.selectedTermsGO = e.detail.originalResult;
      }
      $("#ontologyModal").modal("hide");
       this.updateQueryFilters();
  }
  */
  //refactored and moved in go-accessions-filter and hpo-accessions-filter

  /*onOntologyModalOpen(e) {
      console.log("onOntologyModalOpen variant-filter",e.detail);
      //modal window from variant-modal-ontology
      this.openHPO = e.detail.openHPO;
      this.ontologyTerm = e.detail.ontologyTerm;
      this.selectedTermsOntology = e.detail.selectedTermsOntology; //selectedTermsGO and selectedTermsHPO
      this.ontologyFilter = e.detail.ontologyFilter;
      console.log(this.openHPO, this.ontologyTerm);
      this.requestUpdate();
      $("#ontologyModal").modal("show");
  }*/
  //DONE moved in hpo-accession-filter

  /*openModalHpo() {
      this.openHPO = true;
      this.ontologyTerm = "HPO";
      this.selectedTermsOntology = this.selectedTermsHPO;
      this.ontologyFilter = "hp";
      this.openModalOntology();
  }*/
  //DONE moved to go-accessions-filter

  /*openModalGo() {
      this.openHPO = false;
      this.ontologyTerm = "GO";
      this.selectedTermsOntology = this.selectedTermsGO;
      this.ontologyFilter = "go";
      this.openModalOntology();
  }*/
  //DONE moved to population-frequency-filter

  /*handleCollapseAction(e) {
      let id = e.target.dataset.id;
      let elem = $("#" + id)[0];
      elem.hidden = !elem.hidden;
      if (elem.hidden) {
          e.target.className = "fa fa-plus";
      } else {
          e.target.className = "fa fa-minus";
      }
  }
  //DONE moved to population-frequency-filter
  keyUpAllPopFreq(e) {
      let studyId = e.target.getAttribute("data-study");
      let study = this.populationFrequencies.studies.find((study) => {
          return study.id === studyId;
      });
       study.populations.forEach((popFreq) => {
          PolymerUtils.setValue(this._prefix + studyId + popFreq.id, e.target.value);
      });
       this.updateQueryFilters();
  }*/
  //DONE moved to consequence-type-filter

  /*updateConsequenceTypeFilter(e) {
      // Select LoF term checkboxes
      let lofCheckBox = PolymerUtils.getElementById(this._prefix + "LossOfFunctionCheckBox");
      if (e.currentTarget.id === this._prefix + "LossOfFunctionCheckBox") {
          for (let ct of this.consequenceTypes.lof) {
              let checkbox = PolymerUtils.getElementById(this._prefix + ct + "Checkbox");
              if (UtilsNew.isNotUndefinedOrNull(checkbox)) {
                  checkbox.checked = e.currentTarget.checked;
              }
          }
      }
       // Select/Unselect the items from one category
      if (e.target.parentNode.parentNode.id !== "") {
          $("#" + e.target.parentNode.parentNode.id).children("ul").children("li").children("label").children("input").each(function () {
              $(this).prop("checked", e.target.checked);
          });
      }
       let soTerms = [];
      let selected = PolymerUtils.querySelectorAll("li input", this._prefix + "consequenceTypeFilter");
      selected.forEach((sel) => {
          if (sel.checked && typeof sel.dataset !== "undefined" && typeof sel.dataset.id !== "undefined") {
              soTerms.push(sel.dataset.id);
          } else {
              // If one term from LoF array is not selected we remove LoF check
              let dataId = sel.getAttribute("data-id");
              if (lofCheckBox.checked && UtilsNew.isNotUndefinedOrNull(dataId) && this.consequenceTypes.lof.includes(dataId)) {
                  lofCheckBox.checked = false;
              }
          }
      });
       this.ct = soTerms;
      this.updateQueryFilters();
  }*/
  //DONE moved in proteine-substitution-score-filter

  /*checkScore(e) {
      let inputElement = $("#" + this._prefix + e.target.name + "Input");
      let operatorElement = $("#" + this._prefix + e.target.name + "Operator");
      if (e.target.value === "score") {
          inputElement.prop("disabled", false);
          operatorElement.prop("disabled", false);
      } else {
          inputElement.val("");
          operatorElement.val("<");
          inputElement.prop("disabled", true);
          operatorElement.prop("disabled", true);
      }
      this.updateQueryFilters();
  }*/
  //DONE moved in sample-filter

  /*renderClinicalQuerySummary() {
      if (UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis)) {
          // Get Individuals (and samples) from Clinical Analysis
          let individuals = [];
          if (UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis.family) && UtilsNew.isNotEmptyArray(this.clinicalAnalysis.family.members)) {
              individuals = this.clinicalAnalysis.family.members;
          } else {
              if (UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis.proband)) {
                  individuals = this.clinicalAnalysis.proband;
              }
          }
           // First, render Genotype table
          let sampleGenotypeMap = {};
          if (UtilsNew.isNotUndefinedOrNull(this.query.genotype)) {
              for (let genotype of this.query.genotype.split(";")) {
                  let sampleGt = genotype.split(":");
                  sampleGenotypeMap[sampleGt[0]] = sampleGt[1].split(",");
              }
          } else {
              if (UtilsNew.isNotUndefinedOrNull(this.query.sample)) {
                  for (let sample of this.query.sample.split(",")) {
                      sampleGenotypeMap[sample] = ["0/1", "1/1"];
                  }
              }
          }
           // Render Genotype table
          let sampleTableTr = "";
          for (let individual of individuals) {
              if (UtilsNew.isNotEmptyArray(individual.samples)) {
                  let color = (UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis.proband)
                      && individual.id === this.clinicalAnalysis.proband.id)
                      ? "darkred"
                      : "black";
                  let genotype = (UtilsNew.isNotUndefinedOrNull(sampleGenotypeMap[individual.samples[0].id]))
                      ? sampleGenotypeMap[individual.samples[0].id]
                      : "any";
                   sampleTableTr += `
                          <tr data-sample="${individual.samples[0].id}">
                              <td>
                                  <span style="color: ${color}">${individual.samples[0].id}</span>
                              </td>
                              <td>
                                  ${genotype}
                              </td>
                          </tr>
                  `;
              }
          }
           // Set HTML into the table body
          let elementById = PolymerUtils.getElementById(this._prefix + "SampleFiltersSummaryTBody");
          if (UtilsNew.isNotUndefinedOrNull(elementById)) {
              //TODO avoid innerHTML
              elementById.innerHTML = sampleTableTr;
          }
      }
  }*/
  //binding::from this.query to the view
  //most of those blocks have been refactored and moved in firstUpdated() in each filter component


  setQueryFilters() {
    if (!this._initialised) {
      return;
    } // Clear filter menu before rendering


    this._clearHtmlDom(); // Check 'query' is not null or empty there is nothing else to do


    if (utilsNew_UtilsNew.isUndefinedOrNull(this.preparedQuery) || Object.keys(this.preparedQuery).length === 0) {
      console.warn("this.preparedQuery is NULL:", this.preparedQuery);
      return;
    } // Render Clinical filters: sample and file
    //this.renderClinicalQuerySummary();
    // implemented in study-filter

    /*
    if (typeof this.query.studies !== "undefined") {
        if (this.querySelector("#" + this._prefix + "includeOtherStudy") !== null &&
            this.querySelector("#" + this._prefix + "DifferentStudies") !== null) {
            let studies = this.query.studies.split(new RegExp("[,;]"));
             if (studies.length > 1) {
                let checkBoxes = PolymerUtils.querySelectorAll("input", "#" + this._prefix + "DifferentStudies");
                console.log("checkBoxes",checkBoxes)
                for (let i = 0; i < studies.length; i++) {
                    let study = studies[i].split(":")[1];
                    for (let j = 0; j < checkBoxes.length; j++) {
                        if (checkBoxes[j].value === study) {
                            debugger
                            checkBoxes[j].checked = true;
                        }
                    }
                }
            }
        }
    }
     */
    // DONE moved in cohort-filter
    // Cohorts

    /*let cohortArray = [];
    if (typeof this.query.cohortStatsAlt !== "undefined") {
        cohortArray = this.query.cohortStatsAlt.split(new RegExp("[,;]"));
        for (let i = 0; i < cohortArray.length; i++) {
            let [study, cohortFreq] = cohortArray[i].split(":");
            let [cohort, freq] = cohortFreq.split(/[<=>]+/);
            let operator = cohortFreq.split(/[-A-Za-z0-9._:]+/)[1];
            PolymerUtils.setValue(this._prefix + study + cohort + "Cohort", freq);
            PolymerUtils.setValue(this._prefix + study + cohort + "CohortOperator", operator);
        }
    }*/
    // implemented in file-filter

    /*// Filter PASS
    if (UtilsNew.isNotEmpty(this.query.filter) && this.query.filter === "PASS") {
        PolymerUtils.getElementById(this._prefix + "FilePassCheckbox").checked = true;
    }
    // Filter QUAL
    if (UtilsNew.isNotEmpty(this.query.qual) && this.query.qual > 0) {
        PolymerUtils.getElementById(this._prefix + "FileQualCheckbox").checked = true;
        PolymerUtils.getElementById(this._prefix + "FileQualInput").disabled = false;
        PolymerUtils.getElementById(this._prefix + "FileQualInput").value = this.query.qual;
    }
     */

    /* implemented in cellbase-region-filter
    // Region
    if (UtilsNew.isNotEmpty(this.query.region)) {
        $("#" + this._prefix + "LocationTextarea").val(this.query.region);
    }
    */

    /* implemented in feature-filter
    // XRefs, Gene and Variant Ids
    if (typeof this.query.xref !== "undefined") {
        PolymerUtils.setValue(this._prefix + "FeatureTextarea", this.query["xref"]);
    } else if (typeof this.query.ids !== "undefined") {
        PolymerUtils.setValue(this._prefix + "FeatureTextarea", this.query.ids);
    }
    */
    // DONE moved in disease-filter
    // Disease panels

    /*if (UtilsNew.isNotUndefinedOrNull(this.query.panel)) {
        $("#" + this._prefix + "DiseasePanels").selectpicker("val", this.query.panel.split(","));
        this.showPanelGenes(this.query.panel.split(","));
    }
    */

    /* implemented in biotype-filter
    // Biotype
    if (UtilsNew.isNotUndefinedOrNull(this.query.biotype)) {
        $("#" + this._prefix + "GeneBiotypes").selectpicker("val", this.query.biotype.split(","));
    }
     */

    /* MOVED in feature-filter
    // Panel - annot-panel
    // TODO Genes must be displayed in Xref textarea
    if (typeof this.query["gene"] !== "undefined") {
        // PolymerUtils.setValue(this._prefix + "PanelAppsTextarea", this.query.gene);
        let geneTextarea = PolymerUtils.getElementById(this._prefix + "FeatureTextarea");
        if (UtilsNew.isNotUndefinedOrNull(geneTextarea)) {
            geneTextarea.value = this.query.gene;
        }
    }
     */
    //DONE moved in variant-type-filter

    /*// Type
    if (typeof this.query.type !== "undefined") {
        let types = this.query.type.split(",");
        let checkBoxes = PolymerUtils.querySelectorAll("input", this._prefix + "Type");
        for (let i = 0; i < types.length; i++) {
            for (let j = 0; j < checkBoxes.length; j++) {
                if (checkBoxes[j].value === types[i]) {
                    checkBoxes[j].checked = true;
                }
            }
        }
    }*/
    //DONE moved to population-frequency-filter TODO recheck

    /*
    // Population Frequencies
    let pfArray = [];
    if (typeof this.query["alternate_frequency"] !== "undefined") {
        pfArray = this.query["alternate_frequency"].split(new RegExp("[,;]"));
    }
    if (typeof this.populationFrequencies !== "undefined" && typeof this.populationFrequencies.studies !== "undefined" && this.populationFrequencies.studies.length > 0) {
        for (let i = 0; i < this.populationFrequencies.studies.length; i++) {
            let study = this.populationFrequencies.studies[i].id;
            for (let j = 0; j < this.populationFrequencies.studies[i].populations.length; j++) {
                let population = this.populationFrequencies.studies[i].populations[j].id;
                if (pfArray.length > 0) {
                    for (let k = 0; k < pfArray.length; k++) {
                        let pf = pfArray[k];
                        if (pf.startsWith(study + ":" + population)) {
                            PolymerUtils.setValue(this._prefix + study + population, pf.split(/[<=>]+/)[1]);
                            PolymerUtils.setValue(this._prefix + study + population + "Operator", pf.split(/[-A-Za-z0-9._:]+/)[1]);
                            break;
                        }
                    }
                }
            }
        }
    }*/
    //DONE moved in proteine-substitution-score-filter TODO recheck

    /*
    // Protein Substitution scores
    if (UtilsNew.isNotUndefinedOrNull(this.query["protein_substitution"])) {
        let pss = this.query["protein_substitution"].split(new RegExp("[,;]"));
        if (pss.length > 0) {
            for (let i = 0; i < pss.length; i++) {
                if (pss[i].startsWith("sift")) {
                    let value = pss[i].split("sift")[1];
                    if (value.startsWith("<") || value.startsWith(">")) {
                        PolymerUtils.setValue(this._prefix + "SiftInput", value.split(/[<=>]+/)[1]);
                        PolymerUtils.setValue(this._prefix + "SiftOperator", value.split(/[-0-9.]+/)[0]);
                    } else {
                        PolymerUtils.setValue(this._prefix + "SiftValues", value.split("==")[1]);
                    }
                    PolymerUtils.getElementById(this._prefix + "SiftInput").disabled = !(value.startsWith("<") || value.startsWith(">"));
                    PolymerUtils.getElementById(this._prefix + "SiftOperator").disabled = !(value.startsWith("<") || value.startsWith(">"));
                } else if (pss[i].startsWith("polyphen")) {
                    let value = pss[i].split("polyphen")[1];
                    if (value.startsWith("<") || value.startsWith(">")) {
                        PolymerUtils.setValue(this._prefix + "PolyphenInput", value.split(/[<=>]+/)[1]);
                        PolymerUtils.setValue(this._prefix + "PolyphenOperator", value.split(/[-0-9.]+/)[0]);
                    } else {
                        PolymerUtils.setValue(this._prefix + "PolyphenValues", value.split("==")[1]);
                    }
                    PolymerUtils.getElementById(this._prefix + "PolyphenInput").disabled = !(value.startsWith("<") || value.startsWith(">"));
                    PolymerUtils.getElementById(this._prefix + "PolyphenOperator").disabled = !(value.startsWith("<") || value.startsWith(">"));
                }
            }
        }
        if (pss.length === 2) {
            $("input:radio[name=pss]").attr("disabled", false);
            if (this.query["protein_substitution"].includes(";")) {
                $("input:radio[name=pss][value=and]").prop("checked", true);
            }
        }
    }
     */
    //DONE moved to cadd-filter
    // Cadd scores

    /*if (typeof this.query["annot-functional-score"] !== "undefined") {
        let fields = this.query["annot-functional-score"].split(new RegExp("[,;]"));
        for (let i = 0; i < fields.length; i++) {
            let source = fields[i].split(/[<=>]+/)[0];
            switch (source) {
            case "cadd_raw":
                PolymerUtils.setValue(this._prefix + "CaddRawInput", fields[i].split(/[<=>]+/)[1]);
                PolymerUtils.setValue(this._prefix + "CaddRawOperator", fields[i].split(/[-A-Za-z0-9_]+/)[1]);
                break;
            case "cadd_scaled":
                PolymerUtils.setValue(this._prefix + "CaddScaledInput", fields[i].split(/[<=>]+/)[1]);
                PolymerUtils.setValue(this._prefix + "CaddScaledOperator", fields[i].split(/[-A-Za-z0-9_]+/)[1]);
                break;
            }
        }
    }*/
    //DONE moved in conservation-filter

    /*
    // Conservation
    if (typeof this.query.conservation !== "undefined") {
        let fields = this.query.conservation.split(new RegExp("[,;]"));
        for (let i = 0; i < fields.length; i++) {
            let source = fields[i].split(/[<=>]+/)[0];
            switch (source) {
            case "phylop":
                PolymerUtils.setValue(this._prefix + "PhylopInput", fields[i].split(/[<=>]+/)[1]);
                PolymerUtils.setValue(this._prefix + "PhylopOperator", fields[i].split(/[-A-Za-z0-9]+/)[1]);
                break;
            case "phastCons":
                PolymerUtils.setValue(this._prefix + "PhastconsInput", fields[i].split(/[<=>]+/)[1]);
                PolymerUtils.setValue(this._prefix + "PhastconsOperator", fields[i].split(/[-A-Za-z0-9]+/)[1]);
                break;
            case "gerp":
                PolymerUtils.setValue(this._prefix + "GerpInput", fields[i].split(/[<=>]+/)[1]);
                PolymerUtils.setValue(this._prefix + "GerpOperator", fields[i].split(/[-A-Za-z0-9]+/)[1]);
                break;
            }
        }
    }
     */
    //DONE moved in consequence-type-filter
    // Consequence Type

    /*let ct = [];
    if (typeof this.query.ct !== "undefined") {
        let types = this.query.ct.split(",");
        for (let i = 0; i < types.length; i++) {
            let checkbox = PolymerUtils.getElementById(this._prefix + types[i] + "Checkbox");
            if (UtilsNew.isNotUndefinedOrNull(checkbox)) {
                checkbox.checked = true;
                ct.push(types[i]);
            }
        }
    }
    this.ct = ct;*/
    // Gene Ontology and Human Phenotype Ontology
    //DONE moved to go-accessions-filter

    /*
    if (typeof this.query["go"] !== "undefined") {
        PolymerUtils.setValue(this._prefix + "GeneOntologyTextarea", this.query["go"]);
    }*/
    //DONE moved to hpo-accessions-filter

    /*if (typeof this.query["annot-hpo"] !== "undefined") {
        PolymerUtils.setValue(this._prefix + "HumanPhenotypeOntologyTextarea", this.query["annot-hpo"]);
    }*/
    //DONE moved to clinvar-accessions-filter

    /* if (typeof this.query["clinvar"] !== "undefined") {
         PolymerUtils.setValue(this._prefix + "ClinVarTextarea", this.query["clinvar"]);
     }
     */
    //DONE moved to fulltext-searc-accessions-filter

    /*if (typeof this.query["traits"] !== "undefined") {
         PolymerUtils.setValue(this._prefix + "TraitsTextarea", this.query.traits);
     }*/
    // this.requestUpdate();

  } //DONE MOVED to disease-filter TODO recheck & refactor

  /*showPanelGenes(panels) {
      PolymerUtils.getElementById(this._prefix + "DiseasePanelsTextarea").value = "";
      if (UtilsNew.isNotEmptyArray(panels)) {
          let _this = this;
          this.opencgaSession.opencgaClient.panels()
              .info(panels.join(","), {
                  study: _this.opencgaSession.study.fqn,
                  include: "id,name,genes.id,genes.name,regions.id"
              }, {})
              .then(function (response) {
                  let text = "";
                  for (let panelResponse of response.response) {
                      let panel = panelResponse.result[0];
                      let geneNames = [];
                      for (let gene of panel.genes) {
                          geneNames.push(gene.name);
                      }
                      let regions = [];
                      for (let region of panel.regions) {
                          regions.push(region.id);
                      }
                      text += `${panel.name} (${geneNames.length} genes and ${regions.length} regions): ${geneNames.join(",")} \n`;
                      text += `${geneNames.join(",")} \n`;
                      text += `${regions.join(",")} \n\n`;
                  }
                  PolymerUtils.getElementById(_this._prefix + "DiseasePanelsTextarea").value = text;
              })
              .catch(function (response) {
                  console.error(response);
              });
      }
  }*/

  /***
   * Handles filterChange events from all the filter components (this is the new updateQueryFilters)
   * @param key {string} the name of the property in this.query
   * @param value {string} the new value of the property
   */


  onFilterChange(key, value) {
    console.log("filterChange", {
      [key]: value
    });

    if (value && value !== "") {
      this.preparedQuery = opencga_variant_filter_objectSpread({}, this.preparedQuery, {}, {
        [key]: value
      });
    } else {
      console.log("deleting", key, "from preparedQuery");
      delete this.preparedQuery[key];
      this.preparedQuery = opencga_variant_filter_objectSpread({}, this.preparedQuery);
    }

    this.notifyQuery(this.preparedQuery); //this.requestUpdate(); //TODO recheck if this is necessary. it seems it cause a bug in the select in study-filter (on the first click on the option the option is not selected)
  }

  onSampleFilterChange(sampleFields) {
    console.log("onSampleFilterChange in variant-filter", sampleFields); //TODO refactor with proper optional spreading

    if (!sampleFields.genotype) {
      delete this.preparedQuery.genotype;
    }

    if (!sampleFields.sample) {
      delete this.preparedQuery.sample;
    }

    if (!sampleFields.format) {
      delete this.preparedQuery.format;
    }

    this.preparedQuery = opencga_variant_filter_objectSpread({}, this.preparedQuery, {}, sampleFields);
    this.notifyQuery(this.preparedQuery);
    this.requestUpdate();
  } //binding::from the view to this.query
  //most of those blocks have been refactored & moved in filterChange() in each filter component


  updateQueryFilters() {
    if (!this._initialised) {
      return;
    }

    console.log("this.query", this.query);
    let _filters = {};

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query.genotype)) {
      _filters.genotype = this.query.genotype;
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query.format)) {
      _filters.format = this.query.format;
    } // if (UtilsNew.isNotUndefinedOrNull(this.query.file)) {
    //     _filters.file = this.query.file;
    // }
    // if (UtilsNew.isNotUndefinedOrNull(this.query.qual)) {
    //     _filters.qual = this.query.qual;
    // }


    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query.info)) {
      _filters.info = this.query.info;
    } // Add Cohort stats ALT filter: [{study.alias}]:{cohort}[<|>|<=|>=]{number}
    //DONE moved to cohort-filter

    /*let cohortFreq = [];
    if (UtilsNew.isNotEmpty(this._cohorts)) {
        for (let studyId in this._cohorts) {
            for (let cohort of this._cohorts[studyId]) {
                let cohortInput = PolymerUtils.getElementById(this._prefix + studyId + cohort.id + "Cohort");
                let operator = PolymerUtils.getElementById(this._prefix + studyId + cohort.id + "CohortOperator");
                if (cohortInput !== null && UtilsNew.isNotEmpty(cohortInput.value)) {
                    operator = operator.value;
                    // FIXME to be removed!!
                    if (studyId === "BRIDGE") {
                        studyId = "bridge";
                    }
                    let pf = studyId + ":" + cohort.id + operator + cohortInput.value;
                    cohortFreq.push(pf);
                }
            }
        }
    }
    if (cohortFreq.length > 0) {
        // _filters["cohortStatsMaf"] = cohortFreq.join(';');
        _filters.cohortStatsAlt = cohortFreq.join(";");
    }*/

    /*
    //DONE Move DOM elements checking in study-filter
    // Studies - This section is not renderer when only study exists
    let studies = [this.opencgaSession.study.fqn];
      // PolymerUtils.querySelectorAll doesn't work here...
     //let selectedStudies = PolymerUtils.querySelectorAll("input:checked", "#" + this._prefix + "DifferentStudies");
     let selectedStudies = this.querySelector("#"+this._prefix+"DifferentStudies").querySelector("input:checked");
      //console.log("selectedStudies", selectedStudies)
      if (UtilsNew.isNotUndefinedOrNull(selectedStudies)) {
         for (let i = 0; i < selectedStudies.length; i++) {
             if (studies.indexOf(this.opencgaSession.project.alias + ":" + selectedStudies[i].value) === -1) {
                 studies.push(this.opencgaSession.project.alias + ":" + selectedStudies[i].value);
             }
         }
         switch (PolymerUtils.getElementById(this._prefix + "includeOtherStudy").value) {
         case "in":
             _filters.studies = studies.join(";");
             break;
         case "atleast":
             _filters.studies = studies.join(",");
             break;
         case "not in":
             let notInStudies = [];
             let currentStudy = this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias;
             for (let j = 0; j < studies.length; j++) {
                 if (currentStudy === studies[j]) {
                     // Always add the study that we are browsing currently
                     notInStudies.push(studies[j]);
                 } else {
                     notInStudies.push("!" + studies[j]);
                 }
             }
             _filters.studies = notInStudies.join(";");
             break;
         }
     } else {
         // Set study when no studies have been displayed, probably because there is only one study.
         //TODO add this case this.opencgaSession.study.fqn
         _filters.study = this.opencgaSession.study.fqn;
     }
      */
    //DONE Move DOM elements checking in file-filter

    /*
    Filter PASS
    let filePassCheckbox = PolymerUtils.getElementById(this._prefix + "FilePassCheckbox");
    if (UtilsNew.isNotUndefinedOrNull(filePassCheckbox) && filePassCheckbox.checked) {
        _filters.filter = "PASS";
    }
    // Filter QUAL
    let fileQualCheckbox = PolymerUtils.getElementById(this._prefix + "FileQualCheckbox");
    if (UtilsNew.isNotUndefinedOrNull(filePassCheckbox)) {
        if (fileQualCheckbox.checked) {
            let fileQualInput = PolymerUtils.getElementById(this._prefix + "FileQualInput");
            if (UtilsNew.isNotUndefinedOrNull(fileQualInput) && UtilsNew.isNotEmpty(fileQualInput.value)) {
                _filters.qual = ">=" + fileQualInput.value;
            }
        }
        PolymerUtils.getElementById(this._prefix + "FileQualInput").disabled = !fileQualCheckbox.checked;
    }
    */
    //DONE Move DOM elements checking in region-filter

    /*let locationTextArea = PolymerUtils.getElementById(this._prefix + "LocationTextarea");
    if (UtilsNew.isNotUndefinedOrNull(locationTextArea) && UtilsNew.isNotEmpty(locationTextArea.value)) {
        let _region = locationTextArea.value.trim();
        _region = _region.replace(/\r?\n/g, ",").replace(/\s/g, "");
        _filters.region = _region;
    }*/
    //DONE moved in feature-filter
    // Features: Gene, SNP ID

    /*let featureTextArea = PolymerUtils.getElementById(this._prefix + "FeatureTextarea");
    if (UtilsNew.isNotUndefinedOrNull(featureTextArea) && UtilsNew.isNotEmpty(featureTextArea.value)) {
        let features = featureTextArea.value.trim();
        features = features.replace(/\r?\n/g, ",").replace(/\s/g, "");
        let featureArray = [];
        for (let feature of features.split(",")) {
            if (feature.startsWith("rs") || feature.split(":").length > 2) {
                featureArray.push(feature);
            } else {
                // Genes must be uppercase
                featureArray.push(feature.toUpperCase());
            }
        }
        _filters.xref = featureArray.join(",");
    }*/
    //DONE moved to disease-filter
    // Disease Panel - panel

    /*let panelsDropdown = PolymerUtils.getElementById(this._prefix + "DiseasePanels");
    if (UtilsNew.isNotUndefinedOrNull(panelsDropdown)) {
        let selectedPanels = PolymerUtils.querySelectorAll("option:checked", panelsDropdown);
        let panels = [];
        selectedPanels.forEach(option => panels.push(option.value));
        if (panels.length > 0) {
            _filters.panel = panels.join(",");
            this.showPanelGenes(panels);
        }
    }*/
    // Biotype
    //DONE moved in biotype-filter (actually no, I don't need the whole block)

    /*let biotypeDropdown = PolymerUtils.getElementById(this._prefix + "GeneBiotypes");
    if (UtilsNew.isNotUndefinedOrNull(biotypeDropdown) && UtilsNew.isNotEmpty(biotypeDropdown.value)) {
        let types = PolymerUtils.querySelectorAll("option:checked", biotypeDropdown);
        let biotypes = [];
        types.forEach(option => biotypes.push(option.value));
        _filters.biotype = biotypes.join(",");
    }*/
    //DONE moved to variant-type-filter
    // Type

    /*let typeCheckbox = PolymerUtils.getElementById(this._prefix + "Type");
    if (UtilsNew.isNotUndefinedOrNull(typeCheckbox)) {
        let types = PolymerUtils.querySelectorAll("input:checked", typeCheckbox);
        let typesAux = [];
        if (types.length > 0) {
            for (let i = 0; i < types.length; i++) {
                typesAux.push(types[i].value);
            }
            _filters.type = typesAux.join(",");
        }
    }
    */
    //DONE moved in population-frequency-filter
    // Population Frequencies
    // Population minor allele frequency: {study}:{population}[<|>|<=|>=]{number}

    /*let popFreq = [];
    if (UtilsNew.isNotUndefinedOrNull(this.populationFrequencies) && UtilsNew.isNotEmptyArray(this.populationFrequencies.studies)) {
        for (let i = 0; i < this.populationFrequencies.studies.length; i++) {
            let study = this.populationFrequencies.studies[i].id;
            for (let j = 0; j < this.populationFrequencies.studies[i].populations.length; j++) {
                let population = this.populationFrequencies.studies[i].populations[j].id;
                 let studyTextbox = PolymerUtils.getElementById(this._prefix + study + population);
                if ((UtilsNew.isNotUndefinedOrNull(studyTextbox) && UtilsNew.isNotEmpty(studyTextbox.value))) {
                    let operator = PolymerUtils.getElementById(this._prefix + study + population + "Operator");
                    let pf = study + ":" + population + operator.value + studyTextbox.value;
                    popFreq.push(pf);
                }
            }
        }
    }
    if (popFreq.length > 0) {
        _filters["populationFrequencyAlt"] = popFreq.join(";");
    }*/
    //DONE moved in protein-substitution-score-filter

    /*
    // Protein Substitution Scores -  Sift and Polyphen
    let pss = [];
    let numFilters = 0;
    let subsScores = ["Sift", "Polyphen"];
    subsScores.forEach((subsScore) => {
        let dropdownValues = PolymerUtils.getElementById(this._prefix + subsScore + "Values");
        let textboxInput = PolymerUtils.getElementById(this._prefix + subsScore + "Input");
        let operator = PolymerUtils.getElementById(this._prefix + subsScore + "Operator");
        if (dropdownValues !== null && dropdownValues.value === "score" && UtilsNew.isNotEmpty(textboxInput.value)) {
            pss.push(subsScore.toLowerCase() + operator.value + textboxInput.value);
            numFilters++;
        } else if (dropdownValues !== null && dropdownValues.value !== "score") {
            pss.push(subsScore.toLowerCase() + "==" + dropdownValues.value);
            numFilters++;
        }
    });
     // If both Sift and Polyphen are selected then we activate the AND/OR control
    if (numFilters === 2) {
        $("input:radio[name=pss]").attr("disabled", false);
    }
    if (pss.length > 0) {
        let filter = $("input:radio[name=pss]:checked").val();
        if (filter === "and") {
            _filters.protein_substitution = pss.join(";");
        } else {
            _filters.protein_substitution = pss.join(",");
        }
    }*/
    //DONE moved to cadd-filter
    // Cadd scores

    /*let cadd = [];
    let caddRawInput = PolymerUtils.getElementById(this._prefix + "CaddRawInput");
    let caddScaledInput = PolymerUtils.getElementById(this._prefix + "CaddScaledInput");
    if (UtilsNew.isNotUndefinedOrNull(caddRawInput) && UtilsNew.isNotUndefinedOrNull(caddScaledInput)) {
        if (UtilsNew.isNotEmpty(caddRawInput.value)) {
            cadd.push("cadd_raw" + PolymerUtils.getElementById(this._prefix + "CaddRawOperator").value + caddRawInput.value);
        }
        if (UtilsNew.isNotEmpty(caddScaledInput.value)) {
            cadd.push("cadd_scaled" + PolymerUtils.getElementById(this._prefix + "CaddScaledOperator").value + caddScaledInput.value);
        }
    }
    if (cadd.length > 0) {
        _filters["annot-functional-score"] = cadd.join(",");
    }
      */
    //DONE moved in conservation-filter

    /*// Conservation
    let arr = {"Phylop": "phylop", "Phastcons": "phastCons", "Gerp": "gerp"};
    let conserArr = [];
    for (let key of Object.keys(arr)) {
        let inputTextArea = PolymerUtils.getElementById(this._prefix + key + "Input");
        if (UtilsNew.isNotUndefinedOrNull(inputTextArea) && UtilsNew.isNotEmpty(inputTextArea.value)) {
            let operator = PolymerUtils.getElementById(this._prefix + key + "Operator");
            conserArr.push(arr[key] + operator.value + inputTextArea.value);
        }
    }
    // Disable OR/AND logical operator
    if (conserArr.length > 1) {
        $("input:radio[name=conservation]").attr("disabled", false);
    } else {
        $("input:radio[name=conservation]").attr("disabled", true);
    }
    if (conserArr.length > 0) {
        let filter = $("input:radio[name=conservation]:checked").val();
        if (filter === "and") {
            _filters.conservation = conserArr.join(";");
        } else {
            _filters.conservation = conserArr.join(",");
        }
    }*/
    //DONE moved in consequence-type-filter
    // Consequence Type

    /*
    if (UtilsNew.isNotEmptyArray(this.ct)) {
        _filters["ct"] = this.ct.join(",");
    }*/
    //DONE moved go-accessions-filter
    // Gene Ontology and Human Phenotype Ontology

    /*
    let inputTextArea = PolymerUtils.getElementById(this._prefix + "GeneOntologyTextarea");
    if (UtilsNew.isNotUndefinedOrNull(inputTextArea) && UtilsNew.isNotEmpty(inputTextArea.value)) {
        let _go = inputTextArea.value.trim();
        _go = _go.replace(/\r?\n/g, ",").replace(/\s/g, "");
        _filters.go = _go;
    }*/
    //DONE moved to hpo-accessions-filter

    /*let inputTextArea = PolymerUtils.getElementById(this._prefix + "HumanPhenotypeOntologyTextarea");
    if (UtilsNew.isNotUndefinedOrNull(inputTextArea) && UtilsNew.isNotEmpty(inputTextArea.value)) {
        let hpoValues = inputTextArea.value.split(",");
         if (UtilsNew.isNotEmptyArray(hpoValues)) {
            $("input:radio[name=hpoRadio]").attr("disabled", false);
            let filter = $("input:radio[name=hpoRadio]:checked").val();
            if (filter === "and") {
                _filters["annot-hpo"] = hpoValues.join(";");
            } else {
                _filters["annot-hpo"] = hpoValues.join(",");
            }
        }
        // _filters["annot-hpo"] = inputTextArea.value;
    }*/
    //DONE moved to clinvar-accessions-filter

    /*        let inputTextArea = PolymerUtils.getElementById(this._prefix + "ClinVarTextarea");
            if (UtilsNew.isNotUndefinedOrNull(inputTextArea) && UtilsNew.isNotEmpty(inputTextArea.value)) {
                let _clinvar = inputTextArea.value.trim();
                _clinvar = _clinvar.replace(/\r?\n/g, ",").replace(/\s/g, "");
                _filters.clinvar = _clinvar;
            }*/
    //DONE fulltext-search-accessions-filter

    /*let inputTextArea = PolymerUtils.getElementById(this._prefix + "TraitsTextarea");
    if (UtilsNew.isNotUndefinedOrNull(inputTextArea) && UtilsNew.isNotEmpty(inputTextArea.value)) {
        _filters["traits"] = inputTextArea.value;
    }*/
    // To prevent to call setQueryFilters we set this to false
    // this._reset = false;
    // this.query = _filters;
    // this._reset = true;
    //
    // this.notifyQuery(this.query)
    // this.requestUpdate()

  } //DONE implemented in feature-filter

  /*
  callAutocomplete(e) {
      // Only gene symbols are going to be searched and not Ensembl IDs
      let featureId = PolymerUtils.getElementById(this._prefix + "FeatureIdText").value;
      if (UtilsNew.isNotUndefinedOrNull(featureId) && featureId.length >= 3 && !featureId.startsWith("ENS")) {
          let _this = this;
          _this.cellbaseClient.get("feature", "id", featureId.toUpperCase(), "starts_with", {}, {})
              .then(function (response) {
                  let options = "";
                  for (let id of response.response[0].result) {
                      options += `<option value="${id.name}">`;
                  }
                  PolymerUtils.innerHTML(_this._prefix + "FeatureDatalist", options);
              });
      }
  }
   //DONE implemented in feature-filter
  addFeatureId(e) {
      let allIds = [];
      let featureTextArea = PolymerUtils.getElementById(this._prefix + "FeatureTextarea");
      if (UtilsNew.isNotUndefinedOrNull(featureTextArea) && UtilsNew.isNotEmpty(featureTextArea.value)) {
          allIds = featureTextArea.value.split(",");
      }
       let featureIdText = PolymerUtils.getElementById(this._prefix + "FeatureIdText");
      if (allIds.indexOf(featureIdText.value) === -1) {
          allIds.push(featureIdText.value);
      }
      featureIdText.value = "";
      featureTextArea.value = allIds;
       this.updateQueryFilters();
  }
   */
  //TODO recheck if there is no other way...


  _clearHtmlDom() {
    // Empty everything before rendering
    $("." + this._prefix + "FilterSelect").prop("selectedIndex", 0);
    $("." + this._prefix + "FilterSelect").prop("disabled", false); //handled in population-frequency-filter
    //TODO many other components use this!

    $("." + this._prefix + "FilterTextInput").val("");
    $("." + this._prefix + "FilterTextInput").prop("disabled", false);
    $("." + this._prefix + "FilterCheckBox").prop("checked", false);
    $("." + this._prefix + "FilterRadio").prop("checked", false);
    $("." + this._prefix + "FilterRadio").filter("[value=\"or\"]").prop("checked", true);
    $("." + this._prefix + "FilterRadio").prop("disabled", true);
    $("#" + this._prefix + "DiseasePanelsTextarea").val("");

    if (PolymerUtils_PolymerUtils.getElementById(this._prefix + "FileQualInput") !== null) {
      PolymerUtils_PolymerUtils.getElementById(this._prefix + "FileQualInput").disabled = true;
    } // Deselect bootstrap-select dropdowns
    //handled in updated() in disease-filter
    //$("#" + this._prefix + "DiseasePanels").selectpicker("val", []);
    //handled in updated() in biotype-filter
    //$("#" + this._prefix + "GeneBiotypes").selectpicker("val", []);


    $("#" + this._prefix + "vcfFilterSelect").selectpicker("val", []);
  } // This method is only executed one time from connectedCallback function
  // TODO recheck if it really needs to be executed in opencgaSessionObserver()


  _renderFilterMenu() {
    // Add events and tooltips to the filter menu
    // TODO move tooltips init somewhere after template has been rendered
    //this._addEventListeners();
    return this.config.sections && this.config.sections.length && this.config.sections.map(section => this._createSection(section));
  }

  _createSection(section) {
    let id = section.title.replace(/ /g, "");
    let collapsed = section.collapsed ? "" : "in";
    return lit_html_lit_html_html(opencga_variant_filter_templateObject(), this._prefix, id, this._prefix, this._prefix, id, this._prefix, id, section.title, this._prefix, id, collapsed, this._prefix, id, section.subsections && section.subsections.length && section.subsections.map(subsection => lit_html_lit_html_html(opencga_variant_filter_templateObject2(), this.config.skipSubsections && this.config.skipSubsections.length && !!~this.config.skipSubsections.indexOf(subsection.id) ? null : this._createSubSection(subsection))));
  }

  _createSubSection(subsection) {
    // ConsequenceType needs horizontal scroll
    let ctScroll = subsection.id === "consequenceType" ? "browser-ct-scroll" : "";
    let content = "";

    switch (subsection.id) {
      case "study":
        if (this.opencgaSession.project.studies.length < 2) {
          return "";
        }

        content = lit_html_lit_html_html(opencga_variant_filter_templateObject3(), this.opencgaSession, this.differentStudies, this.preparedQuery.studies, e => this.onFilterChange("studies", e.detail.value));
        break;

      case "cohort":
        content = lit_html_lit_html_html(opencga_variant_filter_templateObject4(), this.opencgaSession, subsection.cohorts, this._cohorts, this.preparedQuery.cohortStatsAlt, e => this.onFilterChange("cohortStatsAlt", e.detail.value));
        break;

      case "sample":
        content = lit_html_lit_html_html(opencga_variant_filter_templateObject5(), subsection.showSelectSamples, this.opencgaSession, this.clinicalAnalysis, this.query, e => this.onSampleFilterChange(e.detail.value));
        break;

      case "file":
        /** @deprecated */
        content = lit_html_lit_html_html(opencga_variant_filter_templateObject6(), this.query, e => this.onFilterChange("filter", e.detail.value));
        break;

      case "file-pass":
        content = lit_html_lit_html_html(opencga_variant_filter_templateObject7(), this.preparedQuery.filter, e => this.onFilterChange("filter", e.detail.value));
        break;

      case "file-qual":
        content = lit_html_lit_html_html(opencga_variant_filter_templateObject8(), this.preparedQuery.qual, e => this.onFilterChange("qual", e.detail.value));
        break;

      case "location":
        content = lit_html_lit_html_html(opencga_variant_filter_templateObject9(), this.cellbaseClient, this.preparedQuery.region, e => this.onFilterChange("region", e.detail.value));
        break;

      case "feature":
        content = lit_html_lit_html_html(_templateObject10(), this.cellbaseClient, this.query, e => this.onFilterChange("xref", e.detail.value));
        break;

      case "diseasePanels":
        content = lit_html_lit_html_html(_templateObject11(), this.opencgaSession, this.config, this.preparedQuery.panel, e => this.onFilterChange("panel", e.detail.value));
        break;

      case "biotype":
        content = lit_html_lit_html_html(_templateObject12(), this.config, this.preparedQuery.biotype, e => this.onFilterChange("biotype", e.detail.value));
        break;

      case "type":
        content = lit_html_lit_html_html(_templateObject13(), this.config, this.preparedQuery.type, this.cellbaseClient, e => this.onFilterChange("type", e.detail.value));
        break;

      case "populationFrequency":
        content = lit_html_lit_html_html(_templateObject14(), this.populationFrequencies, subsection.showSetAll, this.preparedQuery.populationFrequencyAlt, e => this.onFilterChange("populationFrequencyAlt", e.detail.value));
        break;

      case "consequenceType":
        content = lit_html_lit_html_html(_templateObject15(), this.consequenceTypes, this.preparedQuery.ct, e => this.onFilterChange("ct", e.detail.value));
        break;

      case "proteinSubstitutionScore":
        content = lit_html_lit_html_html(_templateObject16(), this.preparedQuery.protein_substitution, e => this.onFilterChange("protein_substitution", e.detail.value));
        break;

      case "cadd":
        if (this.opencgaSession.project.organism.assembly.toLowerCase() === "grch38") {
          return "";
        }

        content = lit_html_lit_html_html(_templateObject17(), this.preparedQuery["annot-functional-score"], e => this.onFilterChange("annot-functional-score", e.detail.value));
        break;

      case "conservation":
        content = lit_html_lit_html_html(_templateObject18(), this.preparedQuery.conservation, e => this.onFilterChange("conservation", e.detail.value));
        break;

      case "go":
        content = lit_html_lit_html_html(_templateObject19(), this.go, this.onOntologyModalOpen, e => this.onFilterChange("go", e.detail.value));
        break;

      case "hpo":
        content = lit_html_lit_html_html(_templateObject20(), this.preparedQuery["annot-hpo"], this.onOntologyModalOpen, e => this.onFilterChange("annot-hpo", e.detail.value));
        break;

      case "clinvar":
        content = lit_html_lit_html_html(_templateObject21(), this.preparedQuery.clinvar, e => this.onFilterChange("clinvar", e.detail.value));
        break;

      case "fullTextSearch":
        content = lit_html_lit_html_html(_templateObject22(), this.preparedQuery.traits, e => this.onFilterChange("traits", e.detail.value));
        break;

      default:
        console.error("Filter component not found");
    }

    return lit_html_lit_html_html(_templateObject23(), subsection.id, subsection.title, subsection.title, this._prefix, subsection.id, this._prefix, subsection.id, ctScroll, content);
  }
  /*
  
      //study-filter
      _getStudyHtml() {
          return html`
              <select class="form-control input-sm ${this._prefix}FilterSelect" id="${this._prefix}includeOtherStudy" @change="${this.updateQueryFilters}">
                  <option value="in" selected>In all (AND)</option>
                  <option value="atleast">In any of (OR)</option>
              </select>
              <div id="${this._prefix}DifferentStudies" class="form-group">
                  <br>
                  <input type="checkbox" value="${this.opencgaSession.study.alias}" data-id="${this.opencgaSession.study.id}" checked disabled >
                  <span style="font-weight: bold;font-style: italic;color: darkred">${this.opencgaSession.study.alias}</span>
                  ${this.differentStudies && this.differentStudies.length && this.differentStudies.map(study => html`
                              <br>
                              <input id="${this._prefix}${study.alias}Checkbox" type="checkbox" @click="${this.updateQueryFilters}" value="${study.alias}" data-id="${study.id}" class="${this._prefix}FilterCheckBox">
                              ${study.alias}
                  `)}
              </div>
          `;
      }
  
      //cohort-filter
      _getCohortHtml(cohorts) {
          let projectId = this.opencgaSession.project.id;
          let cohortsPerStudy = cohorts[projectId];
  
          return cohortsPerStudy ? html`
              ${Object.keys(cohortsPerStudy).map(study => html`
                  <div style="padding: 5px 0px">
                      <div style="padding-bottom: 5px">
                          <span style="font-style: italic">COHORT HTML${study}</span> study:
                      </div>
                      <div class="form-horizontal">
                          ${cohortsPerStudy[study] && cohortsPerStudy[study].map(cohort => html`
                              <div class="form-group" style="margin: 5px 0px">
                                  <span class="col-md-4 control-label">${cohort.name}</span>
                                  <div class="col-md-4" style="padding: 0px 10px">
                                      <select id="${this._prefix}${study}${cohort.id}CohortOperator" name="${cohort.id}Operator"
                                              class="form-control input-sm ${this._prefix}FilterSelect" style="padding: 0px 5px" @change="${this.updateQueryFilters}">
                                          <option value="<" selected><</option>
                                          <option value="<="><=</option>
                                          <option value=">">></option>
                                          <option value=">=">>=</option>
                                      </select>
                                  </div>
                                  <div class="col-md-4" style="padding: 0px 10px">
                                      <input type="text" value="" class="form-control input-sm ${this._prefix}FilterTextInput"
                                             name="${study}_${cohort.id}" id="${this._prefix}${study}${cohort.id}Cohort" @change="${this.updateQueryFilters}">
                                  </div>
                              </div>
                          `)}
                      </div>
                  </div>`)}
          ` : html`
              <span>Project not found</span>
          `;
      }
  
      //sample-filter
      _getSampleHtml(subsection) {
          return subsection.showSelectSamples ? html`
              <div>
                  <div style="padding: 10px 0px">Select Genotype Filter:</div>
                  <div style="padding-left: 20px">
                      <button id="${this._prefix}SampleFilterModalButton" type="button" class="btn btn-default" style="width: 80%" @click="${this.onSampleFilterClick}">
                          Sample Filters ...
                      </button>
                  </div>
              </div>
              <div style="padding: 10px 0px 5px 0px">
                  <div style="padding: 15px 0px;">
                      <span>Sample Genotype Summary</span>
                  </div>
                  <table class="table" style="margin-bottom: 10px">
                      <thead>
                      <tr>
                          <th scope="col">Sample ID</th>
                          <th scope="col">GT</th>
                      </tr>
                      </thead>
                      <tbody id="${this._prefix}SampleFiltersSummaryTBody">
                      <tr>
                          <td>No samples selected</td>
                          <td></td>
                      </tr>
                      </tbody>
                  </table>
              </div>
          ` : ``;
      }
  
      //file-filter
      _getFileHtml() {
          return html`
              <div class="row">
                  <div class="col-md-12">
                      <input id="${this._prefix}FilePassCheckbox" type="checkbox" class="${this._prefix}FilterCheckBox" @change="${this.updateQueryFilters}"><span
                          style="padding-left: 5px">Only include <span style="font-weight: bold;">PASS</span> variants</span>
                  </div>
                  <form class="form-horizontal">
                      <div class="form-group col-md-12">
                          <div class="col-md-8">
                              <input id="${this._prefix}FileQualCheckbox" type="checkbox"
                                     class="${this._prefix}FilterCheckBox" @change="${this.updateQueryFilters}"><span style="padding-left: 5px">Introduce min. <span
                                  style="font-weight: bold;">QUAL</span></span>
                          </div>
                          <div class="col-md-4">
                              <input id="${this._prefix}FileQualInput" type="text" class="form-control input-sm ${this._prefix}FilterTextInput" disabled @keyup="${this.updateQueryFilters}">
                          </div>
                      </div>
                  </form>
              </div>
          `;
      }
  
      //cellbase-region-filter
      _getLocationHtml() {
          return html`<textarea id="${this._prefix}LocationTextarea" name="location" class="form-control clearable ${this._prefix}FilterTextInput" rows="3" placeholder="3:444-55555,1:1-100000" @keyup="${this.updateQueryFilters}"></textarea>`;
      }
  
      //feature-filter
      _getFeatureHtml() {
          return html`
              <div class="row">
                  <div class="col-md-9">
                      <input id="${this._prefix}FeatureIdText" type="text" class="form-control"
                             list="${this._prefix}FeatureDatalist"
                             placeholder="Search for Gene Symbols" value="" @keyup="${this.callAutocomplete}">
                      <datalist id="${this._prefix}FeatureDatalist"></datalist>
                  </div>
                  <div class="col-md-3">
                      <button id="${this._prefix}FeatureAddButton" type="button" class="btn btn-default btn-sm form-control" @click="${this.addFeatureId}">
                          <i class="fa fa-plus"></i>
                      </button>
                  </div>
              </div>
              <div class="form-group">
                  <textarea id="${this._prefix}FeatureTextarea" name="geneSnp"
                      class="form-control clearable ${this._prefix}FilterTextInput"
                      rows="3" placeholder="BRCA2,ENSG00000139618,ENST00000544455,rs28897700"
                      style="margin-top: 5px" @keyup="${this.updateQueryFilters}"></textarea>
              </div>
          `;
      }
  
      //disease-filter
      _getDiseasePanelsHtml() {
          return html`
              <div>
                  <select id="${this._prefix}DiseasePanels" class="selectpicker" data-size="10" data-live-search="true" data-selected-text-format="count" multiple @change="${this.updateQueryFilters}">
                      ${this.opencgaSession.study.panels && this.opencgaSession.study.panels.length && this.opencgaSession.study.panels.map(panel => html`
                          <option value="${panel.id}">
                              ${panel.name}
                              ${panel.source ? "v" + panel.source.version : ""}
                              ( ${panel.stats ? panel.stats.numberOfGenes + "genes, " + panel.stats.numberOfRegions + "regions" : "0 genes, 0 regions"})
                          </option>
                      `)}
                  </select>
              <textarea id="${this._prefix}DiseasePanelsTextarea" class="form-control" rows="4" style="margin-top: 5px;background: #f7f7f7" disabled> </textarea>
              </div>
          `;
      }
  
      //cellbase-biotype-filter
      _getBiotypeHtml(biotypes = []) {
          return html`
              <select class="selectpicker" id="${this._prefix}GeneBiotypes" data-size="10" data-live-search="true" data-selected-text-format="count" multiple @change="${this.updateQueryFilters}">
                  ${biotypes.map(biotype => html`
                       <option value="${biotype}">${biotype}</option>
                  `)}
              </select>
          `;
      }
  
      //varianty-type=filter
      _getVariantTypeHtml(types) {
          return html`
              <div id="${this._prefix}Type">
                  ${types && types.length && types.map(type => html`
                      <input type="checkbox" value="${type}" class="${this._prefix}FilterCheckBox" @change="${this.updateQueryFilters}"> ${type}<br>
                  `)}
              </div>
          `;
      }
  
      //population-frequency-filter
      _getPopulationFrequencyHtml(showSetAll) {
          return html`
                          ${this.populationFrequencies.studies && this.populationFrequencies.studies.length && this.populationFrequencies.studies.map(study => html`
                              <div style="padding-top: 10px">
                                  <i id="${this._prefix}${study.id}Icon" data-id="${this._prefix}${study.id}" class="fa fa-plus" style="cursor: pointer;padding-right: 10px" @click="${this.handleCollapseAction}"></i>
                                  <strong>${study.title}</strong>
                                  <div id="${this._prefix}${study.id}" class="form-horizontal" hidden>
                                      ${showSetAll ? html`
                                          <div class="form-group" style="margin: 5px 0px">
                                              <span class="col-md-7 control-label" data-toggle="tooltip" data-placement="top" style="text-align: left;">Set all</span>
                                              <div class="col-md-5" style="padding: 0px 10px">
                                                  <input id="${this._prefix}${study.id}Input" type="text" data-study="${study.id}" value="" class="form-control input-sm ${this._prefix}FilterTextInput"
                                                  name="${study.id}Input" @keyup="${this.keyUpAllPopFreq}" @change="${this.updateQueryFilters}" >
                                              </div>
                                          </div>
                                      ` : ""}
                                      ${study.populations && study.populations.length && study.populations.map(popFreq => html`
                                          <div class="form-group" style="margin: 5px 0px">
                                              <span class="col-md-3 control-label" data-toggle="tooltip" data-placement="top" title="${popFreq.title}">${popFreq.id}</span>
                                              <div class="col-md-4" style="padding: 0px 10px">
                                                  <select id="${this._prefix}${study.id}${popFreq.id}Operator" name="${popFreq.id}Operator"
                                                          class="form-control input-sm ${this._prefix}FilterSelect" style="padding: 0px 5px" @change="${this.updateQueryFilters}">
                                                      <option value="<" selected><</option>
                                                      <option value="<="><=</option>
                                                      <option value=">">></option>
                                                      <option value=">=">>=</option>
                                                  </select>
                                              </div>
                                              <div class="col-md-5" style="padding: 0px 10px">
                                                  <input id="${this._prefix}${study.id}${popFreq.id}" type="text" value="" class="form-control input-sm ${this._prefix}FilterTextInput"
                                                          name="${study.id}_${popFreq.id}" @keyup="${this.updateQueryFilters}">
                                              </div>
                                          </div>
                                      `)}
                                  </div>
                              </div>
                          `)}
                  `;
      }
  
      //consequence-type-filter
      _getConsequenceTypeHtml() {
          return html`
                      <div style="padding-top: 15px">Loss-of-Function (LoF) terms:</div>
                          <div class="form-check" style="margin-top: 5px;">
                              <div class="form-check-label">
                                  <label id="${this._prefix}LossOfFunctionCheckBoxLabel" class="notbold">
                                      <input id="${this._prefix}LossOfFunctionCheckBox" type="checkbox" class="${this._prefix}FilterCheckBox"
                                             style="cursor: pointer" @change="${this.updateConsequenceTypeFilter}" />
                                      LoF terms
                                  </label>
                              </div>
                          </div>
                          <div style="padding-top: 15px">Consequence Type terms:</div>
                          <div class="browser-ct-tree-view browser-ct-item">
                              <ul id="${this._prefix}consequenceTypeFilter">
                                  ${this.consequenceTypes.categories && this.consequenceTypes.categories.length && this.consequenceTypes.categories.map(category => html`
                                      <li id="${category.title ? category.title : category.name}" class="form-check" style="margin-top: 10px;">
                                          ${category.terms && category.terms.length ? html`
                                              <label class="form-check-label notbold">
                                                  <input id="${this._prefix}${category.title}Input" type="checkbox" class="${this._prefix}FilterCheckBox" @change="${this.updateConsequenceTypeFilter}"> ${category.title}
                                              </label>
                                              <ul>
                                                  ${category.terms.map(item => html`
                                                      <li class="form-check">
                                                          <label class="form-check-label notbold">
                                                              <input id="${this._prefix}${item.name}Checkbox" type="checkbox" data-id="${item.name}" class="soTermCheckBox ${this._prefix}FilterCheckBox" @change="${this.updateConsequenceTypeFilter}">
                                                                  <span title="${item.description}">
                                                                      ${item.name} (<a href="http://www.sequenceontology.org/browser/current_svn/term/${item.id}" target="_blank">${item.id}</a>)
                                                                  </span>
                                                          </label>
                                                      </li>
                                                  `)}
                                              </ul>
                                          ` : html`
                                              <input id="${this._prefix}${category.name}Checkbox" type="checkbox"
                                                         data-id="${category.name}" class="soTermCheckBox ${this._prefix}FilterCheckBox" @change="${this.updateConsequenceTypeFilter}">
                                                  <span title="${category.description}">
                                                      ${category.name} (<a href="http://www.sequenceontology.org/browser/current_svn/term/${category.id}" target="_blank">${category.id}</a>)
                                                  </span>
                                          `}
                                      </li>
                                  `)}
                              </ul>
                          </div>
                      </div>
                  `;
      }
      //proteine-substitution-score-filter
      _getProteinSubstitutionScoreHtml() {
          return html`
                      <div style="padding-top: 10px">
                          <span style="padding-left: 0px;">SIFT</span>
                          <div class="row">
                              <div class="col-md-5" style="padding-right: 5px">
                                  <select  name="Sift" id="${this._prefix}SiftValues" class="${this._prefix}FilterSelect form-control input-sm options" @change="${this.checkScore}">
                                      <option value="score" selected>Score...</option>
                                      <option value="tolerated">Tolerated</option>
                                      <option value="deleterious">Deleterious</option>
                                  </select>
                              </div>
                              <div class="col-md-3" style="padding: 0px 5px">
                                  <select name="siftOperator" id="${this._prefix}SiftOperator" class="${this._prefix}FilterSelect form-control input-sm" style="padding: 0px 5px" @change="${this.updateQueryFilters}">
                                      <option value="<"><</option>
                                      <option value="<="><=</option>
                                      <option value=">"selected>></option>
                                      <option value=">=">>=</option>
                                  </select>
                              </div>
                              <div class="col-md-4" style="padding-left: 5px">
                                  <input id="${this._prefix}SiftInput" name="Sift" type="text" value=""
                                              class="${this._prefix}FilterTextInput form-control input-sm" @keyup="${this.updateQueryFilters}">
                              </div>
                          </div>
                      </div>
  
                      <div style="padding-top: 15px">
                          <span style="padding-top: 10px;padding-left: 0px;">Polyphen</span>
                          <div class="row">
                              <div class="col-sm-5" style="padding-right: 5px">
                                  <select name="Polyphen" id="${this._prefix}PolyphenValues" class="${this._prefix}FilterSelect form-control input-sm options" @change="${this.checkScore}">
                                      <option value="score" selected>Score...</option>
                                      <option value="benign">Benign</option>
                                      <option value="unknown">Unknown</option>
                                      <option value="possibly damaging">Possibly damaging</option>
                                      <option value="probably damaging">Probably damaging</option>
                                      <option value="possibly damaging,probably damaging">Possibly & Probably damaging</option>
                                  </select>
                              </div>
                              <div class="col-sm-3" style="padding: 0px 5px">
                                  <select name="polyphenOperator" id="${this._prefix}PolyphenOperator" class="${this._prefix}FilterSelect form-control input-sm" style="padding: 0px 5px" @change="${this.updateQueryFilters}">
                                      <option value=">" selected>></option>
                                      <option value=">=">>=</option>
                                      <option value="<" ><</option>
                                      <option value="<="><=</option>
                                  </select>
                              </div>
                              <div class="col-sm-4" style="padding-left: 5px">
                                  <input type="text" value="" class="${this._prefix}FilterTextInput form-control input-sm"
                                              id="${this._prefix}PolyphenInput" name="Polyphen" @keyup="${this.updateQueryFilters}">
                              </div>
                          </div>
  
                          <form style="padding-top: 15px">
                              <label style="font-weight: normal;">Logical Operator</label>
                              <input type="radio" name="pss" id="${this._prefix}pssOrRadio" value="or" class="${this._prefix}FilterRadio"
                                      checked disabled  style="margin-left: 10px" @change="${this.updateQueryFilters}"> OR<br>
                              <input type="radio" name="pss" id="${this._prefix}pssAndRadio" value="and"
                                      class="${this._prefix}FilterRadio" disabled style="margin-left: 102px" @change="${this.updateQueryFilters}"> AND  <br>
                          </form>
                          <br>
                      </div>
                  `;
      }
  
      //cadd-filter
      _getCaddHtml() {
          return html`
                      <div style="padding-top: 10px">
                          <div class="row">
                              <div class="col-md-5 form-group" style="padding-right: 5px">
                                  <span class="control-label">Raw</span>
                              </div>
                              <div class="col-md-3" style="padding: 0px 5px">
                                  <select name="caddRawOperator" id="${this._prefix}CaddRawOperator"
                                   class="${this._prefix}FilterSelect form-control input-sm" style="padding: 0px 5px" @change="${this.updateQueryFilters}">
                                      <option value="<"><</option>
                                          <option value="<="><=</option>
                                          <option value=">" selected>></option>
                                          <option value=">=">>=</option>
                                  </select>
                              </div>
                              <div class="col-md-4" style="padding-left: 5px">
                                  <input type="text" value="" class="${this._prefix}FilterTextInput form-control input-sm"
                                     id="${this._prefix}CaddRawInput" name="caddRaw" @keyup="${this.updateQueryFilters}">
                              </div>
  
                          </div>
                      </div>
  
                      <div style="padding-top: 10px">
                          <div class="row">
                              <span class="col-md-5 control-label" style="padding-right: 5px">Scaled</span>
                              <div class="col-md-3" style="padding: 0px 5px">
                                  <select name="caddRScaledOperator" id="${this._prefix}CaddScaledOperator"
                                  class="${this._prefix}FilterSelect form-control input-sm" style="padding: 0px 5px" @change="${this.updateQueryFilters}">
                                      <option value="<" selected><</option>
                                      <option value="<="><=</option>
                                      <option value=">">></option>
                                      <option value=">=">>=</option>
                                  </select>
                              </div>
                              <div class="col-md-4" style="padding-left: 5px">
                                  <input type="text" value="" class="${this._prefix}FilterTextInput form-control input-sm"
                                         id="${this._prefix}CaddScaledInput" name="caddScaled" @keyup="${this.updateQueryFilters}">
                              </div>
                          </div>
                      </div>
                  `;
      }
  
      //conservation-filter
      _getConservationHtml() {
          return html`
                      <div style="padding-top: 10px">
                          <div class="row">
                              <span class="col-md-5 control-label" style="padding-right: 5px"> PhyloP</span>
                              <div class="col-md-3" style="padding: 0px 5px">
                                  <select name="phylopOperator" id="${this._prefix}PhylopOperator" class="${this._prefix}FilterSelect form-control input-sm" style="padding: 0px 5px" @change="${this.updateQueryFilters}">
                                      <option value="<"><</option>
                                      <option value="<="><=</option>
                                      <option value=">" selected>></option>
                                      <option value=">=">>=</option>
                                  </select>
                              </div>
                              <div class="col-md-4" style="padding-left: 5px">
                                  <input type="text" value="" class="${this._prefix}FilterTextInput form-control input-sm"
                                     id="${this._prefix}PhylopInput" name="phylop" @keyup="${this.updateQueryFilters}">
                              </div>
                          </div>
                      </div>
  
                       <div style="padding-top: 10px">
                          <div class="row">
                              <span class="col-md-5 control-label" style="padding-right: 5px">PhastCons</span>
                              <div class="col-md-3" style="padding: 0px 5px">
                                  <select name="phastconsOperator" id="${this._prefix}PhastconsOperator"
                                         class="${this._prefix}FilterSelect form-control input-sm" style="padding: 0px 5px" @change="${this.updateQueryFilters}">
                                      <option value="<" ><</option>
                                      <option value="<="><=</option>
                                      <option value=">" selected>></option>
                                      <option value=">=">>=</option>
                                  </select>
                              </div>
                              <div class="col-md-4" style="padding-left: 5px">
                                  <input type="text" value="" class="${this._prefix}FilterTextInput form-control input-sm"
                                     id="${this._prefix}PhastconsInput" name="phastCons" @keyup="${this.updateQueryFilters}">
                              </div>
                          </div>
                      </div>
  
                      <div style="padding-top: 10px">
                          <div class="row">
                              <span class="col-md-5 control-label" style="padding-right: 5px">Gerp</span>
                              <div class="col-md-3" style="padding: 0px 5px">
                                  <select name="gerpOperator" id="${this._prefix}GerpOperator"
                                          class="${this._prefix}FilterSelect form-control input-sm" style="padding: 0px 5px" @change="${this.updateQueryFilters}">
                                      <option value="<"><</option>
                                      <option value="<="><=</option>
                                      <option value=">" selected>></option>
                                      <option value=">=">>=</option>
                                  </select>
                               </div>
                              <div class="col-md-4" style="padding-left: 5px">
                                  <input type="text" value="" class="${this._prefix}FilterTextInput form-control input-sm"
                                          id="${this._prefix}GerpInput" name="gerp" @keyup="${this.updateQueryFilters}">
                              </div>
                          </div>
  
                          <form style="padding-top: 15px">
                              <label style="font-weight: normal;">Logical Operator</label>
                              <input type="radio" name="conservation" id="${this._prefix}conservationOrRadio" value="or"
                                      class="${this._prefix}FilterRadio" checked disabled style="margin-left: 10px" @change="${this.updateQueryFilters}"> OR<br>
                              <input type="radio" name="conservation" id="${this._prefix}conservationAndRadio" value="and"
                                      class="${this._prefix}FilterRadio" disabled style="margin-left: 102px" @change="${this.updateQueryFilters}"> AND<br>
                          </form>
                      </div>
                  `;
      }
  
      //go-accessions-filter
      _getGoAccessionsHtml() {
          return html`
                      <textarea id="${this._prefix}GeneOntologyTextarea" class="form-control clearable ${this._prefix}FilterTextInput"
                                  rows="3" name="geneOntology" placeholder="GO:0000145" @keyup="${this.updateQueryFilters}"></textarea>
                      <span class="input-group-addon btn btn-primary searchingSpan" id="${this._prefix}buttonOpenGoAccesions" @click="${this.openModalGo}">
                          <strong style="color: white">Add GO Term</strong>
                          <i class="fa fa-search searchingButton" aria-hidden="true"></i>
                      </span>
                  `;
      }
  
      //hop-accessions-filter
      _getHpoAccessionsHtml() {
          return html`
                      <textarea id="${this._prefix}HumanPhenotypeOntologyTextarea" class="form-control clearable ${this._prefix}FilterTextInput"
                                  rows="3" name="hpo" placeholder="HP:0000001, HP:3000079" @keyup="${this.updateQueryFilters}"></textarea>
                      <span class="input-group-addon btn btn-primary searchingSpan" id="${this._prefix}buttonOpenHpoAccesions" @click="${this.openModalHpo}">
                          <strong style="color: white">Add HPO Term</strong>
                          <i class="fa fa-search searchingButton" aria-hidden="true"></i>
                      </span>
                       <form style="padding-top: 15px">
                          <label style="font-weight: normal;">Logical Operator</label>
                          <input type="radio" name="hpoRadio" id="${this._prefix}hpoOrRadio" value="or" class="${this._prefix}FilterRadio"
                                  checked style="margin-left: 10px" @change="${this.updateQueryFilters}"> OR<br>
                          <input type="radio" name="hpoRadio" id="${this._prefix}hpoAndRadio" value="and"
                                  class="${this._prefix}FilterRadio" style="margin-left: 102px" @change="${this.updateQueryFilters}"> AND  <br>
                      </form>
                  `;
      }
  
      //clinvar-accessions-filter
      _getClinvarAccessionsHtml() {
          return html`
                      <textarea id="${this._prefix}ClinVarTextarea" class="form-control clearable ${this._prefix}FilterTextInput" rows="3" name="clinvar" placeholder="RCV000058226" @keyup="${this.updateQueryFilters}"></textarea>
                  `;
      }
  
      //fulltext-search-accessions-filter
      _getFullTextSearchAccessionsHtml() {
          return html`
                      <textarea id="${this._prefix}TraitsTextarea" class="form-control clearable ${this._prefix}FilterTextInput" rows="5" name="traits" placeholder="Full-text search, e.g. *melanoma*" @keyup="${this.updateQueryFilters}"></textarea>
                  `;
      }
  */

  /**
   * @deprecated
   * */

  /*
  _addEventListeners() {
       //FIXME ::  NOT present in DOM:
      //     PanelAppsTextarea
      //     FilterTextInput
        let keyupEvents = ["FileQualInput", "LocationTextarea", "FeatureTextarea", "PanelAppsTextarea", "FilterTextInput", "CaddRawInput", "CaddScaledInput", "SiftInput",
          "PolyphenInput", "PhylopInput", "PhastconsInput", "GerpInput", "GeneOntologyTextarea", "HumanPhenotypeOntologyTextarea", "ClinVarTextarea", "TraitsTextarea"];
      for (let id of keyupEvents) {
          let element = PolymerUtils.getElementById(this._prefix + id);
          if (UtilsNew.isNotUndefinedOrNull(element)) {
              element.addEventListener("keyup", this.updateQueryFilters.bind(this));
          }
      }
        // TODO change Type field to VariantType?
      // NOT present in DOM:
      // GenotypeQueryOptions
      // vcfFilterSelect
       let changeEvents = ["includeOtherStudy", "FilePassCheckbox", "FileQualCheckbox", "GenotypeQueryOptions", "DiseasePanels", "GeneBiotypes", "Type", "CaddRawOperator", "CaddScaledOperator", "SiftOperator", "PolyphenOperator",
          "pssOrRadio", "pssAndRadio", "PhylopOperator", "PhastconsOperator", "GerpOperator", "conservationAndRadio", "conservationOrRadio", "vcfFilterSelect",
          "hpoOrRadio", "hpoAndRadio"];
      for (let id of changeEvents) {
          let element = PolymerUtils.getElementById(this._prefix + id);
          if (UtilsNew.isNotUndefinedOrNull(element)) {
              element.addEventListener("change", this.updateQueryFilters.bind(this));
          }
      }
        // Add events for Feature IDs
      PolymerUtils.getElementById(this._prefix + "FeatureIdText").addEventListener("keyup", this.callAutocomplete.bind(this));
      PolymerUtils.getElementById(this._prefix + "FeatureAddButton").addEventListener("click", this.addFeatureId.bind(this));
        // Add events for Sample IDs
      let elementById = PolymerUtils.getElementById(this._prefix + "SampleFilterModalButton");
      if (UtilsNew.isNotUndefinedOrNull(elementById)) {
          elementById.addEventListener("click", this.onSampleFilterClick.bind(this));
      }
        // Add events for Studies checkboxes
       if (UtilsNew.isNotUndefinedOrNull(this.differentStudies)) {
          for (let study of this.differentStudies) {
              let element = PolymerUtils.getElementById(this._prefix + study.alias + "Checkbox");
              if (UtilsNew.isNotUndefinedOrNull(element)) {
                  element.addEventListener("change", this.updateQueryFilters.bind(this));
              }
          }
      }
       // Add events for Cohort
      for (let section of this.config.menu.sections) {
          for (let subsection of section.subsections) {
              if (subsection.id === "cohort") {
                  let projectId = this.opencgaSession.project.id;
                  if (UtilsNew.isNotUndefinedOrNull(subsection.cohorts[projectId])) {
                      for (let study of Object.keys(subsection.cohorts[projectId])) {
                          for (let cohort of subsection.cohorts[projectId][study]) {
                              let element = PolymerUtils.getElementById(this._prefix + study + cohort.id + "CohortOperator");
                              if (UtilsNew.isNotUndefinedOrNull(element)) {
                                  element.addEventListener("change", this.updateQueryFilters.bind(this));
                              }
                              element = PolymerUtils.getElementById(this._prefix + study + cohort.id + "Cohort");
                              if (UtilsNew.isNotUndefinedOrNull(element)) {
                                  element.addEventListener("keyup", this.updateQueryFilters.bind(this));
                              }
                          }
                      }
                  }
              }
          }
      }
       // Add events for Population Frequency
      for (let study of this.populationFrequencies.studies) {
          let element = PolymerUtils.getElementById(this._prefix + study.id + "Icon");
          let inputAll = PolymerUtils.getElementById(this._prefix + study.id + "Input");
          if (UtilsNew.isNotUndefinedOrNull(element)) {
              element.addEventListener("click", this.handleCollapseAction.bind(this));
          }
           if (UtilsNew.isNotUndefinedOrNull(inputAll)) {
              inputAll.addEventListener("keyup", this.keyUpAllPopFreq.bind(this));
              inputAll.addEventListener("change", this.updateQueryFilters.bind(this));
          }
           for (let pop of study.populations) {
              PolymerUtils.getElementById(this._prefix + study.id + pop.id).addEventListener("keyup", this.updateQueryFilters.bind(this));
              PolymerUtils.getElementById(this._prefix + study.id + pop.id + "Operator").addEventListener("change", this.updateQueryFilters.bind(this));
          }
      }
       // Add events Protein substitution score
      PolymerUtils.getElementById(this._prefix + "SiftValues").addEventListener("change", this.checkScore.bind(this));
      PolymerUtils.getElementById(this._prefix + "PolyphenValues").addEventListener("change", this.checkScore.bind(this));
       // Add events consequence type
      PolymerUtils.getElementById(this._prefix + "LossOfFunctionCheckBox").addEventListener("change", this.updateConsequenceTypeFilter.bind(this));
      if (UtilsNew.isNotEmptyArray(consequenceTypes.categories)) {
          consequenceTypes.categories.forEach((category) => {
              let title = (category.title !== undefined) ? category.title : category.name;
              if (UtilsNew.isNotEmptyArray(category.terms)) {
                  PolymerUtils.getElementById(this._prefix + title + "Input").addEventListener("change", this.updateConsequenceTypeFilter.bind(this));
                  category.terms.forEach((item) => {
                      PolymerUtils.getElementById(this._prefix + item.name + "Checkbox").addEventListener("change", this.updateConsequenceTypeFilter.bind(this));
                  });
              } else {
                  PolymerUtils.getElementById(this._prefix + title + "Checkbox").addEventListener("change", this.updateConsequenceTypeFilter.bind(this));
              }
          });
      }
       // Add events GO accessions
      let goModalButton = PolymerUtils.getElementById(this._prefix + "buttonOpenGoAccesions");
      if (UtilsNew.isNotUndefinedOrNull(goModalButton)) {
          goModalButton.addEventListener("click", this.openModalGo.bind(this));
      }
       // Add events hpo accessions
      let hpoModalButton = PolymerUtils.getElementById(this._prefix + "buttonOpenHpoAccesions");
      if (UtilsNew.isNotUndefinedOrNull(hpoModalButton)) {
          hpoModalButton.addEventListener("click", this.openModalHpo.bind(this));
      }
  }
  */


  _addAllTooltips() {
    for (let section of this.config.sections) {
      for (let subsection of section.subsections) {
        if (utilsNew_UtilsNew.isNotEmpty(subsection.tooltip)) {
          let tooltipIcon = $("#" + this._prefix + subsection.id + "Tooltip");

          if (utilsNew_UtilsNew.isNotUndefinedOrNull(tooltipIcon)) {
            this._addTooltip(tooltipIcon, subsection.title, subsection.tooltip);
          }
        }
      }
    }
  }

  _addTooltip(div, title, content) {
    div.qtip({
      content: {
        title: title,
        text: content
      },
      position: {
        target: "mouse",
        adjust: {
          x: 2,
          y: 2,
          mouse: false
        }
      },
      style: {
        width: true //classes: this.config.tooltip.classes

      },
      show: {
        delay: 200
      },
      hide: {
        fixed: true,
        delay: 300
      }
    });
  }

  render() {
    return lit_html_lit_html_html(_templateObject24(), this.searchButton ? lit_html_lit_html_html(_templateObject25(), this.onSearch, this.config.searchButtonText) : null, this._prefix, this._renderFilterMenu(), this._prefix, this.propagateOkHPO, this.ontologyFilter, this.ontologyTerm, this.selectedTermsOntology);
  }

}
customElements.define("opencga-variant-filter", opencga_variant_filter_OpencgaVariantFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/commons/opencga-facet-result-view.js
function opencga_facet_result_view_templateObject9() {
  const data = opencga_facet_result_view_taggedTemplateLiteral(["\n                        <tr>\n                            <td>", "</td>\n                            <td>", "</td>\n                        </tr>\n                    "]);

  opencga_facet_result_view_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function opencga_facet_result_view_templateObject8() {
  const data = opencga_facet_result_view_taggedTemplateLiteral(["\n                <!-- Facet Range Table -->\n                <thead class=\"table-header bg-primary\">\n                    <tr>\n                        <th>Range</th>\n                        <th>Number of Variants</th>\n                    </tr>\n                    </thead>\n                    <tbody>\n                    ", "\n                </tbody>\n               "]);

  opencga_facet_result_view_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_facet_result_view_templateObject7() {
  const data = opencga_facet_result_view_taggedTemplateLiteral(["\n                                <tr>\n                                    <td>", "}</td>\n                                    <td>", "}</td>\n                                </tr>\n                            "]);

  opencga_facet_result_view_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_facet_result_view_templateObject6() {
  const data = opencga_facet_result_view_taggedTemplateLiteral(["\n                                    <tr>\n                                        <td>", "</td>\n                                        <td>", "</td>\n                                    </tr>\n                                "]);

  opencga_facet_result_view_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_facet_result_view_templateObject5() {
  const data = opencga_facet_result_view_taggedTemplateLiteral(["\n                                <tr>\n                                    <td rowspan=\"", "\">", "</td>\n                                </tr>\n                                ", "\n                            "]);

  opencga_facet_result_view_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_facet_result_view_templateObject4() {
  const data = opencga_facet_result_view_taggedTemplateLiteral(["\n                            ", "                              \n                        "]);

  opencga_facet_result_view_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_facet_result_view_templateObject3() {
  const data = opencga_facet_result_view_taggedTemplateLiteral(["\n                                <th>", "</th>\n                            "]);

  opencga_facet_result_view_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_facet_result_view_templateObject2() {
  const data = opencga_facet_result_view_taggedTemplateLiteral(["\n                    <thead class=\"table-header bg-primary\">\n                        <tr>\n                            <th>", "}</th>\n                            ", "\n                            <th>Number of Variants</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        ", "\n                      \n                    </tbody>\n                "]);

  opencga_facet_result_view_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_facet_result_view_templateObject() {
  const data = opencga_facet_result_view_taggedTemplateLiteral(["\n        <style include=\"jso-styles\"></style>\n        <div style=\"padding: 5px 10px\">\n            <!--<h3>{{facetResult.name}}</h3>-->\n            <div class=\"btn-group\" style=\"float: right\">\n                <span id=\"", "HistogramChartButton\" class=\"btn btn-primary plots active\" @click=\"", "\">\n                    <i class=\"fas fa-chart-bar\" style=\"padding-right: 5px\" title=\"Bar Chart\" data-id=\"", "\"></i>\n                </span>\n                <span id=\"", "PieChartButton\" class=\"btn btn-primary plots\" @click=\"", "\">\n                    <i class=\"fas fa-chart-pie\" style=\"padding-right: 5px\" title=\"Pie Chart\" data-id=\"", "\"></i>\n                </span>\n                <!--<span id=\"", "TableButton\" class=\"btn btn-primary plots\" @click=\"", "\">-->\n                    <!--<i class=\"fa fa-table\" style=\"padding-right: 5px\" title=\"Tabular View\" data-id=\"", "\"></i>-->\n                <!--</span>-->\n            </div>\n            <div id=\"", "Plot\"></div>\n\n            <!--Table-->\n            <br>\n            <table id=\"", "Table\" class=\"table table-bordered\" style=\"display: none;\">               \n                <!-- Facet Field Table -->\n                ", "\n            </table>\n        </div>\n        "]);

  opencga_facet_result_view_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_facet_result_view_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



 //TODO fixbug querying opencga-client PhastCons - 1kG_phase3_EAS

class opencga_facet_result_view_OpencgaFacetResultView extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      facetResult: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }
  /**
   * Init the variables you need, keep in mind this is executed before the actual Polymer properties exist
   */


  _init() {
    // All id fields in the template must start with prefix, this allows components to be instantiated more than once
    this._prefix = "ofv" + utils.randomString(6);
    this.plotDiv = "#" + this._prefix + "Plot"; // Initially we set the default config, this will be overridden if 'config' is passed

    this._config = this.getDefaultConfig();
  }

  updated(changedProperties) {
    console.log("this.facetResult", this.facetResult);

    if (changedProperties.has("facetResult") || changedProperties.has("config")) {
      this.renderFacets();
    }
  }
  /*connectedCallback() {
      super.connectedCallback();
       this.renderFacets();
  }*/


  renderFacets(e, conf) {
    this._config = Object.assign(this.getDefaultConfig(), this.config);
    this.renderHistogramChart();
  } // onHistogramChart() {
  //     // this.highlightActivePlot(e.target.parentElement);
  //     // let id = e.target.dataId;
  //     //TODO Refactor
  //     // debugger
  //     this.renderHistogramChart("#" + this._prefix + "Plot");
  //
  //     PolymerUtils.hide(this._prefix + "Table");
  // }


  onPieChart(e) {
    // this.highlightActivePlot(e.target.parentElement);
    // let id = e.target.dataId;
    this.renderPieChart("#" + this._prefix + "Plot");
    PolymerUtils_PolymerUtils.hide(this._prefix + "Table");
  }

  onTabularView(e) {
    // this.highlightActivePlot(e.target.parentElement);
    // let id = e.target.dataId;
    PolymerUtils_PolymerUtils.innerHTML(this._prefix + "Plot", "");
    PolymerUtils_PolymerUtils.show(this._prefix + "Table", "table");
  }

  highlightActivePlot(button) {// PolymerUtils.removeClass(".plots", "active");
    // PolymerUtils.addClass(button, "active");
  }

  renderHistogramChart(e) {
    PolymerUtils_PolymerUtils.hide(this._prefix + "Table"); // PolymerUtils.removeStyleByClass("plots", "active");
    // PolymerUtils.removeClass(this._prefix + "HistogramChartButton", "active");

    PolymerUtils_PolymerUtils.removeClass(".plots", "active"); //this.querySelector(this._prefix + "HistogramChartButton").classList.add("active");

    let params = this._getHistogramData();

    $(this.plotDiv).highcharts({
      credits: {
        enabled: false
      },
      chart: {
        type: "column"
      },
      title: {
        text: params.title || params.name
      },
      xAxis: {
        categories: params.categories
      },
      yAxis: {
        min: 0,
        title: {
          text: "Total number of Variants"
        }
      },
      tooltip: {
        headerFormat: "<span style=\"font-size:10px\">{point.key}</span><table>",
        pointFormat: "<tr><td style=\"color:{series.color};padding:0\">{series.name}: </td>" + "<td style=\"padding:0\"><b>{point.y:.1f} </b></td></tr>",
        footerFormat: "</table>",
        shared: true,
        useHTML: true
      },
      plotOptions: {
        column: {
          pointPadding: 0.2,
          borderWidth: 0
        }
      },
      series: params.series
    });
  }

  renderPieChart(div, id) {
    let params;
    let renderDonut = false;

    if (utilsNew_UtilsNew.isNotUndefined(this.facetResult) && utilsNew_UtilsNew.isNotUndefined(this.facetResult.buckets[0].fields)) {
      params = this._getDonutData(id);
      renderDonut = true;
    } else {
      params = this._getPieData(id);
    }

    if (renderDonut) {
      $(this.plotDiv).highcharts({
        credits: {
          enabled: false
        },
        chart: {
          type: "pie"
        },
        title: {
          text: params.title || params.name
        },
        plotOptions: {
          pie: {
            shadow: false,
            center: ["50%", "50%"]
          }
        },
        series: params.series
      });
    } else {
      $(div).highcharts({
        credits: {
          enabled: false
        },
        chart: {
          plotBackgroundColor: null,
          plotBorderWidth: null,
          plotShadow: false,
          type: "pie"
        },
        title: {
          text: params.title
        },
        tooltip: {
          pointFormat: "{series.name}: <b>{point.percentage:.1f}%</b>"
        },
        plotOptions: {
          pie: {
            allowPointSelect: true,
            cursor: "pointer",
            dataLabels: {
              enabled: false
            },
            showInLegend: true
          }
        },
        series: params.series
      });
    }
  }

  _getHistogramData() {
    let params;

    if (this.facetResult.start === undefined) {
      let field = this.facetResult; // let fields = field.name.split("-");
      // let title = [];
      // if (fields.length > 1) {
      //     for (let name of fields) {
      //         title.push(this.fieldNamesMap[name]);
      //     }
      // } else {
      //     title.push(this.fieldNamesMap[field.name]);
      // }

      let obj = {
        title: field.name,
        name: field.name,
        categories: [],
        series: []
      };
      let series = {};
      let data = [];

      for (let i = 0; i < field.buckets.length; i++) {
        let bucket = field.buckets[i];
        obj.categories.push(bucket.value);

        if (utilsNew_UtilsNew.isNotEmptyArray(bucket.fields)) {
          let nestedField = bucket.fields[0];
          obj.nestedField = nestedField.name;

          for (let nestedCountObj of nestedField.buckets) {
            if (utilsNew_UtilsNew.isUndefined(series[nestedCountObj.value])) {
              series[nestedCountObj.value] = [];
            } // It is important to push 'index' as we need to take care of the missing values


            series[nestedCountObj.value].push({
              index: i,
              count: nestedCountObj.count
            });
          }
        } else {
          data.push(bucket.count);
        }
      }

      if (Object.keys(series).length > 0) {
        for (let key in series) {
          let data = [];

          for (let countIndex of series[key]) {
            data[countIndex.index] = countIndex.count;
          }

          for (let i = 0; i < data.length; i++) {
            if (utilsNew_UtilsNew.isUndefined(data[i])) {
              data[i] = 0; // Setting '0' for missing fields
            }
          }

          obj.series.push({
            name: key,
            data: data
          });
        }
      } else {
        obj.series.push({
          name: field.name,
          data: data
        });
      }

      params = obj;
    } else if (this.facetResult.start !== undefined) {
      let range = this.facetResult;
      let obj = {
        name: range.name,
        title: this.fieldNamesMap[range.name] || range.name,
        categories: [],
        series: []
      };
      let data = [];
      let start = Number(range.start);

      for (let rangeCount of range.counts) {
        if (Math.round(start) !== start) {
          start = Number(start.toFixed(1));
        }

        let end = Number(start + range.gap);

        if (Math.round(end) !== end) {
          end = Number(end.toFixed(1));
        }

        obj.categories.push(start + "-" + end);
        data.push(rangeCount);
        start = end;
      }

      obj.series.push({
        name: range.name,
        data: data
      });
      params = obj;
    }

    return params;
  }

  _getPieData() {
    let field = this.facetResult;
    let pieData = {
      name: field.name,
      // title: this.fieldNamesMap[field.name],
      title: field.name,
      series: []
    };
    let data = [];

    for (let bucket of field.buckets) {
      data.push({
        name: bucket.value,
        y: bucket.count
      });
    }

    pieData.series.push({
      name: field.name,
      colorByPoint: true,
      data: data
    });
    return pieData;
  }

  _getDonutData() {
    let field = this.facetResult;
    let fields = field.name.split("-");
    let title = []; // if (fields.length > 1) {
    //     for (let name of fields) {
    //         title.push(this.fieldNamesMap[name]);
    //     }
    // } else {
    //     title.push(this.fieldNamesMap[field.name]);
    // }

    let donutData = {
      name: field.name,
      title: title.join(" - "),
      series: []
    };
    let colors = Highcharts.getOptions().colors;
    let categories = [];
    let data = [];

    for (let i = 0; i < field.buckets.length; i++) {
      let bucket = field.buckets[i];
      categories.push(bucket.value);
      let subField = bucket.fields;
      let subCategories = [];
      let subData = [];

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(subField[0])) {
        for (let bucket of subField[0].buckets) {
          subCategories.push(bucket.value);
          subData.push(bucket.count);
        }
      }

      data.push({
        y: bucket.count,
        color: colors[i],
        drilldown: {
          name: subField.name,
          categories: subCategories,
          data: subData,
          color: colors[i]
        }
      });
    }

    let levelOneData = [];
    let levelTwoData = []; // Build the data arrays

    for (let i = 0; i < data.length; i++) {
      // add level one data
      levelOneData.push({
        name: categories[i],
        y: data[i].y,
        color: data[i].color
      }); // add level two data

      let drillDataLen = data[i].drilldown.data.length;

      for (let j = 0; j < drillDataLen; j++) {
        let brightness = 0.2 - j / drillDataLen / 5;
        levelTwoData.push({
          name: data[i].drilldown.categories[j],
          y: data[i].drilldown.data[j],
          color: Highcharts.Color(data[i].color).brighten(brightness).get()
        });
      }
    }

    let [levelOneField, levelTwoField] = field.name.split("-");
    donutData.series.push({
      name: levelOneField,
      data: levelOneData,
      size: "60%",
      dataLabels: {
        formatter: function formatter() {
          return this.y > 5 ? this.point.name : null;
        },
        color: "#ffffff",
        distance: -30
      }
    });
    donutData.series.push({
      name: levelTwoField,
      data: levelTwoData,
      size: "80%",
      innerSize: "60%",
      dataLabels: {
        formatter: function formatter() {
          // display only if larger than 1
          return this.y > 1 ? "<b>" + this.point.name + ":</b> " + this.y : null;
        }
      }
    });
    return donutData;
  }

  subFieldExists(field) {
    return utilsNew_UtilsNew.isNotEmpty(field);
  }

  fieldExists(countObj) {
    return utilsNew_UtilsNew.isNotUndefined(countObj.field);
  }

  countSubFields(countObj) {
    return countObj.field.counts.length + 1;
  }

  getDefaultConfig() {
    return {
      property: "example property"
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_facet_result_view_templateObject(), this._prefix, this.renderHistogramChart, this.facetResult.name, this._prefix, this.onPieChart, this.facetResult.name, this._prefix, this.onTabularView, this.facetResult.name, this._prefix, this._prefix, this.facetResult.category ? lit_html_lit_html_html(opencga_facet_result_view_templateObject2(), this.facetResult.title, this.subFieldExists(this.facetResult.subField) ? lit_html_lit_html_html(opencga_facet_result_view_templateObject3(), this.facetResult.subField) : null, this.facetResult.buckets && this.facetResult.buckets ? this.facetResult.buckets.map(count => lit_html_lit_html_html(opencga_facet_result_view_templateObject4(), this.fieldExists(count) ? lit_html_lit_html_html(opencga_facet_result_view_templateObject5(), this.countSubFields(count), count.value, count.field.counts && count.field.counts.length ? count.field.counts.map(subFieldCount => lit_html_lit_html_html(opencga_facet_result_view_templateObject6(), subFieldCount.value, subFieldCount.count)) : null) : lit_html_lit_html_html(opencga_facet_result_view_templateObject7(), count.value, count.count))) : null) : lit_html_lit_html_html(opencga_facet_result_view_templateObject8(), this.facetResult.data && this.facetResult.data.length ? this.facetResult.data.map(data => lit_html_lit_html_html(opencga_facet_result_view_templateObject9(), data.range, data.count)) : null));
  }

}
customElements.define("opencga-facet-result-view", opencga_facet_result_view_OpencgaFacetResultView);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/opencga-active-filters.js
function opencga_active_filters_templateObject19() {
  const data = opencga_active_filters_taggedTemplateLiteral(["\n                                    <button type=\"button\" class=\"btn btn-danger btn-sm ", "ActiveFilter active-filter-button ripple no-transform\" data-filter-name=\"", "\" data-filter-value=\"\"\n                                                 @click=\"", "\">\n                                        ", "\n                                    </button>\n                            "]);

  opencga_active_filters_templateObject19 = function _templateObject19() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject18() {
  const data = opencga_active_filters_taggedTemplateLiteral(["\n                    <div class=\"facet-wrapper\">\n                        <p class=\"active-filter-label\">Aggregation fields</p>\n                            <div class=\"button-list\">\n                                ", "\n                            </div>\n                            <button type=\"button\" class=\"btn btn-primary ripple pull-right\" @click=\"", "\">\n                                <i class=\"fa fa-eraser\" aria-hidden=\"true\" style=\"padding-right: 5px\"></i> Clear\n                            </button>\n                        </div>\n                "]);

  opencga_active_filters_templateObject18 = function _templateObject18() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject17() {
  const data = opencga_active_filters_taggedTemplateLiteral([""]);

  opencga_active_filters_templateObject17 = function _templateObject17() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject16() {
  const data = opencga_active_filters_taggedTemplateLiteral(["\n                                    <li role=\"separator\" class=\"divider\"></li>\n                                    <li>\n                                        <a style=\"cursor: pointer\" @click=\"", "\"><i class=\"fa fa-floppy-o\" aria-hidden=\"true\"></i> Save...</a>\n                                    </li>\n                                "]);

  opencga_active_filters_templateObject16 = function _templateObject16() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject15() {
  const data = opencga_active_filters_taggedTemplateLiteral(["\n                                            <a data-filter-name=\"", "\" style=\"cursor: pointer;color: green\" @click=\"", "\" class=\"filtersLink\">&nbsp;&nbsp;", "</a>\n                                        "]);

  opencga_active_filters_templateObject15 = function _templateObject15() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject14() {
  const data = opencga_active_filters_taggedTemplateLiteral(["\n                                            <a data-filter-name=\"", "\" style=\"cursor: pointer\" @click=\"", "\" class=\"filtersLink\">&nbsp;&nbsp;", "</a>"]);

  opencga_active_filters_templateObject14 = function _templateObject14() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject13() {
  const data = opencga_active_filters_taggedTemplateLiteral(["\n                                    <li> <!-- TODO recheck and simplify!!-->\n                                        ", "\n                                    </li>\n                                "]);

  opencga_active_filters_templateObject13 = function _templateObject13() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject12() {
  const data = opencga_active_filters_taggedTemplateLiteral(["\n                        <div class=\"dropdown\">\n\n                            <button type=\"button\" class=\"btn btn-primary dropdown-toggle ripple\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                                <i class=\"fa fa-filter\" aria-hidden=\"true\" style=\"padding-right: 5px\"></i> Filters <span class=\"caret\"></span>\n                            </button>\n                            <ul class=\"dropdown-menu dropdown-menu-right\">\n                                <li><a style=\"font-weight: bold\">Saved Filters</a></li>\n                                <!--TODO check why filter is initialized (init()) but I still need to check for truthy-->\n                                ", "\n                                ", "\n                            </ul>\n                        </div>\n                    "]);

  opencga_active_filters_templateObject12 = function _templateObject12() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject11() {
  const data = opencga_active_filters_taggedTemplateLiteral(["\n                                            <li class=\"small active-filter-button\" style=\"cursor: pointer\">\n                                                <a @click=\"", "\" data-filter-name=\"", "\" data-filter-value=\"", "\">\n                                                    ", " \n                                                </a>\n                                            </li>\n                                        "]);

  opencga_active_filters_templateObject11 = function _templateObject11() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject10() {
  const data = opencga_active_filters_taggedTemplateLiteral(["\n                                <!-- Multi-valued filters -->\n                                <div class=\"btn-group\">\n                                    <button type=\"button\" class=\"btn btn-warning btn-sm ", "ActiveFilter active-filter-button ripple no-transform\" data-filter-name=\"", "\" data-filter-value=\"\"\n                                            @click=\"", "\" @mouseover=\"", "\" @mouseout=\"", "\" >\n                                        ", " <span class=\"badge\">", "</span>\n                                    </button>\n                                    <button type=\"button\" class=\"btn btn-warning btn-sm dropdown-toggle ripple no-transform\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                                        <span class=\"caret\"></span>\n                                        <span class=\"sr-only\">Toggle Dropdown</span>\n                                    </button>\n                                    <ul class=\"dropdown-menu\">\n                                        ", "\n                                    </ul>\n                                </div>\n                            "]);

  opencga_active_filters_templateObject10 = function _templateObject10() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject9() {
  const data = opencga_active_filters_taggedTemplateLiteral(["\n                                <button type=\"button\" class=\"btn btn-warning btn-sm ", "ActiveFilter active-filter-button ripple no-transform\" data-filter-name=\"", "\" data-filter-value=\"\"\n                                         @click=\"", "\" title=\"", "\" disabled>\n                                    ", "\n                                </button>\n                            "]);

  opencga_active_filters_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject8() {
  const data = opencga_active_filters_taggedTemplateLiteral(["\n                                <!-- No multi-valued filters -->\n                                <button type=\"button\" class=\"btn btn-warning btn-sm ", "ActiveFilter active-filter-button ripple no-transform\" data-filter-name=\"", "\" data-filter-value=\"\"\n                                        @click=\"", "\">\n                                ", "\n                                </button>\n                            "]);

  opencga_active_filters_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject7() {
  const data = opencga_active_filters_taggedTemplateLiteral([" \n                            ", ""]);

  opencga_active_filters_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject6() {
  const data = opencga_active_filters_taggedTemplateLiteral(["\n                        ", "\n                    "]);

  opencga_active_filters_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject5() {
  const data = opencga_active_filters_taggedTemplateLiteral(["\n                            <label>No filters selected</label>\n                        "]);

  opencga_active_filters_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject4() {
  const data = opencga_active_filters_taggedTemplateLiteral(["\n                        ", "\n                "]);

  opencga_active_filters_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject3() {
  const data = opencga_active_filters_taggedTemplateLiteral(["\n            <div class=\"alert alert-warning filter-warning\" role=\"alert\" id=\"", "Warning\" style=\"\">\n                <span style=\"font-weight: bold;font-size: 1.20em\">Warning!</span>&nbsp;&nbsp;Filters changed, please click on <button type=\"button\" class=\"btn btn-primary ripple ripple-disabled\">\n                    <i class=\"fa fa-search\" aria-hidden=\"true\"></i> Search </button> to update the results.\n            </div>\n        "]);

  opencga_active_filters_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject2() {
  const data = opencga_active_filters_taggedTemplateLiteral(["\n            <div class=\"alert alert-warning filter-warning\" role=\"alert\" id=\"", "Warning\" style=\"\">\n                <span style=\"font-weight: bold;font-size: 1.20em\">Warning!</span>&nbsp;&nbsp;Filters or Facet has changed, please click on <button type=\"button\" class=\"btn btn-primary ripple ripple-disabled\">\n                    <i class=\"fa arrow-circle-right\" aria-hidden=\"true\"></i> Run </button> to update the results.\n            </div>"]);

  opencga_active_filters_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_active_filters_templateObject() {
  const data = opencga_active_filters_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .active-filter-button:hover {\n                text-decoration: line-through;\n            }\n\n            .facet-wrapper{\n                margin: 20px 0 0 0;\n            }\n\n            .double-arrow {\n                transform: rotate(90deg);\n                width: 60px;\n                display: block;\n                margin: 0 auto;\n                height: 60px;\n            }\n\n            .double-arrow-wrapper {\n                display: flex;\n                margin: 5px 0;\n            }\n\n            .button-list{\n                padding-left: 20px;\n                display: inline-block;\n            }\n\n            .active-filter-label{\n                display: inline-block;\n                font-size: 15px;\n                text-transform: uppercase;\n                letter-spacing: 2px;\n                height: 34px;\n                line-height: 34px;\n                margin: 0;\n            }\n\n            .rhs {\n                float: right;\n            }\n\n            .rhs .dropdown {\n                display: inline-block;\n            }\n            \n            .filter-warning {\n                padding: 10px;\n                margin-bottom: 10px;\n                display: none;                \n            }\n        </style>\n        ", "\n        \n\n        <div class=\"panel panel-default\" style=\"margin-bottom: 5px\">\n            <div class=\"panel-body\">\n                <p class=\"active-filter-label\">Filters</p>\n                \n                <div class=\"button-list\">\n                    ", "\n                </div>\n                <div class=\"rhs\">\n                    <button type=\"button\" class=\"btn btn-primary ripple\" @click=\"", "\">\n                        <i class=\"fa fa-eraser\" aria-hidden=\"true\" style=\"padding-right: 5px\"></i> Clear\n                    </button>\n                    \n                    <!-- TODO we probably need a new property for this -->\n                    ", "\n                </div>\n                <!-- aggregation stat section -->\n                ", "\n            </div>\n        </div>\n\n        <!-- Modal -->\n        <div class=\"modal fade\" id=\"", "SaveModal\" tabindex=\"-1\" role=\"dialog\"\n             aria-labelledby=\"", "SaveModalLabel\" aria-hidden=\"true\">\n            <div class=\"modal-dialog\" role=\"document\">\n                <div class=\"modal-content\">\n                    <div class=\"modal-header\">\n                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                            <span aria-hidden=\"true\">&times;</span>\n                        </button>\n                        <h4 class=\"modal-title\" id=\"", "SaveModalLabel\">Filter</h4>\n                    </div>\n                    <div class=\"modal-body\">\n                        <div class=\"form-group row\">\n                            <label for=\"filterName\" class=\"col-xs-2 col-form-label\">Name</label>\n                            <div class=\"col-xs-10\">\n                                <input class=\"form-control\" type=\"text\" id=\"", "filterName\">\n                            </div>\n                        </div>\n                        <div class=\"form-group row\">\n                            <label for=\"", "filterDescription\" class=\"col-xs-2 col-form-label\">Description</label>\n                            <div class=\"col-xs-10\">\n                                <input class=\"form-control\" type=\"text\" id=\"", "filterDescription\">\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"modal-footer\">\n                        <button type=\"button\" class=\"btn btn-primary\" data-dismiss=\"modal\" @click=\"", "\">Save</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        "]);

  opencga_active_filters_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_active_filters_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_active_filters_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_active_filters_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_active_filters_ownKeys(Object(source), true).forEach(function (key) { opencga_active_filters_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_active_filters_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_active_filters_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */





class opencga_active_filters_OpencgaActiveFilters extends lit_element_lit_element_LitElement {
  constructor() {
    super();
    this.init();
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      //NOTE this is actually preparedQuery (in case of variant-browser)
      query: {
        type: Object
      },
      // this is included in config param in case of variant-browser (it can be different somewhere else)
      filters: {
        type: Array
      },
      filterBioformat: {
        type: String
      },
      alias: {
        type: Object
      },
      defaultStudy: {
        type: String
      },
      refresh: {
        type: Object
      },
      config: {
        type: Object
      },
      facetActive: {
        type: Boolean
      },
      facetQuery: {
        type: Object
      }
    };
  }

  createRenderRoot() {
    return this;
  }

  updated(changedProperties) {
    if (changedProperties.has("query")) {
      this.queryObserver();
    }

    if (changedProperties.has("refresh")) {
      this.searchClicked();
    }

    if (changedProperties.has("config")) {
      this.configObserver();
    }

    if (changedProperties.has("opencgaSession")) {
      this.checkFilters(this.config);
    }

    if (changedProperties.has("facetQuery")) {
      //TODO review queryObserver and unify the behaviour of the Warning alert
      this.facetQueryObserver();
    }
  }

  init() {
    this._prefix = "oaf" + utils.randomString(6) + "_";
    this._config = this.getDefaultConfig();
    this.filters = []; //todo recheck why function?

    this.opencgaClient = function () {
      return {
        "_config": {}
      };
    };

    this.query = {};
    this.lockedFieldsMap = {};
    this.facetQuery = {};
    this._facetQuery = {};
  }

  connectedCallback() {
    super.connectedCallback();
    this.opencgaClient = this.opencgaSession.opencgaClient;
  } //TODO recheck connectedCallback


  firstUpdated() {
    //super.connectedCallback();
    // Small trick to force the warning message display after DOM is renderer
    this.query = opencga_active_filters_objectSpread({}, this.query); // We need to init _previousQuery with query in order to work before executing any search

    this._previousQuery = this.query; //console.log("CONFIG", this.filters)
    // If there is any active filter we set the first one in the initialisation

    if (typeof this.filters !== "undefined" && utilsNew_UtilsNew.isEmpty(this.query)) {
      for (let filter of this.filters) {
        if (filter.active) {
          let _queryList = Object.assign({}, filter.query);

          this.dispatchEvent(new CustomEvent("activeFilterChange", {
            detail: _queryList,
            bubbles: true,
            composed: true
          }));
          break;
        }
      }
    }
  }

  configObserver() {
    this._config = Object.assign({}, this.getDefaultConfig(), this.config); // Overwrite default alias with the one passed

    this._config.alias = Object.assign({}, this.getDefaultConfig().alias, this.config.alias);
    this.lockedFieldsMap = {};

    for (let lockedField of this._config.lockedFields) {
      this.lockedFieldsMap[lockedField.id] = lockedField;
    }
  }

  facetQueryObserver() {
    if (JSON.stringify(this._facetQuery) !== JSON.stringify(this.facetQuery)) {
      this.querySelector("#" + this._prefix + "Warning").style.display = "block";
      this._facetQuery = this.facetQuery;
    } else {
      this.querySelector("#" + this._prefix + "Warning").style.display = "none";
    }
  }

  clear() {
    PolymerUtils_PolymerUtils.addStyleByClass("filtersLink", "color", "black"); //TODO do not trigger event if there are no active filters
    // Trigger clear event

    this.dispatchEvent(new CustomEvent("activeFilterClear", {
      detail: {},
      bubbles: true,
      composed: true
    }));
  }

  clearFacet() {
    this.querySelector("#" + this._prefix + "Warning").style.display = "none";
    this.dispatchEvent(new CustomEvent("activeFacetClear", {
      detail: {},
      bubbles: true,
      composed: true
    }));
  } //todo refactor in CSS


  _onMouseOver(e) {
    PolymerUtils_PolymerUtils.addStyleByClass(e.target.dataset.filterName + "ActiveFilter", "text-decoration", "line-through");
  }

  _onMouseOut(e) {
    PolymerUtils_PolymerUtils.addStyleByClass(e.target.dataset.filterName + "ActiveFilter", "text-decoration", "none");
  }

  launchModal() {
    $(PolymerUtils_PolymerUtils.getElementById(this._prefix + "SaveModal")).modal("show");
  }

  showSelectFilters(config) {
    return this.filters !== undefined && this.filters.length > 0 || !utilsNew_UtilsNew.isEmpty(config.sessionId);
  }

  checkSid(config) {
    return utilsNew_UtilsNew.isNotEmpty(config.sessionId);
  }

  checkFilters(config) {
    let _this = this;

    if (this.opencgaClient instanceof opencga_client_OpenCGAClient && utilsNew_UtilsNew.isNotUndefined(config.value.sessionId)) {
      console.error("arguments changed inverted after new clients. recheck functionality. serverVersion is now ignored");
      this.opencgaClient.users().filtersConfigs(this.opencgaSession.user.id).then(function (response) {
        let result = response.response[0].result;

        if (result.length > 0) {
          if (utilsNew_UtilsNew.isUndefined(_this.filters)) {
            _this.filters = [];
          }

          for (let obj of result) {
            _this.filters.push = obj;
          }
        }
      });
    }
  }

  save() {
    let filterName = PolymerUtils_PolymerUtils.getValue("filterName");
    let filterDescription = PolymerUtils_PolymerUtils.getValue(this._prefix + "filterDescription");
    let data = {};
    data.name = filterName;
    data.description = filterDescription;
    data.bioformat = this.filterBioformat;
    data.query = this.query;
    data.options = {};

    let _this = this;

    console.error("arguments order inverted after new clients. recheck functionality");
    this.opencgaClient.users().filtersConfigs(this.opencgaSession.user.id, {
      name: filterName
    }).then(function (response) {
      if (response.response[0].result.length > 0) {
        delete params.name; // TODO recheck!!

        _this.opencgaClient.users().updateFilter(this.opencgaSession.user.id, filterName, data).then(function (response) {
          for (let i in _this.filters) {
            if (_this.filters[i].name === filterName) {
              _this.filters[i] = response.response[0].result[0];
            }
          }

          PolymerUtils_PolymerUtils.setValue("filterName", "");
          PolymerUtils_PolymerUtils.setValue(_this._prefix + "filterDescription", "");
        });
      } else {
        if (_this.opencgaClient._config.serverSession !== undefined && _this.opencgaClient._config.serverSession === "1.3") {
          _this.opencgaClient.users().create(data).then(function (response) {
            _this.push("filters", data); // TODO recheck!!


            PolymerUtils_PolymerUtils.setValue("filterName", "");
            PolymerUtils_PolymerUtils.setValue(_this._prefix + "filterDescription", "");
          });
        } else {
          _this.opencgaClient.users().updateFilters(this.opencgaSession.user.id, data).then(function (response) {
            _this.push("filters", data); // TODO recheck!!


            PolymerUtils_PolymerUtils.setValue("filterName", "");
            PolymerUtils_PolymerUtils.setValue(_this._prefix + "filterDescription", "");
          });
        }
      }
    });
  }

  onServerFilterChange(e) {
    this.querySelector("#" + this._prefix + "Warning").style.display = "none";

    if (!utilsNew_UtilsNew.isUndefinedOrNull(this.filters)) {
      // We look for the filter name in the filters array
      for (let filter of this.filters) {
        if (filter.name === e.target.dataset.filterName) {
          PolymerUtils_PolymerUtils.addStyleByClass("filtersLink", "color", "black");
          e.target.style.color = "green";

          let _queryList = Object.assign({}, filter.query);

          this.dispatchEvent(new CustomEvent("activeFilterChange", {
            detail: _queryList,
            bubbles: true,
            composed: true
          }));
          break;
        }
      }
    }

    this.requestUpdate();
  }

  onQueryFilterDelete(e) {
    let _queryList = Object.assign({}, this.query); // Reset selected filters to none


    PolymerUtils_PolymerUtils.addStyleByClass("filtersLink", "color", "black");
    let name = e.target.dataset.filterName;
    let value = e.target.dataset.filterValue;
    console.log("onQueryFilterDelete", name, value);

    if (utilsNew_UtilsNew.isEmpty(value)) {
      delete _queryList[name]; //TODO check the reason of this condition
      //FIXME this.modeInheritance is never defined

      if (utilsNew_UtilsNew.isEqual(name, "genotype")) {
        if (this.modeInheritance === "xLinked" || this.modeInheritance === "yLinked") {
          delete _queryList["region"];
        }
      }
    } else {
      //                    let filterFields = _queryList[name].split(new RegExp("[,;]"));
      let filterFields;

      if (value.indexOf(";") !== -1 && value.indexOf(",") !== -1 || this._config.complexFields.indexOf(name) !== -1) {
        filterFields = _queryList[name].split(new RegExp(";"));
      } else {
        filterFields = _queryList[name].split(new RegExp("[,;]"));
      }

      let indexOfValue = filterFields.indexOf(value);
      filterFields.splice(indexOfValue, 1);

      if (value.indexOf(";") !== -1 && value.indexOf(",") !== -1 || this._config.complexFields.indexOf(name) !== -1) {
        _queryList[name] = filterFields.join(";");
      } else {
        if (_queryList[name].indexOf(",") !== -1) {
          _queryList[name] = filterFields.join(",");
        } else {
          _queryList[name] = filterFields.join(";");
        }
      }
    } // When you delete any query filter we are not longer using any known Filter


    if (utilsNew_UtilsNew.isNotUndefined(PolymerUtils_PolymerUtils.getElementById("filtersList"))) {
      //TODO Refactor
      $("#filtersList option[value='none']").prop("selected", true);
    }

    this.dispatchEvent(new CustomEvent("activeFilterChange", {
      detail: _queryList,
      bubbles: true,
      composed: true
    }));
  }

  onQueryFacetDelete(e) {
    this.querySelector("#" + this._prefix + "Warning").style.display = "none";
    console.log("onQueryFacetDelete", e.target.dataset.filterName);
    delete this.facetQuery[e.target.dataset.filterName];
    this.facetQuery = opencga_active_filters_objectSpread({}, this.facetQuery);
    this.dispatchEvent(new CustomEvent("activeFacetChange", {
      detail: this.facetQuery,
      bubbles: true,
      composed: true
    }));
  }

  queryObserver() {
    let _queryList = [];
    let keys = Object.keys(this.query);

    for (let keyIdx in keys) {
      let key = keys[keyIdx];

      if (utilsNew_UtilsNew.isNotEmpty(this.query[key]) && !this._config.hiddenFields.includes(key)) {
        let queryString = Object.entries(this.query).sort().toString();
        let prevQueryString = Object.entries(this._previousQuery).sort().toString();

        if (queryString !== prevQueryString) {
          /*console.log(this.query);
          console.log(this._previousQuery);
          console.log(queryString);
          console.log(prevQueryString);*/
          PolymerUtils_PolymerUtils.show(this._prefix + "Warning");
        } else {
          PolymerUtils_PolymerUtils.hide(this._prefix + "Warning");
        } // We use the alias to rename the key


        let title = key;

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(this._config.alias) && utilsNew_UtilsNew.isNotUndefinedOrNull(this._config.alias[key])) {
          title = this._config.alias[key];
        } // We convert the Query entry object into an array of small objects (queryList)


        let value = this.query[key];

        if (typeof value === "boolean") {
          value = value.toString();
        }

        let filterFields = []; // in case of annotation

        if (key === "annotation") {
          const [variable, val] = value.split("="); //filterFields = val.split(",").map( v => variable + "=" + v); // TODO this has an error on filter delete

          filterFields = [val];
        } else {
          // If we find a field with both ; and , or the field has been defined as complex, we will only
          // separate by ;
          if (value.indexOf(";") !== -1 && value.indexOf(",") !== -1 || this._config.complexFields.indexOf(key) !== -1) {
            filterFields = value.split(new RegExp(";"));
          } else {
            filterFields = value.split(new RegExp("[,;]"));
          }
        } // We fist have need to remove defaultStudy from 'filterFields' and 'value'


        if (key === "studies") {
          let otherStudies = [];

          for (let study of filterFields) {
            if (!study.includes(this.defaultStudy)) {
              otherStudies.push(study);
            }
          }

          if (otherStudies.length === 0) {
            // defaultStudy was the only one present so no need to render anything
            continue;
          } else {
            // defaultStudy was just one of the studies selected, we need to set filterFields and value
            filterFields = otherStudies;

            if (value.indexOf(",") !== -1) {
              value = filterFields.join(",");
            } else {
              value = filterFields.join(";");
            }
          }
        }

        let locked = utilsNew_UtilsNew.isNotUndefinedOrNull(this.lockedFieldsMap[key]);
        let lockedTooltip = utilsNew_UtilsNew.isNotUndefinedOrNull(this.lockedFieldsMap[key]) ? this.lockedFieldsMap[key].message : ""; // Just in case one is a flag

        if (filterFields.length === 0) {
          _queryList.push({
            name: key,
            text: title,
            locked: locked,
            message: lockedTooltip
          });
        } else {
          if (filterFields.length === 1) {
            if (value.indexOf(">") !== -1 || value.indexOf("<") !== -1 || value.indexOf("=") !== -1) {
              _queryList.push({
                name: key,
                text: title + ": " + value,
                locked: locked,
                message: lockedTooltip
              });
            } else {
              _queryList.push({
                name: key,
                text: title + " = " + value,
                locked: locked,
                message: lockedTooltip
              });
            } //                                }

          } else {
            _queryList.push({
              name: key,
              text: title,
              items: filterFields,
              locked: locked,
              message: lockedTooltip
            });
          }
        }
      }
    }

    this.queryList = _queryList;
    this.requestUpdate();
  }

  searchClicked() {
    PolymerUtils_PolymerUtils.hide(this._prefix + "Warning");
    this._previousQuery = this.query;
  }

  _isMultiValued(item) {
    return utilsNew_UtilsNew.isNotUndefined(item.items);
  }

  getDefaultConfig() {
    return {
      alias: {
        "region": "Region",
        "gene": "Gene",
        "genotype": "Sample Genotype",
        "sample": "Samples",
        "maf": "Cohort Stat MAF",
        "cohortStatsAlt": "Cohort ALT Stats",
        "xref": "XRef",
        "panel": "Disease Panel",
        "file": "Files",
        "qual": "QUAL",
        "filter": "FILTER",
        "annot-xref": "XRef",
        "biotype": "Biotype",
        "ct": "Consequence Type",
        "annot-ct": "Consequence Type",
        "alternate_frequency": "Population ALT Frequency",
        "annot-functional-score": "CADD",
        "protein_substitution": "Protein Substitution",
        "annot-go": "GO",
        "annot-hpo": "HPO"
      },
      complexFields: [],
      hiddenFields: ["study"],
      lockedFields: []
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_active_filters_templateObject(), this.facetActive ? lit_html_lit_html_html(opencga_active_filters_templateObject2(), this._prefix) : lit_html_lit_html_html(opencga_active_filters_templateObject3(), this._prefix), this.queryList ? lit_html_lit_html_html(opencga_active_filters_templateObject4(), this.queryList.length === 0 ? lit_html_lit_html_html(opencga_active_filters_templateObject5()) : lit_html_lit_html_html(opencga_active_filters_templateObject6(), this.queryList.map(item => !this._isMultiValued(item) ? lit_html_lit_html_html(opencga_active_filters_templateObject7(), !item.locked ? lit_html_lit_html_html(opencga_active_filters_templateObject8(), item.name, item.name, this.onQueryFilterDelete, item.text) : lit_html_lit_html_html(opencga_active_filters_templateObject9(), item.name, item.name, this.onQueryFilterDelete, item.message, item.text)) : lit_html_lit_html_html(opencga_active_filters_templateObject10(), item.name, item.name, this.onQueryFilterDelete, this._onMouseOver, this._onMouseOut, item.text, item.items.length, item.items.length && item.items.map(filterItem => lit_html_lit_html_html(opencga_active_filters_templateObject11(), this.onQueryFilterDelete, item.name, filterItem, filterItem)))))) : null, this.clear, this.showSelectFilters(this.opencgaClient._config) ? lit_html_lit_html_html(opencga_active_filters_templateObject12(), this.filters && this.filters.length ? this.filters.map(item => lit_html_lit_html_html(opencga_active_filters_templateObject13(), !item.active ? lit_html_lit_html_html(opencga_active_filters_templateObject14(), item.name, this.onServerFilterChange, item.name) : lit_html_lit_html_html(opencga_active_filters_templateObject15(), item.name, this.onServerFilterChange, item.name))) : null, this.checkSid(this.opencgaClient._config) ? lit_html_lit_html_html(opencga_active_filters_templateObject16(), this.launchModal) : lit_html_lit_html_html(opencga_active_filters_templateObject17())) : null, this.facetActive && Object.keys(this.facetQuery).length ? lit_html_lit_html_html(opencga_active_filters_templateObject18(), Object.entries(this.facetQuery).map(([name, facet]) => lit_html_lit_html_html(opencga_active_filters_templateObject19(), name, name, this.onQueryFacetDelete, facet.formatted)), this.clearFacet) : null, this._prefix, this._prefix, this._prefix, this._prefix, this._prefix, this._prefix, this.save);
  }

}
customElements.define("opencga-active-filters", opencga_active_filters_OpencgaActiveFilters);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/loading-spinner.js
function loading_spinner_templateObject() {
  const data = loading_spinner_taggedTemplateLiteral(["\n        <style>\n            .loading-spinner-wrapper {\n                text-align: center;\n                height: 90px;\n            }\n            \n            .DNA_cont {\n                display: inline-block;\n                position: relative;\n                -webkit-transform: scale(0.45);\n                transform: scale(0.45);    \n                margin-top: 20px;\n            }\n        \n            .nucleobase {\n                display: inline-block;\n                position: relative;\n                vertical-align: middle;\n            }\n        \n            .nucleobase:not(:last-child) {\n                margin-right: 35px;\n            }\n        \n            .nucleobase:before, .nucleobase:after {\n                content: \"\";\n                display: inline-block;\n                width: 20px;\n                height: 20px;\n                border-radius: 50%;\n                position: absolute;\n            }\n        \n            .nucleobase:nth-child(1) {\n                -webkit-animation-delay: -1.869s;\n                animation-delay: -1.869s;\n            }\n        \n            .nucleobase:nth-child(1):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -1.869s;\n                animation-delay: -1.869s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(1):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -1.869s;\n                animation-delay: -1.869s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(2) {\n                -webkit-animation-delay: -3.738s;\n                animation-delay: -3.738s;\n            }\n        \n            .nucleobase:nth-child(2):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -3.738s;\n                animation-delay: -3.738s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(2):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -3.738s;\n                animation-delay: -3.738s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(3) {\n                -webkit-animation-delay: -5.607s;\n                animation-delay: -5.607s;\n            }\n        \n            .nucleobase:nth-child(3):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -5.607s;\n                animation-delay: -5.607s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(3):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -5.607s;\n                animation-delay: -5.607s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(4) {\n                -webkit-animation-delay: -7.476s;\n                animation-delay: -7.476s;\n            }\n        \n            .nucleobase:nth-child(4):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -7.476s;\n                animation-delay: -7.476s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(4):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -7.476s;\n                animation-delay: -7.476s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(5) {\n                -webkit-animation-delay: -9.345s;\n                animation-delay: -9.345s;\n            }\n        \n            .nucleobase:nth-child(5):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -9.345s;\n                animation-delay: -9.345s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(5):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -9.345s;\n                animation-delay: -9.345s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(6) {\n                -webkit-animation-delay: -11.214s;\n                animation-delay: -11.214s;\n            }\n        \n            .nucleobase:nth-child(6):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -11.214s;\n                animation-delay: -11.214s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(6):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -11.214s;\n                animation-delay: -11.214s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(7) {\n                -webkit-animation-delay: -13.083s;\n                animation-delay: -13.083s;\n            }\n        \n            .nucleobase:nth-child(7):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -13.083s;\n                animation-delay: -13.083s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(7):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -13.083s;\n                animation-delay: -13.083s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(8) {\n                -webkit-animation-delay: -14.952s;\n                animation-delay: -14.952s;\n            }\n        \n            .nucleobase:nth-child(8):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -14.952s;\n                animation-delay: -14.952s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(8):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -14.952s;\n                animation-delay: -14.952s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(9) {\n                -webkit-animation-delay: -16.821s;\n                animation-delay: -16.821s;\n            }\n        \n            .nucleobase:nth-child(9):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -16.821s;\n                animation-delay: -16.821s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(9):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -16.821s;\n                animation-delay: -16.821s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(10) {\n                -webkit-animation-delay: -18.69s;\n                animation-delay: -18.69s;\n            }\n        \n            .nucleobase:nth-child(10):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -18.69s;\n                animation-delay: -18.69s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(10):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -18.69s;\n                animation-delay: -18.69s;\n                background-color: #ff737c;\n            }\n        \n            @-webkit-keyframes animBefore {\n                0% {\n                    top: -6vh;\n                    z-index: 1;\n                }\n                25% {\n                    -webkit-transform: scale(1.2);\n                    transform: scale(1.2);\n                    z-index: 1;\n                }\n                50% {\n                    top: 6vh;\n                    z-index: -1;\n                }\n                75% {\n                    background-color: #ffdab2;\n                    -webkit-transform: scale(0.8);\n                    transform: scale(0.8);\n                    z-index: -1;\n                }\n                100% {\n                    top: -6vh;\n                    z-index: -1;\n                }\n            }\n        \n            @keyframes animBefore {\n                0% {\n                    top: -6vh;\n                    z-index: 1;\n                }\n                25% {\n                    -webkit-transform: scale(1.2);\n                    transform: scale(1.2);\n                    z-index: 1;\n                }\n                50% {\n                    top: 6vh;\n                    z-index: -1;\n                }\n                75% {\n                    background-color: #ffdab2;\n                    -webkit-transform: scale(0.8);\n                    transform: scale(0.8);\n                    z-index: -1;\n                }\n                100% {\n                    top: -6vh;\n                    z-index: -1;\n                }\n            }\n        \n            @-webkit-keyframes animAfter {\n                0% {\n                    top: 6vh;\n                    z-index: -1;\n                }\n                25% {\n                    background-color: #ff329b;\n                    -webkit-transform: scale(0.8);\n                    transform: scale(0.8);\n                    z-index: -1;\n                }\n                50% {\n                    top: -6vh;\n                    z-index: 1;\n                }\n                75% {\n                    -webkit-transform: scale(1.2);\n                    transform: scale(1.2);\n                    z-index: 1;\n                }\n                100% {\n                    top: 6vh;\n                    z-index: 1;\n                }\n            }\n        \n            @keyframes animAfter {\n                0% {\n                    top: 6vh;\n                    z-index: -1;\n                }\n                25% {\n                    background-color: #ff329b;\n                    -webkit-transform: scale(0.8);\n                    transform: scale(0.8);\n                    z-index: -1;\n                }\n                50% {\n                    top: -6vh;\n                    z-index: 1;\n                }\n                75% {\n                    -webkit-transform: scale(1.2);\n                    transform: scale(1.2);\n                    z-index: 1;\n                }\n                100% {\n                    top: 6vh;\n                    z-index: 1;\n                }\n            }\n        \n            @-webkit-keyframes animDotBar {\n                0% {\n                    height: 8.25vh;\n                }\n                25% {\n                    height: 0;\n                }\n                50% {\n                    height: 8.25vh;\n                }\n                75% {\n                    height: 0;\n                }\n                100% {\n                    height: 8.25vh;\n                }\n            }\n        \n            @keyframes animDotBar {\n                0% {\n                    height: 8.25vh;\n                }\n                25% {\n                    height: 0;\n                }\n                50% {\n                    height: 8.25vh;\n                }\n                75% {\n                    height: 0;\n                }\n                100% {\n                    height: 8.25vh;\n                }\n            }\n        \n            @-webkit-keyframes superscript {\n                0% {\n                    opacity: 0;\n                    -webkit-transform: translateY(-1em);\n                    transform: translateY(-1em);\n                }\n                100% {\n                    opacity: 1;\n                    -webkit-transform: translateY(0em);\n                    transform: translateY(0em);\n                }\n            }\n        \n            @keyframes superscript {\n                0% {\n                    opacity: 0;\n                    -webkit-transform: translateY(-1em);\n                    transform: translateY(-1em);\n                }\n                100% {\n                    opacity: 1;\n                    -webkit-transform: translateY(0em);\n                    transform: translateY(0em);\n                }\n            }\n        \n            .loading-spinner-wrapper .loading-text {\n                font-size: 19px;\n                font-variant: all-small-caps;\n                letter-spacing: 5px;\n                margin: 20px 0 0 20px;\n                text-align: left;\n            }\n            \n            .loading-text-wrapper {\n                width: 140px;\n                margin: 0 auto;\n            }\n    \n            /*.text:after {\n                overflow: hidden;\n                display: inline-block;\n                vertical-align: bottom;\n                -webkit-animation: ellipsis steps(4,end) 900ms infinite;      \n                animation: ellipsis steps(4,end) 900ms infinite;\n                content: \"\\2026\"; !* ascii code for the ellipsis character *!\n                width: 0px;\n                margin-left: -8px;\n            }\n\n            @keyframes ellipsis {\n                to {\n                  width: 1.25em;    \n                }\n            }*/\n            \n            @-webkit-keyframes ellipsis {\n                to {\n                  width: 1.25em;    \n                }\n            }\n        \n        </style>\n        <div class=\"loading-spinner-wrapper\">\n            <div class=\"DNA_cont\">\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n            </div>\n            <div class=\"loading-text-wrapper\">\n                <div class=\"loading-text\">\n                    Loading...\n                </div>\n            </div>\n        </div>\n        "], ["\n        <style>\n            .loading-spinner-wrapper {\n                text-align: center;\n                height: 90px;\n            }\n            \n            .DNA_cont {\n                display: inline-block;\n                position: relative;\n                -webkit-transform: scale(0.45);\n                transform: scale(0.45);    \n                margin-top: 20px;\n            }\n        \n            .nucleobase {\n                display: inline-block;\n                position: relative;\n                vertical-align: middle;\n            }\n        \n            .nucleobase:not(:last-child) {\n                margin-right: 35px;\n            }\n        \n            .nucleobase:before, .nucleobase:after {\n                content: \"\";\n                display: inline-block;\n                width: 20px;\n                height: 20px;\n                border-radius: 50%;\n                position: absolute;\n            }\n        \n            .nucleobase:nth-child(1) {\n                -webkit-animation-delay: -1.869s;\n                animation-delay: -1.869s;\n            }\n        \n            .nucleobase:nth-child(1):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -1.869s;\n                animation-delay: -1.869s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(1):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -1.869s;\n                animation-delay: -1.869s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(2) {\n                -webkit-animation-delay: -3.738s;\n                animation-delay: -3.738s;\n            }\n        \n            .nucleobase:nth-child(2):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -3.738s;\n                animation-delay: -3.738s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(2):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -3.738s;\n                animation-delay: -3.738s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(3) {\n                -webkit-animation-delay: -5.607s;\n                animation-delay: -5.607s;\n            }\n        \n            .nucleobase:nth-child(3):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -5.607s;\n                animation-delay: -5.607s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(3):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -5.607s;\n                animation-delay: -5.607s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(4) {\n                -webkit-animation-delay: -7.476s;\n                animation-delay: -7.476s;\n            }\n        \n            .nucleobase:nth-child(4):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -7.476s;\n                animation-delay: -7.476s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(4):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -7.476s;\n                animation-delay: -7.476s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(5) {\n                -webkit-animation-delay: -9.345s;\n                animation-delay: -9.345s;\n            }\n        \n            .nucleobase:nth-child(5):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -9.345s;\n                animation-delay: -9.345s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(5):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -9.345s;\n                animation-delay: -9.345s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(6) {\n                -webkit-animation-delay: -11.214s;\n                animation-delay: -11.214s;\n            }\n        \n            .nucleobase:nth-child(6):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -11.214s;\n                animation-delay: -11.214s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(6):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -11.214s;\n                animation-delay: -11.214s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(7) {\n                -webkit-animation-delay: -13.083s;\n                animation-delay: -13.083s;\n            }\n        \n            .nucleobase:nth-child(7):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -13.083s;\n                animation-delay: -13.083s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(7):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -13.083s;\n                animation-delay: -13.083s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(8) {\n                -webkit-animation-delay: -14.952s;\n                animation-delay: -14.952s;\n            }\n        \n            .nucleobase:nth-child(8):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -14.952s;\n                animation-delay: -14.952s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(8):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -14.952s;\n                animation-delay: -14.952s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(9) {\n                -webkit-animation-delay: -16.821s;\n                animation-delay: -16.821s;\n            }\n        \n            .nucleobase:nth-child(9):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -16.821s;\n                animation-delay: -16.821s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(9):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -16.821s;\n                animation-delay: -16.821s;\n                background-color: #ff737c;\n            }\n        \n            .nucleobase:nth-child(10) {\n                -webkit-animation-delay: -18.69s;\n                animation-delay: -18.69s;\n            }\n        \n            .nucleobase:nth-child(10):before {\n                -webkit-animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animBefore 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -18.69s;\n                animation-delay: -18.69s;\n                background-color: #ff8490;\n            }\n        \n            .nucleobase:nth-child(10):after {\n                -webkit-animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                animation: animAfter 2.1s cubic-bezier(0.42, 0, 0.58, 1) infinite;\n                -webkit-animation-delay: -18.69s;\n                animation-delay: -18.69s;\n                background-color: #ff737c;\n            }\n        \n            @-webkit-keyframes animBefore {\n                0% {\n                    top: -6vh;\n                    z-index: 1;\n                }\n                25% {\n                    -webkit-transform: scale(1.2);\n                    transform: scale(1.2);\n                    z-index: 1;\n                }\n                50% {\n                    top: 6vh;\n                    z-index: -1;\n                }\n                75% {\n                    background-color: #ffdab2;\n                    -webkit-transform: scale(0.8);\n                    transform: scale(0.8);\n                    z-index: -1;\n                }\n                100% {\n                    top: -6vh;\n                    z-index: -1;\n                }\n            }\n        \n            @keyframes animBefore {\n                0% {\n                    top: -6vh;\n                    z-index: 1;\n                }\n                25% {\n                    -webkit-transform: scale(1.2);\n                    transform: scale(1.2);\n                    z-index: 1;\n                }\n                50% {\n                    top: 6vh;\n                    z-index: -1;\n                }\n                75% {\n                    background-color: #ffdab2;\n                    -webkit-transform: scale(0.8);\n                    transform: scale(0.8);\n                    z-index: -1;\n                }\n                100% {\n                    top: -6vh;\n                    z-index: -1;\n                }\n            }\n        \n            @-webkit-keyframes animAfter {\n                0% {\n                    top: 6vh;\n                    z-index: -1;\n                }\n                25% {\n                    background-color: #ff329b;\n                    -webkit-transform: scale(0.8);\n                    transform: scale(0.8);\n                    z-index: -1;\n                }\n                50% {\n                    top: -6vh;\n                    z-index: 1;\n                }\n                75% {\n                    -webkit-transform: scale(1.2);\n                    transform: scale(1.2);\n                    z-index: 1;\n                }\n                100% {\n                    top: 6vh;\n                    z-index: 1;\n                }\n            }\n        \n            @keyframes animAfter {\n                0% {\n                    top: 6vh;\n                    z-index: -1;\n                }\n                25% {\n                    background-color: #ff329b;\n                    -webkit-transform: scale(0.8);\n                    transform: scale(0.8);\n                    z-index: -1;\n                }\n                50% {\n                    top: -6vh;\n                    z-index: 1;\n                }\n                75% {\n                    -webkit-transform: scale(1.2);\n                    transform: scale(1.2);\n                    z-index: 1;\n                }\n                100% {\n                    top: 6vh;\n                    z-index: 1;\n                }\n            }\n        \n            @-webkit-keyframes animDotBar {\n                0% {\n                    height: 8.25vh;\n                }\n                25% {\n                    height: 0;\n                }\n                50% {\n                    height: 8.25vh;\n                }\n                75% {\n                    height: 0;\n                }\n                100% {\n                    height: 8.25vh;\n                }\n            }\n        \n            @keyframes animDotBar {\n                0% {\n                    height: 8.25vh;\n                }\n                25% {\n                    height: 0;\n                }\n                50% {\n                    height: 8.25vh;\n                }\n                75% {\n                    height: 0;\n                }\n                100% {\n                    height: 8.25vh;\n                }\n            }\n        \n            @-webkit-keyframes superscript {\n                0% {\n                    opacity: 0;\n                    -webkit-transform: translateY(-1em);\n                    transform: translateY(-1em);\n                }\n                100% {\n                    opacity: 1;\n                    -webkit-transform: translateY(0em);\n                    transform: translateY(0em);\n                }\n            }\n        \n            @keyframes superscript {\n                0% {\n                    opacity: 0;\n                    -webkit-transform: translateY(-1em);\n                    transform: translateY(-1em);\n                }\n                100% {\n                    opacity: 1;\n                    -webkit-transform: translateY(0em);\n                    transform: translateY(0em);\n                }\n            }\n        \n            .loading-spinner-wrapper .loading-text {\n                font-size: 19px;\n                font-variant: all-small-caps;\n                letter-spacing: 5px;\n                margin: 20px 0 0 20px;\n                text-align: left;\n            }\n            \n            .loading-text-wrapper {\n                width: 140px;\n                margin: 0 auto;\n            }\n    \n            /*.text:after {\n                overflow: hidden;\n                display: inline-block;\n                vertical-align: bottom;\n                -webkit-animation: ellipsis steps(4,end) 900ms infinite;      \n                animation: ellipsis steps(4,end) 900ms infinite;\n                content: \"\\\\2026\"; !* ascii code for the ellipsis character *!\n                width: 0px;\n                margin-left: -8px;\n            }\n\n            @keyframes ellipsis {\n                to {\n                  width: 1.25em;    \n                }\n            }*/\n            \n            @-webkit-keyframes ellipsis {\n                to {\n                  width: 1.25em;    \n                }\n            }\n        \n        </style>\n        <div class=\"loading-spinner-wrapper\">\n            <div class=\"DNA_cont\">\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n                <div class=\"nucleobase\"></div>\n            </div>\n            <div class=\"loading-text-wrapper\">\n                <div class=\"loading-text\">\n                    Loading...\n                </div>\n            </div>\n        </div>\n        "]);

  loading_spinner_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function loading_spinner_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

class loading_spinner_LoadingSpinner extends lit_element_lit_element_LitElement {
  constructor() {
    super();
  }

  createRenderRoot() {
    return this;
  }

  render() {
    return lit_html_lit_html_html(loading_spinner_templateObject());
  }

}
customElements.define("loading-spinner", loading_spinner_LoadingSpinner);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/opencb-facet-results.js
function opencb_facet_results_templateObject5() {
  const data = opencb_facet_results_taggedTemplateLiteral([""]);

  opencb_facet_results_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencb_facet_results_templateObject4() {
  const data = opencb_facet_results_taggedTemplateLiteral(["\n                <div>\n                    <h3>", "</h3>\n                    <opencga-facet-result-view .facetResult=\"", "\"\n                            .config=\"", "\"\n                            ?active=\"", "\">\n                    </opencga-facet-result-view>\n                </div>\n            "]);

  opencb_facet_results_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencb_facet_results_templateObject3() {
  const data = opencb_facet_results_taggedTemplateLiteral(["\n                <div id=\"error\" class=\"alert alert-danger\" role=\"alert\">\n                    ", "\n                </div>\n            "]);

  opencb_facet_results_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencb_facet_results_templateObject2() {
  const data = opencb_facet_results_taggedTemplateLiteral(["\n                <div id=\"loading\">\n                    <loading-spinner></loading-spinner>\n                </div>\n            "]);

  opencb_facet_results_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencb_facet_results_templateObject() {
  const data = opencb_facet_results_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            option:disabled {\n                font-size: 0.85em;\n                font-weight: bold;\n            }\n\n            .active-filter-button:hover {\n                text-decoration: line-through;\n            }\n            .deletable:hover {\n                text-decoration: line-through;\n            }\n            #loading {\n                text-align: center;\n                margin-top: 40px;\n            }\n        </style>\n\n        <div class=\"row\">\n            ", "\n            ", "\n            ", "\n        </div>\n    "]);

  opencb_facet_results_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencb_facet_results_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencb_facet_results_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencb_facet_results_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencb_facet_results_ownKeys(Object(source), true).forEach(function (key) { opencb_facet_results_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencb_facet_results_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencb_facet_results_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */






class opencb_facet_results_OpencbFacetResults extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      query: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      config: {
        type: Object
      },
      active: {
        type: Boolean
      },
      data: {
        type: Object
      },
      loading: {
        type: Boolean
      },
      errorState: {
        type: String
      }
    };
  }

  _init() {
    this._prefix = "facet-results" + utils.randomString(6);
    this._showInitMessage = true;
    this.facets = new Set();
    this.facetActive = true;
    this._config = this.getDefaultConfig();
    this.data = [];
  }

  firstUpdated(_changedProperties) {
    $(".bootstrap-select", this).selectpicker();
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession") || changedProperties.has("query")) {
      this.propertyObserver();
    }

    if (changedProperties.has("query")) {
      this.queryObserver();
    }

    if (changedProperties.has("config")) {
      this.configObserver();
    }

    if (changedProperties.has("active") && this.active) {
      console.warn("fire http req"); //TODO check if query has changed before (this.facetResults.length)
      //this.fetchDefaultData();
    }
  }

  propertyObserver(opencgaSession, query) {// this.clear();
    //PolymerUtils.show(this._prefix + "Warning");
  }

  queryObserver() {
    console.log("queryObserver  in facet!"); //executedQuery in opencga-variant-browser has changed so, if requested,  we have to repeat the facet query

    this.facetResults = [];
    this.fetchDefaultData();
  }

  configObserver() {
    this._config = opencb_facet_results_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  clearPlots() {
    if (utilsNew_UtilsNew.isNotUndefined(this.results) && this.results.length > 0) {
      for (let result of this.results) {
        PolymerUtils_PolymerUtils.removeElement(this._prefix + result.name + "Plot");
      }
    }

    this.results = [];
  }

  clear() {
    this.clearPlots();
    this.chromosome = "";
    this.facets = new Set();
    this.facetFilters = [];
    PolymerUtils_PolymerUtils.hide(this._prefix + "Warning");
    this.facetFields = [];
    this.facetRanges = [];
    this.facetFieldsName = [];
    this.facetRangeFields = [];
    this._showInitMessage = true;
    this.requestUpdate();
  } //TODO add default configuration for file, sample, individual, family, cohort, clinical analysis


  getDefaultConfig() {
    return {};
  }

  render() {
    return lit_html_lit_html_html(opencb_facet_results_templateObject(), this.loading ? lit_html_lit_html_html(opencb_facet_results_templateObject2()) : null, this.errorState ? lit_html_lit_html_html(opencb_facet_results_templateObject3(), this.errorState) : null, this.data && this.data.length ? this.data.map(item => lit_html_lit_html_html(opencb_facet_results_templateObject4(), item.name, item, this.facetConfig, this.facetActive)) : lit_html_lit_html_html(opencb_facet_results_templateObject5()));
  }

}

customElements.define("opencb-facet-results", opencb_facet_results_OpencbFacetResults);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/annotation/cellbase-variant-annotation-summary.js
function cellbase_variant_annotation_summary_templateObject10() {
  const data = cellbase_variant_annotation_summary_taggedTemplateLiteral(["\n                                    (<b>Gene:</b>", ", <b>Transcript: </b>", ")\n                                "]);

  cellbase_variant_annotation_summary_templateObject10 = function _templateObject10() {
    return data;
  };

  return data;
}

function cellbase_variant_annotation_summary_templateObject9() {
  const data = cellbase_variant_annotation_summary_taggedTemplateLiteral(["\n                                    (<b>Gene:</b>{{proteinSubScore.sift.gene}, <b>Transcript: </b>{{proteinSubScore.sift.transcript})\n                                "]);

  cellbase_variant_annotation_summary_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function cellbase_variant_annotation_summary_templateObject8() {
  const data = cellbase_variant_annotation_summary_taggedTemplateLiteral(["\n                                    <span>(<b>Gene</b> : ", ", <b>Transcript</b> : ", ")</span>\n                                "]);

  cellbase_variant_annotation_summary_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function cellbase_variant_annotation_summary_templateObject7() {
  const data = cellbase_variant_annotation_summary_taggedTemplateLiteral(["\n                        <div class=\"block\">\n                            <label class=\"align-left\">MAF</label>\n                            <div class=\"align-right\">", " (", ")</div>\n                            <br>\n                         </div>\n                    "]);

  cellbase_variant_annotation_summary_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function cellbase_variant_annotation_summary_templateObject6() {
  const data = cellbase_variant_annotation_summary_taggedTemplateLiteral(["\n                        <div class=\"block\">\n                            <label class=\"align-left\">Ancestral Allele</label>\n                            <div class=\"align-right\">", "</div>\n                            <br>\n                        </div>\n                    "]);

  cellbase_variant_annotation_summary_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function cellbase_variant_annotation_summary_templateObject5() {
  const data = cellbase_variant_annotation_summary_taggedTemplateLiteral(["\n                            <div class=\"block\">\n                                <label class=\"align-left\">Type</label>\n                                <div class=\"align-right\">", "</div>\n                                <br>\n                            </div>\n                    "]);

  cellbase_variant_annotation_summary_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function cellbase_variant_annotation_summary_templateObject4() {
  const data = cellbase_variant_annotation_summary_taggedTemplateLiteral(["\n                                <div>-", "</div>\n                            "]);

  cellbase_variant_annotation_summary_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function cellbase_variant_annotation_summary_templateObject3() {
  const data = cellbase_variant_annotation_summary_taggedTemplateLiteral(["\n                                        ", "<br>\n                                    "]);

  cellbase_variant_annotation_summary_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function cellbase_variant_annotation_summary_templateObject2() {
  const data = cellbase_variant_annotation_summary_taggedTemplateLiteral(["\n                            <div class=\"block\">\n                                <label class=\"align-left\">HGVS</label>\n                                <div class=\"align-right\">\n                                    ", "\n                                </div> <br>\n                            </div>\n                        "]);

  cellbase_variant_annotation_summary_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function cellbase_variant_annotation_summary_templateObject() {
  const data = cellbase_variant_annotation_summary_taggedTemplateLiteral(["\n            <div>\n                <style include=\"jso-styles\">\n                    div.block {\n                        overflow: hidden;\n                    }\n            \n                    .align-left {\n                        width: 20%;\n                        display: block;\n                        float: left;\n                        text-align: left;\n                    }\n            \n                    .align-right {\n                        width: 70%;\n                        display: block;\n                        float: left;\n                        text-align: left;\n                    }\n                </style>\n            \n                <div>\n                    <div class=\"block\">\n                        <label class=\"align-left\">ID</label>\n                        <div class=\"align-right\"><a target=\"_blank\"\n                                                    href=\"http://grch37.ensembl.org/Homo_sapiens/Variation/Explore?vdb=variation;v=", "\">", "</a>\n                        </div>\n                        <br>\n                    </div>\n                    ", "\n                    <div class=\"block\">\n                        <label class=\"align-left\">Alleles</label>\n                        <div class=\"align-right\">", "/", "</div>\n                        <br>\n                    </div>\n                    <div class=\"block\">\n                        <label class=\"align-left\">Location</label>\n                        <div class=\"align-right\">\n                            <a target=\"_blank\" href=\"http://genomemaps.org/?region=", ":", "\">\n                                ", ":", "\n                                ", "\n                            </a>\n                        </div>\n                        <br>\n                    </div>\n                    ", "\n                    ", "\n                    ", "\n                    <div class=\"block\">\n                        <label class=\"align-left\">Most Severe Consequence Type</label>\n                        <div class=\"align-right\"><span id=\"", "CT\">", "</span>\n                            ", "\n                        </div>\n                        <br>\n                    </div>\n                    <div class=\"block\">\n                        <label class=\"align-left\">Most Severe Deleterious Score</label>\n                        <div class=\"align-right\">\n                            <!-- Sift -->\n                            <div class=\"row\" style=\"padding-left: 12px\">\n                                <label style=\"width:10%\">Sift</label>\n                                <span id=\"", "Sift\"\n                                      title=\"", "\">", "</span>\n                                ", "\n                                <br>\n                            </div>\n                            <!-- Polyphen -->\n                            <div class=\"row\" style=\"padding-left: 12px\">\n                                <label style=\"width:10%\">Polyphen</label>\n                                <span id=\"", "Polyphen\" title=\"", "\">", "</span>\n                                ", "\n                                <br>\n                            </div>\n                            <!--CADD-->\n                            <div class=\"row\" style=\"padding-left: 12px\">\n                                <label style=\"width:10%\">CADD Scaled</label>\n                                <span id=\"", "Cadd\">", "</span>\n                                <br>\n                            </div>\n                        </div>\n                        <br>\n                    </div>\n            \n                </div>\n                <div id=\"", "Traits\"></div>\n            </div>\n        "]);

  cellbase_variant_annotation_summary_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function cellbase_variant_annotation_summary_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/*
 * Copyright 2015-2016 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



class cellbase_variant_annotation_summary_CellbaseVariantAnnotationSummary extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      variantAnnotation: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      minimumFreq: {
        type: Array
      }
    };
  }

  _init() {
    this._prefix = "sf-" + utils.randomString(6) + "_";
    this.variantAnnotation = {};
  }

  updated(changedProperties) {
    if (changedProperties.has("variantAnnotation")) {
      this.variantAnnotationChanged();
    }

    if (changedProperties.has("consequenceTypes") || changedProperties.has("proteinSubstitutionScores")) {
      this.setColors();
    }
  } // ready() {
  //     super.ready();
  //
  //     if (typeof this._prefix === "undefined" || this._prefix === "") {
  //         this._prefix = "annotation" + Utils.randomString(6);
  //     }
  // }


  isTranscriptAvailable(item) {
    return item !== "";
  }

  isDataEmpty(data) {
    return typeof data === "undefined";
  }

  setColors() {
    if (typeof this.consequenceTypes !== "undefined") {
      let consequenceTypeToColor = {};

      for (let i = 0; i < this.consequenceTypes.categories.length; i++) {
        if (typeof this.consequenceTypes.categories[i].terms !== "undefined") {
          for (let j = 0; j < this.consequenceTypes.categories[i].terms.length; j++) {
            consequenceTypeToColor[this.consequenceTypes.categories[i].terms[j].name] = this.consequenceTypes.color[this.consequenceTypes.categories[i].terms[j].impact];
          }
        } else if (typeof this.consequenceTypes.categories[i].id !== "undefined" && typeof this.consequenceTypes.categories[i].name !== "undefined") {
          consequenceTypeToColor[this.consequenceTypes.categories[i].name] = this.consequenceTypes.color[this.consequenceTypes.categories[i].impact];
        }
      }

      this.consequenceTypeToColor = consequenceTypeToColor;
    }

    if (typeof this.proteinSubstitutionScores !== "undefined") {
      let pssColor = new Map();

      for (let i in this.proteinSubstitutionScores) {
        let obj = this.proteinSubstitutionScores[i];
        Object.keys(obj).forEach(key => {
          pssColor.set(key, obj[key]);
        });
      }

      this.pssColor = pssColor;
    }
  }

  variantAnnotationChanged() {
    let _this = this; //debugger


    if (typeof this.variantAnnotation !== "undefined") {
      if (utilsNew_UtilsNew.isEmpty(_this.variantAnnotation.reference)) {
        _this.variantAnnotation.reference = "-";
      }

      if (utilsNew_UtilsNew.isEmpty(_this.variantAnnotation.alternate)) {
        _this.variantAnnotation.alternate = "-";
      } // Consequence type
      // Color the consequence type


      if (typeof _this.consequenceTypeToColor !== "undefined" && typeof _this.consequenceTypeToColor[_this.variantAnnotation.displayConsequenceType] !== "undefined") {
        $("#" + _this._prefix + "CT").css("color", _this.consequenceTypeToColor[_this.variantAnnotation.displayConsequenceType]);
      } // Find the gene and transcript that exhibit the display consequence type


      if (typeof _this.variantAnnotation.consequenceTypes !== "undefined") {
        for (let i = 0; i < _this.variantAnnotation.consequenceTypes.length; i++) {
          for (let j = 0; j < _this.variantAnnotation.consequenceTypes[i].sequenceOntologyTerms.length; j++) {
            if (_this.variantAnnotation.displayConsequenceType === _this.variantAnnotation.consequenceTypes[i].sequenceOntologyTerms[j].name) {
              _this.ctGene = _this.variantAnnotation.consequenceTypes[i].geneName;
              _this.ctTranscript = _this.variantAnnotation.consequenceTypes[i].ensemblTranscriptId;
              break;
            }
          }
        }
      } // PSS


      let proteinSubScore = {}; //debugger

      if (typeof _this.variantAnnotation.consequenceTypes !== "undefined") {
        let min = 10;
        let max = 0;

        for (let i = 0; i < _this.variantAnnotation.consequenceTypes.length; i++) {
          if (typeof _this.variantAnnotation.consequenceTypes[i].proteinVariantAnnotation !== "undefined") {
            let gene = _this.variantAnnotation.consequenceTypes[i].geneName;
            let transcript = _this.variantAnnotation.consequenceTypes[i].ensemblTranscriptId;
            let scores = _this.variantAnnotation.consequenceTypes[i].proteinVariantAnnotation.substitutionScores;

            if (typeof scores !== "undefined") {
              for (let j = 0; j < scores.length; j++) {
                if (scores[j].source === "sift" && scores[j].score <= min) {
                  min = scores[j].score;
                  proteinSubScore.sift = {
                    score: scores[j].score,
                    description: scores[j].description,
                    gene: gene,
                    transcript: transcript
                  }; // if (typeof _this.pssColor !== "undefined" && typeof _this.pssColor.get(scores[j].description) !== "undefined") {
                  //     $("#" + _this._prefix + "Sift").css("color", _this.pssColor.get(scores[j].description));
                  // }
                } else if (scores[j].source === "polyphen" && scores[j].score >= max) {
                  max = scores[j].score;
                  proteinSubScore.polyphen = {
                    score: scores[j].score,
                    description: scores[j].description,
                    gene: gene,
                    transcript: transcript
                  }; // if (typeof _this.pssColor !== "undefined" && typeof _this.pssColor.get(scores[j].description) !== "undefined") {
                  //     $("#" + _this._prefix + "Polyphen").css("color", _this.pssColor.get(scores[j].description));
                  // }
                }
              }
            }
          }
        }
      }

      if (Object.keys(proteinSubScore).length === 0 && proteinSubScore.constructor === Object) {
        proteinSubScore.sift = {
          score: "NA",
          description: "NA",
          transcript: ""
        };
        proteinSubScore.polyphen = {
          score: "NA",
          description: "NA",
          transcript: ""
        };
        $("#" + _this._prefix + "Sift").css("color", "black");
        $("#" + _this._prefix + "Polyphen").css("color", "black");
      }

      _this.proteinSubScore = proteinSubScore; //debugger
      // CADD

      if (typeof _this.variantAnnotation.functionalScore !== "undefined") {
        for (let i in _this.variantAnnotation.functionalScore) {
          let value = Number(_this.variantAnnotation.functionalScore[i].score).toFixed(2);

          if (_this.variantAnnotation.functionalScore[i].source === "cadd_scaled") {
            if (value > 15) {
              $("#" + _this._prefix + "Cadd").css("color", "red");
              _this.caddScaled = value;
            } else {
              $("#" + _this._prefix + "Cadd").css("color", "black");
              _this.caddScaled = value;
            }
          }
        }
      } else {
        $("#" + _this._prefix + "Cadd").css("color", "black");
        _this.caddScaled = "NA";
      }

      this.requestUpdate();
    }
  }

  render() {
    if (this.variantAnnotation === undefined || this.variantAnnotation === "" || this.proteinSubScore === undefined) {
      return;
    }

    return lit_html_lit_html_html(cellbase_variant_annotation_summary_templateObject(), this.variantAnnotation.id, this.variantAnnotation.id, this.variantAnnotation.hgvs && this.variantAnnotation.hgvs.length ? lit_html_lit_html_html(cellbase_variant_annotation_summary_templateObject2(), this.variantAnnotation.hgvs.map(item => lit_html_lit_html_html(cellbase_variant_annotation_summary_templateObject3(), item))) : null, this.variantAnnotation.reference, this.variantAnnotation.alternate, this.variantAnnotation.chromosome, this.variantAnnotation.start, this.variantAnnotation.chromosome, this.variantAnnotation.start, this.variantAnnotation.end ? lit_html_lit_html_html(cellbase_variant_annotation_summary_templateObject4(), this.variantAnnotation.end) : null, this.isDataEmpty(this.variantAnnotation.type) ? lit_html_lit_html_html(cellbase_variant_annotation_summary_templateObject5(), this.variantAnnotation.type) : null, this.isDataEmpty(this.variantAnnotation.ancestralAllele) ? lit_html_lit_html_html(cellbase_variant_annotation_summary_templateObject6(), this.variantAnnotation.ancestralAllele) : null, this.isDataEmpty(this.variantAnnotation.minorAlleleFreq) ? lit_html_lit_html_html(cellbase_variant_annotation_summary_templateObject7(), this.variantAnnotation.minorAlleleFreq, this.variantAnnotation.minorAllele) : null, this._prefix, this.variantAnnotation.displayConsequenceType, this.isDataEmpty(this.ctGene) ? lit_html_lit_html_html(cellbase_variant_annotation_summary_templateObject8(), this.ctGene, this.ctTranscript) : null, this._prefix, this.proteinSubScore.sift.score, this.proteinSubScore.sift.description, this.isTranscriptAvailable(this.proteinSubScore.sift.transcript) ? lit_html_lit_html_html(cellbase_variant_annotation_summary_templateObject9()) : null, this._prefix, this.proteinSubScore.polyphen.score, this.proteinSubScore.polyphen.description, this.isTranscriptAvailable(this.proteinSubScore.polyphen.transcript) ? lit_html_lit_html_html(cellbase_variant_annotation_summary_templateObject10(), this.proteinSubScore.polyphen.gene, this.proteinSubScore.polyphen.transcript) : null, this._prefix, this.caddScaled, this._prefix);
  }

}
customElements.define("cellbase-variant-annotation-summary", cellbase_variant_annotation_summary_CellbaseVariantAnnotationSummary);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/annotation/cellbase-annotation-consequencetype-grid.js
function cellbase_annotation_consequencetype_grid_templateObject() {
  const data = cellbase_annotation_consequencetype_grid_taggedTemplateLiteral(["\n            <div style=\"padding: 10px;\">\n                <table id=\"", "ConsequenceTypeTable\" data-search=\"true\" data-show-columns=\"true\" data-pagination=\"true\"\n                       data-page-list=\"[10, 25, 50]\" data-show-pagination-switch=\"true\" data-show-export=\"true\" data-icons-prefix=\"fa\" data-icons=\"icons\">\n                </table>\n            </div>\n        "]);

  cellbase_annotation_consequencetype_grid_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function cellbase_annotation_consequencetype_grid_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/*
 * Copyright 2015-2016 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


class cellbase_annotation_consequencetype_grid_AnnotationConsequencetypeGrid extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      data: {
        type: Array
      },
      consequenceTypes: {
        type: Object
      },
      hashFragmentCredentials: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "actg" + utils.randomString(6); // this.data = [];
  }

  update(changedProperties) {
    if (changedProperties.has("data")) {
      this.renderTable();
    }

    if (changedProperties.has("consequenceTypes")) {
      this.assignColors();
    }

    this.requestUpdate();
  }

  assignColors() {
    if (typeof this.consequenceTypes !== "undefined") {
      let consequenceTypeToColor = {};
      let consequenceTypeToImpact = {};

      for (let i = 0; i < this.consequenceTypes.categories.length; i++) {
        if (typeof this.consequenceTypes.categories[i].terms !== "undefined") {
          for (let j = 0; j < this.consequenceTypes.categories[i].terms.length; j++) {
            consequenceTypeToColor[this.consequenceTypes.categories[i].terms[j].name] = this.consequenceTypes.color[this.consequenceTypes.categories[i].terms[j].impact];
          }
        } else if (typeof this.consequenceTypes.categories[i].id !== "undefined" && typeof this.consequenceTypes.categories[i].name !== "undefined") {
          consequenceTypeToColor[this.consequenceTypes.categories[i].name] = this.consequenceTypes.color[this.consequenceTypes.categories[i].impact];
        }
      }

      this.consequenceTypeToColor = consequenceTypeToColor;
      this.renderTable(); // this.requestUpdate();
    }
  } //it was render();


  renderTable() {
    // debugger
    let _this = this;

    $('#' + this._prefix + 'ConsequenceTypeTable').bootstrapTable('destroy');
    $('#' + this._prefix + 'ConsequenceTypeTable').bootstrapTable({
      data: _this.data,
      detailView: true,
      detailFormatter: _this.detailFormatter,
      columns: [[{
        title: 'Gene',
        field: 'geneName',
        colspan: 1,
        rowspan: 2
      }, {
        title: 'Ensembl Gene',
        field: 'ensemblGeneId',
        colspan: 1,
        rowspan: 2
      }, {
        title: 'Ensembl Transcript',
        field: 'ensemblTranscriptId',
        colspan: 1,
        rowspan: 2
      }, {
        title: 'Biotype',
        field: 'biotype',
        colspan: 1,
        rowspan: 2
      }, {
        title: 'Sequence Ontology Term',
        field: {
          context: _this
        },
        formatter: _this.seqOntologyFormatter,
        colspan: 1,
        rowspan: 2
      }, {
        title: 'Protein Variant Annotation',
        colspan: 6,
        rowspan: 1
      }], [{
        title: 'Uniprot Accession',
        field: {
          context: _this
        },
        formatter: _this.uniprotAccessionFormatter,
        colspan: 1,
        rowspan: 1
      }, {
        title: 'Position',
        field: 'proteinVariantAnnotation.position',
        colspan: 1,
        rowspan: 1
      }, {
        title: 'Ref/Alt',
        formatter: _this.proteinAlleleFormatter,
        colspan: 1,
        rowspan: 1
      }, {
        title: 'Sift',
        formatter: _this.siftScoreFormatter,
        cellStyle: _this.siftCellStyle,
        colspan: 1,
        rowspan: 1
      }, {
        title: 'Polyphen',
        formatter: _this.polyphenScoreFormatter,
        cellStyle: _this.polyphenCellStyle,
        colspan: 1,
        rowspan: 1
      }, {
        title: 'Functional Description',
        field: 'proteinVariantAnnotation.functionalDescription',
        colspan: 1,
        rowspan: 1
      }]]
    }); // this.requestUpdate();
  }

  uniprotAccessionFormatter(value, row, index) {
    if (typeof row.proteinVariantAnnotation !== 'undefined' && typeof row.proteinVariantAnnotation.uniprotAccession !== 'undefined') {
      if (typeof this.field.context.hashFragmentCredentials !== "undefined") {
        return '<a href="#protein/' + this.field.context.hashFragmentCredentials.project + '/' + this.field.context.hashFragmentCredentials.study + '/' + row.proteinVariantAnnotation.uniprotAccession + '">' + row.proteinVariantAnnotation.uniprotAccession + '</a>';
      } else {
        return '<a href="http://www.uniprot.org/uniprot/' + row.proteinVariantAnnotation.uniprotAccession + '">' + row.proteinVariantAnnotation.uniprotAccession + '</a>';
      }
    } else {
      return '-';
    }
  }

  seqOntologyFormatter(value, row, index) {
    let soTerm = row.sequenceOntologyTerms[0];

    if (typeof this.field.context.consequenceTypeToColor !== "undefined" && typeof this.field.context.consequenceTypeToColor[soTerm.name] !== "undefined") {
      return '<span style="color: ' + this.field.context.consequenceTypeToColor[soTerm.name] + '">' + soTerm.name + '</span>&nbsp;' + '(<a target="_blank" href="http://www.sequenceontology.org/browser/current_svn/term/' + soTerm.accession + '">' + soTerm.accession + '</a>)';
    } else {
      return soTerm.name + '&nbsp;(<a target="_blank" href="http://www.sequenceontology.org/browser/current_svn/term/' + soTerm.accession + '">' + soTerm.accession + '</a>)';
    }
  }

  proteinAlleleFormatter(value, row, index) {
    if (typeof row.proteinVariantAnnotation !== 'undefined' && typeof row.proteinVariantAnnotation.reference !== 'undefined' && typeof row.proteinVariantAnnotation.alternate !== 'undefined') {
      return row.proteinVariantAnnotation.reference + "/" + row.proteinVariantAnnotation.alternate;
    } else {
      return '-';
    }
  }

  detailFormatter(index, row) {
    if (row.biotype === "protein_coding") {
      if (typeof row.proteinVariantAnnotation !== 'undefined') {
        if (typeof row.proteinVariantAnnotation.uniprotVariantId !== 'undefined') {
          var html = [];
          var result = "";

          if (typeof row.proteinVariantAnnotation.features !== 'undefined') {
            let features = row.proteinVariantAnnotation.features;
            var xxx = [];

            for (let i in features) {
              features[i].id = features[i].id || '-';
              features[i].type = features[i].type || '-';
              features[i].description = features[i].description || '-';
              xxx.push('<span> ID: ' + features[i].id + ', Start:' + features[i].start + ', End:' + features[i].end + ', Type:' + features[i].type + ', Description:' + features[i].description + ' </span> <br>');
            }

            result = xxx.join('');
          } else {
            result = '-';
          }

          html.push('<b>Uniprot Variant ID:</b> ' + row.proteinVariantAnnotation.uniprotVariantId + '<br> <b>Keywords:</b> ' + row.proteinVariantAnnotation.keywords + '<br> <b>Features:</b><br> ' + result);
          return html.join('');
        } else {
          return "No Uniprot Data Available";
        }
      } else {
        return "No Uniprot Data Available";
      }
    } else {
      return '-';
    }
  }

  siftScoreFormatter(value, row, index) {
    if (typeof row.proteinVariantAnnotation !== 'undefined') {
      let sub = row.proteinVariantAnnotation.substitutionScores;

      for (let i in sub) {
        if (sub[i].source === "sift") {
          return '<span title="' + sub[i].description + '">' + sub[i].score + '</span>';
        }
      }
    } else {
      return '-';
    }
  }

  polyphenScoreFormatter(value, row, index) {
    if (typeof row.proteinVariantAnnotation !== 'undefined') {
      let sub = row.proteinVariantAnnotation.substitutionScores;

      for (let i in sub) {
        if (sub[i].source === "polyphen") {
          return '<span title="' + sub[i].description + '">' + sub[i].score + '</span>';
        }
      }
    } else {
      return '-';
    }
  }

  siftCellStyle(value, row, index) {
    if (typeof row.proteinVariantAnnotation !== 'undefined') {
      if (typeof row.proteinVariantAnnotation.substitutionScores !== 'undefined') {
        let sift = row.proteinVariantAnnotation.substitutionScores[0];

        if (sift) {
          switch (sift.description) {
            case 'tolerated':
              return {
                css: {
                  "background-color": "green"
                }
              };

            case 'deleterious':
              return {
                css: {
                  "background-color": "red"
                }
              };
          }
        }
      }
    }

    return {};
  }

  polyphenCellStyle(value, row, index) {
    if (typeof row.proteinVariantAnnotation !== 'undefined') {
      if (typeof row.proteinVariantAnnotation.substitutionScores !== 'undefined') {
        let polyphen = row.proteinVariantAnnotation.substitutionScores[1];

        if (polyphen) {
          switch (polyphen.description) {
            case 'probably damaging':
              return {
                css: {
                  "background-color": "red"
                }
              };

            case 'possibly damaging':
              return {
                css: {
                  "background-color": "orange"
                }
              };

            case 'benign':
              return {
                css: {
                  "background-color": "green"
                }
              };

            case 'unknown':
              return {
                css: {
                  "background-color": "blue"
                }
              };
          }
        }
      }
    }

    return {};
  }

  render() {
    return lit_html_lit_html_html(cellbase_annotation_consequencetype_grid_templateObject(), this._prefix);
  }

}
customElements.define('cellbase-annotation-consequencetype-grid', cellbase_annotation_consequencetype_grid_AnnotationConsequencetypeGrid);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/annotation/cellbase-population-frequency-grid.js
function cellbase_population_frequency_grid_templateObject() {
  const data = cellbase_population_frequency_grid_taggedTemplateLiteral(["\n            <div style=\"padding: 10px;\">\n                <table id=\"", "populationFreqTable\" data-search=\"true\" data-show-columns=\"true\" data-pagination=\"true\" data-page-list=\"[5, 15, 30]\"\n                       data-show-pagination-switch=\"true\" data-show-export=\"true\" data-icons-prefix=\"fa\" data-icons=\"icons\">\n                </table>\n                <div id=\"", "Container\"></div>\n            </div>\n        "]);

  cellbase_population_frequency_grid_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function cellbase_population_frequency_grid_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/*
 * Copyright 2015-2016 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


class cellbase_population_frequency_grid_CellbasePopulationFrequencyGrid extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      populationFrequencies: {
        type: Array
      }
    };
  }

  _init() {
    this._prefix = "cpfg-" + utils.randomString(6) + "_"; // this.populationFrequencies = [];
  }

  updated(changedProperties) {
    if (changedProperties.has("populationFrequencies")) {
      this.update2();
    }
  } //it was render();


  update2() {
    let popArray = [];
    let mafArray = [];

    if (typeof this.populationFrequencies !== "undefined") {
      for (let i = 0; i < this.populationFrequencies.length; i++) {
        popArray.push(this.populationFrequencies[i].study + "-" + this.populationFrequencies[i].population);
        mafArray.push(Math.min(Number(this.populationFrequencies[i].refAlleleFreq).toFixed(4), Number(this.populationFrequencies[i].altAlleleFreq).toFixed(4)));
      }
    }

    $('#' + this._prefix + 'Container').highcharts({
      chart: {
        type: 'bar'
      },
      title: {
        text: 'Population Frequencies'
      },
      xAxis: {
        categories: popArray,
        title: {
          text: null
        }
      },
      yAxis: {
        min: 0,
        title: {
          text: 'Minor Allele Frequency (MAF)',
          align: 'high'
        },
        labels: {
          overflow: 'justify'
        },
        max: 0.5
      },
      //                        tooltip: {
      //                            valueSuffix: ' millions'
      //                        },
      plotOptions: {
        bar: {
          dataLabels: {
            enabled: true
          }
        }
      },
      legend: {
        layout: 'vertical',
        align: 'right',
        verticalAlign: 'top',
        x: -40,
        y: 80,
        floating: true,
        borderWidth: 1,
        backgroundColor: Highcharts.theme && Highcharts.theme.legendBackgroundColor || '#FFFFFF',
        shadow: true
      },
      credits: {
        enabled: false
      },
      series: [{
        name: 'Minor Allele Frequency (MAF)',
        data: mafArray
      }]
    }); // Population grid definition

    let _this = this;

    $('#' + this._prefix + 'populationFreqTable').bootstrapTable('destroy');
    $('#' + this._prefix + 'populationFreqTable').bootstrapTable({
      data: _this.populationFrequencies,
      pageSize: 5,
      columns: [[{
        title: 'Study',
        field: 'study',
        sortable: true
      }, {
        title: 'Population',
        field: 'population'
      }, {
        title: 'Ref/Alt',
        formatter: _this.alleleFormatter
      }, {
        title: 'RefAlleleFreq',
        field: 'refAlleleFreq',
        sortable: true,
        formatter: _this.numFormatter
      }, {
        title: 'AltAlleleFreq',
        field: 'altAlleleFreq',
        sortable: true,
        formatter: _this.numFormatter
      }]]
    });
  }

  alleleFormatter(value, row, index) {
    return row.refAllele + "/" + row.altAllele;
  }

  numFormatter(value, row, index) {
    if (this.field === "refAlleleFreq") {
      return Number(row.refAlleleFreq).toFixed(4);
    } else if (this.field === "altAlleleFreq") {
      return Number(row.altAlleleFreq).toFixed(4);
    }
  }

  render() {
    if (this.populationFrequencies === undefined) {
      return;
    }

    return lit_html_lit_html_html(cellbase_population_frequency_grid_templateObject(), this._prefix, this._prefix);
  }

}
customElements.define('cellbase-population-frequency-grid', cellbase_population_frequency_grid_CellbasePopulationFrequencyGrid);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/opencga-variant-detail-view.js
function opencga_variant_detail_view_templateObject4() {
  const data = opencga_variant_detail_view_taggedTemplateLiteral(["\n                                            <li role=\"presentation\" class=\"\">\n                                                    <a href=\"#", "", "\" role=\"tab\" data-toggle=\"tab\"\n                                                       data-id=\"", "\"\n                                                       class=\"browser-variant-tab-title\"\n                                                       @click=\"", "\">", "</a>\n                                                </li>\n                                            "]);

  opencga_variant_detail_view_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_variant_detail_view_templateObject3() {
  const data = opencga_variant_detail_view_taggedTemplateLiteral(["\n                                                 <li role=\"presentation\" class=\"active\">\n                                                    <a href=\"#", "", "\" role=\"tab\" data-toggle=\"tab\"\n                                                       data-id=\"", "\"\n                                                       class=\"browser-variant-tab-title\"\n                                                       @click=\"", "\">", "</a>\n                                                </li>\n                                            "]);

  opencga_variant_detail_view_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_variant_detail_view_templateObject2() {
  const data = opencga_variant_detail_view_taggedTemplateLiteral(["\n                                            ", "\n                                        "]);

  opencga_variant_detail_view_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_variant_detail_view_templateObject() {
  const data = opencga_variant_detail_view_taggedTemplateLiteral(["\n                    <div style=\"padding-top: 20px\">\n                                <h3>Variant: ", "</h3>\n                                <div style=\"padding-top: 20px\">\n                                    <!-- Dynamically create the Detail Tabs from Browser config -->\n                                    <ul id=\"", "ViewTabs\" class=\"nav nav-tabs\" role=\"tablist\">\n                                        ", "\n                                    </ul>\n            \n                                    <div class=\"tab-content\" style=\"height: 680px\">\n                                        <!-- Annotation Tab\n                                        <div id=\"", "annotation\" role=\"tabpanel\" class=\"tab-pane active\">\n                                            <div style=\"width: 90%;padding-top: 8px\">\n                                                <cellbase-variantannotation-view .data=\"", "\"\n                                                                                 .assembly=", "\n                                                                                 _prefix=\"", "\"\n                                                                                 .cellbaseClient=\"", "\"\n                                                                                 mode=\"vertical\"\n                                                                                 .hashFragmentCredentials=\"", "\"\n                                                                                 .consequenceTypes=\"", "\"\n                                                                                 .proteinSubstitutionScores=\"", "\">\n                                                </cellbase-variantannotation-view>\n                                            </div>\n                                        </div>\n             -->\n                                        \n                                        \n                                         <!-- Annotation Tab -->\n                                        <div id=\"", "annotationSummary\" role=\"tabpanel\" class=\"tab-pane active\">\n                                            <div style=\"width: 90%;padding-top: 8px\">\n                                                <cellbase-variant-annotation-summary    .variantAnnotation=\"", "\"\n                                                                                        .consequenceTypes=\"", "\"\n                                                                                        .proteinSubstitutionScores=\"", "\">\n                                                </cellbase-variant-annotation-summary>  \n                                            </div>\n                                        </div>\n                                        \n                                        \n                                        <div id=\"", "annotationConsType\" role=\"tabpanel\" class=\"tab-pane\">\n                                            <div style=\"width: 90%;padding-top: 8px\">\n                                                <cellbase-annotation-consequencetype-grid .data=\"", "\"\n                                                          .hashFragmentCredentials=\"", "\"\n                                                          .consequenceTypes=\"", "\">\n                                                </cellbase-annotation-consequencetype-grid>\n                                            </div>\n                                        </div>\n                                        \n                                        <div id=\"", "annotationPropFreq\" role=\"tabpanel\" class=\"tab-pane\">\n                                            <div style=\"width: 90%;padding-top: 8px\">\n                                                <cellbase-population-frequency-grid .populationFrequencies=\"", "\">\n                                                </cellbase-population-frequency-grid>\n                                            </div>\n                                        </div>\n\n                                        <!-- Cohort Stats Tab -->\n                                        <div id=\"", "cohortStats\" role=\"tabpanel\" class=\"tab-pane\">\n                                            <div style=\"width: 75%;padding-top: 8px\">\n                                                <opencga-variant-cohort-stats .opencgaSession=\"", "\"\n                                                                              variant=\"", "\"\n                                                                              .active=\"", "\"\n                                                                              .config=\"", "\">\n                                                </opencga-variant-cohort-stats>\n                                            </div>\n                                        </div>\n\n                                        <!-- Samples Tab -->\n                                        <div id=\"", "samples\" role=\"tabpanel\" class=\"tab-pane\">\n                                            <div style=\"width: 75%;padding-top: 8px\">\n                                                <opencga-variant-samples .opencgaSession=\"", "\"\n                                                                         variant=\"", "\"\n                                                                         .active=\"", "\">\n                                                </opencga-variant-samples>\n                                            </div>\n                                        </div>\n            \n                                        <!-- Beacon Network Tab -->\n                                        <div id=\"", "beacon\" role=\"tabpanel\" class=\"tab-pane\">\n                                            <div style=\"width: 75%;padding-top: 8px\">\n                                                <variant-beacon-network variant=\"", "\" \n                                                                        clear=\"", "\"\n                                                                        .config=\"", "\">\n                                                </variant-beacon-network>\n                                            </div>\n                                        </div>\n                                        \n            \n                                        <!-- Reactome network tab -->\n                                        <div id=\"", "network\" role=\"tabpanel\" class=\"tab-pane\">\n                                            <div style=\"width: 75%;padding-top: 8px\">\n                                                <reactome-variant-network .opencgaSession=\"", "\"\n                                                                          .reactomeClient=\"", "\" \n                                                                          .genes=\"", "\"\n                                                                          ?active=\"", "\">\n                                                </reactome-variant-network>\n                                            </div>\n                                        </div>\n                                        \n            \n                                        <!-- Example Template Tab\n                                        <div id=\"", "template\" role=\"tabpanel\" class=\"tab-pane\">\n                                            <div style=\"width: 75%;padding-top: 8px\">\n                                                <opencga-variant-detail-template .opencgaSession=\"", "\"\n                                                                                 .variant=\"", "\"\n                                                                                 .active=\"", "\">\n                                                </opencga-variant-detail-template>\n                                            </div>\n                                        </div>\n                                        -->\n                                    </div>\n                                </div>\n                            </div>\n                "]);

  opencga_variant_detail_view_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_variant_detail_view_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_variant_detail_view_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_variant_detail_view_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_variant_detail_view_ownKeys(Object(source), true).forEach(function (key) { opencga_variant_detail_view_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_variant_detail_view_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_variant_detail_view_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/*
 * Copyright 2015-2016 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



 // import "./annotation/cellbase-variantannotation-view.js";



class opencga_variant_detail_view_OpenCGAVariantDetailView extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      variantId: {
        type: String
      },
      variant: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ovdv-" + utils.randomString(6) + "_"; // FIXME in case of region as a prop (with value = this.query.region from variant-filter) in case opencga-active-filter deletes a region filter this component is not updated.
    // A temp solution is to add query as prop and watch for its edits in updated() [this.region as prop is not used anymore].

    this.detailActiveTabs = [];
    this._config = this.getDefaultConfig();
  }

  firstUpdated(_changedProperties) {
    this._config = opencga_variant_detail_view_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  updated(_changedProperties) {
    // if (_changedProperties.has("query")) {
    //     let _region = this.query && this.query.region ? this.query.region : "";
    //     //this shouldn't be necessary.. component view is refreshed but the textArea isn't.
    //     this.querySelector("#" + this._prefix + "LocationTextarea").value = _region;
    // }
    // let _region = _changedProperties.has("variant") && this.variant ? this.variant : null;
    // this.querySelector("#" + this._prefix + "LocationTextarea").value = _region;
    if (_changedProperties.has("variantId")) {
      this._variantChanged();
    }

    if (_changedProperties.has("variant")) {// this.variant
      // debugger
      // this.requestUpdate();
    }
  } // filterChange(e) {
  //     // Process the textarea: remove newline chars, empty chars, leading/trailing commas
  //     const _region = e.target.value.trim()
  //         .replace(/\r?\n/g, this.separator)
  //         .replace(/\s/g, "")
  //         .split(this.separator)
  //         .filter(_ => _)
  //         .join(this.separator);
  //     // this.region = _region;
  //     const event = new CustomEvent("filterChange", {
  //         detail: {
  //             value: _region
  //         },
  //         bubbles: true,
  //         composed: true
  //     });
  //     // this.requestUpdate();
  //     this.dispatchEvent(event);
  // }


  _variantChanged() {
    let _this = this;

    if (typeof this.cellbaseClient !== "undefined" && utilsNew_UtilsNew.isNotEmpty(this.variantId)) {
      this.cellbaseClient.get("genomic", "variant", this.variantId, "annotation", {
        assembly: this.opencgaSession.project.organism.assembly
      }, {}).then(function (response) {
        _this.variant = {
          id: _this.variantId,
          annotation: response.response[0].result[0]
        };
        _this.variantAnnotation = response.response[0].result[0];
        _this.numberConsequenceTypes = 0;
        _this.numberPopulationFrequencies = 0;
        _this.numberVTA = 0;
        _this.numberGTA = 0;

        if (_this.variantAnnotation.geneTraitAssociation != null) {
          _this.numberConsequenceTypes = _this.variantAnnotation.consequenceTypes.length;
          _this.numberPopulationFrequencies = utilsNew_UtilsNew.isNotEmptyArray(_this.variantAnnotation.populationFrequencies) ? _this.variantAnnotation.populationFrequencies.length : 0;
          _this.numberVTA = utilsNew_UtilsNew.isNotUndefinedOrNull(_this.variantAnnotation.traitAssociation) ? _this.variantAnnotation.traitAssociation.length : 0;
          _this.numberGTA = utilsNew_UtilsNew.isNotUndefinedOrNull(_this.variantAnnotation.geneTraitAssociation) ? _this.variantAnnotation.geneTraitAssociation.length : 0;
        } // Gene Trait Association definition
        // $("#" + _this._prefix + "GTATable").bootstrapTable("destroy");
        // $("#" + _this._prefix + "GTATable").bootstrapTable({
        //     data: _this.variantAnnotation.geneTraitAssociation,
        //     columns: [
        //         [
        //             {
        //                 title: "id",
        //                 field: "id"
        //             },
        //             {
        //                 title: "name",
        //                 field: "name"
        //             },
        //             {
        //                 title: "hpo",
        //                 field: "hpo"
        //             },
        //             {
        //                 title: "source",
        //                 field: "source"
        //             }
        //         ]
        //     ]
        // });


        _this.requestUpdate();
      });
    }
  }

  _changeBottomTab(e) {
    let _activeTabs = {};

    for (let detail of this._config.detail) {
      _activeTabs[detail.id] = detail.id === e.currentTarget.dataset.id;
    }

    this.detailActiveTabs = _activeTabs;
    this.requestUpdate();
  }

  render() {
    if (this.variant === undefined || this.variant.annotation === undefined) {
      return;
    }

    return lit_html_lit_html_html(opencga_variant_detail_view_templateObject(), this.variant.id, this._prefix, this._config.detail.length && this._config.detail.map(item => lit_html_lit_html_html(opencga_variant_detail_view_templateObject2(), item.active ? lit_html_lit_html_html(opencga_variant_detail_view_templateObject3(), this._prefix, item.id, item.id, this._changeBottomTab, item.title) : lit_html_lit_html_html(opencga_variant_detail_view_templateObject4(), this._prefix, item.id, item.id, this._changeBottomTab, item.title))), this._prefix, this.variantId, this.opencgaSession.project.organism.assembly, this._prefix, this.cellbaseClient, this.hashFragmentCredentials, this.consequenceTypes, this.proteinSubstitutionScores, this._prefix, this.variant.annotation, this.consequenceTypes, this.proteinSubstitutionScores, this._prefix, this.variant.annotation.consequenceTypes, this.hashFragmentCredentials, this.consequenceTypes, this._prefix, this.variant.annotation.populationFrequencies, this._prefix, this.opencgaSession, this.variant.id, this.detailActiveTabs.cohortStats, this._config.filter.menu, this._prefix, this.opencgaSession, this.variant.id, this.detailActiveTabs.samples, this._prefix, this.variant.id, this.variant.id, this.beaconConfig, this._prefix, this.opencgaSession, this.reactomeClient, this.genes, this.detailActiveTabs.network, this._prefix, this.opencgaSession, this.variant, this.detailActiveTabs.template);
  }

  getDefaultConfig() {
    return {
      title: "",
      filter: {
        menu: []
      },
      detail: [// {
      //     id: "annotation",
      //     component: "cellbase-variantannotation-view",
      //     title: "Advanced Annotation",
      //     active: true
      // },
      {
        id: "annotationSummary",
        // component: "opencga-variant-cohort-stats",
        title: "Summary",
        active: true
      }, {
        id: "annotationConsType",
        // component: "opencga-variant-cohort-stats",
        title: "Consequence Type"
      }, {
        id: "annotationPropFreq",
        // component: "opencga-variant-cohort-stats",
        title: "Population Frequencies"
      }, {
        id: "cohortStats",
        component: "opencga-variant-cohort-stats",
        title: "Cohort Stats"
      }, {
        id: "samples",
        component: "opencga-variant-samples",
        title: "Samples"
      }, {
        id: "beacon",
        component: "variant-beacon-network",
        title: "Beacon" // Uncomment and edit Beacon hosts to change default hosts
        // hosts: [
        //     "brca-exchange", "cell_lines", "cosmic", "wtsi", "wgs", "ncbi", "ebi", "ega", "broad", "gigascience", "ucsc",
        //     "lovd", "hgmd", "icgc", "sahgp"
        // ]

      }, {
        id: "network",
        component: "reactome-variant-network",
        title: "Reactome Pathways"
      } // {
      //     id: "template",
      //     component: "opencga-variant-detail-template",
      //     title: "Template"
      // }
      ]
    };
  }

}
customElements.define("opencga-variant-detail-view", opencga_variant_detail_view_OpenCGAVariantDetailView);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/commons/opencga-facet.js
function _templateObject33() {
  const data = opencga_facet_taggedTemplateLiteral(["\n            <span><h3>No public projects available to browse. Please login to continue</h3></span>\n        "]);

  _templateObject33 = function _templateObject33() {
    return data;
  };

  return data;
}

function _templateObject32() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                            <div class=\"facetResultsDiv\">\n                                <div>\n                                    <h3>", "</h3>\n                                    <opencga-facet-result-view .facetResult=\"", "\" .config=\"", "\" .active=\"", "\"></opencga-facet-result-view>\n                                </div>\n                            </div>\n                        "]);

  _templateObject32 = function _templateObject32() {
    return data;
  };

  return data;
}

function _templateObject31() {
  const data = opencga_facet_taggedTemplateLiteral([""]);

  _templateObject31 = function _templateObject31() {
    return data;
  };

  return data;
}

function _templateObject30() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                            <div id=\"error\" class=\"alert alert-danger\" role=\"alert\">\n                                ", "\n                            </div>\n                        "]);

  _templateObject30 = function _templateObject30() {
    return data;
  };

  return data;
}

function _templateObject29() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                                        <div class=\"alert alert-info text-center\" role=\"alert\"><i class=\"fas fa-3x fa-info-circle\"></i><br><small>No aggregation field has been selected yet.</small></div>\n                                    "]);

  _templateObject29 = function _templateObject29() {
    return data;
  };

  return data;
}

function _templateObject28() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                                        <div class=\"facet-box\" id=\"", "Heading\">\n                                            <div class=\"subsection-content form-group\">\n                                                <div class=\"browser-subsection\">", "\n                                                    <div class=\"tooltip-div pull-right\">\n                                                        <a><i class=\"fa fa-info-circle\" aria-hidden=\"true\" id=\"", "", "Tooltip\"></i></a>\n                                                    </div>\n                                                </div>\n                                                <div id=\"", "", "\" class=\"\" role=\"tabpanel\" aria-labelledby=\"", "Heading\">\n                                                    <div class=\"\">\n                                                        ", "\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>                                    \n                                    "]);

  _templateObject28 = function _templateObject28() {
    return data;
  };

  return data;
}

function _templateObject27() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                                jobs\n                            "]);

  _templateObject27 = function _templateObject27() {
    return data;
  };

  return data;
}

function _templateObject26() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                                <opencga-clinical-analysis-filter   .opencgaSession=\"", "\"\n                                                                    .config=\"", "\"\n                                                                    .analyses=\"", "\"\n                                                                    .search=\"", "\"\n                                                                    .query=\"", "\"\n                                                                    .searchButton=\"", "\"\n                                                                    @queryChange=\"", "\"\n                                                                    @querySearch=\"", "\">\n                                </opencga-clinical-analysis-filter>\n                            "]);

  _templateObject26 = function _templateObject26() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject25() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                                <opencga-cohort-filter  discriminator=\"hardcoded\"  \n                                                        .opencgaSession=\"", "\"\n                                                        .config=\"", "\"\n                                                        .query=\"", "\"\n                                                        .search=\"", "\"\n                                                        .variableSets=\"", "\"\n                                                        .searchButton=\"", "\"\n                                                        @queryChange=\"", "\"\n                                                        @querySearch=\"", "\">\n                                </opencga-cohort-filter>\n                            "]);

  opencga_facet_templateObject25 = function _templateObject25() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject24() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                                <opencga-family-filter  discriminator=\"hardcoded\"  \n                                                        .opencgaSession=\"", "\"\n                                                        .config=\"", "\"\n                                                        .query=\"", "\"\n                                                        .search=\"", "\"\n                                                        .variableSets=\"", "\"\n                                                        .searchButton=\"", "\"\n                                                        @queryChange=\"", "\"\n                                                        @querySearch=\"", "\">\n                                </opencga-family-filter>\n                            "]);

  opencga_facet_templateObject24 = function _templateObject24() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject23() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                                <opencga-individual-filter discriminator=\"hardcoded\"  \n                                                            .opencgaSession=\"", "\"\n                                                            .config=\"", "\"\n                                                            .query=\"", "\"\n                                                            .search=\"", "\"\n                                                            .variableSets=\"", "\"\n                                                            .searchButton=\"", "\"\n                                                            @queryChange=\"", "\"\n                                                            @querySearch=\"", "\">\n                                </opencga-individual-filter>\n                            "]);

  opencga_facet_templateObject23 = function _templateObject23() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject22() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                                <opencga-sample-filter  discriminator=\"hardcoded\"  \n                                                        .opencgaSession=\"", "\"\n                                                        .cellbaseClient=\"", "\"\n                                                        .config=\"", "\"\n                                                        .query=\"", "\"\n                                                        .search=\"", "\"\n                                                        .variableSets=\"", "\"\n                                                        .searchButton=\"", "\"\n                                                        @queryChange=\"", "\"\n                                                        @querySearch=\"", "\">\n                                </opencga-sample-filter>\n                            "]);

  opencga_facet_templateObject22 = function _templateObject22() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject21() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                                <opencga-file-filter discriminator=\"hardcoded\"  \n                                                    .opencgaSession=\"", "\"\n                                                    .config=\"", "\"\n                                                    .files=\"", "\"\n                                                    .query=\"", "\"\n                                                    .search=\"", "\"\n                                                    .variableSets=\"", "\"\n                                                    .searchButton=\"", "\"\n                                                    @queryChange=\"", "\"\n                                                    @querySearch=\"", "\">\n                                </opencga-file-filter>\n                            "]);

  opencga_facet_templateObject21 = function _templateObject21() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject20() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                                <opencga-variant-filter .opencgaSession=", "\n                                                        .opencgaClient=\"", "\"\n                                                        .cellbaseClient=\"", "\"\n                                                        .populationFrequencies=\"", "\"\n                                                        .consequenceTypes=\"", "\"\n                                                        .query=\"", "\"\n                                                        .config=\"", "\"\n                                                        .searchButton=\"", "\"\n                                                        @queryChange=\"", "\"\n                                                        @querySearch=\"", "\">\n                                </opencga-variant-filter>\n                            "]);

  opencga_facet_templateObject20 = function _templateObject20() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject19() {
  const data = opencga_facet_taggedTemplateLiteral(["\n            <div class=\"page-title\">\n                <h2>\n                    <i class=\"", "\" aria-hidden=\"true\"></i>&nbsp;", "\n                </h2>\n            </div>\n\n            <div class=\"row\" style=\"padding: 0px 10px\">\n                <div class=\"col-md-2 left-menu\">\n                \n                    <div class=\"search-button-wrapper\">\n                        <button type=\"button\" class=\"btn btn-primary ripple\" @click=\"", "\">\n                            <i class=\"fa fa-arrow-circle-right\" aria-hidden=\"true\"></i> Run\n                        </button>\n                    </div>\n                    <ul class=\"nav nav-tabs left-menu-tabs\" role=\"tablist\">\n                        <li role=\"presentation\" class=\"active\"><a href=\"#filters_tab\" aria-controls=\"profile\" role=\"tab\" data-toggle=\"tab\">Filters</a></li>\n                        <li role=\"presentation\"><a href=\"#facet_tab\" aria-controls=\"home\" role=\"tab\" data-toggle=\"tab\">Aggregation</a></li>\n                    </ul>\n                    \n                    <div class=\"tab-content\">\n                        <div role=\"tabpanel\" class=\"tab-pane active\" id=\"filters_tab\">\n                                     \n                            <!-- dynamic render doesn't work well with active-filter events  _filterComp ", " -->\n                            \n                            ", "\n                            \n                            ", "\n                            \n                            ", "\n                            \n                            ", "                            \n                            \n                            ", "\n                            \n                            ", "\n                            \n                            ", "\n                            \n                            ", "\n                            \n                        </div>\n                        \n                        <div role=\"tabpanel\" class=\"tab-pane\" id=\"facet_tab\" aria-expanded=\"true\">\n                            <div class=\"facet-selector\">\n                                <label>Select a Term or Range Facet</label>\n                                    <select-field-filter multiple .data=\"", "\" .value=", " @filterChange=\"", "\"></select-field-filter>\n                                    <div class=\"text-center\">\n                                        <p class=\"or-text\">- or -</p>\n                                        <button class=\"btn btn-default btn-small ripple\" @click=\"", "\">Add default fields</button>\n                                    </div> \n                            </div>\n                            \n                            <div class=\"facet-list-container\">\n                                <label>Selected facets</label>\n                                <div class=\"facet-list\">\n                                    <!-- this.selectedFacet <pre>", "</pre> --> \n                                    \n                                    ", "\n                                </div>\n                            </div>\n                        </div>\n                        \n                    </div>\n                </div>\n\n                <div class=\"col-md-10\">\n                \n                    <!-- tabs buttons -->\n                    <div>\n                        <div class=\"btn-group content-pills\" role=\"toolbar\" aria-label=\"toolbar\">\n                            <div class=\"btn-group\" role=\"group\" style=\"margin-left: 0px\">\n                                <button type=\"button\" class=\"btn btn-success active ripple content-pills\" data-view=\"table-results\" @click=\"", "\" data-id=\"table\">\n                                    <i class=\"fa fa-table icon-padding\" aria-hidden=\"true\"></i> Table Result\n                                </button>\n                                <button type=\"button\" class=\"btn btn-success ripple content-pills\" data-view=\"facet-results\" @click=\"", "\" data-id=\"aggregation\">\n                                    <i class=\"fas fa-chart-bar icon-padding\" aria-hidden=\"true\"></i> Aggregation stats\n                                </button>\n                                <button type=\"button\" class=\"btn btn-success ripple content-pills\" data-view=\"comparator\" @click=\"", "\" data-id=\"comparator\">\n                                    <i class=\"fa fa-users icon-padding\" aria-hidden=\"true\"></i> Comparator\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div>\n                        <opencga-active-filters facetActive \n                                                .opencgaSession=\"", "\"\n                                                .defaultStudy=\"", "\"\n                                                .query=\"", "\"\n                                                .refresh=\"", "\"\n                                                .facetQuery=\"", "\"\n                                                .alias=\"", "\"\n                                                .config=\"", "\"\n                                                .filters=\"", "\"\n                                                @activeFacetChange=\"", "\"\n                                                @activeFacetClear=\"", "\"\n                                                @activeFilterChange=\"", "\"\n                                                @activeFilterClear=\"", "\">\n                        </opencga-active-filters>\n\n                    \n                        <div id=\"table-results\" class=\"content-tab\">\n                        <!-- TODO continue integrating browser grids -->\n                            ", "\n                        </div>\n                        \n                        <div id=\"facet-results\" class=\"content-tab\">\n                            <opencb-facet-results .active=\"", "\"\n                                                  .data=\"", "\"\n                                                  .error=\"", "\">\n                            </opencb-facet-results>\n                        </div>\n                                                \n                        <!-- RESULTS - Facet Plots \n                        <div id=\"loading\" style=\"display: none\">\n                            <loading-spinner></loading-spinner>\n                        </div>\n                        ", "\n                        ", "\n\n                        ", "\n                        -->\n                    </div>\n                </div>\n            </div>\n        "]);

  opencga_facet_templateObject19 = function _templateObject19() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject18() {
  const data = opencga_facet_taggedTemplateLiteral(["\n \n        <style include=\"jso-styles\">\n        </style>\n\n        ", "\n    "]);

  opencga_facet_templateObject18 = function _templateObject18() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject17() {
  const data = opencga_facet_taggedTemplateLiteral(["entity not recognized"]);

  opencga_facet_templateObject17 = function _templateObject17() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject16() {
  const data = opencga_facet_taggedTemplateLiteral(["job grid"]);

  opencga_facet_templateObject16 = function _templateObject16() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject15() {
  const data = opencga_facet_taggedTemplateLiteral(["<opencga-clinical-analysis-grid .opencgaSession=\"", "\"\n                                                            .config=\"", "\"\n                                                            .analyses=\"", "\"\n                                                            .query=\"", "\"\n                                                            .search=\"", "\"\n                                                            .active=\"", "\"\n                                                            @selectanalysis=\"", "\">\n                                </opencga-clinical-analysis-grid>\n        \n                                <div style=\"padding-top: 5px\">\n                                <ul id=\"", "ViewTabs\" class=\"nav nav-tabs\" role=\"tablist\">\n                                    <li role=\"presentation\" class=\"active\">\n                                        <a href=\"#", "SampleViewer\" role=\"tab\" data-toggle=\"tab\" class=\"detail-tab-title\">Clinical Analysis Info</a>\n                                    </li>\n                                </ul>\n                \n                                    <div class=\"tab-content\" style=\"height: 680px\">\n                                        <div role=\"tabpanel\" class=\"tab-pane active\" id=\"", "SampleViewer\">\n                                            <clinical-analysis-view .opencgaSession=\"", "\"\n                                                                .opencgaClient=\"", "\"\n                                                                .clinicalAnalysisId=\"", "\"\n                                                                .config=\"", "\">\n                                            </clinical-analysis-view>\n                                        </div>\n                                    </div>\n                                </div>"]);

  opencga_facet_templateObject15 = function _templateObject15() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject14() {
  const data = opencga_facet_taggedTemplateLiteral(["<opencga-family-grid .opencgaClient=\"", "\"\n                                                .opencgaSession=\"", "\"\n                                                .query=\"", "\"\n                                                .config=\"", "\"\n                                                .eventNotifyName=\"", "\"\n                                                .families=\"", "\"\n                                                .search=\"", "\"\n                                                .active=\"", "\"\n                                                @selectfamily=\"", "\">\n                        </opencga-family-grid>\n                "]);

  opencga_facet_templateObject14 = function _templateObject14() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject13() {
  const data = opencga_facet_taggedTemplateLiteral(["<opencga-cohort-grid .opencgaSession=\"", "\"\n                                                     .opencgaClient=\"", "\"\n                                                     .query=\"", "\"\n                                                     .search=\"", "\"\n                                                     .config=\"", "\"\n                                                     .eventNotifyName=\"", "\"\n                                                     .active=\"", "\"\n                                                     @selectcohort=\"", "\">\n                                                </opencga-cohort-grid>\n        \n                                <div style=\"padding-top: 5px\">\n                                    <ul id=\"", "ViewTabs\" class=\"nav nav-tabs\" role=\"tablist\">\n                                        <li role=\"presentation\" class=\"active\">\n                                            <a href=\"#", "CohortViewer\" role=\"tab\" data-toggle=\"tab\" class=\"detail-tab-title\"\n                                               data-id=\"info\" @click=\"", "\">\n                                                Cohort info\n                                            </a>\n                                        </li>\n        \n                                        <li role=\"presentation\">\n                                            <a href=\"#", "SampleViewer\" role=\"tab\" data-toggle=\"tab\" class=\"detail-tab-title\"\n                                               data-id=\"sampleGrid\" @click=\"", "\">\n                                                Sample grid\n                                            </a>\n                                        </li>\n                                    </ul>\n        \n                                    <div class=\"tab-content\" style=\"height: 680px\">\n                                        <div role=\"tabpanel\" class=\"tab-pane active\" id=\"", "CohortViewer\">\n                                            Work in progress\n                                        </div>\n                                        <div role=\"tabpanel\" class=\"tab-pane\" id=\"", "SampleViewer\">\n                                            <opencga-sample-grid .opencgaClient=\"", "\"\n                                                                 .opencgaSession=\"", "\"\n                                                                 .search=\"", "\"\n                                                                 .active=\"", "\">\n                                            </opencga-sample-grid>\n                                        </div>\n        \n                                    </div>\n                                </div>"]);

  opencga_facet_templateObject13 = function _templateObject13() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject12() {
  const data = opencga_facet_taggedTemplateLiteral(["<opencga-individual-grid .opencgaClient=\"", "\"\n                                                 .opencgaSession=\"", "\"\n                                                 .config=\"", "\"\n                                                 .eventNotifyName=\"", "\"\n                                                 .individuals=\"", "\"\n                                                 .search=\"", "\"\n                                                 .active=\"", "\">\n                            </opencga-individual-grid>\n\n                            \n                            <h3> Annotation comparator</h3>\n                            <opencga-annotation-viewer .opencgaClient=\"", "\"\n                                                       .opencgaSession=\"", "\"\n                                                       .config=\"", "\"\n                                                       .entryIds=\"", "\"\n                                                       entity=\"INDIVIDUAL\">\n                            </opencga-annotation-viewer>"]);

  opencga_facet_templateObject12 = function _templateObject12() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject11() {
  const data = opencga_facet_taggedTemplateLiteral(["<opencga-sample-grid .opencgaSession=\"", "\"\n                                                     .query=\"", "\"\n                                                     .search=\"", "\"\n                                                     .config=\"", "\"\n                                                     .samples=\"", "\"\n                                                     .active=\"", "\"\n                                                     @selectsample=\"", "\">\n                                 </opencga-sample-grid>"]);

  opencga_facet_templateObject11 = function _templateObject11() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject10() {
  const data = opencga_facet_taggedTemplateLiteral(["<opencga-file-grid .opencgaSession=\"", "\"\n                                                       .config=\"", "\"\n                                                       .query=\"", "\"\n                                                       .search=\"", "\"\n                                                       .eventNotifyName=\"", "\"\n                                                       .files=\"", "\"\n                                                       @selectfile=\"", "\">\n                                 </opencga-file-grid>\n                            <h3> Annotation comparator</h3>\n                            <opencga-annotation-viewer .opencgaClient=\"", "\"\n                                                       .opencgaSession=\"", "\"\n                                                       .config=\"", "\"\n                                                       .entryIds=\"", "\"\n                                                       entity=\"FILE\">\n                            </opencga-annotation-viewer>"]);

  opencga_facet_templateObject10 = function _templateObject10() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject9() {
  const data = opencga_facet_taggedTemplateLiteral(["no type recognized"]);

  opencga_facet_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject8() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                    <div class=\"col-md-12\">\n                        <input type=\"text\" class=\"form-control\" placeholder=\"Include values\" data-parent-facet=\"", "\" id=\"", "", "_Nested_text\" .value=\"", "\"  @input=\"", "\"  />\n                    </div>"]);

  opencga_facet_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject7() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                    <div class=\"col-md-6\">\n                        <input type=\"text\" class=\"form-control\" placeholder=\"Include values or set range\" data-parent-facet=\"", "\" .disabled=\"", "\" id=\"", "", "_NestedValue\" .value=\"", "\"  @input=\"", "\"  />\n                    </div>\n                    <div class=\"col-md-6\">\n                        <select-field-filter .disabled=\"", "\" .data=\"", "\" .value=\"", "\" id=\"", "_NestedFnSelect\" data-parent-facet=\"", "\" @filterChange=\"", "\"></select-field-filter>\n                    </div>\n                "]);

  opencga_facet_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject6() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                    <div class=\"col-md-12\">\n                        <select-field-filter ?multiple=\"", "\" .data=\"", "\" .value=\"", "\" id=\"", "_NestedSelect\" data-parent-facet=\"", "\" @filterChange=\"", "\"></select-field-filter>\n                    </div>\n                "]);

  opencga_facet_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject5() {
  const data = opencga_facet_taggedTemplateLiteral(["no type recognized: ", ""]);

  opencga_facet_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject4() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                    <div class=\"row facet-row\">\n                        <div class=\"col-md-12\">\n                            <input type=\"text\" class=\"form-control\" placeholder=\"Include values\" @input=\"", "\" data-id=\"", "\" type=\"text\" .value=\"", "\" id=\"", "_NestedFnSelect\"  />\n                        </div>\n                    </div>\n                    ", "\n                "]);

  opencga_facet_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject3() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                    <div class=\"row facet-row\">\n                        <div class=\"col-md-6\">\n                            <input type=\"text\" class=\"form-control\" placeholder=\"Include values or set range\" id=\"", "", "_text\" data-id=\"", "\" .value=\"", "\" @input=\"", "\" />\n                        </div>\n                        <div class=\"col-md-6\">\n                            <select-field-filter .data=\"", "\" .value=\"", "\" id=\"", "", "_FnSelect\" data-facet=\"", "\" @filterChange=\"", "\"></select-field-filter>\n                        </div>\n                    </div>\n                    ", "\n                "]);

  opencga_facet_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject2() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                    <div class=\"row facet-row\">\n                        <div class=\"col-md-12\">\n                            <select-field-filter ?multiple=\"", "\" .data=\"", "\" .value=\"", "\" id=\"", "_Select\" data-id=\"", "\" @filterChange=\"", "\"></select-field-filter>\n                        </div>\n                    </div>\n                    ", "\n                    "]);

  opencga_facet_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_facet_templateObject() {
  const data = opencga_facet_taggedTemplateLiteral(["\n                    <!-- nested facet -->\n                    <div class=\"row facet-row nested\">\n                        <div class=\"col-md-12 text-center\">\n                            <a class=\"btn btn-small collapsed\" role=\"button\" data-collapse=\"#", "_nested\" @click=\"", "\"> <i class=\"fas fa-arrow-alt-circle-down\"></i> Nested Facet (optional) </a>\n                            <div class=\"collapse ", "\" id=\"", "_nested\"> \n                                <div class=\"\">\n                                    <select-field-filter .data=\"", "\" .value=", " @filterChange=\"", "\"></select-field-filter>\n                                    <div class=\"row facet-row nested\">\n                                        ", "\n                                    </div>                                \n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- /nested facet -->\n        "]);

  opencga_facet_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_facet_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_facet_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_facet_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_facet_ownKeys(Object(source), true).forEach(function (key) { opencga_facet_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_facet_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_facet_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */









 // this is the new opencga-browser
// TODO spring-cleaning the old code
// TODO maybe remove this._config, this.config is enough here
// TODO fix props in EACH opencga-x-filter

class opencga_facet_OpencgaFacet extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      resource: {
        type: String
      },
      opencgaSession: {
        type: Object
      },
      query: {
        type: Object
      },
      search: {
        type: Object
      },
      config: {
        type: Object
      },
      facetQuery: {
        type: Object
      },
      selectedFacet: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "facet" + utils.randomString(6);
    this.checkProjects = false;
    this.activeFilterAlias = {
      "annot-xref": "XRef",
      "biotype": "Biotype",
      "annot-ct": "Consequence Types",
      "alternate_frequency": "Population Frequency",
      "annot-functional-score": "CADD",
      "protein_substitution": "Protein Substitution",
      "annot-go": "GO",
      "annot-hpo": "HPO"
    };
    this.fixedFilters = ["studies"]; // These are for making the queries to server

    this.facetFields = [];
    this.facetRanges = [];
    this.facetFieldsName = [];
    this.facetRangeFields = [];
    this.results = [];
    this._showInitMessage = true;
    this.facetConfig = {
      a: 1
    };
    this.facetActive = true;
    this.query = {};
    this.preparedQuery = {};
    this.selectedFacet = {};
    this.selectedFacetFormatted = {};
    this.errorState = false;
    this.activeTab = {};
  }

  connectedCallback() {
    super.connectedCallback(); // TODO we don't need _config anymore

    this._config = opencga_facet_objectSpread({}, this.config);
  }

  firstUpdated(_changedProperties) {
    $(".bootstrap-select", this).selectpicker();
  }

  updated(changedProperties) {
    if (changedProperties.has("config")) {// this.configObserver();
    }

    if (changedProperties.has("opencgaSession")) {
      this.opencgaSessionObserver();
    }
    /* if (changedProperties.has("executedQuery")) {
        this.fetchVariants();
    }*/


    if (changedProperties.has("query")) {
      this.queryObserver();
    }

    if (changedProperties.has("selectedFacet")) {
      this.selectedFacetObserver();
    }
  }

  queryObserver() {
    // Query passed is executed and set to variant-filter, active-filters and variant-grid components
    let _query = {};

    if (utilsNew_UtilsNew.isEmpty(this.query) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.study)) {
      _query = {
        study: this.opencgaSession.study.fqn
      };
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query)) {
      this.preparedQuery = opencga_facet_objectSpread({}, _query, {}, this.query);
      this.executedQuery = opencga_facet_objectSpread({}, _query, {}, this.query);
    } // onServerFilterChange() in opencga-active-filters drops a filterchange event when the Filter dropdown is used


    this.dispatchEvent(new CustomEvent("queryChange", {
      detail: this.preparedQuery
    }));
    this.requestUpdate();
  }

  opencgaSessionObserver() {
    // debugger
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.project)) {
      // Update cohorts from config, this updates the Cohort filter MAF
      //TODO check WHERE this make sense
      for (const section of this._config.filter.sections) {
        for (const subsection of section.fields) {
          if (subsection.id === "cohort") {
            const projectFields = this.opencgaSession.project.alias.split("@");
            const projectId = projectFields.length > 1 ? projectFields[1] : projectFields[0];
            this.cohorts = subsection.cohorts[projectId]; // this.set('cohorts', subsection.cohorts[projectId]);
            // debugger
          }
        }
      }

      this.checkProjects = true;
      this.requestUpdate().then(() => $(".bootstrap-select", this).selectpicker());
    } else {
      this.checkProjects = false;
    }
  }

  selectedFacetObserver() {
    /**
     * Helper for formatting the list of facets to show in opencga-active-filters
     */
    const _valueFormatter = (k, v) => {
      let str = "";

      if (v.fn && (v.fn === "Avg" || v.fn === "Percentile")) {
        str = v.fn + "(" + k + ")";
      } else {
        str = k + v.value;
      }

      if (v.nested) {
        str += ">>" + (v.nested.fn && (v.nested.fn === "Avg" || v.nested.fn === "Percentile") ? v.nested.fn + "(" + v.nested.facet + ")" : v.nested.facet + v.nested.value);
      }

      return str;
    };

    if (Object.keys(this.selectedFacet).length) {
      // Object property spreading cannot be used here as it creates an Object with numeric indexes in Chrome 78...
      this.selectedFacetFormatted = Object.assign({}, ...Object.keys(this.selectedFacet).map(k => ({
        [k]: opencga_facet_objectSpread({}, this.selectedFacet[k], {
          formatted: _valueFormatter(k, this.selectedFacet[k])
        })
      })));
    } else {
      this.selectedFacetFormatted = {};
    }

    this.requestUpdate();
  }

  addDefaultFacet() {
    for (const defaultFacetId of this._config.aggregation.default) {
      const facet = defaultFacetId.split(">>");
      console.log(facet); // in case of nested facets

      if (facet.length > 1) {
        const mainFacet = this._recFind(this._config.aggregation.sections, facet[0]);

        const nestedFacet = this._recFind(this._config.aggregation.sections, facet[1]);

        console.log("nestedFacet", nestedFacet);
        this.selectedFacet[facet[0]] = opencga_facet_objectSpread({}, mainFacet, {
          value: mainFacet && mainFacet.defaultValue ? mainFacet.defaultValue : "",
          nested: opencga_facet_objectSpread({}, nestedFacet, {
            facet: facet[1],
            value: nestedFacet.defaultValue || ""
          })
        });
      } else {
        const mainFacet = this._recFind(this._config.aggregation.sections, facet[0]);

        this.selectedFacet[defaultFacetId] = opencga_facet_objectSpread({}, mainFacet, {
          value: mainFacet && mainFacet.defaultValue ? mainFacet.defaultValue : ""
        });
      }
    }

    this.selectedFacet = opencga_facet_objectSpread({}, this.selectedFacet);
  }

  notifySearch(query) {
    this.dispatchEvent(new CustomEvent("querySearch", {
      detail: {
        query: query
      },
      bubbles: true,
      composed: true
    }));
  } // TODO since this is the new opencga-browser, this have to be moved this in opencga-facet-results


  async onRun() {
    this.clearPlots();

    const queryParams = opencga_facet_objectSpread({}, this.preparedQuery, {
      // sid: this.opencgaClient._config.sessionId,
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias,
      timeout: 60000,
      field: Object.values(this.selectedFacetFormatted).map(v => v.formatted).join(";")
    }); // this event keeps in sync the query object with the one in iva-app
    // TODO do not use this.preparedQuery, use this.query (change this component accordingly)


    this.notifySearch(this.preparedQuery); // this.querySelector("#loading").style.display = "block";

    this.endpoint.aggregationStats(queryParams, {}).then(queryResponse => {
      console.log("queryResponse", queryResponse);
      this.errorState = false;
      this.facetResults = queryResponse.response[0].result[0].results;
      this.requestUpdate();
    }).catch(e => {
      this.errorState = "Error from server: " + e.error;
      this.requestUpdate();
    }).finally(() => {//this.querySelector("#loading").style.display = "none";
    });
  }

  async onFacetFieldChange(e) {
    const currentSelectionNames = e.detail.value ? e.detail.value.split(",") : []; // compute the symmetric difference between this.selectedFacet and currentSelectionNames

    const differences = Object.keys(this.selectedFacet).filter(a => !currentSelectionNames.includes(a)).concat(currentSelectionNames.filter(name => !Object.keys(this.selectedFacet).includes(name))); // the difference involves one item a time

    if (differences.length > 1) console.error("Difference error!", this.selectedFacet, currentSelectionNames);
    const difference = differences[0]; // addition

    if (currentSelectionNames.length > Object.keys(this.selectedFacet).length) {
      console.log("addition of", difference); // Array.find() cannot be nested.. let newField = this._config.aggregation.sections.find(field => field.fields ? field.fields.find(nested => nested === difference) : field.name === difference);
      // console.log(this._config.aggregation.sections, difference)

      const newField = this._recFind(this._config.aggregation.sections, difference); // console.log("newField", newField)


      this.selectedFacet[difference] = opencga_facet_objectSpread({}, newField, {
        value: newField && newField.defaultValue ? newField.defaultValue : ""
      });
      await this.requestUpdate();
      $(".bootstrap-select", this).selectpicker();
    } else {
      console.log("deletion of", difference); // deletion

      delete this.selectedFacet[difference];
    }

    this.selectedFacet = opencga_facet_objectSpread({}, this.selectedFacet);
    this.requestUpdate();
  }

  onFacetValueChange(e) {
    // console.log("onFacetValueChange",e);
    const id = e.target.dataset.id; // this.selectedFacet = {...this.selectedFacet, [id]: (e.target.value.trim() ? e.target.value : "")};

    this.selectedFacet[id].value = e.target.value.trim() ? e.target.value : "";
    this.selectedFacet = opencga_facet_objectSpread({}, this.selectedFacet);
    this.requestUpdate();
  }

  onFacetSelectChange(e) {
    // console.log("onFacetSelectChange",e);
    const id = e.target.dataset.id; // this.selectedFacet = {...this.selectedFacet, [id]: (e.target.value.trim() ? e.target.value : "")};

    this.selectedFacet[id].value = e.detail.value ? e.detail.value : "";
    this.selectedFacet = opencga_facet_objectSpread({}, this.selectedFacet);
    this.requestUpdate();
  }

  onFacetFnChange(e) {
    const value = e.detail.value;
    const facet = e.target.dataset.facet;

    if (value && (value === "Avg" || value === "Percentile")) {
      this.selectedFacet[facet]["fn"] = value;
      this.querySelector("#" + this._prefix + facet + "_text").disabled = true;
    } else {
      delete this.selectedFacet[facet]["fn"];
      this.querySelector("#" + this._prefix + facet + "_text").disabled = false;
    }

    this.selectedFacet = opencga_facet_objectSpread({}, this.selectedFacet);
    this.requestUpdate();
  }

  toggleCollapse(e) {
    $(e.target.dataset.collapse).collapse("toggle");
  }

  onNestedFacetValueChange(e) {
    this.selectedFacet[e.target.dataset.parentFacet].nested.value = e.target.value;
    this.selectedFacet = opencga_facet_objectSpread({}, this.selectedFacet);
    this.requestUpdate();
  }

  onNestedFacetFieldChange(e, parent) {
    const selected = e.detail.value;

    if (selected) {
      const newField = this._recFind(this._config.aggregation.sections, selected);

      this.selectedFacet[parent].nested = opencga_facet_objectSpread({}, newField, {
        facet: selected,
        value: newField.defaultValue || ""
      });
    } else {
      delete this.selectedFacet[parent].nested;
    }

    this.selectedFacet = opencga_facet_objectSpread({}, this.selectedFacet);
    this.requestUpdate();
  }

  onNestedFacetFnChange(e) {
    const value = e.detail.value;
    const facet = e.target.dataset.parentFacet;
    console.log("nestedFacetFNCHANGE", "#" + this._prefix + facet + "_NestedValue");

    if (value && (value === "Avg" || value === "Percentile")) {
      if (this.selectedFacet[facet].nested) {
        this.selectedFacet[facet].nested.fn = value;
        this.querySelector("#" + this._prefix + facet + "_NestedValue").disabled = true;
      } else {
        console.error("function selected before facet!");
      }
    } else {
      this.querySelector("#" + this._prefix + facet + "_NestedValue").disabled = false;
      delete this.selectedFacet[facet].nested.fn;
    }

    this.selectedFacet = opencga_facet_objectSpread({}, this.selectedFacet);
    this.requestUpdate();
  }

  onActiveFacetChange(e) {
    this.selectedFacet = opencga_facet_objectSpread({}, e.detail); // console.log("selectedFacet",Object.keys(this.selectedFacet))

    $("#" + this._prefix + "FacetField", this).selectpicker("val", Object.keys(this.selectedFacet));
    this.requestUpdate();
  }

  onActiveFacetClear(e) {
    this.selectedFacet = {};
    $("#" + this._prefix + "FacetField", this).selectpicker("val", "deselectAll");
    this.requestUpdate();
  }

  onFilterChange(e) {
    this.query = e.detail; // TODO remove search field everywhere. use query instead

    this.search = e.detail;
  }

  clearPlots() {
    if (utilsNew_UtilsNew.isNotUndefined(this.results) && this.results.length > 0) {
      for (const result of this.results) {
        PolymerUtils_PolymerUtils.removeElement(this._prefix + result.name + "Plot");
      }
    }

    this.results = [];
  }

  clearAll() {
    this.clearPlots();
    this.chromosome = "";
    this.facetFields = [];
    this.facetRanges = [];
    this.facetFieldsName = [];
    this.facetRangeFields = [];
    this._showInitMessage = true;
    PolymerUtils_PolymerUtils.setAttributeByClassName(this._prefix + "FilterSelect", "selectedIndex", 0);
    PolymerUtils_PolymerUtils.setValue(this._prefix + "FieldIncludes", "");
    PolymerUtils_PolymerUtils.setValue(this._prefix + "NestedFieldIncludes", "");
    PolymerUtils_PolymerUtils.setValue(this._prefix + "ChromosomeInput", "");
    PolymerUtils_PolymerUtils.removeAttribute(this._prefix + "ChromosomeAdd", "disabled");
  }

  onHistogramChart(e) {
    this.highlightActivePlot(e.target.parentElement);
    const id = e.target.dataId; // TODO Refactor

    this.renderHistogramChart("#" + this._prefix + id + "Plot", id);
    PolymerUtils_PolymerUtils.hide(this._prefix + id + "Table");
  }

  onPieChart(e) {
    this.highlightActivePlot(e.target.parentElement);
    const id = e.target.dataId;
    this.renderPieChart("#" + this._prefix + id + "Plot", id);
    PolymerUtils_PolymerUtils.hide(this._prefix + id + "Table");
  }

  onTabularView(e) {
    this.highlightActivePlot(e.target.parentElement);
    const id = e.target.dataId;
    PolymerUtils_PolymerUtils.innerHTML(this._prefix + id + "Plot", "");
    PolymerUtils_PolymerUtils.show(this._prefix + id + "Table", "table");
  }

  highlightActivePlot(button) {} // PolymerUtils.removeClass(".plots", "active");
  // PolymerUtils.addClass(button, "active");

  /*    fetchVariants() {
      console.log("executedQuery changed!!");
      if (UtilsNew.isNotUndefined(this.opencgaClient)) {
          const queryParams = {
              sid: this.opencgaClient._config.sessionId,
              timeout: 60000,
              summary: true,
              limit: 1
          };
          Object.assign(queryParams, this.query);
           if (UtilsNew.isEmpty(queryParams.studies) || queryParams.studies.split(new RegExp("[,;]")).length === 1) {
              queryParams.studies = this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias;
          }
           const _this = this;
          this.opencgaClient.variants().query(queryParams, {})
              .then(function(response) {
                  _this.totalVariants = response.response[0].numTotalResults;
                  console.log("_this.totalVariants", _this.totalVariants);
              });
      }
  }*/


  _recFind(array, value) {
    for (const f of array) {
      if (f.fields) {
        const r = this._recFind(f.fields, value);

        if (r) return r;
      } else {
        if (f.id === value) {
          // console.log("found", f);
          return f;
        }
      }
    }
  }

  _changeView(e) {
    e.preventDefault();
    $(".content-pills").removeClass("active");
    $(".content-tab").hide();
    $(e.currentTarget).addClass("active");
    $("#" + e.currentTarget.dataset.view).show();

    for (const tab in this.activeTab) this.activeTab[tab] = false;

    this.activeTab[e.currentTarget.dataset.view] = true;
    /* if (e.target.dataset.view === "Summary") {
        this.SummaryActive = true;
        this.requestUpdate();
    } else {
        this.SummaryActive = false;
    }*/

    this.requestUpdate();
  }

  onQueryFilterChange(e) {
    this.preparedQuery = e.detail.query;
    this.requestUpdate();
  }

  onActiveFilterChange(e) {
    console.log("onActiveFilterChange on variant facet", e.detail); // TODO FIXME study prop have to be wiped off if possible. use studies instead

    this.preparedQuery = opencga_facet_objectSpread({
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias
    }, e.detail);
    this.query = opencga_facet_objectSpread({
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias
    }, e.detail);
  }

  onActiveFilterClear() {
    console.log("onActiveFilterClear");
    this.query = {
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias
    };
    this.preparedQuery = opencga_facet_objectSpread({}, this.query);
  }

  renderField(facet) {
    const renderNestedFieldWrapper = facet => lit_html_lit_html_html(opencga_facet_templateObject(), facet.id, this.toggleCollapse, this.selectedFacet[facet.id].nested ? "in" : "", facet.id, this._config.aggregation.sections.map(section => opencga_facet_objectSpread({}, section, {
      fields: section.fields.map(item => opencga_facet_objectSpread({}, item, {
        disabled: item.id === facet.id
      }))
    })), this.selectedFacet[facet.id].nested ? this.selectedFacet[facet.id].nested.id : null, e => this.onNestedFacetFieldChange(e, facet.id), this.renderNestedField(this.selectedFacet[facet.id].nested, facet.id));

    switch (facet.type) {
      case "category":
        return lit_html_lit_html_html(opencga_facet_templateObject2(), !!facet.multiple, facet.allowedValues, facet.defaultValue ? facet.defaultValue : "", facet.id, facet.id, this.onFacetSelectChange, renderNestedFieldWrapper(facet));

      case "number":
      case "integer":
      case "float":
        return lit_html_lit_html_html(opencga_facet_templateObject3(), this._prefix, facet.id, facet.id, facet.value || "", this.onFacetValueChange, ["Range", "Avg", "Percentile"], "Range", this._prefix, facet.id, facet.id, this.onFacetFnChange, renderNestedFieldWrapper(facet));

      case "string":
        return lit_html_lit_html_html(opencga_facet_templateObject4(), this.onFacetValueChange, facet.id, facet.defaultValue ? facet.defaultValue : "", facet.id, renderNestedFieldWrapper(facet));

      default:
        console.log("no type recognized", facet);
        return lit_html_lit_html_html(opencga_facet_templateObject5(), facet.type);
    }
  }

  renderNestedField(facet, parent) {
    if (!facet || !facet.type) return null;
    console.log("renderNestedField", facet);

    switch (facet.type) {
      case "category":
        return lit_html_lit_html_html(opencga_facet_templateObject6(), !!facet.multiple, facet.values, facet.defaultValue ? facet.defaultValue : "", facet.id, parent, this.onNestedFacetValueChange);

      case "number":
      case "integer":
      case "float":
        return lit_html_lit_html_html(opencga_facet_templateObject7(), parent, !facet.facet, this._prefix, parent, facet.value || "", this.onNestedFacetValueChange, false, ["Range", "Avg", "Percentile"], "Range", parent, parent, this.onNestedFacetFnChange);

      case "string":
        return lit_html_lit_html_html(opencga_facet_templateObject8(), parent, this._prefix, facet.id, facet.value || "", this.onNestedFacetValueChange);

      default:
        return lit_html_lit_html_html(opencga_facet_templateObject9());
    }
  }

  renderGrid(entity) {
    switch (entity) {
      // TODO handle specific events
      case "files":
        this.endpoint = this.opencgaSession.opencgaClient.files();
        return lit_html_lit_html_html(opencga_facet_templateObject10(), this.opencgaSession, this._config.filter.grid, this.executedQuery, this.executedQuery, this.eventNotifyName, this.files, this.onSelectFile, this.opencgaSession.opencgaClient, this.opencgaSession, this._config, this.files);

      case "samples":
        this.endpoint = this.opencgaSession.opencgaClient.samples();
        return lit_html_lit_html_html(opencga_facet_templateObject11(), this.opencgaSession, this.executedQuery, this.executedQuery, this._config.filter.grid, this.samples, true, this.onSelectSample);

      case "individuals":
        this.endpoint = this.opencgaSession.opencgaClient.individuals();
        return lit_html_lit_html_html(opencga_facet_templateObject12(), this.opencgaSession.opencgaClient, this.opencgaSession, this._config.filter.grid, this.eventNotifyName, this.individuals, this.search, true, this.opencgaSession.opencgaClient, this.opencgaSession, this._config, this.individuals);

      case "cohort":
        this.endpoint = this.opencgaSession.opencgaClient.cohorts();
        return lit_html_lit_html_html(opencga_facet_templateObject13(), this.opencgaSession, this.opencgaSession.opencgaClient, this.executedQuery, this.executedQuery, this._config.filter.grid, this.eventNotifyName, true, this.onSelectCohort, this._prefix, this._prefix, this._changeBottomTab, this._prefix, this._changeBottomTab, this._prefix, this._prefix, this.opencgaSession.opencgaClient, this.opencgaSession, this.sampleSearch, true);

      case "family":
        this.endpoint = this.opencgaSession.opencgaClient.families();
        return lit_html_lit_html_html(opencga_facet_templateObject14(), this.opencgaSession.opencgaClient, this.opencgaSession, this.executedQuery, this._config.filter.grid, this.eventNotifyName, this.families, this.search, true, this.onSelectFamily);

      case "clinical-analysis":
        this.endpoint = this.opencgaSession.opencgaClient.clinical();
        return lit_html_lit_html_html(opencga_facet_templateObject15(), this.opencgaSession, this._config.filter.grid, this._config.analyses, this.executedQuery, this.executedQuery, true, this.onSelectClinicalAnalysis, this._prefix, this._prefix, this._prefix, this.opencgaSession, this.opencgaSession.opencgaClient, this._config.analysis.id, this._config.sampleDetail);

      case "jobs":
        this.endpoint = this.opencgaSession.opencgaClient.jobs();
        return lit_html_lit_html_html(opencga_facet_templateObject16());

      default:
        return lit_html_lit_html_html(opencga_facet_templateObject17());
    }
  }

  render() {
    return lit_html_lit_html_html(opencga_facet_templateObject18(), this.checkProjects ? lit_html_lit_html_html(opencga_facet_templateObject19(), this._config.icon, this._config.title, this.onRun, this._filterComp, this.resource === "variants" ? lit_html_lit_html_html(opencga_facet_templateObject20(), this.opencgaSession, this.opencgaSession.opencgaClient, this.cellbaseClient, this.populationFrequencies, this.consequenceTypes, this.query, this._config.filter, false, this.onQueryFilterChange, this.onQueryFilterSearch) : null, this.resource === "files" ? lit_html_lit_html_html(opencga_facet_templateObject21(), this.opencgaSession, this._config.filter, this.files, this.query, this.search, this.variableSets, false, this.onQueryFilterChange, this.onQueryFilterSearch) : null, this.resource === "samples" ? lit_html_lit_html_html(opencga_facet_templateObject22(), this.opencgaSession, this.cellbaseClient, this._config.filter, this.query, this.search, this.variableSets, false, this.onQueryFilterChange, this.onQueryFilterSearch) : null, this.resource === "individuals" ? lit_html_lit_html_html(opencga_facet_templateObject23(), this.opencgaSession, this._config.filter, this.query, this.search, this.variableSets, false, this.onQueryFilterChange, this.onQueryFilterSearch) : null, this.resource === "family" ? lit_html_lit_html_html(opencga_facet_templateObject24(), this.opencgaSession, this._config.filter, this.query, this.search, this.variableSets, false, this.onQueryFilterChange, this.onQueryFilterSearch) : null, this.resource === "cohort" ? lit_html_lit_html_html(opencga_facet_templateObject25(), this.opencgaSession, this._config.filter, this.query, this.search, this.variableSets, false, this.onQueryFilterChange, this.onQueryFilterSearch) : null, this.resource === "clinical-analysis" ? lit_html_lit_html_html(_templateObject26(), this.opencgaSession, this._config.filter, this.config.analyses, this.search, this.query, false, this.onQueryFilterChange, this.onQueryFilterSearch) : null, this.resource === "jobs" ? lit_html_lit_html_html(_templateObject27()) : null, this._config.aggregation.sections.length > 1 ? this._config.aggregation.sections : this._config.aggregation.sections[0].fields, Object.keys(this.selectedFacet).join(","), this.onFacetFieldChange, this.addDefaultFacet, JSON.stringify(this.selectedFacet, null, "  "), Object.keys(this.selectedFacet).length > 0 ? Object.entries(this.selectedFacet).map(([, facet]) => lit_html_lit_html_html(_templateObject28(), this._prefix, facet.name, this._prefix, facet.id, this._prefix, facet.id, this._prefix, this.renderField(facet))) : lit_html_lit_html_html(_templateObject29()), this._changeView, this._changeView, this._changeView, this.opencgaSession, this.opencgaSession.study.alias, this.preparedQuery, this.executedQuery, this.selectedFacetFormatted, this.activeFilterAlias, this._config.activeFilters, this._config.filter.examples, this.onActiveFacetChange, this.onActiveFacetClear, this.onActiveFilterChange, this.onActiveFilterClear, this.renderGrid(this.resource), this.activeTab["facet-results"], this.facetResults, this.errorState, this.errorState ? lit_html_lit_html_html(_templateObject30(), this.errorState) : null, this._showInitMessage ? lit_html_lit_html_html(_templateObject31()) : null, this.facetResults && this.facetResults.length ? this.facetResults.map(item => lit_html_lit_html_html(_templateObject32(), item.name, item, this.facetConfig, this.facetActive)) : null) : lit_html_lit_html_html(_templateObject33()));
  }

}
customElements.define("opencga-facet", opencga_facet_OpencgaFacet);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/opencga-variant-facet.js
function opencga_variant_facet_templateObject17() {
  const data = opencga_variant_facet_taggedTemplateLiteral(["\n            <span style=\"text-align: center\"><h3>No public projects available to browse. Please login to continue</h3></span>\n        "]);

  opencga_variant_facet_templateObject17 = function _templateObject17() {
    return data;
  };

  return data;
}

function opencga_variant_facet_templateObject16() {
  const data = opencga_variant_facet_taggedTemplateLiteral(["\n                            <div class=\"facetResultsDiv\">\n                                <div>\n                                    <h3>", "</h3>\n                                    <opencga-facet-result-view .facetResult=\"", "\" .config=\"", "\" .active=\"", "\"></opencga-facet-result-view>\n                                </div>\n                            </div>\n                        "]);

  opencga_variant_facet_templateObject16 = function _templateObject16() {
    return data;
  };

  return data;
}

function opencga_variant_facet_templateObject15() {
  const data = opencga_variant_facet_taggedTemplateLiteral([""]);

  opencga_variant_facet_templateObject15 = function _templateObject15() {
    return data;
  };

  return data;
}

function opencga_variant_facet_templateObject14() {
  const data = opencga_variant_facet_taggedTemplateLiteral(["\n                            <div id=\"error\" class=\"alert alert-danger\" role=\"alert\">\n                                ", "\n                            </div>\n                        "]);

  opencga_variant_facet_templateObject14 = function _templateObject14() {
    return data;
  };

  return data;
}

function opencga_variant_facet_templateObject13() {
  const data = opencga_variant_facet_taggedTemplateLiteral(["\n                                        <div class=\"alert alert-info text-center\" role=\"alert\"><i class=\"fas fa-3x fa-info-circle\"></i><br><small>No aggregation field has been selected yet.</small></div>\n                                    "]);

  opencga_variant_facet_templateObject13 = function _templateObject13() {
    return data;
  };

  return data;
}

function opencga_variant_facet_templateObject12() {
  const data = opencga_variant_facet_taggedTemplateLiteral(["\n                                        <div class=\"facet-box\" id=\"", "Heading\">\n                                            <div class=\"subsection-content form-group\">\n                                                <div class=\"browser-subsection\">", "\n                                                    <div class=\"tooltip-div pull-right\">\n                                                        <a><i class=\"fa fa-info-circle\" aria-hidden=\"true\" id=\"", "", "Tooltip\"></i></a>\n                                                    </div>\n                                                </div>\n                                                <div id=\"", "", "\" class=\"\" role=\"tabpanel\" aria-labelledby=\"", "Heading\">\n                                                    <div class=\"\">\n                                                        ", "\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>                                    \n                                    "]);

  opencga_variant_facet_templateObject12 = function _templateObject12() {
    return data;
  };

  return data;
}

function opencga_variant_facet_templateObject11() {
  const data = opencga_variant_facet_taggedTemplateLiteral(["\n            <div class=\"page-title\">\n                <h2>\n                    <i class=\"", "\" aria-hidden=\"true\"></i>&nbsp;", "\n                </h2>\n            </div>\n            \n            <!-- \n            <div class=\"panel\" style=\"margin-bottom: 15px\">\n                <h3 style=\"margin: 10px 10px 10px 15px\">\n                    <i class=\"", "\" aria-hidden=\"true\"></i>&nbsp;", "\n                </h3>\n            </div> -->\n\n            <div class=\"row\" style=\"padding: 0px 10px\">\n                <div class=\"col-md-2 left-menu\">\n                \n                    <div class=\"search-button-wrapper\">\n                        <button type=\"button\" class=\"btn btn-primary ripple\" @click=\"", "\">\n                            <i class=\"fa fa-arrow-circle-right\" aria-hidden=\"true\"></i> Run\n                        </button>\n                    </div>\n                    <ul class=\"nav nav-tabs left-menu-tabs\" role=\"tablist\">\n                        <li role=\"presentation\" class=\"active\"><a href=\"#filters_tab\" aria-controls=\"profile\" role=\"tab\" data-toggle=\"tab\">Filters</a></li>\n                        <li role=\"presentation\"><a href=\"#facet_tab\" aria-controls=\"home\" role=\"tab\" data-toggle=\"tab\">Aggregation</a></li>\n                    </ul>\n                    \n                    <div class=\"tab-content\">\n                        <div role=\"tabpanel\" class=\"tab-pane\" id=\"facet_tab\">\n                            <div class=\"facet-selector\">\n                                <label>Select a Term or Range Facet</label>\n                                    <select-field-filter multiple .data=\"", "\" .value=", " @filterChange=\"", "\"></select-field-filter>\n                                    <div class=\"text-center\">\n                                        <p class=\"or-text\">- or -</p>\n                                        <button class=\"btn btn-default btn-small ripple\" @click=\"", "\">Add default fields</button>\n                                    </div> \n                            </div>\n                            \n                            <div class=\"facet-list-container\">\n                                <label>Selected facets</label>\n                                <div class=\"facet-list\">\n                                    <!-- this.selectedFacet <pre>", "</pre> --> \n                                    \n                                    ", "\n                                </div>\n                            </div>\n                        </div>\n                        \n                        <div role=\"tabpanel\" class=\"tab-pane active\" id=\"filters_tab\">\n                            <opencga-variant-filter .opencgaSession=", "\n                                                        .opencgaClient=\"", "\"\n                                                        .cellbaseClient=\"", "\"\n                                                        .populationFrequencies=\"", "\"\n                                                        .consequenceTypes=\"", "\"\n                                                        .query=\"", "\"\n                                                        .config=\"", "\"\n                                                        .searchButton=\"", "\"\n                                                        style=\"font-size: 12px\"\n                                                        @queryChange=\"", "\"\n                                                        @querySearch=\"", "\">\n                            </opencga-variant-filter>\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"col-md-10\">\n                \n                    <!-- tabs buttons -->\n                    <div>\n                        <div class=\"btn-group content-pills\" role=\"toolbar\" aria-label=\"toolbar\">\n                            <div class=\"btn-group\" role=\"group\" style=\"margin-left: 0px\">\n                                <button type=\"button\" class=\"btn btn-success active ripple content-pills\" data-view=\"table-results\" @click=\"", "\" data-id=\"table\">\n                                    <i class=\"fa fa-table icon-padding\" aria-hidden=\"true\"></i> Table Result\n                                </button>\n                                <button type=\"button\" class=\"btn btn-success ripple content-pills\" data-view=\"facet-results\" @click=\"", "\" data-id=\"aggregation\">\n                                    <i class=\"fas fa-chart-bar icon-padding\" aria-hidden=\"true\"></i> Aggregation stats\n                                </button>\n                                <button type=\"button\" class=\"btn btn-success ripple content-pills\" data-view=\"comparator\" @click=\"", "\" data-id=\"comparator\">\n                                    <i class=\"fa fa-users icon-padding\" aria-hidden=\"true\"></i> Comparator\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div>\n                        <opencga-active-filters facetActive\n                                                filterBioformat=\"VARIANT\"\n                                                .opencgaSession=\"", "\"\n                                                .defaultStudy=\"", "\"\n                                                .query=\"", "\"\n                                                .refresh=\"", "\"\n                                                .facetQuery=\"", "\"\n                                                .alias=\"", "\"\n                                                .config=\"", "\"\n                                                .filters=\"", "\"\n                                                @activeFacetChange=\"", "\"\n                                                @activeFacetClear=\"", "\"\n                                                @activeFilterChange=\"", "\"\n                                                @activeFilterClear=\"", "\">\n                        </opencga-active-filters>\n                        \n                        <div id=\"table-results\" class=\"content-tab\">\n                            <opencga-variant-grid .opencgaSession=\"", "\"\n                                                  .query=\"", "\"\n                                                  .cohorts=\"", "\"\n                                                  .cellbaseClient=\"", "\"\n                                                  .populationFrequencies=\"", "\"\n                                                  .active=\"", "\" \n                                                  .proteinSubstitutionScores=\"", "\"\n                                                  .consequenceTypes=\"", "\"\n                                                  .config=\"", "\"\n                                                  @selected=\"", "\"\n                                                  @selectvariant=\"", "\"\n                                                  @setgenomebrowserposition=\"", "\">\n                            </opencga-variant-grid>\n            \n            \n                            <!-- Bottom tabs with specific variant information -->\n                            <opencga-variant-detail-view    .opencgaSession=\"", "\" \n                                                            .cellbaseClient=\"", "\"\n                                                            .variantId=\"", "\">\n                            </opencga-variant-detail-view>\n                            \n                        </div>\n                        \n                        <div id=\"facet-results\" class=\"content-tab\">\n                            <opencb-facet-results .active=\"", "\"\n                                                  .data=\"", "\"\n                                                  .error=\"", "\">\n                            </opencb-facet-results>\n                        </div>\n                                         \n                                         \n                        <!-- TODO remove RESULTS - Facet Plots \n                        <div id=\"loading\" style=\"display: none\">\n                            <loading-spinner></loading-spinner>\n                        </div>\n                        ", "\n                        ", "\n\n                        ", " -->\n                    </div>\n                </div>\n            </div>\n        "]);

  opencga_variant_facet_templateObject11 = function _templateObject11() {
    return data;
  };

  return data;
}

function opencga_variant_facet_templateObject10() {
  const data = opencga_variant_facet_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n        </style>\n\n        ", "\n    "]);

  opencga_variant_facet_templateObject10 = function _templateObject10() {
    return data;
  };

  return data;
}

function opencga_variant_facet_templateObject9() {
  const data = opencga_variant_facet_taggedTemplateLiteral(["no type recognized"]);

  opencga_variant_facet_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function opencga_variant_facet_templateObject8() {
  const data = opencga_variant_facet_taggedTemplateLiteral(["\n                    <div class=\"col-md-12\">\n                        <input type=\"text\" class=\"form-control\" placeholder=\"Include values\" data-parent-facet=\"", "\" id=\"", "", "_Nested_text\" .value=\"", "\"  @input=\"", "\"  />\n                    </div>"]);

  opencga_variant_facet_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_variant_facet_templateObject7() {
  const data = opencga_variant_facet_taggedTemplateLiteral(["\n                    <div class=\"col-md-6\">\n                        <input type=\"text\" class=\"form-control\" placeholder=\"Include values or set range\" data-parent-facet=\"", "\" .disabled=\"", "\" id=\"", "", "_NestedValue\" .value=\"", "\"  @input=\"", "\"  />\n                    </div>\n                    <div class=\"col-md-6\">\n                        <select-field-filter .disabled=\"", "\" .data=\"", "\" .value=\"", "\" id=\"", "_NestedFnSelect\" data-parent-facet=\"", "\" @filterChange=\"", "\"></select-field-filter>\n                    </div>\n                "]);

  opencga_variant_facet_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_variant_facet_templateObject6() {
  const data = opencga_variant_facet_taggedTemplateLiteral(["\n                    <div class=\"col-md-12\">\n                        <select-field-filter ?multiple=\"", "\" .data=\"", "\" .value=\"", "\" id=\"", "_NestedSelect\" data-parent-facet=\"", "\" @filterChange=\"", "\"></select-field-filter>\n                    </div>\n                "]);

  opencga_variant_facet_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_variant_facet_templateObject5() {
  const data = opencga_variant_facet_taggedTemplateLiteral(["no type recognized: ", ""]);

  opencga_variant_facet_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_variant_facet_templateObject4() {
  const data = opencga_variant_facet_taggedTemplateLiteral(["\n                    <div class=\"row facet-row\">\n                        <div class=\"col-md-12\">\n                            <input type=\"text\" class=\"form-control\" placeholder=\"Include values\" @input=\"", "\" data-id=\"", "\" type=\"text\" .value=\"", "\" id=\"", "_NestedFnSelect\"  />\n                        </div>\n                    </div>\n                    ", "\n                "]);

  opencga_variant_facet_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_variant_facet_templateObject3() {
  const data = opencga_variant_facet_taggedTemplateLiteral(["\n                    <div class=\"row facet-row\">\n                        <div class=\"col-md-6\">\n                            <input type=\"text\" class=\"form-control\" placeholder=\"Include values or set range\" id=\"", "", "_text\" data-id=\"", "\" .value=\"", "\" @input=\"", "\" />\n                        </div>\n                        <div class=\"col-md-6\">\n                            <select-field-filter .data=\"", "\" .value=\"", "\" id=\"", "", "_FnSelect\" data-facet=\"", "\" @filterChange=\"", "\"></select-field-filter>\n                        </div>\n                    </div>\n                    ", "\n                "]);

  opencga_variant_facet_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_variant_facet_templateObject2() {
  const data = opencga_variant_facet_taggedTemplateLiteral(["\n                    <div class=\"row facet-row\">\n                        <div class=\"col-md-12\">\n                            <select-field-filter ?multiple=\"", "\" .data=\"", "\" .value=\"", "\" id=\"", "_Select\" data-id=\"", "\" @filterChange=\"", "\"></select-field-filter>\n                        </div>\n                    </div>\n                    ", "\n                    "]);

  opencga_variant_facet_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_variant_facet_templateObject() {
  const data = opencga_variant_facet_taggedTemplateLiteral(["\n                    <!-- nested facet -->\n                    <div class=\"row facet-row nested\">\n                        <div class=\"col-md-12 text-center\">\n                            <a class=\"btn btn-small collapsed\" role=\"button\" data-collapse=\"#", "_nested\" @click=\"", "\"> <i class=\"fas fa-arrow-alt-circle-down\"></i> Nested Facet (optional) </a>\n                            <div class=\"collapse ", "\" id=\"", "_nested\"> \n                                <div class=\"\">\n                                    <select-field-filter .data=\"", "\" .value=", " @filterChange=\"", "\"></select-field-filter>\n                                    <div class=\"row facet-row nested\">\n                                        ", "\n                                    </div>                                \n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- /nested facet -->\n        "]);

  opencga_variant_facet_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_variant_facet_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_variant_facet_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_variant_facet_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_variant_facet_ownKeys(Object(source), true).forEach(function (key) { opencga_variant_facet_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_variant_facet_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_variant_facet_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */









 // TODO Note :: this will be the new variant-browser battery included

class opencga_variant_facet_OpencgaVariantFacet extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      query: {
        type: Object
      },
      search: {
        type: Object
      },
      config: {
        type: Object
      },
      facetQuery: {
        type: Object
      },
      selectedFacet: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "facet" + utils.randomString(6);
    this.checkProjects = false;
    this.activeFilterAlias = {
      "annot-xref": "XRef",
      "biotype": "Biotype",
      "annot-ct": "Consequence Types",
      "alternate_frequency": "Population Frequency",
      "annot-functional-score": "CADD",
      "protein_substitution": "Protein Substitution",
      "annot-go": "GO",
      "annot-hpo": "HPO"
    };
    this.fixedFilters = ["studies"]; // These are for making the queries to server

    this.facetFields = [];
    this.facetRanges = [];
    this.facetFieldsName = [];
    this.facetRangeFields = [];
    this.results = [];
    this._showInitMessage = true;
    this.facetConfig = {
      a: 1
    };
    this.facetActive = true;
    this.query = {};
    this.preparedQuery = {};
    this.executedQuery = {};
    this.selectedFacet = {};
    this.selectedFacetFormatted = {};
    this.errorState = false;
    this.checkProjects = false;
    this._collapsed = false;
    this.genotypeColor = {
      "0/0": "#6698FF",
      "0/1": "#FFA500",
      "1/1": "#FF0000",
      "./.": "#000000",
      "0|0": "#6698FF",
      "0|1": "#FFA500",
      "1|0": "#FFA500",
      "1|1": "#FF0000",
      ".|.": "#000000"
    };
    this.variantId = "No variant selected";
    this._sessionInitialised = false;
    this.detailActiveTabs = [];
    this.activeTab = {};
  }

  connectedCallback() {
    super.connectedCallback();
    this._config = opencga_variant_facet_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  firstUpdated(_changedProperties) {
    $(".bootstrap-select", this).selectpicker(); // console.log("this.query from BROWSER", this.query)
  }

  updated(changedProperties) {
    if (changedProperties.has("config")) {
      this.configObserver();
    }

    if (changedProperties.has("opencgaSession")) {
      this.opencgaSessionObserver();
    }

    if (changedProperties.has("executedQuery")) {
      this.fetchVariants();
    }

    if (changedProperties.has("query")) {
      this.queryObserver();
    }

    if (changedProperties.has("selectedFacet")) {
      this.selectedFacetObserver();
    }
  }

  queryObserver() {
    // Query passed is executed and set to variant-filter, active-filters and variant-grid components
    let _query = {};

    if (utilsNew_UtilsNew.isEmpty(this.query) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.study)) {
      _query = {
        study: this.opencgaSession.study.fqn
      };
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query)) {
      this.preparedQuery = opencga_variant_facet_objectSpread({}, _query, {}, this.query);
      this.executedQuery = opencga_variant_facet_objectSpread({}, _query, {}, this.query);
    } // onServerFilterChange() in opencga-active-filters drops a filterchange event when the Filter dropdown is used


    this.dispatchEvent(new CustomEvent("queryChange", {
      detail: this.preparedQuery
    }));
    this.requestUpdate();
  }

  opencgaSessionObserver() {
    console.log("this._config", this._config, this.opencgaSession.project); // debugger

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.project)) {
      // Update cohorts from config, this updates the Cohort filter MAF
      for (const section of this._config.filter.sections) {
        for (const subsection of section.subsections) {
          if (subsection.id === "cohort") {
            const projectFields = this.opencgaSession.project.alias.split("@");
            const projectId = projectFields.length > 1 ? projectFields[1] : projectFields[0];
            this.cohorts = subsection.cohorts[projectId]; // this.set('cohorts', subsection.cohorts[projectId]);
            // debugger
          }
        }
      }

      this.checkProjects = true;
      this.requestUpdate().then(() => $(".bootstrap-select", this).selectpicker());
    } else {
      this.checkProjects = false;
    }
  }

  onCollapse() {
    if (this._collapsed) {
      $("#" + this._prefix + "FilterMenu").show(400);
      $("#" + this._prefix + "MainWindow").removeClass("browser-center").addClass("col-md-10");
    } else {
      $("#" + this._prefix + "FilterMenu").hide(400);
      $("#" + this._prefix + "MainWindow").removeClass("col-md-10").addClass("browser-center");
    }

    this._collapsed = !this._collapsed;
  }
  /**
   * Apply the 'config' properties on the default
   */


  configObserver() {
    this._config = opencga_variant_facet_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  selectedFacetObserver() {
    /**
     * Helper for formatting the list of facets to show in opencga-active-filters
     */
    const _valueFormatter = (k, v) => {
      let str = "";

      if (v.fn && (v.fn === "Avg" || v.fn === "Percentile")) {
        str = v.fn + "(" + k + ")";
      } else {
        str = k + v.value;
      }

      if (v.nested) {
        str += ">>" + (v.nested.fn && (v.nested.fn === "Avg" || v.nested.fn === "Percentile") ? v.nested.fn + "(" + v.nested.facet + ")" : v.nested.facet + v.nested.value);
      }

      return str;
    };

    if (Object.keys(this.selectedFacet).length) {
      // Object property spreading cannot be used here as it creates an Object with numeric indexes in Chrome 78...
      this.selectedFacetFormatted = Object.assign({}, ...Object.keys(this.selectedFacet).map(k => ({
        [k]: opencga_variant_facet_objectSpread({}, this.selectedFacet[k], {
          formatted: _valueFormatter(k, this.selectedFacet[k])
        })
      })));
    } else {
      this.selectedFacetFormatted = {};
    }

    this.requestUpdate();
  }

  addDefaultFacet() {
    for (const defaultFacetId of this._config.aggregation.default) {
      const facet = defaultFacetId.split(">>");
      console.log(facet); // in case of nested facets

      if (facet.length > 1) {
        const mainFacet = this._recFind(this._config.aggregation.sections, facet[0]);

        const nestedFacet = this._recFind(this._config.aggregation.sections, facet[1]);

        console.log("nestedFacet", nestedFacet);
        this.selectedFacet[facet[0]] = opencga_variant_facet_objectSpread({}, mainFacet, {
          value: mainFacet && mainFacet.defaultValue ? mainFacet.defaultValue : "",
          nested: opencga_variant_facet_objectSpread({}, nestedFacet, {
            facet: facet[1],
            value: nestedFacet.defaultValue || ""
          })
        });
      } else {
        this.selectedFacet[defaultFacetId] = opencga_variant_facet_objectSpread({}, facet, {
          value: facet && facet.defaultValue ? facet.defaultValue : ""
        });
      }
    }

    this.selectedFacet = opencga_variant_facet_objectSpread({}, this.selectedFacet);
  }

  notifySearch(query) {
    this.dispatchEvent(new CustomEvent("querySearch", {
      detail: {
        query: query
      },
      bubbles: true,
      composed: true
    }));
  } // TODO since this is the new opencga-browser, this have to be moved this in opencga-facet-results


  async onRun() {
    this.clearPlots();

    const queryParams = opencga_variant_facet_objectSpread({}, this.preparedQuery, {
      // sid: this.opencgaClient._config.sessionId,
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias,
      timeout: 60000,
      field: Object.values(this.selectedFacetFormatted).map(v => v.formatted).join(";")
    }); // this event keeps in sync the query object with the one in iva-app
    // TODO do not use this.preparedQuery, use this.query (change this component accordingly)


    this.notifySearch(this.preparedQuery); // this.querySelector("#loading").style.display = "block";

    this.endpoint.aggregationStats(queryParams, {}).then(queryResponse => {
      console.log("queryResponse", queryResponse);
      this.errorState = false;
      this.facetResults = queryResponse.response[0].result[0].results;
      this.requestUpdate();
    }).catch(e => {
      this.errorState = "Error from server: " + e.error;
      this.requestUpdate();
    }).finally(() => {
      this.querySelector("#loading").style.display = "none";
    });
  }

  async onFacetFieldChange(e) {
    const currentSelectionNames = e.detail.value ? e.detail.value.split(",") : []; // compute the symmetric difference between this.selectedFacet and currentSelectionNames

    const differences = Object.keys(this.selectedFacet).filter(a => !currentSelectionNames.includes(a)).concat(currentSelectionNames.filter(name => !Object.keys(this.selectedFacet).includes(name))); // the difference involves one item a time

    if (differences.length > 1) console.error("Difference error!", this.selectedFacet, currentSelectionNames);
    const difference = differences[0]; // addition

    if (currentSelectionNames.length > Object.keys(this.selectedFacet).length) {
      console.log("addition of", difference); // Array.find() cannot be nested.. let newField = this._config.aggregation.sections.find(field => field.fields ? field.fields.find(nested => nested === difference) : field.name === difference);
      // console.log(this._config.aggregation.sections, difference)

      const newField = this._recFind(this._config.aggregation.sections, difference); // console.log("newField", newField)


      this.selectedFacet[difference] = opencga_variant_facet_objectSpread({}, newField, {
        value: newField && newField.defaultValue ? newField.defaultValue : ""
      });
      await this.requestUpdate();
      $(".bootstrap-select", this).selectpicker();
    } else {
      console.log("deletion of", difference); // deletion

      delete this.selectedFacet[difference];
    }

    this.selectedFacet = opencga_variant_facet_objectSpread({}, this.selectedFacet);
    this.requestUpdate();
  }

  onFacetValueChange(e) {
    // console.log("onFacetValueChange",e);
    const id = e.target.dataset.id; // this.selectedFacet = {...this.selectedFacet, [id]: (e.target.value.trim() ? e.target.value : "")};

    this.selectedFacet[id].value = e.target.value.trim() ? e.target.value : "";
    this.selectedFacet = opencga_variant_facet_objectSpread({}, this.selectedFacet);
    this.requestUpdate();
  }

  onFacetSelectChange(e) {
    // console.log("onFacetSelectChange",e);
    const id = e.target.dataset.id; // this.selectedFacet = {...this.selectedFacet, [id]: (e.target.value.trim() ? e.target.value : "")};

    this.selectedFacet[id].value = e.detail.value ? e.detail.value : "";
    this.selectedFacet = opencga_variant_facet_objectSpread({}, this.selectedFacet);
    this.requestUpdate();
  }

  onFacetFnChange(e) {
    const value = e.detail.value;
    const facet = e.target.dataset.facet;

    if (value && (value === "Avg" || value === "Percentile")) {
      this.selectedFacet[facet]["fn"] = value;
      this.querySelector("#" + this._prefix + facet + "_text").disabled = true;
    } else {
      delete this.selectedFacet[facet]["fn"];
      this.querySelector("#" + this._prefix + facet + "_text").disabled = false;
    }

    this.selectedFacet = opencga_variant_facet_objectSpread({}, this.selectedFacet);
    this.requestUpdate();
  }

  toggleCollapse(e) {
    $(e.target.dataset.collapse).collapse("toggle");
  }

  onNestedFacetValueChange(e) {
    this.selectedFacet[e.target.dataset.parentFacet].nested.value = e.target.value;
    this.selectedFacet = opencga_variant_facet_objectSpread({}, this.selectedFacet);
    this.requestUpdate();
  }

  onNestedFacetFieldChange(e, parent) {
    const selected = e.detail.value;

    if (selected) {
      const newField = this._recFind(this._config.aggregation.sections, selected);

      this.selectedFacet[parent].nested = opencga_variant_facet_objectSpread({}, newField, {
        facet: selected,
        value: newField.defaultValue || ""
      });
    } else {
      delete this.selectedFacet[parent].nested;
    }

    this.selectedFacet = opencga_variant_facet_objectSpread({}, this.selectedFacet);
    this.requestUpdate();
  }

  onNestedFacetFnChange(e) {
    const value = e.detail.value;
    const facet = e.target.dataset.parentFacet;
    console.log("nestedFacetFNCHANGE", "#" + this._prefix + facet + "_NestedValue");

    if (value && (value === "Avg" || value === "Percentile")) {
      if (this.selectedFacet[facet].nested) {
        this.selectedFacet[facet].nested.fn = value;
        this.querySelector("#" + this._prefix + facet + "_NestedValue").disabled = true;
      } else {
        console.error("function selected before facet!");
      }
    } else {
      this.querySelector("#" + this._prefix + facet + "_NestedValue").disabled = false;
      delete this.selectedFacet[facet].nested.fn;
    }

    this.selectedFacet = opencga_variant_facet_objectSpread({}, this.selectedFacet);
    this.requestUpdate();
  }

  onActiveFacetChange(e) {
    this.selectedFacet = opencga_variant_facet_objectSpread({}, e.detail); // console.log("selectedFacet",Object.keys(this.selectedFacet))

    $("#" + this._prefix + "FacetField", this).selectpicker("val", Object.keys(this.selectedFacet));
    this.requestUpdate();
  }

  onActiveFacetClear(e) {
    this.selectedFacet = {};
    $("#" + this._prefix + "FacetField", this).selectpicker("val", "deselectAll");
    this.requestUpdate();
  }

  onFilterChange(e) {
    this.query = e.detail; // TODO remove search field everywhere. use query instead

    this.search = e.detail;
  }

  _onMouseOver(e) {
    PolymerUtils_PolymerUtils.addStyleByClass(e.target.dataset.facet, "text-decoration", "line-through");
  }

  _onMouseOut(e) {
    PolymerUtils_PolymerUtils.addStyleByClass(e.target.dataset.facet, "text-decoration", "none");
  }

  notifySearch(query) {
    this.dispatchEvent(new CustomEvent("querySearch", {
      detail: {
        query: query
      },
      bubbles: true,
      composed: true
    }));
  }

  async onRun() {
    this.clearPlots();

    const queryParams = opencga_variant_facet_objectSpread({}, this.preparedQuery, {
      // sid: this.opencgaClient._config.sessionId,
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias,
      timeout: 60000,
      field: Object.values(this.selectedFacetFormatted).map(v => v.formatted).join(";")
    }); // this event keeps in sync the query object with the one in iva-app
    // TODO do not use this.preparedQuery, use this.query (change this component accordingly)


    this.notifySearch(this.preparedQuery); // this.querySelector("#loading").style.display = "block";

    this.opencgaClient.variants().aggregationStats(queryParams).then(queryResponse => {
      console.log("queryResponse", queryResponse);
      this.errorState = false;
      this.facetResults = queryResponse.response[0].result[0].results;
      this.requestUpdate();
    }).catch(e => {
      this.errorState = "Error from server: " + e.error;
      this.requestUpdate();
    }).finally(() => {
      this.querySelector("#loading").style.display = "none";
    });
  }
  /*
       /!**
       * @deprecated
       * *!/
      fetchData() {
          if (UtilsNew.isUndefinedOrNull(this.opencgaClient)) {
              console.log("opencgaClient is null or undefined");
              return;
          }
           if (this.facets.size === 0) {
              alert("No facets selected.");
              return;
          }
           this.clearPlots();
          // Shows loading modal
          $(PolymerUtils.getElementById(this._prefix + "LoadingModal")).modal("show");
           // Join 'query' from left menu and facet filters
          const queryParams = Object.assign({}, this.executedQuery,
              {
                  // sid: this.opencgaClient._config.sessionId,
                  study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias,
                  timeout: 60000,
                  facet: this.facetFilters.join(";")
              });
           const _this = this;
          setTimeout(() => {
              this.opencgaClient.variants().facet(queryParams, {})
                  .then(function(queryResponse) {
                      // let response = queryResponse.response[0].result[0].result;
                      _this.facetResults = queryResponse.response[0].result[0].results;
                       console.log("facetResults", _this.facetResults);
                      // Remove loading modal
                      $(PolymerUtils.getElementById(_this._prefix + "LoadingModal")).modal("hide");
                      _this._showInitMessage = false;
                  })
                  .catch(function(e) {
                      console.log(e);
                      // Remove loading modal
                      $(PolymerUtils.getElementById(_this._prefix + "LoadingModal")).modal("hide");
                      _this._showInitMessage = false;
                  });
          }
          , 250);
      }
  */


  clearPlots() {
    if (utilsNew_UtilsNew.isNotUndefined(this.results) && this.results.length > 0) {
      for (const result of this.results) {
        PolymerUtils_PolymerUtils.removeElement(this._prefix + result.name + "Plot");
      }
    }

    this.results = [];
  }

  clearAll() {
    this.clearPlots();
    this.chromosome = "";
    this.facetFields = [];
    this.facetRanges = [];
    this.facetFieldsName = [];
    this.facetRangeFields = [];
    this._showInitMessage = true;
    PolymerUtils_PolymerUtils.setAttributeByClassName(this._prefix + "FilterSelect", "selectedIndex", 0);
    PolymerUtils_PolymerUtils.setValue(this._prefix + "FieldIncludes", "");
    PolymerUtils_PolymerUtils.setValue(this._prefix + "NestedFieldIncludes", "");
    PolymerUtils_PolymerUtils.setValue(this._prefix + "ChromosomeInput", "");
    PolymerUtils_PolymerUtils.removeAttribute(this._prefix + "ChromosomeAdd", "disabled");
  }

  onHistogramChart(e) {
    this.highlightActivePlot(e.target.parentElement);
    const id = e.target.dataId; // TODO Refactor

    this.renderHistogramChart("#" + this._prefix + id + "Plot", id);
    PolymerUtils_PolymerUtils.hide(this._prefix + id + "Table");
  }

  onPieChart(e) {
    this.highlightActivePlot(e.target.parentElement);
    const id = e.target.dataId;
    this.renderPieChart("#" + this._prefix + id + "Plot", id);
    PolymerUtils_PolymerUtils.hide(this._prefix + id + "Table");
  }

  onTabularView(e) {
    this.highlightActivePlot(e.target.parentElement);
    const id = e.target.dataId;
    PolymerUtils_PolymerUtils.innerHTML(this._prefix + id + "Plot", "");
    PolymerUtils_PolymerUtils.show(this._prefix + id + "Table", "table");
  }

  highlightActivePlot(button) {} // PolymerUtils.removeClass(".plots", "active");
  // PolymerUtils.addClass(button, "active");

  /**
   *  TODO recheck if is still useful
   * */


  fetchVariants() {
    console.log("executedQuery changed!!");

    if (utilsNew_UtilsNew.isNotUndefined(this.opencgaClient)) {
      const queryParams = {
        sid: this.opencgaClient._config.sessionId,
        timeout: 60000,
        summary: true,
        limit: 1
      };
      Object.assign(queryParams, this.query);

      if (utilsNew_UtilsNew.isEmpty(queryParams.studies) || queryParams.studies.split(new RegExp("[,;]")).length == 1) {
        queryParams.studies = this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias;
      }

      const _this = this;

      this.opencgaClient.variants().query(queryParams).then(function (response) {
        _this.totalVariants = response.response[0].numTotalResults;
        console.log("_this.totalVariants", _this.totalVariants);
      });
    }
  }

  checkField(category) {
    return category === "field";
  }

  subFieldExists(field) {
    return utilsNew_UtilsNew.isNotEmpty(field);
  }

  fieldExists(countObj) {
    return utilsNew_UtilsNew.isNotUndefined(countObj.field);
  }

  countSubFields(countObj) {
    return countObj.field.counts.length + 1;
  }

  _isValidField(item) {
    for (const field of this._config.fields) {
      if (field.value == item.value) {
        return false;
      }
    }

    return true;
  }

  _recFind(array, value) {
    for (const f of array) {
      if (f.fields) {
        const r = this._recFind(f.fields, value);

        if (r) return r;
      } else {
        if (f.id === value) {
          // console.log("found", f);
          return f;
        }
      }
    }
  }

  _changeView(e) {
    e.preventDefault();
    $(".content-pills").removeClass("active");
    $(".content-tab").hide();
    $(e.currentTarget).addClass("active");
    $("#" + e.currentTarget.dataset.view).show();

    for (const tab in this.activeTab) this.activeTab[tab] = false;

    this.activeTab[e.currentTarget.dataset.view] = true;
    /* if (e.target.dataset.view === "Summary") {
        this.SummaryActive = true;
        this.requestUpdate();
    } else {
        this.SummaryActive = false;
    }*/

    this.requestUpdate();
  }

  onQueryFilterChange(e) {
    this.preparedQuery = e.detail.query;
    this.requestUpdate();
  }
  /*
  onQueryFilterSearch(e) {
      this.preparedQuery = e.detail.query;
      this.executedQuery = e.detail.query;
       this.fetchVariants();
       this.requestUpdate();
  }
  */


  onActiveFilterChange(e) {
    console.log("onActiveFilterChange on variant facet", e.detail); // TODO FIXME! study prop have to be wiped off. use studies instead

    this.preparedQuery = opencga_variant_facet_objectSpread({
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias
    }, e.detail);
    this.query = opencga_variant_facet_objectSpread({
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias
    }, e.detail); // this.requestUpdate();
  }

  onActiveFilterClear() {
    console.log("onActiveFilterClear");
    this.query = {
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias
    };
    this.preparedQuery = opencga_variant_facet_objectSpread({}, this.query);
  }

  renderField(facet) {
    const renderNestedFieldWrapper = facet => lit_html_lit_html_html(opencga_variant_facet_templateObject(), facet.id, this.toggleCollapse, this.selectedFacet[facet.id].nested ? "in" : "", facet.id, this._config.aggregation.sections.map(section => opencga_variant_facet_objectSpread({}, section, {
      fields: section.fields.map(item => opencga_variant_facet_objectSpread({}, item, {
        disabled: item.id === facet.id
      }))
    })), this.selectedFacet[facet.id].nested ? this.selectedFacet[facet.id].nested.id : null, e => this.onNestedFacetFieldChange(e, facet.id), this.renderNestedField(this.selectedFacet[facet.id].nested, facet.id));

    switch (facet.type) {
      case "category":
        return lit_html_lit_html_html(opencga_variant_facet_templateObject2(), !!facet.multiple, facet.allowedValues, facet.defaultValue ? facet.defaultValue : "", facet.id, facet.id, this.onFacetSelectChange, renderNestedFieldWrapper(facet));

      case "number":
      case "integer":
      case "float":
        return lit_html_lit_html_html(opencga_variant_facet_templateObject3(), this._prefix, facet.id, facet.id, facet.value || "", this.onFacetValueChange, ["Range", "Avg", "Percentile"], "Range", this._prefix, facet.id, facet.id, this.onFacetFnChange, renderNestedFieldWrapper(facet));

      case "string":
        return lit_html_lit_html_html(opencga_variant_facet_templateObject4(), this.onFacetValueChange, facet.id, facet.defaultValue ? facet.defaultValue : "", facet.id, renderNestedFieldWrapper(facet));

      default:
        console.log("no type recognized", facet);
        return lit_html_lit_html_html(opencga_variant_facet_templateObject5(), facet.type);
    }
  }

  renderNestedField(facet, parent) {
    if (!facet || !facet.type) return null;
    console.log("renderNestedField", facet);

    switch (facet.type) {
      case "category":
        return lit_html_lit_html_html(opencga_variant_facet_templateObject6(), !!facet.multiple, facet.values, facet.defaultValue ? facet.defaultValue : "", facet.id, parent, this.onNestedFacetValueChange);

      case "number":
      case "integer":
      case "float":
        return lit_html_lit_html_html(opencga_variant_facet_templateObject7(), parent, !facet.facet, this._prefix, parent, facet.value || "", this.onNestedFacetValueChange, false, ["Range", "Avg", "Percentile"], "Range", parent, parent, this.onNestedFacetFnChange);

      case "string":
        return lit_html_lit_html_html(opencga_variant_facet_templateObject8(), parent, this._prefix, facet.id, facet.value || "", this.onNestedFacetValueChange);

      default:
        return lit_html_lit_html_html(opencga_variant_facet_templateObject9());
    }
  }

  onSampleChange(e) {
    this.samples = e.detail.samples;
    this.dispatchEvent(new CustomEvent("samplechange", {
      detail: {
        samples: this.samples
      },
      bubbles: true,
      composed: true
    }));
  }

  _changeBottomTab(e) {
    const _activeTabs = {};

    for (const detail of this.config.detail) {
      _activeTabs[detail.id] = detail.id === e.currentTarget.dataset.id;
    }

    this.detailActiveTabs = _activeTabs;
    this.requestUpdate();
  }

  onGenomeBrowserPositionChange(e) {
    $(".variant-browser-content").hide(); // hides all content divs
    // Show genome browser div

    PolymerUtils_PolymerUtils.getElementById(this._prefix + "GenomeBrowser").style.display = "block"; // Show the active button

    $(".variant-browser-view-buttons").removeClass("active");
    PolymerUtils_PolymerUtils.addClass(this._prefix + "GenomeBrowserButton", "active");
    this._genomeBrowserActive = true;
    this.region = e.detail.genomeBrowserPosition;
  }

  checkVariant(variant) {
    return variant.split(":").length > 2;
  }

  onSelectVariant(e) {
    this.variantId = e.detail.id;
    this.variant = e.detail.variant;
    const genes = [];

    for (let i = 0; i < e.detail.variant.annotation.consequenceTypes.length; i++) {
      const gene = e.detail.variant.annotation.consequenceTypes[i].geneName;

      if (utilsNew_UtilsNew.isNotEmpty(gene) && genes.indexOf(gene) === -1) {
        genes.push(gene);
      }
    }

    this.genes = genes;
    this.requestUpdate();
  }

  selectedGene(e) {
    this.dispatchEvent(new CustomEvent("propagate", {
      gene: e.detail.gene
    }));
  }

  getDefaultConfig() {
    return {
      title: "Variant Browser",
      active: false,
      populationFrequencies: true,
      filter: {
        // from OLD variant-browser
        activeFilters: {
          alias: {// Example:
            // "region": "Region",
            // "gene": "Gene",
            // "genotype": "Sample Genotypes",
          },
          complexFields: ["genotype"],
          hiddenFields: ["study"]
        },
        genomeBrowser: {
          showTitle: false
        },
        // from tools.js
        title: "Variant Browser",
        active: false,
        showSummary: true,
        showGenomeBrowser: false,
        sections: [// sections and subsections, structure and order is respected
        {
          title: "Study and Cohorts",
          collapsed: false,
          subsections: [{
            id: "study",
            title: "Studies Filter",
            tooltip: "Only considers variants from the selected studies"
          } // cohortFileMenu // TODO expose common data
          ]
        }, {
          title: "Genomic",
          collapsed: true,
          subsections: [{
            id: "location",
            title: "Chromosomal Location",
            tooltip: "Filter out variants falling outside the genomic interval(s) defined"
          }, {
            id: "feature",
            title: "Feature IDs (gene, SNPs, ...)",
            tooltip: "Filter out variants falling outside the genomic features (gene, transcript, SNP, etc.) defined"
          }, {
            id: "diseasePanels",
            title: "Disease Panels",
            tooltip: "Filter out variants falling outside the genomic intervals (typically genes) defined by the panel(s) chosen"
          }, {
            id: "biotype",
            title: "Gene Biotype",
            biotypes: ["3prime_overlapping_ncrna", "IG_C_gene", "IG_C_pseudogene", "IG_D_gene", "IG_J_gene", "IG_J_pseudogene", "IG_V_gene", "IG_V_pseudogene", "Mt_rRNA", "Mt_tRNA", "TR_C_gene", "TR_D_gene", "TR_J_gene", "TR_J_pseudogene", "TR_V_gene", "TR_V_pseudogene", "antisense", "lincRNA", "miRNA", "misc_RNA", "non_stop_decay", "nonsense_mediated_decay", "polymorphic_pseudogene", "processed_pseudogene", "processed_transcript", "protein_coding", "pseudogene", "rRNA", "retained_intron", "sense_intronic", "sense_overlapping", "snRNA", "snoRNA", "transcribed_processed_pseudogene", "transcribed_unprocessed_pseudogene", "translated_processed_pseudogene", "unitary_pseudogene", "unprocessed_pseudogene"],
            tooltip: "Filter out variants falling outside the genomic features (gene, transcript, SNP, etc.) defined"
          }, {
            id: "type",
            title: "Variant Type",
            types: ["SNV", "INDEL", "CNV", "INSERTION", "DELETION", "MNV"],
            tooltip: "Only considers variants of the selected type"
          }]
        }, {
          title: "Population Frequency",
          collapsed: true,
          subsections: [{
            id: "populationFrequency",
            title: "Select Population Frequency",
            // tooltip: populationFrequencies.tooltip, // TODO expose common data
            showSetAll: true
          }]
        }, {
          title: "Consequence Type",
          collapsed: true,
          subsections: [{
            id: "consequenceType",
            title: "Select SO terms",
            tooltip: "Filter out variants falling outside the genomic features (gene, transcript, SNP, etc.) defined"
          }]
        }, {
          title: "Deleteriousness",
          collapsed: true,
          subsections: [{
            id: "proteinSubstitutionScore",
            title: "Protein Substitution Score",
            tooltip: "<strong>SIFT score:</strong> Choose either a Tolerated/Deleterious qualitative score or provide below a " + "quantitative impact value. SIFT scores <0.05 are considered deleterious. " + "<strong>Polyphen:</strong> Choose, either a Benign/probably damaging qualitative score or provide below a " + "quantitative impact value. Polyphen scores can be Benign (<0.15), Possibly damaging (0.15-0.85) or Damaging (>0.85)"
          }, {
            id: "cadd",
            title: "CADD",
            tooltip: "Raw values have relative meaning, with higher values indicating that a variant is more likely to be " + "simulated (or not observed) and therefore more likely to have deleterious effects. If discovering causal variants " + "within an individual, or small groups, of exomes or genomes te use of the scaled CADD score is recommended"
          }]
        }, {
          title: "Conservation",
          collapsed: true,
          subsections: [{
            id: "conservation",
            title: "Conservation Score",
            tooltip: "<strong>PhyloP</strong> scores measure evolutionary conservation at individual alignment sites. The scores " + "are interpreted as follows compared to the evolution expected under neutral drift: positive scores (max 3.0) mean " + "conserved positions and negative scores (min -14.0) indicate positive selection. PhyloP scores are useful to " + "evaluate signatures of selection at particular nucleotides or classes of nucleotides (e.g., third codon positions, " + "or first positions of miRNA target sites).<br>" + "<strong>PhastCons</strong> estimates the probability that each nucleotide belongs to a conserved element, based on " + "the multiple alignment. The phastCons scores represent probabilities of negative selection and range between 0 " + "(non-conserved) and 1 (highly conserved).<br>" + "<strong>Genomic Evolutionary Rate Profiling (GERP)</strong> score estimate the level of conservation of positions." + " Scores  2 indicate evolutionary constraint to and  3 indicate purifying selection."
          }]
        }, {
          title: "Gene Ontology",
          collapsed: true,
          subsections: [{
            id: "go",
            title: "GO Accessions (max. 100 terms)",
            tooltip: "Filter out variants falling outside the genomic features (gene, transcript, SNP, etc.) defined"
          }]
        }, {
          title: "Phenotype-Disease",
          collapsed: true,
          subsections: [{
            id: "hpo",
            title: "HPO Accessions",
            tooltip: "Filter out variants falling outside the genomic features (gene, transcript, SNP, etc.) defined"
          }, {
            id: "clinvar",
            title: "ClinVar Accessions",
            tooltip: "Filter out variants falling outside the genomic features (gene, transcript, SNP, etc.) defined"
          }, {
            id: "fullTextSearch",
            title: "Full-text search on HPO, ClinVar, protein domains or keywords. Some OMIM and Orphanet IDs are also supported",
            tooltip: "Filter out variants falling outside the genomic features (gene, transcript, SNP, etc.) defined"
          }]
        }],
        examples: [{
          name: "Example BRCA2",
          active: false,
          query: {
            gene: "BRCA2",
            conservation: "phylop<0.001"
          }
        }, {
          name: "Example OR11",
          query: {
            gene: "OR11H1",
            conservation: "phylop<=0.001"
          }
        }, {
          name: "Full Example",
          query: {
            "studies": "exomes_grch37:corpasome;opencga@exomes_grch37:ceph_trio",
            "region": "3:444-555",
            "xref": "BRCA1,DDEF",
            "panel": "Albinism_or_congenital_nystagmus-PanelAppId-511,Amyloidosis-PanelAppId-502",
            "biotype": "IG_C_gene,IG_C_pseudogene",
            "type": "INDEL",
            "ct": "frameshift_variant,incomplete_terminal_codon_variant,inframe_deletion,inframe_insertion,3_prime_UTR_variant,5_prime_UTR_variant,intron_variant,non_coding_transcript_exon_variant,non_coding_transcript_variant",
            "populationFrequencyAlt": "1kG_phase3:ALL<1;1kG_phase3:AFR<1;1kG_phase3:AMR<1;1kG_phase3:EAS<1;1kG_phase3:EUR<1;1kG_phase3:SAS<1;GNOMAD_GENOMES:ALL<1;GNOMAD_GENOMES:AFR<1;GNOMAD_GENOMES:AMR<1;GNOMAD_GENOMES:EAS<1;GNOMAD_GENOMES:FIN<1;GNOMAD_GENOMES:NFE<1;GNOMAD_GENOMES:SAS<1",
            "protein_substitution": "sift>5,polyphen>4",
            "annot-functional-score": "cadd_raw>2,cadd_scaled<4",
            "conservation": "phylop>1;phastCons>2;gerp<=3"
          }
        }],
        result: {
          grid: {}
        },
        detail: []
      },
      aggregation: {
        default: [],
        sections: [{
          name: "terms",
          fields: [{
            name: "Chromosome",
            id: "chromosome",
            type: "string"
          }, {
            name: "Studies",
            id: "studies",
            type: "string"
          }, {
            name: "Variant Type",
            id: "type",
            type: "string"
          }, {
            name: "Genes",
            id: "genes",
            type: "string"
          }, {
            name: "Biotypes",
            id: "biotypes",
            type: "string"
          }, {
            name: "Consequence Type",
            id: "soAcc",
            type: "string"
          }]
        }, {
          name: "Conservation & Deleteriousness Ranges",
          fields: [{
            name: "PhastCons",
            id: "phastCons",
            defaultValue: "[0..1]:0.1",
            type: "string"
          }, {
            name: "PhyloP",
            id: "phylop",
            defaultValue: "",
            type: "string"
          }, {
            name: "Gerp",
            id: "gerp",
            defaultValue: "[-12.3..6.17]:2",
            type: "string"
          }, {
            name: "CADD Raw",
            id: "caddRaw",
            defaultValue: "",
            type: "string"
          }, {
            name: "CADD Scaled",
            id: "caddScaled",
            defaultValue: "",
            type: "string"
          }, {
            name: "Sift",
            id: "sift",
            defaultValue: "[0..1]:0.1",
            type: "string"
          }, {
            name: "Polyphen",
            id: "polyphen",
            defaultValue: "[0..1]:0.1",
            type: "string"
          }]
        }, {
          name: "Population frequency Ranges",
          fields: [...this.populationFrequencies.studies.map(study => study.populations.map(population => ({
            id: "popFreq__".concat(study.id, "__").concat(population.id),
            value: "popFreq__".concat(study.id, "__").concat(population.id),
            name: "pop Freq | ".concat(study.id, " | ").concat(population.id),
            type: "string"
          }))).flat()]
        }]
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_variant_facet_templateObject10(), this.checkProjects ? lit_html_lit_html_html(opencga_variant_facet_templateObject11(), this._config.icon, this._config.title, this._config.icon, this._config.title, this.onRun, this._config.aggregation.sections, Object.keys(this.selectedFacet).join(","), this.onFacetFieldChange, this.addDefaultFacet, JSON.stringify(this.selectedFacet, null, "  "), Object.keys(this.selectedFacet).length > 0 ? Object.entries(this.selectedFacet).map(([, facet]) => lit_html_lit_html_html(opencga_variant_facet_templateObject12(), this._prefix, facet.name, this._prefix, facet.id, this._prefix, facet.id, this._prefix, this.renderField(facet))) : lit_html_lit_html_html(opencga_variant_facet_templateObject13()), this.opencgaSession, this.opencgaClient, this.cellbaseClient, this.populationFrequencies, this.consequenceTypes, this.query, this._config.filter, false, this.onQueryFilterChange, this.onQueryFilterSearch, this._changeView, this._changeView, this._changeView, this.opencgaSession, this.opencgaSession.study.alias, this.preparedQuery, this.executedQuery, this.selectedFacetFormatted, this.activeFilterAlias, this._config.activeFilters, this._config.filter.examples, this.onActiveFacetChange, this.onActiveFacetClear, this.onActiveFilterChange, this.onActiveFilterClear, this.opencgaSession, this.executedQuery, this.cohorts, this.cellbaseClient, this.populationFrequencies, this.active, this.proteinSubstitutionScores, this.consequenceTypes, this._config.filter, this.selectedGene, this.onSelectVariant, this.onGenomeBrowserPositionChange, this.opencgaSession, this.cellbaseClient, this.variantId, this.activeTab["facet-results"], this.facetResults, this.errorState, this.errorState ? lit_html_lit_html_html(opencga_variant_facet_templateObject14(), this.errorState) : null, this._showInitMessage ? lit_html_lit_html_html(opencga_variant_facet_templateObject15()) : null, this.facetResults && this.facetResults.length ? this.facetResults.map(item => lit_html_lit_html_html(opencga_variant_facet_templateObject16(), item.name, item, this.facetConfig, this.facetActive)) : null) : lit_html_lit_html_html(opencga_variant_facet_templateObject17()));
  }

}
customElements.define("opencga-variant-facet", opencga_variant_facet_OpencgaVariantFacet);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/opencb-grid-toolbar.js
function opencb_grid_toolbar_templateObject5() {
  const data = opencb_grid_toolbar_taggedTemplateLiteral(["\n                                    <button type=\"button\" class=\"btn btn-default btn-sm\" data-toggle=\"popover\" data-placement=\"bottom\" @click=\"onShareLink\">\n                                        <i class=\"fa fa-share-alt\" aria-hidden=\"true\" style=\"padding-right: 5px\"></i> Share\n                                    </button>\n                                "]);

  opencb_grid_toolbar_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencb_grid_toolbar_templateObject4() {
  const data = opencb_grid_toolbar_taggedTemplateLiteral(["\n                                                <li><a href=\"javascript:;\" data-download-option=\"", "\" @click=\"", "\">", "</a></li>\n                                        "]);

  opencb_grid_toolbar_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencb_grid_toolbar_templateObject3() {
  const data = opencb_grid_toolbar_taggedTemplateLiteral(["\n                                                        <li>\n                                                            <a data-column-id=\"", "\" @click=\"", "\" style=\"cursor: pointer;\">\n                                                                <input type=\"checkbox\" @click=\"", "\" .checked=\"", "\"/>\n                                                                <label class=\"checkmark-label\">", "</label>\n                                                            </a>\n                                                        </li>"]);

  opencb_grid_toolbar_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencb_grid_toolbar_templateObject2() {
  const data = opencb_grid_toolbar_taggedTemplateLiteral(["\n                                        <div class=\"btn-group\">\n                                            <button type=\"button\" class=\"btn btn-default ripple btn-sm dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                                                <i id=\"", "ColumnIcon\" class=\"fa fa-columns\" aria-hidden=\"true\" style=\"padding-right: 5px\"></i> Columns <span class=\"caret\"></span>\n                                            </button>\n                                            <ul class=\"dropdown-menu btn-sm checkbox-container\">\n                                                ", "\n                                            </ul>\n                                        </div>"]);

  opencb_grid_toolbar_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencb_grid_toolbar_templateObject() {
  const data = opencb_grid_toolbar_taggedTemplateLiteral(["\n            <style>\n\n                opencb-grid-toolbar .checkbox-container label:before {\n                    margin-top: 5px;\n                }\n                \n            </style>\n            <div class=\"container-fluid\">\n                <div class=\"row\">\n                    <div class=\"col-md-12\" style=\"padding: 5px 0px 0px 0px\">\n                        <div id=\"", "ToolbarLeft\" class=\"col-md-6\" style=\"padding: 15px 0px 0px 0px\">\n                                <span style=\"padding: 0px\">\n                                    Showing <label>", "-", "</label> of <label>", "</label> ", "\n                                </span>\n                        </div>\n                \n                        <div id=\"", "toolbar\" class=\"col-md-6\" style=\"padding: 0px\">\n                \n                            <div class=\"form-inline text-right\">\n                                ", "\n                \n                                <div class=\"btn-group\">\n                                    <button type=\"button\" class=\"btn btn-default ripple btn-sm dropdown-toggle\" data-toggle=\"dropdown\"\n                                            aria-haspopup=\"true\" aria-expanded=\"false\">\n                                        <i id=\"", "DownloadRefresh\" class=\"fa fa-refresh fa-spin\" aria-hidden=\"true\"\n                                           style=\"font-size:14px;display: none\"></i>\n                                        <i id=\"", "DownloadIcon\" class=\"fa fa-download\" aria-hidden=\"true\"\n                                           style=\"padding-right: 5px\"></i> Download <span class=\"caret\"></span>\n                                    </button>\n                                    <ul class=\"dropdown-menu btn-sm\">\n                                        ", "\n                                    </ul>\n                                </div>\n                \n                                <!--Share URL-->\n                                ", "\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n"]);

  opencb_grid_toolbar_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencb_grid_toolbar_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencb_grid_toolbar_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencb_grid_toolbar_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencb_grid_toolbar_ownKeys(Object(source), true).forEach(function (key) { opencb_grid_toolbar_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencb_grid_toolbar_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencb_grid_toolbar_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



class opencb_grid_toolbar_OpencbGridToolbar extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      from: {
        type: String
      },
      to: {
        type: String
      },
      numTotalResultsText: {
        type: String
      },
      config: {
        type: Object
      },
      _prefix: {
        type: String
      }
      /*_config: {
          type: Object
      },*/

    };
  }

  createRenderRoot() {
    return this;
  }

  _init() {
    this._prefix = "dialog" + utils.randomString(6);
    this._config = this.getDefaultConfig();
    this.numTotalResultsText = "0";
  }

  updated(changedProperties) {
    if (changedProperties.has("config")) {
      this._config = opencb_grid_toolbar_objectSpread({}, this.getDefaultConfig(), {}, this.config);
      this.requestUpdate(); //NOTE to avoid _config as prop!
    }
  }

  onDownloadFile(e) {
    console.log("onDownloadFile");
    this.dispatchEvent(new CustomEvent('download', {
      detail: {
        option: e.target.dataset.downloadOption
      },
      bubbles: true,
      composed: true
    }));
  }

  checkboxToggle(e) {
    // We undo the checkbox action. We will toggle it on a different event
    e.currentTarget.checked = !e.currentTarget.checked;
  }

  onColumnClick(e) {
    // Toggle the checkbox
    e.currentTarget.firstElementChild.checked = !e.currentTarget.firstElementChild.checked;
    this.dispatchEvent(new CustomEvent('columnchange', {
      detail: {
        id: e.currentTarget.dataset.columnId,
        selected: e.currentTarget.firstElementChild.checked
      },
      bubbles: true,
      composed: true
    })); // We do this call to avoid the dropdown to be closed after the click

    e.stopPropagation();
  }

  onShareLink(e) {
    this.dispatchEvent(new CustomEvent('sharelink', {
      detail: {},
      bubbles: true,
      composed: true
    }));
  }

  isTrue(value) {
    return utilsNew_UtilsNew.isUndefinedOrNull(value) || value;
  }

  getDefaultConfig() {
    return {
      label: "records",
      columns: [],
      // [{field: "blabla", title: "Blabla", visible: true, eligible: true}]
      download: ["Tab", "JSON"],
      showShareLink: false
    };
  }

  render() {
    return lit_html_lit_html_html(opencb_grid_toolbar_templateObject(), this._prefix, this.from, this.to, this.numTotalResultsText, this._config.label, this._prefix, this._config.columns.length ? lit_html_lit_html_html(opencb_grid_toolbar_templateObject2(), this._prefix, this._config.columns.length ? this._config.columns.map(item => this.isTrue(item.eligible) ? lit_html_lit_html_html(opencb_grid_toolbar_templateObject3(), item.field, this.onColumnClick, this.checkboxToggle, this.isTrue(item.visible), item.title) : null) : null) : null, this._prefix, this._prefix, this._config.download.length && this._config.download.map(item => lit_html_lit_html_html(opencb_grid_toolbar_templateObject4(), item, this.onDownloadFile, item)), this.showShareLink ? lit_html_lit_html_html(opencb_grid_toolbar_templateObject5()) : null);
  }

}
customElements.define("opencb-grid-toolbar", opencb_grid_toolbar_OpencbGridToolbar);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/clinical/opencga-clinical-analysis-grid.js
function opencga_clinical_analysis_grid_templateObject() {
  const data = opencga_clinical_analysis_grid_taggedTemplateLiteral(["\n        <style>\n            .detail-view :hover {\n                background-color: white;\n            }\n\n            .detail-view-row :hover {\n                background-color: #f5f5f5;\n            }\n\n            .cursor-pointer {\n                cursor: pointer;\n            }\n\n            .phenotypes-link-dropdown:hover .dropdown-menu {\n                display: block;\n            }\n\n            .variant-link-dropdown:hover .dropdown-menu {\n                display: block;\n            }\n\n            .qtip-cutom-class .qtip-content{\n                font-size: 12px;\n            }\n        </style>\n\n        <opencb-grid-toolbar .from=\"", "\"\n                             .to=\"", "\"\n                             .numTotalResultsText=\"", "\"\n                             .config=\"", "\"\n                             @columnchange=\"", "\"\n                             @download=\"", "\"\n                             @sharelink=\"", "\">\n        </opencb-grid-toolbar>\n\n        <div id=\"", "GridTableDiv\">\n            <table id=\"", "ClinicalAnalysisBrowserGrid\">\n            </table>\n        </div>\n        "]);

  opencga_clinical_analysis_grid_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_grid_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_clinical_analysis_grid_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_clinical_analysis_grid_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_clinical_analysis_grid_ownKeys(Object(source), true).forEach(function (key) { opencga_clinical_analysis_grid_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_clinical_analysis_grid_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_clinical_analysis_grid_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */






class opencga_clinical_analysis_grid_OpencgaClinicalAnalysisGrid extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      analyses: {
        type: Array
      },
      search: {
        type: Object
      },
      active: {
        type: Boolean
      },
      config: {
        type: Object
      },
      query: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "VarClinicalAnalysisGrid" + utils.randomString(6) + "_";
    this.active = true;
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession") || changedProperties.has("query") || changedProperties.has("active")) {
      this.propertyObserver();
    }
  }

  firstUpdated(_changedProperties) {} // this.renderTable(this.active);

  /* connectedCallback() {
      super.connectedCallback();
       this.renderTable(this.active);
  }*/


  propertyObserver() {
    // With each property change we must updated config and create the columns again. No extra checks are needed.
    this._config = Object.assign({}, this.getDefaultConfig(), this.config);
    this._columns = this._initTableColumns(); // Config for the grid toolbar

    this.toolbarConfig = {
      columns: this._columns[0] // columns: [
      //     {
      //         field: "id", title: "Blabla", visible: true, eligible: true
      //     }
      // ]

    };
    this.renderTable(this.active);
    this.requestUpdate();
  } // todo move to ajaxRequest BT table


  renderTable(active) {
    // if (!active) {
    //     return;
    // }
    this.opencgaClient = this.opencgaSession.opencgaClient;
    this.analyses = [];
    let filters = Object.assign({}, this.query); // Initialise the counters

    this.from = 1;
    this.to = this._config.pageSize;

    if (utilsNew_UtilsNew.isNotUndefined(this.opencgaSession.study) && utilsNew_UtilsNew.isNotUndefined(this.opencgaSession.study.fqn)) {
      filters.study = this.opencgaSession.study.fqn; // if (UtilsNew.isNotUndefinedOrNull(this.lastFilters)
      //     && JSON.stringify(this.lastFilters) === JSON.stringify(filters)) {
      //     // Abort destroying and creating again the grid. The filters have not changed
      //     return;
      // }
      // // Store the current filters
      // this.lastFilters = Object.assign({}, filters);
      // Make a copy of the analyses (if they exist), we will use this private copy until it is assigned to this.analyses

      if (utilsNew_UtilsNew.isNotUndefined(this.analyses)) {
        this._analyses = this.analyses;
      } else {
        this._analyses = [];
      } // Check that HTTP protocol is present and complete the URL


      let opencgaHostUrl = this.opencgaSession.opencgaClient.getConfig().host;

      if (!opencgaHostUrl.startsWith("http://") && !opencgaHostUrl.startsWith("https://")) {
        opencgaHostUrl = "http://" + opencgaHostUrl;
      }

      opencgaHostUrl += "/webservices/rest/v1/analysis/clinical/search";
      let skipCount = false;

      const _table = $("#" + this._prefix + "ClinicalAnalysisBrowserGrid");

      const _this = this;

      _table.bootstrapTable("destroy");

      _table.bootstrapTable({
        url: opencgaHostUrl,
        columns: _this._columns,
        method: "get",
        sidePagination: "server",
        uniqueId: "id",
        // Table properties
        pagination: _this._config.pagination,
        pageSize: _this._config.pageSize,
        pageList: _this._config.pageList,
        showExport: _this._config.showExport,
        detailView: _this._config.detailView,
        detailFormatter: _this._config.detailFormatter,
        // Make Polymer components avalaible to table formatters
        gridContext: _this,
        formatLoadingMessage: () => "<div><loading-spinner></loading-spinner></div>",
        ajax: params => {
          if (this.pageNumber > 1) {
            skipCount = true;
          }

          let filters = opencga_clinical_analysis_grid_objectSpread({}, this.query, {
            exclude: "files",
            limit: 100,
            order: "asc",
            sid: this.opencgaSession.opencgaClient._config.token,
            skip: 0,
            skipCount: true,
            study: this.opencgaSession.study.fqn
          });

          this.opencgaSession.opencgaClient.clinical().search(filters).then(res => params.success(res));
        },

        /*queryParams: function(params) {
            if (this.pageNumber > 1) {
                skipCount = true;
            }
             const auxParams = {
                sid: _this.opencgaSession.opencgaClient._config.sessionId,
                order: params.order,
                sort: params.sort,
                limit: params.limit,
                skip: params.offset,
                skipCount: skipCount,
                exclude: "files"
                // include: "id,name,priority,proband,family,disease,type,creationDate,interpretations,status,dueDate"
            };
             if (UtilsNew.isUndefined(filters)) {
                filters = {};
            }
             return Object.assign({}, filters, auxParams);
        },*/
        responseHandler: function responseHandler(response) {
          if (!skipCount) {
            if (!_this.hasOwnProperty("numTotalResults")) {
              _this.numTotalResults = 0;
            }

            if (_this.numTotalResults !== response.response[0].numTotalResults && response.queryOptions.skip === 0) {
              _this.numTotalResults = response.response[0].numTotalResults;
            }
          } // Set the num total rows in a human readable format


          _this.numTotalResultsText = _this.numTotalResults.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

          if (response.queryOptions.skip === 0 && _this.numTotalResults < response.queryOptions.limit) {
            _this.from = 1;
            _this.to = _this.numTotalResults;
          }

          _this.requestUpdate(); // it is necessary to refresh numTotalResultsText in opencga-grid-toolbar


          return {
            total: _this.numTotalResults,
            rows: response.response[0].result
          };
        },
        onClickRow: function onClickRow(row, element, field) {
          if (_this._config.multiSelection) {
            // Check and uncheck when clicking in the checkbox TD cell
            if (field === "state") {
              const index = element[0].dataset.index;

              if (element[0].className.includes("selected")) {
                $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "ClinicalAnalysisBrowserGrid")).bootstrapTable("uncheck", index);
              } else {
                $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "ClinicalAnalysisBrowserGrid")).bootstrapTable("check", index);
                $(".success").removeClass("success");
                $(element).addClass("success");
              }
            } else {
              // If user has clicked in the row
              const index = element[0].dataset.index;

              if (element[0].className.includes("selected")) {
                $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "ClinicalAnalysisBrowserGrid")).bootstrapTable("uncheck", index);
                $(element).removeClass("success");
              } else {
                $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "ClinicalAnalysisBrowserGrid")).bootstrapTable("check", index);
              }
            }
          } else {
            // If not checkboxes exist
            $(".success").removeClass("success");
            $(element).addClass("success");
          }

          _this._onSelectClinicalAnalysis(row);
        },
        onDblClickRow: function onDblClickRow(row, element, field) {
          // We detail view is active we expand the row automatically.
          // FIXME: Note that we use a CSS class way of knowing if the row is expand or collapse, this is not ideal but works.
          if (_this._config.detailView) {
            if (element[0].innerHTML.includes("icon-plus")) {
              $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "ClinicalAnalysisBrowserGrid")).bootstrapTable("expandRow", element[0].dataset.index);
            } else {
              $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "ClinicalAnalysisBrowserGrid")).bootstrapTable("collapseRow", element[0].dataset.index);
            }
          }
        },
        onCheck: function onCheck(row, element) {
          // check analysis is not already selected
          for (const i in _this._analyses) {
            if (_this._analyses[i].id === row.id) {
              return;
            }
          } // we add analyses to selected analyses
          // _this.push("_analyses", row);
          // _this.set("analyses", _this._analyses.slice());


          _this._analyses.push(row);

          _this._analyses = _this._analyses.slice(); // We only activate the row when checking

          if (_this._config.detailView) {
            $(".success").removeClass("success");
          }

          $(element[0].parentElement.parentElement).addClass("success"); // If exist on single nested sample we must check it

          if (row.samples.length === 1) {
            const checkbox = PolymerUtils_PolymerUtils.getElementById(_this._prefix + row.samples[0].id + "Checkbox");

            if (utilsNew_UtilsNew.isNotUndefinedOrNull(checkbox)) {
              checkbox.checked = true;
            }
          }
        },
        onUncheck: function onUncheck(row, elem) {
          let analysisToDeleteIdx = -1;

          for (const i in _this.analyses) {
            if (_this.analyses[i].id === row.id) {
              analysisToDeleteIdx = i;
              break;
            }
          }

          if (analysisToDeleteIdx === -1) {
            return;
          } // _this.splice("_analyses", analysisToDeleteIdx, 1);
          // _this.set("analyses", _this._analyses.slice());


          _this._analyses.splice(analysisToDeleteIdx, 1);

          _this.analyses = _this._analyses.slice(); // We detail view is active we expand the row automatically

          if (_this._config.detailView) {
            $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "ClinicalAnalysisBrowserGrid")).bootstrapTable("collapseRow", elem[0].dataset.index);
          } // We must uncheck nested checked samples


          if (row.samples.length > 0) {
            for (const sample of row.samples) {
              const checkbox = PolymerUtils_PolymerUtils.getElementById(_this._prefix + sample.id + "Checkbox");

              if (utilsNew_UtilsNew.isNotUndefinedOrNull(checkbox)) {
                checkbox.checked = false;
              }
            }
          }
        },
        onCheckAll: function onCheckAll(rows) {
          const newClinicalAnalyses = _this._analyses.slice(); // check analysis is not already selected


          rows.forEach(analysis => {
            const existsNewSelected = _this._analyses.some(analysisSelected => {
              return analysisSelected.id === analysis.id;
            });

            if (!existsNewSelected) {
              newClinicalAnalyses.push(analysis);
            }
          }); // we add analyses to selected analyses

          _this._analyses = newClinicalAnalyses; // _this.set("analyses", newClinicalAnalyses.slice());

          _this.analyses = newClinicalAnalyses.slice(); // We must uncheck nested checked samples

          for (const row of rows) {
            if (row.samples.length === 1) {
              const checkbox = PolymerUtils_PolymerUtils.getElementById(_this._prefix + row.samples[0].id + "Checkbox");

              if (utilsNew_UtilsNew.isNotUndefinedOrNull(checkbox)) {
                checkbox.checked = true;
              }
            }
          }
        },
        onUncheckAll: function onUncheckAll(rows) {
          // check analysis is not already selected
          rows.forEach(analysis => {
            _this._analyses = _this._analyses.filter(analysisSelected => {
              return analysisSelected.id !== analysis.id;
            });
          }); // we add analyses to selected analyses
          //                            _this.push("_analyses", row);
          // _this.set("analyses", _this._analyses.slice());

          _this.analyses = _this._analyses.slice(); // We must uncheck nested checked samples

          for (const row of rows) {
            for (const sample of row.samples) {
              const checkbox = PolymerUtils_PolymerUtils.getElementById(_this._prefix + sample.id + "Checkbox");

              if (utilsNew_UtilsNew.isNotUndefinedOrNull(checkbox)) {
                checkbox.checked = false;
              }
            }
          }
        },
        onLoadSuccess: function onLoadSuccess(data) {
          // Add click event to the "review case" buttons
          const reviewCaseButtons = PolymerUtils_PolymerUtils.querySelectorAll(".reviewCaseButton");

          for (let i = 0; i < reviewCaseButtons.length; i++) {
            reviewCaseButtons[i].addEventListener("click", _this.reviewCaseButtonClicked);
          } // Check all already selected rows. Selected analyses are stored in this.analyses array


          if (utilsNew_UtilsNew.isNotUndefinedOrNull(_table)) {
            if (!_this._config.multiSelection) {
              PolymerUtils_PolymerUtils.querySelector(_table.selector).rows[1].setAttribute("class", "success");

              _this._onSelectClinicalAnalysis(data.rows[0]);
            }

            if (_this.analyses !== "undefined") {
              for (const idx in _this.analyses) {
                for (const j in data.rows) {
                  if (_this.analyses[idx].id === data.rows[j].id) {
                    $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "ClinicalAnalysisBrowserGrid")).bootstrapTable("check", j);
                    break;
                  }
                }
              }
            }
          }
        },
        onPageChange: function onPageChange(page, size) {
          _this.from = (page - 1) * size + 1;
          _this.to = page * size;
        },
        onPostBody: function onPostBody(data) {
          // Add qtip2 tooltips to Interpretation genotypes
          $("div.interpretation-tooltip").qtip({
            content: {
              title: "Clinical Interpreters",
              text: function text(event, api) {
                return $(this).attr("data-tooltip-text");
              }
            },
            position: {
              target: "mouse",
              adjust: {
                x: 2,
                y: 2,
                mouse: false
              }
            },
            style: {
              classes: "qtip-light qtip-rounded qtip-shadow qtip-cutom-class",
              width: "320px"
            },
            show: {
              delay: 200
            },
            hide: {
              fixed: true,
              delay: 300
            }
          });
        }
      });
    } else {
      // Delete table
      $(PolymerUtils_PolymerUtils.getElementById(this._prefix + "ClinicalAnalysisBrowserGrid")).bootstrapTable("destroy");
      this.numTotalResults = 0;
    }
  }

  _onSelectClinicalAnalysis(row) {
    if (typeof row !== "undefined") {
      this.dispatchEvent(new CustomEvent("selectanalysis", {
        detail: {
          id: row.id,
          analysis: row
        }
      }));
    }
  }

  onColumnChange(e) {
    const table = $("#" + this._prefix + "ClinicalAnalysisBrowserGrid");

    if (e.detail.selected) {
      table.bootstrapTable("showColumn", e.detail.id);
    } else {
      table.bootstrapTable("hideColumn", e.detail.id);
    }
  }
  /**
   * DEPRECATED.
   * @param index
   * @param row
   * @return {HTMLElement}
   */


  detailFormatter(index, row) {
    const clinicalAnalysisView = document.createElement("clinical-analysis-view");
    clinicalAnalysisView.opencgaSession = this.gridContext.opencgaSession;
    clinicalAnalysisView.opencgaClient = this.gridContext.opencgaSession.opencgaClient;
    clinicalAnalysisView.clinicalAnalysisId = row.id;
    clinicalAnalysisView.showTitle = false;
    const title = document.createElement("h3");
    title.innerText = "Summary";
    const div = document.createElement("div");
    div.style = "padding: 5px 20px 10px 20px";
    div.appendChild(title);
    div.appendChild(clinicalAnalysisView);
    return div;
  }

  analysisIdFormatter(value, row) {
    const html = "<span style=\"font-size: 1.1em\">\n                                ".concat(value, "\n                            </span>\n                "); // <a style="cursor: pointer" class="btn btn-link" href="#reviewCase">
    //         ${value} <i class="fa fa-search" aria-hidden="true" style="padding-left: 5px"></i>
    //         </a>

    return html;
  }

  probandFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(row)) {
      return row.proband.name;
    }
  }

  familyFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(row)) {
      return value + " (".concat(row.family.members.length, ")");
    }
  }

  interpretationsFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(row) && utilsNew_UtilsNew.isNotEmptyArray(row.interpretations)) {
      let interpretationHtml = "<div>";

      for (const interpretation of row.interpretations) {
        interpretationHtml += "<div>\n                                                    <span>".concat(interpretation.id, "<span>\n                                               </div>");
      }

      interpretationHtml += "</div>";
      return interpretationHtml;
    } else {
      return "<span title='No interpretations available'>NA</span>";
    }
  }

  diseaseFormatter(value, row) {
    return row.disease.name;
  }

  priorityFormatter(value) {
    // TODO: Remove commented code. This is only for debugging purposes to see all the different priorities
    // if (UtilsNew.isUndefinedOrNull(this.count)) {
    //     this.count = 0;
    // }
    // if (this.count % 4 === 0) {
    //     value = "URGENT";
    // }
    // if (this.count % 4 === 1) {
    //     value = "HIGH";
    // }
    // if (this.count % 4 === 2) {
    //     value = "MEDIUM";
    // }
    // if (this.count % 4 === 3) {
    //     value = "LOW";
    // }
    // this.count++;
    if (utilsNew_UtilsNew.isEmpty(value)) {
      return "<span>-</span>";
    } else {
      const styles = ["color: white", "border-radius: 5px", "padding: 3px", "width: 65px", "display: block", "margin: auto"];

      switch (value) {
        case "URGENT":
          styles.push("background: #ef6363", "border: 1px solid red");
          return "<span style='color: #ef6363; font-weight: bold'>Urgent</span>";

        case "HIGH":
          styles.push("background: #ffb42b", "border: 1px solid orange");
          return "<span style='color: #ffb42b; font-weight: bold'>High</span>";

        case "MEDIUM":
          styles.push("background: #237afb", "border: 1px solid blue");
          return "<span style='color: #237afb; font-weight: bold'>Medium</span>";

        case "LOW":
          styles.push("background: #1bb31b", "border: 1px solid green");
          return "<span style='color: #1bb31b; font-weight: bold'>Low</span>";

        default:
          return "<span>-</span>";
      }
    }
  }

  dateFormatter(value, row) {
    if (utilsNew_UtilsNew.isUndefinedOrNull(value)) {
      return "-";
    }

    return moment(value, "YYYYMMDDHHmmss").format("D MMM YYYY");
  } // reviewCaseFormatter(value, row) {
  //     // return `<button data-id=${row.id} style="cursor: pointer; color: #5a4444; border-radius: 5px; padding: 4px;
  //     //         background: #eae7d8; border: 1px solid #8a6d3b;" class='reviewCaseButton'>
  //     //         <i class="fa fa-search" aria-hidden="true"></i> Review Case</button>`;
  //     return `<a style="cursor: pointer" class="btn btn-link" href="#reviewCase">
  //                 <i class="fa fa-search" aria-hidden="true"></i> Review
  //             </a>`;
  // }


  interpretationFormatter(value, row) {
    // console.log("interpretationFormatter",value,row)
    const tooltipText = "\n                                   <div style='padding: 5px 15px; color: darkgray; font-weight: bolder'>Rare Disease (Not Available yet)</div>\n                                   <div>\n                                        <button type='button' class='btn btn-sm btn-link' title='No report tool available yet' style='padding: 2px 10px' disabled>\n                                            OpenCGA Tiering (based on GEL Tiering)\n                                        </button>\n                                   </div>\n                                   <div>\n                                        <button type='button' class='btn btn-sm btn-link' title='No report tool available yet' style='padding: 2px 10px' disabled>\n                                            TEAM\n                                        </button>\n                                   </div>\n                                   ";
    return "<div style=\"padding: 5px\">\n                            <a style=\"cursor: pointer\" href=\"#interpretation/".concat(this.opencgaSession.project.alias, "/").concat(this.opencgaSession.study.alias, "/").concat(row.id, "\">\n                                <i class=\"fa fa-filter\" aria-hidden=\"true\"></i> Open Interpreter \n                            </a> \n                        </div>\n                        <div class=\"interpretation-tooltip\" data-tooltip-text=\"").concat(tooltipText, "\">\n                            <a style=\"cursor: pointer\">\n                                Automatic Interpreters\n                            </a>\n                        </div>");
  }

  reportFormatter(value, row) {
    // return `<a style="cursor: pointer" href="#createReport" title="No report tool available yet" disabled>
    //             <i class="fa fa-id-card" aria-hidden="true"></i> Create
    //         </a>`;
    return "<button type=\"button\" class=\"btn btn-sm btn-link\" title=\"No report tool available yet\" disabled>\n                            <i class=\"fa fa-id-card\" aria-hidden=\"true\"></i> Create\n                        </button>";
  }

  reviewCaseButtonClicked(e) {// The clinical anlysisi id is in: e.target.dataset.id
  }

  _initTableColumns() {
    const columns = [];

    if (this._config.multiSelection) {
      columns.push({
        field: "state",
        radio: true,
        align: "center",
        valign: "middle",
        class: "cursor-pointer",
        eligible: false
      });
    }

    this._columns = [columns.concat([{
      title: "Analysis ID",
      field: "id",
      formatter: this.analysisIdFormatter,
      valign: "middle",
      visible: !this._config.columns.hidden.includes("id")
    }, {
      title: "Proband ID",
      field: "proband.id",
      valign: "middle",
      visible: !this._config.columns.hidden.includes("probandId")
    }, {
      title: "Family (#members)",
      field: "family.id",
      valign: "middle",
      formatter: this.familyFormatter,
      visible: !this._config.columns.hidden.includes("familyId")
    }, {
      title: "Disorder",
      field: "disorder.id",
      valign: "middle",
      // formatter: this.diseaseFormatter
      visible: !this._config.columns.hidden.includes("disorderId")
    }, {
      title: "Type",
      field: "type",
      valign: "middle",
      visible: !this._config.columns.hidden.includes("type")
    }, {
      title: "Interpretations",
      field: "interpretations",
      valign: "middle",
      formatter: this.interpretationsFormatter,
      visible: !this._config.columns.hidden.includes("interpretation")
    }, {
      title: "Status",
      field: "status.name",
      valign: "middle",
      halign: this._config.header.horizontalAlign,
      visible: !this._config.columns.hidden.includes("status")
    }, {
      title: "Priority",
      field: "priority",
      align: "center",
      valign: "middle",
      formatter: this.priorityFormatter,
      visible: !this._config.columns.hidden.includes("priority")
    }, {
      title: "Assigned To",
      field: "analyst.assignee",
      align: "center",
      valign: "middle",
      visible: !this._config.columns.hidden.includes("assignedTo")
    }, {
      title: "Creation Date",
      field: "creationDate",
      valign: "middle",
      formatter: this.dateFormatter,
      visible: !this._config.columns.hidden.includes("creationDate")
    }, {
      title: "Due Date",
      field: "dueDate",
      valign: "middle",
      formatter: this.dateFormatter,
      visible: !this._config.columns.hidden.includes("dueDate")
    }, // {
    //     title: 'Review',
    //     eligible: false,
    //     align: 'center',
    //     visible: this._config.showReviewCase,
    //     formatter: this.reviewCaseFormatter.bind(this)
    // },
    {
      title: "Intepreter",
      eligible: false,
      align: "center",
      valign: "middle",
      formatter: this.interpretationFormatter.bind(this),
      visible: this._config.showInterpretation
    }, {
      title: "Report",
      eligible: false,
      align: "center",
      valign: "middle",
      formatter: this.reportFormatter.bind(this),
      visible: this._config.showReport
    }])];
    return this._columns;
  }

  _getUrlQueryParams() {// TODO
  }

  onDownload(e) {
    // let urlQueryParams = this._getUrlQueryParams();
    // let params = urlQueryParams.queryParams;
    console.log(this.opencgaSession);

    const params = opencga_clinical_analysis_grid_objectSpread({}, this.query, {
      exclude: "files",
      limit: 100,
      order: "asc",
      sid: this.opencgaSession.opencgaClient._config.token,
      skip: 0,
      skipCount: true,
      study: this.opencgaSession.study.fqn
    });

    this.opencgaSession.opencgaClient.clinical().search(params).then(response => {
      console.log("response", response);
      const result = response.response[0].result;
      let dataString = [];
      let mimeType = "";
      let extension = ""; //TODO evaluate webworker with Transferable Objects (it shares objects, not copy like classical WebWorker)

      if (result) {
        console.log("result", result); // Check if user clicked in Tab or JSON format

        if (e.detail.option.toLowerCase() === "tab") {
          dataString = [["Analysis ID", "Proband ID", "Family (#members)", "Disorder", "Type", "Interpretations", "Status", "Priority", "Assigned To", "Creation Date"].join("\t"), ...result.map(_ => [_.id, _.proband.id, _.family.id + "" + _.family.members.length, _.disorder ? _.disorder.id : "", _.type, _.interpretations.join(","), _.status.name, _.priority, _.analyst.assignee, _.creationDate].join("\t"))]; //console.log(dataString);

          mimeType = "text/plain";
          extension = ".txt";
        } else {
          for (const res of result) {
            dataString.push(JSON.stringify(res, null, "\t"));
          }

          mimeType = "application/json";
          extension = ".json";
        } // Build file and anchor link


        const data = new Blob([dataString.join("\n")], {
          type: mimeType
        });
        const file = window.URL.createObjectURL(data);
        const a = document.createElement("a");
        a.href = file;
        a.download = this.opencgaSession.study.alias + extension;
        document.body.appendChild(a);
        a.click();
        setTimeout(function () {
          document.body.removeChild(a);
        }, 0);
      } else {
        console.error("Error in result format");
      }
    }).then(function () {//this.downloadRefreshIcon.css("display", "none");
      //this.downloadIcon.css("display", "inline-block");
    });
  }

  onShare() {//TODO
  }

  getDefaultConfig() {
    return {
      pagination: true,
      pageSize: 5,
      pageList: [10, 25, 50],
      showExport: false,
      showReviewCase: true,
      showInterpretation: true,
      showReport: true,
      detailView: false,
      detailFormatter: this.detailFormatter,
      // function with the detail formatter
      multiSelection: false,
      header: {
        horizontalAlign: "center",
        verticalAlign: "bottom"
      },
      columns: {
        hidden: ["status", "priority", "assignedTo", "dueDate"]
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_clinical_analysis_grid_templateObject(), this.from, this.to, this.numTotalResultsText, this.toolbarConfig, this.onColumnChange, this.onDownload, this.onShare, this._prefix, this._prefix);
  }

}
customElements.define("opencga-clinical-analysis-grid", opencga_clinical_analysis_grid_OpencgaClinicalAnalysisGrid);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/svg.js
/*
 * Copyright (c) 2012 Francisco Salavert (ICM-CIPF)
 * Copyright (c) 2012 Ruben Sanchez (ICM-CIPF)
 * Copyright (c) 2012 Ignacio Medina (ICM-CIPF)
 *
 * This file is part of JS Common Libs.
 *
 * JS Common Libs is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 2 of the License, or
 * (at your option) any later version.
 *
 * JS Common Libs is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with JS Common Libs. If not, see <http://www.gnu.org/licenses/>.
 */
// Element.prototype.addChildSVG = function(elementName, attributes, index){
//	var el = document.createElementNS('http://www.w3.org/2000/svg', elementName);
//	for ( var key in attributes){
//		el.setAttribute(key, attributes[key]);
//	}
//
//	// insert child at requested index, or as last child if index is too high or no index is specified
//    if ( null == index ) {
//      this.appendChild( el );
//    }
//    else {
//      var targetIndex = index + 1;
//      if ( 0 == index ) {
//        targetIndex = 0;
//      }
//      var targetEl = this.childNodes[ targetIndex ];
//      if ( targetEl ) {
//        this.insertBefore( el, targetEl );
//      }
//      else {
//        this.appendChild( el );
//      }
//    }
//    return el;
// };
// Element.prototype.initSVG = function(attributes){
//	return this.addChildSVG("svg", attributes);
// };
const svg_SVG = {
  create(elementName, attributes) {
    const el = document.createElementNS("http://www.w3.org/2000/svg", elementName);

    for (const key in attributes) {
      el.setAttribute(key, attributes[key]);
    }

    return el;
  },

  addChild(parent, elementName, attributes, index) {
    const el = document.createElementNS("http://www.w3.org/2000/svg", elementName);

    for (const key in attributes) {
      el.setAttribute(key, attributes[key]);
    }

    return this._insert(parent, el, index);
  },

  addChildImage(parent, attributes, index) {
    const el = document.createElementNS("http://www.w3.org/2000/svg", "image");

    for (const key in attributes) {
      if (key == "xlink:href") {
        el.setAttributeNS("http://www.w3.org/1999/xlink", "href", attributes[key]);
      } else {
        el.setAttribute(key, attributes[key]);
      }
    }

    return this._insert(parent, el, index);
  },

  _insert(parent, el, index) {
    // insert child at requested index, or as last child if index is too high or no index is specified
    if (index == null) {
      parent.appendChild(el);
    } else {
      let targetIndex = index + 1;

      if (index == 0) {
        targetIndex = 0;
      }

      const targetEl = parent.childNodes[targetIndex];

      if (targetEl) {
        parent.insertBefore(el, targetEl);
      } else {
        parent.appendChild(el);
      }
    }

    return el;
  },

  init(parent, attributes) {
    return this.addChild(parent, "svg", attributes);
  },

  //

  /* Functions to generate arcs with PATH element  */
  //
  _polarToCartesian(centerX, centerY, radius, angleInDegrees) {
    const angleInRadians = (angleInDegrees - 90) * Math.PI / 180.0;
    return {
      x: centerX + radius * Math.cos(angleInRadians),
      y: centerY + radius * Math.sin(angleInRadians)
    };
  },

  describeArc(x, y, radius, startAngle, endAngle) {
    const start = this._polarToCartesian(x, y, radius, endAngle);

    const end = this._polarToCartesian(x, y, radius, startAngle);

    const arcSweep = endAngle - startAngle <= 180 ? "0" : "1";
    const d = ["M", start.x, start.y, "A", radius, radius, 0, arcSweep, 0, end.x, end.y].join(" ");
    return d;
  }

}; // createSVG = function(elementName, attributes){
//	var el = document.createElementNS('http://www.w3.org/2000/svg', elementName);
//	for ( var key in attributes){
//		el.setAttribute(key, attributes[key]);
//	}
//	return el;
// };
// var SVG =
// {
//		svgns : 'http://www.w3.org/2000/svg',
//		xlinkns : "http://www.w3.org/1999/xlink",
//
// //	createSVGCanvas: function(parentNode, attributes)
// //	{
// ////		attributes['xmlns'] = SVG.svgns;
// ////		attributes['xmlns:xlink'] = SVG.xlinkns;
// ////		attributes.push( ['xmlns', SVG.svgns], ['xmlns:xlink', 'http://www.w3.org/1999/xlink']);
// //		var svg = document.createElementNS(SVG.svgns, "svg");
// //
// //		for ( var key in attributes){
// //			svg.setAttribute(key, attributes[key]);
// //		}
// //
// //		parentNode.appendChild(svg);
// //		return svg;
// //	},
//
//	//Shape types : rect, circle, ellipse, line, polyline, polygon , path
//	createElement : function (svgNode, shapeName, attributes) {
//		try{
//			if(attributes.width < 0){
//				console.log("BIOINFO Warn: on SVG.createRectangle: width is negative, will be set to 0");
//				attributes.width=0;
//			}
//			if(attributes.height < 0){
//				console.log("BIOINFO Warn: on SVG.createRectangle: height is negative, will be set to 0");
//				attributes.height=0;
//			}
//
//			var shape = document.createElementNS('http://www.w3.org/2000/svg', shapeName);
//			for ( var key in attributes){
//				shape.setAttribute(key, attributes[key]);
//			}
//			svgNode.appendChild(shape);
//		}
//		catch(e){
//			console.log("-------------------- ");
//			console.log("Error on drawRectangle " + e);
//			console.log(attributes);
//			console.log("-------------------- ");
//		}
//		return shape;
//	}
// };
//
//
//
// var CanvasToSVG = {
//
//	convert: function(sourceCanvas, targetSVG, x, y, id, attributes) {
//
//		var img = this._convert(sourceCanvas, targetSVG, x, y, id);
//
//		for (var i=0; i< attributes.length; i++)
//		{
//			img.setAttribute(attributes[i][0], attributes[i][1]);
//		}
//	},
//
//	_convert: function(sourceCanvas, targetSVG, x, y, id) {
//		var svgNS = "http://www.w3.org/2000/svg";
//		var xlinkNS = "http://www.w3.org/1999/xlink";
//		// get base64 encoded png from Canvas
//		var image = sourceCanvas.toDataURL();
//
//		// must be careful with the namespaces
//		var svgimg = document.createElementNS(svgNS, "image");
//
//		svgimg.setAttribute('id', id);
//
//		//svgimg.setAttribute('class', class);
//		//svgimg.setAttribute('xlink:href', image);
//		svgimg.setAttributeNS(xlinkNS, 'xlink:href', image);
//
//
//		svgimg.setAttribute('x', x ? x : 0);
//		svgimg.setAttribute('y', y ? y : 0);
//		svgimg.setAttribute('width', sourceCanvas.width);
//		svgimg.setAttribute('height', sourceCanvas.height);
//		//svgimg.setAttribute('cursor', 'pointer');
//		svgimg.imageData = image;
//
//		targetSVG.appendChild(svgimg);
//		return svgimg;
//	},
//
//	importSVG: function(sourceSVG, targetCanvas) {
//	    svg_xml = sourceSVG;//(new XMLSerializer()).serializeToString(sourceSVG);
//	    var ctx = targetCanvas.getContext('2d');
//
//	    var img = new Image();
//	    img.src = "data:image/svg+xml;base64," + btoa(svg_xml);
// //	    img.onload = function() {
//	        ctx.drawImage(img, 0, 0);
// //	    };
//	}
//
// };
// CONCATENATED MODULE: ./lib/jsorolla/src/core/visualisation/pedigree.js
/*
 * Copyright 2015-2016 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


class pedigree_Pedigree {
  constructor(pedigree, settings) {
    this.pedigree = pedigree;
    this.settings = settings;
  }

  isDuo() {
    return (typeof this.pedigree.father !== "undefined" || typeof this.pedigree.mother !== "undefined") && typeof this.pedigree.children !== "undefined" && this.pedigree.children.length === 1;
  }

  isTrio() {
    return typeof this.pedigree.father !== "undefined" && typeof this.pedigree.mother !== "undefined" && typeof this.pedigree.children !== "undefined" && this.pedigree.children.length === 1;
  }

  isFamily() {
    return typeof this.pedigree.father !== "undefined" && typeof this.pedigree.mother !== "undefined" && typeof this.pedigree.children !== "undefined" && this.pedigree.children.length > 1;
  }

  render(settings) {
    return this._render(this.pedigree, settings);
  }

  static renderFromPed(pedigree, settings) {
    return this._render(pedigree, settings);
  }

  _render(ped, settings) {
    // If no settings is provided we use the one passed in the constructor
    if (typeof settings === "undefined" || settings === null) {
      settings = this.settings;
    } // We merge user's setting with default settings, by doing this users do not have to write al possible settings


    settings = Object.assign(this.getDefaultSetting(), settings, this.settings);

    let pedigree = this._preprocessFamily(ped);

    let svg = svg_SVG.create("svg", {
      width: settings.width,
      height: settings.height,
      viewBox: "0 0 " + settings.width + " " + settings.height,
      style: "fill: white",
      xmlns: "http://www.w3.org/2000/svg"
    });

    if (settings.border) {
      svg_SVG.addChild(svg, "rect", {
        width: settings.width,
        height: settings.height,
        style: "fill: white;stroke: black"
      });
    }

    svg.appendChild(this._createSvgDefs(pedigree, settings));
    let xCenter = settings.width / 2;
    let radius = settings.box / 2; // Draw the lines between parents and children

    if (typeof pedigree.father !== "undefined" || typeof pedigree.mother !== "undefined") {
      let verticalBarOffset = 0;

      if (typeof pedigree.father !== "undefined" && typeof pedigree.mother !== "undefined" && (pedigree.father.partnerConsaguinity || pedigree.mother.partnerConsaguinity)) {
        verticalBarOffset = 2;
        svg_SVG.addChild(svg, "line", {
          x1: xCenter - settings.box,
          y1: 10 + radius - verticalBarOffset,
          x2: xCenter + settings.box,
          y2: 10 + radius - verticalBarOffset,
          style: "stroke: black;stroke-width: 2"
        });
        svg_SVG.addChild(svg, "line", {
          x1: xCenter - settings.box,
          y1: 10 + radius + verticalBarOffset,
          x2: xCenter + settings.box,
          y2: 10 + radius + verticalBarOffset,
          style: "stroke: black;stroke-width: 2"
        });
      } else {
        svg_SVG.addChild(svg, "line", {
          x1: xCenter - settings.box,
          y1: 10 + radius,
          x2: xCenter + settings.box,
          y2: 10 + radius,
          style: "stroke: black;stroke-width: 2"
        });
      } // Vertical bar for children


      svg_SVG.addChild(svg, "line", {
        x1: xCenter,
        y1: 10 + radius + verticalBarOffset,
        x2: xCenter,
        y2: 10 + radius + 1.5 * settings.box,
        style: "stroke: black;stroke-width: 2"
      });
    } // Draw the FATHER


    if (typeof pedigree.father !== "undefined") {
      // pedigree.father.sex = "male";
      this._addFamilyMember(pedigree.father, xCenter - 1.5 * settings.box, 10, settings.box, radius, settings.selectShowSampleNames, svg);
    } // Draw the MOTHER


    if (typeof pedigree.mother !== "undefined") {
      // pedigree.mother.sex = "female";
      this._addFamilyMember(pedigree.mother, xCenter + 1.5 * settings.box, 10, settings.box, radius, settings.selectShowSampleNames, svg);
    } // Draw the CHILDREN


    if (typeof pedigree.children !== "undefined" && pedigree.children.length > 0) {
      if (pedigree.children.length === 1) {
        this._addFamilyMember(pedigree.children[0], xCenter, 2 * settings.box + 10, settings.box, radius, settings.selectShowSampleNames, svg);
      } else {
        let numChildren = pedigree.children.length;
        let w = (numChildren + numChildren - 1) * settings.box; // Add horizontal bar

        svg_SVG.addChild(svg, "line", {
          x1: xCenter - w / 2,
          y1: 10 + radius + 1.5 * settings.box,
          x2: xCenter + w / 2,
          y2: 10 + radius + 1.5 * settings.box,
          style: "stroke: black;stroke-width: 2"
        });
        let left = xCenter - w / 2;
        let interval = w / (numChildren - 1);

        for (let i = 0; i < pedigree.children.length; i++) {
          svg_SVG.addChild(svg, "line", {
            x1: left + i * interval,
            y1: 10 + radius + 1.5 * settings.box,
            x2: left + i * interval,
            y2: 10 + radius + 1.5 * settings.box + 15,
            style: "stroke: black;stroke-width: 2"
          });

          this._addFamilyMember(pedigree.children[i], left + i * interval, 1.5 * settings.box + 15 + 10 + radius, settings.box, radius, settings.selectShowSampleNames, svg);
        }
      }
    }

    return svg;
  }

  _addFamilyMember(object, x, y, width, radius, showSampleNames, svg) {
    // No defined sex
    let memberSVG;

    if (typeof object.sex === "undefined" || object.sex === "undefined") {
      svg_SVG.addChild(svg, "rect", {
        x: x - radius,
        y: y,
        width: width * 0.8,
        height: width * 0.8,
        transform: "translate(" + radius + ") rotate(45 " + (x - radius) + " " + (10 + radius + 1.5 * width + y) + ")",
        style: "fill: " + object.colorPattern + ";stroke: black;stroke-width: 2"
      });
    } else {
      // Member is a male
      if (object.sex === "male" || object.sex === "MALE") {
        svg_SVG.addChild(svg, "rect", {
          x: x - radius,
          y: y,
          width: width,
          height: width,
          // fill: "url(#Pattern2)",
          style: "fill: url(#" + object.colorPattern + ");stroke: black;stroke-width: 2"
        });
      } else {
        // Member is a female
        memberSVG = svg_SVG.addChild(svg, "circle", {
          cx: x,
          cy: y + radius,
          r: radius,
          style: "fill: url(#" + object.colorPattern + ");stroke: black;stroke-width: 2"
        });
      }
    }

    if (typeof object.lifeStatus !== 'undefined' && object.lifeStatus !== null && object.lifeStatus.toUpperCase() === "DECEASED") {
      svg_SVG.addChild(svg, "line", {
        x1: x - radius - 10,
        y1: y + radius + 30,
        x2: x + radius + 10,
        y2: y - radius + 10,
        style: "stroke: black;stroke-width: 2"
      });
    }

    if (showSampleNames) {
      let text = svg_SVG.addChild(svg, "text", {
        x: x - radius + 2,
        y: y + width + 15,
        style: "fill: black;font-size:11px"
      });
      text.textContent = object.name;
    } // $(memberSVG).qtip({
    //     content: {text: "3:1000123:A:T: " + "<span style='font-weight: bold'>0/1</span>", title: object.member.name},
    //     position: {target: "mouse", adjust: {x: 25, y: 15}, effect: false},
    //     // position: {viewport: $(window), target: "mouse", adjust: {x: 25, y: 15}},
    //     style: {width: true, classes: "ui-tooltip ui-tooltip-shadow"},
    //     show: {delay: 300},
    //     hide: {delay: 300}
    // });

  }

  _preprocessFamily(fam) {
    // Create, edit and return a deep copy of the user object, this prevents us of modifying user's object
    let family = JSON.parse(JSON.stringify(fam));
    let map = {};

    for (let m of family.members) {
      map[m.name] = m;
    }

    let colorMap = {};

    for (let idx in family.disorders) {
      colorMap[family.disorders[idx].id] = idx;
    }

    family.children = [];

    for (let m of family.members) {
      if (m.father !== undefined || m.mother !== undefined) {
        if (m.father !== undefined) {
          map[m.father].partner = m.mother;
          map[m.father].partnerConsaguinity = m.parentalConsanguinity;
        }

        if (m.mother !== undefined) {
          map[m.mother].partner = m.father;
          map[m.mother].partnerConsaguinity = m.parentalConsanguinity;
        }

        if (m.father !== undefined && this._isOrphan(map[m.father])) {
          family.father = map[m.father];
        }

        if (m.mother !== undefined && this._isOrphan(map[m.mother])) {
          family.mother = map[m.mother];
        }

        family.children.push(m);
      } // We save the corresponding disease color pattern for each sample


      if (m.disorders !== undefined && m.disorders.length > 0) {
        let colorIdx = [];

        for (let c of m.disorders) {
          colorIdx.push(colorMap[c]);
        } // Pattern suffix IDs must be sorted, eg. Pattern_01


        colorIdx = colorIdx.sort();
        m.colorPattern = "Pattern_" + colorIdx.join("");
      } else {
        m.colorPattern = "PatternWhite";
      }
    }

    return family;
  } // This function create the different color Patterns in a SVG 'defs' section


  _createSvgDefs(family, settings) {
    let svgDefs = svg_SVG.create("defs"); // Default color pattern when no disease exist

    let pattern = svg_SVG.create("pattern", {
      id: "PatternWhite",
      x: 0,
      y: 0,
      width: 1,
      height: 1
    });
    let rect = svg_SVG.create("rect", {
      x: 0,
      y: 0,
      width: settings.box,
      height: settings.box,
      fill: "white"
    });
    pattern.appendChild(rect);
    svgDefs.appendChild(pattern); // We create all possible combination (incrementally with no reptition, eg. 0, 01, 02, 1, 12, ...)

    for (let i = 0; i < family.disorders.length; i++) {
      // Add the single disease color, eg. 0, 1, 2
      let pattern = svg_SVG.create("pattern", {
        id: "Pattern_" + i,
        x: 0,
        y: 0,
        width: 1,
        height: 1
      });
      let rect = svg_SVG.create("rect", {
        x: 0,
        y: 0,
        width: settings.box,
        height: settings.box,
        fill: settings.colors[i]
      });
      pattern.appendChild(rect);
      svgDefs.appendChild(pattern); // Add the double disease color, eg. 01, 02, 12, ...

      for (let j = i + 1; j < family.disorders.length; j++) {
        let pattern = svg_SVG.create("pattern", {
          id: "Pattern_" + i + j,
          x: 0,
          y: 0,
          width: 1,
          height: 1
        });
        let rect1 = svg_SVG.create("rect", {
          x: 0,
          y: 0,
          width: settings.box / 2,
          height: settings.box,
          fill: settings.colors[i]
        });
        let rect2 = svg_SVG.create("rect", {
          x: settings.box / 2,
          y: 0,
          width: settings.box / 2,
          height: settings.box,
          fill: settings.colors[j]
        });
        pattern.appendChild(rect1);
        pattern.appendChild(rect2);
        svgDefs.appendChild(pattern);
      }
    }

    return svgDefs;
  }

  _isOrphan(member) {
    return (member.father === undefined || member.father === null) && (member.mother === undefined || member.mother.id === null);
  }

  getDefaultSetting() {
    return {
      width: 400,
      height: 240,
      box: 40,
      colors: ["black", "red", "blue"]
    };
  }

  parseFamilyToPedigree(family) {
    let newMembers = family.members.map(member => {
      let newMember = {};
      newMember.name = member.name;

      if (typeof member.disorders !== "undefined" && member.disorders.length > 0) {
        newMember.disorders = member.disorders.map(disease => {
          return disease.id;
        });
      }

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(member.father) && utilsNew_UtilsNew.isUndefinedOrNull(member.father.id)) {
        newMember.father = member.father;
      }

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(member.mother) && utilsNew_UtilsNew.isUndefinedOrNull(member.mother.id)) {
        newMember.mother = member.mother;
      }

      newMember.sex = member.sex;
      newMember.lifeStatus = member.lifeStatus;
      newMember.parentalConsanguinity = member.parentalConsanguinity;
      return newMember;
    });
    let pedigreFromFamily = {
      name: family.name,
      disorders: family.disorders,
      members: newMembers
    };
    this.pedigree = pedigreFromFamily;
  }

  pedigreeFromFamily(family, settings = null) {
    this.parseFamilyToPedigree(family);
    return this.render(settings);
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/opencga-date-filter.js
function opencga_date_filter_templateObject13() {
  const data = opencga_date_filter_taggedTemplateLiteral(["\n                                                <option value=\"", "\">", "</option>\n                                            "]);

  opencga_date_filter_templateObject13 = function _templateObject13() {
    return data;
  };

  return data;
}

function opencga_date_filter_templateObject12() {
  const data = opencga_date_filter_taggedTemplateLiteral(["\n                                                <option value=\"", "\">", "</option>\n                                            "]);

  opencga_date_filter_templateObject12 = function _templateObject12() {
    return data;
  };

  return data;
}

function opencga_date_filter_templateObject11() {
  const data = opencga_date_filter_taggedTemplateLiteral(["\n                                                <option value=\"", "\">", "</option>\n                                            "]);

  opencga_date_filter_templateObject11 = function _templateObject11() {
    return data;
  };

  return data;
}

function opencga_date_filter_templateObject10() {
  const data = opencga_date_filter_taggedTemplateLiteral(["\n                                                <option value=\"", "\">", "</option>\n                                            "]);

  opencga_date_filter_templateObject10 = function _templateObject10() {
    return data;
  };

  return data;
}

function opencga_date_filter_templateObject9() {
  const data = opencga_date_filter_taggedTemplateLiteral(["\n                                                <option value=\"", "\">", "</option>\n                                            "]);

  opencga_date_filter_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function opencga_date_filter_templateObject8() {
  const data = opencga_date_filter_taggedTemplateLiteral(["\n                                                <option value=\"", "\">", "</option>\n                                            "]);

  opencga_date_filter_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_date_filter_templateObject7() {
  const data = opencga_date_filter_taggedTemplateLiteral(["\n                        <div>\n                            <div class=\"range-box\">\n                                <label class=\"", "-text\">Begin periode</label>\n                                <form class=\"form-inline\">\n                                    <div class=\"\">\n                                        <select class=\"bootstrap-select form-control ", "-codeDis col-md-4\"\n                                                id=\"", "YearSelectFrom\" name=\"birthYear\" required @change=\"", "\">\n                                             ", "\n                                        </select>\n            \n                                        <label>-</label>\n                                        <select class=\"bootstrap-select form-control ", "-codeDis col-md-4\"\n                                                id=\"", "MonthSelectFrom\" name=\"birthYear\" required @change=\"", "\">\n                                            <option value=\"any\">Any</option>\n                                             ", "\n                                        </select>\n            \n                                        <label>-</label>\n                                        <select class=\"bootstrap-select form-control ", "-codeDis col-md-4\"\n                                                id=\"", "DaySelectFrom\" name=\"birthYear\" required @change=\"", "\" data-size=\"10\">\n                                            <option value=\"any\">Any</option>\n                                             ", "\n                                        </select>\n                                    </div>\n                                </form>\n                            </div>\n                            <div class=\"range-box\">\n                                <label class=\"", "-text\">End periode</label>\n                                <form class=\"form-inline\">\n                                    <div class=\"\">\n                                        <select class=\"bootstrap-select form-control ", "-codeDis col-md-4\"\n                                                id=\"", "YearSelectTo\" name=\"birthYear\" required @change=\"", "\">\n                                             ", "\n                                        </select>\n            \n                                        <label>-</label>\n                                        <select class=\"bootstrap-select form-control ", "-codeDis col-md-4\"\n                                                id=\"", "MonthSelectTo\" name=\"birthYear\" required @change=\"", "\">\n                                            <option value=\"any\">Any</option>\n                                             ", "\n                                        </select>\n            \n                                        <label>-</label>\n                                        <select class=\"bootstrap-select form-control ", "-codeDis col-md-4\"\n                                                id=\"", "DaySelectTo\" name=\"birthYear\" required @change=\"", "\" data-size=\"10\">\n                                            <option value=\"any\">Any</option>\n                                             ", "\n                                        </select>\n                                    </div>\n                                </form>\n                            </div>\n                        </div>"]);

  opencga_date_filter_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_date_filter_templateObject6() {
  const data = opencga_date_filter_taggedTemplateLiteral(["\n                                            <option value=\"", "\">", "</option>\n                                        "]);

  opencga_date_filter_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_date_filter_templateObject5() {
  const data = opencga_date_filter_taggedTemplateLiteral(["\n                                            <option value=\"", "\">", "</option>\n                                        "]);

  opencga_date_filter_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_date_filter_templateObject4() {
  const data = opencga_date_filter_taggedTemplateLiteral(["\n                                            <option value=\"", "\">", "</option>\n                                        "]);

  opencga_date_filter_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_date_filter_templateObject3() {
  const data = opencga_date_filter_taggedTemplateLiteral(["\n                        <div>\n                            <form class=\"form-inline\">\n                                <div class=\"\">\n                                    <select class=\"bootstrap-select form-control ", "-codeDis col-md-4\"\n                                            id=\"", "YearSelect\" name=\"birthYear\" required @change=\"", "\">\n                                        ", "\n                                    </select>\n        \n                                    <label>-</label>\n                                    <select class=\"bootstrap-select form-control ", "-codeDis col-md-4\"\n                                            id=\"", "MonthSelect\" name=\"birthYear\" required @change=\"", "\">\n                                        <option value=\"any\">Any</option>\n                                        ", "\n                                    </select>\n        \n                                    <label>-</label>\n                                    <select class=\"bootstrap-select form-control ", "-codeDis col-md-4\"\n                                            id=\"", "DaySelect\" name=\"birthYear\" required @change=\"", "\" data-size=\"10\">\n                                        <option value=\"any\">Any</option>\n                                        ", "\n                                    </select>\n                                </div>\n                            </form>\n                        </div>\n                    "]);

  opencga_date_filter_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_date_filter_templateObject2() {
  const data = opencga_date_filter_taggedTemplateLiteral(["\n                        <div>\n                            <form class=\"form-inline text-center\">\n                                <div class=\"\">\n                                    <span class=\"", "-text\">Last</span>\n                                    <select class=\"form-control bootstrap-select ", "-codeDis\"\n                                            id=\"", "RecentSelect\" name=\"birthYear\" required @change=\"", "\" data-size=\"10\">\n                                        <option value=\"1\" ?selected=\"", "\">1</option>\n                                        <option value=\"2\" ?selected=\"", "\">2</option>\n                                        <option value=\"3\" ?selected=\"", "\">3</option>\n                                        <option value=\"4\" ?selected=\"", "\">4</option>\n                                        <option value=\"5\" ?selected=\"", "\">5</option>\n                                        <option value=\"6\" ?selected=\"", "\">6</option>\n                                        <option value=\"7\" ?selected=\"", "\">7</option>\n                                        <option value=\"8\" ?selected=\"", "\">8</option>\n                                        <option value=\"9\" ?selected=\"", "\">9</option>\n                                        <option value=\"10\" ?selected=\"", "\">10</option>\n                                        <option value=\"11\" ?selected=\"", "\">11</option>\n                                        <option value=\"12\" ?selected=\"", "\">12</option>\n                                        <option value=\"13\" ?selected=\"", "\">13</option>\n                                        <option value=\"14\" ?selected=\"", "\">14</option>\n                                        <option value=\"15\" ?selected=\"", "\">15</option>\n                                        <option value=\"16\" ?selected=\"", "\">16</option>\n                                        <option value=\"17\" ?selected=\"", "\">17</option>\n                                        <option value=\"18\" ?selected=\"", "\">18</option>\n                                        <option value=\"19\" ?selected=\"", "\">19</option>\n                                        <option value=\"20\" ?selected=\"", "\">20</option>\n                                        <option value=\"21\" ?selected=\"", "\">21</option>\n                                        <option value=\"22\" ?selected=\"", "\">22</option>\n                                        <option value=\"23\" ?selected=\"", "\">23</option>\n                                        <option value=\"24\" ?selected=\"", "\">24</option>\n                                        <option value=\"25\" ?selected=\"", "\">25</option>\n                                        <option value=\"26\" ?selected=\"", "\">26</option>\n                                        <option value=\"27\" ?selected=\"", "\">27</option>\n                                        <option value=\"28\" ?selected=\"", "\">28</option>\n                                        <option value=\"29\" ?selected=\"", "\">29</option>\n                                        <option value=\"30\" ?selected=\"", "\">30</option>\n                                    </select>\n                                    <span class=\"", "-text\"> day(s)</span>\n                                </div>\n                            </form>\n                        </div>\n                    "]);

  opencga_date_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_date_filter_templateObject() {
  const data = opencga_date_filter_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .range-box:nth-child(2) {\n                margin-top: 20px;\n            }\n        </style>\n\n        <div class=\"form-group\">\n            <form id=\"", "DateRadioButton\">\n            <fieldset>\n                <div class=\"switch-toggle text-white alert alert-light\">\n                    <input type=\"radio\" name=\"selectionButtons\" id=\"allRadio\" value=\"all\" class=\"", "FilterRadio\" checked @change=\"", "\">\n                    <label for=\"allRadio\" ><span class=\"", "-text\">All</span></label>\n                \n                    <input type=\"radio\" name=\"selectionButtons\" id=\"recentlyRadio\" value=\"recently\" class=\"", "FilterRadio\" @change=\"", "\">\n                    <label for=\"recentlyRadio\" ><span class=\"", "-text\">Recent</span></label>\n                \n                    <input type=\"radio\" name=\"selectionButtons\" id=\"dateRadio\" value=\"date\" class=\"", "FilterRadio\" @change=\"", "\">\n                    <label for=\"dateRadio\" ><span class=\"", "-text\">Date</span></label>\n                \n                    <input type=\"radio\" name=\"selectionButtons\" id=\"rangesRadio\" value=\"range\" class=\"", "FilterRadio\" @change=\"", "\">\n                    <label for=\"rangesRadio\" ><span class=\"", "-text\">Range</span></label>\n                    \n                    \n                    <a class=\"btn btn-primary ripple btn-small\"></a>\n                </div>\n            </fieldset>            \n            \n                <div class=\"date-option-wrapper\">\n                    ", "\n                    \n                   \n    \n                    ", "\n    \n                    \n                    ", "\n                    </div>\n            </form>\n        </div>"]);

  opencga_date_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_date_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_date_filter_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_date_filter_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_date_filter_ownKeys(Object(source), true).forEach(function (key) { opencga_date_filter_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_date_filter_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_date_filter_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



 //TODO refactor needed both in UI and code (UI done)
//FIXME ::critical:: changes from active-filter are not handled at the moment

class opencga_date_filter_OpencgaDateFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "odf-" + utils.randomString(6) + "_";
    this._config = this.getDefaultConfig();
    this.activatedRanges = false;
    this.activatedDate = false;
    this.activatedRecent = false;
  }

  updated(changedProperties) {
    if (changedProperties.has("config")) {
      this.configObserver();
    }
  }

  configObserver() {
    this._config = opencga_date_filter_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  firstUpdated(_changedProperties) {
    const _years = [];
    const fullDate = new Date();
    const limitYear = fullDate.getFullYear();

    for (let year = this._config.minYear; year <= limitYear; year++) {
      _years.push(year);
    } // This change triggers the polymer dom-repeat


    this.years = _years; // Init arrays for Date selector

    const _yearsToSearch = [];

    for (let year = limitYear, i = 0; i < 5; year--, i++) {
      _yearsToSearch.push(year);
    }

    this.yearsToSearch = _yearsToSearch;
    this.monthToSearch = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
    const _days = [];

    for (let i = 1; i <= 31; i++) {
      _days.push(i);
    }

    this.daysToSearch = _days;

    if (utilsNew_UtilsNew.isNotEmpty(this._config.inputClass)) {
      $(".".concat(this._prefix, "-codeDis"), this).addClass(this._config.inputClass);
      $(".".concat(this._prefix, "-text"), this).addClass(this._config.class);
    }
  }

  async calculateFilters(e) {
    console.log("calculateFilters", e);
    const dateOption = $("#".concat(this._prefix, "DateRadioButton input[type='radio']:checked")).val();
    console.log("dateOption", dateOption); //console.log("DATE OPT", $(`#${this._prefix}DateRadioButton input[type='radio']:checked`).val())
    //const dateOption = e.target.value;

    let date = "";

    switch (dateOption) {
      case "recently":
        this.activatedRanges = false;
        this.activatedDate = false;
        this.activatedRecent = true;
        await this.requestUpdate(); // Last x days

        const da = new Date();
        da.setDate(da.getDate() - this.querySelector("#".concat(this._prefix, "RecentSelect")).value); // If the month and day have one digit we add 0 before

        let m = da.getMonth() + 1;

        if (m < 10) {
          m = "0" + m;
        }

        let d = da.getDate();

        if (d < 10) {
          d = "0" + d;
        }

        date = ">=".concat(da.getFullYear()).concat(m).concat(d);
        break;

      case "date":
        this.activatedRanges = false;
        this.activatedDate = true;
        this.activatedRecent = false;
        await this.requestUpdate();
        date = this._getDateFilter();
        break;

      case "range":
        this.activatedRanges = true;
        this.activatedDate = false;
        this.activatedRecent = false;
        await this.requestUpdate();
        date = this._getRangeFilter();
        break;

      case "all":
      default:
        this.activatedRanges = false;
        this.activatedDate = false;
        this.activatedRecent = false;
        await this.requestUpdate();
        break;
    }

    $(".bootstrap-select", this).selectpicker();
    this.dispatchEvent(new CustomEvent("filterChange", {
      detail: {
        value: date
      }
    }));
  }

  _getDateFilter() {
    const year = PolymerUtils_PolymerUtils.getElementById(this._prefix + "YearSelect").value;
    let month = PolymerUtils_PolymerUtils.getElementById(this._prefix + "MonthSelect").value;
    let day = PolymerUtils_PolymerUtils.getElementById(this._prefix + "DaySelect").value;

    if (month === "any") {
      month = "";
      day = "";
    } else {
      const monthIndex = this.monthToSearch.indexOf(month) + 1;
      month = monthIndex < 10 ? "0".concat(monthIndex) : monthIndex; // TODO use padStart

      if (day === "any") {
        day = "";
      } else if (day < 10) {
        day = "0".concat(day);
      }
    }

    return "".concat(year).concat(month).concat(day);
  }

  _getRangeFilter() {
    const from = this._getFromDate();

    const to = this._getToDate();

    if (to > from) {
      return "".concat(from, "-").concat(to);
    }

    return "";
  }

  _getFromDate() {
    const year = PolymerUtils_PolymerUtils.getElementById(this._prefix + "YearSelectFrom").value;
    let month = PolymerUtils_PolymerUtils.getElementById(this._prefix + "MonthSelectFrom").value;
    let day = PolymerUtils_PolymerUtils.getElementById(this._prefix + "DaySelectFrom").value;

    if (month === "any") {
      month = "01";
    } else {
      const monthIndex = this.monthToSearch.indexOf(month) + 1;
      month = monthIndex < 10 ? "0".concat(monthIndex) : monthIndex;
    }

    if (day === "any") {
      day = "01";
    } else if (day < 10) {
      day = "0".concat(day);
    }

    return "".concat(year).concat(month).concat(day);
  }

  _getToDate() {
    const year = PolymerUtils_PolymerUtils.getElementById(this._prefix + "YearSelectTo").value;
    let month = PolymerUtils_PolymerUtils.getElementById(this._prefix + "MonthSelectTo").value;
    let day = PolymerUtils_PolymerUtils.getElementById(this._prefix + "DaySelectTo").value;

    if (month === "any") {
      month = "12";
    } else {
      const monthIndex = this.monthToSearch.indexOf(month) + 1;
      month = monthIndex < 10 ? "0".concat(monthIndex) : monthIndex;
    }

    if (day === "any") {
      day = ["01", "03", "05", "07", "08", "10", "12"].indexOf(month) !== -1 ? "31" : month === "02" ? "28" : "30";
    } else if (day < 10) {
      day = "0".concat(day);
    }

    return "".concat(year).concat(month).concat(day); //     let monthIndex = this.monthToSearch.indexOf(month) + 1;
    //     if (monthIndex < 10) {
    //         monthIndex = "0" + monthIndex;
    //     }
    //     if (day === "any") {
    //         date = "~^" + year + monthIndex + "*";
    //     } else {
    //         if (day < 10) {
    //             day = "0" + day;
    //         }
    //         date = "~^" + year + monthIndex + day + "*";
    //     }
    // }
    // return date;
  }

  checkYears(e) {
    e.preventDefault(); // prevents the hash change to "#" and allows to manipulate the hash fragment as needed

    PolymerUtils_PolymerUtils.innerHTML(this._prefix + "_errorDiv_birthYear", "");
    PolymerUtils_PolymerUtils.innerHTML(this._prefix + "_errorDiv_testYear", "");
    let currentElement = PolymerUtils_PolymerUtils.getElementById(e.target.id);
    const identifier = e.target.id;
    let pairElement = "";
    let divSuffix = "";
    let message = "";

    if (identifier.search("birthYear") !== -1) {
      // Birth year element raises the event -> check Test year
      pairElement = PolymerUtils_PolymerUtils.getElementById(this._prefix + "testYear");
      divSuffix = "birthYear";
      message = "Year of Birth must be prior to year of Test";
    } else {
      // Year of test element raises the event -> swap elements and check the birth year
      currentElement = PolymerUtils_PolymerUtils.getElementById(this._prefix + "birthYear");
      pairElement = PolymerUtils_PolymerUtils.getElementById(e.target.id);
      divSuffix = "testYear";
      message = "Year of Test must be posterior to year of Birth";
    }

    if (PolymerUtils_PolymerUtils.querySelectorAll("option:selected", pairElement) !== "" && parseInt(PolymerUtils_PolymerUtils.querySelectorAll("option:selected", currentElement).textContent) > parseInt(PolymerUtils_PolymerUtils.querySelectorAll("option:selected", pairElement).textContent)) {
      // Year of birth cannot be lower than Year of test
      PolymerUtils_PolymerUtils.innerHTML(this._prefix + "_errorDiv_" + divSuffix, message);
    }
  }

  matchesRecentDaysConfig(day) {
    // Because the config might not have changed yet...
    this.configObserver();
    return day === this._config.recentDays;
  }
  /**
   * Use custom CSS class to easily reset all controls.
   */


  _clearHtmlDom() {
    // Input controls
    PolymerUtils_PolymerUtils.setPropertyByClassName(this._prefix + "FilterTextInput", "value", "");
    PolymerUtils_PolymerUtils.removeAttributebyclass(this._prefix + "FilterTextInput", "disabled"); // Uncheck checkboxes

    PolymerUtils_PolymerUtils.setPropertyByClassName(this._prefix + "FilterCheckBox", "checked", false); // Set first option and make it active

    PolymerUtils_PolymerUtils.setAttributeByClassName(this._prefix + "FilterSelect", "selectedIndex", 0);
    PolymerUtils_PolymerUtils.removeAttributebyclass(this._prefix + "FilterSelect", "disabled");
    PolymerUtils_PolymerUtils.setPropertyByClassName(this._prefix + "FilterRadio", "checked", false);
    PolymerUtils_PolymerUtils.setAttributeByClassName(this._prefix + "FilterRadio", "disabled", true);
    $("." + this._prefix + "FilterRadio").filter("[value=\"or\"]").prop("checked", true);
  }

  getDefaultConfig() {
    return {
      minYear: 1920,
      recentDays: 7,
      inputClass: "input-sm",
      class: "small"
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_date_filter_templateObject(), this._prefix, this._prefix, this.calculateFilters, this._prefix, this._prefix, this.calculateFilters, this._prefix, this._prefix, this.calculateFilters, this._prefix, this._prefix, this.calculateFilters, this._prefix, this.activatedRecent ? lit_html_lit_html_html(opencga_date_filter_templateObject2(), this._prefix, this._prefix, this._prefix, this.calculateFilters, this.matchesRecentDaysConfig(1), this.matchesRecentDaysConfig(2), this.matchesRecentDaysConfig(3), this.matchesRecentDaysConfig(4), this.matchesRecentDaysConfig(5), this.matchesRecentDaysConfig(6), this.matchesRecentDaysConfig(7), this.matchesRecentDaysConfig(8), this.matchesRecentDaysConfig(9), this.matchesRecentDaysConfig(10), this.matchesRecentDaysConfig(11), this.matchesRecentDaysConfig(12), this.matchesRecentDaysConfig(13), this.matchesRecentDaysConfig(14), this.matchesRecentDaysConfig(15), this.matchesRecentDaysConfig(16), this.matchesRecentDaysConfig(17), this.matchesRecentDaysConfig(18), this.matchesRecentDaysConfig(19), this.matchesRecentDaysConfig(20), this.matchesRecentDaysConfig(21), this.matchesRecentDaysConfig(22), this.matchesRecentDaysConfig(23), this.matchesRecentDaysConfig(24), this.matchesRecentDaysConfig(25), this.matchesRecentDaysConfig(26), this.matchesRecentDaysConfig(27), this.matchesRecentDaysConfig(28), this.matchesRecentDaysConfig(29), this.matchesRecentDaysConfig(30), this._prefix) : null, this.activatedDate ? lit_html_lit_html_html(opencga_date_filter_templateObject3(), this._prefix, this._prefix, this.calculateFilters, this.yearsToSearch.length && this.yearsToSearch.map(item => lit_html_lit_html_html(opencga_date_filter_templateObject4(), item, item)), this._prefix, this._prefix, this.calculateFilters, this.monthToSearch.length && this.monthToSearch.map(item => lit_html_lit_html_html(opencga_date_filter_templateObject5(), item, item)), this._prefix, this._prefix, this.calculateFilters, this.daysToSearch.length && this.daysToSearch.map(item => lit_html_lit_html_html(opencga_date_filter_templateObject6(), item, item))) : null, this.activatedRanges ? lit_html_lit_html_html(opencga_date_filter_templateObject7(), this._prefix, this._prefix, this._prefix, this.calculateFilters, this.yearsToSearch.length && this.yearsToSearch.map(item => lit_html_lit_html_html(opencga_date_filter_templateObject8(), item, item)), this._prefix, this._prefix, this.calculateFilters, this.monthToSearch.length && this.monthToSearch.map(item => lit_html_lit_html_html(opencga_date_filter_templateObject9(), item, item)), this._prefix, this._prefix, this.calculateFilters, this.daysToSearch.length && this.daysToSearch.map(item => lit_html_lit_html_html(opencga_date_filter_templateObject10(), item, item)), this._prefix, this._prefix, this._prefix, this.calculateFilters, this.yearsToSearch.length && this.yearsToSearch.map(item => lit_html_lit_html_html(opencga_date_filter_templateObject11(), item, item)), this._prefix, this._prefix, this.calculateFilters, this.monthToSearch.length && this.monthToSearch.map(item => lit_html_lit_html_html(opencga_date_filter_templateObject12(), item, item)), this._prefix, this._prefix, this.calculateFilters, this.daysToSearch.length && this.daysToSearch.map(item => lit_html_lit_html_html(opencga_date_filter_templateObject13(), item, item))) : null);
  }

}
customElements.define("opencga-date-filter", opencga_date_filter_OpencgaDateFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/clinical/opencga-clinical-analysis-filter.js
function opencga_clinical_analysis_filter_templateObject9() {
  const data = opencga_clinical_analysis_filter_taggedTemplateLiteral(["No filter has been configured."]);

  opencga_clinical_analysis_filter_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_filter_templateObject8() {
  const data = opencga_clinical_analysis_filter_taggedTemplateLiteral(["\n            <div class=\"search-button-wrapper\">\n                <button type=\"button\" class=\"btn btn-primary ripple\" @click=\"", "\">\n                    <i class=\"fa fa-search\" aria-hidden=\"true\"></i> Search\n                </button>\n            </div>\n            "]);

  opencga_clinical_analysis_filter_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_filter_templateObject7() {
  const data = opencga_clinical_analysis_filter_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n\n            span + span {\n                margin-left: 10px;\n            }\n\n            div.block {\n                overflow: hidden;\n            }\n\n            div.block label {\n                width: 80px;\n                display: block;\n                float: left;\n                text-align: left;\n                font-weight: normal;\n            }\n\n            select + select {\n                margin-left: 10px;\n            }\n\n            select + input {\n                margin-left: 10px;\n            }\n        </style>\n\n        ", "\n\n        <div class=\"panel-group\" id=\"", "Accordion\" role=\"tablist\" aria-multiselectable=\"true\">\n            <div class=\"\">\n                ", "\n            </div>\n        </div>\n        "]);

  opencga_clinical_analysis_filter_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_filter_templateObject6() {
  const data = opencga_clinical_analysis_filter_taggedTemplateLiteral(["\n                                <div class=\"tooltip-div pull-right\">\n                                    <a><i class=\"fa fa-info-circle\" aria-hidden=\"true\" id=\"", "", "Tooltip\"></i></a>\n                                </div>"]);

  opencga_clinical_analysis_filter_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_filter_templateObject5() {
  const data = opencga_clinical_analysis_filter_taggedTemplateLiteral(["\n                    <div class=\"form-group\">\n                        <div class=\"browser-subsection\" id=\"", "\">", "\n                            ", "\n                        </div>\n                        <div id=\"", "", "\" class=\"subsection-content\">\n                            ", "\n                         </div>\n                    </div>\n                "]);

  opencga_clinical_analysis_filter_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_filter_templateObject4() {
  const data = opencga_clinical_analysis_filter_taggedTemplateLiteral(["<opencga-date-filter .config=\"", "\" @filterChange=\"", "\"></opencga-date-filter>"]);

  opencga_clinical_analysis_filter_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_filter_templateObject3() {
  const data = opencga_clinical_analysis_filter_taggedTemplateLiteral(["<select-field-filter ?multiple=\"", "\" .data=\"", "\" .value=\"", "\" @filterChange=\"", "\"></select-field-filter>"]);

  opencga_clinical_analysis_filter_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_filter_templateObject2() {
  const data = opencga_clinical_analysis_filter_taggedTemplateLiteral(["<text-field-filter placeholder=\"", "\" .value=\"", "\" @filterChange=\"", "\"></text-field-filter>"]);

  opencga_clinical_analysis_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_filter_templateObject() {
  const data = opencga_clinical_analysis_filter_taggedTemplateLiteral(["<section-filter .config=\"", "\" .filters=\"", "\">"]);

  opencga_clinical_analysis_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_clinical_analysis_filter_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_clinical_analysis_filter_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_clinical_analysis_filter_ownKeys(Object(source), true).forEach(function (key) { opencga_clinical_analysis_filter_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_clinical_analysis_filter_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_clinical_analysis_filter_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */





class opencga_clinical_analysis_filter_OpencgaClinicalAnalysisFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      analyses: {
        type: Array
      },
      query: {
        type: Object
      },
      search: {
        type: Object
      },
      minYear: {
        type: Number
      },
      compact: {
        type: Boolean
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    // super.ready();
    this._prefix = "osf-" + utils.randomString(6) + "_";
    this.minYear = 1920;
    this.annotationFilterConfig = {
      class: "small",
      buttonClass: "btn-sm",
      inputClass: "input-sm"
    };
    this.dateFilterConfig = {
      recentDays: 10
    };
    this.query = {};
    this.preparedQuery = {};
  }

  connectedCallback() {
    super.connectedCallback();
  }

  updated(changedProperties) {
    if (changedProperties.has("query")) {
      this.queryObserver();
    }
  }

  onSearch() {
    // this.search = {...this.query};
    this.notifySearch(this.preparedQuery);
  }

  onDateChanged(e) {
    const query = {};
    Object.assign(query, this.query);

    if (utilsNew_UtilsNew.isNotEmpty(e.detail.date)) {
      query["creationDate"] = e.detail.date;
    } else {
      delete query["creationDate"];
    }

    this._reset = false; // this.set("query", query);

    this.query = query;
    this._reset = true;
  }

  queryObserver() {
    if (this._reset) {
      console.log("queryObserver: calling to 'renderQueryFilters()'", this.query);
      this.preparedQuery = this.query; // renderQueryFilters shouldn't be necessary anymore
      // this.renderQueryFilters();

      this.requestUpdate();
    } else {
      this._reset = true;
    }
  }
  /*    renderQueryFilters() {
      // Empty everything before rendering
      this._clearHtmlDom();
       // ClinicalAnalysis
      if (UtilsNew.isNotUndefined(this.query.id)) {
          PolymerUtils.setValue(`${this._prefix}-analysis-input`, this.query.id);
      }
       // Family
      if (UtilsNew.isNotUndefined(this.query.family)) {
          PolymerUtils.setValue(`${this._prefix}-family-input`, this.query.family);
      }
       // Proband
      if (UtilsNew.isNotUndefined(this.query.proband)) {
          PolymerUtils.setValue(`${this._prefix}-proband-input`, this.query.proband);
      }
       // Sample
      if (UtilsNew.isNotUndefined(this.query.sample)) {
          PolymerUtils.setValue(`${this._prefix}-sample-input`, this.query.sample);
      }
       // Priority
      if (UtilsNew.isNotUndefined(this.query.priority)) {
          $(`#${this._prefix}-analysis-priority-select`).selectpicker("val", this.query.priority.split(","));
      }
       // Type
      if (UtilsNew.isNotUndefined(this.query.type)) {
          $(`#${this._prefix}-analysis-type-select`).selectpicker("val", this.query.type.split(","));
      }
  }
   calculateFilters(e) {
      const _query = {};
       const name = PolymerUtils.getValue(`${this._prefix}-analysis-input`);
      if (UtilsNew.isNotEmpty(name)) {
          _query.id = name;
      }
       const family = PolymerUtils.getValue(`${this._prefix}-family-input`);
      if (UtilsNew.isNotEmpty(family)) {
          _query.family = family;
      }
       const proband = PolymerUtils.getValue(`${this._prefix}-proband-input`);
      if (UtilsNew.isNotEmpty(proband)) {
          _query.proband = proband;
      }
       const samples = PolymerUtils.getValue(`${this._prefix}-sample-input`);
      if (UtilsNew.isNotEmpty(samples)) {
          _query.sample = samples;
      }
       const priority = $(`#${this._prefix}-analysis-priority-select`).selectpicker("val");
      if (UtilsNew.isNotEmpty(priority)) {
          _query.priority = priority.join(",");
      }
       const type = $(`#${this._prefix}-analysis-type-select`).selectpicker("val");
      if (UtilsNew.isNotEmpty(type)) {
          _query.type = type.join(",");
      }
       // keep date filters
      if (UtilsNew.isNotEmpty(this.query.creationDate)) {
          _query.creationDate = this.query.creationDate;
      }
       // To prevent to call renderQueryFilters we set this to false
      this._reset = false;
      // this.set("query", _query);
      this.query = _query;
      this._reset = true;
  }*/


  onFilterChange(key, value) {
    console.log("filterChange", {
      [key]: value
    });

    if (value && value !== "") {
      this.preparedQuery = opencga_clinical_analysis_filter_objectSpread({}, this.preparedQuery, {}, {
        [key]: value
      });
    } else {
      console.log("deleting", key, "from preparedQuery");
      delete this.preparedQuery[key];
      this.preparedQuery = opencga_clinical_analysis_filter_objectSpread({}, this.preparedQuery);
    }

    this.notifyQuery(this.preparedQuery);
    this.requestUpdate();
  }

  notifyQuery(query) {
    this.dispatchEvent(new CustomEvent("queryChange", {
      detail: {
        query: query
      },
      bubbles: true,
      composed: true
    }));
  }

  notifySearch(query) {
    this.dispatchEvent(new CustomEvent("querySearch", {
      detail: {
        query: query
      },
      bubbles: true,
      composed: true
    }));
  }

  _createSection(section) {
    const htmlFields = section.fields && section.fields.length && section.fields.map(subsection => this._createSubSection(subsection));
    return this.config.sections.length > 1 ? lit_html_lit_html_html(opencga_clinical_analysis_filter_templateObject(), section, htmlFields) : htmlFields;
  }

  _createSubSection(subsection) {
    let content = "";

    switch (subsection.id) {
      case "id":
      case "family":
      case "proband":
      case "samples":
        content = lit_html_lit_html_html(opencga_clinical_analysis_filter_templateObject2(), subsection.placeholder, this.preparedQuery[subsection.id], e => this.onFilterChange(subsection.id, e.detail.value));
        break;

      case "priority":
      case "type":
        content = lit_html_lit_html_html(opencga_clinical_analysis_filter_templateObject3(), subsection.multiple, subsection.allowedValues, this.preparedQuery[subsection.id], e => this.onFilterChange(subsection.id, e.detail.value));
        break;

      case "date":
        content = lit_html_lit_html_html(opencga_clinical_analysis_filter_templateObject4(), this.dateFilterConfig, e => this.onFilterChange("creationDate", e.detail.value));
        break;

      default:
        console.error("Filter component not found");
    }

    return lit_html_lit_html_html(opencga_clinical_analysis_filter_templateObject5(), subsection.id, subsection.name, subsection.description ? lit_html_lit_html_html(opencga_clinical_analysis_filter_templateObject6(), this._prefix, subsection.id) : null, this._prefix, subsection.id, content);
  }
  /**
   * Use custom CSS class to easily reset all controls.
   */


  _clearHtmlDom() {
    // Input controls
    PolymerUtils_PolymerUtils.setPropertyByClassName(this._prefix + "FilterTextInput", "value", "");
    PolymerUtils_PolymerUtils.removeAttributebyclass(this._prefix + "FilterTextInput", "disabled");
    $("#".concat(this._prefix, "ClinicalAnalysisSelection .selectpicker")).selectpicker("val", "");
  }

  render() {
    return lit_html_lit_html_html(opencga_clinical_analysis_filter_templateObject7(), this.searchButton ? lit_html_lit_html_html(opencga_clinical_analysis_filter_templateObject8(), this.onSearch) : null, this._prefix, this.config.sections && this.config.sections.length ? this.config.sections.map(section => this._createSection(section)) : lit_html_lit_html_html(opencga_clinical_analysis_filter_templateObject9()));
  }

}
customElements.define("opencga-clinical-analysis-filter", opencga_clinical_analysis_filter_OpencgaClinicalAnalysisFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/clinical/opencga-clinical-analysis-browser.js
function opencga_clinical_analysis_browser_templateObject2() {
  const data = opencga_clinical_analysis_browser_taggedTemplateLiteral(["\n            <div class=\"page-title\">\n                <h2>\n                    <i class=\"fa fa-users\" aria-hidden=\"true\"></i> </i>&nbsp;", "\n                </h2>\n            </div>"]);

  opencga_clinical_analysis_browser_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_browser_templateObject() {
  const data = opencga_clinical_analysis_browser_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .icon-padding {\n                padding-left: 4px;\n                padding-right: 5px;\n            }\n\n            .detail-tab-title {\n                font-size: 115%;\n                font-weight: bold;\n            }\n        </style>\n\n        ", "\n            \n\n        <div class=\"row\" style=\"padding: 0px 10px\">\n            <div class=\"col-md-2\">\n                <opencga-clinical-analysis-filter   .opencgaSession=\"", "\"\n                                                    .config=\"", "\"\n                                                    .analyses=\"", "\"\n                                                    .search=\"", "\"\n                                                    .query=\"", "\"\n                                                    @queryChange=\"", "\"\n                                                    @querySearch=\"", "\">\n                </opencga-clinical-analysis-filter>\n            </div>\n\n            <div class=\"col-md-10\">\n                <opencga-active-filters .opencgaSession=\"", "\"\n                                        .query=\"", "\"\n                                        .refresh=\"", "\"\n                                        .defaultStudy=\"", "\"\n                                        .config=\"", "\"\n                                        .alias=\"", "\"\n                                        @activeFilterClear=\"", "\"\n                                        @activeFilterChange=\"", "\">\n                </opencga-active-filters>\n\n\n                <!-- Clinical Analysis View Buttons -->\n                <div class=\"col-md-12\" style=\"padding: 5px 0px 5px 0px\">\n                    <div class=\"btn-toolbar\" role=\"toolbar\" aria-label=\"...\" style=\"padding: 10px 0px;margin-left: 0px\">\n                        <div class=\"btn-group\" role=\"group\" style=\"margin-left: 0px\">\n                            <button type=\"button\" class=\"btn btn-success analysis-browser-view-buttons ripple active\" data-view=\"TableResult\" @click=\"", "\" data-id=\"table\">\n                                <i class=\"fa fa-table icon-padding\" aria-hidden=\"true\" data-view=\"TableResult\" @click=\"", "\" data-id=\"table\"></i> Table Result\n                            </button>\n                            <button type=\"button\" class=\"btn btn-success analysis-browser-view-buttons ripple\" data-view=\"Summary\" @click=\"", "\">\n                                <i class=\"fas fa-chart-bar icon-padding\" aria-hidden=\"true\" data-view=\"Summary\" @click=\"", "\"></i> Summary Stats\n                            </button>\n                            <!--<button type=\"button\" class=\"btn btn-success analysis-browser-view-buttons\" data-view=\"FamilyComparator\" on-click=\"_changeView\" data-id=\"comparator\">-->\n                                <!--<i class=\"fa fa-users icon-padding\" aria-hidden=\"true\" data-view=\"FamilyComparator\" on-click=\"_changeView\" data-id=\"comparator\"></i> Family Comparator-->\n                            <!--</button>-->\n                        </div>\n                    </div>\n                </div>\n\n                <div>\n                    <div id=\"", "TableResult\" class=\"clinical-analysis-browser-view-content\">\n                        <opencga-clinical-analysis-grid .opencgaSession=\"", "\"\n                                                        .config=\"", "\"\n                                                        .analyses=\"", "\"\n                                                        .query=\"", "\"\n                                                        .search=\"", "\"\n                                                        style=\"font-size: 12px\"\n                                                        .active=\"", "\"\n                                                        @selectanalysis=\"", "\">\n                        </opencga-clinical-analysis-grid>\n\n                        <div style=\"padding-top: 5px\">\n                            <ul id=\"", "ViewTabs\" class=\"nav nav-tabs\" role=\"tablist\">\n                                <li role=\"presentation\" class=\"active\">\n                                    <a href=\"#", "SampleViewer\" role=\"tab\" data-toggle=\"tab\" class=\"detail-tab-title\">\n                                        Clinical Analysis Info\n                                    </a>\n                                </li>\n                            </ul>\n\n                            <div class=\"tab-content\" style=\"height: 680px\">\n                                <div role=\"tabpanel\" class=\"tab-pane active\" id=\"", "SampleViewer\">\n                                    <clinical-analysis-view .opencgaSession=\"", "\"\n                                                            .opencgaClient=\"", "\"\n                                                            .clinicalAnalysisId=\"", "\"\n                                                            .config=\"", "\"\n                                                            style=\"font-size: 12px;\">\n                                    </clinical-analysis-view>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div id=\"", "Summary\" class=\"clinical-analysis-browser-view-content\" style=\"display: none\">\n                        Work in progress\n                        <!--<opencga-facet-view opencga-session=\"{{opencgaSession}}\" entity=\"FAMILY\"-->\n                                            <!--variable-sets=\"[[variableSets]]\"></opencga-facet-view>-->\n                    </div>\n                </div>\n            </div>\n        </div>\n        "]);

  opencga_clinical_analysis_browser_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_browser_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_clinical_analysis_browser_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_clinical_analysis_browser_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_clinical_analysis_browser_ownKeys(Object(source), true).forEach(function (key) { opencga_clinical_analysis_browser_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_clinical_analysis_browser_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_clinical_analysis_browser_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */






class opencga_clinical_analysis_browser_OpencgaClinicalAnalysisBrowser extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      search: {
        type: Object,
        notify: true // todo check notify

      },
      query: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ocab-" + utils.randomString(6) + "_";
    this.analyses = [];
    this._config = this.getDefaultConfig();
    this.activeMenu = {
      table: true
    }; //it is defined in opencga-clinical-analysis-grid, it must be initialized here because clinical-analysis-view have it as prop

    this.analysis = {};
    this.query = {};
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaClient")) {//this.renderAnalysisTable();
    }

    if (changedProperties.has("config")) {
      this.configObserver();
    }

    if (changedProperties.has("query")) {
      this.queryObserver();
    }
  }

  firstUpdated(_changedProperties) {}

  configObserver() {
    this._config = Object.assign(this.getDefaultConfig(), this.config);
  }

  queryObserver() {
    if (this.query) {
      this.preparedQuery = opencga_clinical_analysis_browser_objectSpread({}, this.query);
      this.executedQuery = opencga_clinical_analysis_browser_objectSpread({}, this.query);
    }

    this.requestUpdate();
  }

  analysisObserver() {
    this.dispatchEvent(new CustomEvent("analysischange", {
      detail: {
        analyses: this.analyses
      },
      bubbles: true,
      composed: true
    }));
  }

  onClear() {
    this._config = Object.assign(this.getDefaultConfig(), this.config);
    this.query = {}; // this.query = {studies: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias};

    this.search = {};
  }

  onSelectClinicalAnalysis(e) {
    this.analysis = e.detail.analysis;
  }

  _changeBottomTab(e) {
    const _activeTabs = {
      info: e.currentTarget.dataset.id === "info" // familyGrid: e.currentTarget.dataset.id === "familyGrid"

    };
    this.detailActiveTabs = _activeTabs;
  }

  _changeView(e) {
    e.preventDefault(); // prevents the hash change to "#" and allows to manipulate the hash fragment as needed

    const activeMenu = {
      table: e.currentTarget.dataset.id === "table" // comparator: e.currentTarget.dataset.id === "comparator"

    };
    this.activeMenu = activeMenu;
    $(".clinical-analysis-browser-view-content").hide(); // hides all content divs

    if (typeof e.target !== "undefined" && typeof e.target.dataset.view !== "undefined") {
      PolymerUtils_PolymerUtils.show(this._prefix + e.target.dataset.view);
    } // Show the active button


    $(".analysis-browser-view-buttons").removeClass("active");
    $(e.target).addClass("active");

    if (e.target.dataset.view === "Summary") {
      this.SummaryActive = true;
      this.requestUpdate();
    } else {
      this.SummaryActive = false;
    }
  }

  onQueryFilterChange(e) {
    console.log("onQueryFilterChange on sample browser", e.detail.query);
    this.preparedQuery = e.detail.query;
    this.requestUpdate();
  }

  onQueryFilterSearch(e) {
    this.preparedQuery = e.detail.query;
    this.executedQuery = e.detail.query;
    this.requestUpdate();
  } //TODO recheck if there is a default param


  onActiveFilterChange(e) {
    console.log("onActiveFilterChange on clinical analysis browser", e.detail);
    this.preparedQuery = opencga_clinical_analysis_browser_objectSpread({}, e.detail);
    this.query = opencga_clinical_analysis_browser_objectSpread({}, e.detail);
    this.requestUpdate();
  }

  onActiveFilterClear() {
    this.query = {}; //this.search = {};

    this.preparedQuery = {};
    this.requestUpdate();
  }

  getDefaultConfig() {
    return {
      title: "Clinical Analysis Browser",
      showTitle: true,
      showAggregationStats: true,
      showComparator: true,
      filter: {},
      grid: {
        pageSize: 10,
        pageList: [10, 25, 50],
        detailView: false,
        multiSelection: false
      },
      gridComparator: {
        pageSize: 5,
        pageList: [5, 10],
        detailView: true,
        multiSelection: true
      },
      summary: {
        fields: ["name"]
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_clinical_analysis_browser_templateObject(), this._config.showTitle ? lit_html_lit_html_html(opencga_clinical_analysis_browser_templateObject2(), this._config.title) : null, this.opencgaSession, this._config.filter, this.analyses, this.search, this.query, this.onQueryFilterChange, this.onQueryFilterSearch, this.opencgaSession, this.preparedQuery, this.executedQuery, this.opencgaSession.study.alias, this.filtersConfig, this.activeFilterAlias, this.onActiveFilterClear, this.onActiveFilterChange, this._changeView, this._changeView, this._changeView, this._changeView, this._prefix, this.opencgaSession, this._config.grid, this.analyses, this.executedQuery, this.executedQuery, this.activeMenu.table, this.onSelectClinicalAnalysis, this._prefix, this._prefix, this._prefix, this.opencgaSession, this.opencgaSession.opencgaClient, this.analysis.id, this._config.sampleDetail, this._prefix);
  }

}
customElements.define("opencga-clinical-analysis-browser", opencga_clinical_analysis_browser_OpencgaClinicalAnalysisBrowser);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/clinical/opencga-clinical-analysis-view.js
function opencga_clinical_analysis_view_templateObject6() {
  const data = opencga_clinical_analysis_view_taggedTemplateLiteral(["\n                                                    <tr>\n                                                        <td>", "</td>\n                                                        <td>", "</td>\n                                                        <td>", "</td>\n                                                        <td>", "</td>\n                                                        <td>", "</td>\n                                                        <td>", "</td>\n                                                        <td>", "</td>\n                                                        <td>", "</td>\n                                                        <td>", "</td>\n                                                        <td>", "</td>\n                                                    </tr>\n                                                "]);

  opencga_clinical_analysis_view_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_view_templateObject5() {
  const data = opencga_clinical_analysis_view_taggedTemplateLiteral(["\n                        <form class=\"form-horizontal\" style=\"padding: 10px 0px 0px 0px;\">\n        \n                                <div class=\"form-group\" style=\"margin-bottom: 5px\">\n                                    <label class=\"control-label col-md-1 jso-label-title pad-top-5\">Family</label>\n                                    <div class=\"col-md-3 pad-top-5\">\n                                        <span>", "</span>\n                                    </div>\n                                </div>\n        \n                                <div class=\"form-group\" style=\"padding-left: 25px; margin-bottom: 5px\">\n                                    <!--<label class=\"col-md-12\">Members:</label>-->\n                                    <h4>Members</h4>\n                                    <div class=\"col-md-12\">\n                                        <div style=\"width: 90%;padding-left: 10px\">\n                                            <table class=\"table\">\n                                                <thead>\n                                                <tr class=\"table-header\">\n                                                    <th>Individual ID</th>\n                                                    <th>Sex</th>\n                                                    <th>Father</th>\n                                                    <th>Mother</th>\n                                                    <th>Disorders</th>\n                                                    <th>Phenotypes</th>\n                                                    <th>Life Status</th>\n                                                    <th>Year of Birth</th>\n                                                    <th>Creation Date</th>\n                                                    <th>Status</th>\n                                                </tr>\n                                                </thead>\n                                                <tbody>\n                                                ", "\n                                                </tbody>\n                                            </table>\n                                        </div>\n                                    </div>\n                                </div>\n        \n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-12\">Pedigree:</label>\n                                    <div class=\"col-md-11 col-md-offset-1\">\n                                        <div id=\"", "PedigreeView\"></div>\n                                    </div>\n                                </div>\n                            </form>\n                        "]);

  opencga_clinical_analysis_view_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_view_templateObject4() {
  const data = opencga_clinical_analysis_view_taggedTemplateLiteral(["\n                                <div class=\"form-group\" style=\"margin-bottom: 5px\">\n                                    <label class=\"control-label col-md-1 jso-label-title pad-top-5\">Disorder</label>\n                                    <div class=\"col-md-3 pad-top-5\">\n                                        <span>", " (", ")</span>\n                                    </div>\n                                </div>"]);

  opencga_clinical_analysis_view_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_view_templateObject3() {
  const data = opencga_clinical_analysis_view_taggedTemplateLiteral(["\n                <div class=\"container\">\n                    <div id=\"", "Summary\" class=\"col-md-12 section-padding\">\n                        <!--<h3><span style=\"color: #8a6d3b;\">{{clinicalAnalysis.id}}</span> - Analysis Summary</h3>-->\n                        <!--<hr class=\"hr-underline\">-->\n        \n                        <div>\n                            <h4 class=\"form-section-title\">Case Summary</h4>\n                        </div>\n        \n                        <form class=\"form-horizontal\" style=\"padding: 5px 10px\">\n        \n                            <div class=\"form-group\" style=\"margin-bottom: 5px\">\n                                <label class=\"control-label col-md-1 jso-label-title\">Analysis ID</label>\n                                <div class=\"col-md-3 pad-top-5\">\n                                    <span>", "</span>\n                                </div>\n                            </div>\n        \n                            <div class=\"form-group\" style=\"margin-bottom: 5px\">\n                                <label class=\"control-label col-md-1 jso-label-title pad-top-5\">Proband</label>\n                                <div class=\"col-md-3 pad-top-5\">\n                                    <span>", "</span>\n                                </div>\n                            </div>\n        \n                            ", "\n        \n                            <div class=\"form-group\" style=\"margin-bottom: 5px\">\n                                <label class=\"control-label col-md-1 jso-label-title pad-top-5\">Analysis Type</label>\n                                <div class=\"col-md-3 pad-top-5\">\n                                    <span>", "</span>\n                                </div>\n                            </div>\n        \n                            <div class=\"form-group\" style=\"margin-bottom: 5px\">\n                                <label class=\"control-label col-md-1 jso-label-title pad-top-5\">Flags</label>\n                                <div class=\"col-md-3 pad-top-5\">\n                                    <span>", "</span>\n                                </div>\n                            </div>\n        \n                            <div class=\"form-group\" style=\"margin-bottom: 5px\">\n                                <label class=\"control-label col-md-1 jso-label-title pad-top-5\">Status</label>\n                                <div class=\"col-md-3 pad-top-5\">\n                                    <span>", "</span>\n                                </div>\n                            </div>\n        \n                            <div class=\"form-group\" style=\"margin-bottom: 5px\">\n                                <label class=\"control-label col-md-1 jso-label-title pad-top-5\">Priority</label>\n                                <div class=\"col-md-3 pad-top-5\">\n                                    <span class=\"", "-priority\">", "</span>\n                                </div>\n                            </div>\n        \n                            <div class=\"form-group\" style=\"margin-bottom: 5px\">\n                                <label class=\"control-label col-md-1 jso-label-title pad-top-5\">Assigned To</label>\n                                <div class=\"col-md-3 pad-top-5\">\n                                    <span>", "</span>\n                                </div>\n                            </div>\n        \n                            <div class=\"form-group\" style=\"margin-bottom: 5px\">\n                                <label class=\"control-label col-md-1 jso-label-title pad-top-5\">Creation Date</label>\n                                <div class=\"col-md-3 pad-top-5\">\n                                    <span>", "</span>\n                                </div>\n                            </div>\n        \n                            <div class=\"form-group\" style=\"margin-bottom: 5px\">\n                                <label class=\"control-label col-md-1 jso-label-title pad-top-5\">Due Date</label>\n                                <div class=\"col-md-3 pad-top-5\">\n                                    <span>", "</span>\n                                </div>\n                            </div>\n        \n                            <div class=\"form-group\" style=\"margin-bottom: 5px\">\n                                <label class=\"control-label col-md-1 jso-label-title pad-top-5\">Description</label>\n                                <div class=\"col-md-3 pad-top-5\">\n                                    <span>", "</span>\n                                </div>\n                            </div>\n                        </form>\n                    </div>\n    \n                    <div id=\"", "Proband\" class=\"col-md-12 section-padding\">\n                        <div>\n                            <h4 class=\"form-section-title\">Proband</h4>\n                        </div>\n        \n                        <form class=\"form-horizontal\" style=\"padding: 10px 0px 0px 0px;\">\n                            <div class=\"form-group\" style=\"margin-bottom: 5px\">\n                                <label class=\"control-label col-md-1 jso-label-title pad-top-5\">Proband</label>\n                                <div class=\"col-md-3 pad-top-5\">\n                                    <span>", "</span>\n                                </div>\n                            </div>\n        \n                            <div class=\"form-group\" style=\"margin-bottom: 5px\">\n                                <label class=\"control-label col-md-1 jso-label-title pad-top-5\">Sex (karyotype)</label>\n                                <div class=\"col-md-3 pad-top-5\">\n                                    <span>", " &nbsp;&nbsp; (", ")</span>\n                                </div>\n                            </div>\n        \n                            <div class=\"form-group\" style=\"margin-bottom: 5px\">\n                                <label class=\"control-label col-md-1 jso-label-title pad-top-5\">Date of Birth</label>\n                                <div class=\"col-md-3 pad-top-5\">\n                                    <span>", " &nbsp;&nbsp; (", ")</span>\n                                </div>\n                            </div>\n        \n                            <div class=\"form-group\" style=\"margin-bottom: 5px\">\n                                <label class=\"control-label col-md-1 jso-label-title pad-top-5\">Disorders</label>\n                                <div class=\"col-md-3 pad-top-5\">\n                                    <span>", "</span>\n                                </div>\n                            </div>\n        \n                            <div class=\"form-group\" style=\"margin-bottom: 5px\">\n                                <label class=\"control-label col-md-1 jso-label-title pad-top-5\">Phenotypes</label>\n                                <div class=\"col-md-3 pad-top-5\">\n                                    <span>", "</span>\n                                </div>\n                            </div>\n        \n                            <div class=\"form-group\" style=\"padding-left: 25px; margin-bottom: 5px\">\n                                <!--<label class=\"col-md-12\">Sample:</label>-->\n                                <h4>Sample</h4>\n                                <!--<label class=\"control-label col-md-1 jso-label-title pad-top-5\">Sample</label>-->\n                                <div class=\"col-md-12\">\n                                    <div style=\"width: 90%;padding-left: 10px\">\n                                        <table class=\"table\">\n                                            <thead>\n                                            <tr class=\"table-header\">\n                                                <th>ID</th>\n                                                <th>Files</th>\n                                                <th>Collection Method</th>\n                                                <th>Preparation Method</th>\n                                                <th>Somatic</th>\n                                                <th>Creation Date</th>\n                                                <th>Status</th>\n                                            </tr>\n                                            </thead>\n                                            <tbody>\n                                            <tr>\n                                                <td>", "</td>\n                                                <!--<td>{{clinicalAnalysis.proband.samples.0.source}}</td>-->\n                                                <td>", "</td>\n                                                <td>", "</td>\n                                                <td>", "</td>\n                                                <td>", "</td>\n                                                <td>", "</td>\n                                                <td>", "</td>\n                                            </tr>\n                                            </tbody>\n                                        </table>\n                                    </div>\n                                </div>\n                            </div>\n                        </form>\n                    </div>\n    \n                    <div id=\"", "Family\" class=\"col-md-12 section-padding\">\n                        <div>\n                            <h4 class=\"form-section-title\">Family</h4>\n                        </div>\n        \n                        ", "\n                    </div>\n                </div>\n            </div>\n        </div>\n        "]);

  opencga_clinical_analysis_view_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_view_templateObject2() {
  const data = opencga_clinical_analysis_view_taggedTemplateLiteral(["\n                    <div style=\"margin: 10px\">\n                            <span>\n                                <!--<i id=\"", "SummaryCollapseIcon\" class=\"fa fa-minus-square-o\" aria-hidden=\"true\" on-click=\"_summaryOnClick\" style=\"cursor: pointer\"></i>-->\n                                <h4 style=\"display: inline\">&nbsp;", "</h4>\n                            </span>\n                    </div>\n                "]);

  opencga_clinical_analysis_view_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_view_templateObject() {
  const data = opencga_clinical_analysis_view_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .section-padding {\n                padding: 10px 25px 5px 25px;\n                /*padding-left: 25px;*/\n                /*padding-right: 25px;*/\n            }\n\n            .hr-underline {\n                margin: 1px 0px;\n                border-top: 2px solid #eee;\n            }\n\n            .URGENT-priority {\n                color: red;\n            }\n\n            .HIGH-priority {\n                color: orange;\n            }\n\n            .MEDIUM-priority {\n                color: blue;\n            }\n\n            .LOW-priority {\n                color: green;\n            }\n\n            .form-section-title {\n                padding: 5px 0px;\n                width: 80%;\n                border-bottom-width: 1px;\n                border-bottom-style: solid;\n                border-bottom-color: #ddd\n            }\n\n            .jso-label-title {\n                width: 15em !important;\n            }\n\n            .pad-top-5 {\n                padding-top: 5px !important;\n            }\n\n            /*.control-label2 {*/\n            /*padding-top: 5px;*/\n            /*margin-bottom: 0;*/\n            /*text-align: right;*/\n            /*}*/\n        </style>\n\n        <!--<template is=\"dom-if\" if=\"{{showSummary}}\">-->\n        <div class=\"container-fluid\">\n            <div class=\"row\">\n                ", "\n    \n                ", "\n\n        <!--<div id=\"", "Interperetations\" class=\"col-md-12 section-padding\">-->\n            <!--<div>-->\n                <!--<h3 class=\"form-section-title\">Interpretation Summary</h3>-->\n            <!--</div>-->\n            <!--<div>No interpretations found.</div>-->\n        <!--</div>-->\n        "]);

  opencga_clinical_analysis_view_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_view_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */






class opencga_clinical_analysis_view_OpencgaClinicalAnalysisView extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      clinicalAnalysis: {
        type: Object
      },
      clinicalAnalysisId: {
        type: String
      },
      // title: {
      //     type: String,
      //     value: "Clinical Analysis Summary"
      // },
      // showTitle: {
      //     type: Boolean
      // },
      // showSummary: {
      //     type: Boolean,
      //     value: true,
      //     notify: true
      // },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ocav-" + utils.randomString(6);
    this._config = this.getDefaultConfig();
  }

  updated(changedProperties) {
    if (changedProperties.has("clinicalAnalysisId")) {
      this.clinicalAnalysisIdObserver();
    }

    if (changedProperties.has("opencgaSession") || changedProperties.has("clinicalAnalysis") || changedProperties.has("mode") || changedProperties.has("config")) {
      this.propertyObserver(this.opencgaSession, this.clinicalAnalysis, this.config);
    }
  }

  firstUpdated(_changedProperties) {}

  propertyObserver(opencgaSession, clinicalAnalysis, config) {
    this._config = Object.assign(this.getDefaultConfig(), this.config);

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis)) {
      this._flags = utilsNew_UtilsNew.isNotEmptyArray(clinicalAnalysis.flags) ? clinicalAnalysis.flags.join(", ") : "-";
      this._assignee = utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.analyst) && utilsNew_UtilsNew.isNotEmpty(clinicalAnalysis.analyst.assignee) ? clinicalAnalysis.analyst.assignee : "-";
      this._description = utilsNew_UtilsNew.isNotEmpty(clinicalAnalysis.description) ? clinicalAnalysis.description : "-";
      this._dueDate = moment(clinicalAnalysis.dueDate, "YYYYMMDDHHmmss").format("D MMM YY");
      this._creationDate = moment(clinicalAnalysis.creationDate, "YYYYMMDDHHmmss").format("D MMM YY");
      this._probandDisorders = "-";

      if (utilsNew_UtilsNew.isNotEmptyArray(clinicalAnalysis.proband.disorders)) {
        const disorders = [];

        for (const disorder of clinicalAnalysis.proband.disorders) {
          disorders.push(disorder.name + " (" + disorder.id + ")");
        }

        this._probandDisorders = disorders.join(", ");
      }

      this._probandPhenotypes = "-";

      if (utilsNew_UtilsNew.isNotEmptyArray(clinicalAnalysis.proband.phenotypes)) {
        const phenotypes = [];

        for (const phenotype of clinicalAnalysis.proband.phenotypes) {
          phenotypes.push(phenotype.name + " (" + phenotype.id + ")");
        }

        this._probandPhenotypes = phenotypes.join(", ");
      }

      this._probandFiles = "-";

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.files) && utilsNew_UtilsNew.isNotEmptyArray(clinicalAnalysis.proband.samples)) {
        const files = [];
        const probandFiles = clinicalAnalysis.files[clinicalAnalysis.proband.samples[0].id];

        if (utilsNew_UtilsNew.isNotEmptyArray(probandFiles)) {
          for (const file of clinicalAnalysis.files[clinicalAnalysis.proband.samples[0].id]) {
            files.push(file.name);
          }
        }

        this._probandFiles = files.join(", ");
      }

      this._memberPhenotypes = [];

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.family) && utilsNew_UtilsNew.isNotEmptyArray(clinicalAnalysis.family.members)) {
        for (const member of clinicalAnalysis.family.members) {
          const phenotypes = [];

          for (const phenotype of member.phenotypes) {
            phenotypes.push(phenotype.name + " (" + phenotype.id + ")");
          }

          this._memberPhenotypes.push(phenotypes.join(", ")); // PolymerUtils.setValue(this._prefix + member.id + "Cell", "bbb");

        }
      }
    }

    this.pedigreeRender();
  }

  _summaryOnClick() {
    if (this._summaryCollapsed) {
      $("#" + this._prefix + "SummaryCollapseIcon").removeClass("fa-plus-square-o").addClass("fa-minus-square-o");
      PolymerUtils_PolymerUtils.show(this._prefix + "ClinicalAnalysisViewPanel");
      PolymerUtils_PolymerUtils.show(this._prefix + "OtherPrioritisationsPanel");
    } else {
      $("#" + this._prefix + "SummaryCollapseIcon").removeClass("fa-minus-square-o").addClass("fa-plus-square-o");
      PolymerUtils_PolymerUtils.hide(this._prefix + "ClinicalAnalysisViewPanel");
      PolymerUtils_PolymerUtils.hide(this._prefix + "OtherPrioritisationsPanel");
    }

    this._summaryCollapsed = !this._summaryCollapsed;
  }

  clinicalAnalysisIdObserver() {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysisId)) {
      const params = {
        study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias
      };

      const _this = this;

      this.opencgaSession.opencgaClient.clinical().info(this.clinicalAnalysisId, params).then(function (response) {
        _this.showSummary = false;

        if (response.response[0].numResults === 1) {
          console.log("aysnc response", response.response[0].numResults);
          _this.clinicalAnalysis = response.response[0].result[0];
          _this._dueDate = moment(_this.clinicalAnalysis.dueDate, "YYYYMMDDHHmmss").format("D MMM YY");
          _this._creationDate = moment(_this.clinicalAnalysis.creationDate, "YYYYMMDDHHmmss").format("D MMM YY");
          _this.showSummary = true; //                                _this.title =  "Clinical Analysis Summary: " + _this.clinicalAnalysis.name;

          _this.pedigreeRender();
        }
      });
    }
  }

  pedigreeRender() {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis.family)) {
      if (utilsNew_UtilsNew.isNotUndefined(this.svg) && PolymerUtils_PolymerUtils.getElementById(this._prefix + "PedigreeView").hasChildNodes()) {
        PolymerUtils_PolymerUtils.getElementById(this._prefix + "PedigreeView").removeChild(this.svg);
      }

      const family = Object.assign({}, this.clinicalAnalysis.family);
      const membersNew = [];

      if (utilsNew_UtilsNew.isNotEmpty(family.members)) {
        family.members.forEach(member => {
          const newMember = Object.assign({}, member);

          if (utilsNew_UtilsNew.isNotUndefinedOrNull(newMember.father)) {
            const newFather = family.members.find(member => {
              return member.id === newMember.father.id;
            });

            if (utilsNew_UtilsNew.isNotUndefinedOrNull(newFather)) {
              newMember.father = newFather.id;
            } else {
              newMember.father = undefined;
            }
          }

          if (utilsNew_UtilsNew.isNotUndefinedOrNull(newMember.mother)) {
            const newMother = family.members.find(member => {
              return member.id === newMember.mother.id;
            });

            if (utilsNew_UtilsNew.isNotUndefinedOrNull(newMother)) {
              newMember.mother = newMother.id;
            } else {
              newMember.mother = undefined;
            }
          }

          membersNew.push(newMember);
        });
        family.members = membersNew; // Render new Pedigree

        const querySelector = PolymerUtils_PolymerUtils.getElementById(this._prefix + "PedigreeView");
        const pedigree = new pedigree_Pedigree(family, {
          selectShowSampleNames: true
        });
        this.svg = pedigree.pedigreeFromFamily(pedigree.pedigree, {
          width: 640,
          height: 240
        });

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(querySelector)) {
          querySelector.appendChild(this.svg);
        }
      }

      this.requestUpdate();
    }
  }

  getDefaultConfig() {
    return {
      title: "Clinical Analysis View",
      showTitle: false
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_clinical_analysis_view_templateObject(), this._config.showTitle ? lit_html_lit_html_html(opencga_clinical_analysis_view_templateObject2(), this._prefix, this.title) : null, this.clinicalAnalysis ? lit_html_lit_html_html(opencga_clinical_analysis_view_templateObject3(), this._prefix, this.clinicalAnalysis.id, this.clinicalAnalysis.proband.id, this.clinicalAnalysis.disorder ? lit_html_lit_html_html(opencga_clinical_analysis_view_templateObject4(), this.clinicalAnalysis.disorder.name, this.clinicalAnalysis.disorder.id) : null, this.clinicalAnalysis.type, this._flags, this.clinicalAnalysis.status.name, this.clinicalAnalysis.priority, this.clinicalAnalysis.priority, this._assignee, this._creationDate, this._dueDate, this._description, this._prefix, this.clinicalAnalysis.proband.id, this.clinicalAnalysis.proband.sex, this.clinicalAnalysis.proband.karyotypicSex, this.clinicalAnalysis.proband.dateOfBirth, this.clinicalAnalysis.proband.lifeStatus, this._probandDisorders, this._probandPhenotypes, this.clinicalAnalysis.proband.samples[0].id, this._probandFiles, this.clinicalAnalysis.proband.samples[0].collection ? this.clinicalAnalysis.proband.samples[0].collection.method : "", this.clinicalAnalysis.proband.samples[0].processing ? this.clinicalAnalysis.proband.samples[0].processing.preparationMethod : "", this.clinicalAnalysis.proband.samples[0].somatic, this.clinicalAnalysis.proband.samples[0].creationDate, this.clinicalAnalysis.proband.samples[0].status.name, this._prefix, this.clinicalAnalysis.family.members ? lit_html_lit_html_html(opencga_clinical_analysis_view_templateObject5(), this.clinicalAnalysis.family.id, this.clinicalAnalysis.family && this.clinicalAnalysis.family.members ? this.clinicalAnalysis.family.members.map(member => lit_html_lit_html_html(opencga_clinical_analysis_view_templateObject6(), member.id, member.sex, member.father.id, member.mother.id, member.disorders && member.disorders.length ? member.disorders[0].name : null, member.phenotypes && member.phenotypes.length ? member.phenotypes[0].name : null, member.lifeStatus, member.dateOfBirth, member.creationDate, member.status.name)) : null, this._prefix) : null) : null, this._prefix);
  }

}
customElements.define("opencga-clinical-analysis-view", opencga_clinical_analysis_view_OpencgaClinicalAnalysisView);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/clinical/opencga-clinical-review-cases.js
function opencga_clinical_review_cases_templateObject7() {
  const data = opencga_clinical_review_cases_taggedTemplateLiteral(["\n                            <div style=\"padding-top: 20px\">\n                                <h3>Case Study: ", "</h3>\n                                <div style=\"padding-top: 20px\">\n                                    <ul id=\"", "ViewTabs\" class=\"nav nav-tabs\" role=\"tablist\">\n                                        <li role=\"presentation\" class=\"active\">\n                                            <a href=\"#", "Info\" role=\"tab\" data-toggle=\"tab\" class=\"browser-variant-tab-title\">Case Information</a>\n                                        </li>\n                                        <!--<li role=\"presentation\">-->\n                                            <!--<a href=\"#", "Proband\" role=\"tab\" data-toggle=\"tab\" class=\"browser-variant-tab-title\">Proband Info</a>-->\n                                        <!--</li>-->\n                                    </ul>\n    \n                                    <div class=\"tab-content\" style=\"height: 680px\">\n                                        <div id=\"", "Info\" role=\"tabpanel\" class=\"tab-pane active\">\n                                            <div style=\"padding: 10px 20px; width: 90%\">\n                                                <opencga-clinical-analysis-view .opencgaSession=\"", "\"\n                                                                                .clinicalAnalysis=", "\n                                                                                .opencgaClient=\"", "\"\n                                                                                .config=\"", "\"\n                                                                                style=\"font-size: 12px\">\n                                                </opencga-clinical-analysis-view>\n                                            </div>\n                                        </div>\n    \n                                        <!--<div id=\"", "Proband\" role=\"tabpanel\" class=\"tab-pane\">-->\n                                            <!--<div style=\"padding: 10px 20px; width: 90%\">-->\n                                                <!--<span>Work in progress</span>-->\n                                            <!--</div>-->\n                                        <!--</div>-->\n                                    </div>\n                                </div>\n                            </div>\n                        "]);

  opencga_clinical_review_cases_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_clinical_review_cases_templateObject6() {
  const data = opencga_clinical_review_cases_taggedTemplateLiteral(["\n                                        <li role=\"separator\" class=\"divider\"></li>\n                                        <li>\n                                            <a style=\"cursor: pointer\" @click=\"", "\"><i class=\"fa fa-floppy-o\" aria-hidden=\"true\" style=\"padding-right: 5px\"></i> Save...</a>\n                                        </li>\n                                    "]);

  opencga_clinical_review_cases_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_clinical_review_cases_templateObject5() {
  const data = opencga_clinical_review_cases_taggedTemplateLiteral(["\n                                                <a data-filter-name=\"", "\" style=\"cursor: pointer;color: green\" @click=\"", "\" class=\"filtersLink\">&nbsp;&nbsp;", "</a>\n                                            "]);

  opencga_clinical_review_cases_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_clinical_review_cases_templateObject4() {
  const data = opencga_clinical_review_cases_taggedTemplateLiteral(["\n                                                <a data-filter-name=\"", "\" style=\"cursor: pointer\" @click=\"", "\" class=\"filtersLink\">&nbsp;&nbsp;", "</a>\n                                            "]);

  opencga_clinical_review_cases_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_clinical_review_cases_templateObject3() {
  const data = opencga_clinical_review_cases_taggedTemplateLiteral(["\n                                        <li>\n                                            ", "\n                                        </li>\n                                    "]);

  opencga_clinical_review_cases_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_clinical_review_cases_templateObject2() {
  const data = opencga_clinical_review_cases_taggedTemplateLiteral(["\n                                            <option on-dom-change=\"_updateValidateFormFields\" value=\"", "\">", "</option>\n                                        "]);

  opencga_clinical_review_cases_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_clinical_review_cases_templateObject() {
  const data = opencga_clinical_review_cases_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .ocap-text-button {\n                display: inline-block;\n                overflow: hidden;\n                width: 90px;\n                text-align: left;\n                float: left !important;\n            }\n\n            .filter-label {\n                margin: auto 10px;\n                white-space: nowrap\n            }\n\n            .browser-variant-tab-title {\n                font-size: 115%;\n                font-weight: bold;\n            }\n            .horizontal-flex{\n                display: flex;\n            }\n            .horizontal-flex > div {\n                padding:5px;\n                flex:1;\n                box-sizing: border-box;\n            }\n            .horizontal-flex > div label {\n                display:block\n            }\n            .active-filter-label{\n                display: inline-block;\n                font-size: 15px;\n                text-transform: uppercase;\n                letter-spacing: 2px;\n                height: 34px;\n                line-height: 34px;\n                margin: 0;\n            }\n        </style>\n\n        <div class=\"row\">\n            <div class=\"col-md-12\">\n\n                <!--<div>-->\n                    <!--<h2 style=\"margin-top: 10px\">{{_config.title}}</h2>-->\n                <!--</div>-->\n\n                <div style=\"\">\n\n                    <div class=\"panel panel-default\" style=\"margin-bottom: 10px\">\n                        <!--<div class=\"panel-heading\">Case Filters</div>-->\n                        <div class=\"panel-body\" style=\"padding: 10px\">\n\n                            <div class=\"btn-group\" style=\"padding-right: 20px\">\n                                <label>Filters</label>\n                            </div>\n\n                            <!-- Case ID -->\n                            <div class=\"btn-group\">\n                                <button type=\"button\" class=\"dropdown-toggle btn btn-default filter-button\" style=\"width:125px; color: rgb(153, 153, 153);\"\n                                        id=\"", "caseMenu\"\n                                        data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"true\">\n                                    <span class=\"ocap-text-button\">Case: <span>", "</span></span>&nbsp;<span class=\"caret\"></span>\n                                </button>\n                                <ul class=\"dropdown-menu\" aria-labelledby=\"", "caseMenu\">\n                                    <li style=\"padding: 5px;\">\n                                        <div style=\"display: inline-flex; width: 300px;\">\n                                            <label class=\"filter-label\">Case ID:</label>\n                                            <input type=\"text\" id=\"", "caseInput\" class=\"", "-input form-control\" data-id=\"case\" placeholder=\"All\" @input=\"", "\">\n                                        </div>\n                                    </li>\n                                </ul>\n                            </div>\n\n                            <!-- Proband -->\n                            <div class=\"btn-group\">\n                                <button type=\"button\" class=\"btn btn-default dropdown-toggle filter-button\" style=\"width:125px; color: rgb(153, 153, 153);\"\n                                        id=\"", "probandMenu\" title=\"", "\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"true\">\n                                    <span class=\"ocap-text-button\">Proband: <span>", "</span></span>&nbsp; <span class=\"caret\"></span>\n                                </button>\n                                <ul class=\"dropdown-menu\" aria-labelledby=\"", "probandMenu\">\n                                    <li style=\"padding: 5px;\">\n                                        <div style=\"display: inline-flex;width: 300px\">\n                                            <label class=\"filter-label\">Proband ID:</label>\n                                            <input type=\"text\" id=\"", "probandInput\" class=\"", "-input form-control\" data-id=\"proband\" placeholder=\"All\" @keyup=\"", "\">\n                                        </div>\n                                    </li>\n                                </ul>\n                            </div>\n\n                            <!-- Family -->\n                            <div class=\"btn-group\">\n                                <button type=\"button\" class=\"dropdown-toggle btn btn-default filter-button\" style=\"width:125px; color: rgb(153, 153, 153);\"\n                                        id=\"", "familyMenu\" title=\"", "\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"true\">\n                                    <span class=\"ocap-text-button\">Family: <span>", "</span></span>&nbsp; <span class=\"caret\"></span>\n                                </button>\n                                <ul class=\"dropdown-menu\" aria-labelledby=\"", "FamilyMenu\">\n                                    <li style=\"padding: 5px;\">\n                                        <div style=\"display: inline-flex; width: 300px;\">\n                                            <label class=\"filter-label\">Family ID:</label>\n                                            <input type=\"text\" id=\"", "familyInput\" class=\"", "-input form-control\" data-id=\"family\" placeholder=\"All\" @input=\"", "\">\n                                        </div>\n                                    </li>\n                                </ul>\n                            </div>\n\n                            <!-- Disorder -->\n                            <div class=\"btn-group\">\n                                <button type=\"button\" class=\"dropdown-toggle btn btn-default filter-button\" style=\"width:125px; color: rgb(153, 153, 153);\"\n                                        id=\"", "disorderMenu\" title=\"", "\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"true\">\n                                    <span class=\"ocap-text-button\">Disorder: <span>", "</span></span>&nbsp; <span class=\"caret\"></span>\n                                </button>\n                                <ul class=\"dropdown-menu\" aria-labelledby=\"", "DisorderMenu\">\n                                    <li style=\"padding: 5px;\">\n                                        <div style=\"display: inline-flex; width: 300px;\">\n                                            <label class=\"filter-label\">Disorder ID:</label>\n                                            <input type=\"text\" id=\"", "disorderInput\" class=\"", "-input form-control\" data-id=\"disorder\" placeholder=\"All\" @input=\"", "\">\n                                        </div>\n                                    </li>\n                                </ul>\n                            </div>\n\n                            <!-- Type -->\n                            <div class=\"btn-group\">\n                                <select class=\"selectpicker\" data-width=\"125px\" id=\"", "-type\" multiple\n                                        title=\"Type: All\" @change=\"", "\" style=\"width:125px; color: rgb(153, 153, 153);\">\n                                    <option value=\"SINGLE\">Single</option>\n                                    <option value=\"FAMILY\">Family</option>\n                                    <option value=\"CANCER\">Cancer</option>\n                                    <option value=\"COHORT\">Cohort</option>\n                                    <option value=\"AUTOCOMPARATIVE\">Autocomparative</option>\n                                </select>\n                            </div>\n\n                            <!-- Status -->\n                            <div class=\"btn-group\">\n                                <select class=\"selectpicker\" data-width=\"125px\" id=\"", "-status\" multiple\n                                        title=\"Status: All\" @change=\"", "\">\n                                    <option value=\"INCOMPLETE\">Incomplete</option>\n                                    <option value=\"READY_FOR_VALIDATION\">Ready for Validation</option>\n                                    <option value=\"READY_FOR_INTERPRETATION\">Ready for Interpretation</option>\n                                    <option value=\"INTERPRETATION_IN_PROGRESS\">Interpretation in Progress</option>\n                                    <option value=\"READY_FOR_INTEPRETATION_REVIEW\">Ready for Interpretation Review</option>\n                                    <option value=\"INTERPRETATION_REVIEW_IN_PROGRESS\">Interpretation Review in Progress</option>\n                                    <option value=\"READY_FOR_REPORT\">Ready for Report</option>\n                                    <option value=\"REPORT_IN_PROGRESS\">Report in Progress</option>\n                                    <option value=\"DONE\">Done</option>\n                                    <option value=\"REVIEW_IN_PROGRESS\">Final Review in Progress</option>\n                                    <option value=\"REJECTED\">Rejected</option>\n                                    <option value=\"CLOSED\">Closed</option>\n                                </select>\n                            </div>\n\n                            <!-- Priority -->\n                            <div class=\"btn-group\">\n                                <select class=\"selectpicker\" data-width=\"125px\" id=\"", "-priority\" multiple\n                                        title=\"Priority: All\" @change=\"", "\">\n                                    <option style=\"color: red; font-weight: bold;\" value=\"URGENT\">Urgent</option>\n                                    <option style=\"color: orange; font-weight: bold;\" value=\"HIGH\">High</option>\n                                    <option style=\"color: blue; font-weight: bold;\" value=\"MEDIUM\">Medium</option>\n                                    <option style=\"color: green; font-weight: bold;\" value=\"LOW\">Low</option>\n                                </select>\n                            </div>\n\n                            <!-- Assignees -->\n                            <div class=\"btn-group\">\n                                <select class=\"selectpicker\" data-width=\"125px\" id=\"", "-assigned\" multiple\n                                        title=\"Assignee: All\" @change=\"", "\">\n                                        ", "\n                                        \n                                    <!-- TODO recheck ondomchange!! \n                                    <template is=\"dom-repeat\" items=\"{{_studyUsers}}\" on-dom-change=\"_updateValidateFormFields\">\n                                        <option value=\"{{item}}\">{{item}}</option>\n                                    </template>\n                                    -->\n                                </select>\n                            </div>\n\n                            <!-- Buttons -->\n                            <button class=\"btn btn-default\" style=\"margin-left: 15px;\" type=\"button\" @click=\"", "\">\n                                <i class=\"fa fa-times\" aria-hidden=\"true\"></i>\n                            </button>\n\n                            <button class=\"btn btn-default\" type=\"button\" @click=\"", "\">\n                                <i class=\"fa fa-search\" aria-hidden=\"true\"></i>\n                            </button>\n\n\n                            <!--<template is=\"dom-if\" if=\"{{showSelectFilters(opencgaClient._config)}}\">-->\n                            <div class=\"btn-group\" style=\"float: right\">\n                                <button type=\"button\" class=\"btn btn-primary ripple dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                                    <i class=\"fa fa-filter\" aria-hidden=\"true\" style=\"padding-right: 5px\"></i> Filters <span class=\"caret\"></span>\n                                </button>\n                                <ul class=\"dropdown-menu dropdown-menu-right\">\n                                    <li><a style=\"font-weight: bold\">Saved Filters</a></li>\n                                    ", "\n                                    \n                                    ", "\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div>\n                        <opencga-clinical-analysis-grid .opencgaSession=\"", "\"\n                                                        .query=\"", "\" style=\"font-size: 12px\"\n                                                        .active=\"", "\"\n                                                        .config=\"", "\"\n                                                        @selectanalysis=\"", "\">\n                        </opencga-clinical-analysis-grid>\n\n                        <!-- Bottom tabs with specific variant information -->\n                        ", "\n                    </div>\n                </div>\n            </div>\n        </div>\n        "]);

  opencga_clinical_review_cases_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_clinical_review_cases_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */






class opencga_clinical_review_cases_OpencgaClinicalReviewCases extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      query: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ocrc-" + utils.randomString(6) + "_";
    this._config = this.getDefaultConfig();
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession") || changedProperties.has("query")) {
      this.propertyObserver();
    }
  }

  firstUpdated(_changedProperties) {
    this.case = "All";
    this.proband = "All";
    this.family = "All";
    this.disorder = "All";
    this.active = true;
    $("select.selectpicker").selectpicker("render");
  }

  propertyObserver() {
    this._config = Object.assign({}, this.getDefaultConfig(), this.config);

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.study) && utilsNew_UtilsNew.isNotEmptyArray(this.opencgaSession.study.groups)) {
      // let _studyUsers = [opencgaSession.user.id];
      for (const group of this.opencgaSession.study.groups) {
        if (group.id === "@members" || group.name === "@members") {
          this._studyUsers = group.userIds;
        }
      }
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query)) {
      this.setQueryFilters(this.query);
      this._query = Object.assign({}, this.query);
    }

    this.requestUpdate();
  }

  checkSid(config) {
    return utilsNew_UtilsNew.isNotEmpty(config.sessionId);
  }

  onClearQuery(e) {
    //FIXME monkey patch to reset button (text) fields. TODO complete refactor.
    this.case = "All";
    this.querySelector("#".concat(this._prefix, "caseInput")).value = "";
    this.proband = "All";
    this.querySelector("#".concat(this._prefix, "probandInput")).value = "";
    this.family = "All";
    this.querySelector("#".concat(this._prefix, "familyInput")).value = "";
    this.disorder = "All";
    this.querySelector("#".concat(this._prefix, "disorderInput")).value = "";
    $(".filter-button").css("color", "rgb(153, 153, 153)");
    $("#".concat(this._prefix, "-type")).selectpicker("val", "");
    $("#".concat(this._prefix, "-priority")).selectpicker("val", "");
    $("#".concat(this._prefix, "-status")).selectpicker("val", "");
    $("#".concat(this._prefix, "-assigned")).selectpicker("val", "");
    this.updateQuery();
  }

  onSelectClinicalAnalysis(e) {
    this.clinicalAnalysis = e.detail.analysis;
    this.requestUpdate();
  }

  onFilterChange(e) {
    for (const exampleFilter of this._config.filter.examples) {
      if (e.currentTarget.dataset.filterName === exampleFilter.name) {
        this._query = exampleFilter.query;
        this.setQueryFilters(this._query);
        break;
      }
    }
  }

  onFilterInputText(e) {
    const filterId = e.currentTarget.dataset.id;
    const value = e.currentTarget.value;
    this.updateInputTextMenuItem(filterId, value);
  }

  updateInputTextMenuItem(filterId, value) {
    const buttonElem = PolymerUtils_PolymerUtils.getElementById(this._prefix + filterId + "Menu");
    console.log(buttonElem);
    console.log(filterId, value, this[filterId]);

    if (utilsNew_UtilsNew.isNotEmpty(value)) {
      this[filterId] = value;
      buttonElem.style.color = "#333";
    } else {
      this[filterId] = "All";
      buttonElem.style.color = "rgb(153, 153, 153)";
    }

    this.requestUpdate();
  }

  updateQuery() {
    const _query = {};
    const defaultValue = "All";

    if (this.case !== defaultValue && this.case !== "") {
      _query.id = this.case;
    }

    if (this.proband !== defaultValue) {
      _query.proband = this.proband;
    }

    if (this.family !== defaultValue) {
      _query.family = this.family;
    }

    if (this.disorder !== defaultValue) {
      _query.disorder = this.disorder;
    }

    const type = $("#".concat(this._prefix, "-type")).selectpicker("val");

    if (utilsNew_UtilsNew.isNotEmpty(type)) {
      _query.type = type.join(",");
    }

    const status = $("#".concat(this._prefix, "-status")).selectpicker("val");

    if (utilsNew_UtilsNew.isNotEmpty(status)) {
      _query.status = status.join(",");
    }

    const priority = $("#".concat(this._prefix, "-priority")).selectpicker("val");

    if (utilsNew_UtilsNew.isNotEmpty(priority)) {
      _query.priority = priority.join(",");
    }

    const assigned = $("#".concat(this._prefix, "-assigned")).selectpicker("val");

    if (utilsNew_UtilsNew.isNotEmpty(assigned)) {
      _query.analystAssignee = assigned.join(",");
    }

    this._query = _query;
    this.requestUpdate();
  }

  setQueryFilters(query) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(query.id)) {
      PolymerUtils_PolymerUtils.setValue(this._prefix + "caseInput", query.id);
      this.updateInputTextMenuItem("case", query.id);
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(query.proband)) {
      PolymerUtils_PolymerUtils.setValue(this._prefix + "probandInput", query.proband);
      this.updateInputTextMenuItem("proband", query.proband);
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(query.family)) {
      PolymerUtils_PolymerUtils.setValue(this._prefix + "familyInput", query.family);
      this.updateInputTextMenuItem("family", query.family);
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(query.disorder)) {
      PolymerUtils_PolymerUtils.setValue(this._prefix + "disorderInput", query.disorder);
      this.updateInputTextMenuItem("disorder", query.disorder);
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(query.type)) {
      $("#" + this._prefix + "-type").selectpicker("val", query.type.split(","));
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(query.status)) {
      $("#" + this._prefix + "-status").selectpicker("val", query.status.split(","));
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(query.priority)) {
      $("#" + this._prefix + "-priority").selectpicker("val", query.priority.split(","));
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(query.assigned)) {
      $("#" + this._prefix + "-assigned").selectpicker("val", query.analystAssignee.split(","));
    }
  }

  _updateValidateFormFields() {
    $("#" + this._prefix + "-assigned").validator("update");
  }

  getDefaultConfig() {
    return {
      title: "Review Cases",
      showTitle: true,
      filter: {
        examples: [{
          name: "High Priority",
          active: false,
          query: {
            type: "FAMILY",
            priority: "URGENT,HIGH" // assigned: "cafetero"

          }
        }]
      },
      grid: {
        pageSize: 5,
        pageList: [5, 10, 25],
        detailView: false,
        multiSelection: false
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_clinical_review_cases_templateObject(), this._prefix, this.case, this._prefix, this._prefix, this._prefix, this.onFilterInputText, this._prefix, this.proband, this.proband, this._prefix, this._prefix, this._prefix, this.onFilterInputText, this._prefix, this.family, this.family, this._prefix, this._prefix, this._prefix, this.onFilterInputText, this._prefix, this.disorder, this.disorder, this._prefix, this._prefix, this._prefix, this.onFilterInputText, this._prefix, this.updateQuery, this._prefix, this.updateQuery, this._prefix, this.updateQuery, this._prefix, this.updateQuery, this._studyUsers && this._studyUsers.length ? this._studyUsers.map(item => lit_html_lit_html_html(opencga_clinical_review_cases_templateObject2(), item, item)) : null, this.onClearQuery, this.updateQuery, this._config.filter.examples && this._config.filter.examples.length ? this._config.filter.examples.map(item => lit_html_lit_html_html(opencga_clinical_review_cases_templateObject3(), item.active ? lit_html_lit_html_html(opencga_clinical_review_cases_templateObject4(), item.name, this.onFilterChange, item.name) : lit_html_lit_html_html(opencga_clinical_review_cases_templateObject5(), item.name, this.onFilterChange, item.name))) : null, this.checkSid(this.opencgaSession.opencgaClient._config) ? lit_html_lit_html_html(opencga_clinical_review_cases_templateObject6(), this.launchModal) : null, this.opencgaSession, this._query, this.active, this._config.grid, this.onSelectClinicalAnalysis, this.clinicalAnalysis ? lit_html_lit_html_html(opencga_clinical_review_cases_templateObject7(), this.clinicalAnalysis.id, this._prefix, this._prefix, this._prefix, this._prefix, this.opencgaSession, this.clinicalAnalysis, this.opencgaSession.opencgaClient, this.config, this._prefix) : null);
  }

}
customElements.define("opencga-clinical-review-cases", opencga_clinical_review_cases_OpencgaClinicalReviewCases);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/commons/CatalogUIUtils.js

class CatalogUIUtils_CatalogUIUtils {
  constructor() {}

  static parseVariableSetVariablesForDisplay(variables, tags, margin, config) {
    config = Object.assign({
      marginStep: 15,
      onlyAllowLeafSelection: true
    }, config);
    let displayVariables = [];

    for (let i in variables) {
      let variable = variables[i];

      if (variable.type !== "OBJECT") {
        // Add variable
        displayVariables.push({
          id: variable.id,
          name: utilsNew_UtilsNew.defaultString(variable.name, variable.id),
          category: variable.category,
          type: variable.type,
          defaultValue: variable.defaultValue,
          multiValue: variable.multiValue,
          allowedValues: variable.allowedValues,
          disabled: false,
          margin: margin,
          cursor: "pointer",
          tags: tags.concat(variable.id).join(".")
        });
      } else {
        // Add variable
        displayVariables.push({
          id: variable.id,
          name: utilsNew_UtilsNew.defaultString(variable.name, variable.id),
          category: variable.category,
          type: variable.type,
          defaultValue: variable.defaultValue,
          multiValue: variable.multiValue,
          allowedValues: variable.allowedValues,
          disabled: config.onlyAllowLeafSelection,
          margin: margin,
          cursor: config.onlyAllowLeafSelection ? "default" : "pointer",
          tags: tags.concat(variable.id).join(".")
        });
        displayVariables = displayVariables.concat(this.parseVariableSetVariablesForDisplay(variable.variableSet, tags.concat(variable.id), margin + config.marginStep, config));
      }
    }

    return displayVariables;
  }

  addTooltip(selector, title, config) {
    $(selector).qtip({
      content: {
        title: title,
        text: function text(event, api) {
          return $(this).attr('data-tooltip-text');
        }
      },
      position: {
        target: "mouse",
        adjust: {
          x: 2,
          y: 2,
          mouse: false
        }
      },
      style: {
        classes: config !== undefined && config.style !== undefined && config.style.classes !== undefined ? config.style.classes : "qtip-light qtip-rounded qtip-shadow qtip-custom-class",
        width: "320px"
      },
      show: {
        delay: 250
      },
      hide: {
        fixed: true,
        delay: 300
      }
    });
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/variableSets/opencga-variable-selector.js
function opencga_variable_selector_templateObject4() {
  const data = opencga_variable_selector_taggedTemplateLiteral(["\n                        <button type=\"button\" class=\"btn btn-primary\" @click=\"", "\">Reset</button>\n                    "]);

  opencga_variable_selector_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_variable_selector_templateObject3() {
  const data = opencga_variable_selector_taggedTemplateLiteral(["\n                                    <option data-tokens=\"", "\" data-index=\"", "\" \n                                            style=\"padding-left: ", "px; cursor: ", ";\"\n                                            ?disabled=\"", "\">\n                                        ", "\n                                    </option>\n                                "]);

  opencga_variable_selector_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_variable_selector_templateObject2() {
  const data = opencga_variable_selector_taggedTemplateLiteral(["\n                <label for=\"", "-annotation-picker\" style=\"margin-top: 15px;\">", "</label>\n\n                <form>\n                    <div class=\"form-group\">\n                        <select class=\"selectpicker ovs-list\" id=\"", "-annotation-picker\" data-live-search=\"true\" data-size=\"10\"\n                                @change=\"", "\" data-width=\"100%\" ?multiple=\"", "\">\n                            ", "\n                        </select>\n                    </div>\n                    ", "\n                </form>\n            "]);

  opencga_variable_selector_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_variable_selector_templateObject() {
  const data = opencga_variable_selector_taggedTemplateLiteral(["\n        <style>\n        .ovs-list li.selected {\n            background-color: #cdcdcd;\n        }\n    </style>\n\n        <div id=\"", "-main-div\">\n            ", "\n        </div>\n        "]);

  opencga_variable_selector_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_variable_selector_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
// TODO check functionality and on-dom-repeat




class opencga_variable_selector_OpencgaVariableSelector extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      variableSet: {
        type: Array
      },
      selected: {
        type: Array
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ovs-" + utils.randomString(6) + "_";
    this.variables = [];
    this._config = this.getDefaultConfig();
  }

  firstUpdated(_changedProperties) {
    const selectpicker = $("#".concat(this.prefix, "-annotation-picker"));
    selectpicker.selectpicker("refresh");
    selectpicker.selectpicker("deselectAll");

    if (!this._config.multiSelection) {
      // Select first allowed variable by default
      for (const variable of this.variables) {
        if (!variable.disabled) {
          $("#".concat(this._prefix, "-annotation-picker")).find(".selectpicker").selectpicker("deselectAll");
          this.dispatchEvent(new CustomEvent("variablechange", {
            detail: {
              value: [variable]
            }
          }));
          return;
        }
      }
    }
  }

  updated(changedProperties) {
    if (changedProperties.has("variableSet")) {
      this.onVariableSetConfigChange();
    }

    if (changedProperties.has("config")) {
      this.onVariableSetConfigChange();
    }
  }

  connectedCallback() {
    super.connectedCallback();
  }

  async onVariableSetConfigChange() {
    this._config = Object.assign({}, this.getDefaultConfig(), this.config);
    const customConfig = {
      onlyAllowLeafSelection: this._config.onlyAllowLeafSelection
    };

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.variableSet)) {
      this.variables = CatalogUIUtils_CatalogUIUtils.parseVariableSetVariablesForDisplay(this.variableSet.variables, [], 25, customConfig);
      console.log("onVariableSetConfigChange this.variables ", this.variables); //await this.requestUpdate();

      const selectpicker = $("#".concat(this.prefix, "-annotation-picker")); //console.log("selectpicker",selectpicker.val())
      //selectpicker.selectpicker("render");

      await this.requestUpdate();
      selectpicker.selectpicker("refresh");
    }
  }

  renderDomRepeat(e) {
    const mainDiv = $("#".concat(this._prefix, "-main-div"));
    const selectpicker = mainDiv.find(".selectpicker");
    selectpicker.selectpicker("refresh");
    selectpicker.selectpicker("deselectAll"); // // Add the class to the select picker buttons
    // selectpicker.selectpicker('setStyle', this._config.buttonClass, 'add');
    // // Add the class to the lists
    // mainDiv.find("ul > li").addClass(this._config.class);
  }

  onChangeSelectedVariable(e) {
    console.log("onChangeSelectedVariable");
    const selectedVariables = [];
    /*for (let i = 0; i < e.currentTarget.selectedOptions.length; i++) {
        selectedVariables.push(e.currentTarget.selectedOptions[i].dataVariable);
    }
    */
    //let selectedVariable = this.variables[selectedIndex];

    const selectpicker = $("#".concat(this.prefix, "-annotation-picker"));
    let selectedOption = selectpicker.selectpicker("val");
    let selectedVariable = this.variables.find(variable => variable.id === selectedOption);
    selectpicker.selectpicker("refresh");
    console.log("selectedVariable", selectedVariable);
    this.dispatchEvent(new CustomEvent("variablechange", {
      detail: {
        value: selectedVariable
      }
    }));
  }

  resetSelection(e) {
    const mainDiv = $("#".concat(this._prefix, "-main-div"));
    const selectpicker = this.querySelector("#".concat(this.prefix, "-annotation-picker")); //console.log("selectpicker",selectpicker)

    selectpicker.selectpicker("refresh");
    selectpicker.selectpicker("deselectAll");
  }

  getDefaultConfig() {
    return {
      title: "Select variable and value(s)",
      multiSelection: false,
      // Select multiple fields
      onlyAllowLeafSelection: true,
      // Only allow leaf selection
      showResetButton: false,
      class: "small",
      buttonClass: "btn-sm",
      inputClass: "input-sm"
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_variable_selector_templateObject(), this.prefix, this.variables && this.variables.length ? lit_html_lit_html_html(opencga_variable_selector_templateObject2(), this.prefix, this._config.title, this.prefix, this.onChangeSelectedVariable, this._config.multiSelection, this.variables.map((variable, i) => {
      console.log("variable", variable);
      return lit_html_lit_html_html(opencga_variable_selector_templateObject3(), variable.tags, i, variable.margin, variable.cursor, variable.disabled, variable.id);
    }), this._config.showResetButton ? lit_html_lit_html_html(opencga_variable_selector_templateObject4(), this.resetSelection) : null) : null);
  }

}
customElements.define("opencga-variable-selector", opencga_variable_selector_OpencgaVariableSelector);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/variableSets/opencga-annotation-filter.js
function opencga_annotation_filter_templateObject11() {
  const data = opencga_annotation_filter_taggedTemplateLiteral(["\n                    <!-- BOOLEAN type, 2 values: radio buttons for selection: yes or no -->\n                    <div class=\"form-check form-check-inline\">\n                        <input id=\"", "", "yes\" class=\"form-check-input\"\n                               type=\"radio\" name=\"", "Options\" data-value=true @input=\"", "\">\n                        True\n                        <input id=\"", "", "no\" class=\"form-check-input\"\n                               type=\"radio\" name=\"", "Options\" data-value=false @input=\"", "\">\n                        False\n                    </div>\n\n                "]);

  opencga_annotation_filter_templateObject11 = function _templateObject11() {
    return data;
  };

  return data;
}

function opencga_annotation_filter_templateObject10() {
  const data = opencga_annotation_filter_taggedTemplateLiteral(["\n                                    <option value=\"", "\" on-dom-change=\"renderDomRepeat\">", "</option>F\n                                "]);

  opencga_annotation_filter_templateObject10 = function _templateObject10() {
    return data;
  };

  return data;
}

function opencga_annotation_filter_templateObject9() {
  const data = opencga_annotation_filter_taggedTemplateLiteral(["\n                    <select id=\"", "-categorical-selector\" class=\"selectpicker\" multiple @change=\"", "\"\n                            data-width=\"100%\">\n                        ", "\n                    </select>\n                "]);

  opencga_annotation_filter_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function opencga_annotation_filter_templateObject8() {
  const data = opencga_annotation_filter_taggedTemplateLiteral(["\n                    <!-- NUMERIC type: include an input text and add suitable regular expression for numbers -->\n                    <input type=\"text\" class=\"form-control ", "AnnotationTextInput\"\n                           placeholder=\"", " number\" data-variable-name=\"", "\"\n                           pattern=\"^[0-9]+$\" @input=\"", "\">\n                "]);

  opencga_annotation_filter_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_annotation_filter_templateObject7() {
  const data = opencga_annotation_filter_taggedTemplateLiteral(["\n                    <!-- TEXT type: include an input text and add suitable regular expression for text-->\n                    <!-- http://stackoverflow.com/questions/14237686/disabling-controls-in-bootstrap-->\n                    <input type=\"text\" class=\"form-control ", "AnnotationTextInput\"\n                           placeholder=\"", " name\" data-variable-name=\"", "\"\n                           pattern=\"", "\"\n                           aria-describedby=\"basic-addon1\" @input=\"", "\">\n                "]);

  opencga_annotation_filter_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_annotation_filter_templateObject6() {
  const data = opencga_annotation_filter_taggedTemplateLiteral(["<div class=\"row\" style=\"margin-top: 15px; margin-right: 20px;\">\n            <div class=\"col-md-10\">\n                \n                ", "\n            </div>\n            \n            <div class=\"col-md-2\">\n                <button class=\"btn btn-default\" @click=\"", "\"><i class=\"fa fa-plus-circle plus-button\" aria-hidden=\"true\"></i></button>\n            </div>\n        "]);

  opencga_annotation_filter_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_annotation_filter_templateObject5() {
  const data = opencga_annotation_filter_taggedTemplateLiteral(["<option>", "</option>"]);

  opencga_annotation_filter_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_annotation_filter_templateObject4() {
  const data = opencga_annotation_filter_taggedTemplateLiteral(["\n                <label for=\"", "-variableSetSelect\">Select Variable Set</label>\n                <!-- TODO use this <select-field-filter .data=\"", "\" @filterChange=\"", "\"></select-field-filter> -->\n                <select class=\"selectpicker\" id=\"", "-variableSetSelect\" @change=\"", "\" data-width=\"100%\">\n                    ", "\n                </select>"]);

  opencga_annotation_filter_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_annotation_filter_templateObject3() {
  const data = opencga_annotation_filter_taggedTemplateLiteral(["\n            <!-- Annotations -->\n            ", "\n        \n        <opencga-variable-selector .variableSet=\"", "\"\n                                   @variablechange=\"", "\">\n        </opencga-variable-selector>\n                \n        <!-- Show different value selector based on the type of the selected variable -->\n        ", "\n        </div>\n    </div>\n        "]);

  opencga_annotation_filter_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_annotation_filter_templateObject2() {
  const data = opencga_annotation_filter_taggedTemplateLiteral(["\n            <label>No variableSets defined in the study<label>\n        "]);

  opencga_annotation_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_annotation_filter_templateObject() {
  const data = opencga_annotation_filter_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .plus-button {\n                color: #00AA33;\n                cursor: pointer;\n            }\n\n            .plus-button:hover {\n                color: #009c2c;\n            }\n            \n            .annotation-filter-div label{\n                font-weight: normal;\n                font-size: .9em;\n            }\n            \n            \n        </style>\n        <div id=\"", "-main-annotation-filter-div\" class=\"annotation-filter-div\">\n        ", "\n        "]);

  opencga_annotation_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_annotation_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_annotation_filter_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_annotation_filter_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_annotation_filter_ownKeys(Object(source), true).forEach(function (key) { opencga_annotation_filter_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_annotation_filter_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_annotation_filter_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }






 // TODO replicate and check on-dom-change behaviour

class opencga_annotation_filter_OpencgaAnnotationFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      entity: {
        type: String
      },
      config: {
        type: Object
      }
    };
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession")) {
      this.opencgaSessionObserver();
    }
  }

  _init() {
    this._prefix = "oaf-" + utils.randomString(6);
    this.multipleVariableSets = false;
    this._config = this.getDefaultConfig();
    this.variableSets = []; // this.selectedVariable = {}
  }

  connectedCallback() {
    super.connectedCallback();
    this._config = opencga_annotation_filter_objectSpread({}, this.getDefaultConfig(), {}, this.config); // Components are already set. We will override with the classes from the configuration file

    PolymerUtils_PolymerUtils.addClassById("".concat(this._prefix, "-main-annotation-filter-div"), [this._config.class]);
    $("select.selectpicker", this).selectpicker("render");
    $("select.selectpicker", this).selectpicker("refresh");
    $("select.selectpicker", this).selectpicker("deselectAll"); // Get selected variable

    const variableSetSelector = $("button[data-id=".concat(this._prefix, "-annotation-picker]"))[0];
    console.log("variableSetSelector", variableSetSelector);

    if (typeof variableSetSelector !== "undefined") {
      this.selectedVariable = this.getVariable(variableSetSelector.title);
    }

    this.lastAnnotationFilter = undefined;
    const annotationDiv = $("#".concat(this._prefix, "-main-annotation-filter-div")); // Add the class to the select picker buttons

    annotationDiv.find(".selectpicker").selectpicker("setStyle", this._config.buttonClass, "add"); // Add the class to the lists

    annotationDiv.find("ul > li").addClass(this._config.class); // Add the class to the input

    annotationDiv.find(".".concat(this._prefix, "AnnotationTextInput")).addClass(this._config.class);
  }

  firstUpdated(_changedProperties) {
    $("select.selectpicker").selectpicker("render");
    $("select.selectpicker").selectpicker("refresh");
    $("select.selectpicker").selectpicker("deselectAll");
  } // TODO FIXME opencga-variable-selector can be configured to be a multiple choice select, but here just the first selection is used


  async onChangeSelectedVariable(e) {
    // this.selectedVariable = e.detail.value[0];
    this.selectedVariable = e.detail.value;
    await this.requestUpdate();
    this.lastAnnotationFilter = undefined; // We do this manually here because the selectpicker class does not show/hide automatically

    if (this.selectedVariable.type === "CATEGORICAL") {
      // $(`#${this._prefix}-variableSetSelect`).selectpicker('hide')
      $("#".concat(this._prefix, "-categorical-selector")).selectpicker("show");
      $("#".concat(this._prefix, "-categorical-selector")).selectpicker("refresh");
      $("#".concat(this._prefix, "-categorical-selector")).selectpicker("deselectAll");
    } else {
      $("#".concat(this._prefix, "-categorical-selector")).selectpicker("hide"); // $(`#${this._prefix}-variableSetSelect`).selectpicker('show');
      // $(`#${this._prefix}-variableSetSelect`).selectpicker('refresh');
    }
  }

  onAddAnnotationClicked(e) {
    if (typeof this.lastAnnotationFilter === "undefined") {
      NotificationUtils_NotificationUtils.showNotify("Please choose or input a value", "WARNING");
      return;
    }

    this.dispatchEvent(new CustomEvent("filterannotation", {
      detail: {
        value: this.lastAnnotationFilter
      }
    }));
  }

  getVariable(variableId) {
    for (const i in this.variables) {
      if (this.variables[i].id === variableId) {
        return this.variables[i];
      }
    }

    console.error("Variable " + variableId + " not found");
  }

  addCategoricalFilter(e) {
    this.lastAnnotationFilter = undefined;
    const values = $(e.target).selectpicker("val");

    if (values === null) {
      return;
    } // Note: in case of single variable set the select #${this._prefix}-variableSetSelect is not actually present in DOM, this.singleVariableSet contains the value


    const variableSetId = this.singleVariableSet ? this.singleVariableSet : $("#".concat(this._prefix, "-variableSetSelect")).selectpicker("val");
    const variable = this.selectedVariable.tags;
    this.lastAnnotationFilter = "".concat(variableSetId, ":").concat(variable, "=").concat(values.join(","));
  }

  addInputFilter(e) {
    this.lastAnnotationFilter = undefined;
    const value = e.target.value.trim();

    if (!value) {
      return;
    }

    const variableSetId = this.singleVariableSet ? this.singleVariableSet : $("#".concat(this._prefix, "-variableSetSelect")).selectpicker("val");
    const variable = this.selectedVariable.tags;
    console.log(variableSetId);
    this.lastAnnotationFilter = "".concat(variableSetId, ":").concat(variable, "=").concat(value);
  }

  addSelectedFilter(e) {
    const value = e.currentTarget.dataset.value;
    const variableSetId = this.singleVariableSet ? this.singleVariableSet : $("#".concat(this._prefix, "-variableSetSelect")).selectpicker("val");
    const variable = this.selectedVariable.tags;
    this.lastAnnotationFilter = "".concat(variableSetId, ":").concat(variable, "=").concat(value);
  }

  opencgaSessionObserver() {
    this.variableSets = [];
    this.multipleVariableSets = false;
    this.variables = [];
    $("select.selectpicker").selectpicker("refresh");
    $("select.selectpicker").selectpicker("deselectAll");

    if (typeof this.opencgaSession.study === "undefined") {
      this.dispatchEvent(new CustomEvent("variablesetselected", {
        detail: {
          id: null
        }
      }));
      return;
    }

    if (typeof this.opencgaSession.study.variableSets !== "undefined") {
      this._updateVariableSets(this.opencgaSession.study);
    } else {
      const _this = this;

      this.opencgaClient.studies().info(this.opencgaSession.study.id, {
        include: "variableSets"
      }).then(function (response) {
        _this._updateVariableSets(response.response[0].result[0]);
      }).catch(function () {
        _this.multipleVariableSets = false; // Hide all selectpicker selectors

        $("#".concat(this._prefix, "-variableSetSelect")).selectpicker("hide");
        $("#".concat(this._prefix, "-annotation-picker")).selectpicker("hide");
        $("#".concat(this._prefix, "-categorical-selector")).selectpicker("hide");
        this.dispatchEvent(new CustomEvent("variablesetselected", {
          detail: {
            id: null
          }
        }));
        console.log("Could not obtain the variable sets of the study " + _this.opencgaSession.study);
      });
    }
  }

  async _updateVariableSets(study) {
    if (typeof study.variableSets === "undefined") {
      this.variableSets = [];
    } else {
      const _variableSets = [];

      for (const variableSet of study.variableSets) {
        if (utilsNew_UtilsNew.isEmpty(this.entity) || variableSet.entities.includes(this.entity)) {
          variableSet["name"] = utilsNew_UtilsNew.defaultString(variableSet.name, variableSet.id);

          _variableSets.push(variableSet);
        }
      }

      this.variableSets = _variableSets;
    }

    if (this.variableSets.length > 0) {
      this.selectedVariableSet = this.variableSets[0];
      this.filteredVariables = {
        variableSet: this.variableSets[0].id,
        variables: []
      }; // Show all selectpicker selectors

      $("#".concat(this._prefix, "-variableSetSelect")).selectpicker("show");
      $("#".concat(this._prefix, "-annotation-picker")).selectpicker("show");

      if (typeof this.selectedVariable !== "undefined" && this.checkVarType(this.selectedVariable, "CATEGORICAL")) {
        $("#".concat(this._prefix, "-categorical-selector")).selectpicker("show");
      }

      this.multipleVariableSets = this.variableSets.length > 1;
      this.singleVariableSet = !this.multipleVariableSets ? this.variableSets[0].id : null;
      await this.requestUpdate();
      this.dispatchEvent(new CustomEvent("variablesetselected", {
        detail: {
          id: this.variableSets[0].id
        }
      }));
    } else {
      this.multipleVariableSets = false; // Hide all selectpicker selectors

      $("#".concat(this._prefix, "-variableSetSelect")).selectpicker("hide");
      $("#".concat(this._prefix, "-annotation-picker")).selectpicker("hide");
      $("#".concat(this._prefix, "-categorical-selector")).selectpicker("hide");
      this.dispatchEvent(new CustomEvent("variablesetselected", {
        detail: {
          id: null
        }
      }));
    }

    this.requestUpdate().then(() => {
      $("select.selectpicker", this).selectpicker("refresh");
    });
  }

  renderVariableTemplate() {
    const myTemplate = PolymerUtils_PolymerUtils.getElementById(this._prefix + "VariableTemplate");

    if (utilsNew_UtilsNew.isNotNull(myTemplate)) {
      myTemplate.render();
    }
  }

  onSelectedVariableSetChange(e) {
    // console.log("onSelectedVariableSetChange", e )
    const selectedVariableSet = e.currentTarget.value;
    this.variableSets.forEach(variableSet => {
      if (variableSet.name === selectedVariableSet) {
        this.selectedVariableSet = variableSet; // console.log("selectedVariableSet",this.selectedVariableSet)

        this.requestUpdate();
      }
    });
  }

  checkVarType(myVar, type) {
    return myVar.type === type;
  }

  getDefaultConfig() {
    return {
      variableSelector: {
        marginLeft: 20,
        marginStep: 15
      },
      class: "",
      buttonClass: "",
      inputClass: ""
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_annotation_filter_templateObject(), this._prefix, !this.variableSets.length ? lit_html_lit_html_html(opencga_annotation_filter_templateObject2()) : lit_html_lit_html_html(opencga_annotation_filter_templateObject3(), this.multipleVariableSets ? lit_html_lit_html_html(opencga_annotation_filter_templateObject4(), this._prefix, this.variableSets.map(_ => _.name), this.onSelectedVariableSetChange, this._prefix, this.onSelectedVariableSetChange, this.variableSets.map(item => lit_html_lit_html_html(opencga_annotation_filter_templateObject5(), item.name))) : null, this.selectedVariableSet, this.onChangeSelectedVariable, this.selectedVariable ? lit_html_lit_html_html(opencga_annotation_filter_templateObject6(), this.selectedVariable.type === "TEXT" ? lit_html_lit_html_html(opencga_annotation_filter_templateObject7(), this._prefix, this.selectedVariable.id, this.selectedVariable.id, this.selectedVariable.attributes && this.selectedVariable.attributes.pattern ? this.selectedVariable.attributes.pattern : null, this.addInputFilter) : this.selectedVariable.type === "NUMERIC" || this.selectedVariable.type === "INTEGER" || this.selectedVariable.type === "DOUBLE" ? lit_html_lit_html_html(opencga_annotation_filter_templateObject8(), this._prefix, this.selectedVariable.id, this.selectedVariable.id, this.addInputFilter) : this.selectedVariable.type === "CATEGORICAL" ? lit_html_lit_html_html(opencga_annotation_filter_templateObject9(), this._prefix, this.addCategoricalFilter, this.selectedVariable.allowedValues && this.selectedVariable.allowedValues.length && this.selectedVariable.allowedValues.map(item => lit_html_lit_html_html(opencga_annotation_filter_templateObject10(), item, item))) : this.selectedVariable.type === "BOOLEAN" ? lit_html_lit_html_html(opencga_annotation_filter_templateObject11(), this._prefix, this.selectedVariable.id, this.selectedVariable.id, this.addSelectedFilter, this._prefix, this.selectedVariable.id, this.selectedVariable.id, this.addSelectedFilter) : null, this.onAddAnnotationClicked) : null));
  }

}
customElements.define("opencga-annotation-filter", opencga_annotation_filter_OpencgaAnnotationFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/text-field-filter.js
function text_field_filter_templateObject() {
  const data = text_field_filter_taggedTemplateLiteral(["\n            <div id=\"", "-wrapper\" class=\"subsection-content form-group\">\n                <input type=\"text\" id=\"", "-input\" class=\"form-control input-sm ", "FilterTextInput\" ?disabled=", " .required=", " placeholder=\"", "\" @input=\"", "\">\n            </div>\n        "]);

  text_field_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function text_field_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


class text_field_filter_TextFieldFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      placeholder: {
        type: String
      },
      value: {
        type: String
      },
      disabled: {
        type: Boolean
      },
      required: {
        type: Boolean
      }
    };
  }

  _init() {
    this._prefix = "tff-" + utils.randomString(6) + "_";
  }
  /*set value(val) {
      let oldVal = this._value;
      this._value = val;
      this.requestUpdate('value', oldVal);
  }*/


  updated(_changedProperties) {
    if (_changedProperties.has("value")) {
      if (this.value) {
        this.querySelector("#" + this._prefix + "-input").value = this.value;
      } else {
        this.querySelector("#" + this._prefix + "-input").value = "";
      }
    }
  }

  filterChange(e) {
    const event = new CustomEvent("filterChange", {
      detail: {
        value: e.target.value || null
      }
    });
    this.dispatchEvent(event);
  }

  render() {
    return lit_html_lit_html_html(text_field_filter_templateObject(), this._prefix, this._prefix, this._prefix, this.disabled, this.required, this.placeholder, this.filterChange);
  }

}
customElements.define("text-field-filter", text_field_filter_TextFieldFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/individual/opencga-individual-filter.js
function opencga_individual_filter_templateObject10() {
  const data = opencga_individual_filter_taggedTemplateLiteral(["No filter has been configured."]);

  opencga_individual_filter_templateObject10 = function _templateObject10() {
    return data;
  };

  return data;
}

function opencga_individual_filter_templateObject9() {
  const data = opencga_individual_filter_taggedTemplateLiteral(["\n            <div class=\"search-button-wrapper\">\n                <button type=\"button\" class=\"btn btn-primary ripple\" @click=\"", "\">\n                    <i class=\"fa fa-search\" aria-hidden=\"true\"></i> Search\n                </button>\n            </div>\n            "]);

  opencga_individual_filter_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function opencga_individual_filter_templateObject8() {
  const data = opencga_individual_filter_taggedTemplateLiteral(["\n            <style include=\"jso-styles\">\n\n            span + span {\n                margin-left: 10px;\n            }\n\n            div.block {\n                overflow: hidden;\n            }\n\n            div.block label {\n                width: 80px;\n                display: block;\n                float: left;\n                text-align: left;\n                font-weight: normal;\n            }\n\n            select + select {\n                margin-left: 10px;\n            }\n\n            select + input {\n                margin-left: 10px;\n            }\n        </style>\n\n        ", "\n\n        <div class=\"panel-group\" id=\"", "Accordion\" role=\"tablist\" aria-multiselectable=\"true\" style=\"padding-top: 20px\">\n\n            <!-- Individual field attributes -->\n                <div class=\"\">            \n                    ", "\n                </div>\n            </div>\n        </div>\n        "]);

  opencga_individual_filter_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_individual_filter_templateObject7() {
  const data = opencga_individual_filter_taggedTemplateLiteral(["\n                                <div class=\"tooltip-div pull-right\">\n                                    <a><i class=\"fa fa-info-circle\" aria-hidden=\"true\" id=\"", "", "Tooltip\"></i></a>\n                                </div>"]);

  opencga_individual_filter_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_individual_filter_templateObject6() {
  const data = opencga_individual_filter_taggedTemplateLiteral(["\n                    <div class=\"form-group\">\n                        <div class=\"browser-subsection\" id=\"", "\">", "\n                            ", "\n                        </div>\n                        <div id=\"", "", "\" class=\"subsection-content\">\n                            ", "\n                         </div>\n                    </div>\n                "]);

  opencga_individual_filter_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_individual_filter_templateObject5() {
  const data = opencga_individual_filter_taggedTemplateLiteral(["<opencga-date-filter .config=\"", "\" @filterChange=\"", "\"></opencga-date-filter>"]);

  opencga_individual_filter_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_individual_filter_templateObject4() {
  const data = opencga_individual_filter_taggedTemplateLiteral(["<opencga-annotation-filter .opencgaSession=\"", "\"\n                                                      .opencgaClient=\"", "\"\n                                                      entity=\"INDIVIDUAL\"\n                                                      .config=\"", "\"\n                                                      @filterannotation=\"", "\">\n                           </opencga-annotation-filter>"]);

  opencga_individual_filter_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_individual_filter_templateObject3() {
  const data = opencga_individual_filter_taggedTemplateLiteral(["<select-field-filter ?multiple=\"", "\" .data=\"", "\" .value=\"", "\" @filterChange=\"", "\"></select-field-filter>"]);

  opencga_individual_filter_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_individual_filter_templateObject2() {
  const data = opencga_individual_filter_taggedTemplateLiteral(["<text-field-filter placeholder=\"", "\" .value=\"", "\" @filterChange=\"", "\"></text-field-filter>"]);

  opencga_individual_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_individual_filter_templateObject() {
  const data = opencga_individual_filter_taggedTemplateLiteral(["<section-filter .config=\"", "\" .filters=\"", "\">"]);

  opencga_individual_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_individual_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_individual_filter_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_individual_filter_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_individual_filter_ownKeys(Object(source), true).forEach(function (key) { opencga_individual_filter_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_individual_filter_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_individual_filter_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */








class opencga_individual_filter_OpencgaIndividualFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      individuals: {
        type: Array
      },
      query: {
        type: Object
      },
      search: {
        type: Object
      },
      variableSets: {
        type: Array
      },
      variables: {
        type: Array
      },
      minYear: {
        type: Number
      },
      compact: {
        type: Boolean
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    // super.ready();
    this._prefix = "osf-" + utils.randomString(6) + "_";
    this.annotationFilterConfig = {
      class: "small",
      buttonClass: "btn-sm",
      inputClass: "input-sm"
    };
    this.dateFilterConfig = {
      recentDays: 10
    };
    this.minYear = 1920;
    this.query = {};
    this.preparedQuery = {};
    this.searchButton = true;
  }

  connectedCallback() {
    super.connectedCallback();
    this.preparedQuery = opencga_individual_filter_objectSpread({}, this.query); // propagates here the iva-app query object
  }

  updated(changedProperties) {
    if (changedProperties.has("query")) {
      this.queryObserver();
    }

    if (changedProperties.has("variables")) {
      this.variablesChanged();
    }
  }

  onSearch() {
    // this.search = {...this.query};
    this.notifySearch(this.preparedQuery);
  }

  addAnnotation(e) {
    if (typeof this._annotationFilter === "undefined") {
      this._annotationFilter = {};
    }

    const split = e.detail.value.split("=");
    this._annotationFilter[split[0]] = split[1];
    const _query = {};
    Object.assign(_query, this.query);
    const annotations = [];

    for (const key in this._annotationFilter) {
      annotations.push("".concat(key, "=").concat(this._annotationFilter[key]));
    }

    _query["annotation"] = annotations.join(";");
    this._reset = false;
    this.query = _query;
    this._reset = true;
  }

  onDateChanged(e) {
    const query = {};
    Object.assign(query, this.query);

    if (utilsNew_UtilsNew.isNotEmpty(e.detail.date)) {
      query["creationDate"] = e.detail.date;
    } else {
      delete query["creationDate"];
    }

    this._reset = false;
    this.query = _query;
    this._reset = true;
  }

  queryObserver() {
    if (this._reset) {
      console.log("onQueryUpdate: calling to 'renderQueryFilters()'", this.query);
      this.preparedQuery = this.query; // renderQueryFilters shouldn't be necessary anymore
      // this.renderQueryFilters();

      this.requestUpdate();
    } else {
      this._reset = true;
    }
  }
  /**
   * @deprecated
  * */


  renderQueryFilters() {
    // Empty everything before rendering
    this._clearHtmlDom(); // Individual


    if (utilsNew_UtilsNew.isNotUndefined(this.query.id)) {
      PolymerUtils_PolymerUtils.setValue("".concat(this._prefix, "-individual-input"), this.query.id);
    } // Samples


    if (utilsNew_UtilsNew.isNotUndefined(this.query.samples)) {
      PolymerUtils_PolymerUtils.setValue("".concat(this._prefix, "-sample-input"), this.query.samples);
    } // Phenotypes


    if (utilsNew_UtilsNew.isNotUndefined(this.query.phenotypes)) {
      PolymerUtils_PolymerUtils.setValue("".concat(this._prefix, "-phenotypes-input"), this.query.phenotypes);
    } // Ethnicity


    if (utilsNew_UtilsNew.isNotUndefined(this.query.ethnicity)) {
      PolymerUtils_PolymerUtils.setValue("".concat(this._prefix, "-ethnicity-input"), this.query.ethnicity);
    } // Disorder


    if (utilsNew_UtilsNew.isNotUndefined(this.query.disorders)) {
      PolymerUtils_PolymerUtils.setValue("".concat(this._prefix, "-disorder-input"), this.query.disorders);
    } // Sex


    if (utilsNew_UtilsNew.isNotUndefined(this.query.sex)) {
      $("#".concat(this._prefix, "-individual-sex-select")).selectpicker("val", this.query.sex.split(","));
    } // Karyotypic sex


    if (utilsNew_UtilsNew.isNotUndefined(this.query.karyotypicSex)) {
      $("#".concat(this._prefix, "-individual-karyotypicsex-select")).selectpicker("val", this.query.karyotypicSex.split(","));
    } // Affectation status


    if (utilsNew_UtilsNew.isNotUndefined(this.query.affectationStatus)) {
      $("#".concat(this._prefix, "-affectation-status-select")).selectpicker("val", this.query.affectationStatus.split(","));
    } // Life status


    if (utilsNew_UtilsNew.isNotUndefined(this.query.lifeStatus)) {
      $("#".concat(this._prefix, "-life-status-select")).selectpicker("val", this.query.lifeStatus.split(","));
    }
  }

  onFilterChange(key, value) {
    console.log("filterChange", {
      [key]: value
    });

    if (value && value !== "") {
      this.preparedQuery = opencga_individual_filter_objectSpread({}, this.preparedQuery, {}, {
        [key]: value
      });
    } else {
      console.log("deleting", key, "from preparedQuery");
      delete this.preparedQuery[key];
      this.preparedQuery = opencga_individual_filter_objectSpread({}, this.preparedQuery);
    }

    this.notifyQuery(this.preparedQuery);
    this.requestUpdate();
  }

  notifyQuery(query) {
    this.dispatchEvent(new CustomEvent("queryChange", {
      detail: {
        query: query
      },
      bubbles: true,
      composed: true
    }));
  }

  notifySearch(query) {
    this.dispatchEvent(new CustomEvent("querySearch", {
      detail: {
        query: query
      },
      bubbles: true,
      composed: true
    }));
  }

  _createSection(section) {
    const htmlFields = section.fields && section.fields.length && section.fields.map(subsection => this._createSubSection(subsection));
    return this.config.sections.length > 1 ? lit_html_lit_html_html(opencga_individual_filter_templateObject(), section, htmlFields) : htmlFields;
  }

  _createSubSection(subsection) {
    let content = "";

    switch (subsection.id) {
      case "id":
      case "samples":
      case "ethnicity":
      case "disorder":
      case "phenotypes":
        content = lit_html_lit_html_html(opencga_individual_filter_templateObject2(), subsection.placeholder, this.preparedQuery[subsection.id], e => this.onFilterChange(subsection.id, e.detail.value));
        break;

      case "sex":
      case "karyotypicSex":
      case "affectationStatus":
      case "lifeStatus":
        content = lit_html_lit_html_html(opencga_individual_filter_templateObject3(), subsection.multiple, subsection.allowedValues, this.preparedQuery[subsection.id], e => this.onFilterChange(subsection.id, e.detail.value));
        break;

      case "annotations":
        content = lit_html_lit_html_html(opencga_individual_filter_templateObject4(), this.opencgaSession, this.opencgaSession.opencgaClient, this.annotationFilterConfig, this.addAnnotation);
        break;

      case "date":
        content = lit_html_lit_html_html(opencga_individual_filter_templateObject5(), this.dateFilterConfig, e => this.onFilterChange("creationDate", e.detail.value));
        break;

      default:
        console.error("Filter component not found");
    }

    return lit_html_lit_html_html(opencga_individual_filter_templateObject6(), subsection.id, subsection.name, subsection.description ? lit_html_lit_html_html(opencga_individual_filter_templateObject7(), this._prefix, subsection.id) : null, this._prefix, subsection.id, content);
  }
  /**
   * Use custom CSS class to easily reset all controls.
   */


  _clearHtmlDom() {
    // Input controls
    PolymerUtils_PolymerUtils.setPropertyByClassName(this._prefix + "FilterTextInput", "value", "");
    PolymerUtils_PolymerUtils.removeAttributebyclass(this._prefix + "FilterTextInput", "disabled");
    $("#".concat(this._prefix, "IndividualSelection .selectpicker")).selectpicker("val", "");
  }

  render() {
    return lit_html_lit_html_html(opencga_individual_filter_templateObject8(), this.searchButton ? lit_html_lit_html_html(opencga_individual_filter_templateObject9(), this.onSearch) : null, this._prefix, this.config.sections && this.config.sections.length ? this.config.sections.map(section => this._createSection(section)) : lit_html_lit_html_html(opencga_individual_filter_templateObject10()));
  }

}
customElements.define("opencga-individual-filter", opencga_individual_filter_OpencgaIndividualFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/individual/opencga-individual-grid.js
function opencga_individual_grid_templateObject() {
  const data = opencga_individual_grid_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .detail-view :hover {\n                background-color: white;\n            }\n\n            .detail-view-row :hover {\n                background-color: #f5f5f5;\n            }\n\n            .cursor-pointer {\n                cursor: pointer;\n            }\n\n            .phenotypes-link-dropdown:hover .dropdown-menu {\n                display: block;\n            }\n        </style>\n\n        <opencb-grid-toolbar .from=\"", "\"\n                             .to=\"", "\"\n                             .numTotalResultsText=\"", "\"\n                             .config=\"", "\"\n                             @download=\"", "\"\n                             @columnchange=\"", "\">\n        </opencb-grid-toolbar>\n\n        <div id=\"", "GridTableDiv\">\n            <table id=\"", "IndividualBrowserGrid\">\n            </table>\n        </div>\n        "]);

  opencga_individual_grid_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_individual_grid_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_individual_grid_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_individual_grid_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_individual_grid_ownKeys(Object(source), true).forEach(function (key) { opencga_individual_grid_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_individual_grid_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_individual_grid_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */






class opencga_individual_grid_OpencgaIndividualGrid extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      individuals: {
        type: Array
      },
      query: {
        type: Object
      },
      search: {
        type: Object
      },
      active: {
        type: Boolean
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "VarIndividualGrid" + utils.randomString(6);
    this.catalogUiUtils = new CatalogUIUtils_CatalogUIUtils();
    this.active = false;
  }

  firstUpdated(_changedProperties) {// this.renderTable(this.active);
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession") || changedProperties.has("search") || changedProperties.has("config") || changedProperties.has("active")) {
      this.propertyObserver();
    }
  }

  propertyObserver() {
    // With each property change we must updated config and create the columns again. No extra checks are needed.
    this._config = Object.assign(this.getDefaultConfig(), this.config);
    this._columns = this._initTableColumns(); // Config for the grid toolbar

    this.toolbarConfig = {
      columns: this._columns[0]
    };
    this.renderTable(this.active);
  }

  renderTable(active) {
    if (!active) {
      return;
    }

    this.opencgaClient = this.opencgaSession.opencgaClient;
    this.individuals = [];
    const filters = Object.assign({}, this.query); // Initialise the counters

    this.from = 1;
    this.to = this._config.pageSize;

    if (this.opencgaClient && this.opencgaSession.study && this.opencgaSession.study.fqn) {
      filters.study = this.opencgaSession.study.fqn;

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.lastFilters) && JSON.stringify(this.lastFilters) === JSON.stringify(filters)) {
        // Abort destroying and creating again the grid. The filters have not changed
        return;
      } // Store the current filters


      this.lastFilters = opencga_individual_grid_objectSpread({}, filters); // Make a copy of the individuals (if they exist), we will use this private copy until it is assigned to this.individuals

      if (utilsNew_UtilsNew.isNotUndefined(this.individuals)) {
        this._individuals = this.individuals;
      } else {
        this._individuals = [];
      } // Check that HTTP protocol is present and complete the URL

      /* let opencgaHostUrl = this.opencgaClient.getConfig().host;
      if (!opencgaHostUrl.startsWith("http://") && !opencgaHostUrl.startsWith("https://")) {
          opencgaHostUrl = "http://" + opencgaHostUrl;
      }
      opencgaHostUrl += "/webservices/rest/v1/individuals/search";
      */


      let skipCount = false;

      const _table = $("#" + this._prefix + "IndividualBrowserGrid");

      const _this = this;

      $("#" + this._prefix + "IndividualBrowserGrid").bootstrapTable("destroy");
      $("#" + this._prefix + "IndividualBrowserGrid").bootstrapTable({
        // url: opencgaHostUrl,
        columns: _this._columns,
        method: "get",
        sidePagination: "server",
        uniqueId: "id",
        // Table properties
        pagination: _this._config.pagination,
        pageSize: _this._config.pageSize,
        pageList: _this._config.pageList,
        showExport: _this._config.showExport,
        detailView: _this._config.detailView,
        detailFormatter: _this._config.detailFormatter,
        // Make Polymer components avalaible to table formatters
        gridContext: _this,

        /* queryParams: function(params) {
            if (this.pageNumber > 1) {
                skipCount = true;
            }
             let auxParams = {
                sid: Cookies.get(_this.opencgaClient.getConfig().cookieSessionId),
                order: params.order,
                sort: params.sort,
                limit: params.limit,
                skip: params.offset,
                skipCount: skipCount
                // include: "id,creationDate,status,uuid,sex,version,release,father,mother,population,"
                //     + "dateOfBirth,modificationDate,lifeStatus,affectationStatus,phenotypes,samples,"
                //     + "parentalConsanguinity,multiples"
            };
             if (UtilsNew.isUndefined(filters)) {
                filters = {};
            }
            return Object.assign({}, filters, auxParams);
        },*/
        formatLoadingMessage: () => "<div><loading-spinner></loading-spinner></div>",
        ajax: params => {
          if (this.pageNumber > 1) {
            skipCount = true;
          }

          const _filters = opencga_individual_grid_objectSpread({
            // study: this.opencgaSession.study.fqn,
            order: params.data.order,
            limit: params.data.limit,
            skip: params.data.offset || 0,
            skipCount: skipCount
          }, filters);

          this.opencgaSession.opencgaClient.individuals().search(_filters).then(res => params.success(res)).catch(e => console.error(e));
        },
        responseHandler: function responseHandler(response) {
          if (!skipCount) {
            if (!_this.hasOwnProperty("numTotalResults")) {
              _this.numTotalResults = 0;
            }

            if (_this.numTotalResults !== response.getResponse().numTotalResults && response.queryOptions.skip === 0) {
              _this.numTotalResults = response.getResponse().numTotalResults;
            }
          }

          _this.numTotalResultsText = _this.numTotalResults.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

          if (response.getParams().skip === 0 && _this.numTotalResults < response.getParams().limit) {
            _this.from = 1;
            _this.to = _this.numTotalResults;
          }

          _this.requestUpdate(); // it is necessary to refresh numTotalResultsText in opencga-grid-toolbar


          return {
            total: _this.numTotalResults,
            rows: response.getResults()
          };
        },
        onClickRow: function onClickRow(row, element, field) {
          if (_this._config.multiSelection) {
            // Check and uncheck when clicking in the checkbox TD cell
            if (field === "state") {
              const index = element[0].dataset.index;

              if (element[0].className.includes("selected")) {
                $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "IndividualBrowserGrid")).bootstrapTable("uncheck", index);
              } else {
                $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "IndividualBrowserGrid")).bootstrapTable("check", index);
                $(".success").removeClass("success");
                $(element).addClass("success");
              }
            } else {
              // If user has clicked in the row
              const index = element[0].dataset.index;

              if (element[0].className.includes("selected")) {
                $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "IndividualBrowserGrid")).bootstrapTable("uncheck", index);
                $(element).removeClass("success");
              } else {
                $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "IndividualBrowserGrid")).bootstrapTable("check", index);
              }
            }
          } else {
            // If not checkboxes exist
            $(".success").removeClass("success");
            $(element).addClass("success");
          }

          _this._onSelectIndividual(row);
        },
        onDblClickRow: function onDblClickRow(row, element, field) {
          // We detail view is active we expand the row automatically.
          // FIXME: Note that we use a CSS class way of knowing if the row is expand or collapse, this is not ideal but works.
          if (_this._config.detailView) {
            if (element[0].innerHTML.includes("icon-plus")) {
              $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "IndividualBrowserGrid")).bootstrapTable("expandRow", element[0].dataset.index);
            } else {
              $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "IndividualBrowserGrid")).bootstrapTable("collapseRow", element[0].dataset.index);
            }
          }
        },
        onCheck: function onCheck(row, element) {
          // check individual is not already selected
          for (const i in _this._individuals) {
            if (_this._individuals[i].id === row.id) {
              return;
            }
          } // we add individuals to selected individuals
          // _this.push("_individuals", row);
          // _this.set("individuals", _this._individuals.slice());


          _this._individuals.push(row);

          _this.individuals = _this._individuals.slice(); // We only activate the row when checking

          if (_this._config.detailView) {
            $(".success").removeClass("success");
          }

          $(element[0].parentElement.parentElement).addClass("success"); // If exist on single nested sample we must check it

          if (row.samples.length === 1) {
            const checkbox = PolymerUtils_PolymerUtils.getElementById(_this._prefix + row.samples[0].id + "Checkbox");

            if (utilsNew_UtilsNew.isNotUndefinedOrNull(checkbox)) {
              checkbox.checked = true;
            }
          }
        },
        onUncheck: function onUncheck(row, elem) {
          let individualToDeleteIdx = -1;

          for (const i in _this.individuals) {
            if (_this.individuals[i].id === row.id) {
              individualToDeleteIdx = i;
              break;
            }
          }

          if (individualToDeleteIdx === -1) {
            return;
          } // _this.splice("_individuals", individualToDeleteIdx, 1);
          // _this.set("individuals", _this._individuals.slice());


          _this._individuals.splice(individualToDeleteIdx, 1);

          _this.individuals = _this._individuals.slice(); // We detail view is active we expand the row automatically

          if (_this._config.detailView) {
            $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "IndividualBrowserGrid")).bootstrapTable("collapseRow", elem[0].dataset.index);
          } // We must uncheck nested checked samples


          if (row.samples.length > 0) {
            for (const sample of row.samples) {
              const checkbox = PolymerUtils_PolymerUtils.getElementById(_this._prefix + sample.id + "Checkbox");

              if (utilsNew_UtilsNew.isNotUndefinedOrNull(checkbox)) {
                checkbox.checked = false;
              }
            }
          }
        },
        onCheckAll: function onCheckAll(rows) {
          const newIndividuals = _this._individuals.slice(); // check individual is not already selected


          rows.forEach(individual => {
            const existsNewSelected = _this._individuals.some(individualSelected => {
              return individualSelected.id === individual.id;
            });

            if (!existsNewSelected) {
              newIndividuals.push(individual);
            }
          }); // we add individuals to selected individuals

          _this._individuals = newIndividuals; // _this.set("individuals", newIndividuals.slice());

          _this.individuals = newIndividuals.slice(); // We must uncheck nested checked samples

          for (const row of rows) {
            if (row.samples.length === 1) {
              const checkbox = PolymerUtils_PolymerUtils.getElementById(_this._prefix + row.samples[0].id + "Checkbox");

              if (utilsNew_UtilsNew.isNotUndefinedOrNull(checkbox)) {
                checkbox.checked = true;
              }
            }
          }
        },
        onUncheckAll: function onUncheckAll(rows) {
          // check individual is not already selected
          rows.forEach(individual => {
            _this._individuals = _this._individuals.filter(individualSelected => {
              return individualSelected.id !== individual.id;
            });
          }); // we add individuals to selected individuals

          _this.individuals = _this._individuals.slice(); // We must uncheck nested checked samples

          for (const row of rows) {
            for (const sample of row.samples) {
              const checkbox = PolymerUtils_PolymerUtils.getElementById(_this._prefix + sample.id + "Checkbox");

              if (utilsNew_UtilsNew.isNotUndefinedOrNull(checkbox)) {
                checkbox.checked = false;
              }
            }
          }
        },
        onLoadSuccess: function onLoadSuccess(data) {
          // Check all already selected rows. Selected individuals are stored in this.individuals array
          if (utilsNew_UtilsNew.isNotUndefinedOrNull(_table)) {
            if (!_this._config.multiSelection) {
              PolymerUtils_PolymerUtils.querySelector(_table.selector).rows[1].setAttribute("class", "success");

              _this._onSelectIndividual(data.rows[0], "onLoad");
            }

            if (_this.individuals !== "undefined") {
              for (const idx in _this.individuals) {
                for (const j in data.rows) {
                  if (_this.individuals[idx].id === data.rows[j].id) {
                    $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "IndividualBrowserGrid")).bootstrapTable("check", j);
                    break;
                  }
                }
              }
            }
          }
        },
        onPageChange: function onPageChange(page, size) {
          _this.from = (page - 1) * size + 1;
          _this.to = page * size;
        },
        onPostBody: function onPostBody(data) {
          // Add tooltips
          _this.catalogUiUtils.addTooltip("div.phenotypesTooltip", "Phenotypes");
        }
      });
    } else {
      // Delete table
      $(PolymerUtils_PolymerUtils.getElementById(this._prefix + "IndividualBrowserGrid")).bootstrapTable("destroy");
      this.numTotalResults = 0;
    }
  }

  _onSelectIndividual(row, event) {
    console.log("row, event", row, event);

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(row)) {
      if (utilsNew_UtilsNew.isUndefinedOrNull(event) || event !== "onLoad") {
        this.dispatchEvent(new CustomEvent("selectindividual", {
          detail: {
            id: row.id,
            individual: row
          }
        }));
      }
    }
  }

  onColumnChange(e) {
    const table = $("#" + this._prefix + "IndividualBrowserGrid");

    if (e.detail.selected) {
      table.bootstrapTable("showColumn", e.detail.id);
    } else {
      table.bootstrapTable("hideColumn", e.detail.id);
    }
  }

  detailFormatter(value, row) {
    let result = "<div class='row' style=\"padding: 5px 10px 20px 10px\">\n                                <div class='col-md-12'>\n                                    <h5 style=\"font-weight: bold\">Samples</h5>\n                ";

    if (utilsNew_UtilsNew.isNotEmptyArray(row.samples)) {
      let tableCheckboxHeader = "";

      if (this.gridContext._config.multiSelection) {
        tableCheckboxHeader = "<th>Select</th>";
      }

      result += "<div style=\"width: 90%;padding-left: 20px\">\n                                <table class=\"table table-hover table-no-bordered\">\n                                    <thead>\n                                        <tr class=\"table-header\">\n                                            ".concat(tableCheckboxHeader, "\n                                            <th>Sample ID</th>\n                                            <th>Source</th>\n                                            <th>Collection Method</th>\n                                            <th>Preparation Method</th>\n                                            <th>Somatic</th>\n                                            <th>Creation Date</th>\n                                            <th>Status</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>");

      for (const sample of row.samples) {
        let tableCheckboxRow = ""; // If parent row is checked and there is only one samlpe then it must be selected

        if (this.gridContext._config.multiSelection) {
          let checkedStr = "";

          for (const individual of this.gridContext.individuals) {
            if (individual.id === row.id && row.samples.length === 1) {
              // TODO check sampkle has been checked before, we need to store them
              checkedStr = "checked";
              break;
            }
          }

          tableCheckboxRow = "<td><input id='".concat(this.gridContext.prefix).concat(sample.id, "Checkbox' type='checkbox' ").concat(checkedStr, "></td>");
        }

        const source = utilsNew_UtilsNew.isNotEmpty(sample.source) ? sample.source : "-";
        const collectionMethod = sample.collection !== undefined ? sample.collection.method : "-";
        const preparationMethod = sample.processing !== undefined ? sample.processing.preparationMethod : "-";
        const cellLine = sample.somatic ? "Somatic" : "Germline";
        const creationDate = moment(sample.creationDate, "YYYYMMDDHHmmss").format("D MMM YYYY");
        result += "<tr class=\"detail-view-row\">\n                                        ".concat(tableCheckboxRow, "\n                                        <td>").concat(sample.id, "</td>\n                                        <td>").concat(source, "</td>\n                                        <td>").concat(collectionMethod, "</td>\n                                        <td>").concat(preparationMethod, "</td>\n                                        <td>").concat(cellLine, "</td>\n                                        <td>").concat(creationDate, "</td>\n                                        <td>").concat(sample.status.name, "</td>\n                                   </tr>");
      }

      result += "</tbody></table></diV>";
    } else {
      result += "No samples found";
    }

    result += "</div></div>";
    return result;
  } // stateFormatter(value, row, index) {
  // if (this.gridContext !== undefined && typeof this.gridContext.individuals !== "undefined") {
  //     for (let idx in this.gridContext.individuals) {
  //         if (this.gridContext.individuals[idx].name === row.name) {
  //             break;
  //         }
  //     }
  // }
  // }


  sexFormatter(value, row) {
    let sexHtml = "<span>".concat(row.sex, "</span>");

    if (utilsNew_UtilsNew.isNotEmpty(row.karyotypicSex)) {
      sexHtml += " (".concat(row.karyotypicSex, ")");
    }

    return sexHtml;
  }

  fatherFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(row.father) && utilsNew_UtilsNew.isNotEmpty(row.father.id)) {
      return row.father.id;
    } else {
      return "-";
    }
  }

  motherFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(row.mother) && utilsNew_UtilsNew.isNotEmpty(row.mother.id)) {
      return row.mother.id;
    } else {
      return "-";
    }
  }

  disordersFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotEmpty(value)) {
      let disordersHtml = "<div>";

      for (const disorder of value) {
        disordersHtml += "<span>".concat(disorder.id, "</span>");
      }

      disordersHtml += "</div>";
      return disordersHtml;
    } else {
      return "-";
    }
  }

  phenotypesFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotEmptyArray(value)) {
      let phenotypeTooltipText = "";

      for (const phenotype of value) {
        phenotypeTooltipText += "<div style=\"padding: 5px\">";

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(phenotype.source) && phenotype.source.toUpperCase() === "HPO") {
          phenotypeTooltipText += "<span><a target=\"_blank\" href=\"https://hpo.jax.org/app/browse/term/".concat(phenotype.id, "\">").concat(phenotype.id, " </a>(").concat(phenotype.status, ")</span>");
        } else {
          phenotypeTooltipText += "<span>".concat(phenotype.id, " (").concat(phenotype.status, ")</span>");
        }

        phenotypeTooltipText += "</div>";
      }

      const html = "<div class=\"phenotypesTooltip\" data-tooltip-text='".concat(phenotypeTooltipText, "' align=\"center\">\n                                    <a style=\"cursor: pointer\">\n                                        ").concat(value.length, " terms found\n                                    </a>\n                                </div>\n                    ");
      return html;
    } else {
      return "-";
    }
  }

  samplesFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotEmptyArray(row.samples)) {
      let samples = "<div>";

      for (const sample of row.samples) {
        samples += "<div>".concat(sample.id, "</div>");
      }

      samples += "</div>";
      return samples;
    } else {
      return "-";
    }
  }

  customAnnotationFormatter(value, row) {// debugger
  }

  dateFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(value)) {
      return moment(value, "YYYYMMDDHHmmss").format("D MMM YYYY");
    }

    return "-";
  }

  _initTableColumns() {
    // Check column visibility
    const customAnnotationVisible = utilsNew_UtilsNew.isNotUndefinedOrNull(this._config.customAnnotations) && utilsNew_UtilsNew.isNotEmptyArray(this._config.customAnnotations.fields);
    const columns = [];

    if (this._config.multiSelection) {
      columns.push({
        field: "state",
        checkbox: true,
        // formatter: this.stateFormatter,
        class: "cursor-pointer",
        eligible: false
      });
    }

    this._columns = [columns.concat([{
      title: "Individual",
      field: "id",
      sortable: true,
      halign: this._config.header.horizontalAlign
    }, {
      title: "Samples",
      field: "samples",
      formatter: this.samplesFormatter,
      halign: this._config.header.horizontalAlign
    }, {
      title: "Sex",
      field: "sex",
      sortable: true,
      formatter: this.sexFormatter,
      halign: this._config.header.horizontalAlign
    }, {
      title: "Father",
      field: "father.id",
      formatter: this.fatherFormatter,
      halign: this._config.header.horizontalAlign
    }, {
      title: "Mother",
      field: "mother.id",
      formatter: this.motherFormatter,
      halign: this._config.header.horizontalAlign
    }, {
      title: "Disorders",
      field: "disorders",
      formatter: this.disordersFormatter.bind(this),
      halign: this._config.header.horizontalAlign
    }, {
      title: "Phenotypes",
      field: "phenotypes",
      formatter: this.phenotypesFormatter.bind(this),
      halign: this._config.header.horizontalAlign
    }, // {
    //     title: 'Affectation Status',
    //     field: 'affectationStatus',
    //     halign: this._config.header.horizontalAlign
    // },
    {
      title: "Life Status",
      field: "lifeStatus",
      halign: this._config.header.horizontalAlign
    }, {
      title: "Custom Annotations",
      field: "customAnnotation",
      formatter: this.customAnnotationFormatter,
      visible: customAnnotationVisible,
      halign: this._config.header.horizontalAlign
    }, {
      title: "Date of Birth",
      field: "dateOfBirth",
      sortable: true,
      formatter: this.dateFormatter,
      halign: this._config.header.horizontalAlign
    }, {
      title: "Creation Date",
      field: "creationDate",
      sortable: true,
      formatter: this.dateFormatter,
      halign: this._config.header.horizontalAlign
    }, {
      title: "Status",
      field: "status.name",
      halign: this._config.header.horizontalAlign
    }])];
    return this._columns;
  }

  _getUrlQueryParams() {// TODO
  }

  onDownload(e) {
    // let urlQueryParams = this._getUrlQueryParams();
    // let params = urlQueryParams.queryParams;
    // console.log(this.opencgaSession);
    const params = opencga_individual_grid_objectSpread({}, this.query, {
      study: this.opencgaSession.study.fqn,
      sid: this.opencgaSession.opencgaClient._config.sessionId,
      limit: 1000,
      skip: 0,
      includeIndividual: true,
      skipCount: true
    });

    this.opencgaSession.opencgaClient.individuals().search(params).then(response => {
      const result = response.response[0].result;
      console.log(result);
      let dataString = [];
      let mimeType = "";
      let extension = "";

      if (result) {
        // Check if user clicked in Tab or JSON format
        if (e.detail.option.toLowerCase() === "tab") {
          dataString = [["Individual", "Samples", "Sex", "Father", "Mother", "Disorders", "Phenotypes", "Life Status", "Date of Birth", "Creation Date", "Status"].join("\t"), ...result.map(_ => [_.id, _.samples ? _.samples.map(_ => _.id).join(",") : "", _.sex, _.father.id, _.mother.id, _.disorders ? _.disorders.map(_ => _.id).join(",") : "", _.phenotypes ? _.phenotypes.map(_ => _.id).join(",") : "", _.lifeStatus, _.dateOfBirth, _.creationDate, _.status.name].join("\t"))]; // console.log(dataString);

          mimeType = "text/plain";
          extension = ".txt";
        } else {
          for (const res of result) {
            dataString.push(JSON.stringify(res, null, "\t"));
          }

          mimeType = "application/json";
          extension = ".json";
        } // Build file and anchor link


        const data = new Blob([dataString.join("\n")], {
          type: mimeType
        });
        const file = window.URL.createObjectURL(data);
        const a = document.createElement("a");
        a.href = file;
        a.download = this.opencgaSession.study.alias + extension;
        document.body.appendChild(a);
        a.click();
        setTimeout(function () {
          document.body.removeChild(a);
        }, 0);
      } else {
        console.error("Error in result format");
      }
    }).then(function () {// this.downloadRefreshIcon.css("display", "none");
      // this.downloadIcon.css("display", "inline-block");
    });
  }

  getDefaultConfig() {
    return {
      pagination: true,
      pageSize: 10,
      pageList: [10, 25, 50],
      showExport: false,
      detailView: true,
      detailFormatter: this.detailFormatter,
      // function with the detail formatter
      multiSelection: false,
      header: {
        horizontalAlign: "center",
        verticalAlign: "bottom"
      },
      disorderSources: ["ICD", "ICD10", "GelDisorder"],
      customAnnotations: {
        title: "Custom Annotation",
        fields: []
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_individual_grid_templateObject(), this.from, this.to, this.numTotalResultsText, this.toolbarConfig, this.onDownload, this.onColumnChange, this._prefix, this._prefix);
  }

}
customElements.define("opencga-individual-grid", opencga_individual_grid_OpencgaIndividualGrid);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/commons/opencga-facet-view-selector.js
function opencga_facet_view_selector_templateObject3() {
  const data = opencga_facet_view_selector_taggedTemplateLiteral(["\n                                <option data-tokens=\"", "\" data-variable=\"", "\"\n                                        data-id=\"", "\"\n                                        style=\"padding-left: ", "px; cursor: ", ";\"\n                                        .disabled=\"", "\">\n                                    ", "\n                                </option>\n                            "]);

  opencga_facet_view_selector_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_facet_view_selector_templateObject2() {
  const data = opencga_facet_view_selector_taggedTemplateLiteral(["\n                        <optgroup label=\"", "\" style=\"font-size: 1.1em; font-weight: bold\">\n                            ", "\n                        </optgroup>\n                    "]);

  opencga_facet_view_selector_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_facet_view_selector_templateObject() {
  const data = opencga_facet_view_selector_taggedTemplateLiteral(["\n<style include=\"jso-styles\">\n\n            /* Select picker optgroup header */\n            .dropdown-header>span {\n                font-size: 1.2em;\n                font-weight: bold;\n            }\n        </style>\n\n        <div id=\"", "-ofvs\" class=\"form-group row\">\n\n            <div class=\"col-md-7\">\n                <label>Select a Field</label>\n                <select id=\"", "-term-select\" class=\"selectpicker\" data-live-search=\"true\"\n                        .disabled=", " @change=\"", "\">\n                    ", "\n                </select>\n            </div>\n\n            <div class=\"col-md-5\">\n                <label>Include values or set range</label>\n                <div class=\"input-group\">\n                    <input id=\"", "-input\" type=\"text\" class=\"form-control\" value=\"\"\n                           placeholder=\"Include values or range\" @keyup=\"", "\">\n                    <div class=\"input-group-btn\">\n                        <select id=\"", "-value-select\" class=\"selectpicker\" .disabled=", "\n                                @change=\"", "\">\n                            <optgroup label=\"Aggregation Function\">\n                                <option data-value=\"average\">Average</option>\n                                <option data-value=\"percentile\">Percentile</option>\n                            </optgroup>\n                            <option data-divider=\"true\"></option>\n                            <option data-value=\"\" data-id=\"reset\">Reset</option>\n                        </select>\n                    </div>\n                </div>\n                <div>\n                    <span style=\"font-style: italic;color: grey;font-size: 0.9em\">For Terms you can set include values with [], e.g. for chromosome [1,2,3]</span>\n                    <br>\n                    <span style=\"font-style: italic;color: grey;font-size: 0.9em\">For Range facets you can set [start..end]:step, e.g. for sift[0..1]:0.1</span>\n                </div>\n            </div>\n        </div>\n        "]);

  opencga_facet_view_selector_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_facet_view_selector_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

/**
 * @deprecated
 **/


class opencga_facet_view_selector_OpencgaFacetViewSelector extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      terms: {
        type: Array
      },
      variableSets: {
        type: Array
      },
      disabled: {
        type: Boolean
      },
      clear: {
        type: Boolean
      }
    };
  }

  _init() {
    this._prefix = "ofvs-" + utils.randomString(6) + "_";
    this._showInitMessage = true;
    this.facets = new Set();
    this.facetFilters = [];
    this.disabled = false;
    this.clean = false;
  }

  updated(changedProperties) {
    if (changedProperties.has("terms") || changedProperties.has("variableSets")) {
      this.renderSelector();
    }

    if (changedProperties.has("disabled")) {
      this.renderSelector();
    }

    if (changedProperties.has("clear")) {
      this.clearFieldsObserver();
    }
  } // it was connectedCallback()


  firstUpdated(_changedProperties) {
    // Deselect any item selected
    $("#".concat(this._prefix, "-value-select")).selectpicker("val", "");
    $("#".concat(this._prefix, "-term-select")).selectpicker("val", ""); // Remove span with text from one of the select pickers so it only shows the caret and not the text
    //TODO fix?
    //$(`button[data-id=${this._prefix}-value-select]`)[0].firstElementChild.remove();

    console.log($("button[data-id=".concat(this._prefix, "-value-select]")));
  }

  onSelectedItemChange(e) {
    const input = $("#".concat(this._prefix, "-input"))[0];

    if (e.target.id === "".concat(this._prefix, "-value-select")) {
      input.value = e.target.selectedOptions[0].dataset.value;
    } else {
      if (UtilsNew.isNotEmpty(e.target.selectedOptions[0].dataVariable.default)) {
        input.value = e.target.selectedOptions[0].dataVariable.default;
      }
    }

    const term = $("#".concat(this._prefix, "-term-select"))[0].selectedOptions[0];
    this.dispatchEvent(new CustomEvent("variablechange", {
      detail: {
        term: UtilsNew.isNotUndefinedOrNull(term) ? term.dataVariable.tags : "",
        value: input.value
      }
    }));
  }

  onInputTextChange(e) {
    const input = $("#".concat(this._prefix, "-input"))[0]; // Deselect any item selected

    $("#".concat(this._prefix, "-value-select")).selectpicker("val", "");
    const term = $("#".concat(this._prefix, "-term-select"))[0].selectedOptions[0];
    this.dispatchEvent(new CustomEvent("variablechange", {
      detail: {
        term: UtilsNew.isNotUndefinedOrNull(term) ? term.dataVariable.tags : "",
        value: input.value
      }
    }));
  }

  clearFieldsObserver(clear) {
    if (clear) {
      $("#".concat(this._prefix, "-value-select")).selectpicker("val", "");
      $("#".concat(this._prefix, "-term-select")).selectpicker("val", "");
      $("#".concat(this._prefix, "-input"))[0].value = "";
    }
  }

  disabledObserver(disabled) {
    const picker = $("#".concat(this._prefix, "-ofvs .selectpicker"));
    const input = $("#".concat(this._prefix, "-input"))[0];

    if (typeof picker[0] === "undefined") {
      return;
    }

    if (disabled) {
      picker[0].setAttribute("disabled", true);
      picker[1].setAttribute("disabled", true);
      input.setAttribute("disabled", true);
    } else {
      picker[0].removeAttribute("disabled");
      picker[1].removeAttribute("disabled");
      input.removeAttribute("disabled");
    }

    picker.selectpicker("refresh");
  }

  applyRenderFilters(fields) {
    if (UtilsNew.isUndefinedOrNull(fields) || fields.length === 0) {
      return fields;
    }

    const myFields = [];

    for (let i = 0; i < fields.length; i++) {
      const field = Object.assign({}, fields[i]);
      field["disabled"] = false;
      field["margin"] = 25;
      field["cursor"] = "pointer";
      field["tags"] = field.id;
      myFields.push(field);
    }

    return myFields;
  }

  renderSelector(fields, variableSets) {
    const myFields = this.applyRenderFilters(fields);
    const showTerms = [];
    showTerms.push({
      name: "Data model",
      values: myFields
    });

    if (typeof variableSets !== "undefined" && variableSets.length > 0) {
      for (let i = 0; i < variableSets.length; i++) {
        showTerms.push({
          name: variableSets[i].id,
          values: CatalogUIUtils.parseVariableSetVariablesForDisplay(variableSets[i].variables, ["annotation"], 25)
        });
      }
    }

    this.showTerms = showTerms;
  }

  render() {
    return lit_html_lit_html_html(opencga_facet_view_selector_templateObject(), this.prefix, this.prefix, this.disabled, this.onSelectedItemChange, this.showTerms && this.showTerms.length && this.showTerms.map(optterm => lit_html_lit_html_html(opencga_facet_view_selector_templateObject2(), optterm.name, optterm.values && optterm.values.length && optterm.values.map(term => lit_html_lit_html_html(opencga_facet_view_selector_templateObject3(), term.tags, term, term.id, term.margin, term.cursor, term.disabled, term.name)))), this.prefix, this.onInputTextChange, this.prefix, this.disabled, this.onSelectedItemChange);
  }

}
customElements.define("opencga-facet-view-selector", opencga_facet_view_selector_OpencgaFacetViewSelector);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/commons/opencga-facet-view.js
function opencga_facet_view_templateObject6() {
  const data = opencga_facet_view_taggedTemplateLiteral(["\n                    <div style=\"padding: 20px\">\n                        <h4>", "</h4>\n                        <opencga-facet-result-view .facetResult=\"", "\" .config=\"", "\"></opencga-facet-result-view>\n                    </div>\n                "]);

  opencga_facet_view_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_facet_view_templateObject5() {
  const data = opencga_facet_view_taggedTemplateLiteral(["\n                    <h4 style=\"padding-left: 20px\">No aggregation fields selected.</h4>\n                "]);

  opencga_facet_view_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_facet_view_templateObject4() {
  const data = opencga_facet_view_taggedTemplateLiteral(["\n                                    <button type=\"button\" class=\"btn btn-warning btn-sm ", "\" data-facet=\"", "\" @click=\"", "\"\n                                        @mouseover=\"", "\" @mouseout=\"", "\">\n                                            ", "\n                                    </button>\n                               "]);

  opencga_facet_view_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_facet_view_templateObject3() {
  const data = opencga_facet_view_taggedTemplateLiteral(["\n                                <span style=\"font-weight: bold; padding-right: 10px\">Selected Aggregation Fields:</span>\n                                ", "\n                               \n                            "]);

  opencga_facet_view_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_facet_view_templateObject2() {
  const data = opencga_facet_view_taggedTemplateLiteral(["\n                            <h4 style=\"padding-top: 5px\">Default Aggregation Stats</h4>\n                            <span style=\"padding-left: 10px\">Add default aggregation stats</span>\n                            <span style=\"padding-left: 10px\">\n                                <button type=\"button\" class=\"btn btn-primary\" @click=\"", "\">Add</button>\n                            </span>\n                            "]);

  opencga_facet_view_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_facet_view_templateObject() {
  const data = opencga_facet_view_taggedTemplateLiteral(["\n            <style include=\"jso-styles\">\n                option:disabled {\n                    font-size: 0.85em;\n                    font-weight: bold;\n                }\n    \n                .active-filter-button:hover {\n                    text-decoration: line-through;\n                }\n            </style>\n    \n            <!-- Facet Fields -->\n            <div class=\"row\" style=\"padding: 0px 15px\">\n                <div class=\"col-md-12 panel panel-default\">\n                    <h3>Select Aggregation Stats</h3>\n    \n                    <div class=\"col-md-12\">\n                        ", "\n                    </div>\n    \n                    <div class=\"col-md-12\">\n                        <h4 style=\"padding: 20px 0px 5px 0px\">Select Custom Aggregation Fields</h4>\n    \n                        <div class=\"row\">\n                            <div class=\"col-md-5\" style=\"padding: 0px 30px 0px 10px\">\n                                <opencga-facet-view-selector id=\"", "-ofvs-first\" .terms=\"", "\" .variableSets=\"", "\"\n                                                             @variablechange=\"", "\" .clear=\"", "\">\n                                </opencga-facet-view-selector>\n                            </div>\n                            <div class=\"col-md-5\" style=\"padding: 0px 10px 0px 30px\">\n                                <opencga-facet-view-selector id=\"", "-ofvs-nested\" .terms=\"", "\" .variableSets=\"", "\"\n                                                             @variablechange=\"", "\" .clear=\"", "\"\n                                                             ?disabled=\"", "\">\n                                </opencga-facet-view-selector>\n                            </div>\n    \n                            <div class=\"col-md-1 col-md-offset-1\" style=\"padding-top: 25px\">\n                                <button type=\"button\" class=\"btn btn-primary\" @click=\"", "\" style=\"cursor: pointer\">Add</button>\n                            </div>\n                        </div>\n                    </div>\n    \n                    <div class=\"col-md-12\">\n                        <div style=\"padding: 35px 10px 15px 25px\">\n                            ", "\n                                \n                        </div>\n                    </div>\n    \n                    <div class=\"col-md-10 col-md-offset-2\">\n                        <div style=\"float: right; padding: 10px\">\n                            <button type=\"button\" class=\"btn btn-primary btn-lg\" @click=\"", "\">Run</button>\n                        </div>\n    \n                        <div style=\"float: right; padding: 10px\">\n                            <button type=\"button\" class=\"btn btn-primary btn-lg\" @click=\"", "\">Clear</button>\n                        </div>\n                    </div>\n                </div>\n    \n                <!-- RESULTS - Facet Plots -->\n                <h3>Results</h3>\n                ", "\n    \n                <div id=\"facetResultsDiv\">\n                ", "\n                </div>\n                \n            </div>\n    \n            <div class=\"modal fade\" id=\"", "LoadingModal\" data-backdrop=\"static\" data-keyboard=\"false\" tabindex=\"-1\"\n                 role=\"dialog\" aria-hidden=\"true\" style=\"padding-top:15%; overflow-y:visible;\">\n                <div class=\"modal-dialog\">\n                    <div class=\"modal-content\">\n                        <div class=\"modal-header\">\n                            <h3>Loading ...</h3>\n                        </div>\n                        <div class=\"modal-body\">\n                            <div class=\"progress progress-striped active\">\n                                <div class=\"progress-bar progress-bar-success\" style=\"width: 100%\"></div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        "]);

  opencga_facet_view_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_facet_view_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */






/**
 * @deprecated
 * */

class opencga_facet_view_OpencgaFacetView extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      variableSets: {
        type: Array
      },
      entity: {
        type: String
      },
      query: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "facet" + utils.randomString(6) + "_";
    this.disableNestedSelector = false;
    this._showInitMessage = true;
    this.facets = new Set();
    this.facetFilters = [];
    this._firstVariable = {};
    this._secondVariable = {};
    this.variableSets = [];
    this.query = {};
  }

  updated(changedProperties) {
    if (changedProperties.has("variableSets") || changedProperties.has("entity") || changedProperties.has("query") || changedProperties.has("config")) {
      this.renderFacetView();
    }
  }

  renderFacetView(variableSets, entity, query, config) {
    this._config = Object.assign(this.getDefaultConfig(), this.config);
    this.dataModelTerms = this.getDataModelTerms(this.entity); // Take variableSets from the opencgaSession if it has not been passed

    if (utilsNew_UtilsNew.isUndefinedOrNull(this.variableSets) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.study) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.study.variableSets)) {
      this.variableSets = this.opencgaSession.study.variableSets;
    }
  }

  onVariableSelectedChange(e) {
    if (e.target.id === "".concat(this._prefix, "-ofvs-first")) {
      if (e.detail.value === "average" || e.detail.value === "percentile") {
        this.disableNestedSelector = true;
      } else {
        this.disableNestedSelector = false;
      }

      this._firstVariable = e.detail;
    } else {
      this._secondVariable = e.detail;
    }
  }

  getDataModelTerms(entity) {
    let catalogCommon = [{
      id: "creationYear",
      name: "Creation year"
    }, {
      id: "creationMonth",
      name: "Creation month"
    }, {
      id: "creationDay",
      name: "Creation day"
    }, {
      id: "creationDayOfWeek",
      name: "Creation day of week"
    }, {
      id: "status",
      name: "Status"
    }, {
      id: "release",
      name: "Release"
    }];

    switch (entity) {
      case "COHORT":
        return catalogCommon.concat([{
          id: "type",
          name: "Type"
        }, {
          id: "numSamples",
          name: "Number of samples"
        }]);

      case "FILE":
        return catalogCommon.concat([{
          id: "name",
          name: "Name"
        }, {
          id: "type",
          name: "Type"
        }, {
          id: "format",
          name: "Format"
        }, {
          id: "bioformat",
          name: "Bioformat"
        }, {
          id: "external",
          name: "External"
        }, {
          id: "size",
          name: "Size"
        }, {
          id: "numSamples",
          name: "Number of samples"
        }, {
          id: "numRelatedFiles",
          name: "Number of related files"
        }]);

      case "SAMPLE":
        return catalogCommon.concat([{
          id: "somatic",
          name: "Somatic"
        }, {
          id: "version",
          name: "Version"
        }]);

      case "INDIVIDUAL":
        return catalogCommon.concat([{
          id: "hasFather",
          name: "Has father"
        }, {
          id: "hasMother",
          name: "Has mother"
        }, {
          id: "numMultiples",
          name: "Number of multiples"
        }, {
          id: "multiplesType",
          name: "Multiples type"
        }, {
          id: "sex",
          name: "Sex"
        }, {
          id: "karyotypicSex",
          name: "Karyotypic sex"
        }, {
          id: "version",
          name: "Version"
        }, {
          id: "lifeStatus",
          name: "Life status"
        }, {
          id: "affectationStatus",
          name: "Affectation status"
        }, {
          id: "numSamples",
          name: "Number of samples"
        }, {
          id: "parentalConsanguinity",
          name: "Parental consanguinity"
        }]);

      case "FAMILY":
        return catalogCommon.concat([{
          id: "phenotypes",
          name: "Phenotypes"
        }, {
          id: "numMembers",
          name: "Number of members"
        }, {
          id: "expectedSize",
          name: "Expected size"
        }, {
          id: "version",
          name: "Version"
        }]);

      default:
        return [{}];
    }
  }

  getOpencgaClient(entity) {
    switch (entity) {
      case "COHORT":
        return this.opencgaSession.opencgaClient.cohorts();

      case "FILE":
        return this.opencgaSession.opencgaClient.files();

      case "SAMPLE":
        return this.opencgaSession.opencgaClient.samples();

      case "INDIVIDUAL":
        return this.opencgaSession.opencgaClient.individuals();

      case "FAMILY":
        return this.opencgaSession.opencgaClient.families();

      default:
        return [{}];
    }
  }
  /**
   * Apply the 'config' properties on the default
   */


  configObserver() {
    this._config = Object.assign(this.getDefaultConfig(), this.config);
  }

  onFacetFieldChange(e) {
    if (e.target.selectedOptions[0].dataset.range !== undefined) {
      PolymerUtils_PolymerUtils.setValue(this._prefix + "FacetFieldIncludes", e.target.selectedOptions[0].dataset.range);
    } else {
      PolymerUtils_PolymerUtils.setValue(this._prefix + "FacetFieldIncludes", "");
    }
  }

  onNestedFacetFieldChange(e) {
    if (e.target.selectedOptions[0].dataset.range !== undefined) {
      PolymerUtils_PolymerUtils.setValue(this._prefix + "NestedFacetFieldIncludes", e.target.selectedOptions[0].dataset.range);
    } else {
      PolymerUtils_PolymerUtils.setValue(this._prefix + "NestedFacetFieldIncludes", "");
    }
  }

  onClear() {
    this.query = {};
    this.search = {};
  }

  onFilterChange(e) {
    this.query = e.detail;
    this.search = e.detail;
  }

  _onMouseOver(e) {
    PolymerUtils_PolymerUtils.addStyleByClass(e.target.dataset.facet, "text-decoration", "line-through");
  }

  _onMouseOut(e) {
    PolymerUtils_PolymerUtils.addStyleByClass(e.target.dataset.facet, "text-decoration", "none");
  }

  _isAggregationFunction(value) {
    return value === "percentile" || value === "average";
  }

  addDefaultStats(e) {
    for (let i = 0; i < this._config.defaultStats.length; i++) {
      this.facets.add(this._config.defaultStats[i]);
    }

    this.facetFilters = Array.from(this.facets);
    this.requestUpdate();
  }

  addFacet(e) {
    let facetField = this._firstVariable.term;

    if (utilsNew_UtilsNew.isNotEmpty(facetField)) {
      let facetFieldIncludes = this._firstVariable.value;
      let facet;

      if (this._isAggregationFunction(facetFieldIncludes)) {
        facet = "".concat(facetFieldIncludes, "(").concat(facetField, ")");
      } else {
        facet = facetField + facetFieldIncludes;
      }

      let nestedFacetField = this._secondVariable.term;

      if (!this.disableNestedSelector && utilsNew_UtilsNew.isNotEmpty(nestedFacetField)) {
        let nestedFacetFieldIncludes = this._secondVariable.value;
        let nestedFacet;

        if (this._isAggregationFunction(nestedFacetFieldIncludes)) {
          nestedFacet = "".concat(nestedFacetFieldIncludes, "(").concat(nestedFacetField, ")");
        } else {
          nestedFacet = nestedFacetField + nestedFacetFieldIncludes;
        }

        facet += ">>" + nestedFacet;
      } // Add facet


      this.facets.add(facet);
      this.facetFilters = Array.from(this.facets); // Clear form controls

      this.clearSelectedOptions = true;
      this.clearSelectedOptions = false;
      this._firstVariable = {};
      this._secondVariable = {};
    }
  }

  removeFacet(e) {
    this.facets.delete(e.target.dataset.facet);
    this.facetFilters = Array.from(this.facets);
    this.requestUpdate();
  }

  fetchData() {
    let client = this.getOpencgaClient(this.entity);

    if (utilsNew_UtilsNew.isUndefinedOrNull(client)) {
      console.log("opencgaClient is null or undefined");
      return;
    }

    if (this.facets.size === 0) {
      alert("No facets selected.");
      return;
    }

    this.clearPlots(); // Shows loading modal

    $(PolymerUtils_PolymerUtils.getElementById(this._prefix + "LoadingModal")).modal("show"); // Join 'query' from left menu and facet filters

    let queryParams = Object.assign(this.query, {
      // sid: this.opencgaClient._config.sessionId,
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias,
      timeout: 60000,
      field: this.facetFilters.join(";")
    });

    let _this = this;

    setTimeout(() => {
      client.stats(queryParams, {}).then(function (queryResponse) {
        // let response = queryResponse.response[0].result[0].result;
        _this.facetResults = queryResponse.response[0].result[0].results; // Remove loading modal

        $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "LoadingModal")).modal("hide");
        _this._showInitMessage = false;
      }).catch(function (e) {
        console.log(e); // Remove loading modal

        $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "LoadingModal")).modal("hide");
        _this._showInitMessage = false;
      });
    }, 250);
  }

  clearPlots() {
    this.facetResults = [];
  }

  clearAll() {
    this.clearPlots();
    this.facets = new Set();
    this.facetFilters = [];
    this._showInitMessage = true;
    this.clearSelectedOptions = true;
    this.clearSelectedOptions = false;
  }

  isNotEmpty(myArray) {
    return typeof myArray !== "undefined" && myArray.length > 0;
  }

  getDefaultConfig() {
    return {
      defaultStats: ["creationYear>>creationMonth"]
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_facet_view_templateObject(), this._config && this._config.defaultStats && this._config.defaultStats.length ? lit_html_lit_html_html(opencga_facet_view_templateObject2(), this.addDefaultStats) : null, this._prefix, this.dataModelTerms, this.variableSets, this.onVariableSelectedChange, this.clearSelectedOptions, this._prefix, this.dataModelTerms, this.variableSets, this.onVariableSelectedChange, this.clearSelectedOptions, this.disableNestedSelector, this.addFacet, this.facetFilters.length ? lit_html_lit_html_html(opencga_facet_view_templateObject3(), this.facetFilters.map(item => lit_html_lit_html_html(opencga_facet_view_templateObject4(), item, item, this.removeFacet, this._onMouseOver, this._onMouseOut, item))) : null, this.fetchData, this.clearAll, this._showInitMessage ? lit_html_lit_html_html(opencga_facet_view_templateObject5()) : null, this.facetResults && this.facetResults.length && this.facetResults.map(item => lit_html_lit_html_html(opencga_facet_view_templateObject6(), item.name, item, this._config.result)), this._prefix);
  }

}
customElements.define("opencga-facet-view", opencga_facet_view_OpencgaFacetView);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/individual/opencga-individual-browser.js
function opencga_individual_browser_templateObject2() {
  const data = opencga_individual_browser_taggedTemplateLiteral(["\n            <div class=\"page-title\">\n                <h2>\n                    <i class=\"fa fa-users\" aria-hidden=\"true\"></i> </i>&nbsp;", "\n                </h2>\n            </div>\n        "]);

  opencga_individual_browser_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_individual_browser_templateObject() {
  const data = opencga_individual_browser_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .icon-padding {\n                padding-left: 4px;\n                padding-right: 5px;\n            }\n\n            .detail-tab-title {\n                font-size: 115%;\n                font-weight: bold;\n            }\n        </style>\n\n        ", "\n        \n        <div class=\"row\" style=\"padding: 0px 10px\">\n            <div class=\"col-md-2\">\n                <opencga-individual-filter  .opencgaSession=\"", "\"\n                                            .config=\"", "\"\n                                            .individuals=\"", "\"\n                                            .opencgaClient=\"", "\"\n                                            .query=\"", "\"\n                                            .search=\"", "\"\n                                            @queryChange=\"", "\"\n                                            @querySearch=\"", "\">\n                </opencga-individual-filter>\n            </div>\n\n            <div class=\"col-md-10\">\n                <opencga-active-filters .opencgaSession=\"", "\"\n                                        .query=\"", "\"\n                                        .refresh=\"", "\"\n                                        .defaultStudy=\"", "\"\n                                        .config=\"", "\"\n                                        .alias=\"", "\"\n                                        @activeFilterClear=\"", "\"\n                                        @activeFilterChange=\"", "\">\n                </opencga-active-filters>\n\n                <!-- Individual View Buttons -->\n                <div class=\"col-md-12\" style=\"padding: 5px 0px 5px 0px\">\n                    <div class=\"btn-toolbar\" role=\"toolbar\" aria-label=\"...\" style=\"padding: 10px 0px;margin-left: 0px\">\n                        <div class=\"btn-group\" role=\"group\" style=\"margin-left: 0px\">\n                            <button type=\"button\" class=\"btn btn-success individual-browser-view-buttons ripple active\" data-view=\"TableResult\" @click=\"", "\" data-id=\"table\">\n                                <i class=\"fa fa-table icon-padding\" aria-hidden=\"true\" data-view=\"TableResult\" @click=\"", "\" data-id=\"table\"></i> Table Result\n                            </button>\n                            <button type=\"button\" class=\"btn btn-success individual-browser-view-buttons ripple\" data-view=\"Summary\" @click=\"", "\" ?disabled=\"", "\">\n                                <i class=\"fas fa-chart-bar icon-padding\" aria-hidden=\"true\" data-view=\"Summary\" @click=\"", "\"></i> Summary Stats\n                            </button>\n                            <button type=\"button\" class=\"btn btn-success individual-browser-view-buttons ripple\" data-view=\"IndividualComparator\" @click=\"", "\" data-id=\"comparator\" ?disabled=\"", "\">\n                                <i class=\"fa fa-users icon-padding\" aria-hidden=\"true\" data-view=\"IndividualComparator\" @click=\"", "\" data-id=\"comparator\"></i> Individual Comparator\n                            </button>\n                        </div>\n                    </div>\n                </div>\n\n\n                <!-- Individual View Content -->\n                <div>\n                    <div id=\"", "TableResult\" class=\"individual-browser-view-content\">\n                        <opencga-individual-grid .opencgaClient=\"", "\"\n                                                 .opencgaSession=\"", "\"\n                                                 .query=\"", "\"\n                                                 .search=\"", "\"\n                                                 .config=\"", "\"\n                                                 .eventNotifyName=\"", "\"\n                                                 .individuals=\"", "\"\n                                                 .active=\"", "\"\n                                                 style=\"font-size: 12px\"\n                                                 @selectindividual=\"", "\">\n                        </opencga-individual-grid>\n\n                        <!--<div style=\"padding-top: 5px\">-->\n                            <!--<ul id=\"", "ViewTabs\" class=\"nav nav-tabs\" role=\"tablist\">-->\n                                <!--<li role=\"presentation\" class=\"active\">-->\n                                    <!--<a href=\"#", "IndividualViewer\" role=\"tab\" data-toggle=\"tab\" class=\"detail-tab-title\"-->\n                                       <!--data-id=\"info\" on-click=\"_changeBottomTab\">-->\n                                        <!--Individual Info-->\n                                    <!--</a>-->\n                                <!--</li>-->\n\n                                <!--<li role=\"presentation\">-->\n                                    <!--<a href=\"#", "FamilyViewer\" role=\"tab\" data-toggle=\"tab\" class=\"detail-tab-title\"-->\n                                       <!--data-id=\"familyGrid\" on-click=\"_changeBottomTab\">-->\n                                        <!--Family-->\n                                    <!--</a>-->\n                                <!--</li>-->\n                            <!--</ul>-->\n\n                            <!--<div class=\"tab-content\" style=\"height: 680px\">-->\n                                <!--<div role=\"tabpanel\" class=\"tab-pane active\" id=\"", "CohortViewer\">-->\n                                    <!--Work in progress:  {{individual.id}}-->\n                                <!--</div>-->\n                                <!--<div role=\"tabpanel\" class=\"tab-pane\" id=\"", "FamilyViewer\">-->\n                                    <!--Work in progress:  {{individual.id}}-->\n                                    <!--&lt;!&ndash;<opencga-sample-grid opencga-client=\"{{opencgaSession.opencgaClient}}\"&ndash;&gt;-->\n                                                         <!--&lt;!&ndash;opencga-session=\"{{opencgaSession}}\" search=\"{{sampleSearch}}\"&ndash;&gt;-->\n                                                         <!--&lt;!&ndash;style=\"font-size: 12px\" active=\"{{detailActiveTabs.sampleGrid}}\">&ndash;&gt;-->\n                                    <!--&lt;!&ndash;</opencga-sample-grid>&ndash;&gt;-->\n                                <!--</div>-->\n\n                            <!--</div>-->\n                        <!--</div>-->\n                    </div>\n\n                    <div id=\"", "Summary\" class=\"individual-browser-view-content\" style=\"display: none\">\n                        <opencb-facet-query resource=\"individuals\"\n                                            .opencgaSession=\"", "\"\n                                            .cellbaseClient=\"", "\"  \n                                            .config=\"", "\"\n                                            .query=\"", "\"\n                                            .active=\"", "\">\n                    </div>\n\n                    <div id=\"", "IndividualComparator\" class=\"individual-browser-view-content\" style=\"display: none\">\n                        <opencga-individual-grid .opencgaClient=\"", "\"\n                                                 .opencgaSession=\"", "\"\n                                                 .config=\"", "\"\n                                                 .eventNotifyName=\"", "\"\n                                                 .individuals=\"", "\"\n                                                 .search=\"", "\" style=\"font-size: 12px\"\n                                                 .active=\"", "\">\n                        </opencga-individual-grid>\n\n                        <div style=\"padding-top: 5px\">\n                            <h3> Annotation comparator</h3>\n                            <opencga-annotation-viewer .opencgaClient=\"", "\"\n                                                       .opencgaSession=\"", "\"\n                                                       .config=\"", "\"\n                                                       .entryIds=\"", "\"\n                                                       entity=\"INDIVIDUAL\">\n                            </opencga-annotation-viewer>\n                        </div>\n\n                    </div>\n                </div>\n\n            </div>\n        </div>\n        "]);

  opencga_individual_browser_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_individual_browser_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_individual_browser_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_individual_browser_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_individual_browser_ownKeys(Object(source), true).forEach(function (key) { opencga_individual_browser_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_individual_browser_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_individual_browser_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */








class opencga_individual_browser_OpencgaIndividualBrowser extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      filters: {
        type: Object //notify: true

      },
      search: {
        type: Object //notify: true

      },
      config: {
        type: Object
      },
      query: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "osb-" + utils.randomString(6) + "_";
    this.individuals = [];
    this._config = this.getDefaultConfig();
    this.filtersConfig = {
      complexFields: ["annotation"]
    };
    this.activeMenu = {
      table: true,
      comparator: false
    };
    this.detailActiveTabs = {
      info: true,
      familyGrid: false
    };
    this.query = {};
  }

  firstUpdated(_changedProperties) {}

  updated(changedProperties) {
    if (changedProperties.has("opencgaClient")) {//this.renderAnalysisTable(); TODO it doesn't exist
    }

    if (changedProperties.has("filters")) {
      this.onFilterUpdate();
    }

    if (changedProperties.has("config")) {
      this.configObserver();
    }

    if (changedProperties.has("opencgaSession") || changedProperties.has("config")) {
      this.filterAvailableVariableSets(this.opencgaSession, this.config);
    }

    if (changedProperties.has("individuals")) {
      this.individualObserver();
    }

    if (changedProperties.has("query")) {
      this.queryObserver();
    }
  }
  /*    static get observers() {
      return ['filterAvailableVariableSets(opencgaSession, config)', 'individualObserver(individuals.*)'];
  }*/


  configObserver() {
    this._config = Object.assign(this.getDefaultConfig(), this.config);
  }

  queryObserver() {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query)) {
      this.preparedQuery = opencga_individual_browser_objectSpread({}, this.query);
      this.executedQuery = opencga_individual_browser_objectSpread({}, this.query);
    }

    this.requestUpdate();
  }

  individualObserver() {
    this.dispatchEvent(new CustomEvent("individualchange", {
      detail: {
        individuals: this.individuals
      },
      bubbles: true,
      composed: true
    }));
  }

  onClear() {
    this._config = Object.assign(this.getDefaultConfig(), this.config);
    this.query = {}; // this.query = {studies: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias};

    this.search = {};
  }

  onSelectIndividual(e) {
    this.individual = e.detail.individual;
    const sampleList = [];

    for (let i = 0; i < this.individual.samples.length; i++) {
      sampleList.push(this.individual.samples[i].id);
    }

    this.sampleSearch = {
      id: sampleList.join(",")
    };
    this.dispatchEvent(new CustomEvent("selectindividual", {
      detail: {
        individual: this.individual
      }
    }));
  }

  _changeBottomTab(e) {
    const _activeTabs = {
      info: e.currentTarget.dataset.id === "info",
      familyGrid: e.currentTarget.dataset.id === "familyGrid"
    }; //this.set("detailActiveTabs", _activeTabs);

    this.detailActiveTabs = _activeTabs;
  }

  _changeView(e) {
    e.preventDefault(); // prevents the hash change to "#" and allows to manipulate the hash fragment as needed

    const activeMenu = {
      table: e.currentTarget.dataset.id === "table",
      comparator: e.currentTarget.dataset.id === "comparator"
    }; //this.set("activeMenu", activeMenu);

    this.activeMenu = activeMenu;
    $(".individual-browser-view-content").hide(); // hides all content divs

    if (typeof e.target !== "undefined" && typeof e.target.dataset.view !== "undefined") {
      PolymerUtils_PolymerUtils.show(this._prefix + e.target.dataset.view);
    } // Show the active button


    $(".individual-browser-view-buttons").removeClass("active");
    $(e.target).addClass("active");

    if (e.target.dataset.view === "Summary") {
      this.SummaryActive = true;
      this.requestUpdate();
    } else {
      this.SummaryActive = false;
    }

    this.requestUpdate();
  }

  filterAvailableVariableSets(opencgaSession, config) {
    if (this._config.variableSetIds.length === 0 && utilsNew_UtilsNew.isNotUndefinedOrNull(opencgaSession.study)) {
      this.variableSets = opencgaSession.study.variableSets;
    } else {
      const variableSets = [];

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(opencgaSession.study) && utilsNew_UtilsNew.isNotEmptyArray(opencgaSession.study.variableSets)) {
        for (let i = 0; i < opencgaSession.study.variableSets.length; i++) {
          if (this._config.variableSetIds.indexOf(opencgaSession.study.variableSets[i].id) !== -1) {
            variableSets.push(opencgaSession.study.variableSets[i]);
          }
        }
      }

      this.variableSets = variableSets;
    }
  }

  executeFacet() {}

  onQueryFilterChange(e) {
    this.preparedQuery = e.detail.query;
    this.requestUpdate();
  }

  onQueryFilterSearch(e) {
    this.preparedQuery = e.detail.query;
    this.executedQuery = e.detail.query;
    this.requestUpdate();
  }

  onActiveFilterChange(e) {
    console.warn("onActiveFilterChange", e.detail);
    this.preparedQuery = opencga_individual_browser_objectSpread({}, e.detail);
    this.query = opencga_individual_browser_objectSpread({}, e.detail);
    this.requestUpdate();
  }

  onActiveFilterClear() {
    this.query = {}; //this.search = {};

    this.preparedQuery = {};
    this.requestUpdate();
  }

  getDefaultConfig() {
    return {
      title: "Individual Browser",
      showTitle: true,
      showAggregationStats: true,
      showComparator: true,
      filter: {},
      grid: {
        pageSize: 10,
        pageList: [10, 25, 50],
        detailView: true,
        multiSelection: false
      },
      gridComparator: {
        pageSize: 5,
        pageList: [5, 10],
        detailView: true,
        multiSelection: true
      },
      individualDetail: {
        showTitle: false
      },
      variableSetIds: [],
      summary: {
        fields: ["type", "format", "bioformat"]
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_individual_browser_templateObject(), this._config.showTitle ? lit_html_lit_html_html(opencga_individual_browser_templateObject2(), this._config.title) : null, this.opencgaSession, this._config.filter, this.individuals, this.opencgaSession.opencgaClient, this.query, this.search, this.onQueryFilterChange, this.onQueryFilterSearch, this.opencgaSession, this.preparedQuery, this.executedQuery, this.opencgaSession.study.alias, this.filtersConfig, this.activeFilterAlias, this.onActiveFilterClear, this.onActiveFilterChange, this._changeView, this._changeView, this._changeView, !this._config.showAggregationStats, this._changeView, this._changeView, !this._config.showComparator, this._changeView, this._prefix, this.opencgaSession.opencgaClient, this.opencgaSession, this.executedQuery, this.executedQuery, this._config.grid, this.eventNotifyName, this.individuals, this.activeMenu.table, this.onSelectIndividual, this._prefix, this._prefix, this._prefix, this._prefix, this._prefix, this._prefix, this.opencgaSession, this.cellbaseClient, this._config, this.executedQuery, this.SummaryActive, this._prefix, this.opencgaSession.opencgaClient, this.opencgaSession, this._config.gridComparator, this.eventNotifyName, this.individuals, this.search, this.activeMenu.comparator, this.opencgaSession.opencgaClient, this.opencgaSession, this._config, this.individuals);
  }

}
customElements.define("opencga-individual-browser", opencga_individual_browser_OpencgaIndividualBrowser);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/family/opencga-family-editor.js
function opencga_family_editor_templateObject3() {
  const data = opencga_family_editor_taggedTemplateLiteral(["\n                        <span style=\"color: white; border-radius: 5px; padding: 4px; width: fit-content; display: inline-block;\n                            margin: 2px 0px; background: #ffb42b; border: 1px solid orange\">", "</span>\n                    "]);

  opencga_family_editor_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_family_editor_templateObject2() {
  const data = opencga_family_editor_taggedTemplateLiteral(["\n                            <tr class=\"detail-view-row\">\n                                <td>", "</td>\n                                <td>", "</td>\n                                <td>", "</td>\n                                <td>", "</td>\n                                <td>", "</td>\n                                <td>", "</td>\n                                <td>", "</td>\n                                <td>", "</td>\n                                <td>", "</td>\n                                <td>\n                                    <button type=\"button\" class=\"btn btn-xs btn-danger\" data-id=\"", "\"\n                                            @click=\"", "\">\n                                        <i class=\"fa fa-trash fa-lg\"> </i>\n                                        Remove\n                                    </button>\n                                </td>\n                            </tr>\n\n                        "]);

  opencga_family_editor_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_family_editor_templateObject() {
  const data = opencga_family_editor_taggedTemplateLiteral(["\n        <style>\n        </style>\n\n        <div class=\"row\">\n            <div class=\"col-md-10 col-md-offset-1\">\n\n                <div class=\"browser-subsection\">\n                    <h3>Family Info</h3>\n                </div>\n\n                <div style=\"padding: 5px 0px;\">\n\n                    <div class=\"form-group\">\n                        <label for=\"", "-id-input\" class=\"col-2 col-form-label\">ID</label>\n                        <div class=\"col-10\">\n                            <input class=\"form-control\" type=\"text\" value=\"\" id=\"", "-id-input\">\n                        </div>\n                    </div>\n\n                    <div class=\"form-group\">\n                        <label for=\"", "-description-input\" class=\"col-2 col-form-label\">Description</label>\n                        <div class=\"col-10\">\n                            <input class=\"form-control\" type=\"text\" value=\"\" id=\"", "-description-input\">\n                        </div>\n                    </div>\n\n                </div>\n\n                <div class=\"browser-subsection\">\n                    <h3>Members And Phenotypes</h3>\n                </div>\n\n                <form class=\"form-inline\" style=\"padding-top: 10px;\">\n                    <div class=\"form-group\">\n                        Select Individual\n                        <input style=\"margin: 0px 5px; width: 200px;\" class=\"form-control\" type=\"text\" value=\"\"\n                               @keyup=\"", "\" list=\"", "IndividualDatalist\"\n                               placeholder=\"Type an individual id\" id=\"", "-individual-input\">\n                        <datalist id=\"", "IndividualDatalist\"></datalist>\n\n                        <button type=\"button\" class=\"btn btn-primary\" @click=\"", "\">Add</button>\n                        <span style=\"margin: 0px 10px;\">\n                            or\n                            <button type=\"button\" id=\"", "-browseIndividual\" class=\"btn btn-sm btn-primary\"\n                                    data-toggle=\"modal\" data-placement=\"bottom\" @click=\"", "\"\n                                    style=\"display: inline\">Browse</button>\n                        </span>\n                    </div>\n                </form>\n\n                <div style=\"width: 90%; padding-top: 10px;\">\n                    <table class=\"table table-hover table-no-bordered\">\n                        <thead>\n                        <tr class=\"table-header\">\n                            <th>ID</th>\n                            <th>Sex</th>\n                            <th>Father</th>\n                            <th>Mother</th>\n                            <th>Affectation Status</th>\n                            <th>Life Status</th>\n                            <th>Year of Birth</th>\n                            <th>Creation Date</th>\n                            <th>Status</th>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        ", "\n                        </tbody>\n                    </table>\n                </div>\n\n                <div style=\"padding-top: 10px;\">\n                    Phenotypes:\n                    ", "\n                </div>\n\n                <div class=\"browser-subsection\">\n                    <h3>Relationship</h3>\n                </div>\n\n                <button type=\"button\" class=\"btn btn-primary\" @click=\"", "\">Create Family</button>\n\n            </div>\n        </div>\n\n        <div class=\"modal fade\" id=\"", "IndividualBrowser\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"individualBrowserLabel\">\n            <div class=\"modal-dialog modal-lg\" role=\"document\" style=\"width: 90%;\">\n                <div class=\"modal-content\">\n                    <div class=\"modal-header\">\n                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n                        <h4 class=\"modal-title\" id=\"", "IndividualBrowserLabel\">Family Selector</h4>\n                    </div>\n                    <div class=\"modal-body\" style=\"height: 780px\">\n                        <opencga-individual-browser .opencgaSession=\"", "\"\n                                                    .config=\"", "\">\n                        </opencga-individual-browser>\n                    </div>\n                    <div class=\"modal-footer\">\n                        <button type=\"button\" class=\"btn btn-primary\" data-dismiss=\"modal\" @click=\"", "\">\n                            OK\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        "]);

  opencga_family_editor_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_family_editor_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */





class opencga_family_editor_OpencgaFamilyEditor extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      id: {
        type: String
      },
      opencgaSession: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ofe-" + utils.randomString(6) + "_";
    this._config = this.getDefaultConfig();
  }
  /*    static get observers() {
      return ['mainObserver(id, opencgaSession, config)'];
  }*/


  updated(changedProperties) {
    if (changedProperties.has("config")) {
      this.configObserver();
    }

    if (changedProperties.has("id") || changedProperties.has("opencgaSession") || changedProperties.has("config")) {
      this.mainObserver();
    }
  }

  mainObserver(id, opencgaSession, config) {
    this.study = opencgaSession.study.fqn;
    this.opencgaClient = opencgaSession.opencgaClient;
    this.selectedIndividuals = [];
    this.phenotypes = [];
    this.individualBrowserConfig = {
      title: "Individual Browser",
      showTitle: true,
      showAggregationStats: false,
      showComparator: false,
      filter: {},
      grid: {
        pageSize: 10,
        pageList: [10, 25, 50],
        detailView: false,
        multiSelection: false
      },
      variableSetIds: []
    };
  }

  configObserver() {
    this._config = Object.assign(this.getDefaultConfig(), this.config);
  }

  showIndividualSelector(e) {
    e.preventDefault();
    this.individualModal = UtilsNew.isUndefined(this.individualModal) ? true : !this.individualModal;
    $("#" + this._prefix + "IndividualBrowser").modal("show");
  }

  autocompleteIndividuals(e) {
    const individualId = PolymerUtils_PolymerUtils.getElementById("".concat(this._prefix, "-individual-input")).value;

    if (UtilsNew.isNotUndefinedOrNull(individualId) && individualId.length >= 3) {
      const _this = this;

      const params = {
        id: "~^".concat(individualId),
        study: this.study,
        limit: 10,
        skipCount: true,
        include: "id"
      };

      _this.opencgaClient.individuals().search(params).then(function (response) {
        let options = "";

        for (const id of response.response[0].result) {
          options += "<option value=\"".concat(id.id, "\">");
        }

        PolymerUtils_PolymerUtils.innerHTML(_this._prefix + "IndividualDatalist", options);
      });
    }
  }

  addIndividual(e) {
    const individualId = PolymerUtils_PolymerUtils.getElementById("".concat(this._prefix, "-individual-input")).value;

    if (UtilsNew.isNotEmpty(individualId)) {
      const _this = this;

      const params = {
        study: this.study
      };

      _this.opencgaClient.individuals().info(individualId, params).then(function (response) {
        const individual = response.response[0].result[0];

        _this._addIndividualToSelectedArray(individual);

        _this.computePhenotypes(); // if (UtilsNew.isNotUndefinedOrNull(individual.father)) {
        //     _this.selectedIndividuals.push(_this._parseIndividual(individual.father));
        // }
        // if (UtilsNew.isNotUndefinedOrNull(individual.mother)) {
        //     _this.selectedIndividuals.push(_this._parseIndividual(individual.mother));
        // }

      }).catch(function (response) {
        NotificationUtils_NotificationUtils.showNotify(response.error, "ERROR");
      });
    } else {
      NotificationUtils_NotificationUtils.showNotify("Please start typing an individual id", "WARNING");
    }
  }

  removeSelectedIndividual(e) {
    const selectedIndividuals = [];

    for (let i = 0; i < this.selectedIndividuals.length; i++) {
      if (this.selectedIndividuals[i].id !== e.currentTarget.dataId) {
        selectedIndividuals.push(this.selectedIndividuals[i]);
      }
    }

    this.set("selectedIndividuals", selectedIndividuals);
    this.computePhenotypes();
  }

  computePhenotypes() {
    const phenotypes = new Set();

    for (let i = 0; i < this.selectedIndividuals.length; i++) {
      if (UtilsNew.isNotUndefinedOrNull(this.selectedIndividuals[i].member.phenotypes)) {
        for (let j = 0; j < this.selectedIndividuals[i].member.phenotypes.length; j++) {
          phenotypes.add(this.selectedIndividuals[i].member.phenotypes[j].id);
        }
      }
    }

    this.set("phenotypes", Array.from(phenotypes));
  }

  _addIndividualToSelectedArray(individual) {
    for (let i = 0; i < this.selectedIndividuals.length; i++) {
      if (this.selectedIndividuals[i].id === individual.id) {
        NotificationUtils_NotificationUtils.showNotify("Individual ".concat(individual.id, " already added"), "WARNING"); // The individual was already added

        return;
      }
    }

    this.push("selectedIndividuals", {
      id: individual.id,
      sex: individual.sex,
      father: UtilsNew.isNotEmpty(individual.father) && UtilsNew.isNotEmpty(individual.father.id) ? individual.father.id : "-",
      mother: UtilsNew.isNotEmpty(individual.mother) && UtilsNew.isNotEmpty(individual.mother.id) ? individual.mother.id : "-",
      affectationStatus: UtilsNew.isNotEmpty(individual.affectationStatus) ? individual.affectationStatus : "-",
      lifeStatus: UtilsNew.isNotEmpty(individual.lifeStatus) ? individual.lifeStatus : "-",
      dateOfBirth: UtilsNew.isNotEmpty(individual.dateOfBirth) ? moment(individual.dateOfBirth, "YYYYMMDD").format("YYYY") : "-",
      creationDate: moment(individual.creationDate, "YYYYMMDDHHmmss").format("D MMM YYYY"),
      status: individual.status.name,
      member: individual
    });
  }

  createFamily(e) {
    const params = this.obtainAllFamilyParameters();

    if (UtilsNew.isNotUndefinedOrNull(params)) {
      const _this = this;

      this.opencgaClient.families().create({
        study: this.study
      }, params).then(function (response) {
        _this.resetFields();

        NotificationUtils_NotificationUtils.showNotify("Family ".concat(response.response[0].result[0].id, " created successfully"), "SUCCESS");
      }).catch(function (response) {
        console.error(response);
        NotificationUtils_NotificationUtils.showNotify(response.error, "ERROR");
      });
    }
  }

  resetFields() {
    PolymerUtils_PolymerUtils.setValue("".concat(this._prefix, "-id-input"), "");
    PolymerUtils_PolymerUtils.setValue("".concat(this._prefix, "-description-input"), "");
    this.selectedIndividuals = [];
    this.phenotypes = [];
  }

  obtainAllFamilyParameters(params) {
    const missingFields = [];
    const id = PolymerUtils_PolymerUtils.getValue("".concat(this._prefix, "-id-input"));

    if (UtilsNew.isEmpty(id)) {
      missingFields.push("id");
    }

    const description = PolymerUtils_PolymerUtils.getValue("".concat(this._prefix, "-description-input"));

    if (UtilsNew.isEmpty(description)) {
      missingFields.push("description");
    }

    const members = [];

    if (UtilsNew.isEmptyArray(this.selectedIndividuals)) {
      missingFields.push("members");
    } else {
      for (let i = 0; i < this.selectedIndividuals.length; i++) {
        members.push({
          id: this.selectedIndividuals[i].id
        });
      }
    }

    if (UtilsNew.isNotEmptyArray(missingFields)) {
      NotificationUtils_NotificationUtils.showNotify("Missing " + missingFields.join(", ") + " fields", "ERROR");
      return null;
    }

    return {
      id: id,
      description: description,
      members: members,
      phenotypes: this.phenotypes
    };
  }

  getDefaultConfig() {
    return {
      title: "Family Editor",
      showTitle: true,
      showAggregationStats: true,
      showComparator: true,
      filter: {},
      grid: {
        pageSize: 10,
        pageList: [10, 25, 50],
        detailView: false,
        multiSelection: false
      },
      gridComparator: {
        pageSize: 5,
        pageList: [5, 10],
        detailView: true,
        multiSelection: true
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_family_editor_templateObject(), this._prefix, this._prefix, this._prefix, this._prefix, this.autocompleteIndividuals, this._prefix, this._prefix, this._prefix, this.addIndividual, this._prefix, this.showIndividualSelector, this.selectedIndividuals && this.selectedIndividuals.length ? this.selectedIndividuals.map(member => lit_html_lit_html_html(opencga_family_editor_templateObject2(), member.id, member.sex, member.father, member.mother, member.affectationStatus, member.lifeStatus, member.dateOfBirth, member.creationDate, member.status, member.id, this.removeSelectedIndividual)) : null, this.phenotypes && this.phenotypes.length ? this.phenotypes.map(phenotype => lit_html_lit_html_html(opencga_family_editor_templateObject3(), phenotype)) : null, this.createFamily, this._prefix, this._prefix, this.opencgaSession, this.individualBrowserConfig, this.onIndividualSelected);
  }

}
customElements.define("opencga-family-editor", opencga_family_editor_OpencgaFamilyEditor);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/family/opencga-family-filter.js
function opencga_family_filter_templateObject9() {
  const data = opencga_family_filter_taggedTemplateLiteral(["No filter has been configured."]);

  opencga_family_filter_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function opencga_family_filter_templateObject8() {
  const data = opencga_family_filter_taggedTemplateLiteral(["\n            <div class=\"search-button-wrapper\">\n                <button type=\"button\" class=\"btn btn-primary ripple\" @click=\"", "\">\n                    <i class=\"fa fa-search\" aria-hidden=\"true\"></i> Search\n                </button>\n            </div>\n            "]);

  opencga_family_filter_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_family_filter_templateObject7() {
  const data = opencga_family_filter_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n\n            span + span {\n                margin-left: 10px;\n            }\n\n            div.block {\n                overflow: hidden;\n            }\n\n            div.block label {\n                width: 80px;\n                display: block;\n                float: left;\n                text-align: left;\n                font-weight: normal;\n            }\n\n            select + select {\n                margin-left: 10px;\n            }\n\n            select + input {\n                margin-left: 10px;\n            }\n        </style>\n\n        ", "\n\n        <div class=\"panel-group\" id=\"", "Accordion\" role=\"tablist\" aria-multiselectable=\"true\">\n                <div class=\"\">\n                    ", "\n                </div>\n        </div>\n        "]);

  opencga_family_filter_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_family_filter_templateObject6() {
  const data = opencga_family_filter_taggedTemplateLiteral(["\n                                <div class=\"tooltip-div pull-right\">\n                                    <a><i class=\"fa fa-info-circle\" aria-hidden=\"true\" id=\"", "", "Tooltip\"></i></a>\n                                </div>"]);

  opencga_family_filter_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_family_filter_templateObject5() {
  const data = opencga_family_filter_taggedTemplateLiteral(["\n                    <div class=\"form-group\">\n                        <div class=\"browser-subsection\" id=\"", "\">", "\n                            ", "\n                        </div>\n                        <div id=\"", "", "\" class=\"subsection-content\">\n                            ", "\n                         </div>\n                    </div>\n                "]);

  opencga_family_filter_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_family_filter_templateObject4() {
  const data = opencga_family_filter_taggedTemplateLiteral(["<opencga-date-filter .config=\"", "\" @filterChange=\"", "\"></opencga-date-filter>"]);

  opencga_family_filter_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_family_filter_templateObject3() {
  const data = opencga_family_filter_taggedTemplateLiteral(["<opencga-annotation-filter .opencgaSession=\"", "\"\n                                                      .opencgaClient=\"", "\"\n                                                      entity=\"FAMILY\"\n                                                      .config=\"", "\"\n                                                      @filterannotation=\"", "\">\n                           </opencga-annotation-filter>"]);

  opencga_family_filter_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_family_filter_templateObject2() {
  const data = opencga_family_filter_taggedTemplateLiteral(["<text-field-filter placeholder=\"", "\" .value=\"", "\" @filterChange=\"", "\"></text-field-filter>"]);

  opencga_family_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_family_filter_templateObject() {
  const data = opencga_family_filter_taggedTemplateLiteral(["<section-filter .config=\"", "\" .filters=\"", "\">"]);

  opencga_family_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_family_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_family_filter_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_family_filter_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_family_filter_ownKeys(Object(source), true).forEach(function (key) { opencga_family_filter_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_family_filter_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_family_filter_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */






class opencga_family_filter_OpencgaFamilyFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      families: {
        type: Array,
        notify: true
      },
      query: {
        type: Object,
        notify: true
      },
      search: {
        type: Object,
        notify: true
      },
      variableSets: {
        type: Array
      },
      variables: {
        type: Array
      },
      minYear: {
        type: Number
      },
      compact: {
        type: Boolean
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    // super.ready();
    this._prefix = "osf-" + utils.randomString(6) + "_";
    this.minYear = 1920;
    this.annotationFilterConfig = {
      class: "small",
      buttonClass: "btn-sm",
      inputClass: "input-sm"
    };
    this.dateFilterConfig = {
      recentDays: 10
    };
    this.query = {};
    this.preparedQuery = {};
    this.searchButton = true;
  }

  connectedCallback() {
    super.connectedCallback();
    this.preparedQuery = opencga_family_filter_objectSpread({}, this.query); // propagates here the iva-app query object
  }

  updated(changedProperties) {
    if (changedProperties.has("query")) {
      this.queryObserver();
    }

    if (changedProperties.has("variables")) {
      this.variablesChanged();
    }
  }

  queryObserver() {
    if (this._reset) {
      console.log("onQueryUpdate: calling to 'renderQueryFilters()'", this.query);
      this.preparedQuery = this.query; // renderQueryFilters shouldn't be necessary anymore
      // this.renderQueryFilters();

      this.requestUpdate();
    } else {
      this._reset = true;
    }
  }

  onSearch() {
    // this.search = {...this.query};
    this.notifySearch(this.preparedQuery);
  }

  addAnnotation(e) {
    if (typeof this._annotationFilter === "undefined") {
      this._annotationFilter = {};
    }

    const split = e.detail.value.split("=");
    this._annotationFilter[split[0]] = split[1];

    const _query = opencga_family_filter_objectSpread({}, this.query);

    const annotations = [];

    for (const key in this._annotationFilter) {
      annotations.push("".concat(key, "=").concat(this._annotationFilter[key]));
    }

    _query["annotation"] = annotations.join(";");
    this._reset = false;
    this.query = _query;
    this._reset = true;
  }

  onDateChanged(e) {
    const query = {};
    Object.assign(query, this.query);

    if (utilsNew_UtilsNew.isNotEmpty(e.detail.date)) {
      query["creationDate"] = e.detail.date;
    } else {
      delete query["creationDate"];
    }

    this._reset = false;
    this.query = query;
    this._reset = true;
  }

  onQueryUpdate() {
    if (this._reset) {
      console.log("onQueryUpdate: calling to 'renderQueryFilters()'", this.query);
      this.renderQueryFilters();
    } else {
      this._reset = true;
    }
  }

  renderQueryFilters() {
    // Empty everything before rendering
    this._clearHtmlDom(); // Family


    if (utilsNew_UtilsNew.isNotUndefined(this.query.id)) {
      PolymerUtils_PolymerUtils.setValue("".concat(this._prefix, "-family-input"), this.query.id);
    } // Members


    if (utilsNew_UtilsNew.isNotUndefined(this.query.members)) {
      PolymerUtils_PolymerUtils.setValue("".concat(this._prefix, "-members-input"), this.query.members);
    } // Samples
    // if (UtilsNew.isNotUndefined(this.query.samples)) {
    //     PolymerUtils.setValue(`${this._prefix}-sample-input`, this.query.samples);
    // }
    // Phenotypes


    if (utilsNew_UtilsNew.isNotUndefined(this.query.phenotypes)) {
      PolymerUtils_PolymerUtils.setValue("".concat(this._prefix, "-phenotypes-input"), this.query.phenotypes);
    }
  }

  onFilterChange(key, value) {
    console.log("filterChange", {
      [key]: value
    });

    if (value && value !== "") {
      this.preparedQuery = opencga_family_filter_objectSpread({}, this.preparedQuery, {}, {
        [key]: value
      });
    } else {
      console.log("deleting", key, "from preparedQuery");
      delete this.preparedQuery[key];
      this.preparedQuery = opencga_family_filter_objectSpread({}, this.preparedQuery);
    }

    this.notifyQuery(this.preparedQuery);
    this.requestUpdate();
  }

  notifyQuery(query) {
    this.dispatchEvent(new CustomEvent("queryChange", {
      detail: {
        query: query
      },
      bubbles: true,
      composed: true
    }));
  }

  notifySearch(query) {
    this.dispatchEvent(new CustomEvent("querySearch", {
      detail: {
        query: query
      },
      bubbles: true,
      composed: true
    }));
  }

  _createSection(section) {
    const htmlFields = section.fields && section.fields.length && section.fields.map(subsection => this._createSubSection(subsection));
    return this.config.sections.length > 1 ? lit_html_lit_html_html(opencga_family_filter_templateObject(), section, htmlFields) : htmlFields;
  }

  _createSubSection(subsection) {
    let content = "";

    switch (subsection.id) {
      case "id":
      case "members":
      case "phenotypes":
        content = lit_html_lit_html_html(opencga_family_filter_templateObject2(), subsection.placeholder, this.preparedQuery[subsection.id], e => this.onFilterChange(subsection.id, e.detail.value));
        break;

      case "annotations":
        content = lit_html_lit_html_html(opencga_family_filter_templateObject3(), this.opencgaSession, this.opencgaSession.opencgaClient, this.annotationFilterConfig, this.addAnnotation);
        break;

      case "date":
        content = lit_html_lit_html_html(opencga_family_filter_templateObject4(), this.dateFilterConfig, e => this.onFilterChange("creationDate", e.detail.value));
        break;

      default:
        console.error("Filter component not found");
    }

    return lit_html_lit_html_html(opencga_family_filter_templateObject5(), subsection.id, subsection.name, subsection.description ? lit_html_lit_html_html(opencga_family_filter_templateObject6(), this._prefix, subsection.id) : null, this._prefix, subsection.id, content);
  }

  calculateFilters(e) {
    const _query = {};
    const name = PolymerUtils_PolymerUtils.getValue("".concat(this._prefix, "-family-input"));

    if (utilsNew_UtilsNew.isNotEmpty(name)) {
      _query.id = name;
    } // let samples = PolymerUtils.getValue(`${this._prefix}-samples-input`);
    // if (UtilsNew.isNotEmpty(samples)) {
    //     _query.samples = samples;
    // }


    const members = PolymerUtils_PolymerUtils.getValue("".concat(this._prefix, "-members-input"));

    if (utilsNew_UtilsNew.isNotEmpty(members)) {
      _query.members = members;
    }

    const phenotypes = PolymerUtils_PolymerUtils.getValue("".concat(this._prefix, "-phenotypes-input"));

    if (utilsNew_UtilsNew.isNotEmpty(phenotypes)) {
      _query.phenotypes = phenotypes;
    } // keep annotation filter


    if (utilsNew_UtilsNew.isNotEmpty(this.query.annotation)) {
      _query.annotation = this.query.annotation;
    } // keep date filters


    if (utilsNew_UtilsNew.isNotEmpty(this.query.creationDate)) {
      _query.creationDate = this.query.creationDate;
    } // To prevent to call renderQueryFilters we set this to false


    this._reset = false;
    this.query = _query;
    this._reset = true;
  }
  /**
   * Use custom CSS class to easily reset all controls.
   */


  _clearHtmlDom() {
    // Input controls
    PolymerUtils_PolymerUtils.setPropertyByClassName(this._prefix + "FilterTextInput", "value", "");
    PolymerUtils_PolymerUtils.removeAttributebyclass(this._prefix + "FilterTextInput", "disabled");
    $("#".concat(this._prefix, "FamilySelection .selectpicker")).selectpicker("val", "");
  }

  render() {
    return lit_html_lit_html_html(opencga_family_filter_templateObject7(), this.searchButton ? lit_html_lit_html_html(opencga_family_filter_templateObject8(), this.onSearch) : null, this._prefix, this.config.sections && this.config.sections.length ? this.config.sections.map(section => this._createSection(section)) : lit_html_lit_html_html(opencga_family_filter_templateObject9()));
  }

}
customElements.define("opencga-family-filter", opencga_family_filter_OpencgaFamilyFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/family/opencga-family-grid.js
function opencga_family_grid_templateObject() {
  const data = opencga_family_grid_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .detail-view :hover {\n                background-color: white;\n            }\n\n            .detail-view-row :hover {\n                background-color: #f5f5f5;\n            }\n\n            .cursor-pointer {\n                cursor: pointer;\n            }\n\n            .members-link-dropdown:hover .dropdown-menu {\n                display: block;\n            }\n\n            .phenotypes-link-dropdown:hover .dropdown-menu {\n                display: block;\n            }\n        </style>\n\n        <opencb-grid-toolbar .from=\"", "\"\n                             .to=\"", "\"\n                             .numTotalResultsText=\"", "\"\n                             .config=\"", "\"\n                             @columnchange=\"", "\"\n                             @download=\"", "\">\n        </opencb-grid-toolbar>\n\n        <div id=\"", "GridTableDiv\">\n            <table id=\"", "FamilyBrowserGrid\">\n            </table>\n        </div>\n        "]);

  opencga_family_grid_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_family_grid_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_family_grid_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_family_grid_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_family_grid_ownKeys(Object(source), true).forEach(function (key) { opencga_family_grid_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_family_grid_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_family_grid_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */







class opencga_family_grid_OpencgaFamilyGrid extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      families: {
        type: Array
      },
      //TODO remove
      search: {
        type: Object
      },
      active: {
        type: Boolean
      },
      config: {
        type: Object
      },
      query: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "VarFamilyGrid" + utils.randomString(6);
    this.catalogUiUtils = new CatalogUIUtils_CatalogUIUtils();
    this.active = false;
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession") || changedProperties.has("query") || changedProperties.has("config") || changedProperties.has("active")) {
      this.propertyObserver();
    }
  }
  /* connectedCallback() {
      super.connectedCallback();
       this.renderTable(this.active);
  }*/


  firstUpdated(_changedProperties) {//this.renderTable(this.active);
  }

  propertyObserver() {
    // With each property change we must updated config and create the columns again. No extra checks are needed.
    this._config = Object.assign(this.getDefaultConfig(), this.config);
    this._columns = this._initTableColumns(); // Config for the grid toolbar

    this.toolbarConfig = {
      columns: this._columns[0]
    };
    this.renderTable(this.active);
  }

  renderTable(active) {
    if (!active) {
      return;
    }

    this.opencgaClient = this.opencgaSession.opencgaClient;
    this.families = [];

    let filters = opencga_family_grid_objectSpread({}, this.query); // Initialise the counters


    this.from = 1;
    this.to = this._config.pageSize;

    if (this.opencgaClient && this.opencgaSession.study && this.opencgaSession.study.fqn) {
      filters.study = this.opencgaSession.study.fqn;

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.lastFilters) && JSON.stringify(this.lastFilters) === JSON.stringify(filters)) {
        // Abort destroying and creating again the grid. The filters have not changed
        return;
      } // Store the current filters


      this.lastFilters = opencga_family_grid_objectSpread({}, filters); // Make a copy of the families (if they exist), we will use this private copy until it is assigned to this.families

      if (utilsNew_UtilsNew.isNotUndefined(this.families)) {
        this._families = this.families;
      } else {
        this._families = [];
      } // Check that HTTP protocol is present and complete the URL

      /*            let opencgaHostUrl = this.opencgaClient.getConfig().host;
                  if (!opencgaHostUrl.startsWith("http://") && !opencgaHostUrl.startsWith("https://")) {
                      opencgaHostUrl = "http://" + opencgaHostUrl;
                  }
                  opencgaHostUrl += "/webservices/rest/v1/families/search";*/


      let skipCount = false;

      const _table = $("#" + this._prefix + "FamilyBrowserGrid");

      const _this = this;

      $("#" + this._prefix + "FamilyBrowserGrid").bootstrapTable("destroy");
      $("#" + this._prefix + "FamilyBrowserGrid").bootstrapTable({
        //url: opencgaHostUrl,
        columns: _this._columns,
        method: "get",
        sidePagination: "server",
        uniqueId: "id",
        // Table properties
        pagination: _this._config.pagination,
        pageSize: _this._config.pageSize,
        pageList: _this._config.pageList,
        showExport: _this._config.showExport,
        detailView: _this._config.detailView,
        detailFormatter: _this._config.detailFormatter,
        // Make Polymer components avalaible to table formatters
        gridContext: _this,

        /*                queryParams: function(params) {
                            if (this.pageNumber > 1) {
                                skipCount = true;
                            }
        
                            const auxParams = {
                                sid: Cookies.get(_this.opencgaClient.getConfig().cookieSessionId),
                                order: params.order,
                                sort: params.sort,
                                limit: params.limit,
                                skip: params.offset,
                                // includeFamily: true,
                                skipCount: skipCount
                                // include: "id,creationDate,status,uuid,version,release,modificationDate,phenotypes,members,expectedSize"
                            };
        
                            if (UtilsNew.isUndefined(filters)) {
                                filters = {};
                            }
                            return Object.assign({}, filters, auxParams);
                        },*/
        formatLoadingMessage: () => "<div><loading-spinner></loading-spinner></div>",
        ajax: params => {
          if (this.pageNumber > 1) {
            skipCount = true;
          }

          let _filters = opencga_family_grid_objectSpread({
            //study: this.opencgaSession.study.fqn,
            order: params.data.order,
            limit: params.data.limit,
            skip: params.data.offset || 0,
            skipCount: skipCount
          }, filters);

          this.opencgaSession.opencgaClient.families().search(_filters).then(res => params.success(res)).catch(e => console.error(e));
        },
        responseHandler: function responseHandler(response) {
          if (!skipCount) {
            if (!_this.hasOwnProperty("numTotalResults")) {
              _this.numTotalResults = 0;
            }

            if (_this.numTotalResults !== response.getResponse().numTotalResults && response.queryOptions.skip === 0) {
              _this.numTotalResults = response.getResponse().numTotalResults;
            }
          }

          _this.numTotalResultsText = _this.numTotalResults.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

          if (response.getParams().skip === 0 && _this.numTotalResults < response.getParams().limit) {
            _this.from = 1;
            _this.to = _this.numTotalResults;
          }

          _this.requestUpdate(); // it is necessary to refresh numTotalResultsText in opencga-grid-toolbar


          return {
            total: _this.numTotalResults,
            rows: response.getResults()
          };
        },
        onClickRow: function onClickRow(row, element, field) {
          if (_this._config.multiSelection) {
            // Check and uncheck when clicking in the checkbox TD cell
            if (field === "state") {
              const index = element[0].dataset.index;

              if (element[0].className.includes("selected")) {
                $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "FamilyBrowserGrid")).bootstrapTable("uncheck", index);
              } else {
                $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "FamilyBrowserGrid")).bootstrapTable("check", index);
                $(".success").removeClass("success");
                $(element).addClass("success");
              }
            } else {
              // If user has clicked in the row
              const index = element[0].dataset.index;

              if (element[0].className.includes("selected")) {
                $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "FamilyBrowserGrid")).bootstrapTable("uncheck", index);
                $(element).removeClass("success");
              } else {
                $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "FamilyBrowserGrid")).bootstrapTable("check", index);
              }
            }
          } else {
            // If not checkboxes exist
            $(".success").removeClass("success");
            $(element).addClass("success");
          }

          _this._onSelectFamily(row);
        },
        onDblClickRow: function onDblClickRow(row, element, field) {
          // We detail view is active we expand the row automatically.
          // FIXME: Note that we use a CSS class way of knowing if the row is expand or collapse, this is not ideal but works.
          if (_this._config.detailView) {
            if (element[0].innerHTML.includes("icon-plus")) {
              $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "FamilyBrowserGrid")).bootstrapTable("expandRow", element[0].dataset.index);
            } else {
              $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "FamilyBrowserGrid")).bootstrapTable("collapseRow", element[0].dataset.index);
            }
          }
        },
        onCheck: function onCheck(row, element) {
          // check family is not already selected
          for (const i in _this._families) {
            if (_this._families[i].id === row.id) {
              return;
            }
          } // we add families to selected families


          _this._families.push(row);

          _this.families = _this._families.slice(); // We only activate the row when checking

          if (_this._config.detailView) {
            $(".success").removeClass("success");
          }

          $(element[0].parentElement.parentElement).addClass("success"); // If exist on single nested sample we must check it

          if (row.members.length === 1) {
            const checkbox = PolymerUtils_PolymerUtils.getElementById(_this._prefix + row.members[0].id + "Checkbox");

            if (utilsNew_UtilsNew.isNotUndefinedOrNull(checkbox)) {
              checkbox.checked = true;
            }
          }
        },
        onUncheck: function onUncheck(row, elem) {
          let familyToDeleteIdx = -1;

          for (const i in _this.families) {
            if (_this.families[i].id === row.id) {
              familyToDeleteIdx = i;
              break;
            }
          }

          if (familyToDeleteIdx === -1) {
            return;
          }

          _this._families = _this._families.splice(familyToDeleteIdx, 1);
          _this.families = this._families.slice(); // We detail view is active we expand the row automatically

          if (_this._config.detailView) {
            $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "FamilyBrowserGrid")).bootstrapTable("collapseRow", elem[0].dataset.index);
          } // We must uncheck nested checked samples


          if (row.members.length > 0) {
            for (const sample of row.members) {
              const checkbox = PolymerUtils_PolymerUtils.getElementById(_this._prefix + sample.id + "Checkbox");

              if (utilsNew_UtilsNew.isNotUndefinedOrNull(checkbox)) {
                checkbox.checked = false;
              }
            }
          }
        },
        onCheckAll: function onCheckAll(rows) {
          const newFamilies = _this._families.slice(); // check family is not already selected


          rows.forEach(family => {
            const existsNewSelected = _this._families.some(familySelected => {
              return familySelected.id === family.id;
            });

            if (!existsNewSelected) {
              newFamilies.push(family);
            }
          }); // we add families to selected families

          _this._families = newFamilies;
          _this.families = newFamilies.slice(); // We must uncheck nested checked samples

          for (const row of rows) {
            if (row.members.length === 1) {
              const checkbox = PolymerUtils_PolymerUtils.getElementById(_this._prefix + row.members[0].id + "Checkbox");

              if (utilsNew_UtilsNew.isNotUndefinedOrNull(checkbox)) {
                checkbox.checked = true;
              }
            }
          }
        },
        onUncheckAll: function onUncheckAll(rows) {
          // check family is not already selected
          rows.forEach(family => {
            _this._families = _this._families.filter(familySelected => {
              return familySelected.id !== family.id;
            });
          }); // we add families to selected families
          //                            _this.push("_families", row);

          _this.families = _this._families.slice(); // We must uncheck nested checked samples

          for (const row of rows) {
            for (const sample of row.members) {
              const checkbox = PolymerUtils_PolymerUtils.getElementById(_this._prefix + sample.id + "Checkbox");

              if (utilsNew_UtilsNew.isNotUndefinedOrNull(checkbox)) {
                checkbox.checked = false;
              }
            }
          }
        },
        onLoadSuccess: function onLoadSuccess(data) {
          // Check all already selected rows. Selected families are stored in this.families array
          if (utilsNew_UtilsNew.isNotUndefinedOrNull(_table)) {
            if (_this._config.detailView) {
              PolymerUtils_PolymerUtils.querySelector(_table.selector).rows[1].setAttribute("class", "success");

              _this._onSelectFamily(data.rows[0]);
            }

            if (_this.families !== "undefined") {
              for (const idx in _this.families) {
                for (const j in data.rows) {
                  if (_this.families[idx].id === data.rows[j].id) {
                    $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "FamilyBrowserGrid")).bootstrapTable("check", j);
                    break;
                  }
                }
              }
            }
          }
        },
        onPageChange: function onPageChange(page, size) {
          _this.from = (page - 1) * size + 1;
          _this.to = page * size;
        },
        onPostBody: function onPostBody(data) {
          // Add tooltips
          _this.catalogUiUtils.addTooltip("div.phenotypesTooltip", "Phenotypes");

          _this.catalogUiUtils.addTooltip("div.membersTooltip", "Members");
        }
      });
    } else {
      // Delete table
      $(PolymerUtils_PolymerUtils.getElementById(this._prefix + "FamilyBrowserGrid")).bootstrapTable("destroy");
      this.numTotalResults = 0;
    }
  }

  _onSelectFamily(row) {
    if (typeof row !== "undefined") {
      this.dispatchEvent(new CustomEvent("selectfamily", {
        detail: {
          id: row.id,
          family: row
        }
      }));
    }
  }

  onColumnChange(e) {
    const table = $("#" + this._prefix + "FamilyBrowserGrid");

    if (e.detail.selected) {
      table.bootstrapTable("showColumn", e.detail.id);
    } else {
      table.bootstrapTable("hideColumn", e.detail.id);
    }
  }

  detailFormatter(value, row) {
    let result = "<div class='row' style=\"padding: 5px 10px 20px 10px\">\n                                <div class='col-md-12'>\n                                    <h5 style=\"font-weight: bold\">Members</h5>\n                ";

    if (utilsNew_UtilsNew.isNotEmptyArray(row.members)) {
      let tableCheckboxHeader = "";

      if (this.gridContext._config.multiSelection) {
        tableCheckboxHeader = "<th>Select</th>";
      }

      result += "<div style=\"width: 90%;padding-left: 20px\">\n                                <table class=\"table table-hover table-no-bordered\">\n                                    <thead>\n                                        <tr class=\"table-header\">\n                                            ".concat(tableCheckboxHeader, "\n                                            <th>ID</th>\n                                            <th>Sex</th>\n                                            <th>Father</th>\n                                            <th>Mother</th>\n                                            <th>Affectation Status</th>\n                                            <th>Life Status</th>\n                                            <th>Year of Birth</th>\n                                            <th>Creation Date</th>\n                                            <th>Status</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>");

      for (const member of row.members) {
        let tableCheckboxRow = ""; // If parent row is checked and there is only one samlpe then it must be selected

        if (this.gridContext._config.multiSelection) {
          let checkedStr = "";

          for (const family of this.gridContext.families) {
            if (family.id === row.id && row.members.length === 1) {
              // TODO check member has been checked before, we need to store them
              checkedStr = "checked";
              break;
            }
          }

          tableCheckboxRow = "<td><input id='".concat(this.gridContext.prefix).concat(member.id, "Checkbox' type='checkbox' ").concat(checkedStr, "></td>");
        }

        const father = utilsNew_UtilsNew.isNotEmpty(member.father.id) ? member.father.id : "-";
        const mother = utilsNew_UtilsNew.isNotEmpty(member.mother.id) ? member.mother.id : "-";
        const affectation = utilsNew_UtilsNew.isNotEmpty(member.affectationStatus) ? member.affectationStatus : "-";
        const lifeStatus = utilsNew_UtilsNew.isNotEmpty(member.lifeStatus) ? member.lifeStatus : "-";
        const dateOfBirth = utilsNew_UtilsNew.isNotEmpty(member.dateOfBirth) ? moment(member.dateOfBirth, "YYYYMMDD").format("YYYY") : "-";
        const creationDate = moment(member.creationDate, "YYYYMMDDHHmmss").format("D MMM YYYY");
        result += "<tr class=\"detail-view-row\">\n                                        ".concat(tableCheckboxRow, "\n                                        <td>").concat(member.id, "</td>\n                                        <td>").concat(member.sex, "</td>\n                                        <td>").concat(father, "</td>\n                                        <td>").concat(mother, "</td>\n                                        <td>").concat(affectation, "</td>\n                                        <td>").concat(lifeStatus, "</td>\n                                        <td>").concat(dateOfBirth, "</td>\n                                        <td>").concat(creationDate, "</td>\n                                        <td>").concat(member.status.name, "</td>\n                                   </tr>");
      }

      result += "</tbody></table></diV>";
    } else {
      result += "No members found";
    }

    result += "</div></div>";
    return result;
  }

  membersFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotEmptyArray(value)) {
      let members = "";

      for (const member of value) {
        members += "<div style=\"padding: 5px\">\n                                        <span>\n                                            ".concat(member.id, " (").concat(member.sex, ")\n                                        </span>\n                                    </div>");
      }

      const html = "<div class=\"membersTooltip\" data-tooltip-text='".concat(members, "' align=\"center\">\n                                    <a style=\"cursor: pointer\">\n                                        ").concat(value.length, " members found\n                                    </a>\n                                </div>\n                    ");
      return html;
    } else {
      return "No members found";
    }
  }

  disordersFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotEmpty(value)) {
      let disordersHtml = "<div>";

      for (const disorder of value) {
        disordersHtml += "<span>".concat(disorder.id, "</span>");
      }

      disordersHtml += "</div>";
      return disordersHtml;
    } else {
      return "-";
    }
  }

  phenotypesFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotEmptyArray(value)) {
      let phenotypeTooltipText = "";

      for (const phenotype of value) {
        phenotypeTooltipText += "<div style=\"padding: 5px\">";

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(phenotype.source) && phenotype.source.toUpperCase() === "HPO") {
          phenotypeTooltipText += "<span><a target=\"_blank\" href=\"https://hpo.jax.org/app/browse/term/".concat(phenotype.id, "\">").concat(phenotype.id, " </a>(").concat(phenotype.status, ")</span>\n                                ");
        } else {
          phenotypeTooltipText += "<span>".concat(phenotype.id, " (").concat(phenotype.status, ")</span>");
        }

        phenotypeTooltipText += "</div>";
      }

      const html = "<div class=\"phenotypesTooltip\" data-tooltip-text='".concat(phenotypeTooltipText, "' align=\"center\">\n                                    <a style=\"cursor: pointer\">\n                                        ").concat(value.length, " terms found\n                                    </a>\n                                </div>\n                    ");
      return html;
    } else {
      return "-";
    }
  }

  customAnnotationFormatter(value, row) {// debugger
  }

  dateFormatter(value, row) {
    if (utilsNew_UtilsNew.isUndefinedOrNull(value)) {
      return "-";
    }

    return moment(value, "YYYYMMDDHHmmss").format("D MMM YYYY");
  }

  _initTableColumns() {
    // Check column visibility
    const customAnnotationVisible = utilsNew_UtilsNew.isNotUndefinedOrNull(this._config.customAnnotations) && utilsNew_UtilsNew.isNotEmptyArray(this._config.customAnnotations.fields);
    const columns = [];

    if (this._config.multiSelection) {
      columns.push({
        field: "state",
        checkbox: true,
        // formatter: this.stateFormatter,
        class: "cursor-pointer",
        eligible: false
      });
    }

    this._columns = [columns.concat([{
      title: "Family",
      field: "id",
      sortable: true,
      halign: this._config.header.horizontalAlign
    }, {
      title: "Members",
      field: "members",
      formatter: this.membersFormatter.bind(this),
      halign: this._config.header.horizontalAlign
    }, {
      title: "Disorders",
      field: "disorders",
      formatter: this.disordersFormatter.bind(this),
      halign: this._config.header.horizontalAlign
    }, {
      title: "Phenotypes",
      field: "phenotypes",
      formatter: this.phenotypesFormatter.bind(this),
      halign: this._config.header.horizontalAlign
    }, {
      title: "Custom Annotations",
      field: "customAnnotation",
      formatter: this.customAnnotationFormatter,
      visible: customAnnotationVisible,
      halign: this._config.header.horizontalAlign
    }, {
      title: "Creation Date",
      field: "creationDate",
      formatter: this.dateFormatter,
      sortable: true,
      halign: this._config.header.horizontalAlign
    }, {
      title: "Status",
      field: "status.name",
      halign: this._config.header.horizontalAlign
    }])];
    return this._columns;
  }

  _getUrlQueryParams() {// TODO
  }

  onDownload(e) {
    // let urlQueryParams = this._getUrlQueryParams();
    // let params = urlQueryParams.queryParams;
    //console.log(this.opencgaSession);
    const params = opencga_family_grid_objectSpread({}, this.query, {
      study: this.opencgaSession.study.fqn,
      sid: this.opencgaSession.opencgaClient._config.sessionId,
      limit: 1000,
      skip: 0,
      includeIndividual: true,
      skipCount: true
    });

    this.opencgaSession.opencgaClient.families().search(params).then(response => {
      const result = response.response[0].result;
      console.log(result);
      let dataString = [];
      let mimeType = "";
      let extension = "";

      if (result) {
        // Check if user clicked in Tab or JSON format
        if (e.detail.option.toLowerCase() === "tab") {
          dataString = [["Family", "Members", "Disorders", "Phenotypes", "Creation Date", "Status"].join("\t"), ...result.map(_ => [_.id, _.members ? _.members.map(_ => "".concat(_.id, " (").concat(_.sex, ")")).join(",") : "", _.disorders ? _.disorders.map(_ => _.id).join(",") : "", _.phenotypes ? _.phenotypes.map(_ => _.id).join(",") : "", _.creationDate, _.status.name].join("\t"))]; //console.log(dataString);

          mimeType = "text/plain";
          extension = ".txt";
        } else {
          for (const res of result) {
            dataString.push(JSON.stringify(res, null, "\t"));
          }

          mimeType = "application/json";
          extension = ".json";
        } // Build file and anchor link


        const data = new Blob([dataString.join("\n")], {
          type: mimeType
        });
        const file = window.URL.createObjectURL(data);
        const a = document.createElement("a");
        a.href = file;
        a.download = this.opencgaSession.study.alias + extension;
        document.body.appendChild(a);
        a.click();
        setTimeout(function () {
          document.body.removeChild(a);
        }, 0);
      } else {
        console.error("Error in result format");
      }
    }).then(function () {//this.downloadRefreshIcon.css("display", "none");
      //this.downloadIcon.css("display", "inline-block");
    });
  }

  getDefaultConfig() {
    return {
      pagination: true,
      pageSize: 10,
      pageList: [10, 25, 50],
      showExport: false,
      detailView: true,
      detailFormatter: this.detailFormatter,
      // function with the detail formatter
      multiSelection: false,
      header: {
        horizontalAlign: "center",
        verticalAlign: "bottom"
      },
      disorderSources: ["ICD", "ICD10", "GelDisorder"],
      customAnnotations: {
        title: "Custom Annotation",
        fields: []
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_family_grid_templateObject(), this.from, this.to, this.numTotalResultsText, this.toolbarConfig, this.onColumnChange, this.onDownload, this._prefix, this._prefix);
  }

}
customElements.define("opencga-family-grid", opencga_family_grid_OpencgaFamilyGrid);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/variableSets/opencga-annotation-comparator.js
function opencga_annotation_comparator_templateObject5() {
  const data = opencga_annotation_comparator_taggedTemplateLiteral(["\n                <p>No variableSets defined in the study</p>\n            "]);

  opencga_annotation_comparator_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_annotation_comparator_templateObject4() {
  const data = opencga_annotation_comparator_taggedTemplateLiteral(["\n                            <option data-variable=\"{{item}}\">{{item.id}}</option>\n                        "]);

  opencga_annotation_comparator_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_annotation_comparator_templateObject3() {
  const data = opencga_annotation_comparator_taggedTemplateLiteral(["\n                    <label for=\"", "-variableSetSelect\">Select Variable Set</label>\n                    <select class=\"selectpicker\" id=\"", "-variableSetSelect\" @change=\"", "\"\n                            on-dom-change=\"renderDomRepeat\" data-width=\"auto\">\n                        <!--<select class=\"form-control\" id=\"variableSetSelect\" style=\"width: 100%\"-->\n                        <!--on-change=\"onSelectedVariableSetChange\">-->\n                        ", "\n                    </select>\n                "]);

  opencga_annotation_comparator_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_annotation_comparator_templateObject2() {
  const data = opencga_annotation_comparator_taggedTemplateLiteral(["\n                <!-- Annotations -->\n                ", "\n                <table id=\"", "-ac-table\" data-test-id=\"variant-sample-grid-sample-selector\" data-show-columns=\"true\" data-show-export=\"true\"\n                       data-page-size=\"100\">\n                </table>\n            "]);

  opencga_annotation_comparator_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_annotation_comparator_templateObject() {
  const data = opencga_annotation_comparator_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .plus-button {\n                color: #00AA33;\n                cursor: pointer;\n            }\n\n            .plus-button:hover {\n                color: #009c2c;\n            }\n        </style>\n\n        <div id=\"", "-main-annotation-comparator-div\">\n            ", "\n\n            \n        </div>\n        "]);

  opencga_annotation_comparator_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_annotation_comparator_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



class opencga_annotation_comparator_OpencgaAnnotationComparator extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      entryIds: {
        type: Array
      },
      entity: {
        // Allowed values are SAMPLE,INDIVIDUAL,COHORT,FAMILY
        type: String
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    // super.ready();
    this._prefix = "oac-" + utils.randomString(6);
    this._config = {};
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession")) {
      this.opencgaSessionObserver();
    }

    if (changedProperties.has("entryIds")) {
      this.entryIdsObserver();
    }
  }

  opencgaSessionObserver() {
    this.variableSets = [];
    this.variables = [];

    if (typeof this.opencgaSession.study === "undefined") {
      return;
    }

    if (typeof this.opencgaSession.study.variableSets !== "undefined") {
      this._updateVariableSets(this.opencgaSession.study);
    } else {
      let _this = this;

      this.opencgaClient.studies().info(this.opencgaSession.study.id, {
        include: "variableSets"
      }).then(function (response) {
        _this._updateVariableSets(response.response[0].result[0]);
      }).catch(function () {
        _this.multipleVariableSets = false; // Hide all selectpicker selectors

        $("#".concat(this._prefix, "-variableSetSelect")).selectpicker("hide");
        console.log("Could not obtain the variable sets of the study " + _this.opencgaSession.study);
      });
    }
  }

  entryIdsObserver() {
    if (this.entryIds.length === 0 || utilsNew_UtilsNew.isEmpty(this.entity)) {
      $("#".concat(this._prefix, "-ac-table")).bootstrapTable("destroy");
      return;
    }

    let client = undefined;

    switch (this.entity) {
      case "SAMPLE":
        client = this.opencgaClient.samples();
        break;

      case "INDIVIDUAL":
        client = this.opencgaClient.individuals();
        break;

      case "COHORT":
        client = this.opencgaClient.cohorts();
        break;

      case "FAMILY":
        client = this.opencgaClient.families();
        break;

      case "FILE":
        client = this.opencgaClient.files();
        break;

      default:
        console.error("Unexpected entity value passed to annotation-comparator webcomponent");
        return;
    } // Extract sample ids


    let entryIds = [];

    for (let i in this.entryIds) {
      entryIds.push(this.entryIds[i].id);
    }

    let _this = this;

    client.info(entryIds.join(","), {
      study: this.opencgaSession.study.id,
      include: "annotationSets,id",
      flattenAnnotations: true
    }).then(function (response) {
      // Get the selected variableSet
      let variableSet = $("button[data-id=".concat(_this._prefix, "-variableSetSelect]"))[0].title;

      for (let i in _this.variableSets) {
        if (_this.variableSets[i].id === variableSet) {
          _this.selectedVariableSet = _this.variableSets[i];
          break;
        }
      }

      let variables = _this.flattenVariableArray(_this.selectedVariableSet.variables); // We create a temporal map to be able to update each variable with the annotation values directly


      let variableMap = {};

      for (let i in variables) {
        variableMap[variables[i].id] = variables[i];
      }

      let samples = [];

      for (let i in response.response) {
        let tmpSample = {};

        for (let j in response.response[i].result) {
          let sample = response.response[i].result[j];
          tmpSample["id"] = sample.id;
          tmpSample["annotations"] = []; // We check all the different annotations

          for (let w in sample.annotationSets) {
            let annotationSet = sample.annotationSets[w];

            if (annotationSet.variableSetId !== _this.selectedVariableSet.id) {
              // The current annotation set does not annotate the selected variable set
              continue;
            }

            tmpSample["annotations"].push(annotationSet.id);
            let id = "".concat(sample.id, ":").concat(annotationSet.id);

            for (let z in annotationSet.annotations) {
              _this._processAnnotations(variableMap, {
                id: z,
                value: annotationSet.annotations[z]
              }, id); // variableMap[annotationSet.annotations[z].name].annotations[id] = annotationSet.annotations[z].value;

            }
          }
        }

        if (tmpSample.annotations.length > 0) {
          samples.push(tmpSample);
        }
      }

      _this.buildNewTable(samples, variables);
    }).catch(function (response) {
      $("#".concat(_this._prefix, "-ac-table")).bootstrapTable("destroy");
      debugger;
    });
  }

  _processAnnotations(variableMap, annotation, id) {
    if (variableMap[annotation.id].type !== "OBJECT") {
      variableMap[annotation.id].annotations[id] = annotation.value;
      return;
    }

    if (typeof variableMap[annotation.id].variableSet === "undefined" || variableMap[annotation.id].variableSet.length === 0) {
      // We don't expect more annotations
      variableMap[annotation.id].annotations[id] = "".concat(JSON.stringify(annotation.value).substring(0, 30), "...");
    } // We are processing a complex annotation.


    let annotations = {};

    if (variableMap[annotation.id].multiValue) {
      // We expect an array
      for (let i in annotation.value) {
        this._processComplexAnnotations(annotations, variableMap, annotation.value[i], annotation.id, true);
      }
    } else {
      this._processComplexAnnotations(annotations, variableMap, annotation.value, annotation.id, false);
    }

    for (let key in annotations) {
      if (Array.isArray(annotations[key])) {
        variableMap[key].annotations[id] = annotations[key].join(", ");
      } else {
        variableMap[key].annotations[id] = annotations[key];
      }
    } // debugger

  }

  _processComplexAnnotations(returnedAnnotation, variableMap, annotation, fullAnnotationId, isArray) {
    for (let key in annotation) {
      let currentVariable = "".concat(fullAnnotationId, ".").concat(key);

      if (variableMap[currentVariable].type !== "OBJECT") {
        this._addAnnotationValue(returnedAnnotation, currentVariable, annotation[key], isArray);

        continue;
      }

      if (typeof variableMap[currentVariable].variableSet === "undefined" || variableMap[currentVariable].variableSet.length === 0) {
        let value = "".concat(JSON.stringify(annotation[key]).substring(0, 30), "...");

        this._addAnnotationValue(returnedAnnotation, currentVariable, value, isArray);

        continue;
      } // We are processing a complex annotation


      if (Array.isArray(annotation[key])) {
        for (let i in annotation[key]) {
          this._processComplexAnnotations(returnedAnnotation, variableMap, annotation[key][i], currentVariable, isArray || variableMap[currentVariable].multiValue);
        }
      } else {
        this._processComplexAnnotations(returnedAnnotation, variableMap, annotation[key], currentVariable, isArray || variableMap[currentVariable].multiValue);
      }
    }
  }

  _addAnnotationValue(returnedAnnotation, currentVariable, value, isArray) {
    if (isArray) {
      if (typeof returnedAnnotation[currentVariable] === "undefined") {
        returnedAnnotation[currentVariable] = [];
      }

      returnedAnnotation[currentVariable].push(value);
    } else {
      returnedAnnotation[currentVariable] = value;
    }
  }

  buildNewTable(samples, variables) {
    $("#".concat(this._prefix, "-ac-table")).bootstrapTable("destroy");

    if (samples.length === 0) {
      return;
    }

    let columnsFirstLevel = [{
      title: "Variable",
      field: "variable",
      rowspan: 2
    }];
    let columnsSecondLevel = [];

    for (let i in samples) {
      if (samples[i].annotations.length > 1) {
        columnsFirstLevel.push({
          title: samples[i].id,
          colspan: samples[i].annotations.length
        });

        for (let j in samples[i].annotations) {
          columnsSecondLevel.push({
            title: samples[i].annotations[j],
            field: "".concat(samples[i].id, ":").concat(samples[i].annotations[j])
          });
        }
      } else {
        columnsFirstLevel.push({
          title: samples[i].id,
          colspan: 1,
          rowspan: 2,
          field: "".concat(samples[i].id, ":").concat(samples[i].annotations[0])
        });
      }
    }

    let columns = [columnsFirstLevel, columnsSecondLevel];
    let data = [];

    for (let i in variables) {
      data.push(variables[i].annotations);
    }

    $("#".concat(this._prefix, "-ac-table")).bootstrapTable({
      columns: columns,
      data: data
    });
  }

  flattenVariableArray(variables) {
    return this._flattenVariableArray(variables, []);
  }

  _flattenVariableArray(variables, tags) {
    let displayVariables = [];

    for (let i in variables) {
      let variable = variables[i];

      if (variable.type !== "OBJECT") {
        // Add variable
        displayVariables.push({
          id: tags.concat(variable.id).join("."),
          name: variable.name,
          category: variable.category,
          type: variable.type,
          defaultValue: variable.defaultValue,
          multiValue: variable.multiValue,
          allowedValues: variable.allowedValues,
          annotations: {
            variable: tags.concat(variable.id).join(".")
          }
        });
      } else {
        // Add variable
        displayVariables.push({
          id: tags.concat(variable.id).join("."),
          name: variable.name,
          category: variable.category,
          type: variable.type,
          defaultValue: variable.defaultValue,
          multiValue: variable.multiValue,
          allowedValues: variable.allowedValues,
          annotations: {
            variable: tags.concat(variable.id).join(".")
          },
          variableSet: variable.variableSet
        });
        displayVariables = displayVariables.concat(this._flattenVariableArray(variable.variableSet, tags.concat(variable.id)));
      }
    }

    return displayVariables;
  }

  _updateVariableSets(study) {
    if (typeof study.variableSets === "undefined") {
      this.variableSets = [];
    } else {
      this.variableSets = study.variableSets;
    }

    if (this.variableSets.length > 0) {
      // this.variables = this.parseVariableForDisplay(this.variableSets[0].variables); // select first one by default
      // Show selectpicker selector
      $("#".concat(this._prefix, "-variableSetSelect")).selectpicker("show");
      this.multipleVariableSets = this.variableSets.length > 1;
    } else {
      this.multipleVariableSets = false; // Hide selectpicker selector

      $("#".concat(this._prefix, "-variableSetSelect")).selectpicker("hide");
    }
  }

  renderDomRepeat(e) {
    $("select.selectpicker", this).selectpicker("refresh");
    $("select.selectpicker", this).selectpicker("deselectAll");
  }

  getDefaultConfig() {
    return {
      variableSelector: {
        marginLeft: 20,
        marginStep: 15
      },
      class: "",
      buttonClass: "",
      inputClass: ""
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_annotation_comparator_templateObject(), this._prefix, this.variableSets.length ? lit_html_lit_html_html(opencga_annotation_comparator_templateObject2(), this.multipleVariableSets ? lit_html_lit_html_html(opencga_annotation_comparator_templateObject3(), this._prefix, this._prefix, this.entryIdsObserver, this.variableSets && this.variableSets.length && this.variableSets.map(item => lit_html_lit_html_html(opencga_annotation_comparator_templateObject4()))) : null, this._prefix) : lit_html_lit_html_html(opencga_annotation_comparator_templateObject5()));
  }

}
customElements.define("opencga-annotation-comparator", opencga_annotation_comparator_OpencgaAnnotationComparator);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/family/opencga-family-browser.js
function opencga_family_browser_templateObject2() {
  const data = opencga_family_browser_taggedTemplateLiteral(["\n            <div class=\"page-title\">\n                <h2>\n                    <i class=\"fa fa-users\" aria-hidden=\"true\"></i> </i>&nbsp;", "\n                </h2>\n            </div>\n        "]);

  opencga_family_browser_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_family_browser_templateObject() {
  const data = opencga_family_browser_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .icon-padding {\n                padding-left: 4px;\n                padding-right: 5px;\n            }\n\n            .detail-tab-title {\n                font-size: 115%;\n                font-weight: bold;\n            }\n        </style>\n\n        ", "\n        <div class=\"row\" style=\"padding: 0px 10px\">\n            <div class=\"col-md-2\">\n                <opencga-family-filter .opencgaSession=\"", "\"\n                                       .config=\"", "\"\n                                       .families=\"", "\"\n                                       .opencgaClient=\"", "\"\n                                       .search=\"", "\"\n                                       .query=\"", "\"\n                                        @queryChange=\"", "\"\n                                        @querySearch=\"", "\">\n                </opencga-family-filter>\n            </div>\n\n            <div class=\"col-md-10\">\n                <opencga-active-filters .opencgaSession=\"", "\"\n                                        .query=\"", "\"\n                                        .refresh=\"", "\"\n                                        .defaultStudy=\"", "\"\n                                        .config=\"", "\"\n                                        .alias=\"", "\"\n                                        @activeFilterClear=\"", "\"\n                                        @activeFilterChange=\"", "\">\n                </opencga-active-filters>\n\n                <!-- Family View Buttons -->\n                <div class=\"col-md-12\" style=\"padding: 5px 0px 5px 0px\">\n                    <div class=\"btn-toolbar\" role=\"toolbar\" aria-label=\"...\" style=\"padding: 10px 0px;margin-left: 0px\">\n                        <div class=\"btn-group\" role=\"group\" style=\"margin-left: 0px\">\n                            <button type=\"button\" class=\"btn btn-success family-browser-view-buttons ripple active\" data-view=\"TableResult\" @click=\"", "\" data-id=\"table\">\n                                <i class=\"fa fa-table icon-padding\" aria-hidden=\"true\" data-view=\"TableResult\" @click=\"", "\" data-id=\"table\"></i> Table Result\n                            </button>\n                            <button type=\"button\" class=\"btn btn-success family-browser-view-buttons ripple \" data-view=\"Summary\" @click=\"", "\" .disabled=\"", "\">\n                                <i class=\"fas fa-chart-bar icon-padding\" aria-hidden=\"true\" data-view=\"Summary\" @click=\"", "\"></i> Summary Stats\n                            </button>\n                            <button type=\"button\" class=\"btn btn-success family-browser-view-buttons ripple \" data-view=\"FamilyComparator\" @click=\"", "\" data-id=\"comparator\" .disabled=\"", "\">\n                                <i class=\"fa fa-users icon-padding\" aria-hidden=\"true\" data-view=\"FamilyComparator\" @click=\"", "\" data-id=\"comparator\"></i> Family Comparator\n                            </button>\n                        </div>\n                    </div>\n                </div>\n\n\n                <!-- Family View Content -->\n                <div>\n                    <div id=\"", "TableResult\" class=\"family-browser-view-content\">\n                        <opencga-family-grid .opencgaClient=\"", "\"\n                                             .opencgaSession=\"", "\"\n                                             .query=\"", "\"\n                                             .config=\"", "\"\n                                             .eventNotifyName=\"", "\"\n                                             .families=\"", "\"\n                                             .search=\"", "\"\n                                             .active=\"", "\"\n                                             @selectfamily=\"", "\">\n                        </opencga-family-grid>\n                    </div>\n\n                    <div id=\"", "Summary\" class=\"family-browser-view-content\" style=\"display: none\">\n                        <opencb-facet-query resource=\"families\"\n                                            .opencgaSession=\"", "\"\n                                            .cellbaseClient=\"", "\"  \n                                            .config=\"", "\"\n                                            .query=\"", "\"\n                                            .active=\"", "\">\n                        </opencb-facet-query>\n                    </div>\n\n                    <div id=\"", "FamilyComparator\" class=\"family-browser-view-content\" style=\"display: none\">\n                        <opencga-family-grid .opencgaClient=\"", "\"\n                                             .opencgaSession=\"", "\"\n                                             .config=\"", "\"\n                                             .eventNotifyName=\"", "\"\n                                             .families=\"", "\"\n                                             .search=\"", "\" style=\"font-size: 12px\"\n                                             .active=\"", "\">\n                        </opencga-family-grid>\n\n                        <div style=\"padding-top: 5px\">\n                            <h3> Annotation comparator</h3>\n                            <opencga-annotation-viewer .opencgaClient=\"", "\"\n                                                        .opencgaSession=\"", "\"\n                                                        .config=\"", "\"\n                                                        .entryIds=\"", "\"\n                                                        entity=\"INDIVIDUAL\">\n                            </opencga-annotation-viewer>\n                        </div>\n\n                    </div>\n                </div>\n\n            </div>\n        </div>\n        "]);

  opencga_family_browser_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_family_browser_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_family_browser_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_family_browser_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_family_browser_ownKeys(Object(source), true).forEach(function (key) { opencga_family_browser_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_family_browser_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_family_browser_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
//TODO check functionality









class opencga_family_browser_OpencgaFamilyBrowser extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      filters: {
        type: Object,
        notify: true
      },
      //TODO remove
      search: {
        type: Object,
        notify: true
      },
      config: {
        type: Object
      },
      query: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "osb-" + utils.randomString(6);
    this.families = [];
    this._config = this.getDefaultConfig(); // this.filtersConfig = {
    //     complexFields: ["annotation"]
    // };
  }

  updated(changedProperties) {
    if (changedProperties.has("config")) {
      this.configObserver();
    }

    if (changedProperties.has("filters")) {
      this.onFilterUpdate();
    }

    if (changedProperties.has("opencgaClient")) {//this.renderAnalysisTable(); it doesn't exists
    }

    if (changedProperties.has("families")) {
      this.familyObserver();
    }

    if (changedProperties.has("opencgaSession") || changedProperties.has("config")) {
      this.filterAvailableVariableSets(this.opencgaSession, this.config);
    }

    if (changedProperties.has("query")) {
      this.queryObserver();
    }
  }

  connectedCallback() {
    super.connectedCallback();
    this.activeMenu = {
      table: true,
      comparator: false
    };
    this.detailActiveTabs = {
      info: true,
      sampleGrid: false
    };
  }

  configObserver() {
    this._config = Object.assign(this.getDefaultConfig(), this.config);
  }

  queryObserver() {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query)) {
      this.preparedQuery = opencga_family_browser_objectSpread({}, this.query);
      this.executedQuery = opencga_family_browser_objectSpread({}, this.query);
    }

    this.requestUpdate();
  }

  familyObserver() {
    this.dispatchEvent(new CustomEvent("familychange", {
      detail: {
        families: this.families
      },
      bubbles: true,
      composed: true
    }));
  }

  onClear() {
    this._config = Object.assign(this.getDefaultConfig(), this.config);
    this.query = {}; // this.query = {studies: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias};

    this.search = {};
  }

  onActiveFilterChange(e) {
    this.query = e.detail;
    this.search = e.detail;
  }

  onSelectFamily(e) {
    this.family = e.detail.family;
    const memberList = [];

    for (let i = 0; i < this.family.members.length; i++) {
      memberList.push(this.family.members[i].id);
    }

    this.memberSearch = {
      id: memberList.join(",")
    };
    this.dispatchEvent(new CustomEvent("selectfamily", {
      detail: {
        family: this.family
      }
    }));
  }

  _changeBottomTab(e) {
    const _activeTabs = {
      info: e.currentTarget.dataset.id === "info",
      sampleGrid: e.currentTarget.dataset.id === "sampleGrid"
    };
    this.detailActiveTabs = _activeTabs;
  }

  _changeView(e) {
    e.preventDefault(); // prevents the hash change to "#" and allows to manipulate the hash fragment as needed

    const activeMenu = {
      table: e.currentTarget.dataset.id === "table",
      comparator: e.currentTarget.dataset.id === "comparator"
    };
    this.activeMenu = activeMenu;
    $(".family-browser-view-content").hide(); // hides all content divs

    if (typeof e.target !== "undefined" && typeof e.target.dataset.view !== "undefined") {
      PolymerUtils_PolymerUtils.show(this._prefix + e.target.dataset.view);
    } // Show the active button


    $(".family-browser-view-buttons").removeClass("active");
    $(e.target).addClass("active");

    if (e.target.dataset.view === "Summary") {
      this.SummaryActive = true;
      this.requestUpdate();
    } else {
      this.SummaryActive = false;
    }

    this.requestUpdate();
  }

  filterAvailableVariableSets(opencgaSession, config) {
    if (this._config.variableSetIds.length === 0 && utilsNew_UtilsNew.isNotUndefinedOrNull(opencgaSession.study)) {
      this.variableSets = opencgaSession.study.variableSets;
    } else {
      const variableSets = [];

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(opencgaSession.study) && utilsNew_UtilsNew.isNotEmptyArray(opencgaSession.study.variableSets)) {
        for (let i = 0; i < opencgaSession.study.variableSets.length; i++) {
          if (this._config.variableSetIds.indexOf(opencgaSession.study.variableSets[i].id) !== -1) {
            variableSets.push(opencgaSession.study.variableSets[i]);
          }
        }
      }

      this.variableSets = variableSets;
    }
  }

  executeFacet() {}

  onQueryFilterChange(e) {
    console.log("onQueryFilterChange on family browser", e.detail.query);
    this.preparedQuery = e.detail.query;
    this.requestUpdate();
  }

  onQueryFilterSearch(e) {
    this.preparedQuery = e.detail.query;
    this.executedQuery = e.detail.query;
    this.requestUpdate();
  }

  onActiveFilterChange(e) {
    this.preparedQuery = opencga_family_browser_objectSpread({}, e.detail);
    this.query = opencga_family_browser_objectSpread({}, e.detail);
    this.requestUpdate();
  }

  onActiveFilterClear() {
    this.query = {}; //this.search = {};

    this.preparedQuery = {};
    this.requestUpdate();
  }

  getDefaultConfig() {
    return {
      title: "Family Browser",
      showTitle: true,
      showAggregationStats: true,
      showComparator: true,
      filter: {},
      grid: {
        pageSize: 10,
        pageList: [10, 25, 50],
        detailView: true,
        multiSelection: false
      },
      gridComparator: {
        pageSize: 5,
        pageList: [5, 10],
        detailView: true,
        multiSelection: true
      },
      familyDetail: {
        showTitle: false
      },
      variableSetIds: [],
      activeFilters: {
        complexFields: ["annotation"]
      },
      summary: {
        fields: ["name"]
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_family_browser_templateObject(), this._config.showTitle ? lit_html_lit_html_html(opencga_family_browser_templateObject2(), this._config.title) : null, this.opencgaSession, this._config.filter, this.families, this.opencgaSession.opencgaClient, this.search, this.query, this.onQueryFilterChange, this.onQueryFilterSearch, this.opencgaSession, this.preparedQuery, this.executedQuery, this.opencgaSession.study.alias, this._config.activeFilters, this.activeFilterAlias, this.onActiveFilterClear, this.onActiveFilterChange, this._changeView, this._changeView, this._changeView, !this._config.showAggregationStats, this._changeView, this._changeView, !this._config.showComparator, this._changeView, this._prefix, this.opencgaSession.opencgaClient, this.opencgaSession, this.executedQuery, this._config.grid, this.eventNotifyName, this.families, this.search, this.activeMenu.table, this.onSelectFamily, this._prefix, this.opencgaSession, this.cellbaseClient, this._config, this.executedQuery, this.SummaryActive, this._prefix, this.opencgaSession.opencgaClient, this.opencgaSession, this._config.gridComparator, this.eventNotifyName, this.families, this.search, this.activeMenu.comparator, this.opencgaSession.opencgaClient, this.opencgaSession, this._config.gridComparator, this.families);
  }

}
customElements.define("opencga-family-browser", opencga_family_browser_OpencgaFamilyBrowser);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/clinical/opencga-clinical-analysis-editor.js
function opencga_clinical_analysis_editor_templateObject8() {
  const data = opencga_clinical_analysis_editor_taggedTemplateLiteral(["\n                                                <option value=\"", "\" data-value=\"", "\">", "</option>\n                                            "]);

  opencga_clinical_analysis_editor_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_editor_templateObject7() {
  const data = opencga_clinical_analysis_editor_taggedTemplateLiteral(["\n                                    <div class=\"form-group\" style=\"padding-top: 10px\">\n                                        <label class=\"control-label col-md-1 jso-label-title\">Search Proband</label>\n                                        <div class=\"col-md-1\">\n                                            <button id=\"", "-browseIndividual2\" class=\"btn btn-sm btn-primary\"\n                                                    data-toggle=\"modal\" data-placement=\"bottom\" @click=\"", "\"\n                                                    style=\"display: inline\">Browse...</button>\n                                        </div>\n                                    </div>\n                                "]);

  opencga_clinical_analysis_editor_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_editor_templateObject6() {
  const data = opencga_clinical_analysis_editor_taggedTemplateLiteral(["\n                                    <div class=\"form-group\" style=\"padding-top: 10px\">\n                                        <label class=\"control-label col-md-1 jso-label-title\">Search Family</label>\n                                        <div class=\"col-md-1\">\n                                            <!--Search family-->\n                                            <button id=\"", "-browseFamily2\" class=\"btn btn-sm btn-primary\"\n                                                    data-toggle=\"modal\" data-placement=\"bottom\" @click=\"", "\"\n                                                    style=\"display: inline\">Browse...</button>\n                                        </div>\n                                        <div>\n                                            <a @click=\"", "\" class=\"col-md-2\" style=\"cursor:pointer;\">\n                                                Don't have a family?\n                                            </a>\n                                        </div>\n                                    </div>\n                                "]);

  opencga_clinical_analysis_editor_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_editor_templateObject5() {
  const data = opencga_clinical_analysis_editor_taggedTemplateLiteral(["\n                                                <option value=\"", "\" data-value=\"", "\">", "</option>\n                                            "]);

  opencga_clinical_analysis_editor_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_editor_templateObject4() {
  const data = opencga_clinical_analysis_editor_taggedTemplateLiteral(["\n                                                <option value=\"", "\">", "</option>\n                                            "]);

  opencga_clinical_analysis_editor_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_editor_templateObject3() {
  const data = opencga_clinical_analysis_editor_taggedTemplateLiteral(["\n                                            <div class=\"input-group\">\n                                                <input type=\"text\" id=\"", "Id\" class=\"", "Input form-control\"\n                                                       placeholder=\"ID of the case\" data-field=\"id\" @input=\"", "\">\n                                                <span class=\"input-group-btn\">\n                                                <button class=\"btn btn-default\" type=\"button\">\n                                                    <i class=\"fa fa-search\" aria-hidden=\"true\"></i>\n                                                </button>\n                                            </span>\n                                            </div>\n                                        "]);

  opencga_clinical_analysis_editor_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_editor_templateObject2() {
  const data = opencga_clinical_analysis_editor_taggedTemplateLiteral(["\n                                            <input type=\"text\" id=\"", "Id\" class=\"", "Input form-control\"\n                                                   placeholder=\"ID of the case\" data-field=\"id\" @input=\"", "\" value=\"", "\">\n                                        "]);

  opencga_clinical_analysis_editor_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_editor_templateObject() {
  const data = opencga_clinical_analysis_editor_taggedTemplateLiteral(["\n        <style>\n            .form-section-title {\n                padding: 5px 0px;\n                width: 80%;\n                border-bottom-width: 1px;\n                border-bottom-style: solid;\n                border-bottom-color: #ddd\n            }\n\n            .jso-label-title {\n                width: 15em !important;\n            }\n        </style>\n\n        <div class=\"container-fluid\">\n                <div class=\"row\">\n                    <div class=\"col-md-12\">\n        \n                        <!--<div>-->\n                            <!--<h2 style=\"margin-top: 10px\"></i> {{_config.title}}</h2>-->\n                        <!--</div>-->\n        \n                        <div style=\"padding: 10px 10px;\">\n                            <div>\n                                <h4 class=\"form-section-title\">Case Information</h4>\n                            </div>\n        \n                            <div class=\"form-horizontal\" style=\"padding: 5px 10px\">\n        \n                                <div class=\"form-group\" style=\"padding-top: 10px\">\n                                    <label class=\"control-label col-md-1 jso-label-title\">Analysis ID</label>\n                                    <div class=\"col-md-3\">\n                                        ", "\n                                    </div>\n                                </div>\n        \n                                <div class=\"form-group\">\n                                    <label class=\"control-label col-md-1 jso-label-title\">Analysis Type</label>\n                                    <div class=\"col-md-3\">\n                                        <select class=\"selectpicker\" data-width=\"100%\" id=\"", "Type\" data-field=\"type\" data-field-type=\"string\"\n                                                @change=\"", "\">\n                                            <option value=\"SINGLE\">Single</option>\n                                            <option value=\"FAMILY\">Family</option>\n                                            <option value=\"CANCER\">Cancer</option>\n                                            <option value=\"COHORT\">Cohort</option>\n                                            <option value=\"AUTOCOMPARATIVE\">Autocomparative</option>\n                                        </select>\n                                    </div>\n                                </div>\n        \n                                <div class=\"form-group\">\n                                    <label class=\"control-label col-md-1 jso-label-title\">Interpretation Flags</label>\n                                    <div class=\"col-md-3\">\n                                        <!-- TODO CHECK on-dom-change=\"renderDomRepeat\"-->\n                                        <select class=\"selectpicker\" data-width=\"100%\" id=\"", "Flags\" data-field=\"flags\" data-field-type=\"array\"\n                                                @change=\"", "\" on-dom-change=\"renderDomRepeat\" multiple data-selected-text-format=\"count > 2\">\n                                            ", "\n                                        </select>\n                                    </div>\n                                </div>\n        \n                                <div class=\"form-group\">\n                                    <label class=\"control-label col-md-1 jso-label-title\">Priority</label>\n                                    <div class=\"col-md-3\">\n                                        <select class=\"selectpicker\" data-width=\"100%\" id=\"", "Priority\" data-field=\"priority\" data-field-type=\"string\"\n                                                @change=\"", "\">\n                                            <option style=\"color: red\" value=\"URGENT\">Urgent</option>\n                                            <option style=\"color: orange\" value=\"HIGH\">High</option>\n                                            <option style=\"color: blue\" value=\"MEDIUM\" selected>Medium</option>\n                                            <option style=\"color: green\" value=\"LOW\">Low</option>\n                                        </select>\n                                    </div>\n                                </div>\n        \n                                <div class=\"form-group\">\n                                    <label class=\"control-label col-md-1 jso-label-title\">Assigned To</label>\n                                    <div class=\"col-md-3\">\n                                        <!-- TODO CHECK on-dom-change=\"renderDomRepeat\"-->\n                                        <select class=\"selectpicker\" data-width=\"100%\" id=\"", "Assigned\" data-field=\"assigned\" data-field-type=\"object\"\n                                                @change=\"", "\" on-dom-change=\"renderDomRepeat\">\n                                            ", "\n                                        </select>\n                                    </div>\n                                </div>\n        \n                                <div class=\"form-group\">\n                                    <label class=\"control-label col-md-1 jso-label-title\">Due Date</label>\n                                    <div class=\"date col-md-3\">\n                                        <div class='input-group date' id=\"", "DuePickerDate\">\n                                            <input type='text' id=\"", "DueDate\" class=\"", "Input form-control\" data-field=\"dueDate\" @input=\"", "\" />\n                                            <span class=\"input-group-addon\">\n                                            <span class=\"fa fa-calendar\"></span>\n                                        </span>\n                                        </div>\n                                    </div>\n                                </div>\n        \n                                <div class=\"form-group\">\n                                    <label class=\"control-label col-md-1 jso-label-title\">Description</label>\n                                    <div class=\"col-md-3\">\n                                        <textarea id=\"", "Description\" class=\"", "Input form-control\"\n                                                  placeholder=\"Description of the case\" data-field=\"description\" @input=\"", "\"></textarea>\n                                    </div>\n                                </div>\n                            </div>\n        \n        \n                            <div>\n                                <h4 class=\"form-section-title\">Proband and Disease</h4>\n                            </div>\n        \n                            <div class=\"form-horizontal\" style=\"padding: 10px 10px\">\n                                ", "\n                                \n                                <div class=\"form-group\">\n                                    <label class=\"control-label col-md-1 jso-label-title\">Disorder</label>\n                                    <div class=\"col-md-3\">\n                                        <!-- TODO CHECK on-dom-change=\"renderDomRepeat\"-->\n                                        <select class=\"selectpicker\" data-width=\"100%\" id=\"", "Disorder\" data-field=\"disorder\" data-field-type=\"object\"\n                                                @change=\"", "\" on-dom-change=\"renderDomRepeat\">\n                                            ", "\n                                        </select>\n                                    </div>\n                                </div>\n        \n                                <div class=\"form-group\">\n                                    <label class=\"control-label col-md-1 jso-label-title\">Sample Configuration:</label>\n                                    <div id=\"", "GridTableDiv\" class=\"col-md-11 col-md-offset-1\" style=\"padding: 10px 20px\">\n                                        <table id=\"", "IndividualBrowserGrid\">\n                                        </table>\n                                    </div>\n                                </div>\n                            </div>\n        \n        \n                        </div>\n                    </div>\n        \n                    <div class=\"col-md-2 col-md-offset-2\">\n                        <!--<div class=\"form-group\">-->\n                        <!--<div class=\"col-md-2\" style=\"float: right\">-->\n                        <button id=\"", "Clear\" class=\"btn btn-primary\" @click=\"", "\">Clear</button>\n                        <button id=\"", "Ok\" class=\"btn btn-primary\" @click=\"", "\">Create</button>\n                        <!--</div>-->\n                        <!--</div>-->\n                    </div>\n                </div>\n        \n                <!-- Modal: Individual browser -->\n                <div class=\"modal fade\" id=\"", "IndividualBrowser\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"individualBrowserLabel\">\n                    <div class=\"modal-dialog modal-lg\" role=\"document\" style=\"width: 90%;\">\n                        <div class=\"modal-content\">\n                            <div class=\"modal-header\">\n                                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n                                <h4 class=\"modal-title\" id=\"", "IndividualBrowserLabel\">Individual Selector</h4>\n                            </div>\n                            <div class=\"modal-body\" style=\"height: 780px\">\n                                <opencga-individual-browser .opencgaSession=\"", "\"\n                                                            .config=\"", "\"\n                                                            @selectindividual=\"", "\">\n                                </opencga-individual-browser>\n                            </div>\n                            <div class=\"modal-footer\">\n                                <button type=\"button\" class=\"btn btn-primary\" data-dismiss=\"modal\">\n                                    OK\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n        \n                <!-- Modal: Family browser -->\n                <div class=\"modal fade\" id=\"", "FamilyBrowser\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"familyBrowserLabel\">\n                    <div class=\"modal-dialog modal-lg\" role=\"document\" style=\"width: 90%;\">\n                        <div class=\"modal-content\">\n                            <div class=\"modal-header\">\n                                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n                                <h4 class=\"modal-title\" id=\"", "FamilyBrowserLabel\">Family Selector</h4>\n                            </div>\n                            <div class=\"modal-body\" style=\"height: 780px\">\n                                <opencga-family-browser .opencgaSession=\"", "\"\n                                                        .config=\"", "\"\n                                                        @selectfamily=\"", "\">\n                                </opencga-family-browser>\n                            </div>\n                            <div class=\"modal-footer\">\n                                <button type=\"button\" class=\"btn btn-primary\" data-dismiss=\"modal\">\n                                    OK\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n        </div>\n\n        <!--<table id=\"", "IndividualBrowserGrid\">-->\n        <!--<thead style=\"background-color: #eee\"></thead>-->\n        <!--</table>-->\n\n        <!-- Same window: Family editor -->\n        <!--<template is=\"dom-if\" if=\"{{createFamily}}\">-->\n        <!--<button type=\"button\" style=\"float: right; margin: 30px 30px 0px 0px;\" class=\"btn btn-success\" on-click=\"backToClinicalView\">BACK</button>-->\n        <!--<opencga-family-editor opencga-session=\"{{opencgaSession}}\" config=\"[[familyBrowserConfig]]\"></opencga-family-editor>-->\n        <!--</template>-->\n        "]);

  opencga_clinical_analysis_editor_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_editor_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */








 // TODO recheck functionality
//TODO CHECK on-dom-change="renderDomRepeat"

class opencga_clinical_analysis_editor_OpencgaClinicalAnalysisEditor extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      clinicalAnalysis: {
        type: Object
      },
      mode: {
        type: String
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ocab-" + utils.randomString(6) + "_";
    this._config = this.getDefaultConfig();
    this._individuals = [];
    this._disorders = [];
    this.isCreate = false;
    this.notifyEnabled = true;
    this.catalogUiUtils = new CatalogUIUtils_CatalogUIUtils();
    this.createButtonStatus = "disabled";
    this.familyBrowserConfig = {
      title: "Family Browser",
      showTitle: true,
      showAggregationStats: false,
      showComparator: false,
      filter: {},
      grid: {
        pageSize: 5,
        pageList: [5, 10],
        detailView: false,
        multiSelection: false
      },
      variableSetIds: []
    };
    this.individualBrowserConfig = {
      title: "Individual Browser",
      showTitle: true,
      showAggregationStats: false,
      showComparator: false,
      filter: {},
      grid: {
        pageSize: 5,
        pageList: [5, 10],
        detailView: false,
        multiSelection: false
      },
      variableSetIds: []
    };
    this.mode = "create";
    this._clinicalAnalysis = {}; // FIXME quick fix needs a proper check
    //console.log("this._config",this._config)
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession") || changedProperties.has("clinicalAnalysis") || changedProperties.has("mode") || changedProperties.has("config")) {
      this.propertyObserver();
    }
  }

  firstUpdated(_changedProperties) {
    $("#" + this._prefix + "DuePickerDate").datetimepicker({
      format: "DD/MM/YYYY" // minDate: moment().add(1, "days"),
      // date: moment().add(1, "months")

    });
    $("select.selectpicker".this).selectpicker("render"); // Render default values when clinicalAnalysis property is not set

    if (utilsNew_UtilsNew.isUndefinedOrNull(this.clinicalAnalysis)) {
      this._clinicalAnalysis = this.getDefaultClinicalAnalysis();
    } else {
      // Merge default and passed clinical analysis, then notify.
      // let defaultClinicalAnalysis = this.getDefaultClinicalAnalysis();
      // this._clinicalAnalysis = Object.assign(defaultClinicalAnalysis, this.clinicalAnalysis);
      this._clinicalAnalysis = this.clinicalAnalysis; // this.notifyClinicalAnalysis();
    }

    this.fillForm(this._clinicalAnalysis);

    this._updateCreateButtonStatus(); // Render empty table
    // this.renderTable();

  }

  getDefaultClinicalAnalysis() {
    return {
      type: "FAMILY",
      priority: "MEDIUM",
      analyst: {
        assignee: this.opencgaSession.user.id
      },
      dueDate: moment().add(7, "days").format("DD/MM/YYYY")
    };
  } // TODO recheck functionality


  propertyObserver() {
    this._config = Object.assign(this.getDefaultConfig(), this.config); //console.log("this._config",this._config)
    // Set a private variable with all the users in this study: owner + @members group.
    // By default, the user creating the Case is selected as default

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.study) && utilsNew_UtilsNew.isNotEmptyArray(this.opencgaSession.study.groups)) {
      // let _studyUsers = [opencgaSession.user.id];
      for (const group of this.opencgaSession.study.groups) {
        if (group.id === "@members" || group.name === "@members") {
          this._studyUsers = group.userIds;
        }
      }
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.mode)) {
      this.isCreate = this.mode.toLowerCase() === "create";
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis)) {
      // Merge default and passed clinical analysis, then notify.
      // let defaultClinicalAnalysis = this.getDefaultClinicalAnalysis();
      // this._clinicalAnalysis = Object.assign(defaultClinicalAnalysis, clinicalAnalysis);
      this._clinicalAnalysis = this.clinicalAnalysis;
      this.fillForm(this._clinicalAnalysis); // this.notifyClinicalAnalysis();
    } //this.renderTable();
    //this.requestUpdate();

  }

  onSelectChange(e) {
    const field = e.currentTarget.dataset.field;
    const fieldCapital = field.charAt(0).toUpperCase() + field.slice(1);
    const select = PolymerUtils_PolymerUtils.getElementById(this._prefix + fieldCapital);

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(select) && utilsNew_UtilsNew.isNotEmpty(select.value)) {
      const selected = PolymerUtils_PolymerUtils.querySelectorAll("option:checked", select);
      const values = [];
      selected.forEach(option => values.push(option.value));

      if (e.currentTarget.dataset.fieldType === "string") {
        this._clinicalAnalysis[field] = values.join(",");
      } else if (e.currentTarget.dataset.fieldType === "array") {
        this._clinicalAnalysis[field] = values;
      } else {
        // Get the first element of values which contains the Disorder 'object' we want
        this._clinicalAnalysis[field] = JSON.parse(selected[0].dataset.value);
      }

      this._clinicalAnalysis = Object.assign({}, this._clinicalAnalysis);
      this.notifyClinicalAnalysis();
    }
  }

  onInputChange(e) {
    const field = e.currentTarget.dataset.field;
    const fieldCapital = field.charAt(0).toUpperCase() + field.slice(1);
    const text = PolymerUtils_PolymerUtils.getElementById(this._prefix + fieldCapital);

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(text)) {
      // && UtilsNew.isNotEmpty(text.value)
      this._clinicalAnalysis[field] = text.value;
      this._clinicalAnalysis = Object.assign({}, this._clinicalAnalysis);
      this.notifyClinicalAnalysis();

      this._updateCreateButtonStatus();
    }
  } //TODO move in template


  _updateCreateButtonStatus() {
    if (utilsNew_UtilsNew.isNotEmpty(this._clinicalAnalysis.id) && utilsNew_UtilsNew.isNotUndefinedOrNull(this._clinicalAnalysis.proband)) {
      PolymerUtils_PolymerUtils.getElementById("".concat(this._prefix, "Ok")).disabled = false;
    } else {
      PolymerUtils_PolymerUtils.getElementById("".concat(this._prefix, "Ok")).disabled = true;
    }

    this.requestUpdate();
  }

  fillForm(clinicalAnalysis) {
    if (utilsNew_UtilsNew.isUndefinedOrNull(clinicalAnalysis)) {
      console.log("'clinicalAnalysis' is undefined or null");
      return;
    }

    this.notifyEnabled = false; // We must first clear the form

    this.clear(); // Calculate some internal data and render the sample table

    this._individuals = this.getIndividualsFromClinicalAnalysis(clinicalAnalysis);
    this._disorders = this.getDisordersFromIndividuals(this._individuals);
    this.renderTable();

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.id)) {
      PolymerUtils_PolymerUtils.setValue(this._prefix + "Id", clinicalAnalysis.id);
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.type)) {
      $("#" + this._prefix + "Type").selectpicker("val", clinicalAnalysis.type);
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.assigned)) {
      $("#" + this._prefix + "Assigned").selectpicker("val", clinicalAnalysis.analyst.assignee);
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.priority)) {
      $("#" + this._prefix + "Priority").selectpicker("val", clinicalAnalysis.priority);
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.dueDate)) {
      PolymerUtils_PolymerUtils.setValue(this._prefix + "DueDate", clinicalAnalysis.dueDate);
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.flags)) {
      $("#" + this._prefix + "Flags").selectpicker("val", clinicalAnalysis.flags);
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.description)) {
      PolymerUtils_PolymerUtils.setValue(this._prefix + "Description", clinicalAnalysis.description);
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.disorder)) {
      $("#" + this._prefix + "Disorder").selectpicker("val", clinicalAnalysis.disorder.id);
    }

    this.notifyEnabled = true;
  }

  clear() {
    // Empty everything before rendering
    $("." + this._prefix + "Input").val("");
    $("." + this._prefix + "Input").prop("disabled", false); // Deselect bootstrap-select dropdowns

    $("#" + this._prefix + "Type").selectpicker("val", []);
    $("#" + this._prefix + "Assigned").selectpicker("val", []);
    $("#" + this._prefix + "Priority").selectpicker("val", []);
    $("#" + this._prefix + "Flags").selectpicker("val", []);
    $("#" + this._prefix + "Disorder").selectpicker("val", []);
  }

  notifyClinicalAnalysis() {
    // debugger
    if (this.notifyEnabled) {
      this.dispatchEvent(new CustomEvent("clinicalanalysischange", {
        detail: {
          clinicalAnalysis: this._clinicalAnalysis
        },
        bubbles: true,
        composed: true
      }));
    }
  }

  onIndividualSelect(e) {
    const individuals = [e.detail.individual];
    this._clinicalAnalysis.family = undefined;
    this.updateIndividual(individuals);
  }

  onFamilySelect(e) {
    this._clinicalAnalysis.family = e.detail.family;
    const individualIds = [];

    for (const individual of e.detail.family.members) {
      individualIds.push(individual.id);
    }

    const _this = this;

    this.opencgaSession.opencgaClient.individuals().search({
      id: individualIds.join(","),
      study: this.opencgaSession.study.fqn
    }).then(function (response) {
      _this._clinicalAnalysis.family.members = response.response[0].result;

      _this.updateIndividual(response.response[0].result);
    });
  }

  updateIndividual(individuals) {
    this._clinicalAnalysis.files = {}; // this._individuals = individuals;
    // Set the proband when there is just one individual

    console.warn("commented line for proband undefined (the case of one individual)"); //this._clinicalAnalysis.proband = undefined;
    // FIXME add this comparison
    // && individuals.length === 1
    // if (UtilsNew.isNotEmptyArray(individuals) ) {
    //     this._clinicalAnalysis.proband = individuals[0];
    // }

    const sampleIds = [];

    for (const individual of individuals) {
      for (const sample of individual.samples) {
        sampleIds.push(sample.id);
      }
    } // This triggers the render of Disorder dropdown


    const disorders = this.getDisordersFromIndividuals(individuals);
    this._disorders = disorders;

    if (utilsNew_UtilsNew.isNotEmptyArray(disorders) && disorders.length === 1) {
      this._clinicalAnalysis.disorder = disorders[0];
    }

    if (utilsNew_UtilsNew.isNotEmptyArray(sampleIds)) {
      const promises = [];

      for (const sampleId of sampleIds) {
        // We look for the files related to the samples
        promises.push(this.opencgaSession.opencgaClient.files().search({
          samples: sampleId,
          format: "BAM,VCF,BIGWIG",
          study: this.opencgaSession.study.fqn,
          exclude: "samples" // include: "id,name,format,bioformat,size"

        }).then(function (response) {
          return {
            sampleId: sampleId,
            files: response.response[0].result
          };
        }));
      }

      const files = {};
      Promise.all(promises).then(values => {
        for (const value of values) {
          files[value.sampleId] = value.files;
        }

        this._clinicalAnalysis.files = files;
        this.fillForm(this._clinicalAnalysis);
        this.requestUpdate();
        this.notifyClinicalAnalysis();
      });
    } else {
      this.fillForm(this._clinicalAnalysis);
      this.notifyClinicalAnalysis();
    }
  }

  showIndividualSelector(e) {
    e.preventDefault();
    this.individualModal = utilsNew_UtilsNew.isUndefined(this.individualModal) ? true : !this.individualModal;
    $("#" + this._prefix + "IndividualBrowser").modal("show");
  }

  showFamilySelector(e) {
    e.preventDefault();
    this.familyModal = utilsNew_UtilsNew.isUndefined(this.familyModal) ? true : !this.familyModal;
    $("#" + this._prefix + "FamilyBrowser").modal("show");
  }

  showFamilyCreator(e) {
    e.preventDefault();
    this.createFamily = true; // this.familyModal = UtilsNew.isUndefined(this.familyModal) ? true : !this.familyModal;
    // $("#" + this._prefix + "FamilyBrowser").modal('show');
  }

  getIndividualsFromClinicalAnalysis(clinicalAnalysis) {
    let individuals = [];

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis)) {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.family)) {
        individuals = clinicalAnalysis.family.members;
      } else {
        if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.proband)) {
          individuals = [clinicalAnalysis.proband];
        }
      }
    }

    return individuals;
  }

  getDisordersFromIndividuals(individuals) {
    const disorders = [];

    if (utilsNew_UtilsNew.isNotEmptyArray(individuals)) {
      for (const individual of individuals) {
        if (utilsNew_UtilsNew.isNotEmptyArray(individual.disorders)) {
          for (const disorder of individual.disorders) {
            // disorders array does not contain the element we're looking for
            if (disorders.filter(e => e.id === disorder.id).length === 0) {
              disorders.push(disorder);
            }
          }
        }
      }
    }

    return disorders;
  }

  isFamilyAnalysis(type) {
    if (type === "single" || type === "multiple" || type === "somatic") {
      return false;
    }

    return true;
  }

  renderDomRepeat(e) {
    $("select.selectpicker", this).selectpicker("refresh");
  }

  onClear() {
    this.clear();
    this._individuals = [];
    this._disorders = [];
    this._clinicalAnalysis = this.getDefaultClinicalAnalysis();
    this.fillForm(this._clinicalAnalysis);
    this.renderTable();
    this.notifyClinicalAnalysis();
  }

  onCreate() {
    const _clinicalAnalysis = Object.assign({}, this._clinicalAnalysis);

    _clinicalAnalysis.proband = {
      id: _clinicalAnalysis.proband.id,
      samples: [{
        id: _clinicalAnalysis.proband.samples[0].id
      }]
    };
    _clinicalAnalysis.analyst = {
      assignee: _clinicalAnalysis.analyst.assignee
    }; // delete _clinicalAnalysis.assigned;

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(_clinicalAnalysis.family)) {
      const _family = {
        id: _clinicalAnalysis.family.id,
        members: []
      };

      for (const member of _clinicalAnalysis.family.members) {
        _family.members.push({
          id: member.id,
          samples: [{
            id: member.samples[0].id
          }]
        });
      }

      _clinicalAnalysis.family = _family;
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(_clinicalAnalysis.files)) {
      const _files = {};

      for (const sampleId in _clinicalAnalysis.files) {
        const fileIds = [];

        for (const file of _clinicalAnalysis.files[sampleId]) {
          fileIds.push(file.id);
        }

        _files[sampleId] = fileIds;
      }

      _clinicalAnalysis.files = _files;
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(_clinicalAnalysis.dueDate)) {
      const dueDate = moment(_clinicalAnalysis.dueDate, "DD/MM/YYYY").format("YYYYMMDDHHMMSS");
      _clinicalAnalysis.dueDate = dueDate;
    }

    const _this = this;

    console.error("arguments order inverted after new clients. recheck functionality");
    this.opencgaSession.opencgaClient.clinical().create(_clinicalAnalysis, {
      study: this.opencgaSession.study.fqn
    }).then(function (response) {
      _this.onClear();

      NotificationUtils_NotificationUtils.showNotify("Family ".concat(response.response[0].result[0].id, " created successfully"), "SUCCESS");
    }).catch(function (response) {
      console.error(response);
      NotificationUtils_NotificationUtils.showNotify(response.error, "ERROR");
    });
  }
  /*
   * TABLE AND FORMATTERS
   */


  renderTable() {
    const columns = this._initTableColumns();

    console.log("columns", columns);

    const _this = this;

    console.log("_this._individuals", _this._individuals);
    $("#" + this._prefix + "IndividualBrowserGrid").bootstrapTable("destroy");
    $("#" + this._prefix + "IndividualBrowserGrid").bootstrapTable({
      columns: columns,
      data: _this._individuals,
      // Table properties
      pagination: _this._config.grid.pagination,
      // showExport: _this._config.grid.showExport,
      detailView: _this._config.grid.detailView,
      detailFormatter: _this._config.grid.detailFormatter,
      // Make Polymer components available to table formatters
      gridContext: _this,
      onPostBody: function onPostBody(data) {
        $(".selectpicker", this).selectpicker("refresh");
        /**
         *  returning a lit-html element in a formatter cause the print of [object Object].
         *  the flowwing listerners are necessary as temp solution.
         *  TODO find a better way to make bootstrap-table formatters and lit-html works together.
         */

        const removeIndividualButtons = PolymerUtils_PolymerUtils.querySelectorAll(".removeIndividualButton");

        for (let i = 0; i < removeIndividualButtons.length; i++) {
          removeIndividualButtons[i].addEventListener("click", _this.removeIndividualButtonClicked.bind(_this));
        }

        const probandRadio = PolymerUtils_PolymerUtils.querySelectorAll(".probandRadio");

        for (let i = 0; i < probandRadio.length; i++) {
          probandRadio[i].addEventListener("click", _this.aaa.bind(_this)); // removeIndividualButtons[i].addEventListener('change', _this.aaa.bind(_this));
        } // Add tooltips


        _this.catalogUiUtils.addTooltip("div.phenotypesTooltip", "Phenotypes");
      }
    });
  }

  removeIndividualButtonClicked(e) {
    const individuals = [];

    for (let i = 0; i < this._individuals.length; i++) {
      if (this._individuals[i].id !== e.target.dataset.id) {
        individuals.push(this._individuals[i]);
      }
    }

    this._individuals = individuals; // Reload data of the table

    $("#" + this._prefix + "IndividualBrowserGrid").bootstrapTable("load", this._individuals);

    if (this._individuals.length === 0 && !this.isFamilyAnalysis(this._clinicalAnalysis.type)) {
      // Re-enable disabled buttons
      PolymerUtils_PolymerUtils.getElementById("".concat(this._prefix, "-browseIndividual")).disabled = false;
      const buttons = PolymerUtils_PolymerUtils.getElementsByClassName("".concat(this._prefix, "-type"));

      for (let i = 0; i < buttons.length; i++) {
        buttons[i].disabled = false;
      }
    }

    this._clinicalAnalysis.family.members = this._individuals;
    delete this._clinicalAnalysis.files[e.target.dataset.id];
    this.notifyClinicalAnalysis(this._clinicalAnalysis);
  }

  detailFormatter(index, row) {// let result = `<div class='row' style="padding: 5px 10px 15px 10px">
    //                 <div class='col-md-12'>
    //                     <h5 style="font-weight: bold">Samples</h5>
    // `;
    //
    // if (UtilsNew.isNotEmptyArray(row.samples)) {
    //     if (row.samples.length === 1) {
    //         result += ""
    //     } else {
    //
    //     }
    // }
  }

  individualFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(value) && utilsNew_UtilsNew.isNotUndefinedOrNull(row)) {
      const sampleIcon = this._config.sexIconMap[row.sex];
      let sampleIdStyle = "color: black";

      if (utilsNew_UtilsNew.isNotEmptyArray(row.disorders)) {
        for (const disorder of row.disorders) {
          if (disorder.id === this._clinicalAnalysis.disorder.id) {
            sampleIdStyle = "color: red";
            break;
          }
        }
      }

      return "<div>\n                            <span data-toggle=\"tooltip\" data-placement=\"bottom\" style=\"".concat(sampleIdStyle, "\" title=\"\" >\n                            ").concat(value, " <i class='fa ").concat(sampleIcon, " fa-lg' style='padding-left: 5px'></i>\n                            </span>\n                        </div>");
    } else {
      return "-";
    }
  }

  samplesFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotEmptyArray(row.samples)) {
      // for (let sample of row.samples) {
      //     samples += `<div>${sample.id}</div>`;
      // }
      return "<span>".concat(row.samples[0].id, "</span>");
    } else {
      return "-";
    }
  }

  probandFormatter(value, row) {
    return "<input type=\"radio\" name=\"".concat(this._prefix, "-optradio\" class=\"probandRadio\" data-individual-id=\"").concat(row.id, "\" @click=\"").concat(this.aaa, "\">");
  } //TODO change name


  aaa(e) {
    console.warn("change function name");
    const individualId = e.currentTarget.dataset.individualId;

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this._clinicalAnalysis.family) && utilsNew_UtilsNew.isNotEmptyArray(this._clinicalAnalysis.family.members)) {
      for (const member of this._clinicalAnalysis.family.members) {
        if (member.id === individualId) {
          this._clinicalAnalysis.proband = member;
        }
      }

      this.notifyClinicalAnalysis(this._clinicalAnalysis);
    }

    this._updateCreateButtonStatus();
  }

  disordersFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotEmpty(value)) {
      let disordersHtml = "<div>";

      for (const disorder of value) {
        disordersHtml += "<span>".concat(disorder.id, "</span>");
      }

      disordersHtml += "</div>";
      return disordersHtml;
    } else {
      return "-";
    }
  }

  phenotypesFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotEmptyArray(value)) {
      let phenotypeTooltipText = "";

      for (const phenotype of value) {
        phenotypeTooltipText += "<div style=\"padding: 5px\">";

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(phenotype.source) && phenotype.source.toUpperCase() === "HPO") {
          phenotypeTooltipText += "<span><a target=\"_blank\" href=\"https://hpo.jax.org/app/browse/term/".concat(phenotype.id, "\">").concat(phenotype.id, " </a>(").concat(phenotype.status, ")</span>");
        } else {
          phenotypeTooltipText += "<span>".concat(phenotype.id, " (").concat(phenotype.status, ")</span>");
        }

        phenotypeTooltipText += "</div>";
      }

      const html = "<div class=\"phenotypesTooltip\" data-tooltip-text='".concat(phenotypeTooltipText, "'>\n                                    <a style=\"cursor: pointer\">\n                                        ").concat(value.length, " terms found\n                                    </a>\n                           </div>\n                    ");
      return html;
    } else {
      return "-";
    }
  }

  filesFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this._clinicalAnalysis.files)) {
      let html = "<div>";

      if (utilsNew_UtilsNew.isNotEmptyArray(row.samples)) {
        const files = this._clinicalAnalysis.files[row.samples[0].id];

        if (utilsNew_UtilsNew.isNotEmptyArray(files)) {
          for (const file of files) {
            html += "<div>".concat(file.name, "</div>");
          }
        }
      }

      html += "</div>";
      return html;
    }
  } //not used, not converted in litElement

  /*    flagsFormatter(value, row) {
          const html = `<select class="selectpicker" data-id=${row.id}  data-width="100%" on-change="updateQuery"
                                      on-dom-change="renderDomRepeat" multiple data-selected-text-format="count > 1">
                                  <template is="dom-repeat" items="${this._config.flags}">
                                      <option value="{{item}}">{{item}}</option>
                                  </template>
                              </select>`;
          return html;
      }*/


  removeButtonFormatter(value, row) {
    return "<button data-id=".concat(row.id, " class='btn btn-sm btn-danger removeIndividualButton' @click=\"").concat(this.removeIndividualButtonClicked, "\">\n                        <i class=\"fa fa-trash\" aria-hidden=\"true\"></i> Remove</button>");
  }

  _initTableColumns() {
    return [[{
      title: "Individual",
      field: "id",
      formatter: this.individualFormatter.bind(this),
      halign: this._config.grid.header.horizontalAlign
    }, {
      title: "Sample",
      field: "samples",
      formatter: this.samplesFormatter.bind(this),
      halign: this._config.grid.header.horizontalAlign
    }, {
      title: "Proband",
      formatter: this.probandFormatter.bind(this),
      align: this._config.grid.header.horizontalAlign,
      halign: this._config.grid.header.horizontalAlign
    }, {
      title: "Father",
      field: "father.id",
      halign: this._config.grid.header.horizontalAlign
    }, {
      title: "Mother",
      field: "mother.id",
      halign: this._config.grid.header.horizontalAlign
    }, {
      title: "Disorders",
      field: "disorders",
      formatter: this.disordersFormatter,
      halign: this._config.grid.header.horizontalAlign
    }, {
      title: "Phenotypes",
      field: "phenotypes",
      formatter: this.phenotypesFormatter,
      halign: this._config.grid.header.horizontalAlign
    }, {
      title: "Files",
      field: "files",
      formatter: this.filesFormatter.bind(this),
      halign: this._config.grid.header.horizontalAlign
    }, // {
    //     title: 'Flags',
    //     field: 'flags',
    //     // rowspan: 2,
    //     formatter: this.flagsFormatter.bind(this),
    //     align: this._config.grid.header.horizontalAlign
    // },
    {
      title: "Remove",
      field: "id",
      formatter: this.removeButtonFormatter,
      align: this._config.grid.header.horizontalAlign,
      halign: this._config.grid.header.horizontalAlign
    }], []];
  }

  getDefaultConfig() {
    return {
      title: "Create Case",
      showTitle: true,
      grid: {
        pagination: false,
        // showExport: false,
        detailView: true,
        detailFormatter: this.detailFormatter,
        // multiSelection: false,
        header: {
          horizontalAlign: "center",
          verticalAlign: "bottom"
        }
      },
      flags: ["mixed_chemistries", "low_tumour_purity", "uniparental_isodisomy", "uniparental_heterodisomy", "unusual_karyotype", "suspected_mosaicism", "low_quality_sample"],
      sexIconMap: {
        MALE: "fa-mars",
        FEMALE: "fa-venus",
        UNKNOWN: "fa-genderless"
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_clinical_analysis_editor_templateObject(), this.isCreate ? lit_html_lit_html_html(opencga_clinical_analysis_editor_templateObject2(), this._prefix, this._prefix, this.onInputChange, this._clinicalAnalysis.id) : lit_html_lit_html_html(opencga_clinical_analysis_editor_templateObject3(), this._prefix, this._prefix, this.onInputChange), this._prefix, this.onSelectChange, this._prefix, this.onSelectChange, this._config.flags && this._config.flags.length ? this._config.flags.map(item => lit_html_lit_html_html(opencga_clinical_analysis_editor_templateObject4(), item, item)) : null, this._prefix, this.onSelectChange, this._prefix, this.onSelectChange, this._studyUsers && this._studyUsers.length ? this._studyUsers.map(item => lit_html_lit_html_html(opencga_clinical_analysis_editor_templateObject5(), item, item, item)) : null, this._prefix, this._prefix, this._prefix, this.onInputChange, this._prefix, this._prefix, this.onInputChange, this.isFamilyAnalysis(this._clinicalAnalysis.type) ? lit_html_lit_html_html(opencga_clinical_analysis_editor_templateObject6(), this._prefix, this.showFamilySelector, this.showFamilyCreator) : lit_html_lit_html_html(opencga_clinical_analysis_editor_templateObject7(), this._prefix, this.showIndividualSelector), this._prefix, this.onSelectChange, this._disorders && this._disorders.length ? this._disorders.map(item => lit_html_lit_html_html(opencga_clinical_analysis_editor_templateObject8(), item.id, item, item.id)) : null, this._prefix, this._prefix, this._prefix, this.onClear, this._prefix, this.onCreate, this._prefix, this._prefix, this.opencgaSession, this.individualBrowserConfig, this.onIndividualSelect, this._prefix, this._prefix, this.opencgaSession, this.familyBrowserConfig, this.onFamilySelect, this._prefix);
  }

}
customElements.define("opencga-clinical-analysis-editor", opencga_clinical_analysis_editor_OpencgaClinicalAnalysisEditor);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/clinical/opencga-clinical-portal.js
function opencga_clinical_portal_templateObject3() {
  const data = opencga_clinical_portal_taggedTemplateLiteral(["\n            <span style=\"text-align: center\"><h3>No public projects available to browse. Please login to continue</h3></span>\n        "]);

  opencga_clinical_portal_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_clinical_portal_templateObject2() {
  const data = opencga_clinical_portal_taggedTemplateLiteral(["\n            <div class=\"row\">\n                <div id=\"", "ClinicalPortal\"  class=\"col-md-10 col-md-offset-1\">\n                    <nav class=\"navbar\" style=\"border-bottom: 1px solid rgba(221, 221, 221, 0.8)\">\n                        <div class=\"container-fluid\" style=\"padding: 0px 5px\">\n                            <!-- Brand and toggle get grouped for better mobile display -->\n                            <div class=\"navbar-header\">\n                                <!--<a href=\"#home\" class=\"navbar-brand\" style=\"padding-top: 10px\" on-click=\"changeTool\">-->\n                                <!--<img src=\"{{config.logo}}\" width=\"100px\">-->\n                                <!--</a>-->\n                                \n                                    <h1>", "</h1>\n                                \n                            </div>\n                        </div>\n\n                        <ul class=\"nav navbar-nav navbar-right\" style=\"padding: 0px 20px\">\n                            <li>\n                                <button type=\"button\" class=\"btn btn-link clinical-portal-button active myactive\" style=\"font-size: 1.1em\" data-view=\"ReviewCases\" @click=\"", "\" active>\n                                    <i class=\"fa fa-list clinical-portal-button\" style=\"padding: 0px 5px\" data-view=\"ReviewCases\" @click=\"", "\"></i>Review Cases\n                                </button>\n                            </li>\n                            <li>\n                                <button type=\"button\" class=\"btn btn-link clinical-portal-button\" style=\"font-size: 1.1em\" data-view=\"CreateCase\" @click=\"", "\">\n                                    <i class=\"fa fa-file clinical-portal-button\" style=\"padding: 0px 5px\" data-view=\"CreateCase\" @click=\"", "\"></i>Create Case\n                                </button>\n                            </li>\n<!--                            <li>-->\n<!--                                <button type=\"button\" class=\"btn btn-link clinical-portal-button\" style=\"font-size: 1.1em\" data-view=\"DiseasePanel\" on-click=\"_changeView\">-->\n<!--                                    <i class=\"fa fa-columns clinical-portal-button\" style=\"padding: 0px 5px\" data-view=\"DiseasePanel\" on-click=\"_changeView\"></i>Disease Panel (Experimental)-->\n<!--                                </button>-->\n<!--                            </li>-->\n                            <!--<li>-->\n                            <!--<button type=\"button\" class=\"btn btn-link clinical-portal-button\" style=\"font-size: 1.1em\" style=\"font-size: 1.1em\" data-view=\"ReviewCases\" on-click=\"_changeView\">-->\n                            <!--<i class=\"fa fa-database\" style=\"padding: 0px 5px\" data-view=\"ReviewCases\" on-click=\"_changeView\"></i>CVA (pending)-->\n                            <!--</button>-->\n                            <!--</li>-->\n                        </ul>\n                    </nav>\n                </div>\n\n\n                <div id=\"", "MainWindow\" class=\"col-md-10 col-md-offset-1\">\n\n                    <div style=\"padding: 0px 10px\">\n                        <div id=\"", "ReviewCases\" class=\"clinical-portal-content\">\n                            <opencga-clinical-review-cases .opencgaSession=\"", "\"\n                                                           .config=\"", "\">\n                            </opencga-clinical-review-cases>\n                        </div>\n\n                        <div id=\"", "CreateCase\" class=\"clinical-portal-content\" style=\"display: none\">\n                            <opencga-clinical-analysis-editor .opencgaSession=\"", "\"\n                                                              .config=\"", "\"\n                                                              @clinicalanalysischange=\"", "\">\n                            </opencga-clinical-analysis-editor>\n                        </div>\n\n                        <div id=\"", "DiseasePanel\" class=\"clinical-portal-content\" style=\"display: none\">\n                            <opencga-panel-browser .opencgaSession=\"", "\"\n                                                   .opencgaClient=\"", "\"\n                                                   .cellbaseClient=\"", "\"\n                                                   .eventNotifyName=\"", "\"\n                                                   @notifymessage=\"", "\">\n                            </opencga-panel-browser>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        \n        "]);

  opencga_clinical_portal_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_clinical_portal_templateObject() {
  const data = opencga_clinical_portal_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .myactive {\n                color: darkorange !important;\n                border-top-color: darkorange !important;\n                border-top-width: 1px !important;\n            }\n        </style>\n\n        ", "\n        \n        "]);

  opencga_clinical_portal_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_clinical_portal_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */






class opencga_clinical_portal_OpencgaClinicalPortal extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ocap-" + utils.randomString(6) + "_";
    this.checkProjects = false;
    this._config = this.getDefaultConfig();
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession")) {
      this.propertyObserver();
    }
  }

  firstUpdated(_changedProperties) {
    this.search = {};
    this.case = "";
    this.proband = "All";
    this.family = "All";
    this.active = true;
  }

  propertyObserver() {
    this._config = Object.assign({}, this.getDefaultConfig(), this.config);

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.project)) {
      this.checkProjects = true;
    } else {
      this.checkProjects = false;
    }

    this.requestUpdate();
  }

  _changeView(e) {
    e.preventDefault(); // prevents the hash change to "#" and allows to manipulate the hash fragment as needed

    $(".clinical-portal-content").hide(); // hides all content divs

    if (typeof e.target !== "undefined" && typeof e.target.dataset.view !== "undefined") {
      // $("#" + this._prefix + e.target.dataset.view).show(); // get the href and use it find which div to show
      PolymerUtils_PolymerUtils.show(this._prefix + e.target.dataset.view);
    } // Show the active button


    $(".clinical-portal-button").removeClass("active");
    $(".clinical-portal-button").removeClass("myactive");
    $(e.target).addClass("active");
    $(e.target).addClass("myactive");
  }

  getDefaultConfig() {
    return {
      title: "Clinical Interpretation Portal",
      showTitle: true // grid: {
      //     pageSize: 10,
      //     pageList: [10, 25, 50],
      //     detailView: false,
      //     multiSelection: false
      // }

    };
  }

  render() {
    return lit_html_lit_html_html(opencga_clinical_portal_templateObject(), this.checkProjects ? lit_html_lit_html_html(opencga_clinical_portal_templateObject2(), this._prefix, this._config.title, this._changeView, this._changeView, this._changeView, this._changeView, this._prefix, this._prefix, this.opencgaSession, this._config.reviewCases, this._prefix, this.opencgaSession, this._config.clinicalAnalysisBrowser, this.onClinicalAnalysisEditor, this._prefix, this.opencgaSession, this.opencgaSession.opencgaClient, this.cellbaseClient, this._config.notifyEventMessage, this.onNotifyMessage) : lit_html_lit_html_html(opencga_clinical_portal_templateObject3()));
  }

}
customElements.define("opencga-clinical-portal", opencga_clinical_portal_OpencgaClinicalPortal);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/variant-beacon-network.js
function variant_beacon_network_templateObject2() {
  const data = variant_beacon_network_taggedTemplateLiteral(["\n                <div class=\"beacon-square ", "", " shadow\">\n                    <span>", "</span>\n                    <span id=\"", "", "\" class=\"beaconResponse\">&nbsp;</span>\n                </div> \n            "]);

  variant_beacon_network_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function variant_beacon_network_templateObject() {
  const data = variant_beacon_network_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n        \n        .beacon-square {\n            width: 120px;\n            height: 120px;\n            display: inline-flex;\n            justify-content: center;\n            align-items: center;\n            background: aliceblue;\n            margin: 10px;\n            flex-flow: column;\n            transition: all .7s ease-in-out;\n        }\n        .beacon-square.false {\n            background: #cfffc7;\n        }\n        .beacon-square.true {\n            background: red;\n        }\n        </style>\n\n        <div style=\"padding: 15px 20px\">\n            <div style=\"padding: 0px 0px 10px 0px\">\n                <button class=\"btn btn-primary ripple\" type=\"button\" @click=\"", "\">Search Beacon Network</button>\n                <a data-toggle=\"tooltip\"\n                   title=\"Beacon Network is a search engine across the world's public beacons. You can find it here - https://beacon-network.org/#/\">\n                   <i class=\"fa fa-info-circle\" aria-hidden=\"true\"></i>\n                </a>\n                        \n                <i class=\"fa fa-spinner fa-spin\" aria-hidden=\"true\" id=\"", "spinGif\" style=\"display:none\"></i>\n            </div>\n\n            ", "\n        </div>\n        "]);

  variant_beacon_network_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function variant_beacon_network_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function variant_beacon_network_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function variant_beacon_network_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { variant_beacon_network_ownKeys(Object(source), true).forEach(function (key) { variant_beacon_network_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { variant_beacon_network_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function variant_beacon_network_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


 // TODO: Assembly is hardcoded for now. It has to be taken care in the future

class variant_beacon_network_VariantBeaconNetwork extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      variant: {
        type: String
      },
      clear: {
        type: String
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "bn-" + utils.randomString(6) + "_";
    this._config = this.getDefaultConfig();
  }

  updated(changedProperties) {
    if (changedProperties.has("clear")) {
      this.clearResponse();
    }

    if (changedProperties.has("config")) {
      this.configObserver();
    }
  }

  configObserver() {
    this._config = variant_beacon_network_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  clearResponse() {
    // Empty previous response
    PolymerUtils_PolymerUtils.innerHtmlByClass("beaconResponse", "");
  }

  async searchBeaconNetwork() {
    if (this._config.hosts !== undefined && this.variant !== undefined && this.variant.split(":").length > 2) {
      const [chromosome, position, reference, alternate] = this.variant.split(":");
      $("#" + this._prefix + "spinGif").show(); // url to search : https://beacon-network.org/api/responses?allele=C&beacon=[cosmic]&chrom=1&pos=99999&ref=GRCh37
      // TODO: Assembly is hardcoded for now. It has to be taken care in the future

      const _this = this;

      for (let i = 0; i < this._config.hosts.length; i++) {
        const xhr = new XMLHttpRequest(); // Beacon network uses zero-based numbering hence (position-1) is used in the url.

        const url = "https://beacon-network.org/api/responses?allele=" + alternate + "&beacon=[" + _this._config.hosts[i] + "]&chrom=" + chromosome + "&pos=" + (position - 1) + "&ref=GRCh37"; // TODO continue

        /* axios.get(url)
            .then( response => {
                console.log("rr", response)
            })
            .catch( e => console.error(e))
        */

        fetch(url).then(async res => {
          if (res.ok) {
            const response = await res.json();
            console.log(response);

            for (const r of response) {
              console.log(r);
              const host = this.querySelector("." + this._prefix + this._config.hosts[i]);
              host.classList.add(r.response || "false");

              if (r.response === null) {
                // null from server
                host.querySelector(".beaconResponse").innerHTML = "false (".concat(r.response, ")");
              } else {
                host.querySelector(".beaconResponse").innerHTML = r.response;
              }
            }
          } else {
            console.error("Server Error", res);
          }
        }).catch(e => console.error(e));
        /* xhr.onload = function (event) {
            if (xhr.readyState === xhr.DONE) {
                if (xhr.status === 200) {
                    let contentType = xhr.getResponseHeader('Content-Type');
                    if (contentType === 'application/json') {
                        let beaconResponse = JSON.parse(xhr.response);
                        for (let j = 0; j < beaconResponse.length; j++) {
                            if (beaconResponse[j].response != null) {
                                let response = beaconResponse[j].response.toString();
                                PolymerUtils.innerHTML(_this._prefix + _this._config.hosts[i], "" + response.charAt(0).toUpperCase() + response.slice(1));
                                //_this.querySelector("." + _this._prefix + _this._config.hosts[i]).classList.add(response.charAt(0).toUpperCase() + response.slice(1))
                                if (response === "true") {
                                    //PolymerUtils.addStyle(_this._prefix + _this._config.hosts[i], "color", "red"); // Highlighting the true response in the table
                                 } else {
                                    PolymerUtils.addStyle(_this._prefix + _this._config.hosts[i], "color", "black");
                                }
                            } else {
                                PolymerUtils.innerHTML(_this._prefix + _this._config.hosts[i], "False");
                                PolymerUtils.addStyle(_this._prefix + _this._config.hosts[i], "color", "black");
                            }
                        }
                        PolymerUtils.hide(_this._prefix + 'spinGif');
                    }
                } else {
                    PolymerUtils.innerHTML(_this._prefix + _this._config.hosts[i], "False (not 200)");
                }
            } else {
                PolymerUtils.innerHTML(_this._prefix + _this._config.hosts[i], "False (No response from server)");
            }
        };
        xhr.open("GET", url, true);
        xhr.send(null);*/
      }
    }
  }

  getDefaultConfig() {
    return {
      hosts: ["brca-exchange", "cell_lines", "cosmic", "wtsi", "wgs", "ncbi", "ebi", "ega", "broad", "gigascience", "ucsc", "lovd", "hgmd", "icgc", "sahgp"]
    };
  }

  render() {
    return lit_html_lit_html_html(variant_beacon_network_templateObject(), this.searchBeaconNetwork, this._prefix, this._config.hosts && this._config.hosts.length && this._config.hosts.map(item => lit_html_lit_html_html(variant_beacon_network_templateObject2(), this._prefix, item, item, this._prefix, item)));
  }

}
customElements.define("variant-beacon-network", variant_beacon_network_VariantBeaconNetwork);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/variant-beacon.js
function variant_beacon_templateObject5() {
  const data = variant_beacon_taggedTemplateLiteral(["\n                <span style=\"text-align: center\"><h3>No public projects available to browse. Please login to continue</h3></span>\n            "]);

  variant_beacon_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function variant_beacon_templateObject4() {
  const data = variant_beacon_taggedTemplateLiteral(["\n                                    <div class=\"col-xs-3\" style=\"padding-left: 0px\">\n                                        <div class=\"panel panel-primary\">\n                                            <div class=\"panel-heading\">\n                                                <h3 class=\"panel-title\">Response</h3>\n                                            </div>\n                                            <div class=\"panel-body\">\n                                                <span id=\"BeaconResponse\">Exists: ", "</span>\n                                            </div>\n                                        </div>\n                                    </div>\n                                "]);

  variant_beacon_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function variant_beacon_templateObject3() {
  const data = variant_beacon_taggedTemplateLiteral(["\n                                                <option value=\"", "\">", "</option>\n                                            "]);

  variant_beacon_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function variant_beacon_templateObject2() {
  const data = variant_beacon_taggedTemplateLiteral(["\n                <div class=\"page-title\">\n                    <h2>\n                        <i class=\"fa fa-share-alt\" aria-hidden=\"true\"></i> </i>&nbsp;GA4GH Beacon\n                    </h2>\n                </div>\n    \n                <div class=\"container\">\n                    <div class=\"row\">\n                        <div class=\"col-md-12\">\n                            <h3>Input Variant</h3>\n                            <div>\n                            <span>\n                                <button class=\"btn btn-default ripple\" @click=\"", "\">Load example</button>\n                            </span>\n                                <br>\n                                <br>\n                                <div class=\"form-group row\">\n                                    <label for=\"datasetInput\" class=\"col-xs-2 col-form-label\">Dataset</label>\n                                    <div class=\"col-xs-6\">\n                                        <select class=\"form-control\" name=\"dataset\" id=\"", "datasetInput\">\n                                            ", "\n                                        </select>\n                                    </div>\n                                </div>\n                                <div class=\"form-group row\">\n                                    <label for=\"refNameInput\" class=\"col-xs-2 col-form-label\">Reference Name</label>\n                                    <div class=\"col-xs-3\">\n                                        <input class=\"form-control\" type=\"text\" value=\"\" id=\"", "refNameInput\" @input=\"", "\">\n                                    </div>\n                                </div>\n                                <div class=\"form-group row\">\n                                    <label for=\"startInput\" class=\"col-xs-2 col-form-label\">Start</label>\n                                    <div class=\"col-xs-3\">\n                                        <input class=\"form-control\" type=\"text\" value=\"\" id=\"", "startInput\" @input=\"", "\">\n                                    </div>\n                                </div>\n                                <div class=\"form-group row\">\n                                    <label for=\"alleleInput\" class=\"col-xs-2 col-form-label\">Allele</label>\n                                    <div class=\"col-xs-3\">\n                                        <input class=\"form-control\" type=\"text\" value=\"\" id=\"", "alleleInput\" @input=\"", "\">\n                                    </div>\n                                </div>\n                                <!--<div class=\"form-group row\">-->\n                                <!--<label class=\"col-xs-2 col-form-label\">Format Type</label>-->\n                                <!--<div class=\"col-xs-3\">-->\n                                <!--<input class=\"form-check-input\" type=\"checkbox\" name=\"formatType\" id=\"textType\" value=\"text\" checked> Text-->\n                                <!--<input class=\"form-check-input\" type=\"checkbox\" name=\"formatType\" id=\"jsonType\" value=\"json\"> JSON-->\n                                <!--</div>-->\n                                <!--</div>-->\n                                <div class=\"form-group row\" style=\"padding-left: 14px\">\n                                    <button type=\"reset\" class=\"btn btn-primary ripple\" @click=\"", "\" .disabled=\"", "\">Reset</button>\n                                    <button type=\"submit\" class=\"btn btn-primary ripple\" @click=\"", "\" .disabled=\"", "\">Submit</button>\n                                </div>\n            \n                                <!-- Result -->\n                                ", "\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"row\">\n                        <div class=\"col-md-12\">\n                                <h3>Beacon Network</h3>\n                                <div>\n                                    <variant-beacon-network .variant=\"", "\" .clear=\"", "\" .config=\"", "\"></variant-beacon-network>\n                                </div>\n                        </div>\n                    </div>\n                </div>\n            "]);

  variant_beacon_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function variant_beacon_templateObject() {
  const data = variant_beacon_taggedTemplateLiteral(["\n            <style include=\"jso-styles\"></style>\n    \n            ", "\n        "]);

  variant_beacon_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function variant_beacon_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */




class variant_beacon_VariantBeacon extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ovdv-"
    /* + Utils.randomString(6) + "_"*/
    ;
    this.checkProjects = false;
    this._config = this.getDefaultConfig();
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession") || changedProperties.has("config")) {
      this.propertyObserver();
      this.requestUpdate();
    }
  }

  propertyObserver() {
    this._config = Object.assign(this.getDefaultConfig(), this.config);

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.project)) {
      this.checkProjects = true;
    } else {
      this.checkProjects = false;
    }
  }

  clearFields(e) {
    this.querySelector("#" + this._prefix + "datasetInput").value = "";
    this.querySelector("#" + this._prefix + "refNameInput").value = "";
    this.querySelector("#" + this._prefix + "startInput").value = "";
    this.querySelector("#" + this._prefix + "alleleInput").value = "";
    this.result = "";
    this.clear = utils.randomString(4); // Clear beacon network response

    this.variant = ""; // reset variant to empty

    this.resetEnabled = false;
    this.requestUpdate();
  }

  loadExample() {
    console.log(this.opencgaSession.project.studies);
    this.querySelector("#" + this._prefix + "datasetInput").value = this.opencgaSession.project.studies[0].alias;
    this.querySelector("#" + this._prefix + "refNameInput").value = "21";
    this.querySelector("#" + this._prefix + "startInput").value = "46047686";
    this.querySelector("#" + this._prefix + "alleleInput").value = "T";
    this.updateVariant();
  }

  execute(e) {
    this.clear = utils.randomString(4); // Clear beacon network response

    const queryParams = {
      chrom: this.querySelector("#" + this._prefix + "refNameInput").value,
      pos: Number(this.querySelector("#" + this._prefix + "startInput").value) - 1,
      allele: this.querySelector("#" + this._prefix + "alleleInput").value,
      beacon: this.opencgaSession.project.alias + ":" + this.querySelector("#" + this._prefix + "datasetInput").value
    };

    if (this.opencgaSession.opencgaClient !== undefined) {
      const _this = this;

      this.opencgaSession.opencgaClient.GA4GH().responses(queryParams, {}).then(function (response) {
        console.log(response);
        const exists = response[0].response.toString();
        _this.result = exists.charAt(0).toUpperCase() + exists.slice(1);

        _this.requestUpdate();
      });
    }
  }

  updateVariant() {
    const ref = this.querySelector("#" + this._prefix + "refNameInput").value;
    const start = this.querySelector("#" + this._prefix + "startInput").value;
    const allele = this.querySelector("#" + this._prefix + "alleleInput").value;
    this.resetEnabled = ref || start || allele;
    this.variant = ref && start && allele ? ref + ":" + start + "::" + allele : "";
    this.requestUpdate();
  }

  checkResult(result) {
    return utilsNew_UtilsNew.isNotEmpty(result);
  }

  getDefaultConfig() {
    return {
      hosts: ["brca-exchange", "cell_lines", "cosmic", "wtsi", "wgs", "ncbi", "ebi", "ega", "broad", "gigascience", "ucsc", "lovd", "hgmd", "icgc", "sahgp"]
    };
  }

  render() {
    return lit_html_lit_html_html(variant_beacon_templateObject(), this.checkProjects ? lit_html_lit_html_html(variant_beacon_templateObject2(), this.loadExample, this._prefix, this.opencgaSession && this.opencgaSession.project.studies ? this.opencgaSession.project.studies.map(item => lit_html_lit_html_html(variant_beacon_templateObject3(), item.alias, item.name)) : null, this._prefix, this.updateVariant, this._prefix, this.updateVariant, this._prefix, this.updateVariant, this.clearFields, !this.resetEnabled, this.execute, !this.variant, this.checkResult(this.result) ? lit_html_lit_html_html(variant_beacon_templateObject4(), this.result) : null, this.variant, this.clear, this._config) : lit_html_lit_html_html(variant_beacon_templateObject5()));
  }

}
customElements.define("variant-beacon", variant_beacon_VariantBeacon);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/opencga-variant-facet-query.js
function opencga_variant_facet_query_templateObject5() {
  const data = opencga_variant_facet_query_taggedTemplateLiteral(["\n                            <div>\n                                <h3>", "</h3>\n                                <opencga-facet-result-view .facetResult=\"", "\"\n                                                           .config=\"", "\"\n                                                           ?active=\"", "\">\n                                </opencga-facet-result-view>\n                            </div>\n                        "]);

  opencga_variant_facet_query_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_variant_facet_query_templateObject4() {
  const data = opencga_variant_facet_query_taggedTemplateLiteral(["\n                        ", "\n                    "]);

  opencga_variant_facet_query_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_variant_facet_query_templateObject3() {
  const data = opencga_variant_facet_query_taggedTemplateLiteral(["\n                        <!--<h4>No facet filters selected</h4>-->\n                    "]);

  opencga_variant_facet_query_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_variant_facet_query_templateObject2() {
  const data = opencga_variant_facet_query_taggedTemplateLiteral([" \n            <div class=\"col-md-12\">\n                <div>\n                    <button type=\"button\" class=\"btn btn-primary ripple pull-right\" @click=\"", "\">Run Advanced facet query</button>\n                </div>\n                <div >\n                    <h2>Results</h2>\n                    \n                    <div id=\"loading\" style=\"display: none\">\n                        <loading-spinner></loading-spinner>\n                    </div>\n                    ", "\n                </div>\n            </div>"]);

  opencga_variant_facet_query_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_variant_facet_query_templateObject() {
  const data = opencga_variant_facet_query_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            option:disabled {\n                font-size: 0.85em;\n                font-weight: bold;\n            }\n\n            .active-filter-button:hover {\n                text-decoration: line-through;\n            }\n            .deletable:hover {\n                text-decoration: line-through;\n            }\n            #loading {\n                text-align: center;\n                margin-top: 40px;\n            }\n        </style>\n\n        <div class=\"row\">\n            <!-- RESULTS - Facet Plots -->\n            ", "\n        </div>\n    "]);

  opencga_variant_facet_query_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_variant_facet_query_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_variant_facet_query_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_variant_facet_query_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_variant_facet_query_ownKeys(Object(source), true).forEach(function (key) { opencga_variant_facet_query_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_variant_facet_query_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_variant_facet_query_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */





 //TODO avg(popFreq__1kG_phase3__AFR)[0..1]:0.1>>avg(popFreq__GNOMAD_GENOMES__EAS[0..1]):0.1
//TODO this components needs cleaning from the old code

class opencga_variant_facet_query_OpencgaVariantFacetQuery extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      query: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      config: {
        type: Object
      },
      active: {
        type: Boolean
      }
    };
  }

  _init() {
    this._prefix = "facet" + utils.randomString(6); // this.checkProjects = true;
    // These are for making the queries to server

    this.facetFields = [];
    this.facetRanges = [];
    this.facetFieldsName = [];
    this.facetRangeFields = [];
    this.results = [];
    this._showInitMessage = true;
    this.facets = new Set();
    this.facetFilters = [];
    this.facetConfig = {
      a: 1
    };
    this.facetActive = true;
    this._config = this.getDefaultConfig();
  }

  firstUpdated(_changedProperties) {
    $(".bootstrap-select", this).selectpicker();
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession") || changedProperties.has("query")) {
      this.propertyObserver();
    }

    if (changedProperties.has("query")) {
      this.queryObserver();
    }

    if (changedProperties.has("config")) {
      this.configObserver();
    }

    if (changedProperties.has("active")) {
      this.fetchDefaultData();
    }
  }

  propertyObserver(opencgaSession, query) {// this.clear();
    //PolymerUtils.show(this._prefix + "Warning");
  }

  queryObserver() {
    console.log("queryObserver  in facet!"); //executedQuery in opencga-variant-browser has changed so, if requested,  we have to repeat the facet query

    this.facetResults = [];
    this.fetchDefaultData();
  }

  configObserver() {
    this._config = opencga_variant_facet_query_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  addDefaultStats(e) {
    for (let i = 0; i < this._config.defaultStats.fields.length; i++) {
      this.facets.add(this._config.defaultStats.fields[i]);
    }

    this.facetFilters = Array.from(this.facets);
    this.requestUpdate();
  }

  fetchDefaultData() {
    //this.facetResults is reset in queryObserver
    if (this.active && !this.facetResults.length) {
      this.addDefaultStats();
      this.fetchData();
    }
  }

  fetchData() {
    if (utilsNew_UtilsNew.isUndefinedOrNull(this.opencgaSession.opencgaClient)) {
      console.log("opencgaClient is null or undefined");
      return;
    }

    PolymerUtils_PolymerUtils.hide(this._prefix + "Warning");
    this.clearPlots();
    this.querySelector("#loading").style.display = "block"; // Join 'query' from left menu and facet filters

    let queryParams = opencga_variant_facet_query_objectSpread({}, this.query, {
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias,
      sid: this.opencgaSession.opencgaClient._config.sessionId,
      fields: this.facetFilters.join(";"),
      timeout: 60000
    });

    console.warn("queryParams", queryParams);
    this.opencgaSession.opencgaClient.variants().aggregationStats(queryParams).then(queryResponse => {
      this.facetResults = queryResponse.response[0].result[0].results;
      this.querySelector("#loading").style.display = "none";
      this._showInitMessage = false;
    }).catch(function (e) {
      console.log(e);
      this.querySelector("#loading").style.display = "none";
      this._showInitMessage = false;
    }).finally(() => this.requestUpdate());
  }

  clearPlots() {
    if (utilsNew_UtilsNew.isNotUndefined(this.results) && this.results.length > 0) {
      for (let result of this.results) {
        PolymerUtils_PolymerUtils.removeElement(this._prefix + result.name + "Plot");
      }
    }

    this.results = [];
  }

  clear() {
    this.clearPlots();
    this.chromosome = "";
    this.facets = new Set();
    this.facetFilters = [];
    PolymerUtils_PolymerUtils.hide(this._prefix + "Warning");
    this.facetFields = [];
    this.facetRanges = [];
    this.facetFieldsName = [];
    this.facetRangeFields = [];
    this._showInitMessage = true;
    this.requestUpdate();
  }

  facetSearch() {
    //query.study = this.opencgaSession.study.fqn;
    this.dispatchEvent(new CustomEvent("facetSearch", {
      detail: this.query,
      bubbles: true,
      composed: true
    }));
  } //TODO add default configuration for file, sample, individual, family, cohort, clinical analysis


  getDefaultConfig() {
    return {
      // title: "Aggregation Stats",
      active: false,
      populationFrequencies: true,
      defaultStats: {
        visible: true,
        fields: ["chromosome", "biotypes", "type"]
      },
      fields: {
        terms: [{
          name: "Chromosome",
          value: "chromosome"
        }, {
          name: "Studies",
          value: "studies"
        }, {
          name: "Variant Type",
          value: "type"
        }, {
          name: "Genes",
          value: "genes"
        }, {
          name: "Biotypes",
          value: "biotypes"
        }, {
          name: "Consequence Type",
          value: "soAcc"
        }],
        ranges: [{
          name: "PhastCons",
          value: "phastCons",
          default: "[0..1]:0.1"
        }, {
          name: "PhyloP",
          value: "phylop",
          default: ""
        }, {
          name: "Gerp",
          value: "gerp",
          default: "[-12.3..6.17]:2"
        }, {
          name: "CADD Raw",
          value: "caddRaw"
        }, {
          name: "CADD Scaled",
          value: "caddScaled"
        }, {
          name: "Sift",
          value: "sift",
          default: "[0..1]:0.1"
        }, {
          name: "Polyphen",
          value: "polyphen",
          default: "[0..1]:0.1"
        }]
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_variant_facet_query_templateObject(), this.active ? lit_html_lit_html_html(opencga_variant_facet_query_templateObject2(), this.facetSearch, this._showInitMessage ? lit_html_lit_html_html(opencga_variant_facet_query_templateObject3()) : lit_html_lit_html_html(opencga_variant_facet_query_templateObject4(), this.facetResults.map(item => lit_html_lit_html_html(opencga_variant_facet_query_templateObject5(), item.name, item, this.facetConfig, this.facetActive)))) : null);
  }

}

customElements.define("opencga-variant-facet-query", opencga_variant_facet_query_OpencgaVariantFacetQuery);
// CONCATENATED MODULE: ./lib/jsorolla/src/genome-browser/webcomponent/genome-browser.js
function genome_browser_templateObject() {
  const data = genome_browser_taggedTemplateLiteral(["\n        <div id=\"", "FilterMenu\"></div>\n        <h3 class=\"form-section-title\">Genome Browser</h3>\n        <div id=\"", "GenomeBrowser\"></div>\n        "]);

  genome_browser_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function genome_browser_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */





class genome_browser_GenomeBrowserComponent extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      cellbaseClient: {
        type: Object //              observer: "init"

      },
      // opencgaClient: {
      //     type: Object
      // },
      region: {
        type: Object
      },
      species: {
        type: Object
      },
      tracks: {
        type: Array
      },
      width: {
        type: Number //              value: 1400,

      },
      active: {
        type: Boolean
      },
      filter: {
        type: Object
      },
      settings: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "gb_" + utils.randomString(6) + "_";
    this.tracks = [{
      type: "sequence"
    }, {
      type: "gene"
    }];
    this.species = {
      id: "hsapiens",
      scientificName: "Homo sapiens",
      assembly: {
        name: "GRCh37"
      }
    };
    this.active = false;
  }

  updated(changedProperties) {
    if (changedProperties.has("region")) {
      this._setRegion();
    }

    if (changedProperties.has("tracks")) {
      this.init();
    }

    if (changedProperties.has("width")) {
      this._updateWidth();
    }

    if (changedProperties.has("active")) {
      this._setActive();
    }

    if (changedProperties.has("opencgaSession") || changedProperties.has("cellbaseClient") || changedProperties.has("tracks") || changedProperties.has("filter") || changedProperties.has("active")) {
      this.propertyObserver(this.opencgaSession, this.cellbaseClient, this.tracks, this.filters, this.active);
    }
  }

  firstUpdated(_changedProperties) {
    this.init(); //                this.region = {chromosome: "21", start: 22859462, end: 22859610};
    // We need to listen to Window resize

    window.addEventListener("resize", e => this._updateWidth());
  }

  init() {
    this.lastFilter = undefined;
  }

  propertyObserver(opencgaSession, cellbaseClient, tracks, filter, active) {
    if (typeof this.cellbaseClient === "undefined" || typeof this.opencgaSession === "undefined") {
      return;
    }

    if (!active) {
      return;
    }

    if (this._tracksCopy === tracks) {
      // We don't need to render anything again
      return;
    }

    this.clear();
    this._tracksCopy = tracks;

    const [myTracks, featureTracks] = this._getConfiguredTracks(tracks);

    this._addFilters(filter, featureTracks);

    this.featureTracks = featureTracks;

    if (typeof this.region === "undefined") {
      this.region = new Region("13:32889611-32973805"); // BRCA2
    }

    if (typeof this.genomeBrowser !== "undefined") {
      this.genomeBrowser.destroy();
    }

    this.width = $("#" + this._prefix + "GenomeBrowser").width();
    const defaultSettings = {
      client: this.cellbaseClient,
      target: this._prefix + "GenomeBrowser",
      region: this.region,
      availableSpecies: {
        vertebrates: [this.species]
      },
      species: this.species,
      width: this.width,
      //                    zoom: 80,
      sidePanel: false,
      autoRender: true,
      resizable: true,
      karyotypePanelConfig: {
        collapsed: true,
        collapsible: true
      },
      chromosomePanelConfig: {
        collapsed: true,
        collapsible: true
      },
      navigationBarConfig: {
        componentsConfig: {}
      },
      handlers: {
        "region:change": function regionChange(e) {
          console.log(e);
        }
      }
    };
    const settings = Object.assign(defaultSettings, this.settings);
    this.genomeBrowser = new GenomeBrowser(settings); // Region Overview

    const gene = new FeatureTrack({
      minHistogramRegionSize: 20000000,
      maxLabelRegionSize: 10000000,
      height: 120,
      renderer: new FeatureRenderer(FEATURE_TYPES.gene),
      dataAdapter: new CellBaseAdapter(this.cellbaseClient, "genomic", "region", "gene", {
        exclude: "transcripts.tfbs,transcripts.xrefs,transcripts.exons.sequence"
      }, {
        chunkSize: 100000
      })
    });
    this.genomeBrowser.addOverviewTrack(gene);
    this.genomeBrowser.addTrack(myTracks);
    this.genomeBrowser.draw();
  }

  _addFilters(filter, featureTracks) {
    const myFilter = Object.assign(this.getDefaultFilters(), filter);

    if (myFilter.active === false) {
      return;
    }

    const filterDiv = PolymerUtils_PolymerUtils.getElementById(this._prefix + "FilterMenu");

    if (utilsNew_UtilsNew.isUndefinedOrNull(filterDiv)) {
      return;
    } // Clean anything the div might have


    for (let i = 0; i < filterDiv.length; i++) {
      filterDiv[i].remove();
    } // Build collapsable panel


    const rowDiv = document.createElement("div");
    rowDiv.classList.add("row");
    rowDiv.style.padding = "0px 10px";
    rowDiv.style.maring = "10px 0px";
    const colDiv = document.createElement("div");
    colDiv.classList.add("col-md-12");
    rowDiv.appendChild(colDiv);
    colDiv.appendChild($("<div style=\"display: block; cursor:pointer;\" on-click=\"toggleCollapsedFilter\"\n                                         data-toggle=\"collapse\" href$=\"#".concat(this._prefix, "collapsibleFilter\">\n                                        <h3 class=\"form-section-title\">").concat(myFilter.title, "</h3>\n                                    </div>"))[0]);
    const elements = document.createElement("div");
    elements.id = "".concat(this._prefix, "collapsibleFilter");
    elements.classList.add("form-horizontal", "collapse", "in");
    colDiv.appendChild(elements);

    for (let i = 0; i < myFilter.filters.length; i++) {
      switch (myFilter.filters[i].id) {
        case "gene":
          elements.appendChild(this._getGeneHtml(myFilter.filters[i])); // html += this._getGeneHtml(myFilter.filters[i]);

          break;

        case "region":
          elements.appendChild(this._getRegionHtml(myFilter.filters[i])); // html += this._getRegionHtml(myFilter.filters[i]);

          break;

        case "panel":
          const panelHtml = this._getPanelHtml(myFilter.filters[i], elements);

          if (utilsNew_UtilsNew.isNotUndefinedOrNull(panelHtml)) {
            elements.appendChild(this._getPanelHtml(myFilter.filters[i], elements));
          }

          break;

        case "alignment":
          elements.appendChild(this._getTrackHtml(myFilter.filters[i], featureTracks, AlignmentTrack));
          break;

        case "variant":
          elements.appendChild(this._getTrackHtml(myFilter.filters[i], featureTracks, VariantTrack));
          break;

        default:
          break;
      }
    } // Add buttons


    const formGroupDiv = document.createElement("div");
    formGroupDiv.classList.add("form-group");
    const colButtonDiv = document.createElement("div");
    colButtonDiv.classList.add("col-md-offset-3", "col-md-9");
    formGroupDiv.appendChild(colButtonDiv);
    const clearButton = document.createElement("button");
    clearButton.classList.add("btn", "btn-primary");
    clearButton.type = "submit";
    clearButton.addEventListener("click", this.clearFilters.bind(this));
    clearButton.innerHTML = "Clear";
    colButtonDiv.appendChild(clearButton);
    const submitButton = document.createElement("button");
    submitButton.classList.add("btn", "btn-primary");
    submitButton.type = "submit";
    submitButton.addEventListener("click", this.showSelectionInGenomeBrowser.bind(this));
    submitButton.innerHTML = "Render";
    colButtonDiv.appendChild(submitButton);
    elements.appendChild(formGroupDiv); // elements.appendChild($(`<div class="form-group">
    //             <div class="col-md-offset-3 col-md-9">
    //                 <button type="submit" class="btn btn-primary" on-click="onClear">Clear</button>
    //                 <button type="submit" class="btn btn-primary" on-click="showSelectionInGenomeBrowser">Render</button>
    //             </div>
    //         </div>`)[0]);

    filterDiv.appendChild(rowDiv);
  } // filterObserver(filter, tracks) {
  //     let myFilter = Object.assign(this.getDefaultFilters(), filter);
  //
  //     if (myFilter.active === false) {
  //         return;
  //     }
  //
  //     let filterDiv = PolymerUtils.getElementById(this._prefix + "FilterMenu");
  //     if (UtilsNew.isUndefinedOrNull(filterDiv)) {
  //         return;
  //     }
  //
  //     // Clean anything the div might have
  //     for (let i = 0; i < filterDiv.length; i++) {
  //         filterDiv[i].remove();
  //     }
  //
  //     // return {
  //     //     title: "Genome Browser Filters",
  //     //     active: true,
  //     //     filters: [{
  //     //         title: "Search by Region",
  //     //         example: "e.g. 3:55555-666666",
  //     //         id: "region"
  //     //     }, {
  //     //         title: "Search by Gene",
  //     //         example: "Search for Gene Symbols",
  //     //         id: "gene"
  //     //     }]
  //     // }
  //
  //     // Build collapsable panel
  //     let rowDiv = document.createElement("div");
  //     rowDiv.classList.add("row");
  //     rowDiv.style.padding = "0px 10px";
  //     rowDiv.style.maring = "10px 0px";
  //
  //     let colDiv = document.createElement("div");
  //     colDiv.classList.add("col-md-12");
  //     rowDiv.appendChild(colDiv);
  //
  //     colDiv.appendChild($(`<div style="display: block; cursor:pointer;" on-click="toggleCollapsedFilter"
  //                              data-toggle="collapse" href$="#${this._prefix}collapsibleFilter">
  //                             <h3 class="form-section-title">${myFilter.title}</h3>
  //                         </div>`)[0]);
  //
  //     let elements = document.createElement("div");
  //     elements.id = `${this._prefix}collapsibleFilter`;
  //     elements.classList.add("form-horizontal", "collapse", "in");
  //     colDiv.appendChild(elements);
  //
  //     for (let i = 0; i < myFilter.filters.length; i++) {
  //         switch (myFilter.filters[i].id) {
  //             case "gene":
  //                 elements.appendChild(this._getGeneHtml(myFilter.filters[i]));
  //                 // html += this._getGeneHtml(myFilter.filters[i]);
  //                 break;
  //             case "region":
  //                 elements.appendChild(this._getRegionHtml(myFilter.filters[i]));
  //                 // html += this._getRegionHtml(myFilter.filters[i]);
  //                 break;
  //             case "panel":
  //                 let panelHtml = this._getPanelHtml(myFilter.filters[i], elements);
  //                 if (UtilsNew.isNotUndefinedOrNull(panelHtml)) {
  //                     elements.appendChild(this._getPanelHtml(myFilter.filters[i], elements));
  //                 }
  //                 break;
  //             case "alignment":
  //                 elements.appendChild(this._getTrackHtml(myFilter.filters[i], "alignment"));
  //                 break;
  //             case "variant":
  //                 elements.appendChild(this._getTrackHtml(myFilter.filters[i], "variant"));
  //                 break;
  //             default:
  //                 break;
  //         }
  //     }
  //
  //     // Add buttons
  //     let formGroupDiv = document.createElement("div");
  //     formGroupDiv.classList.add("form-group");
  //
  //     let colButtonDiv = document.createElement("div");
  //     colButtonDiv.classList.add("col-md-offset-3", "col-md-9");
  //     formGroupDiv.appendChild(colButtonDiv);
  //
  //     let clearButton = document.createElement("button");
  //     clearButton.classList.add("btn", "btn-primary");
  //     clearButton.type = "submit";
  //     clearButton.addEventListener("click", this.clear.bind(this));
  //     clearButton.innerHTML = "Clear";
  //     colButtonDiv.appendChild(clearButton);
  //
  //     let submitButton = document.createElement("button");
  //     submitButton.classList.add("btn", "btn-primary");
  //     submitButton.type = "submit";
  //     submitButton.addEventListener("click", this.showSelectionInGenomeBrowser.bind(this));
  //     submitButton.innerHTML = "Render";
  //     colButtonDiv.appendChild(submitButton);
  //
  //     elements.appendChild(formGroupDiv);
  //     // elements.appendChild($(`<div class="form-group">
  //     //             <div class="col-md-offset-3 col-md-9">
  //     //                 <button type="submit" class="btn btn-primary" on-click="onClear">Clear</button>
  //     //                 <button type="submit" class="btn btn-primary" on-click="showSelectionInGenomeBrowser">Render</button>
  //     //             </div>
  //     //         </div>`)[0]);
  //
  //     filterDiv.appendChild(rowDiv);
  // }


  _getTrackHtml(filter, featureTracks, trackInstanceClass) {
    if (utilsNew_UtilsNew.isEmptyArray(featureTracks)) {
      console.log("WARNING: List of tracks is empty. Cannot display track selector.");
      return;
    }

    const tracks = [];

    for (let i = 0; i < featureTracks.length; i++) {
      if (featureTracks[i] instanceof trackInstanceClass) {
        tracks.push({
          id: featureTracks[i]["id"],
          title: featureTracks[i]["title"]
        });
      }
    }

    const div = document.createElement("div");
    div.classList.add("form-group");
    div.appendChild($("<label class=\"control-label col-md-1 jso-label-title\">".concat(filter.title, "</label>"))[0]);
    const innerDiv = document.createElement("div");
    innerDiv.classList.add("col-md-3", "form-check");
    div.appendChild(innerDiv);

    for (let i = 0; i < tracks.length; i++) {
      if (innerDiv.childElementCount > 0) {
        innerDiv.appendChild(document.createElement("br"));
      }

      const checkbox = document.createElement("input");
      checkbox.type = "checkbox";
      checkbox.classList.add("form-check-input", "".concat(this._prefix, "-checkbox"));
      checkbox.id = "".concat(tracks[i]["id"]);
      checkbox.setAttribute("data-track", tracks[i]["id"]);
      const label = document.createElement("label");
      label.classList.add("form-check-label");
      label.setAttribute("for", "".concat(tracks[i]["id"]));
      label.innerText = tracks[i]["title"];
      innerDiv.appendChild(checkbox);
      innerDiv.appendChild(label);
    }

    return div;
  } // TODO why $?


  _getRegionHtml(filter) {
    return $("<div class=\"form-group\">\n                            <label class=\"control-label col-md-1 jso-label-title\">".concat(filter.title, "</label>\n                            <div class=\"input-group col-md-3\" style=\"padding-left: 15px;padding-right: 15px\">\n                                <input id=\"").concat(this._prefix, "RegionInputText\" type=\"text\" class=\"form-control\" placeholder=\"").concat(filter.example, "\">\n                                <span class=\"input-group-btn\">\n                                <button class=\"btn btn-default\" type=\"button\" @click=\"").concat(this.onEraserClicked, "\">\n                                    <i class=\"fa fa-eraser\" aria-hidden=\"true\"></i>\n                                </button>\n                            </span>\n                            </div>\n                        </div>"))[0];
  } // TODO REFACTOR!


  _getGeneHtml(filter) {
    const cellbase = document.createElement("cellbase-gene-filter");
    cellbase.cellbaseClient = this.cellbaseClient;
    cellbase.id = "".concat(this._prefix, "-geneFilter");
    cellbase.erase = this.eraseSearchGene; // cellbase.addEventListener("genechange", this.onInputGeneChange.bind(this));

    const div = document.createElement("div");
    div.classList.add("form-group");
    div.appendChild($("<label class=\"control-label col-md-1 jso-label-title\">".concat(filter.title, "</label>"))[0]);
    const innerDiv = document.createElement("div");
    innerDiv.classList.add("col-md-3");
    innerDiv.appendChild(cellbase);
    div.appendChild(innerDiv);
    return div;
  }

  _getPanelHtml(filter, parentDiv) {
    if (utilsNew_UtilsNew.isNotEmptyArray(this._genePanels)) {
      // Return html
      let html = "<div class=\"form-group\">\n                            <label class=\"control-label col-md-1 jso-label-title\">".concat(filter.title, "</label>\n                            <div class=\"col-md-3\">\n                                <select class=\"selectpicker\" id=\"").concat(this._prefix, "-geneSelect\" data-live-search=\"true\" data-max-options=\"1\"\n                                        on-dom-change=\"renderDomRepeat\" multiple>");

      for (let i = 0; i < this._genePanels.length; i++) {
        html += "<optgroup label=\"".concat(this._genePanels[i].name, "\">");

        for (let j = 0; j < this._genePanels[i].genes.length; j++) {
          html += "<option>".concat(this._genePanels[i].genes[j].name, "</option>");
        }

        html += "</optgroup>";
      }

      html += "</select></div></div>";
      return $(html)[0];
    } else {
      const lastChild = parentDiv.lastChild; // We first need to fetch the panel information

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession)) {
        const _this = this;

        if (utilsNew_UtilsNew.isNotEmptyArray(filter.values)) {
          this.opencgaSession.opencgaClient.panels().info(filter.values.join(","), {
            study: _this.opencgaSession.study.fqn,
            include: "id,name,genes"
          }).then(function (response) {
            const _panels = [];

            for (const panel of response.response) {
              _panels.push(panel.result[0]);
            }

            _this._genePanels = _panels;

            if (utilsNew_UtilsNew.isUndefinedOrNull(lastChild.nextSibling)) {
              parentDiv.appendChild(_this._getPanelHtml(filter));
            } else {
              parentDiv.insertBefore(_this._getPanelHtml(filter), lastChild.nextSibling);
            } // Force the selectpicker to be rendered


            $("#".concat(_this._prefix, "-geneSelect"), parentDiv).selectpicker("refresh");
          }).catch(response => {
            console.error("An error occurred fetching panels: ", response);
          });
        } else {
          this._genePanels = [];
        }
      }

      return undefined;
    }
  }

  clear() {
    // Clean any old filter that might exist
    const children = $("#".concat(this._prefix, "FilterMenu")).children();

    for (let i = 0; i < children.length; i++) {
      children[i].remove();
    } // Destroy genome browser if it existed


    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.genomeBrowser)) {
      this.genomeBrowser.destroy();
    }
  }

  clearFilters() {
    const geneFilter = document.getElementById("".concat(this._prefix, "-geneFilter"));

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(geneFilter)) {
      geneFilter.clear();
    }

    PolymerUtils_PolymerUtils.setValue("".concat(this._prefix, "RegionInputText"), "");
    $("#".concat(this._prefix, "-geneSelect")).selectpicker("deselectAll");
  }

  showSelectionInGenomeBrowser() {
    let searchBy = undefined;
    let search = undefined;
    const geneFilter = document.getElementById("".concat(this._prefix, "-geneFilter"));

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(geneFilter)) {
      const gene = geneFilter.gene;

      if (utilsNew_UtilsNew.isNotEmpty(gene)) {
        searchBy = "gene";
        search = gene;
      }
    }

    const regionFilter = document.getElementById("".concat(this._prefix, "RegionInputText"));

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(regionFilter)) {
      const region = regionFilter.value;

      if (utilsNew_UtilsNew.isNotEmpty(region)) {
        if (utilsNew_UtilsNew.isNotEmpty(searchBy)) {
          NotificationUtils_NotificationUtils.showNotify("Cannot apply 'region' and 'gene' filters. Please, choose one or the other.", "WARNING");
          return;
        }

        search = region;
        searchBy = "region";
      }
    }

    const panelGene = $("#".concat(this._prefix, "-geneSelect")).selectpicker("val");

    if (utilsNew_UtilsNew.isNotEmptyArray(panelGene)) {
      if (utilsNew_UtilsNew.isNotEmpty(searchBy)) {
        NotificationUtils_NotificationUtils.showNotify("Cannot apply '" + searchBy + "' and 'gene panel' filters. " + "Please, choose one or the other.", "WARNING");
        return;
      }

      searchBy = "gene";
      search = panelGene[0];
    }

    if (utilsNew_UtilsNew.isNotEmpty(searchBy)) {
      if (searchBy === "gene") {
        const _this = this;

        this.cellbaseClient.getGeneClient(search, "info", {
          exclude: "annotation"
        }, {}).then(function (response) {
          const gene = response.response[0].result[0];

          _this.genomeBrowser.setRegion("".concat(gene.chromosome, ":").concat(gene.start, "-").concat(gene.end));
        });
      } else {
        this.genomeBrowser.setRegion(search);
      }
    }

    this._addSelectedTracks();
  } // _addSelectedTracks(trackType) {
  //     let checkedTracks = $(`.${this._prefix}-${trackType}-checkbox:checked`);
  //     let checkedTrackIds = [];
  //     for (let i = 0; i < checkedTracks.length; i++) {
  //         checkedTrackIds.push(checkedTracks[i].dataset.track);
  //     }
  //
  //     for (let i = 0; i < this.tracks.length; i++) {
  //         if (this.tracks[i]['type'] === trackType && checkedTrackIds.indexOf(this.tracks[i]['config']['data']['name']) > -1) {
  //             if (!this.genomeBrowser.containsTrackById(this.tracks[i]['config']['data']['name'])) {
  //                 let track = undefined;
  //                 if (trackType === "variant") {
  //                     track = this._addVariantTrack(this.tracks[i]);
  //                 } else if (trackType === "alignment") {
  //                     track = this._addAlignmentTrack(this.tracks[i]);
  //                 } else {
  //                     console.log("ERROR: Track must be of type 'alignment' or 'variant'");
  //                 }
  //
  //                 this.genomeBrowser.addTrack(track);
  //             }
  //         }
  //     }
  //
  //     // Remove unchecked tracks
  //     let uncheckedTracks = $(`.${this._prefix}-${trackType}-checkbox:not(:checked)`);
  //     for (let i = 0; i < uncheckedTracks.length; i++) {
  //         let trackId = uncheckedTracks[i].dataset.track;
  //         let track = this.genomeBrowser.getTrackById(trackId);
  //         if (UtilsNew.isNotUndefinedOrNull(track)) {
  //             this.genomeBrowser.removeTrack(track);
  //         }
  //     }
  // }


  _addSelectedTracks() {
    const checkedTracks = $(".".concat(this._prefix, "-checkbox:checked"));
    const checkedTrackIds = [];

    for (let i = 0; i < checkedTracks.length; i++) {
      checkedTrackIds.push(checkedTracks[i].dataset.track);
    }

    for (let i = 0; i < this.featureTracks.length; i++) {
      if (checkedTrackIds.indexOf(this.featureTracks[i]["id"]) > -1) {
        if (!this.genomeBrowser.containsTrackById(this.featureTracks[i]["id"])) {
          this.genomeBrowser.addTrack(this.featureTracks[i]);
        }
      }
    } // Remove unchecked tracks


    const uncheckedTracks = $(".".concat(this._prefix, "-checkbox:not(:checked)"));

    for (let i = 0; i < uncheckedTracks.length; i++) {
      const trackId = uncheckedTracks[i].dataset.track;

      if (this.genomeBrowser.containsTrackById(trackId)) {
        const track = this.genomeBrowser.getTrackById(trackId);
        this.genomeBrowser.removeTrack(track);
      }
    }
  }

  _addSequenceTrack(settings) {
    let mySettings = {
      title: "Sequence",
      height: 20,
      visibleRegionSize: 200,
      renderer: new SequenceRenderer(),
      dataAdapter: new CellBaseAdapter(this.cellbaseClient, "genomic", "region", "sequence", {}, {
        chunkSize: 100
      })
    };
    mySettings = Object.assign(mySettings, settings);
    return new FeatureTrack(mySettings);
  }

  _addGeneTrack(settings) {
    let mySettings = {
      title: "Gene",
      minHistogramRegionSize: 20000000,
      maxLabelRegionSize: 10000000,
      minTranscriptRegionSize: 200000,
      height: 100,
      renderer: new GeneRenderer({
        handlers: {
          "feature:click": function featureClick(e) {
            console.log(e);
          }
        }
      }),
      dataAdapter: new CellBaseAdapter(this.cellbaseClient, "genomic", "region", "gene", {
        exclude: "transcripts.tfbs,transcripts.xrefs,transcripts.exons.sequence"
      }, {
        chunkSize: 100000
      })
    };
    mySettings = Object.assign(mySettings, settings);
    return new GeneTrack(mySettings);
  }

  _addVariantTrack(settings) {
    let title = "Variant";

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(settings.data.name)) {
      title = settings.data.name;
    } //                console.log("Study credentials: " + this.project.alias + ":" + this.study.alias);


    const mySettings = {
      title: title,
      closable: true,
      minHistogramRegionSize: 20000000,
      maxLabelRegionSize: 10000000,
      minTranscriptRegionSize: 200000,
      visibleRegionSize: 100000000,
      height: 100,
      opencga: {
        client: this.opencgaSession.opencgaClient,
        studies: "".concat(this.opencgaSession.project.alias, ":").concat(this.opencgaSession.study.alias),
        config: {} //                        studies: "reference_grch37:1kG_phase3"
        //                        "HG00096", "HG00097", "HG00099"

      } //                    renderer: new FeatureRenderer(FEATURE_TYPES.variant),

    };

    if (settings.data.samples !== undefined && settings.data.samples.length > 0) {
      mySettings.opencga.samples = settings.data.samples;
    } else {
      mySettings.opencga.samples = [];
    }

    if (settings.data.files !== undefined && settings.data.files.length > 0) {
      mySettings.opencga.files = settings.data.files;
    } else {
      mySettings.opencga.files = [];
    } // mySettings = Object.assign(mySettings, settings);


    return new VariantTrack(mySettings);
  }

  _addAlignmentTrack(settings) {
    let title = "Aligment";

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(settings.data.name)) {
      title = settings.data.name;
    }

    let mySettings = {
      title: title,
      closable: true,
      minHistogramRegionSize: 5000,
      maxLabelRegionSize: 3000,
      visibleRegionSize: 100000000,
      height: 300,
      opencga: {
        client: this.opencgaSession.opencgaClient,
        studies: "".concat(this.opencgaSession.project.alias, ":").concat(this.opencgaSession.study.alias),
        //                        config: {height:1},
        // By default no custom config
        config: {} //                        studies: "reference_grch37:1kG_phase3"
        //                        "HG00096", "HG00097", "HG00099"

      }
    }; // You have to pass opencga.config to renderer if you use your own renderer. If you customize config yo have to change opencga.config.

    const renderer = {
      renderer: new AlignmentRenderer({
        config: mySettings.opencga.config
      }),
      dataAdapter: new OpencgaAdapter(this.opencgaSession.opencgaClient, "analysis/alignment", undefined, "query", settings.data)
    };
    mySettings = Object.assign(mySettings, settings.config, renderer);
    return new AlignmentTrack(mySettings);
  }
  /*
   settings is supposed to have:
   - type: alignment...
   - config: Configuration of the track (title, closable, height...)
   - source: opencga, cellbase...
   - data: data that will be used
   */


  addAlignmentTrack(settings = {}) {
    const resTracks = [];

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(settings.files) && settings.files.length > 0) {
      const _this = this;

      settings.files.forEach(function (file) {
        const mySettings = {
          data: {
            fileId: file.path,
            name: file.name,
            study: _this.opencgaSession.study.id
          }
        }; // if (UtilsNew.isNotEmptyArray(settings.filesName) && settings.filesName.length > 0) {
        //     mySettings.data.name = settings.filesName[file];
        //
        // }

        Object.assign(settings, mySettings);

        const track = _this._addAlignmentTrack(settings);

        resTracks.push(track);
      });
    }

    return resTracks;
  }

  addGenericTrack(settings) {
    switch (settings.type) {
      case "alignment":
      default:
        return this._addAlignmentTrack(settings);
    }
  }
  /* Building
    example:
      uriTemplate: "http://ws.babelomics.org/cellbase/webservices/rest/v4/hsapiens/genomic/region/13:32990000-32999999/snp?exclude={exclude}"
      templateVariables: {exclude:'annotation.populationFrequencies,annotation.additionalAttributes,transcriptVariations,xrefs,samples'}
   */


  _addTemplateTrack(settings = {}) {
    const uriTemplate = settings.uriTemplate;
    const templateVariables = settings.templateVariables;
    const title = settings.title;
    const t = new FeatureTrack({
      title: title,
      closable: true,
      minHistogramRegionSize: 20000000,
      maxLabelRegionSize: 10000000,
      minTranscriptRegionSize: 200000,
      histogramColor: "#92de47",
      height: 100,
      renderer: new FeatureRenderer(FEATURE_TYPES.snp),
      dataAdapter: new FeatureTemplateAdapter({
        multiRegions: false,
        histogramMultiRegions: false,
        uriTemplate: uriTemplate,
        templateVariables: templateVariables,
        species: genomeBrowser.species,
        cacheConfig: {
          chunkSize: 100000
        },
        parse: function parse(response) {
          const chunks = [];

          for (let i = 0; i < response.response.length; i++) {
            const res = response.response[i].result;
            chunks.push(res);
          }

          return chunks;
        }
      })
    });
    return t;
  }

  _setRegion(region) {
    if (typeof this.genomeBrowser === "undefined") {
      this.init();
    }

    if (typeof this.genomeBrowser !== "undefined" && this.active) {
      this.genomeBrowser.setRegion(region);
    }
  } //            _setSamples(samples) {
  //                if (typeof this.genomeBrowser === "undefined") {
  //                    this.init();
  //                }
  //            }


  _updateWidth(width) {
    if (typeof this.genomeBrowser !== "undefined") {
      // Check if width has been passed, otherwise we calculate the max for the current DIV size
      if (width === undefined || width === null || width < 0) {
        width = $("#" + this._prefix + "GenomeBrowser").width();
      } // Set the with to the genome browser


      this.genomeBrowser.setWidth(width);
    }
  }

  _setActive(active) {
    if (active && typeof this.genomeBrowser === "undefined") {
      this.init();
    }
  }

  _getConfiguredTracks(tracks) {
    const _tracks = [];
    const featureTracks = [];

    for (let i = 0; i < tracks.length; i++) {
      const track = tracks[i];

      switch (track.type) {
        case "sequence":
          _tracks.push(this._addSequenceTrack(track.config));

          break;

        case "gene":
          _tracks.push(this._addGeneTrack(track.config));

          break;

        case "variant":
          // featureTracks[track.id] = this._addVariantTrack(track.config);
          featureTracks.push(this._addVariantTrack(track.config));
          break;

        case "alignment":
          // featureTracks[track.id] = this._addAlignmentTrack(track.config);
          featureTracks.push(this._addAlignmentTrack(track.config));
          break;

        case "template":
          _tracks.push(this._addTemplateTrack(track.config));

          break;
        //                            default:
        //                                tracks.push(this.addGenericTrack(this.trackConfigs[this.tracks[i]]));
        //                                break;
      }
    } // if (UtilsNew.isNotUndefinedOrNull(files)) {
    //     for (let sample in files) {
    //         let featureFiles = files[sample];
    //         for (let j = 0; j < featureFiles.length; j++) {
    //             featureFiles[j].display = display;
    //             if (featureFiles[j].bioformat === "VARIANT") {
    //                 variants[role] = featureFiles[j];
    //                 variants[role]['sample'] = samples[i];
    //             } else if (featureFiles[j].bioformat === "ALIGNMENT") {
    //                 alignments[role] = featureFiles[j];
    //             } else if (featureFiles[j].bioformat === "COVERAGE") {
    //                 coverage[role] = featureFiles[j];
    //             }
    //         }
    //     }
    // }


    return [_tracks, featureTracks];
  }

  getDefaultFilters() {
    return {
      title: "Genome Browser Filters",
      active: false,
      filters: [{
        title: "Search by Region",
        example: "e.g. 3:55555-666666",
        id: "region"
      }, {
        title: "Search by Gene",
        example: "Search for Gene Symbols",
        id: "gene"
      }, {
        title: "Panel",
        id: "panel",
        values: ["Xeroderma_pigmentosum-Trichothiodystrophy_or_Cockayne_syndrome-PanelAppId-77", "White_matter_disorders_and_cerebral_calcification-narrow_panel-PanelAppId-476"]
      }, {
        title: "Show alignments (BAM)",
        id: "alignment"
      }, {
        title: "Show variants (VCF)",
        id: "variant"
      }]
    };
    /* Other allowed filters */
    // filters: [{
    //     title: "Select a Gene from a Panel",
    //     id: "panel",
    //     values: ["A", "B", "C"]
    // }, {
    //     title: "Show alignments (BAM)",
    //     id: "alignment"
    // }, {
    //     title: "Show variants (VCF)",
    //     id: "variant"
    // }]
  }

  render() {
    return lit_html_lit_html_html(genome_browser_templateObject(), this._prefix, this._prefix);
  }

}
customElements.define("genome-browser", genome_browser_GenomeBrowserComponent);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/variant-genome-browser.js
function variant_genome_browser_templateObject5() {
  const data = variant_genome_browser_taggedTemplateLiteral(["\n                          <label>No samples selected</label>\n                        "]);

  variant_genome_browser_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function variant_genome_browser_templateObject4() {
  const data = variant_genome_browser_taggedTemplateLiteral(["\n                                    <input type=\"checkbox\" style=\"padding-left: 25px\" class=\"", "FileCheckbox\"\n                                           data-file-id=\"", "\" @change=\"", "\"\n                                           .checked=\"", "\" data-file-name=\"", "\" >\n                                    <label>", "</label> ", "\n                                    <br>\n                                "]);

  variant_genome_browser_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function variant_genome_browser_templateObject3() {
  const data = variant_genome_browser_taggedTemplateLiteral(["\n                                ", "\n                            "]);

  variant_genome_browser_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function variant_genome_browser_templateObject2() {
  const data = variant_genome_browser_taggedTemplateLiteral(["\n                            ", "\n                        "]);

  variant_genome_browser_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function variant_genome_browser_templateObject() {
  const data = variant_genome_browser_taggedTemplateLiteral(["\n                <style include=\"jso-styles\"></style>\n\n        <!--<div class=\"alert alert-warning\" role=\"alert\" id=\"", "Warning\" style=\"padding: 10px\">-->\n        <!--<span style=\"font-weight: bold;font-size: 1.20em\">Warning!</span>&nbsp;&nbsp;Genome Browser is not fully integrated yet, this is just a prototype.-->\n        <!--</div>-->\n\n        <div class=\"panel panel-default\">\n            <div class=\"panel-heading\" role=\"tab\" id=\"", "GenomeBrowserSettings\">\n                <h3 class=\"panel-title\">\n                    <a class=\"collapsed\" role=\"button\" data-toggle=\"collapse\" data-parent=\"#", "Accordion\"\n                       href=\"#", "Position\" aria-expanded=\"true\" aria-controls=\"", "Position\">\n                        Settings\n                        <!--<div style=\"float: right\" class=\"tooltip-div\">-->\n                        <!--<a data-toggle=\"tooltip\" title=\"Introduce a region interval and/or gene/variant ids.-->\n                        <!--The filter will allow variants which fall within provided genomic intervals OR match the ids provided\">-->\n                        <!--<i class=\"fa fa-info-circle\" aria-hidden=\"true\"></i>-->\n                        <!--</a>-->\n                        <!--</div>-->\n                    </a>\n                </h3>\n            </div>\n\n            <div id=\"", "Position\" class=\"panel-collapse collapse in\" role=\"tabpanel\"\n                 aria-labelledby=\"", "GenomeBrowserSettings\">\n                <div class=\"panel-body\">\n                    <h4>Variant</h4>\n                    <input type=\"checkbox\"> View extended\n                    <h4 style=\"padding-top: 5px\">Alignments</h4>\n                    <div style=\"padding-left: 20px\">\n                        ", "\n                    </div>\n                    <div style=\"width: 120px;float: right;\">\n                        <button type=\"button\" class=\"btn btn-primary\" style=\"width: 100%\"\n                                @click=\"", "\">Refresh\n                        </button>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n\n        <div>\n            <div class=\"\" style=\"font-size: 11px;width: 20%;float: left;padding: 0px 0px\">\n                <table id=\"", "VariantGenomeBrowserTable\" data-pagination=\"true\" data-page-list=\"[]\"\n                       style=\"padding: 0px 0px\"></table>\n            </div>\n            <div class=\"\" style=\"width: 80%;float: right;padding: 0px 5px\">\n                <genome-browser .cellbaseClient=\"", "\"\n                                .opencgaClient=\"", "\"\n                                .species=\"", "\"\n                                .region=\"", "\"\n                                .tracks=\"", "\"\n                                .study=\"", "\"\n                                .project=\"", "\"\n                                .active=\"", "\"\n                                .width=\"", "\">\n                </genome-browser>\n            </div>\n        </div>"]);

  variant_genome_browser_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function variant_genome_browser_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */





class variant_genome_browser_VariantGenomeBrowser extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object,
        observer: "render"
      },
      opencgaClient: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      query: {
        type: Object
      },
      search: {
        type: Object,
        observer: "render"
      },
      samples: {
        type: Array,
        observer: "changeSamples"
      },
      species: {
        type: Object
      },
      region: {
        type: Object
      },
      active: {
        type: Boolean,
        value: false
      },
      fullScreen: {
        type: Boolean,
        observer: "onFullScreen"
      }
    };
  }

  _init() {
    //this._prefix = "sf-" + Utils.randomString(6) + "_";
    if (utilsNew_UtilsNew.isEmpty(this._prefix)) {
      this._prefix = "VarGenBrowser".concat(utils.randomString(6));
    }
  }

  updated(changedProperties) {
    if (changedProperties.has("property")) {
      this.propertyObserver();
    }
  }

  static get observers() {
    return ["_hasFilesSamples(samplesWithFiles.*)"];
  }

  ready() {
    super.ready();
    this.summary = true;
    this.tracks = {
      sequence: {
        type: "sequence"
      },
      gene: {
        type: "gene"
      },
      variant: {
        type: "variant",
        config: {}
      },
      alignment: {
        type: "alignment",
        config: {}
      }
    };
  }

  connectedCallback() {
    super.connectedCallback();
    this.existsSamplesWithfiles = false;
    this.render();
    this.table = PolymerUtils_PolymerUtils.getElementById("".concat(this._prefix, "VariantGenomeBrowserTable"));
  }

  changeSamples(e) {
    this.getFilesToVisualiseAlignmentTracks();
  }

  _hasFilesSamples() {
    let result = false;

    if (utilsNew_UtilsNew.isNotEmptyArray(this.samplesWithFiles)) {
      let someWithfiles = this.samplesWithFiles.some(element => {
        return utilsNew_UtilsNew.isNotEmptyArray(element.files);
      });
      result = someWithfiles;
    }

    this.existsSamplesWithfiles = result;
  }

  getFilesToVisualiseAlignmentTracks(settings) {
    this.samplesWithFiles = [];

    if (utilsNew_UtilsNew.isUndefinedOrNull(this._filesSelectedAlignment)) {
      this._filesSelectedAlignment = new Set();
      this._filesSelectedAlignmentName = [];
    }

    if (utilsNew_UtilsNew.isNotEmptyArray(this.samples)) {
      if (utilsNew_UtilsNew.isUndefined(settings)) {
        settings = {};
      }

      const samples = [];
      this.samples.forEach(sample => {
        samples.push(sample.id);
      });
      const query = {
        samples,
        study: this.opencgaSession.study.id,
        format: "BAM",
        include: "id,name,path,samples"
      };

      const _this = this;

      let _samplesWithFiles = [];
      let currentFilesSelectedAlignment = new Set();
      let currentFilesSelectedNameAlignment = [];
      this.opencgaClient.files().search(query).then(response => {
        if (utilsNew_UtilsNew.isNotEmptyArray(response.response[0].result)) {
          _this.samples.forEach(sampleSelected => {
            const filesSamples = [];
            response.response[0].result.forEach(file => {
              const containSample = file.samples.some(sampleFile => sampleFile.id === sampleSelected.id);

              if (containSample) {
                file.checked = false;

                if (_this._filesSelectedAlignment.has(file.id)) {
                  file.checked = true; // this file id is which is selected from previous selection.

                  currentFilesSelectedAlignment.add(file.id);
                  currentFilesSelectedNameAlignment[file.id] = file.name;
                }

                filesSamples.push(file);
              }
            }); // Push linked filename list with sampleSelected using polymer array mutation method to update dom-repeat

            _samplesWithFiles.push({
              name: sampleSelected.name,
              files: filesSamples
            });
          });
        } // Re-assign selected files after select samples and update files to remove alignment track that are not selected after remove its samples


        _this._filesSelectedAlignment = currentFilesSelectedAlignment;
        _this._filesSelectedAlignmentName = currentFilesSelectedNameAlignment;
        _this.samplesWithFiles = _samplesWithFiles; //                            _this._files = currentFilesSelectedAlignment;

        _this.tracks.alignment.config.files = _this._filesSelectedAlignment;
        _this.tracks.alignment.config.filesName = _this._filesSelectedAlignmentName;
        _this.tracks.variant.config.samples = _this.samples;

        _this.set("tracks", Object.assign({}, _this.tracks)); // Update sampleswithfiles to show in checkbox
        // Update _samples to render variant track
        //                            _this._samples = _this.samples;

      }).catch(response => {
        console.log(response);
      });
    } else {
      //                    this._samples = [];
      //                    this._files = [];
      let _tracks = {
        sequence: {
          type: "sequence"
        },
        gene: {
          type: "gene"
        },
        variant: {
          type: "variant"
        },
        alignment: {
          type: "alignment",
          config: {}
        }
      };
      this.set("tracks", _tracks);
    }
  }

  render() {
    this.variant = ""; // Empty the variant every time the grid is loaded

    if (typeof this.opencgaClient !== "undefined" && this.opencgaClient instanceof OpenCGAClient && typeof this.opencgaSession !== "undefined" && typeof this.opencgaSession.project !== "undefined" && typeof this.opencgaSession.study !== "undefined" && typeof this.opencgaSession.study.alias !== "undefined") {
      const urlQueryParams = this._getUrlQueryParams();

      const queryParams = urlQueryParams.queryParams;

      let _numTotal = -1;

      const _this = this;

      $("#".concat(_this._prefix, "VariantGenomeBrowserTable")).bootstrapTable("destroy");
      $("#".concat(_this._prefix, "VariantGenomeBrowserTable")).bootstrapTable({
        url: urlQueryParams.host,
        columns: [{
          title: "Variant",
          field: "variant",
          formatter: this.variantFormatter
        }],
        method: "get",
        sidePagination: "server",

        queryParams(params) {
          queryParams.limit = params.limit;
          queryParams.skip = params.offset; //                            queryParams.skipCount = true;

          if (typeof _this.query !== "undefined" && typeof _this.query.gene !== "undefined" && _this.query.gene !== "") {
            queryParams.skipCount = false;
          }

          return queryParams;
        },

        responseHandler(res) {
          if (_numTotal === -1) {
            if (_this.summary || typeof _this.query !== "undefined" && typeof _this.query.gene !== "undefined" && _this.query.gene !== "") {
              _numTotal = res.response[0].numTotalResults;
            } else {
              _numTotal = 1150;
            }
          }

          return {
            total: _numTotal,
            rows: res.response[0].result
          };
        },

        onClickRow(row, $element) {
          $(".success").removeClass("success");
          $($element).addClass("success"); //                            _this._onSelectVariant(row);

          _this.region = new Region({
            chromosome: row.chromosome,
            start: row.start,
            end: row.end
          }); //                            _this.set("region", new Region({chromosome: row.chromosome, start: row.start, end: row.end}));
        },

        onLoadSuccess(data) {
          // The first time we mark as selected the first row that is rows[2] since the first two rows are the header
          const table = PolymerUtils_PolymerUtils.getElementById("".concat(_this._prefix, "VariantGenomeBrowserTable"));

          if (utilsNew_UtilsNew.isNotUndefinedOrNull(table)) {
            table.rows[1].setAttribute("class", "success"); //                            _this._onSelectVariant(data.rows[0]);

            if (typeof data !== "undefined" && data.rows.length > 0) {
              _this.region = new Region({
                chromosome: data.rows[0].chromosome,
                start: data.rows[0].start,
                end: data.rows[0].end
              }); //                                    _this.set('region', new Region({chromosome: data.rows[0].chromosome, start: data.rows[0].start, end: data.rows[0].end}));
            }
          }
        }

      });
      $("#".concat(_this._prefix, "VariantGenomeBrowserTable")).bootstrapTable("showLoading");
    }
  }

  _getUrlQueryParams() {
    if (typeof this.opencgaClient === "undefined") {
      return {
        host: "",
        queryParams: {},
        url: ""
      };
    }

    let host = this.opencgaClient.getConfig().host;

    if (!host.startsWith("https://") && !host.startsWith("http://")) {
      host = "https://".concat(host);
    }

    if (typeof this.opencgaSession.project !== "undefined" && typeof this.opencgaSession.study.alias !== "undefined") {
      if (typeof this.query === "undefined") {
        this.query = {};
      }

      if (typeof this.query.studies === "undefined" || this.query.studies === "" || this.query.studies.split(new RegExp("[,;]")).length === 1) {
        this.query.studies = "".concat(this.opencgaSession.project.alias, ":").concat(this.opencgaSession.study.alias);
      }

      host += "/webservices/rest/v1/analysis/variant/query";
    } else {
      return {
        host,
        queryParams: {},
        url: ""
      };
    }

    const queryParams = {
      sid: this.opencgaClient._config.sessionId,
      timeout: 60000,
      summary: this.summary
    };
    Object.assign(queryParams, this.query); // Important : Adding the query object contents to queryParams

    if (typeof this.samples !== "undefined" && this.samples.length > 0) {
      const sampleNames = [];

      for (const sampleIdx in this.samples) {
        sampleNames.push(this.samples[sampleIdx].name);
      }

      queryParams.returnedSamples = sampleNames.join();
    } else {
      // queryParams.exclude = "studies,annotation.xrefs,annotation.populationFrequencies,annotation.conservation,annotation.geneTraitAssociation,annotation.geneDrugInteraction";
      queryParams.include = "id,chromosome,start,end,type,annotation.consequenceTypes";
    }

    if (typeof this.config !== "undefined" && typeof this.config.missing !== "undefined" && this.config.missing) {
      const keys = Object.keys(queryParams);

      for (let i = 0; i < keys.length; i++) {
        let val = queryParams[keys[i]];

        if (typeof val === "string") {
          val = val.replace(/</g, "<<");
          val = val.replace(/>/g, ">>");
          queryParams[keys[i]] = val;
        }
      }
    }

    const query = ["limit=1000"];

    for (const key in queryParams) {
      // Check sid has a proper value. For public projects sid is undefined. In that case, sid must be removed from the url
      if (key === "sid" && queryParams[key] === undefined) {
        delete queryParams.sid;
      } else {
        query.push("".concat(key, "=").concat(queryParams[key]));
      }
    }

    const url = "".concat(host, "?").concat(query.join("&"));
    return {
      host,
      queryParams,
      url
    };
  }

  variantFormatter(value, row) {
    const ref = row.reference !== "" ? row.reference : "-";
    const alt = row.alternate !== "" ? row.alternate : "-";
    let html = "".concat(row.chromosome, ":").concat(row.start, " ").concat(ref, "/").concat(alt);

    if (typeof row.id !== "undefined" && row.id !== "") {
      html += "&nbsp;(<a target='_blank' href='https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?type=rs&rs=".concat(row.id, "'>").concat(row.id, "</a>)");
    }

    if (typeof row.annotation !== "undefined" && typeof row.annotation.consequenceTypes !== "undefined" && row.annotation.consequenceTypes.length > 0) {
      html += "<br>";
      const cts = new Set();
      const arr = [];

      for (const ct of row.annotation.consequenceTypes) {
        if (!cts.has(ct.geneName)) {
          arr.push(ct.geneName);
          cts.add(ct.geneName);
        }
      }

      html += "<span>".concat(arr.join(), "</span>");
    }

    return "<span style='white-space: nowrap;font-weight: bold'>".concat(html, "</span>");
  }

  onFullScreen() {
    if (this.fullScreen) {
      this.genomeBrowserWidth = -1;
    } else {
      this.genomeBrowserWidth = -2;
    }
  }

  onRefreshAlignmentRender(e) {
    this.tracks.alignment.config.files = this._filesSelectedAlignment;
    this.tracks.alignment.config.filesName = this._filesSelectedAlignmentName;
    this.set("tracks", Object.assign({}, this.tracks));
  }

  toggleSelection(e) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(e.target)) {
      let idFile = e.target.getAttribute("data-file-id");
      let filename = e.target.getAttribute("data-file-name");

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(idFile)) {
        idFile = parseInt(idFile);

        if (this._filesSelectedAlignment.has(idFile)) {
          this._filesSelectedAlignment.delete(idFile);

          let filesSelectedAlignmentName = [];

          this._filesSelectedAlignmentName.forEach((element, index) => {
            if (idFile !== index) {
              filesSelectedAlignmentName[index] = element;
            }
          });

          this._filesSelectedAlignmentName = filesSelectedAlignmentName;
        } else {
          this._filesSelectedAlignment.add(idFile);

          this._filesSelectedAlignmentName[idFile] = filename;
        }
      }
    }
  }

  render_NEW() {
    return lit_html_lit_html_html(variant_genome_browser_templateObject(), this._prefix, this._prefix, this._prefix, this._prefix, this._prefix, this._prefix, this._prefix, this.existsSamplesWithfiles ? lit_html_lit_html_html(variant_genome_browser_templateObject2(), this.samplesWithFiles && this.samplesWithFiles.length ? this.samplesWithFiles.map(sample => lit_html_lit_html_html(variant_genome_browser_templateObject3(), this.sample.files.map(file => lit_html_lit_html_html(variant_genome_browser_templateObject4(), this._prefix, file.id, this.toggleSelection, file.checked, file.name, sample.name, file.name)))) : null) : lit_html_lit_html_html(variant_genome_browser_templateObject5()), this.onRefreshAlignmentRender, this._prefix, this.cellbaseClient, this.opencgaClient, this.species, this.region, this.tracks, this.opencgaSession.study, this.opencgaSession.project, this.active, this.genomeBrowserWidth);
  }

}
customElements.define("variant-genome-browser", variant_genome_browser_VariantGenomeBrowser);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/region.js


class region_Region {
  constructor(args) {
    this.chromosome = null;
    this.start = null;
    this.end = null;
    this.chromosomeAlias = ["chromosome", "sequenceName"];

    if (_.isObject(args)) {
      this.load(args);
    } else if (_.isString(args)) {
      this.parse(args);
    }
  }

  load(obj) {
    if (_.isString(obj)) {
      return this.parse(obj);
    }

    this.chromosome = this._checkChromosomeAlias(obj) || this.chromosome;

    if (typeof obj.position !== "undefined") {
      obj.start = parseInt(obj.position);
      obj.end = obj.start;
    }

    utilsNew_UtilsNew.isUndefinedOrNull(obj.start) ? this.start = parseInt(this.start) : this.start = parseInt(obj.start);
    utilsNew_UtilsNew.isUndefinedOrNull(obj.end) ? this.end = parseInt(this.end) : this.end = parseInt(obj.end);
  }

  parse(str) {
    if (_.isObject(str)) {
      this.load(str);
    }

    const pattern = /^([a-zA-Z0-9_])+\:([0-9])+\-([0-9])+$/;
    const pattern2 = /^([a-zA-Z0-9_])+\:([0-9])+$/;

    if (pattern.test(str) || pattern2.test(str)) {
      const splitDots = str.split(":");

      if (splitDots.length === 2) {
        const splitDash = splitDots[1].split("-");
        this.chromosome = splitDots[0];
        this.start = parseInt(splitDash[0]);

        if (splitDash.length === 2) {
          this.end = parseInt(splitDash[1]);
        } else {
          this.end = this.start;
        }
      }

      return true;
    }

    return false;
  }

  multiParse(str) {
    if (_.isObject(str)) {
      this.load(obj);
    }

    const pattern = /^([a-zA-Z0-9_])+\:([0-9])+\-([0-9])+(,([a-zA-Z0-9_])+\:([0-9])+\-([0-9])+)*$/;
    const pattern2 = /^\[([a-zA-Z0-9_])+\:([0-9])+\-([0-9])+(,([a-zA-Z0-9_])+\:([0-9])+\-([0-9])+)*\]$/;
    let withoutBrackets = str;

    if (pattern2.test(str)) {
      withoutBrackets = str.slice(1, str.length - 1);
    }

    const regions = [];

    if (pattern.test(withoutBrackets)) {
      const splitRegions = withoutBrackets.split(",");

      for (let i = 0; i < splitRegions.length; i++) {
        regions.push(new region_Region(splitRegions[i]));
      }
    }

    return regions;
  }

  center() {
    return this.start + Math.floor(this.length() / 2);
  }

  length() {
    return this.end - this.start + 1;
  }

  equals(r) {
    return this.chromosome === r.chromosome && this.start === r.start && this.end === r.end;
  }

  toString(formatted) {
    let str;

    if (formatted === true) {
      str = "".concat(this.chromosome, ":").concat(utils.formatNumber(this.start), "-").concat(utils.formatNumber(this.end));
    } else {
      str = "".concat(this.chromosome, ":").concat(this.start, "-").concat(this.end);
    }

    return str;
  }

  _checkChromosomeAlias(obj) {
    for (let i = 0; i < this.chromosomeAlias.length; i++) {
      const alias = this.chromosomeAlias[i];

      if (alias in obj) {
        return obj[alias];
      }
    }
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/somatic-filter.js
function somatic_filter_templateObject() {
  const data = somatic_filter_taggedTemplateLiteral(["\n            <form id=\"", "-somatic\" class=\"subsection-content form-group\">\n               \n            <fieldset>\n                <div class=\"switch-toggle alert text-white alert-light\">\n                    <input id=\"", "-somatic-option-none\"\n                                   class=\"form-group-sm ", "FilterRadio\"\n                                   type=\"radio\" name=\"", "-somatic-options\" value=\"\"\n                                   @change=\"", "\" checked>\n                    <label for=\"", "-somatic-option-none\"><span class=\"small\">None</span></label>\n            \n                    <input id=\"", "-somatic-option-true\"\n                                                   class=\"form-group-sm ", "FilterRadio\"\n                                                   type=\"radio\" name=\"", "-somatic-options\" value=\"True\"\n                                                   @change=\"", "\">\n                    <label for=\"", "-somatic-option-true\"><span class=\"small\">True</span></label>\n                \n                    <input id=\"", "-somatic-option-false\"\n                                                   class=\"form-group-sm ", "FilterRadio\"\n                                                   type=\"radio\" name=\"", "-somatic-options\" value=\"False\"\n                                                   @change=\"", "\">\n                    <label for=\"", "-somatic-option-false\"><span class=\"small\">False</span></label>\n            \n                    <a class=\"btn btn-primary ripple\"></a>\n                </div>\n            </fieldset>\n              \n            </form>\n        "]);

  somatic_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function somatic_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


class somatic_filter_SomaticFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      placeholder: {
        type: String
      },
      value: {
        type: String
      }
    };
  }

  createRenderRoot() {
    return this;
  }

  _init() {
    this._prefix = "tff-" + utils.randomString(6) + "_";
  }
  /* set value(val) {
      let oldVal = this._value;
      this._value = val;
      this.requestUpdate('value', oldVal);
  }*/


  updated(_changedProperties) {
    if (_changedProperties.has("value")) {
      if (this.value) {
        this.querySelector("input[value='".concat(this.value, "']")).checked = true;
      } else {
        $("input", this).prop("checked", false);
      }
    }
  }

  filterChange(e) {
    console.log("filterChange", e.target.value);
    const event = new CustomEvent("filterChange", {
      detail: {
        value: e.target.value || null
      }
    });
    this.dispatchEvent(event);
  }

  render() {
    return lit_html_lit_html_html(somatic_filter_templateObject(), this._prefix, this._prefix, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this._prefix, this._prefix, this.filterChange, this._prefix, this._prefix, this._prefix, this._prefix, this.filterChange, this._prefix);
  }

}
customElements.define("somatic-filter", somatic_filter_SomaticFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/filters/section-filter.js
function section_filter_templateObject3() {
  const data = section_filter_taggedTemplateLiteral(["<div>No config</div>"]);

  section_filter_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function section_filter_templateObject2() {
  const data = section_filter_taggedTemplateLiteral(["", ""]);

  section_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function section_filter_templateObject() {
  const data = section_filter_taggedTemplateLiteral(["\n                <div class=\"panel panel-default filter-section shadow-sm\">\n                    <div class=\"panel-heading\" role=\"tab\" id=\"", "", "Heading\">\n                            <h4 class=\"panel-title\">\n                                <a class=\"collapsed\" role=\"button\" data-toggle=\"collapse\" data-parent=\"#", "Accordion\"\n                                    href=\"#", "", "\" aria-expanded=\"true\" aria-controls=\"", "", "\">\n                                    ", "\n                                </a>\n                            </h4>\n                    </div>\n                    <div id=\"", "", "\" class=\"panel-collapse collapse ", "\" role=\"tabpanel\" aria-labelledby=\"", "", "Heading\">\n                        <div class=\"panel-body\">\n                            ", "\n                        </div>\n                    </div>\n                </div>                    \n        "]);

  section_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function section_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


/**
 * This is a wrapper component of a group of filters
* */

class section_filter_SectionFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      config: {
        type: Object
      },
      filters: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "sf-" + utils.randomString(6) + "_";
  }

  connectedCallback() {
    super.connectedCallback();
    this.id = this.config.title.replace(/ /g, "");
  }

  render() {
    return this.config ? lit_html_lit_html_html(section_filter_templateObject(), this._prefix, this.id, this._prefix, this._prefix, this.id, this._prefix, this.id, this.config.title, this._prefix, this.id, this.config.collapsed ? "" : "in", this._prefix, this.id, this.filters.map(filter => lit_html_lit_html_html(section_filter_templateObject2(), filter))) : lit_html_lit_html_html(section_filter_templateObject3());
  }

}
customElements.define("section-filter", section_filter_SectionFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/samples/opencga-sample-filter.js
function opencga_sample_filter_templateObject11() {
  const data = opencga_sample_filter_taggedTemplateLiteral(["No filter has been configured."]);

  opencga_sample_filter_templateObject11 = function _templateObject11() {
    return data;
  };

  return data;
}

function opencga_sample_filter_templateObject10() {
  const data = opencga_sample_filter_taggedTemplateLiteral(["\n                <div class=\"search-button-wrapper\">\n                    <button type=\"button\" class=\"btn btn-primary ripple\" @click=\"", "\">\n                        <i class=\"fa fa-search\" aria-hidden=\"true\"></i> Search\n                    </button>\n                </div>\n                "]);

  opencga_sample_filter_templateObject10 = function _templateObject10() {
    return data;
  };

  return data;
}

function opencga_sample_filter_templateObject9() {
  const data = opencga_sample_filter_taggedTemplateLiteral(["\n            <style include=\"jso-styles\">\n                .label-opencga-sample-filter {\n                    padding-top: 10px;\n                }\n            \n                span + span {\n                    margin-left: 10px;\n                }\n            \n                .browser-ct-scroll {\n                    /*max-height: 450px;*/\n                    /*overflow-y: scroll;*/\n                    overflow-x: scroll;\n                }\n            \n                .browser-ct-tree-view,\n                .browser-ct-tree-view * {\n                    padding: 0;\n                    margin: 0;\n                    list-style: none;\n                }\n            \n                .browser-ct-tree-view li ul {\n                    margin: 0 0 0 22px;\n                }\n            \n                .browser-ct-tree-view * {\n                    vertical-align: middle;\n                }\n            \n                .browser-ct-tree-view {\n                    /*font-size: 14px;*/\n                }\n            \n                .browser-ct-tree-view input[type=\"checkbox\"] {\n                    cursor: pointer;\n                }\n            \n                .browser-ct-item {\n                    white-space: nowrap;\n                    display: inline\n                }\n            \n                div.block {\n                    overflow: hidden;\n                }\n            \n                div.block label {\n                    width: 80px;\n                    display: block;\n                    float: left;\n                    text-align: left;\n                    font-weight: normal;\n                }\n            \n                select + select {\n                    margin-left: 10px;\n                }\n            \n                select + input {\n                    margin-left: 10px;\n                }\n\n                span.searchingSpan {\n                    background-color: #286090;\n                }\n            \n                .searchingButton {\n                    color: #fff;\n                }\n            \n                .notbold {\n                    font-weight: normal;\n                }\n\n            </style>\n            \n            ", "\n            \n            <div class=\"panel-group\" id=\"", "Accordion\" role=\"tablist\" aria-multiselectable=\"true\"\n                 style=\"padding-top: 20px\">\n            \n                <!-- Sample field attributes -->\n                <div class=\"\">            \n                    ", "\n                </div>\n            </div>\n        "]);

  opencga_sample_filter_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function opencga_sample_filter_templateObject8() {
  const data = opencga_sample_filter_taggedTemplateLiteral(["\n                                <div class=\"tooltip-div pull-right\">\n                                    <a><i class=\"fa fa-info-circle\" aria-hidden=\"true\" id=\"", "", "Tooltip\"></i></a>\n                                </div>"]);

  opencga_sample_filter_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_sample_filter_templateObject7() {
  const data = opencga_sample_filter_taggedTemplateLiteral(["\n                    <div class=\"form-group\">\n                        <div class=\"browser-subsection\" id=\"", "\">", "\n                            ", "\n                        </div>\n                        <div id=\"", "", "\" class=\"subsection-content\">\n                            ", "\n                         </div>\n                    </div>\n                "]);

  opencga_sample_filter_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_sample_filter_templateObject6() {
  const data = opencga_sample_filter_taggedTemplateLiteral(["<feature-filter .cellbaseClient=\"", "\" .query=", "\n                                            @filterChange=\"", "\"></feature-filter>"]);

  opencga_sample_filter_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_sample_filter_templateObject5() {
  const data = opencga_sample_filter_taggedTemplateLiteral(["<opencga-date-filter .config=\"", "\" @filterChange=\"", "\"></opencga-date-filter>"]);

  opencga_sample_filter_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_sample_filter_templateObject4() {
  const data = opencga_sample_filter_taggedTemplateLiteral(["<somatic-filter .value=\"", "\" @filterChange=\"", "\"></somatic-filter>"]);

  opencga_sample_filter_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_sample_filter_templateObject3() {
  const data = opencga_sample_filter_taggedTemplateLiteral(["<opencga-annotation-filter .opencgaSession=\"", "\"\n                                                      .opencgaClient=\"", "\"\n                                                      entity=\"SAMPLE\"\n                                                      .config=\"", "\"\n                                                      @filterannotation=\"", "\">\n                           </opencga-annotation-filter>"]);

  opencga_sample_filter_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_sample_filter_templateObject2() {
  const data = opencga_sample_filter_taggedTemplateLiteral(["<text-field-filter placeholder=\"", "\" .value=\"", "\" @filterChange=\"", "\"></text-field-filter>"]);

  opencga_sample_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_sample_filter_templateObject() {
  const data = opencga_sample_filter_taggedTemplateLiteral(["<section-filter .config=\"", "\" .filters=\"", "\">"]);

  opencga_sample_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_sample_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_sample_filter_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_sample_filter_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_sample_filter_ownKeys(Object(source), true).forEach(function (key) { opencga_sample_filter_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_sample_filter_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_sample_filter_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */











class opencga_sample_filter_OpencgaSampleFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      samples: {
        type: Array // notify: true //todo check notify and replace with _didRender() if necessary https://github.com/Polymer/lit-element/issues/81

      },
      query: {
        type: Object
      },
      variableSets: {
        type: Array
      },
      variables: {
        type: Array
      },
      minYear: {
        type: Number
      },
      compact: {
        type: Boolean
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    // super.ready();
    this._prefix = "osf-" + utils.randomString(6) + "_";
    this.annotationFilterConfig = {
      class: "small",
      buttonClass: "btn-sm",
      inputClass: "input-sm"
    };
    this.dateFilterConfig = {
      recentDays: 10
    };
    this.minYear = 1920;
    this.query = {};
    this.preparedQuery = {};
    this.searchButton = true;
  }

  connectedCallback() {
    super.connectedCallback();
    this.preparedQuery = opencga_sample_filter_objectSpread({}, this.query); // propagates here the iva-app query object
  }

  updated(changedProperties) {
    if (changedProperties.has("query")) {
      this.queryObserver();
    }

    if (changedProperties.has("variables")) {// this.variablesChanged()
    }
  }
  /*    //TODO in progress, added to replace notify
  filterChange() {
      const value = ``;
      console.log("filterChange", value);
      const event = new CustomEvent("filterChange", {
          detail: {
              value: value || null
          }
      });
      this.dispatchEvent(event);
  }*/


  onSearch() {
    this.search = opencga_sample_filter_objectSpread({}, this.query);
    this.notifySearch(this.preparedQuery);
  }

  onDateChanged(e) {
    const query = {};
    Object.assign(query, this.query);

    if (utilsNew_UtilsNew.isNotEmpty(e.detail.date)) {
      query["creationDate"] = e.detail.date;
    } else {
      delete query["creationDate"];
    }

    this._reset = false;
    this.query = query;
    this._reset = true;
  }

  queryObserver() {
    if (this._reset) {
      console.log("queryObserver: calling to 'renderQueryFilters()'", this.query);
      this.preparedQuery = this.query; // renderQueryFilters shouldn't be necessary anymore
      // this.renderQueryFilters();

      this.requestUpdate();
    } else {
      this._reset = true;
    }
  }

  onFilterChange(key, value) {
    console.log("filterChange", {
      [key]: value
    });

    if (value && value !== "") {
      this.preparedQuery = opencga_sample_filter_objectSpread({}, this.preparedQuery, {}, {
        [key]: value
      });
    } else {
      console.log("deleting", key, "from preparedQuery");
      delete this.preparedQuery[key];
      this.preparedQuery = opencga_sample_filter_objectSpread({}, this.preparedQuery);
    }

    this.notifyQuery(this.preparedQuery);
    this.requestUpdate();
  }

  addAnnotation(e) {
    // console.log("addAnnotation", e)
    if (typeof this._annotationFilter === "undefined") {
      this._annotationFilter = {};
    }

    const split = e.detail.value.split("=");
    this._annotationFilter[split[0]] = split[1];
    const _query = {};
    Object.assign(_query, this.query);
    const annotations = [];

    for (const key in this._annotationFilter) {
      annotations.push("".concat(key, "=").concat(this._annotationFilter[key]));
    }

    this.preparedQuery.annotation = annotations.join(";");
    this.preparedQuery = opencga_sample_filter_objectSpread({}, this.preparedQuery);
    this.notifyQuery(this.preparedQuery);
    this.requestUpdate();
  }

  notifyQuery(query) {
    this.dispatchEvent(new CustomEvent("queryChange", {
      detail: {
        query: query
      },
      bubbles: true,
      composed: true
    }));
  }

  notifySearch(query) {
    this.dispatchEvent(new CustomEvent("querySearch", {
      detail: {
        query: query
      },
      bubbles: true,
      composed: true
    }));
  }

  _createSection(section) {
    const htmlFields = section.fields && section.fields.length && section.fields.map(subsection => this._createSubSection(subsection));
    return this.config.sections.length > 1 ? lit_html_lit_html_html(opencga_sample_filter_templateObject(), section, htmlFields) : htmlFields;
  }

  _createSubSection(subsection) {
    let content = "";

    switch (subsection.id) {
      case "id":
      case "individual":
      case "source":
      case "phenotypes":
        content = lit_html_lit_html_html(opencga_sample_filter_templateObject2(), subsection.placeholder, this.preparedQuery[subsection.id], e => this.onFilterChange(subsection.id, e.detail.value));
        break;

      case "annotations":
        content = lit_html_lit_html_html(opencga_sample_filter_templateObject3(), this.opencgaSession, this.opencgaSession.opencgaClient, this.annotationFilterConfig, this.addAnnotation);
        break;

      case "somatic":
        content = lit_html_lit_html_html(opencga_sample_filter_templateObject4(), this.preparedQuery.somatic, e => this.onFilterChange("somatic", e.detail.value));
        break;

      case "date":
        content = lit_html_lit_html_html(opencga_sample_filter_templateObject5(), this.dateFilterConfig, e => this.onFilterChange("creationDate", e.detail.value));
        break;

      case "study":
        content = lit_html_lit_html_html(opencga_sample_filter_templateObject6(), this.cellbaseClient, this.query, e => this.onFilterChange("xref", e.detail.value));
        break;

      default:
        console.error("Filter component not found");
    }

    return lit_html_lit_html_html(opencga_sample_filter_templateObject7(), subsection.id, subsection.name, subsection.description ? lit_html_lit_html_html(opencga_sample_filter_templateObject8(), this._prefix, subsection.id) : null, this._prefix, subsection.id, content);
  }

  render() {
    return lit_html_lit_html_html(opencga_sample_filter_templateObject9(), this.searchButton ? lit_html_lit_html_html(opencga_sample_filter_templateObject10(), this.onSearch) : null, this._prefix, this.config.sections && this.config.sections.length ? this.config.sections.map(section => this._createSection(section)) : lit_html_lit_html_html(opencga_sample_filter_templateObject11()));
  }

}
customElements.define("opencga-sample-filter", opencga_sample_filter_OpencgaSampleFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/samples/opencga-sample-grid.js
function opencga_sample_grid_templateObject() {
  const data = opencga_sample_grid_taggedTemplateLiteral(["\n        <style include=\"jso-styles\"></style>\n        <opencb-grid-toolbar .from=\"", "\"\n                             .to=\"", "\"\n                             .numTotalResultsText=\"", "\"\n                             .config=\"", "\"\n                             @columnchange=\"", "\"\n                             @download=\"", "\">\n        </opencb-grid-toolbar>\n\n        <div id=\"", "GridTableDiv\">\n            <table id=\"", "SampleBrowserGrid\">\n            </table>\n        </div>\n        "]);

  opencga_sample_grid_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_sample_grid_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_sample_grid_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_sample_grid_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_sample_grid_ownKeys(Object(source), true).forEach(function (key) { opencga_sample_grid_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_sample_grid_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_sample_grid_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */





class opencga_sample_grid_OpencgaSampleGrid extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      samples: {
        type: Array
      },
      query: {
        type: Object
      },
      search: {
        type: Object
      },
      active: {
        type: Boolean
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "VarSampleGrid" + utils.randomString(6) + "_";
    this.active = false;
  }

  firstUpdated() {//this.renderTable(this.active);
    // this.table = PolymerUtils.getElementById(this._prefix + "SampleBrowserGrid");
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession") || changedProperties.has("search") || changedProperties.has("config") || changedProperties.has("active")) {
      this.propertyObserver();
    }
  }

  propertyObserver() {
    // With each property change we must updated config and create the columns again. No extra checks are needed.
    this._config = Object.assign(this.getDefaultConfig(), this.config);
    this._columns = this._initTableColumns(); // Config for the grid toolbar

    this.toolbarConfig = {
      columns: this._columns[0]
    };
    this.renderTable(this.active);
  }

  renderTable(active) {
    if (!active) {
      return;
    }

    this.opencgaClient = this.opencgaSession.opencgaClient;
    this.samples = [];

    let filters = opencga_sample_grid_objectSpread({}, this.query);

    this.from = 1;
    this.to = 10;

    if (this.opencgaClient && this.opencgaSession.study && this.opencgaSession.study.fqn) {
      filters["study"] = this.opencgaSession.study.fqn;

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.lastFilters) && JSON.stringify(this.lastFilters) === JSON.stringify(filters)) {
        // Abort destroying and creating again the grid. The filters have not changed
        return;
      } // Store the current filters


      this.lastFilters = opencga_sample_grid_objectSpread({}, filters); // Make a copy of the samples (if they exist), we will use this private copy until it is assigned to this.samples

      if (utilsNew_UtilsNew.isNotUndefined(this.samples)) {
        this._samples = this.samples;
      } else {
        this._samples = [];
      } // Check that HTTP protocol is present and complete the URL

      /*let opencgaHostUrl = this.opencgaClient.getConfig().host;
      if (!opencgaHostUrl.startsWith("http://") && !opencgaHostUrl.startsWith("https://")) {
          opencgaHostUrl = "http://" + opencgaHostUrl;
      }
      opencgaHostUrl += "/webservices/rest/v1/samples/search";*/


      let skipCount = false;

      const _table = $("#" + this._prefix + "SampleBrowserGrid");

      const _this = this;

      $("#" + this._prefix + "SampleBrowserGrid").bootstrapTable("destroy");
      $("#" + this._prefix + "SampleBrowserGrid").bootstrapTable({
        //url: opencgaHostUrl,
        columns: _this._columns,
        method: "get",
        sidePagination: "server",
        uniqueId: "id",
        // Table properties
        pagination: _this._config.pagination,
        pageSize: _this._config.pageSize,
        pageList: _this._config.pageList,
        showExport: _this._config.showExport,
        detailView: _this._config.detailView,
        detailFormatter: _this._config.detailFormatter,

        /*queryParams: function(params) {
            if (this.pageNumber > 1) {
                skipCount = true;
            }
             const auxParams = {
                sid: Cookies.get(_this.opencgaClient.getConfig().cookieSessionId),
                order: params.order,
                sort: params.sort,
                limit: params.limit,
                skip: params.offset,
                includeIndividual: true,
                skipCount: skipCount
                // include: "id,source,collection,processing,creationDate,status,type,version,release,individual.id"
            };
             if (UtilsNew.isUndefined(filters)) {
                filters = {};
            }
            return Object.assign(filters, auxParams);
        },*/
        formatLoadingMessage: () => "<div><loading-spinner></loading-spinner></div>",
        ajax: params => {
          if (this.pageNumber > 1) {
            skipCount = true;
          }

          let _filters = opencga_sample_grid_objectSpread({
            //study: this.opencgaSession.study.fqn,
            order: params.data.order,
            limit: params.data.limit,
            skip: params.data.offset || 0,
            skipCount: this.pageNumber > 1
          }, filters);

          this.opencgaSession.opencgaClient.samples().search(_filters).then(res => params.success(res)).catch(e => console.error(e));
        },
        responseHandler: function responseHandler(response) {
          if (!skipCount) {
            if (!_this.hasOwnProperty("numTotalResults")) {
              _this.numTotalResults = 0;
            }

            if (_this.numTotalResults !== response.getResponse().numTotalResults && response.queryOptions.skip === 0) {
              _this.numTotalResults = response.getResponse().numTotalResults;
            }
          }

          _this.numTotalResultsText = _this.numTotalResults.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

          if (response.getParams().skip === 0 && _this.numTotalResults < response.getParams().limit) {
            _this.from = 1;
            _this.to = _this.numTotalResults;
          }

          _this.requestUpdate(); // it is necessary to refresh numTotalResultsText in opencga-grid-toolbar


          return {
            total: _this.numTotalResults,
            rows: response.getResults()
          };
        },
        onClickRow: function onClickRow(row, element, field) {
          if (_this._config.multiSelection) {
            $(element).toggleClass("success");
            const index = element[0].getAttribute("data-index"); // Check and uncheck actions trigger events that are captured below

            if ("selected" === element[0].className) {
              $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "SampleBrowserGrid")).bootstrapTable("uncheck", index);
            } else {
              $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "SampleBrowserGrid")).bootstrapTable("check", index);
            }
          } else {
            $(".success").removeClass("success");
            $(element).addClass("success");
          }

          _this._onSelectSample(row);
        },
        onCheck: function onCheck(row, elem) {
          // check sample is not already selected
          for (const i in _this._samples) {
            if (_this._samples[i].id === row.id) {
              return;
            }
          } // we add samples to selected samples


          _this._samples = row;
          _this.samples = _this._samples.slice();
        },
        onUncheck: function onUncheck(row, elem) {
          let sampleToDeleteIdx = -1;

          for (const i in _this.samples) {
            if (_this.samples[i].id === row.id) {
              sampleToDeleteIdx = i;
              break;
            }
          }

          if (sampleToDeleteIdx === -1) {
            return;
          }

          _this._samples = _this._samples.splice(sampleToDeleteIdx, 1);
          _this.samples = _this._samples.slice();
        },
        onCheckAll: function onCheckAll(rows) {
          const newSamples = _this._samples.slice(); // check sample is not already selected


          rows.forEach(sample => {
            const existsNewSelected = _this._samples.some(sampleSelected => {
              return sampleSelected.id === sample.id;
            });

            if (!existsNewSelected) {
              newSamples.push(sample);
            }
          }); // we add samples to selected samples

          _this._samples = newSamples;
          _this.samples = newSamples.slice();
        },
        onUncheckAll: function onUncheckAll(rows) {
          // check sample is not already selected
          rows.forEach(sample => {
            _this._samples = _this._samples.filter(sampleSelected => {
              return sampleSelected.id !== sample.id;
            });
          }); // we add samples to selected samples
          //                            _this.push("_samples", row);
          // _this.set('samples', _this._samples.slice());

          _this.samples = _this._samples.slice();
        },
        onLoadSuccess: function onLoadSuccess(data) {
          // Check all already selected rows. Selected samples are stored in this.samples array
          if (utilsNew_UtilsNew.isNotUndefinedOrNull(_table)) {
            if (!_this._config.multiSelection) {
              PolymerUtils_PolymerUtils.querySelector(_table.selector).rows[1].setAttribute("class", "success");

              _this._onSelectSample(data.rows[0]);
            }

            if (_this.samples !== "undefined") {
              for (const idx in _this.samples) {
                for (const j in data.rows) {
                  if (_this.samples[idx].id === data.rows[j].id) {
                    $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "SampleBrowserGrid")).bootstrapTable("check", j);
                    break;
                  }
                }
              }
            }
          }
        },
        onPageChange: function onPageChange(page, size) {
          _this.from = (page - 1) * size + 1;
          _this.to = page * size;
        } //                         onPostBody: function() {
        //                             if(PolymerUtils.getElementsByClassName(_this._prefix + 'Download')) {
        //                                 PolymerUtils.querySelectorAll("." + _this._prefix + "Download").forEach(elem => elem.addEventListener("click", _this.downloadQCFile.bind(_this), true));
        //
        // //                                PolymerUtils.getElementById(_this._prefix + 'Download').addEventListener('click', _this.downloadQCFile.bind(_this));
        //                             }
        //                         }

      });
    } else {
      // Delete table
      $(PolymerUtils_PolymerUtils.getElementById(this._prefix + "SampleBrowserGrid")).bootstrapTable("destroy");
      this.numTotalResults = 0;
    }

    this.requestUpdate();
  }

  _onSelectSample(row) {
    if (typeof row !== "undefined") {
      this.dispatchEvent(new CustomEvent("selectsample", {
        detail: {
          id: row.id,
          sample: row
        }
      }));
    }
  }

  onColumnChange(e) {
    const table = $("#" + this._prefix + "SampleBrowserGrid");

    if (e.detail.selected) {
      table.bootstrapTable("showColumn", e.detail.id);
    } else {
      table.bootstrapTable("hideColumn", e.detail.id);
    }
  } // stateFormatter(value, row, index) {
  //     if (typeof this.field.context.samples !== "undefined") {
  //         for (let idx in this.field.context.samples) {
  //             if (this.field.context.samples[idx].name === row.name) {
  //                 break;
  //             }
  //         }
  //     }
  // }


  individualFormatter(value, row) {
    //TODO fix
    let a = "-";

    if (utilsNew_UtilsNew.isNotUndefined(row.attributes) && utilsNew_UtilsNew.isNotUndefined(row.attributes.OPENCGA_INDIVIDUAL)) {
      a = row.attributes.OPENCGA_INDIVIDUAL.id || "-";
    }

    return a;
  }

  dateFormatter(value, row) {
    return moment(value, "YYYYMMDDHHmmss").format("D MMM YYYY");
  }

  cellTypeFormatter(value, row) {
    return row.somatic ? "Somatic" : "Germline";
  }

  _initTableColumns() {
    const columns = [];

    if (this._config.multiSelection) {
      columns.push({
        field: {
          source: "state",
          context: this
        },
        checkbox: true,
        // formatter: this.stateFormatter,
        eligible: false
      });
    }

    this._columns = [columns.concat([{
      title: "Sample ID",
      field: "id"
    }, {
      title: "Individual ID",
      formatter: this.individualFormatter
    }, {
      title: "Source",
      field: "source"
    }, {
      title: "Collection Method",
      field: "collection.method"
    }, {
      title: "Preparation Method",
      field: "processing.preparationMethod"
    }, // {
    //     title: 'Sex',
    //     field: 'attributes.individual.sex'
    // },
    // {
    //     title: 'Diagnosis',
    //     formatter: this.diagnosisFormatter
    // },
    // {
    //     title: 'HPO',
    //     formatter: this.hpoFormatter
    // },
    // {
    //     title: 'Father',
    //     field: 'attributes.individual.father.id',
    //     formatter: this.fatherFormatter
    // },
    // {
    //     title: 'Mother',
    //     field: 'attributes.individual.mother.id',
    //     formatter: this.motherFormatter
    // },
    {
      title: "Cell Line",
      formatter: this.cellTypeFormatter
    }, {
      title: "Creation Date",
      field: "creationDate",
      formatter: this.dateFormatter
    }, {
      title: "Status",
      field: "status.name"
    }])];
    return this._columns;
  }

  _getUrlQueryParams() {// TODO
  }

  onDownload(e) {
    // let urlQueryParams = this._getUrlQueryParams();
    // let params = urlQueryParams.queryParams;
    //console.log(this.opencgaSession);
    const params = opencga_sample_grid_objectSpread({}, this.query, {
      sid: this.opencgaSession.opencgaClient._config.sessionId,
      limit: 1000,
      skip: 0,
      includeIndividual: true,
      skipCount: true,
      include: "id,source,collection,processing,creationDate,status,type,version,release,individual.id"
    });

    this.opencgaSession.opencgaClient.samples().search(params).then(response => {
      const result = response.response[0].result;
      console.log(result);
      let dataString = [];
      let mimeType = "";
      let extension = "";

      if (result) {
        // Check if user clicked in Tab or JSON format
        if (e.detail.option.toLowerCase() === "tab") {
          dataString = [["Sample ID", "Individual ID", "Source", "Collection Method", "Preparation Method", "Cell Line", "Creation Date", "Status"].join("\t"), ...result.map(_ => [_.id, _.attributes && _.attributes.OPENCGA_INDIVIDUAL ? _.attributes.OPENCGA_INDIVIDUAL.id : "", _.source, _.collection && _.collection.method ? _.collection.method : "", _.processing && _.processing.preparationMethod ? _.processing.preparationMethod : "", _.somatic ? "Somatic" : "Germline", _.creationDate, _.status.name].join("\t"))]; //console.log(dataString);

          mimeType = "text/plain";
          extension = ".txt";
        } else {
          for (const res of result) {
            dataString.push(JSON.stringify(res, null, "\t"));
          }

          mimeType = "application/json";
          extension = ".json";
        } // Build file and anchor link


        const data = new Blob([dataString.join("\n")], {
          type: mimeType
        });
        const file = window.URL.createObjectURL(data);
        const a = document.createElement("a");
        a.href = file;
        a.download = this.opencgaSession.study.alias + extension;
        document.body.appendChild(a);
        a.click();
        setTimeout(function () {
          document.body.removeChild(a);
        }, 0);
      } else {
        console.error("Error in result format");
      }
    }).then(function () {//this.downloadRefreshIcon.css("display", "none");
      //this.downloadIcon.css("display", "inline-block");
    });
  }

  getDefaultConfig() {
    return {
      pagination: true,
      pageSize: 10,
      pageList: [10, 25, 50],
      showExport: false,
      detailView: false,
      detailFormatter: undefined,
      // function with the detail formatter
      multiSelection: false
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_sample_grid_templateObject(), this.from, this.to, this.numTotalResultsText, this.toolbarConfig, this.onColumnChange, this.onDownload, this._prefix, this._prefix);
  }

}
customElements.define("opencga-sample-grid", opencga_sample_grid_OpencgaSampleGrid);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/samples/opencga-sample-browser.js
function opencga_sample_browser_templateObject2() {
  const data = opencga_sample_browser_taggedTemplateLiteral(["\n            <div class=\"page-title\">\n                <h2>\n                    <i class=\"fa fa-users\" aria-hidden=\"true\"></i> </i>&nbsp;", "\n                </h2>\n            </div>\n        "]);

  opencga_sample_browser_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_sample_browser_templateObject() {
  const data = opencga_sample_browser_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .icon-padding {\n                padding-left: 4px;\n                padding-right: 5px;\n            }\n\n            .detail-tab-title {\n                font-size: 115%;\n                font-weight: bold;\n            }\n        </style>\n\n        ", "\n        \n        <div class=\"row\" style=\"padding: 0px 10px\">\n            <div class=\"col-md-2\">\n                <opencga-sample-filter .opencgaSession=\"", "\"\n                                       .config=\"", "\"\n                                       .samples=\"", "\"\n                                       .opencgaClient=\"", "\"\n                                       .query=\"", "\"\n                                        @queryChange=\"", "\"\n                                        @querySearch=\"", "\">\n                </opencga-sample-filter>\n            </div>\n\n            <div class=\"col-md-10\">\n                <opencga-active-filters .opencgaSession=\"", "\"\n                                        .query=\"", "\"\n                                        .refresh=\"", "\"\n                                        .defaultStudy=\"", "\"\n                                        .config=\"", "\"\n                                        .alias=\"", "\"\n                                        @activeFilterClear=\"", "\"\n                                        @activeFilterChange=\"", "\">\n                </opencga-active-filters>\n\n                <!-- Sample View Buttons -->\n                <div class=\"col-md-12\" style=\"padding: 5px 0px 5px 0px\">\n                    <div class=\"btn-toolbar\" role=\"toolbar\" aria-label=\"...\" style=\"padding: 10px 0px;margin-left: 0px\">\n                        <div class=\"btn-group\" role=\"group\" style=\"margin-left: 0px\">\n                            <button type=\"button\" class=\"btn btn-success sample-browser-view-buttons active ripple\" data-view=\"TableResult\" @click=\"", "\"  data-id=\"table\">\n                                <i class=\"fa fa-table icon-padding\" aria-hidden=\"true\" data-view=\"TableResult\" @click=\"", "\"></i> Table Result\n                            </button>\n                            <button type=\"button\" class=\"btn btn-success sample-browser-view-buttons ripple\" data-view=\"Summary\" @click=\"", "\">\n                                <i class=\"fas fa-chart-bar icon-padding\" aria-hidden=\"true\" data-view=\"Summary\" @click=\"", "\"></i> Summary Stats\n                            </button>\n                            <button type=\"button\" class=\"btn btn-success sample-browser-view-buttons ripple\" data-view=\"SampleComparator\" @click=\"", "\"  data-id=\"comparator\">\n                                <i class=\"fa fa-users icon-padding\" aria-hidden=\"true\" data-view=\"SampleComparator\" @click=\"", "\"></i> Sample Comparator\n                            </button>\n                        </div>\n                    </div>\n                </div>\n\n\n                <!-- Sample View Content -->\n                <div>\n                    <div id=\"", "TableResult\" class=\"sample-browser-view-content\">\n                        <opencga-sample-grid .opencgaSession=\"", "\"\n                                             .query=\"", "\"\n                                             .search=\"", "\"\n                                             .config=\"", "\"\n                                             .samples=\"", "\"\n                                             .active=\"", "\"\n                                             style=\"font-size: 12px\"\n                                             @selectsample=\"", "\">\n                        </opencga-sample-grid>\n\n                        <!--<div style=\"padding-top: 5px\">-->\n                            <!--<ul id=\"", "ViewTabs\" class=\"nav nav-tabs\" role=\"tablist\">-->\n                                <!--<li role=\"presentation\" class=\"active\">-->\n                                    <!--<a href=\"#", "SampleViewer\" role=\"tab\" data-toggle=\"tab\" class=\"detail-tab-title\">-->\n                                        <!--Sample Info-->\n                                    <!--</a>-->\n                                <!--</li>-->\n                            <!--</ul>-->\n\n                            <!--<div class=\"tab-content\" style=\"height: 680px\">-->\n                                <!--<div role=\"tabpanel\" class=\"tab-pane active\" id=\"", "SampleViewer\">-->\n                                    <!--<opencga-sample-view opencga-client=\"{{opencgaSession.opencgaClient}}\"-->\n                                                         <!--opencga-session=\"{{opencgaSession}}\" sample-id=\"{{sample.id}}\" config=\"{{_config.sampleDetail}}\"-->\n                                                         <!--style=\"font-size: 12px;\">-->\n                                        <!--&lt;!&ndash;opencga-client=\"{{opencgaSession.opencgaClient}}\" &ndash;&gt;-->\n                                        <!--&lt;!&ndash;opencga-session=\"{{opencgaSession}}\" config=\"[[_config]]\"&ndash;&gt;-->\n                                    <!--</opencga-sample-view>-->\n                                <!--</div>-->\n\n                            <!--</div>-->\n                        <!--</div>-->\n                    </div>\n\n                    <!--TODO refactor is missing here -->\n                    <div id=\"", "Summary\" class=\"sample-browser-view-content\" style=\"display: none\">\n                         <opencb-facet-query resource=\"samples\"\n                                            .opencgaSession=\"", "\"\n                                            .cellbaseClient=\"", "\"  \n                                            .config=\"", "\"\n                                            .query=\"", "\"\n                                            .active=\"", "\">\n                        </opencb-facet-query>\n                    </div>\n\n                    <div id=\"", "SampleComparator\" class=\"sample-browser-view-content\" style=\"display: none\">\n                        <opencga-sample-grid .opencgaSession=\"", "\"\n                                             .config=\"", "\"\n                                             .samples=\"", "\"\n                                             .search=\"", "\" style=\"font-size: 12px\"\n                                             ?active=\"", "\">\n                        </opencga-sample-grid>\n\n                        <div style=\"padding-top: 5px\">\n                            <h3>Annotation comparator</h3>\n                            <opencga-annotation-viewer .opencgaClient=\"", "\"\n                                                       .opencgaSession=\"", "\"\n                                                       .config=\"", "\"\n                                                       .entryIds=\"", "\" entity=\"SAMPLE\">\n                            </opencga-annotation-viewer>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        "]);

  opencga_sample_browser_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_sample_browser_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_sample_browser_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_sample_browser_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_sample_browser_ownKeys(Object(source), true).forEach(function (key) { opencga_sample_browser_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_sample_browser_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_sample_browser_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
//TODO check functionality









class opencga_sample_browser_OpencgaSampleBrowser extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      config: {
        type: Object
      },
      filters: {
        type: Object,
        notify: true //TODO recheck notify

      },
      //TODO remove
      search: {
        type: Object,
        notify: true
      },
      query: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "osb-" + utils.randomString(6);
    this.samples = [];
    this._config = this.getDefaultConfig();
    this.filtersConfig = {
      complexFields: ["annotation"]
    };
    this.query = {};
  }

  firstUpdated(_changedProperties) {}

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession")) {
      this.filterAvailableVariableSets();
    }

    if (changedProperties.has("config")) {
      this.filterAvailableVariableSets();
      this.configObserver();
    }

    if (changedProperties.has("opencgaClient")) {//this.renderAnalysisTable();
    }

    if (changedProperties.has("filters")) {
      this.onFilterUpdate();
    }

    if (changedProperties.has("query")) {
      this.queryObserver();
    }
  } //TODO recheck functionality


  connectedCallback() {
    super.connectedCallback();
    this.activeMenu = {
      table: true,
      comparator: false
    };
  }

  configObserver() {
    this._config = opencga_sample_browser_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  } //TODO recheck if sample-browser needs study param in query


  queryObserver() {
    // Query passed is executed and set to variant-filter, active-filters and variant-grid components
    let _query = {};

    if (utilsNew_UtilsNew.isEmpty(this.query) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.study)) {
      _query = {
        study: this.opencgaSession.study.fqn
      };
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query)) {
      this.preparedQuery = opencga_sample_browser_objectSpread({}, _query, {}, this.query);
      this.executedQuery = opencga_sample_browser_objectSpread({}, _query, {}, this.query);
    } // onServerFilterChange() in opencga-active-filters drops a filterchange event when the Filter dropdown is used


    this.requestUpdate();
  }

  sampleObserver() {
    this.dispatchEvent(new CustomEvent("samplechange", {
      detail: {
        samples: this.samples
      },
      bubbles: true,
      composed: true
    }));
  }

  onSelectSample(e) {
    this.sample = e.detail.sample;
  }

  _changeView(e) {
    e.preventDefault(); // prevents the hash change to "#" and allows to manipulate the hash fragment as needed

    let activeMenu = {
      table: e.currentTarget.dataset.id === "table",
      comparator: e.currentTarget.dataset.id === "comparator"
    };
    this.activeMenu = activeMenu;
    $('.sample-browser-view-content').hide(); // hides all content divs

    if (typeof e.target !== "undefined" && typeof e.target.dataset.view !== "undefined") {
      PolymerUtils_PolymerUtils.show(this._prefix + e.target.dataset.view);
    } // Show the active button


    $('.sample-browser-view-buttons').removeClass("active");
    $(e.target).addClass("active");

    if (e.target.dataset.view === "Summary") {
      this.SummaryActive = true;
      this.requestUpdate();
    } else {
      this.SummaryActive = false;
    }

    this.requestUpdate();
  }

  filterAvailableVariableSets() {
    if (this._config.variableSetIds.length === 0 && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.study)) {
      this.variableSets = this.opencgaSession.study.variableSets;
    } else {
      let variableSets = [];

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.study) && utilsNew_UtilsNew.isNotEmptyArray(this.opencgaSession.study.variableSets)) {
        for (let i = 0; i < this.opencgaSession.study.variableSets.length; i++) {
          if (this._config.variableSetIds.indexOf(this.opencgaSession.study.variableSets[i].id) !== -1) {
            variableSets.push(this.opencgaSession.study.variableSets[i]);
          }
        }
      }

      this.variableSets = variableSets;
    }
  }

  executeFacet() {}

  onQueryFilterChange(e) {
    console.log("onQueryFilterChange on sample browser", e.detail.query);
    this.preparedQuery = e.detail.query;
    this.requestUpdate();
  }

  onQueryFilterSearch(e) {
    this.preparedQuery = e.detail.query;
    this.executedQuery = e.detail.query;
    this.requestUpdate();
  } //TODO recheck what's/if there is a default param in sample-browser. study key comes from variant-browser.


  onActiveFilterChange(e) {
    console.log("onActiveFilterChange on sample browser", e.detail); //TODO FIXME!! study prop have to be wiped off! use studies instead

    this.preparedQuery = opencga_sample_browser_objectSpread({
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias
    }, e.detail);
    this.query = opencga_sample_browser_objectSpread({
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias
    }, e.detail);
    this.requestUpdate();
  }

  onActiveFilterClear() {
    this._config = Object.assign(this.getDefaultConfig(), this.config);
    this.query = {}; // this.query = {studies: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias};
    //this.search = {};

    this.preparedQuery = {};
    this.requestUpdate();
  }

  getDefaultConfig() {
    return {
      title: "Sample Browser",
      showTitle: true,
      showAggregationStats: true,
      showComparator: true,
      filter: {},
      grid: {
        pageSize: 10,
        pageList: [10, 25, 50],
        multiSelection: false
      },
      gridComparator: {
        pageSize: 5,
        pageList: [5, 10],
        multiSelection: true
      },
      sampleDetail: {
        showTitle: false
      },
      variableSetIds: [],
      summary: {
        fields: ["name"]
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_sample_browser_templateObject(), this._config.showTitle ? lit_html_lit_html_html(opencga_sample_browser_templateObject2(), this._config.title) : null, this.opencgaSession, this._config.filter, this.samples, this.opencgaSession.opencgaClient, this.query, this.onQueryFilterChange, this.onQueryFilterSearch, this.opencgaSession, this.preparedQuery, this.executedQuery, this.opencgaSession.study.alias, this.filtersConfig, this.activeFilterAlias, this.onActiveFilterClear, this.onActiveFilterChange, this._changeView, this._changeView, this._changeView, this._changeView, this._changeView, this._changeView, this._prefix, this.opencgaSession, this.executedQuery, this.executedQuery, this._config.grid, this.samples, this.activeMenu.table, this.onSelectSample, this._prefix, this._prefix, this._prefix, this._prefix, this.opencgaSession, this.cellbaseClient, this._config, this.executedQuery, this.SummaryActive, this._prefix, this.opencgaSession, this._config.gridComparator, this.samples, this.search, this.activeMenu.comparator, this.opencgaSession.opencgaClient, this.opencgaSession, this._config, this.samples);
  }

}
customElements.define('opencga-sample-browser', opencga_sample_browser_OpencgaSampleBrowser);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/opencga-genome-browser.js
function opencga_genome_browser_templateObject6() {
  const data = opencga_genome_browser_taggedTemplateLiteral(["\n                                        <input type=\"checkbox\" style=\"margin-left: 15px;\" name=\"", "file-checkbox\" value=\"", "\" data=\"", "\">\n                                        <span style=\"word-wrap:break-word;\">", "</span><br>\n                                    "]);

  opencga_genome_browser_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_genome_browser_templateObject5() {
  const data = opencga_genome_browser_taggedTemplateLiteral(["\n                                    <div>\n                                        <div style=\"font-weight: bold; text-decoration: underline; display: inline-block;padding: 5px 10px\">\n                                            <span>", "</span>\n                                        </div>\n                                        <button type=\"button\" id=\"", "deleteSampleButton\" class=\"btn btn-xs btn-danger\"\n                                                @click=\"", "\" data-sample=\"", "\">\n                                            <i class=\"fa fa-times\" aria-hidden=\"true\"> Delete</i>\n                                        </button>\n                                    </div>\n                                    ", " \n                                    <br>\n                                "]);

  opencga_genome_browser_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_genome_browser_templateObject4() {
  const data = opencga_genome_browser_taggedTemplateLiteral(["\n                            <i class=\"fa fa-caret-down\" aria-hidden=\"true\"></i>\n                        "]);

  opencga_genome_browser_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_genome_browser_templateObject3() {
  const data = opencga_genome_browser_taggedTemplateLiteral(["\n                            <i class=\"fa fa-caret-right\" aria-hidden=\"true\"></i>\n                        "]);

  opencga_genome_browser_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_genome_browser_templateObject2() {
  const data = opencga_genome_browser_taggedTemplateLiteral(["\n            <div class=\"page-title\">\n                <h2>\n                    <i class=\"fa fa-list\" aria-hidden=\"true\"></i> </i>&nbsp;", "\n                </h2>\n            </div>\n        "]);

  opencga_genome_browser_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_genome_browser_templateObject() {
  const data = opencga_genome_browser_taggedTemplateLiteral(["\n        <style include=\"jso-styles\"></style>\n\n        ", "\n\n        <div style=\"margin: 20px\">\n            <div class=\"col-md-12\">\n                <div style=\"display: block; cursor:pointer;\" @click=\"", "\"\n                     data-toggle=\"collapse\" href=\"#", "collapsibleFilter\">\n                    <h4>\n                        ", "\n                        Select Samples and Files\n                    </h4>\n                    <hr style=\"width: 80%; margin: 2px 0px;border-top: 2px solid #eee\">\n                </div>\n\n                <div class=\"collapse in\" id=\"", "collapsibleFilter\">\n                    <div class=\"col-md-12\" style=\"padding: 10px\">\n                        <div class=\"col-md-2\">\n                            Search samples by ID:\n                        </div>\n                        <div class=\"col-md-2\">\n                            <input id=\"", "AutocompleteSearchInput\" type=\"text\" class=\"form-control form-control-sm\" placeholder=\"HG01879...\"\n                                   list=\"", "AutocompleteSearchDataList\" @keyup=\"", "\">\n                            <datalist id=\"", "AutocompleteSearchDataList\"></datalist>\n                        </div>\n                        <div class=\"col-md-2\">\n                            <button type=\"button\" id=\"", "addSampleButton\" class=\"btn btn-sm btn-primary\" @click=\"", "\">\n                                +\n                            </button>\n                        </div>\n                    </div>\n\n                    <div class=\"col-md-12\" style=\"padding: 0px 10px\">\n                        <div class=\"col-md-2\">\n                            or browse samples:\n                        </div>\n                        <div class=\"col-md-2\">\n                            <button type=\"button\" class=\"btn btn-primary btn-sm\"\n                                    @click=\"", "\" data-toggle=\"modal\">\n                                Sample Browser...\n                            </button>\n                        </div>\n                    </div>\n\n                    <div class=\"col-md-12\" style=\"padding: 25px 10px 10px 10px\">\n                        <div class=\"col-md-12\">\n                            <span>Samples selected:</span>\n                        </div>\n                        <!--List of available files to browse -->\n                        <div class=\"col-md-12\">\n                            <div style=\"padding: 5px;max-height: 300px; overflow-y: auto\">\n                                ", "\n                            </div>\n                        </div>\n                    </div>\n\n                </div>\n\n            </div>\n\n            <div class=\"col-md-6\" style=\"margin-top: 15px;\">\n                <button id=\"", "RunGenomeBrowser\" type=\"button\" class=\"btn btn-primary\"\n                        @click=\"", "\" style=\"float: right\">\n                    Show Genome Browser\n                </button>\n            </div>\n\n            <!-- Genome browser -->\n            <div class=\"col-md-12\">\n                <h4>Genome Browser</h4>\n                <hr style=\"width: 80%; margin: 2px 0px;border-top: 2px solid #eee\">\n\n                <div style=\"padding: 20px 0px;display: ", ";\">\n                    <div style=\"padding: 20px\">\n                        <span style=\"font-weight: bolder\">Please select some data above</span>\n                    </div>\n                </div>\n\n                <div style=\"padding: 20px 5px\">\n                    <genome-browser id=\"", "gb\" .opencgaSession=", " .cellbaseClient=\"", "\"\n                                    .opencgaClient=\"", "\" .region=\"", "\" .tracks=\"", "\">\n                    </genome-browser>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"modal fade\" id=\"", "SampleBrowser\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"sampleBrowserLabel\">\n            <div class=\"modal-dialog modal-lg\" role=\"document\" style=\"width: 80%;\">\n                <div class=\"modal-content\">\n                    <div class=\"modal-header\">\n                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n                        <h4 class=\"modal-title\" id=\"", "SampleBrowserLabel\">Sample Browser</h4>\n                    </div>\n                    <div class=\"modal-body\" style=\"height: 780px\">\n                        <opencga-sample-browser .opencgaClient=\"", "\" .opencgaSession=\"", "\" .config=\"", "\"></opencga-sample-browser>\n                    </div>\n                    <div class=\"modal-footer\">\n                        <button type=\"button\" class=\"btn btn-primary\" data-dismiss=\"modal\" @click=\"", "\">\n                            OK\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        "]);

  opencga_genome_browser_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_genome_browser_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */







class opencga_genome_browser_OpencgaGenomeBrowser extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      samples: {
        type: Array
      },
      region: {
        type: String
      },
      active: {
        type: Boolean
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "OpencgaGenomeBrowser" + utils.randomString(6) + "_";
    this._availableFiles = [];

    if (!utilsNew_UtilsNew.isNotUndefinedOrNull(this.region)) {
      this.region = new region_Region({
        chromosome: "11",
        start: 68177378,
        end: 68177510
      });
    }

    this.tracks = {
      sequence: {
        type: "sequence"
      },
      gene: {
        type: "gene"
      },
      variant: {
        type: "variant",
        config: {}
      },
      alignment: {
        type: "alignment",
        config: {}
      }
    };
    this._config = this.getDefaultConfig();
    this._filtersCollapsed = false;
    this.displayGenomeBrowserMessage = "inline";
    this.active = false;
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession")) {
      this.onStudyUpdate();
    }

    if (changedProperties.has("samples")) {
      this.samplesObserver();
    }

    if (changedProperties.has("region")) {
      this.regionObserver();
    }

    if (changedProperties.has("active")) {//this._setActive();
    }

    if (changedProperties.has("config")) {
      this.configObserver();
    }
  }

  configObserver() {
    this._config = Object.assign(this.getDefaultConfig(), this.config);
  }

  toggleCollapsedFilter() {
    this._filtersCollapsed = !this._filtersCollapsed;
    this.requestUpdate();
  }

  regionObserver() {
    this.genomeBrowserRegion = new region_Region(this.region);
  }

  onStudyUpdate() {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.study)) {
      this._availableFiles = []; // this.showSelectionInGenomeBrowser();
    }
  }

  showSampleBrowser(e) {
    e.preventDefault();
    this.sampleBrowserModal = utilsNew_UtilsNew.isUndefined(this.sampleBrowserModal) ? true : !this.sampleBrowserModal;
    $("#" + this._prefix + "SampleBrowser").modal("show");
  }

  samplesObserver() {
    for (const sample of this.samples) {
      this._addSample(sample.name);
    }
  }

  addSample(e) {
    const sample = PolymerUtils_PolymerUtils.getElementById(this._prefix + "AutocompleteSearchInput").value;

    this._addSample(sample);
  }

  _addSample(sample) {
    for (const i in this._availableFiles) {
      const existingSample = this._availableFiles[i].name;

      if (existingSample === sample) {
        // The sample is already in the shown list
        return;
      }
    }

    const queryParams = {
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias,
      sample: sample,
      format: "VCF,BAM",
      include: "path,name,format,bioformat"
    };

    const _this = this;

    this.opencgaClient.files().search(queryParams).then(values => {
      if (values.response[0].result !== undefined && values.response[0].result.length > 0) {
        _this.push("_availableFiles", {
          name: sample,
          files: values.response[0].result
        });
      }
    }).catch(function (response) {
      //_this.showErrorAlert(response.error);
      console.log("Error: ", response.error);
    });
  }

  deleteSample(e) {
    const sample = e.currentTarget.dataSample; // We make a copy of the list of available files excluding the selected sample

    const availableFiles = [];

    for (const i in this._availableFiles) {
      const item = this._availableFiles[i];

      if (item.name !== sample) {
        availableFiles.push(item);
      }
    }

    this._availableFiles = availableFiles;
  }

  _autocompleteSampleSearch(e) {
    // Only gene symbols are going to be searched and not Ensembl IDs
    const sampleNamePrefix = PolymerUtils_PolymerUtils.getElementById(this._prefix + "AutocompleteSearchInput").value;

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(sampleNamePrefix) && sampleNamePrefix.length >= 4) {
      const _this = this;

      this.opencgaClient.samples().search({
        study: _this.opencgaSession.project.alias + ":" + _this.opencgaSession.study.alias,
        name: "~^" + sampleNamePrefix,
        include: "id,name",
        includeIndividual: false,
        limit: 20
      }).then(function (response) {
        //                            _this.autocompleteSampleData = response.response[0].result;
        let options = "";

        for (const sample of response.response[0].result) {
          const sampleStr = JSON.stringify(sample);
          options += "<option id=\"".concat(_this._prefix, "Sample").concat(sample.name, "\" value=\"").concat(sample.name, "\" data-sample='") + sampleStr + "'>";
        }

        PolymerUtils_PolymerUtils.innerHTML(_this._prefix + "AutocompleteSearchDataList", options);
      });
    }
  }

  showSelectionInGenomeBrowser() {
    const genomeBrowser = PolymerUtils_PolymerUtils.getElementById(this._prefix + "gb");

    if (genomeBrowser !== undefined && genomeBrowser !== null) {
      const inputArray = document.querySelectorAll("input[name=" + this._prefix + "file-checkbox]:checked");
      const myVariantFiles = [];
      const myAlignmentFiles = [];
      inputArray.forEach(function (input) {
        const file = input.data;

        if (file.format === "VCF") {
          myVariantFiles.push(file);
        } else if (file.format === "BAM") {
          myAlignmentFiles.push(file);
        }
      }); // In order to notify of the changes to the genome browser, we make a copy of the tracks object

      const _tracks = this.tracks;
      _tracks.variant.config.files = myVariantFiles;
      _tracks.alignment.config.files = myAlignmentFiles;
      this.tracks = Object.assign({}, _tracks); // Activate genome browser
      // if (myVariantFiles.length > 0 || myAlignmentFiles.length > 0) {
      // Hide Genome Browser initial message

      this.displayGenomeBrowserMessage = "none";
      genomeBrowser.active = true; // }
    }
  }

  getDefaultConfig() {
    return {
      title: "Genome Browser",
      showTitle: true
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_genome_browser_templateObject(), this._config.showTitle ? lit_html_lit_html_html(opencga_genome_browser_templateObject2(), this._config.title) : null, this.toggleCollapsedFilter, this._prefix, this._filtersCollapsed ? lit_html_lit_html_html(opencga_genome_browser_templateObject3()) : lit_html_lit_html_html(opencga_genome_browser_templateObject4()), this._prefix, this._prefix, this._prefix, this._autocompleteSampleSearch, this._prefix, this._prefix, this.addSample, this.showSampleBrowser, this._availableFiles && this._availableFiles.length ? this._availableFiles.map(sample => lit_html_lit_html_html(opencga_genome_browser_templateObject5(), sample.name, this._prefix, this.deleteSample, sample.name, sample.file && sample.file.length && sample.file.map(file => lit_html_lit_html_html(opencga_genome_browser_templateObject6(), this._prefix, file.name, file, file.name)))) : null, this._prefix, this.showSelectionInGenomeBrowser, this.displayGenomeBrowserMessage, this._prefix, this.opencgaSession, this.cellbaseClient, this.opencgaClient, this.genomeBrowserRegion, this.tracks, this._prefix, this._prefix, this.opencgaClient, this.opencgaSession, this.sampleBrowserConfig, this.onAnalysisSelected);
  }

}
customElements.define("opencga-genome-browser", opencga_genome_browser_OpencgaGenomeBrowser);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/VariantGridFormatter.js
/*
 * Copyright 2015-2016 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

 //TODO urgent review of the whole class

class VariantGridFormatter_VariantGridFormatter {
  constructor(opencgaSession, config) {
    this.opencgaSession = opencgaSession;
    this.config = config;
    this.prefix = "VarBrowserGrid-" + utils.randomString(6);
  }

  assignColors(consequenceTypes, proteinSubstitutionScores) {
    let result = {};

    if (typeof consequenceTypes !== "undefined") {
      let consequenceTypeToColor = {};
      let consequenceTypeToImpact = {};

      for (let i = 0; i < consequenceTypes.categories.length; i++) {
        if (typeof consequenceTypes.categories[i].terms !== "undefined") {
          for (let j = 0; j < consequenceTypes.categories[i].terms.length; j++) {
            consequenceTypeToColor[consequenceTypes.categories[i].terms[j].name] = consequenceTypes.color[consequenceTypes.categories[i].terms[j].impact];
            consequenceTypeToImpact[consequenceTypes.categories[i].terms[j].name] = consequenceTypes.categories[i].terms[j].impact;
          }
        } else if (typeof consequenceTypes.categories[i].id !== "undefined" && typeof consequenceTypes.categories[i].name !== "undefined") {
          consequenceTypeToColor[consequenceTypes.categories[i].name] = consequenceTypes.color[consequenceTypes.categories[i].impact];
          consequenceTypeToImpact[consequenceTypes.categories[i].name] = consequenceTypes.categories[i].impact;
        }
      } // this.consequenceTypeToColor = consequenceTypeToColor;
      // this.consequenceTypeToImpact = consequenceTypeToImpact;


      result = {
        consequenceTypeToColor: consequenceTypeToColor,
        consequenceTypeToImpact: consequenceTypeToImpact
      };
    }

    if (typeof proteinSubstitutionScores !== "undefined") {
      let pssColor = new Map();

      for (let i in proteinSubstitutionScores) {
        let obj = proteinSubstitutionScores[i];
        Object.keys(obj).forEach(key => {
          pssColor.set(key, obj[key]);
        });
      } // this.pssColor = pssColor;


      result.pssColor = pssColor;
    }

    return result;
  }

  variantFormatter(value, row, config) {
    if (row === undefined) {
      return;
    } // If REF/ALT is greater than maxAlleleLength we display the first and last 5 bp


    let ref = utilsNew_UtilsNew.isNotEmpty(row.reference) ? row.reference : "-";
    let alt = utilsNew_UtilsNew.isNotEmpty(row.alternate) ? row.alternate : "-";
    let maxAlleleLength = 15;

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(config) && utilsNew_UtilsNew.isNotUndefinedOrNull(config.alleleStringLengthMax)) {
      maxAlleleLength = config.alleleStringLengthMax;
    }

    ref = ref.length > maxAlleleLength ? ref.substring(0, 5) + "..." + ref.substring(ref.length - 5) : ref;
    alt = alt.length > maxAlleleLength ? alt.substring(0, 5) + "..." + alt.substring(alt.length - 5) : alt;
    let id = row.id;

    if (utilsNew_UtilsNew.isEmpty(id)) {
      console.warn("row.id is empty: " + row);
      id = "".concat(row.chromosome, ":").concat(row.start, ":").concat(ref, ":").concat(alt);
    }

    if (typeof row.annotation !== "undefined" && utilsNew_UtilsNew.isNotEmptyArray(row.annotation.xrefs)) {
      row.annotation.xrefs.find(function (element) {
        if (element.source === "dbSNP") {
          id = element.id;
        }
      });
    }

    let genomeBrowserMenuLink = "";

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(config) && config.showGenomeBrowser) {
      genomeBrowserMenuLink = "<div>\n                                        <a class=\"genome-browser-option\" data-variant-position=\"".concat(row.chromosome, ":").concat(row.start, "-").concat(row.end, "\" style=\"cursor: pointer\">\n                                            <i class=\"fa fa-list\" aria-hidden=\"true\"></i> Genome Browser\n                                        </a>\n                                     </div>");
    }

    let ensemblLinkHtml = id.startsWith("rs") ? "https://www.ensembl.org/Homo_sapiens/Variation/Explore?vdb=variation;v=" + id : "http://www.ensembl.org/Homo_sapiens/Location/View?r=" + row.chromosome + ":" + row.start + "-" + row.end;
    let snpLinkHtml = "";

    if (id.startsWith("rs")) {
      snpLinkHtml = "<div style=\"padding: 5px\"><a target=\"_blank\" href=\"https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?searchType=adhoc_search&type=rs&rs=".concat(id, "\">dbSNP</a></div>\n                           <div style=\"padding: 5px\"><a target=\"_blank\" href=\"https://www.snpedia.com/index.php/").concat(id, "\">SNPedia</a></div>\n                           <div style=\"padding: 5px\"><a target=\"_blank\" href=\"https://www.ncbi.nlm.nih.gov/clinvar/?term=").concat(id, "\">ClinVar</a></div>\n                ");
    } // <div style="padding: 5px 15px; color: darkgray; font-weight: bolder">External Links</div>


    let tooltipText = "".concat(genomeBrowserMenuLink, "\n                            <div style=\"padding: 5px\">\n                                <a target=\"_blank\" href=\"").concat(ensemblLinkHtml, "\">Ensembl</a>\n                            </div>\n                            ").concat(snpLinkHtml, "\n                ");
    return "<div class=\"variant-tooltip\" data-tooltip-text='".concat(tooltipText, "'>\n                    <a style=\"cursor: pointer\">\n                        ").concat(row.chromosome, ":").concat(row.start, "&nbsp;&nbsp;").concat(ref, "/").concat(alt, "\n                    </a>\n                </div>");
  }

  snpFormatter(value, row, index) {
    /*
        We try first to read SNP ID from the identifier of the variant (this identifier comes from the file).
        If this ID is not a "rs..." (it is a variant with the format: "13:20277279:-:T") then we search
        the rs in the CellBase XRef annotations. This field is in annotation.xref when source: "dbSNP".
    */
    if (typeof row.id !== "undefined" && row.id.startsWith("rs")) {
      if (this.opencgaSession.project.organism !== undefined && this.opencgaSession.project.organism.assembly === "GRCh37") {
        return "<a target='_blank' href='http://grch37.ensembl.org/Homo_sapiens/Variation/Explore?vdb=variation;v=" + row.id + "'>" + row.id + "</a>";
      } else {
        return "<a target='_blank' href='http://www.ensembl.org/Homo_sapiens/Variation/Explore?vdb=variation;v=" + row.id + "'>" + row.id + "</a>";
      }
    } else if (typeof row.annotation !== "undefined" && typeof row.annotation.xrefs !== "undefined" && row.annotation.xrefs.length > 0) {
      let annotation = row.annotation.xrefs.find(function (element) {
        return element.source === "dbSNP";
      });

      if (typeof annotation !== "undefined") {
        return "<a target='_blank' href='http://grch37.ensembl.org/Homo_sapiens/Variation/Explore?vdb=variation;v=" + annotation.id + "'>" + annotation.id + "</a>";
      }
    }

    return "-";
  }

  geneFormatter(value, row, index) {
    if (typeof row !== "undefined" && row.annotation !== undefined && utilsNew_UtilsNew.isNotEmptyArray(row.annotation.consequenceTypes)) {
      let visited = {};
      let geneLinks = [];

      for (let i = 0; i < row.annotation.consequenceTypes.length; i++) {
        let geneName = row.annotation.consequenceTypes[i].geneName;

        if (utilsNew_UtilsNew.isNotEmpty(geneName) && typeof visited[geneName] === "undefined") {
          if (typeof this.opencgaSession.project !== "undefined" && typeof this.opencgaSession.study !== "undefined") {
            let genomeBrowserMenuLink = "";

            if (this.config.showGenomeBrowser) {
              genomeBrowserMenuLink = "<div>\n                                                        <a class=\"genome-browser-option\" data-variant-position=\"".concat(row.chromosome, ":").concat(row.start, "-").concat(row.end, "\" style=\"cursor: pointer\">\n                                                            Genome Browser\n                                                        </a>\n                                                     </div>");
            }

            let tooltipText = "<div style=\"padding: 5px\"><a style=\"cursor: pointer\" href=\"#gene/".concat(this.opencgaSession.project.alias, "/").concat(this.opencgaSession.study.alias, "/").concat(geneName, "\">Gene View</a></div>\n                                            ").concat(genomeBrowserMenuLink, "\n                                            <div class=\"dropdown-header\" style=\"padding-left: 10px\">External Links</div>\n                                            <div style=\"padding: 5px\"><a target=\"_blank\" href=\"http://www.ensembl.org/Homo_sapiens/Gene/Summary?db=core;g=").concat(geneName, "\">Ensembl</a></div>\n                                            <div style=\"padding: 5px\"><a target=\"_blank\" href=\"https://cancer.sanger.ac.uk/cosmic/gene/analysis?ln=").concat(geneName, "\">COSMIC</a></div>\n                                            <div style=\"padding: 5px\"><a target=\"_blank\" href=\"https://www.uniprot.org/uniprot/?sort=score&query=").concat(geneName, "\">UniProt</a></div>\n                                        ");
            geneLinks.push("<span class=\"gene-tooltip\" data-tooltip-text='".concat(tooltipText, "' style=\"margin-left: 2px\">\n                                            <a style=\"cursor: pointer\">\n                                                ").concat(geneName, "\n                                            </a>\n                                        </span>"));
          } else {
            geneLinks.push("<a style=\"cursor: pointer\">".concat(geneName, "</a>"));
          }

          visited[geneName] = true;
        }
      } // Do not write more than 4 genes per line, this could be easily configurable


      let resultHtml = "";

      for (let i = 0; i < geneLinks.length; i++) {
        resultHtml += geneLinks[i];

        if (i + 1 !== geneLinks.length) {
          if (i === 0) {
            resultHtml += ",";
          } else if ((i + 1) % 4 !== 0) {
            resultHtml += ",";
          } else {
            resultHtml += "<br>";
          }
        }
      }

      return resultHtml;
    } else {
      return "-";
    }
  }

  typeFormatter(value, row, index) {
    if (row !== undefined) {
      let color = "";

      switch (row.type) {
        case "INDEL":
        case "MNV":
          color = "darkorange";
          break;

        case "INSERTION":
        case "DELETION":
          color = "red";
          break;

        default:
          color = "black";
          break;
      }

      return "<span style=\"color: ".concat(color, "\">").concat(row.type, "</span>");
    } else {
      return "-";
    }
  }

  consequenceTypeFormatter(value, row, index) {
    if (typeof row !== "undefined" && typeof row.annotation !== "undefined" && utilsNew_UtilsNew.isNotEmptyArray(row.annotation.consequenceTypes)) {
      let consequenceTypesArr = [];
      let visited = new Set();
      let impact = {};

      for (let i = 0; i < row.annotation.consequenceTypes.length; i++) {
        for (let j = 0; j < row.annotation.consequenceTypes[i].sequenceOntologyTerms.length; j++) {
          let consequenceTypeName = row.annotation.consequenceTypes[i].sequenceOntologyTerms[j].name; // FIXME This is a temporal fix for some wrong CTs. This must be removed ASAP.

          if (consequenceTypeName === "2KB_downstream_gene_variant") {
            consequenceTypeName = "2KB_downstream_variant";
          }

          if (consequenceTypeName === "2KB_upstream_gene_variant") {
            consequenceTypeName = "2KB_upstream_variant";
          }

          if (typeof consequenceTypeName !== "undefined" && consequenceTypeName !== "" && !visited.has(consequenceTypeName)) {
            if (typeof this.consequenceTypeToImpact !== "undefined" && typeof this.consequenceTypeToImpact[consequenceTypeName] !== "undefined") {
              let imp = this.consequenceTypeToImpact[consequenceTypeName];

              if (typeof impact[imp] === "undefined") {
                impact[imp] = [];
              }

              if (typeof this.consequenceTypeToColor !== "undefined" && typeof this.consequenceTypeToColor[consequenceTypeName] !== "undefined") {
                impact[imp].push("<span style=\"color: " + this.consequenceTypeToColor[consequenceTypeName] + "\">" + consequenceTypeName + "</span>");
              } else {
                impact[imp].push("<span>" + consequenceTypeName + "</span>");
              }
            }

            visited.add(consequenceTypeName);
          }
        }
      }

      if (Object.keys(impact).length > 0) {
        if (typeof impact["high"] !== "undefined" || typeof impact["moderate"] !== "undefined") {
          if (typeof impact["high"] !== "undefined") {
            Array.prototype.push.apply(consequenceTypesArr, impact["high"]);
          }

          if (typeof impact["moderate"] !== "undefined") {
            Array.prototype.push.apply(consequenceTypesArr, impact["moderate"]);
          }
        } else if (typeof impact["low"] !== "undefined") {
          Array.prototype.push.apply(consequenceTypesArr, impact["low"]);
        } else if (typeof impact["modifier"] !== "undefined") {
          Array.prototype.push.apply(consequenceTypesArr, impact["modifier"]);
        }
      }

      return consequenceTypesArr.join("<br>");
    }

    return "-";
  }

  consequenceTypeDetailFormatter(value, row, variantGrid) {
    if (typeof row !== "undefined" && typeof row.annotation !== "undefined" && utilsNew_UtilsNew.isNotEmptyArray(row.annotation.consequenceTypes)) {
      let ctHtml = "<table id=\"ConsqTypeTable\" class=\"table table-hover table-no-bordered\">\n                                <thead>\n                                    <tr>\n                                        <th rowspan=\"2\">Gene Name</th>\n                                        <th rowspan=\"2\">Ensembl Gene</th>                                     \n                                        <th rowspan=\"2\">Ensembl Transcript</th>\n                                        <th rowspan=\"2\">Biotype</th>\n                                        <th rowspan=\"2\">Transcript Flags</th>\n                                        <th rowspan=\"2\">Consequence Types (SO Term)</th>\n                                        <th rowspan=\"1\" colspan=\"4\" style=\"text-align: center\">Protein Variant Annotation</th>\n                                    </tr>\n                                    <tr>\n                                        <th rowspan=\"1\">UniProt Acc</th>\n                                        <th rowspan=\"1\">Position</th>\n                                        <th rowspan=\"1\">Ref/Alt</th>\n                                        <th rowspan=\"1\">Sift/Polyphen</th>\n                                    </tr>\n                                </thead>\n                                <tbody>"; // Sort and group CTs by Gene name

      row.annotation.consequenceTypes.sort(function (a, b) {
        if (a.geneName === "" && b.geneName !== "") {
          return 1;
        }

        if (a.geneName !== "" && b.geneName === "") {
          return -1;
        }

        if (a.geneName < b.geneName) {
          return -1;
        }

        if (a.geneName > b.geneName) {
          return 1;
        }

        return 0;
      });

      for (let ct of row.annotation.consequenceTypes) {
        // Prepare data info for columns
        let geneName = "NA";

        if (utilsNew_UtilsNew.isNotEmpty(ct.geneName)) {
          geneName = "<a href=\"https://www.genenames.org/tools/search/#!/all?query=".concat(ct.geneName, "\" target=\"_blank\">\n                                ").concat(ct.geneName, "\n                              </a>");
        }

        let geneId = "NA";

        if (utilsNew_UtilsNew.isNotEmpty(ct.ensemblGeneId)) {
          geneId = "<a href=\"http://www.ensembl.org/Homo_sapiens/Gene/Summary?db=core;g=".concat(ct.ensemblGeneId, "\" target=\"_blank\">\n                                ").concat(ct.ensemblGeneId, "\n                              </a>");
        }

        let transcriptId = "NA";

        if (utilsNew_UtilsNew.isNotEmpty(ct.ensemblTranscriptId)) {
          transcriptId = "<a href=\"http://www.ensembl.org/Homo_sapiens/Transcript/Idhistory?t=".concat(ct.ensemblTranscriptId, "\" target=\"_blank\">\n                                        ").concat(ct.ensemblTranscriptId, "\n                                    </a>");
        }

        let pva = {};

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(ct.proteinVariantAnnotation)) {
          pva = ct.proteinVariantAnnotation;
        }

        let soArray = [];

        for (let so of ct.sequenceOntologyTerms) {
          let color = "black";

          if (typeof variantGrid.consequenceTypeToColor !== "undefined" && typeof variantGrid.consequenceTypeToColor[so.name] !== "undefined") {
            color = variantGrid.consequenceTypeToColor[so.name];
          }

          soArray.push("<div style=\"color: ".concat(color, "\">\n                                    ").concat(so.name, " (<a href=\"http://www.sequenceontology.org/browser/current_svn/term/").concat(so.accession, "\" target=\"_blank\">").concat(so.accession, "</a>)\n                                  </div>"));
        }

        let uniprotAccession = "-";

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(pva.uniprotAccession)) {
          uniprotAccession = "<a href=\"https://www.uniprot.org/uniprot/".concat(pva.uniprotAccession, "\" target=\"_blank\">").concat(pva.uniprotAccession, "</a>");
        }

        let deleteriousness = "-/-";

        if (utilsNew_UtilsNew.isNotEmptyArray(pva.substitutionScores)) {
          let sift = "-";
          let polyphen = "-";

          for (let score of pva.substitutionScores) {
            if (score.source === "sift") {
              sift = score.description;
            }

            if (score.source === "polyphen") {
              polyphen = score.description;
            }
          }

          deleteriousness = sift + "/" + polyphen;
        } // Create the table row


        ctHtml += "<tr class=\"detail-view-row\">\n                            <td>".concat(geneName, "</td>\n                            <td>").concat(geneId, "</td>\n                            <td>").concat(transcriptId, "</td>\n                            <td>").concat(utilsNew_UtilsNew.isNotEmpty(ct.biotype) ? ct.biotype : "NA", "</td>\n                            <td>").concat(utilsNew_UtilsNew.isNotEmptyArray(ct.transcriptAnnotationFlags) ? ct.transcriptAnnotationFlags.join(", ") : "NA", "</td>\n                            <td>").concat(soArray.join(""), "</td>\n                            <td>").concat(uniprotAccession, "</td>\n                            <td>").concat(pva.position !== undefined ? pva.position : "-", "</td>\n                            <td>").concat(pva.reference !== undefined ? pva.reference + "/" + pva.alternate : "-", "</td>\n                            <td>").concat(deleteriousness, "</td>\n                           </tr>");
      }

      ctHtml += "</tbody></table>";
      return ctHtml;
    }

    return "-";
  }

  addCohortStatsInfoTooltip(div, populationFrequencies) {
    $("#" + div).qtip({
      content: {
        title: "Population Frequencies",
        text: function text(event, api) {
          return "One coloured square is shown for each cohort. Frequencies are coded with colours which classify values \n                            into 'very rare', 'rare', 'average', 'common' or 'missing', see \n                            <a href=\"http://www.dialogues-cns.com/wp-content/uploads/2015/03/DialoguesClinNeurosci-17-69-g001.jpg\" target=\"_blank\">\n                                http://www.dialogues-cns.com/wp-content/uploads/2015/03/DialoguesClinNeurosci-17-69-g001.jpg\n                            </a>. Please, leave the cursor over each square to visualize the actual frequency values.\n                            <div style=\"padding: 10px 0px 0px 0px\"><label>Legend: </label></div>\n                            <div><span><i class=\"fa fa-square\" style=\"color: ".concat(populationFrequencies.color.veryRare, "\" aria-hidden=\"true\"></i> Very rare:  freq < 0.001</span></div>\n                            <div><span><i class=\"fa fa-square\" style=\"color: ").concat(populationFrequencies.color.rare, "\" aria-hidden=\"true\"></i> Rare:  freq < 0.005</span></div>\n                            <div><span><i class=\"fa fa-square\" style=\"color: ").concat(populationFrequencies.color.average, "\" aria-hidden=\"true\"></i> Average:  freq < 0.05</span></div>\n                            <div><span><i class=\"fa fa-square\" style=\"color: ").concat(populationFrequencies.color.common, "\" aria-hidden=\"true\"></i> Common:  freq >= 0.05</span></div>\n                            <div><span><i class=\"fa fa-square\" style=\"color: black\" aria-hidden=\"true\"></i> Not observed</span></div>");
        }
      },
      position: {
        target: "mouse",
        adjust: {
          x: 2,
          y: 2,
          mouse: false
        }
      },
      style: {
        width: "240px"
      },
      show: {
        delay: 200
      },
      hide: {
        fixed: true // delay: 300

      }
    });
  }
  /**
   * Creates the colored table with one row and as many columns as populations.
   * @param cohorts
   * @param populationFrequenciesColor
   */


  createCohortStatsTable(cohorts, cohortStats, populationFrequenciesColor) {
    // This is used by the tooltip function below to display all population frequencies
    let popFreqsTooltip;
    let popFreqsArray = [];

    for (let cohort of cohorts) {
      let freq = cohortStats.get(cohort.id) !== undefined ? cohortStats.get(cohort.id) : 0;
      popFreqsArray.push(cohort.name + "::" + freq);
    }

    popFreqsTooltip = popFreqsArray.join(","); // Create the table (with the tooltip info)

    let tableSize = cohorts.length * 15;
    let htmlPopFreqTable = "<table style=\"width:".concat(tableSize, "px\" class=\"cohortStatsTable\" data-pop-freq=\"").concat(popFreqsTooltip, "\"><tr>");

    for (let cohort of cohorts) {
      let color = "black";

      if (typeof cohortStats.get(cohort.id) !== "undefined") {
        let freq = cohortStats.get(cohort.id);
        color = this._getPopulationFrequencyColor(freq, populationFrequenciesColor);
      }

      htmlPopFreqTable += "<td style=\"width: 15px; background: ".concat(color, "\">&nbsp;</td>");
    }

    htmlPopFreqTable += "</tr></table>";
    return htmlPopFreqTable;
  }

  addPopulationFrequenciesInfoTooltip(selector, populationFrequencies) {
    $(selector).qtip({
      content: {
        title: "Population Frequencies",
        text: function text(event, api) {
          return "One coloured square is shown for each population. Frequencies are coded with colours which classify values \n                            into 'very rare', 'rare', 'average', 'common' or 'missing', see \n                            <a href=\"https://www.nature.com/scitable/topicpage/multifactorial-inheritance-and-genetic-disease-919\" target=\"_blank\">\n                                https://www.nature.com/scitable/topicpage/multifactorial-inheritance-and-genetic-disease-919\n                            </a>. Please, leave the cursor over each square to display the actual frequency value.\n                            <div style=\"padding: 10px 0px 0px 0px\"><label>Legend: </label></div>\n                            <div><span><i class=\"fa fa-square\" style=\"color: ".concat(populationFrequencies.color.veryRare, "\" aria-hidden=\"true\"></i> Very rare:  freq < 0.001</span></div>\n                            <div><span><i class=\"fa fa-square\" style=\"color: ").concat(populationFrequencies.color.rare, "\" aria-hidden=\"true\"></i> Rare:  freq < 0.005</span></div>\n                            <div><span><i class=\"fa fa-square\" style=\"color: ").concat(populationFrequencies.color.average, "\" aria-hidden=\"true\"></i> Average:  freq < 0.05</span></div>\n                            <div><span><i class=\"fa fa-square\" style=\"color: ").concat(populationFrequencies.color.common, "\" aria-hidden=\"true\"></i> Common:  freq >= 0.05</span></div>\n                            <div><span><i class=\"fa fa-square\" style=\"color: black\" aria-hidden=\"true\"></i> Not observed</span></div>");
        }
      },
      position: {
        target: "mouse",
        adjust: {
          x: 2,
          y: 2,
          mouse: false
        }
      },
      style: {
        width: "240px"
      },
      show: {
        delay: 200
      },
      hide: {
        fixed: true,
        delay: 300
      }
    });
  }
  /**
   * Creates the colored table with one row and as many columns as populations.
   * @param populations
   * @param populationFrequenciesMap
   * @param populationFrequenciesColor
   */


  createPopulationFrequenciesTable(populations, populationFrequenciesMap, populationFrequenciesColor) {
    // This is used by the tooltip function below to display all population frequencies
    let popFreqsTooltip;
    let popFreqsArray = [];

    for (let population of populations) {
      let freq = populationFrequenciesMap.get(population) !== undefined ? populationFrequenciesMap.get(population) : 0;
      popFreqsArray.push(population + "::" + freq);
    }

    popFreqsTooltip = popFreqsArray.join(","); // Create the table (with the tooltip info)

    let tableSize = populations.length * 15;
    let htmlPopFreqTable = "<table style=\"width:".concat(tableSize, "px\" class=\"populationFrequenciesTable\" data-pop-freq=\"").concat(popFreqsTooltip, "\"><tr>");

    for (let population of populations) {
      // This array contains "study:population"
      let color = "black";

      if (typeof populationFrequenciesMap.get(population) !== "undefined") {
        let freq = populationFrequenciesMap.get(population);
        color = this._getPopulationFrequencyColor(freq, populationFrequenciesColor);
      }

      htmlPopFreqTable += "<td style=\"width: 15px; background: ".concat(color, "\">&nbsp;</td>");
    }

    htmlPopFreqTable += "</tr></table>";
    return htmlPopFreqTable;
  }

  addPopulationFrequenciesTooltip(div, populationFrequencies) {
    if (utilsNew_UtilsNew.isEmpty(div)) {
      div = "table.populationFrequenciesTable";
    }

    let _this = this;

    $(div).qtip({
      content: {
        title: "Population Frequencies",
        text: function text(event, api) {
          let popFreqs = $(this).attr('data-pop-freq').split(",");
          let html = "";

          for (let popFreq of popFreqs) {
            let arr = popFreq.split("::");

            let color = _this._getPopulationFrequencyColor(arr[1], populationFrequencies.color);

            let freq = arr[1] !== 0 && arr[1] !== "0" ? arr[1] : "0.00 (NA)";
            html += "<div>\n                                    <span><i class=\"fa fa-xs fa-square\" style=\"color: ".concat(color, "\" aria-hidden=\"true\"></i>\n                                        <label style=\"padding-left: 5px\">").concat(arr[0], ":</label>\n                                    </span>\n                                    <span style=\"font-weight: bold\">").concat(freq, "</span>\n                                </div>");
          }

          return html;
        }
      },
      position: {
        target: "mouse",
        adjust: {
          x: 2,
          y: 2,
          mouse: false
        }
      },
      style: {
        width: "240px"
      },
      show: {
        delay: 200
      },
      hide: {
        fixed: true,
        delay: 300
      }
    });
  }

  _getPopulationFrequencyColor(freq, populationFrequenciesColor) {
    let color;

    if (freq === 0 || freq === "0") {
      color = populationFrequenciesColor.unobserved;
    } else if (freq < 0.001) {
      color = populationFrequenciesColor.veryRare;
    } else if (freq < 0.005) {
      color = populationFrequenciesColor.rare;
    } else if (freq < 0.05) {
      color = populationFrequenciesColor.average;
    } else {
      color = populationFrequenciesColor.common;
    }

    return color;
  }

  addPhenotypesInfoTooltip(div) {
    $("#" + div).qtip({
      content: {
        title: "Phenotypes",
        text: function text(event, api) {
          return "<div>\n                                <span style=\"font-weight: bold\">ClinVar</span> is a freely accessible, public archive of reports of the relationships among human variations \n                                and phenotypes, with supporting evidence.\n                            </div>\n                            <div style=\"padding-top: 10px\">\n                                <span style=\"font-weight: bold\">COSMIC</span> is the world's largest and most comprehensive resource for exploring the impact of somatic mutations in human cancer.\n                            </div>\n\n                           ";
        }
      },
      position: {
        target: "mouse",
        my: "top right",
        adjust: {
          x: 2,
          y: 2,
          mouse: false
        }
      },
      style: {
        width: "240px"
      },
      show: {
        delay: 200
      },
      hide: {
        fixed: true,
        delay: 300
      }
    });
  }
  /*
   * Reported Variant formatters
   */


  reportedEventDetailFormatter(value, row, variantGrid) {
    if (typeof row !== "undefined" && utilsNew_UtilsNew.isNotEmptyArray(row.evidences)) {
      let selectColumnHtml = "";

      if (variantGrid._config.showSelectCheckbox) {
        selectColumnHtml = "<th rowspan=\"2\">Select</th>";
      }

      let ctHtml = "<table id=\"ConsqTypeTable\" class=\"table table-hover table-no-bordered\">\n                                <thead>\n                                    <tr>\n                                        <th rowspan=\"2\">Gene</th>\n                                        <th rowspan=\"2\">Transcript</th>\n                                        <th rowspan=\"2\">Gencode</th>\n                                        <th rowspan=\"2\">Consequence Type (SO Term)</th>\n                                        <th rowspan=\"2\">Panel</th>\n                                        <th rowspan=\"2\">Mode of Inheritance</th>\n                                        <th rowspan=\"2\">Role in Cancer</th>\n                                        <th rowspan=\"2\">Actionable</th>\n                                        <th rowspan=\"1\" colspan=\"3\" style=\"text-align: center\">Classification</th>\n                                        ".concat(selectColumnHtml, "\n                                    </tr>\n                                    <tr>\n                                        <th rowspan=\"1\">ACMG</th>\n                                        <th rowspan=\"2\">Tier</th>\n                                        <th rowspan=\"1\">Clinical Significance</th>\n                                    </tr>\n                                </thead>\n                                <tbody>"); // Sort by Tier level

      row.evidences.sort(function (a, b) {
        if (a.tier === null || b.tier !== null) {
          return 1;
        }

        if (a.tier !== null || b.tier === null) {
          return -1;
        }

        if (a.tier < b.tier) {
          return -1;
        }

        if (a.tier > b.tier) {
          return 1;
        }

        return 0;
      }); // FIXME Maybe this should happen in the server?
      // let biotypeSet = new Set();

      let consequenceTypeSet = new Set();

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(variantGrid.query)) {
        // if (UtilsNew.isNotUndefinedOrNull(variantGrid.query.biotype)) {
        //     biotypeSet = new Set(variantGrid.query.biotype.split(","));
        // }
        if (utilsNew_UtilsNew.isNotUndefinedOrNull(variantGrid.query.ct)) {
          consequenceTypeSet = new Set(variantGrid.query.ct.split(","));
        }
      }

      for (let re of row.evidences) {
        // FIXME Maybe this should happen in the server?
        // If ct exist and there are some consequenceTypeIds then we check that the report event matches the query
        if (utilsNew_UtilsNew.isNotEmptyArray(re.consequenceTypeIds) && consequenceTypeSet.size > 0) {
          let hasConsequenceType = false;

          for (let ct of re.consequenceTypeIds) {
            if (consequenceTypeSet.has(ct)) {
              hasConsequenceType = true;
            }
          }

          if (!hasConsequenceType) {
            continue;
          }
        } // Prepare data info for columns


        let gene = "NA";

        if (utilsNew_UtilsNew.isNotEmpty(re.genomicFeature.id)) {
          gene = "<div>\n                                <a href=\"https://www.genenames.org/tools/search/#!/all?query=".concat(re.genomicFeature.geneName, "\" target=\"_blank\">\n                                    ").concat(re.genomicFeature.geneName, "\n                                </a>\n                            </div>\n                            <div style=\"padding-top: 5px\">\n                                <a href=\"http://www.ensembl.org/Homo_sapiens/Gene/Summary?db=core;g=").concat(re.genomicFeature.id, "\" target=\"_blank\">\n                                    ").concat(re.genomicFeature.id, "\n                                </a>\n                            </div>");
        }

        let transcriptId = "NA";

        if (utilsNew_UtilsNew.isNotEmpty(re.genomicFeature.transcriptId)) {
          let biotype = "NA";

          if (utilsNew_UtilsNew.isNotUndefinedOrNull(row.annotation) && utilsNew_UtilsNew.isNotEmptyArray(row.annotation.consequenceTypes)) {
            for (let ct of row.annotation.consequenceTypes) {
              if (ct.ensemblTranscriptId === re.genomicFeature.transcriptId) {
                biotype = ct.biotype;
                break;
              }
            }
          }

          transcriptId = "<div>\n                                        <a href=\"http://www.ensembl.org/Homo_sapiens/Transcript/Idhistory?t=".concat(re.genomicFeature.transcriptId, "\" target=\"_blank\">\n                                            ").concat(re.genomicFeature.transcriptId, "\n                                        </a>\n                                    </div>\n                                    <div style=\"padding-top: 5px\">\n                                        ").concat(biotype, "\n                                    </div>");
        }

        let transcriptFlag = "";
        let transcriptFlagChecked = false;

        if (utilsNew_UtilsNew.isNotEmptyArray(row.annotation.consequenceTypes)) {
          for (let ct of row.annotation.consequenceTypes) {
            if (re.genomicFeature.transcriptId === ct.ensemblTranscriptId) {
              if (ct.transcriptAnnotationFlags !== undefined && ct.transcriptAnnotationFlags.includes("basic")) {
                transcriptFlag = "<span data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Proband\">\n                                                    <i class='fa fa-check' style='color: green'></i>\n                                                  </span>";
                transcriptFlagChecked = true;
              } else {
                transcriptFlag = "<span><i class='fa fa-times' style='color: red'></i></span>";
              }

              break;
            }
          }
        }

        let soArray = [];

        if (utilsNew_UtilsNew.isNotEmptyArray(re.consequenceTypes)) {
          for (let so of re.consequenceTypes) {
            let color = "black";

            if (typeof variantGrid.consequenceTypeToColor !== "undefined" && typeof variantGrid.consequenceTypeToColor[so.name] !== "undefined") {
              color = variantGrid.consequenceTypeToColor[so.name];
            }

            soArray.push("<div style=\"color: ".concat(color, "\">\n                                    ").concat(so.name, " (<a href=\"http://www.sequenceontology.org/browser/current_svn/term/").concat(so.accession, "\" target=\"_blank\">").concat(so.accession, "</a>)\n                                  </div>"));
          }
        }

        let panel = "-";

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(re.panelId)) {
          panel = re.panelId;
        }

        let moi = "-";

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(re.modeOfInheritance)) {
          moi = re.modeOfInheritance;
        }

        let roleInCancer = "-";

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(re.roleInCancer)) {
          roleInCancer = re.roleInCancer;
        }

        let actionable = "-";

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(re.actionable) && re.actionable) {
          actionable = "Yes";
        }

        let acmg = "-";

        if (utilsNew_UtilsNew.isNotEmptyArray(re.classification.acmg)) {
          acmg = re.classification.acmg.join(", ");
        }

        let tier = "none";
        let color = "black";

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(re.tier)) {
          color = re.tier === "Tier1" || re.tier === "Tier 1" ? "red" : color;
          color = re.tier === "Tier2" || re.tier === "Tier 2" ? "darkorange" : color;
          color = re.tier === "Tier3" || re.tier === "Tier 3" ? "blue" : color;
          tier = "<span style=\"color: ".concat(color, "\">").concat(re.tier, "</span>");
        }

        let clinicalSignificance = "-";

        if (utilsNew_UtilsNew.isNotEmptyArray(re.classification.clinicalSignificance)) {
          clinicalSignificance = re.classification.clinicalSignificance;

          switch (re.classification.clinicalSignificance) {
            case "PATHOGENIC_VARIANT":
              clinicalSignificance = "<span style='color: red'>Pathogenic</span>";
              break;

            case "LIKELY_PATHOGENIC_VARIANT":
              clinicalSignificance = "<span style='color: red'>Likely Pathogenic</span>";
              break;

            case "VARIANT_OF_UNKNOWN_CLINICAL_SIGNIFICANCE":
              clinicalSignificance = "<span style='color: darkorange'>VUS</span>";
              break;

            case "LINKELY_BENIGN_VARIANT":
              clinicalSignificance = "<span style='color: blue'>Likely Benign</span>";
              break;

            case "BENIGN_VARIANT":
              clinicalSignificance = "<span style='color: blue'>Benign</span>";
              break;

            case "UNKNOWN":
            case "NOT_ASSESSED":
            default:
              clinicalSignificance = "NA";
              break;
          }
        }

        let checboxHtml = "";

        if (variantGrid._config.showSelectCheckbox) {
          let checked = "";

          if (transcriptFlagChecked && tier !== "none") {
            checked = "checked";
          }

          checboxHtml = "<td><input type=\"checkbox\" ".concat(checked, "></td>");
        } // Create the table row


        ctHtml += "<tr class=\"detail-view-row\">\n                            <td>".concat(gene, "</td>\n                            <td>").concat(transcriptId, "</td>\n                            <td>").concat(transcriptFlag, "</td>\n                            <td>").concat(soArray.join(""), "</td>\n                            <td>").concat(panel, "</td>\n                            <td>").concat(moi, "</td>\n                            <td>").concat(roleInCancer, "</td>\n                            <td>").concat(actionable, "</td>\n                            <td>").concat(acmg, "</td>\n                            <td>").concat(tier, "</td>\n                            <td>").concat(clinicalSignificance, "</td>\n                            ").concat(checboxHtml, "\n                           </tr>");
      }

      ctHtml += "</tbody></table>";
      return ctHtml;
    }

    return "-";
  }

  addTooltip(selector, title, content, config) {
    $(selector).qtip({
      content: {
        title: title,
        text: function text(event, api) {
          if (utilsNew_UtilsNew.isNotEmpty(content)) {
            return content;
          } else {
            return $(this).attr('data-tooltip-text');
          }
        }
      },
      position: {
        target: "mouse",
        my: config !== undefined && config.position !== undefined && config.position.my !== undefined ? config.position.my : "top left",
        adjust: {
          x: 2,
          y: 2,
          mouse: false
        }
      },
      style: {
        classes: config !== undefined && config.style !== undefined && config.style.classes !== undefined ? config.style.classes : "qtip-light qtip-rounded qtip-shadow qtip-custom-class",
        width: "260px"
      },
      show: {
        delay: 250
      },
      hide: {
        fixed: true,
        delay: 300
      }
    });
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/variant-utils.js
/**
 * Created by swaathi on 28/03/17.
 */
 // TODO refactor

class variant_utils_VariantUtils {
  static jsonToTabConvert(json, studiesPopFrequencies, samples, nucleotideGenotype) {
    let dataString = [];
    let variantString = [];
    let populationMap = {};

    for (var key in json[0]) {
      console.log(key);
    }

    variantString.push("Variant");
    variantString.push("SNP ID");
    variantString.push("Genes");
    variantString.push("Type");
    samples.forEach(sample => {
      variantString.push(sample.id);
    });
    variantString.push("Consequence Type");
    variantString.push("SIFT");
    variantString.push("Polyphen");
    variantString.push("CADD");
    variantString.push("PhyloP");
    variantString.push("PhastCons");
    variantString.push("GERP"); // variantString.push("Population frequencies");

    studiesPopFrequencies.forEach(study => {
      study.populations.forEach(pop => variantString.push(study.id + "_" + pop.id));
    });
    variantString.push("Clinvar");
    variantString.push("Cosmic");
    dataString.push(variantString.join('\t'));
    variantString = [];

    for (let i = 0; i < json.length; i++) {
      variantString.push(json[i].chromosome + ':' + json[i].start + " " + json[i].reference + '/' + json[i].alternate);

      if (typeof json[i].id !== "undefined" && json[i].id.startsWith("rs")) {
        variantString.push(json[i].id);
      } else if (typeof json[i].annotation !== "undefined" && typeof json[i].annotation.xrefs !== "undefined" && json[i].annotation.xrefs.length > 0) {
        let annotation = json[i].annotation.xrefs.find(function (element) {
          return element.source === "dbSNP";
        });

        if (typeof annotation !== "undefined") {
          variantString.push(annotation.id);
        } else {
          variantString.push("-");
        }
      } else {
        variantString.push("-");
      }

      let genes = [];
      let ct = [];
      let pfArray = [];
      let sift,
          polyphen,
          cadd = "-",
          phylop = "-",
          phastCons = "-",
          gerp = "-";
      let clinvar = [];
      let cosmic = [];
      populationMap = {};
      let description = {
        sift: "-",
        polyphen: "-"
      };
      let min = 10;
      let max = 0;

      if (typeof json[i].annotation !== "undefined") {
        if (typeof json[i].annotation.consequenceTypes !== "undefined" && json[i].annotation.consequenceTypes.length > 0) {
          let visitedGenes = {};
          let visitedCT = new Set();

          for (let j = 0; j < json[i].annotation.consequenceTypes.length; j++) {
            // gene
            if (typeof json[i].annotation.consequenceTypes[j].geneName !== "undefined" && json[i].annotation.consequenceTypes[j].geneName != "" && typeof visitedGenes[json[i].annotation.consequenceTypes[j].geneName] === "undefined") {
              genes.push(json[i].annotation.consequenceTypes[j].geneName);
              visitedGenes[json[i].annotation.consequenceTypes[j].geneName] = true;
            } // Consequence Type


            for (let z = 0; z < json[i].annotation.consequenceTypes[j].sequenceOntologyTerms.length; z++) {
              let consequenceTypeName = json[i].annotation.consequenceTypes[j].sequenceOntologyTerms[z].name;

              if (typeof consequenceTypeName !== "undefined" && consequenceTypeName != "" && !visitedCT.has(consequenceTypeName)) {
                ct.push(consequenceTypeName);
                visitedCT.add(consequenceTypeName);
              }
            } // Sift, Polyphen


            if (typeof json[i].annotation.consequenceTypes[j].proteinVariantAnnotation !== "undefined" && typeof json[i].annotation.consequenceTypes[j].proteinVariantAnnotation.substitutionScores !== "undefined") {
              for (let ss = 0; ss < json[i].annotation.consequenceTypes[j].proteinVariantAnnotation.substitutionScores.length; ss++) {
                let source = json[i].annotation.consequenceTypes[j].proteinVariantAnnotation.substitutionScores[ss].source;

                switch (source) {
                  case "sift":
                    if (json[i].annotation.consequenceTypes[j].proteinVariantAnnotation.substitutionScores[ss].score < min) {
                      min = json[i].annotation.consequenceTypes[j].proteinVariantAnnotation.substitutionScores[ss].score;
                      description.sift = json[i].annotation.consequenceTypes[j].proteinVariantAnnotation.substitutionScores[ss].description + " (" + json[i].annotation.consequenceTypes[j].proteinVariantAnnotation.substitutionScores[ss].score + ")";
                    }

                    break;

                  case "polyphen":
                    if (json[i].annotation.consequenceTypes[j].proteinVariantAnnotation.substitutionScores[ss].score >= max) {
                      max = json[i].annotation.consequenceTypes[j].proteinVariantAnnotation.substitutionScores[ss].score;
                      description.polyphen = json[i].annotation.consequenceTypes[j].proteinVariantAnnotation.substitutionScores[ss].description + " (" + json[i].annotation.consequenceTypes[j].proteinVariantAnnotation.substitutionScores[ss].score + ")";
                    }

                    break;
                }
              }
            }
          }
        }

        sift = typeof description.sift !== "undefined" ? description.sift : "-";
        polyphen = typeof description.polyphen !== "undefined" ? description.polyphen : "-"; // CADD

        if (typeof json[i].annotation.functionalScore !== "undefined") {
          for (let fs = 0; fs < json[i].annotation.functionalScore.length; fs++) {
            if (typeof json[i].annotation.functionalScore[fs] !== "undefined" && json[i].annotation.functionalScore[fs].source == "cadd_scaled") {
              cadd = Number(json[i].annotation.functionalScore[fs].score).toFixed(2);
            }
          }
        } // Conservation


        if (typeof json[i].annotation.conservation !== "undefined") {
          for (let cons = 0; cons < json[i].annotation.conservation.length; cons++) {
            switch (json[i].annotation.conservation[cons].source) {
              case "phylop":
                phylop = Number(json[i].annotation.conservation[cons].score).toFixed(3);
                break;

              case "phastCons":
                phastCons = Number(json[i].annotation.conservation[cons].score).toFixed(3);
                break;

              case "gerp":
                gerp = Number(json[i].annotation.conservation[cons].score).toFixed(3);
                break;
            }
          }
        } // Population frequency


        let populations = [];
        let populationStudyBidimensional = [];
        let populationMapExists = [];
        studiesPopFrequencies.forEach(study => {
          populations[study.id] = study.populations.map(pop => pop.id);
          study.populations.forEach(pop => {
            populationMapExists[pop.id] = true;
          });
          populationStudyBidimensional[study.id] = populationMapExists;
        });

        if (typeof studiesPopFrequencies !== "undefined" && studiesPopFrequencies.length > 0) {
          for (let j = 0; j < studiesPopFrequencies.length; j++) {
            let study = studiesPopFrequencies[j];

            for (let popFreqIdx in json[i].annotation.populationFrequencies) {
              let popFreq = json[i].annotation.populationFrequencies[popFreqIdx];

              if (utilsNew_UtilsNew.isNotUndefinedOrNull(popFreq)) {
                let population = popFreq.population;

                if (study.id === popFreq.study && populationStudyBidimensional[study.id][population] === true) {
                  populationMap[study.id + "_" + population] = 'NA';
                }
              }
            }
          }
        }

        if (typeof json[i].annotation.populationFrequencies !== "undefined") {
          for (let pf = 0; pf < json[i].annotation.populationFrequencies.length; pf++) {
            let pop = json[i].annotation.populationFrequencies[pf].study + '_' + json[i].annotation.populationFrequencies[pf].population;

            if (typeof populationMap[pop] !== "undefined" && populationMap[pop] == "NA") {
              populationMap[pop] = Number(json[i].annotation.populationFrequencies[pf].altAlleleFreq).toFixed(4);
            }
          }
        } // pfArray = Object.keys(populationMap).map(key => populationMap[key]);
        // Clinvar, cosmic


        if (typeof json[i].annotation.variantTraitAssociation !== "undefined" && json[i].annotation.variantTraitAssociation != null) {
          for (let key in json[i].annotation.variantTraitAssociation) {
            let clinicalData = json[i].annotation.variantTraitAssociation[key];

            if (typeof clinicalData !== "undefined") {
              for (let cd = 0; cd < clinicalData.length; cd++) {
                switch (key) {
                  case "clinvar":
                    clinvar.push(clinicalData[cd].traits[0]);
                    break;

                  case "cosmic":
                    cosmic.push(clinicalData[cd].primaryHistology);
                    break;
                }
              }
            }
          }
        }
      }

      if (genes.length > 0) {
        variantString.push(genes.join(','));
      } else {
        variantString.push("-");
      }

      variantString.push(json[i].type);
      this.getGenotypeSamples(json[i], samples, nucleotideGenotype, variantString);

      if (ct.length > 0) {
        variantString.push(ct.join(','));
      } else {
        variantString.push("-");
      }

      variantString.push(sift);
      variantString.push(polyphen);
      variantString.push(cadd);
      variantString.push(phylop);
      variantString.push(phastCons);
      variantString.push(gerp);
      studiesPopFrequencies.forEach(study => {
        study.populations.forEach(pop => {
          let valuePopFreq = populationMap[study.id + "_" + pop.id];
          variantString.push(utilsNew_UtilsNew.isNotEmpty(valuePopFreq) ? valuePopFreq : "-");
        });
      }); // variantString.push(pfArray.join(','));

      if (clinvar.length > 0) {
        variantString.push(clinvar.join(','));
      } else {
        variantString.push("-");
      }

      if (cosmic.length > 0) {
        variantString.push(cosmic.join(','));
      } else {
        variantString.push("-");
      }

      dataString.push(variantString.join('\t'));
      variantString = [];
    }

    return dataString;
  }

  static getGenotypeSamples(json, samples, nucleotideGenotype, variantString) {
    // Samples genotypes
    if (nucleotideGenotype) {
      samples.forEach((sample, indexSample) => {
        let alternateSequence = json.alternate;
        let referenceSequence = json.reference;
        let genotypeMatch = new Map();
        let colText = "";
        let referenceValueColText = "-";
        let alternateValueColText = "-";
        genotypeMatch.set(0, referenceSequence === "" ? "-" : referenceSequence);
        genotypeMatch.set(1, alternateSequence === "" ? "-" : alternateSequence);
        json.studies.forEach(study => {
          if (utilsNew_UtilsNew.isNotUndefinedOrNull(study.secondaryAlternates) && utilsNew_UtilsNew.isNotEmptyArray(study.secondaryAlternates)) {
            study.secondaryAlternates.forEach(secondary => {
              genotypeMatch.set(genotypeMatch.size, secondary.alternate === "" ? "-" : secondary.alternate);
            });
          }

          if (utilsNew_UtilsNew.isNotUndefinedOrNull(study.samplesData) && utilsNew_UtilsNew.isNotEmptyArray(study.samplesData)) {
            if (utilsNew_UtilsNew.isNotUndefinedOrNull(study.samplesData[indexSample])) {
              let currentGenotype = study.samplesData[indexSample][0];
              let reference = currentGenotype.split("/")[0];
              let alternate = currentGenotype.split("/")[1];
              let tooltipText = reference + " / " + alternate;

              if (utilsNew_UtilsNew.isNotEqual(reference, ".") && utilsNew_UtilsNew.isNotEqual(alternate, ".")) {
                reference = parseInt(reference);
                alternate = parseInt(alternate);
                let referenceValue = genotypeMatch.get(reference);
                let alternateValue = genotypeMatch.get(alternate); // Cases which this will cover.
                // referenceValue.length <= 5 && alternateVAlue.length <= 5
                // referenceValue.length <= 10 && alternateValue == "-"
                // alternateValue.length <= 10 && referenceValue == "-"

                referenceValueColText = referenceValue;
                alternateValueColText = alternateValue; // Not equal X/- or -/X

                if (utilsNew_UtilsNew.isNotEqual(referenceValue, "-") && utilsNew_UtilsNew.isNotEqual(alternateValue, "-")) {
                  if (referenceValue.length <= 5 && alternateValue.length > 5 || referenceValue.length > 5 && alternateValue.length <= 5) {
                    if (referenceValue.length > 5) {
                      // referenceValue > 5
                      referenceValueColText = referenceValue.substring(0, 3) + "..."; //                                                    tooltipText += "<br>" + referenceValue +" / " + alternateValue;
                    } else {
                      // alternateValue > 5
                      alternateValueColText = alternateValue.substring(0, 3) + "..."; //                                                    tooltipText += "<br>" + referenceValue +" / " + alternateValue;
                    }
                  } else if (referenceValue.length > 5 && alternateValue.length > 5) {
                    // Both > 5 It will never happen
                    referenceValueColText = referenceValue.substring(0, 3) + "...";
                    alternateValueColText = alternateValue.substring(0, 3) + "..."; //                                                tooltipText += "<br>" +   referenceValue +" / " + alternateValue;
                  }
                } else if (utilsNew_UtilsNew.isNotEqual(referenceValue, "-") && referenceValue.length > 10) {
                  // X/-
                  let substringReference = referenceValue.substring(0, 5) + "...";
                  referenceValueColText = substringReference;
                  alternateValueColText = "-"; //                                                tooltipText += "<br>" +   referenceValue +" / " + alternateValue;
                } else if (utilsNew_UtilsNew.isNotEqual(alternateValue, "-") && alternateValue.length > 10) {
                  // -/X
                  let substringAlternate = alternateValue.substring(0, 5) + "...";
                  alternateValueColText = substringAlternate;
                  referenceValueColText = "-"; //                                                tooltipText += "<br>" +   referenceValue + " / " + alternateValue;
                }

                tooltipText += "<br>" + referenceValue + " / " + alternateValue;
              } else {
                referenceValueColText = reference;
                alternateValueColText = alternate;
                tooltipText += "<br>" + reference + " / " + alternate;
              }

              let referenceIndex = parseInt(reference);
              let alternateIndex = parseInt(alternate);
              referenceValueColText = referenceValueColText;
              alternateValueColText = alternateValueColText;
              colText = referenceValueColText + " / " + alternateValueColText;
              variantString.push(colText); // res = "<span class='sampleGenotype' data-text='" + tooltipText + "'> " + colText + " </span>";

              return;
            }
          }
        });
      });
    } else {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(samples)) {
        samples.forEach((sample, indexSample) => {
          json.studies.forEach(study => {
            if (study.samplesData.length > 0) {
              let currentGenotype = study.samplesData[indexSample];

              if (utilsNew_UtilsNew.isNotUndefinedOrNull(currentGenotype)) {
                variantString.push(currentGenotype[0]);
                return;
              }
            }

            variantString.push("-");
          });
        });
      }
    }
  }

}
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/opencga-variant-grid.js
function opencga_variant_grid_templateObject() {
  const data = opencga_variant_grid_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            #opencga-variant-grid {\n                font-size: 12px;\n            }\n            \n            span.redText, span.orangeText {\n                margin-left: 0;\n            }\n\n            span.redText {\n                color: red;\n            }\n\n            span.orangeText {\n                color: orange;\n            }\n\n            .detail-view :hover {\n                background-color: white;\n            }\n\n            .detail-view-row :hover {\n                background-color: #f5f5f5;\n            }\n\n            .variant-link-dropdown:hover .dropdown-menu {\n                display: block;\n            }\n\n            .qtip-custom-class .qtip-content{\n                font-size: 12px;\n            }\n        </style>\n        \n        <div id=\"opencga-variant-grid\">\n            <opencb-grid-toolbar from=\"", "\"\n                                to=\"", "\"\n                                numTotalResultsText=\"", "\"\n                                .config=\"", "\"\n                                @columnchange=\"", "\"\n                                @download=\"", "\"\n                                @sharelink=\"", "\">\n            </opencb-grid-toolbar>\n    \n    \n            <div id=\"", "GridTableDiv\">\n                <table id=\"", "VariantBrowserGrid\">\n                </table>\n            </div>\n        </div>\n        "]);

  opencga_variant_grid_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_variant_grid_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_variant_grid_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_variant_grid_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_variant_grid_ownKeys(Object(source), true).forEach(function (key) { opencga_variant_grid_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_variant_grid_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_variant_grid_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */








class opencga_variant_grid_OpencgaVariantGrid extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      _prefix: {
        type: Object
      },
      opencgaSession: {
        type: Object
      },
      query: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      data: {
        type: Array
      },
      cohorts: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      queryCellbase: {
        type: Boolean
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "VarBrowserGrid-" + utils.randomString(6) + "_";
    this.data = [];
    this.queryCellbase = false; // Config for the grid toolbar

    this.toolbarConfig = {
      columns: [{
        title: "Variant",
        field: "id"
      }, {
        title: "dbSNP Id",
        field: "dbSNP"
      }, {
        title: "Gene",
        field: "gene"
      }, {
        title: "Type",
        field: "type"
      }, {
        title: "Consequence Type",
        field: "consequenceType"
      }]
    };
  }

  connectedCallback() {
    super.connectedCallback(); // TODO Refactor

    this.table = $("#" + this._prefix + "VariantBrowserGrid");
    this.downloadRefreshIcon = $("#" + this._prefix + "DownloadRefresh");
    this.downloadIcon = $("#" + this._prefix + "DownloadIcon"); // this._updateTableColumns();
    // this._columns = this._createDefaultColumns();
    // this.renderVariantTable();
    // this.config = this.getDefaultConfig();

    this._config = opencga_variant_grid_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  firstUpdated(_changedProperties) {
    this._createDefaultColumns();

    this.query = {};
  }

  updated(changedProperties) {
    if (changedProperties.has("query") || changedProperties.has("consequenceTypes") || changedProperties.has("populationFrequencies") || changedProperties.has("proteinSubstitutionScores")) {
      // console.log("propertyObserver")
      this.propertyObserver();
    }

    if (changedProperties.has("data")) {
      this.renderFromLocal();
    }
  }

  propertyObserver() {
    // With each property change we must updated config and create the columns again. No extra checks are needed.
    this._config = Object.assign(this.getDefaultConfig(), this.config); // this._columns = this._createDefaultColumns();
    // We check query.sample and query.genotype to check if samples exist.
    // We parse query fields and store a samples object array for convenience

    const _samples = [];

    if (this.query !== undefined) {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query.sample)) {
        for (const sampleId of this.query.sample.split(",")) {
          _samples.push({
            id: sampleId
          });
        }
      }

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query.genotype)) {
        for (const genotype of this.query.genotype.split(";")) {
          _samples.push({
            id: genotype.split(":")[0]
          });
        }
      }
    }

    this.samples = _samples;
    this.variantGridFormatter = new VariantGridFormatter_VariantGridFormatter(this.opencgaSession, this._config); // Set colors

    const colors = this.variantGridFormatter.assignColors(this.consequenceTypes, this.proteinSubstitutionScores);
    Object.assign(this, colors);
    this.renderVariantTable();
  }

  onColumnChange(e) {
    const table = $("#" + this._prefix + "VariantBrowserGrid");

    if (e.detail.selected) {
      table.bootstrapTable("showColumn", e.detail.id);
    } else {
      table.bootstrapTable("hideColumn", e.detail.id);
    }
  }

  renderVariantTable() {
    this.variant = ""; // Empty the variant every time the grid is loaded

    this.from = 1;
    this.to = 10;
    this.approximateCountResult = false;
    let skipCount = false;

    const _table = $("#" + this._prefix + "VariantBrowserGrid"); // TODO quickfix. The check on query is required because the study is in the query object. A request without the study returns the error "Multiple projects found"


    if (this.query && typeof this.opencgaSession !== "undefined" && typeof this.opencgaSession.project !== "undefined" && typeof this.opencgaSession.study !== "undefined" && typeof this.opencgaSession.study.alias !== "undefined") {
      this._columns = this._createDefaultColumns();
      const queryParams = this._getUrlQueryParams;

      let _numTotal = -1;

      const _this = this;

      $("#" + this._prefix + "VariantBrowserGrid").bootstrapTable("destroy");
      $("#" + this._prefix + "VariantBrowserGrid").bootstrapTable({
        // url: urlQueryParams.host,
        columns: _this._columns,
        method: "get",
        sidePagination: "server",
        // Set table properties, these are read from config property
        uniqueId: "id",
        pagination: _this._config.pagination,
        pageSize: _this._config.pageSize,
        pageList: _this._config.pageList,
        showExport: _this._config.showExport,
        detailView: _this._config.detailView,
        detailFormatter: _this._config.detailFormatter,
        // this makes the opencga-variant-grid properties available in the bootstrap-table formatters
        variantGrid: _this,
        //TODO recheck query
        ajax: params => {
          if (this.pageNumber > 1) {
            skipCount = true;
          }

          const filters = opencga_variant_grid_objectSpread({
            study: this.opencgaSession.study.fqn,
            order: params.data.order,
            limit: params.data.limit,
            skip: params.data.offset || 0,
            skipCount: skipCount
          }, this.query);

          this.opencgaSession.opencgaClient.variants().query(filters).then(res => params.success(res));
        },

        /*queryParams: function(params) {
            queryParams.limit = params.limit;
            queryParams.skip = params.offset;
            return queryParams;
        },*/
        //TODO recheck
        responseHandler: function responseHandler(response) {
          if (!skipCount) {
            if (!_this.hasOwnProperty("numTotalResults")) {
              _this.numTotalResults = 0;
            }

            if (_this.numTotalResults !== response.getResponse().numTotalResults && response.queryOptions.skip === 0) {
              _this.numTotalResults = response.getResponse().numTotalResults;
            }
          } //_this.to = Math.min(response.getResponse(0).numResults, this.pageSize);


          _this.numTotalResultsText = _this.numTotalResults.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

          if (response.getParams().skip === 0 && _this.numTotalResults < response.getParams().limit) {
            _this.from = 1;
            _this.to = _this.numTotalResults;
          }

          _this.approximateCountResult = response.getResponse().approximateCount;

          _this.requestUpdate(); // it is necessary to refresh numTotalResultsText in opencga-grid-toolbar


          return {
            total: _this.numTotalResults,
            rows: response.getResults()
          };
        },
        onClickRow: function onClickRow(row, $element, field) {
          $("#" + _this._prefix + "VariantBrowserGrid tr").removeClass("success");
          $($element).addClass("success");

          _this._onSelectVariant(row);
        },
        onDblClickRow: function onDblClickRow(row, element, field) {
          // We detail view is active we expand the row automatically.
          // FIXME: Note that we use a CSS class way of knowing if the row is expand or collapse, this is not ideal but works.
          if (_this._config.detailView) {
            // TODO refactor this omg!
            if (element[0].innerHTML.includes("icon-plus")) {
              $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "VariantBrowserGrid")).bootstrapTable("expandRow", element[0].dataset.index);
            } else {
              $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "VariantBrowserGrid")).bootstrapTable("collapseRow", element[0].dataset.index);
            }
          }
        },
        onCheck: function onCheck(row, $element) {
          //                            $('.success').removeClass('success');
          //                            $($element).addClass('success');
          const _variant = row.chromosome + ":" + row.start + ":" + row.reference + ":" + row.alternate;

          _this.dispatchEvent(new CustomEvent("checkvariant", {
            detail: {
              id: _variant,
              variant: row,
              checkdVariant: true,
              variants: $("#" + _this._prefix + "VariantBrowserGrid").bootstrapTable("getAllSelections")
            }
          }));
        },
        onCheckAll: function onCheckAll(rows) {
          _this.dispatchEvent(new CustomEvent("checkvariant", {
            detail: {
              variants: $("#" + _this._prefix + "VariantBrowserGrid").bootstrapTable("getAllSelections")
            }
          }));
        },
        onUncheck: function onUncheck(row, $element) {
          //                            $('.success').removeClass('success');
          //                            $($element).addClass('success');
          const _variant = row.chromosome + ":" + row.start + ":" + row.reference + ":" + row.alternate;

          _this.dispatchEvent(new CustomEvent("checkvariant", {
            detail: {
              id: _variant,
              variant: row,
              checkdVariant: false,
              variants: $("#" + _this._prefix + "VariantBrowserGrid").bootstrapTable("getAllSelections")
            }
          }));
        },
        onLoadSuccess: function onLoadSuccess(data) {
          // The first time we mark as selected the first row that is rows[2] since the first two rows are the header
          if (_table) {
            _table[0].rows[2].setAttribute("class", "success");

            _this._onSelectVariant(data.rows[0]);

            const elementsByClassName = PolymerUtils_PolymerUtils.getElementsByClassName("genome-browser-option");

            for (const elem of elementsByClassName) {
              elem.addEventListener("click", function (e) {
                // _this.genomeBrowserPosition = e.target.dataset.variantPosition;
                _this.dispatchEvent(new CustomEvent("setgenomebrowserposition", {
                  detail: {
                    genomeBrowserPosition: e.target.dataset.variantPosition
                  },
                  bubbles: true,
                  composed: true
                }));
              });
            }
          }
        },
        onLoadError: function onLoadError(status, res) {
          console.trace();
          debugger;
        },
        onPageChange: function onPageChange(page, size) {
          _this.from = (page - 1) * size + 1;
          _this.to = page * size;
        },
        onPostBody: function onPostBody(data) {
          $("span.sampleGenotype").qtip({
            content: {
              title: "More info",
              text: function text(event, api) {
                return $(this).attr("data-text");
              }
            },
            position: {
              target: "mouse",
              adjust: {
                x: 2,
                y: 2,
                mouse: false
              }
            },
            style: {
              width: true
            },
            show: {
              delay: 200
            },
            hide: {
              fixed: true,
              delay: 300
            }
          }); // Add tooltips

          _this.variantGridFormatter.addTooltip("div.variant-tooltip", "Links");

          _this.variantGridFormatter.addTooltip("span.gene-tooltip", "Links");

          _this.variantGridFormatter.addCohortStatsInfoTooltip("cohortStatsInfoIcon", _this.populationFrequencies);

          _this.variantGridFormatter.addPopulationFrequenciesTooltip("table.populationFrequenciesTable", _this.populationFrequencies);

          _this.variantGridFormatter.addPopulationFrequenciesTooltip("table.cohortStatsTable", _this.populationFrequencies);

          _this.variantGridFormatter.addPopulationFrequenciesInfoTooltip("span.popFreqInfoIcon", _this.populationFrequencies);

          _this.variantGridFormatter.addPhenotypesInfoTooltip("phenotypesInfoIcon");
        }
      });
      $("#" + _this._prefix + "VariantBrowserGrid").bootstrapTable("showLoading");
    } // To query from cellbase, 'queryCellbase' property must be set to true explicitly


    if (typeof this.queryCellbase !== "undefined" && this.queryCellbase && this.cellbaseClient instanceof cellbase_client_CellBaseClient) {
      $("#" + this._prefix + "VariantBrowserGrid").bootstrapTable("destroy");

      let _numTotal = -1;

      let url = "";

      if (this.cellbaseClient._config.hosts[0].startsWith("https://")) {
        url = this.cellbaseClient._config.hosts[0];
      } else {
        url = "http://" + this.cellbaseClient._config.hosts[0];
      }

      const _queryParams = {
        timeout: 20000
      };
      Object.assign(_queryParams, this.query); // Important : Adding the query object contents to queryParams

      url = url + "/webservices/rest/v4/" + this.cellbaseClient._config.species + "/feature/variation/search";

      const _this = this;

      $("#" + this._prefix + "VariantBrowserGrid").bootstrapTable({
        url: url,
        method: "get",
        sidePagination: "server",
        queryParams: function queryParams(params) {
          _queryParams.limit = params.limit;
          _queryParams.skip = params.offset; //                            queryParams.summary = true;

          return _queryParams;
        },
        responseHandler: function responseHandler(res) {
          if (_numTotal === -1) {
            _numTotal = res.response[0].numTotalResults;
            _this.count = _numTotal; // updates numTotalResultsText

            _this.requestUpdate();
          }

          return {
            total: _numTotal,
            rows: res.response[0].result
          };
        },
        columns: _this.cols,
        onClickRow: function onClickRow(row, $element) {
          _this.variant = row.chromosome + ":" + row.start + ":" + row.reference + ":" + row.alternate;
          $(".success").removeClass("success");
          $($element).addClass("success");
        }
      });
      $("#" + this._prefix + "VariantBrowserGrid").bootstrapTable("showLoading");
    }
  } // TODO refactor using bootstrap table ajax


  _getUrlQueryParams() {
    /* // Check the opencgaClient exists
    if (UtilsNew.isUndefinedOrNull(this.opencgaSession.opencgaClient)) {
        return {host: "", queryParams: {}};
    }
     let host = this.opencgaSession.opencgaClient.getConfig().host;
    // By default we assume https protocol instead of http
    if (!host.startsWith("https://") && !host.startsWith("http://")) {
        host = "https://" + host;
    }
     if (typeof this.opencgaSession.project !== "undefined" && typeof this.opencgaSession.study.alias !== "undefined") {
        // if (typeof this.query === "undefined") {
        //     this.query = {};
        // }
        // if (UtilsNew.isEmpty(this.query.studies) || this.query.studies.split(new RegExp("[,;]")).length === 1) {
        //     this.query.studies = this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias;
        // }
        host += "/webservices/rest/v1/analysis/variant/query";
    } else {
        return {host: host, queryParams: {}};
    }*/
    // Init queryParams with default and config values plus query object
    let queryParams = {};

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.config) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.config.grid) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.config.grid.queryParams)) {
      queryParams = Object.assign({}, this.config.grid.queryParams, this.query);
    } else {
      queryParams = Object.assign({}, this.query);
    }

    if (this.opencgaSession.opencgaClient._config.sessionId !== undefined) {
      queryParams = Object.assign(queryParams, {
        sid: this.opencgaSession.opencgaClient._config.sessionId
      });
    }

    if (utilsNew_UtilsNew.isEmptyArray(this.samples)) {
      queryParams.summary = true; // queryParams.exclude = "annotation.geneExpression";
    } else {
      queryParams.summary = false;
      queryParams.approximateCount = true;
      queryParams.exclude = "annotation.geneExpression";
    }

    if (typeof this.config !== "undefined" && utilsNew_UtilsNew.isNotUndefinedOrNull(this.config.grid) && typeof this.config.grid.includeMissing !== "undefined" && this.config.grid.includeMissing) {
      const keys = Object.keys(queryParams);

      for (let i = 0; i < keys.length; i++) {
        let val = queryParams[keys[i]];

        if (typeof val === "string" && keys[i] !== "cohortStatsMaf" && keys[i] !== "cohortStatsAlt") {
          val = val.replace(/</g, "<<"); // val = val.replace(/>/g, ">>");

          queryParams[keys[i]] = val;
        }
      }
    }

    return queryParams;
  }

  _onSelectVariant(row) {
    if (typeof row !== "undefined") {
      const reference = row.reference !== "" ? row.reference : "-";
      const alternate = row.alternate !== "" ? row.alternate : "-";

      const _variant = row.chromosome + ":" + row.start + ":" + reference + ":" + alternate;

      this.dispatchEvent(new CustomEvent("selectvariant", {
        detail: {
          id: _variant,
          variant: row
        },
        bubbles: true,
        composed: true
      }));
    }
  }

  renderFromLocal() {
    const _this = this;

    $("#" + this._prefix + "VariantBrowserGrid").bootstrapTable("destroy");
    $("#" + this._prefix + "VariantBrowserGrid").bootstrapTable({
      data: this.data,
      columns: this.cols,
      onClickRow: function onClickRow(row, $element) {
        _this.variant = row.chromosome + ":" + row.start + ":" + row.reference + ":" + row.alternate;
        $(".success").removeClass("success");
        $($element).addClass("success");
      }
    });
  }

  showGene(geneName) {
    //                this.fire('selected', {gene: geneName});
    this.dispatchEvent(new CustomEvent("selected", {
      detail: {
        gene: geneName
      }
    }));
  }

  detailFormatter(value, row, a) {
    let result = "<div class='row' style='padding-bottom: 20px'>";
    let detailHtml = "";

    if (typeof row !== "undefined" && typeof row.annotation !== "undefined") {
      detailHtml = "<div style='padding: 10px 0px 10px 25px'><h4>Consequence Types</h4></div>";
      detailHtml += "<div style='padding: 5px 50px'>";
      detailHtml += this.variantGrid.variantGridFormatter.consequenceTypeDetailFormatter(value, row, this.variantGrid);
      detailHtml += "</div>";
      detailHtml += "<div style='padding: 20px 0px 15px 25px'><h4>Clinical Phenotypes</h4></div>";
      detailHtml += "<div style='padding: 5px 50px'>";
      let clinvarTraits = "";
      let cosmicTraits = "";

      if (typeof row.annotation.variantTraitAssociation !== "undefined" && row.annotation.variantTraitAssociation != null) {
        const traits = {
          clinvar: [],
          cosmic: []
        };
        const fields = ["clinvar", "cosmic"];

        for (const field of fields) {
          const clinicalData = row.annotation.variantTraitAssociation[field];

          if (typeof clinicalData !== "undefined" && clinicalData.length > 0) {
            for (let j = 0; j < clinicalData.length; j++) {
              if (field === "clinvar" && traits.clinvar.indexOf(clinicalData[j].traits[0]) === -1 && clinicalData[j].traits[0] !== "not specified" && clinicalData[j].traits[0] !== "not provided") {
                traits.clinvar.push(clinicalData[j].traits[0]);
              } else if (field === "cosmic" && traits.cosmic.indexOf(clinicalData[j].primaryHistology) === -1) {
                const histologySubtype = utilsNew_UtilsNew.isNotEmpty(clinicalData[j].histologySubtype) ? clinicalData[j].histologySubtype : "-";
                traits.cosmic.push(clinicalData[j].primaryHistology + " (" + histologySubtype + ")");
              }
            }
          }
        }

        if (traits.clinvar.length > 0) {
          clinvarTraits = "<div><label style='padding-right: 10px'>ClinVar: </label>" + traits.clinvar.join(", ") + "</div>";
        } else {
          clinvarTraits = "<div><label style='padding-right: 10px'>ClinVar: </label>-</div>";
        }

        if (traits.cosmic.length > 0) {
          cosmicTraits = "<div><label style='padding-right: 10px'>Cosmic: </label>" + traits.cosmic.join(", ") + "</div>";
        } else {
          cosmicTraits = "<div><label style='padding-right: 10px'>Cosmic: </label>-</div>";
        }
      }

      detailHtml += clinvarTraits + cosmicTraits;
      detailHtml += "</div>";
    }

    result += detailHtml + "</div>";
    return result;
  }

  variantFormatter(value, row, index) {
    const variantHtmlDiv = this.variantGridFormatter.variantFormatter(value, row, this._config);
    return variantHtmlDiv;
  } // TODO refactor this to make it more clear (polyphenProteinScoreFormatter too)


  siftPproteinScoreFormatter(value, row, index) {
    let min = 10;
    const description = {};

    if (typeof row !== "undefined" && typeof row.annotation !== "undefined") {
      if (typeof row.annotation !== "undefined" && typeof row.annotation.consequenceTypes !== "undefined") {
        for (let i = 0; i < row.annotation.consequenceTypes.length; i++) {
          if (typeof row.annotation.consequenceTypes[i].proteinVariantAnnotation !== "undefined" && typeof row.annotation.consequenceTypes[i].proteinVariantAnnotation.substitutionScores !== "undefined") {
            for (let j = 0; j < row.annotation.consequenceTypes[i].proteinVariantAnnotation.substitutionScores.length; j++) {
              if (row.annotation.consequenceTypes[i].proteinVariantAnnotation.substitutionScores[j].source === "sift") {
                if (row.annotation.consequenceTypes[i].proteinVariantAnnotation.substitutionScores[j].score < min) {
                  min = row.annotation.consequenceTypes[i].proteinVariantAnnotation.substitutionScores[j].score;
                  description.sift = row.annotation.consequenceTypes[i].proteinVariantAnnotation.substitutionScores[j].description;
                }
              }
            }
          }
        }
      }
    }

    if (min !== 10) {
      return "<span style=\"color: " + this.pssColor.get(description.sift) + "\" title=\"" + min + "\">" + description.sift + "</span>";
    }

    return "-";
  }

  polyphenProteinScoreFormatter(value, row, index) {
    let max = 0;
    const description = {};

    if (typeof row !== "undefined" && typeof row.annotation !== "undefined") {
      if (typeof row.annotation !== "undefined" && typeof row.annotation.consequenceTypes !== "undefined") {
        for (let i = 0; i < row.annotation.consequenceTypes.length; i++) {
          if (typeof row.annotation.consequenceTypes[i].proteinVariantAnnotation !== "undefined" && typeof row.annotation.consequenceTypes[i].proteinVariantAnnotation.substitutionScores !== "undefined") {
            for (let j = 0; j < row.annotation.consequenceTypes[i].proteinVariantAnnotation.substitutionScores.length; j++) {
              if (row.annotation.consequenceTypes[i].proteinVariantAnnotation.substitutionScores[j].source === "polyphen") {
                if (row.annotation.consequenceTypes[i].proteinVariantAnnotation.substitutionScores[j].score >= max) {
                  max = row.annotation.consequenceTypes[i].proteinVariantAnnotation.substitutionScores[j].score;
                  description.polyphen = row.annotation.consequenceTypes[i].proteinVariantAnnotation.substitutionScores[j].description;
                }
              }
            }
          }
        }
      }
    }

    if (max >= 0 && utilsNew_UtilsNew.isNotUndefinedOrNull(description) && utilsNew_UtilsNew.isNotUndefinedOrNull(description.polyphen)) {
      let str = description.polyphen;

      if (str.indexOf(" ") >= 0) {
        str = str.replace(/\s(.)/g, function ($1) {
          return $1.toUpperCase();
        }).replace(/\s/g, "").replace(/^(.)/, function ($1) {
          return $1.toLowerCase();
        });
      }

      return "<span style=\"color: " + this.pssColor.get(str) + "\" title=\"" + max + "\">" + description.polyphen + "</span>";
    }

    return "-";
  }

  caddScaledFormatter(value, row, index) {
    if (typeof row !== "undefined" && typeof row.annotation !== "undefined" && typeof row.annotation.functionalScore !== "undefined") {
      for (let i = 0; i < row.annotation.functionalScore.length; i++) {
        if (typeof row.annotation.functionalScore[i] !== "undefined" && row.annotation.functionalScore[i].source === "cadd_scaled" && row.type !== "INDEL") {
          const value = Number(row.annotation.functionalScore[i].score).toFixed(2);

          if (value < 15) {
            return value;
          } else {
            return "<span style=\"color: red\">" + value + "</span>";
          }
        }
      }
    }

    return "-";
  }

  conservationFormatter(value, row, index) {
    if (typeof row !== "undefined" && typeof row.annotation !== "undefined" && typeof row.annotation.conservation !== "undefined") {
      for (let i = 0; i < row.annotation.conservation.length; i++) {
        if (row.annotation.conservation[i].source === this.field) {
          return Number(row.annotation.conservation[i].score).toFixed(3);
        }
      }
    }

    return "-";
  }

  cohortFormatter(value, row, index) {
    if (typeof row !== "undefined" && typeof row.studies !== "undefined" && typeof row.studies[0].stats !== "undefined") {
      const cohortStats = new Map();

      for (const study of row.studies) {
        if (study.studyId === this.field.study) {
          for (const cohortId in study.stats) {
            const cohortStat = study.stats[cohortId];
            cohortStats.set(cohortId, Number(cohortStat.maf).toFixed(4));
          }

          break;
        }
      }

      return this.field.context.variantGridFormatter.createCohortStatsTable(this.field.cohorts, cohortStats, this.field.context.populationFrequencies.color);
    } else {
      return "-";
    }
  }

  populationFrequenciesFormatter(value, row, index) {
    if (typeof row !== "undefined" && typeof row.annotation !== "undefined" && typeof row.annotation.populationFrequencies !== "undefined") {
      const popFreqMap = new Map();

      for (const popFreqIdx in row.annotation.populationFrequencies) {
        const popFreq = row.annotation.populationFrequencies[popFreqIdx];

        if (this.field.study === popFreq.study) {
          // && this.field.populationMap[popFreq.population] === true
          popFreqMap.set(popFreq.population, Number(popFreq.altAlleleFreq).toFixed(4));
        }
      }

      return this.field.context.variantGridFormatter.createPopulationFrequenciesTable(this.field.populations, popFreqMap, this.field.context.populationFrequencies.color);
    } else {
      return "-";
    }
  }

  clinicalPhenotypeFormatter(value, row, index) {
    let phenotypeHtml = "<span><i class='fa fa-times' style='color: red'></i></span>";

    if (typeof row !== "undefined" && typeof row.annotation !== "undefined" && typeof row.annotation.variantTraitAssociation !== "undefined") {
      if (row.annotation.variantTraitAssociation != null) {
        const traits = [];
        const clinicalData = row.annotation.variantTraitAssociation[this.field];

        if (typeof clinicalData !== "undefined" && clinicalData.length > 0) {
          for (let j = 0; j < clinicalData.length; j++) {
            if (this.field === "clinvar" && traits.indexOf(clinicalData[j].traits[0]) === -1 && clinicalData[j].traits[0] !== "not specified" && clinicalData[j].traits[0] !== "not provided") {
              traits.push(clinicalData[j].traits[0]);
            } else if (this.field === "cosmic" && traits.indexOf(clinicalData[j].primaryHistology) === -1) {
              traits.push(clinicalData[j].primaryHistology);
            }
          }

          if (traits.length > 0) {
            let traitText = traits[0];

            if (traits.length > 1) {
              traitText += ", ...";
            }

            phenotypeHtml = "<span data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"".concat(traitText, "\"><i class='fa fa-check' style='color: green'></i></span>");
          }
        }
      }
    }

    return phenotypeHtml;
  }

  sampleFormatter(value, row, index) {
    let res = "-";

    if (typeof row !== "undefined" && typeof row.studies !== "undefined" && row.studies.length > 0) {
      // NOTE: There are always 4 columns before the samples
      // This context is for row
      if (this.nucleotideGenotype) {
        const alternateSequence = row.alternate;
        const referenceSequence = row.reference;
        const genotypeMatch = new Map();
        let colText = "";
        let referenceValueColText = "-";
        let alternateValueColText = "-";
        genotypeMatch.set(0, referenceSequence === "" ? "-" : referenceSequence);
        genotypeMatch.set(1, alternateSequence === "" ? "-" : alternateSequence);
        row.studies.forEach(study => {
          if (utilsNew_UtilsNew.isNotUndefinedOrNull(study.secondaryAlternates) && utilsNew_UtilsNew.isNotEmptyArray(study.secondaryAlternates)) {
            study.secondaryAlternates.forEach(secondary => {
              genotypeMatch.set(genotypeMatch.size, secondary.alternate === "" ? "-" : secondary.alternate);
            });
          }

          if (utilsNew_UtilsNew.isNotUndefinedOrNull(study.samplesData) && utilsNew_UtilsNew.isNotEmptyArray(study.samplesData)) {
            if (utilsNew_UtilsNew.isNotUndefinedOrNull(study.samplesData[this.fieldIndex - 4])) {
              const currentGenotype = study.samplesData[this.fieldIndex - 4][0];
              let reference = currentGenotype.split("/")[0];
              let alternate = currentGenotype.split("/")[1];
              let tooltipText = reference + " / " + alternate;

              if (utilsNew_UtilsNew.isNotEqual(reference, ".") && utilsNew_UtilsNew.isNotEqual(alternate, ".")) {
                reference = parseInt(reference);
                alternate = parseInt(alternate);
                const referenceValue = genotypeMatch.get(reference);
                const alternateValue = genotypeMatch.get(alternate); // Cases which this will cover.
                // referenceValue.length <= 5 && alternateVAlue.length <= 5
                // referenceValue.length <= 10 && alternateValue == "-"
                // alternateValue.length <= 10 && referenceValue == "-"

                referenceValueColText = referenceValue;
                alternateValueColText = alternateValue; // Not equal X/- or -/X

                if (utilsNew_UtilsNew.isNotEqual(referenceValue, "-") && utilsNew_UtilsNew.isNotEqual(alternateValue, "-")) {
                  if (referenceValue.length <= 5 && alternateValue.length > 5 || referenceValue.length > 5 && alternateValue.length <= 5) {
                    if (referenceValue.length > 5) {
                      // referenceValue > 5
                      referenceValueColText = referenceValue.substring(0, 3) + "..."; //                                                    tooltipText += "<br>" + referenceValue +" / " + alternateValue;
                    } else {
                      // alternateValue > 5
                      alternateValueColText = alternateValue.substring(0, 3) + "..."; //                                                    tooltipText += "<br>" + referenceValue +" / " + alternateValue;
                    }
                  } else if (referenceValue.length > 5 && alternateValue.length > 5) {
                    // Both > 5 It will never happen
                    referenceValueColText = referenceValue.substring(0, 3) + "...";
                    alternateValueColText = alternateValue.substring(0, 3) + "..."; //                                                tooltipText += "<br>" +   referenceValue +" / " + alternateValue;
                  }
                } else if (utilsNew_UtilsNew.isNotEqual(referenceValue, "-") && referenceValue.length > 10) {
                  // X/-
                  const substringReference = referenceValue.substring(0, 5) + "...";
                  referenceValueColText = substringReference;
                  alternateValueColText = "-"; //                                                tooltipText += "<br>" +   referenceValue +" / " + alternateValue;
                } else if (utilsNew_UtilsNew.isNotEqual(alternateValue, "-") && alternateValue.length > 10) {
                  // -/X
                  const substringAlternate = alternateValue.substring(0, 5) + "...";
                  alternateValueColText = substringAlternate;
                  referenceValueColText = "-"; //                                                tooltipText += "<br>" +   referenceValue + " / " + alternateValue;
                }

                tooltipText += "<br>" + referenceValue + " / " + alternateValue;
              } else {
                referenceValueColText = reference;
                alternateValueColText = alternate;
                tooltipText += "<br>" + reference + " / " + alternate;
              }

              const referenceIndex = parseInt(reference);
              const alternateIndex = parseInt(alternate);

              if (referenceIndex === 1 && referenceValueColText !== "-" && referenceValueColText !== "*") {
                referenceValueColText = "<span class='orangeText'>" + referenceValueColText + "</span>";
              } else if (referenceIndex > 1 && referenceValueColText !== "-" && referenceValueColText !== "*") {
                referenceValueColText = "<span class='redText'>" + referenceValueColText + "</span>";
              }

              if (alternateIndex === 1 && alternateValueColText !== "-" && alternateValueColText !== "*") {
                alternateValueColText = "<span class='orangeText'>" + alternateValueColText + "</span>";
              } else if (alternateIndex > 1 && alternateValueColText !== "-" && alternateValueColText !== "*") {
                alternateValueColText = "<span class='redText'>" + alternateValueColText + "</span>";
              }

              colText = referenceValueColText + " / " + alternateValueColText;
              res = "<span class='sampleGenotype' data-text='" + tooltipText + "'> " + colText + " </span>";
              return;
            }
          }
        });
      } else {
        row.studies.forEach(study => {
          if (study.samplesData.length > 0) {
            const currentGenotype = study.samplesData[this.fieldIndex - 4];

            if (utilsNew_UtilsNew.isNotUndefinedOrNull(currentGenotype)) {
              res = currentGenotype[0];
              return;
            }
          }
        });
      }
    }

    return res;
  }

  _createDefaultColumns() {
    if (this.variantGridFormatter === undefined) {
      return;
    }

    this._columns = [[{
      title: "Variant",
      field: "id",
      rowspan: 2,
      colspan: 1,
      formatter: this.variantFormatter.bind(this),
      halign: "center"
    }, {
      title: "dbSNP Id",
      field: "dbSNP",
      rowspan: 2,
      colspan: 1,
      formatter: this.variantGridFormatter.snpFormatter.bind(this),
      halign: "center"
    }, {
      title: "Gene",
      field: "gene",
      rowspan: 2,
      colspan: 1,
      formatter: this.variantGridFormatter.geneFormatter.bind(this),
      halign: "center"
    }, {
      title: "Type",
      field: "type",
      rowspan: 2,
      colspan: 1,
      formatter: this.variantGridFormatter.typeFormatter.bind(this),
      halign: "center"
    }, {
      title: "Consequence Type",
      field: "consequenceType",
      rowspan: 2,
      colspan: 1,
      formatter: this.variantGridFormatter.consequenceTypeFormatter.bind(this),
      halign: "center"
    }, {
      title: "Deleteriousness <a data-toggle=\"tooltip\" title=\"SIFT scores are classified into tolerated and deleterious. " + "Polyphen scores are classified into benign, possibly damaging, probably damaging and possibly & probably damaging. " + "Please, leave the cursor over each tag to visualize the actual score value. " + "SIFT score takes values in the range [0, infinite[, the lower the values, the more damaging the prediction. " + "Polyphen score takes values in the range [0, 1[, the closer to 2, the more damaging the prediction.\">" + "<i class=\"fa fa-info-circle\" aria-hidden=\"true\"></i></a>",
      field: "deleteriousness",
      rowspan: 1,
      colspan: 3,
      align: "center"
    }, {
      title: "Conservation  <a data-toggle=\"tooltip\" title=\"Positive PhyloP scores measure conservation which is slower evolution than expected, at sites that are predicted to be conserved. Negative PhyloP scores measure acceleration, which is faster evolution than expected, at sites that are predicted to be fast-evolving. Absolute values of phyloP scores represent -log p-values under a null hypothesis of neutral evolution. The phastCons scores represent probabilities of negative selection and range between 0 and 1. Positive GERP scores represent a substitution deficit and thus indicate that a site may be under evolutionary constraint. Negative scores indicate that a site is probably evolving neutrally. Some authors suggest that a score threshold of 2 provides high sensitivity while still strongly enriching for truly constrained sites\"><i class=\"fa fa-info-circle\" aria-hidden=\"true\"></i></a>",
      field: "Conservation",
      rowspan: 1,
      colspan: 3,
      align: "center"
    }, {
      title: "Phenotypes <span id=\"phenotypesInfoIcon\"><i class=\"fa fa-info-circle\" style=\"color: #337ab7\" aria-hidden=\"true\"></i></span>",
      field: "phenotypes",
      rowspan: 1,
      colspan: 2,
      align: "center"
    }], [{
      title: "SIFT",
      field: "sift",
      colspan: 1,
      rowspan: 1,
      formatter: this.siftPproteinScoreFormatter.bind(this),
      halign: "center"
    }, {
      title: "Polyphen",
      field: "polyphen",
      colspan: 1,
      rowspan: 1,
      formatter: this.polyphenProteinScoreFormatter.bind(this),
      halign: "center"
    }, {
      title: "CADD",
      field: "cadd",
      colspan: 1,
      rowspan: 1,
      formatter: this.caddScaledFormatter,
      align: "right",
      halign: "center"
    }, {
      title: "PhyloP",
      field: "phylop",
      colspan: 1,
      rowspan: 1,
      formatter: this.conservationFormatter,
      align: "right",
      halign: "center"
    }, {
      title: "PhastCons",
      field: "phastCons",
      colspan: 1,
      rowspan: 1,
      formatter: this.conservationFormatter,
      align: "right",
      halign: "center"
    }, {
      title: "GERP",
      field: "gerp",
      colspan: 1,
      rowspan: 1,
      formatter: this.conservationFormatter,
      align: "right",
      halign: "center"
    }, {
      title: "ClinVar",
      field: "clinvar",
      colspan: 1,
      rowspan: 1,
      formatter: this.clinicalPhenotypeFormatter,
      align: "center"
    }, {
      title: "Cosmic",
      field: "cosmic",
      colspan: 1,
      rowspan: 1,
      formatter: this.clinicalPhenotypeFormatter,
      align: "center"
    }]]; // update columns dynamically

    this._updateTableColumns();

    return this._columns;
  }

  _updateTableColumns() {
    // add last checkbox column
    if (this._config.showSelectCheckbox) {
      this._columns[1].push({
        field: "stateCheckBox",
        checkbox: true,
        rowspan: 1,
        colspan: 1
      });
    }

    let isCohortPresent = false; // if (typeof this._columns !== "undefined" && typeof this.cohorts !== "undefined" && Object.keys(this.cohorts).length > 0
    //     && this.config.filter.menu.skipSubsections !== undefined && !this.config.filter.menu.skipSubsections.includes("cohort")) {

    if (typeof this._columns !== "undefined" && typeof this.cohorts !== "undefined" && Object.keys(this.cohorts).length > 0 && typeof this.cohorts[this.opencgaSession.project.id] !== "undefined") {
      isCohortPresent = true;
      const cohortStudyIdx = 7;
      const cohortIdx = 6;
      const cohortStudies = Object.keys(this.cohorts[this.opencgaSession.project.id]);

      this._columns[0].splice(cohortStudyIdx, 0, {
        // title: this.opencgaSession.project.name,
        title: "Cohort Stats <span id=\"cohortStatsInfoIcon\"><i class=\"fa fa-info-circle\" style=\"color: #337ab7\" aria-hidden=\"true\"></i></span>",
        field: "cohorts",
        rowspan: 1,
        colspan: cohortStudies.length,
        align: "center"
      });

      for (let i = 0; i < cohortStudies.length; i++) {
        this._columns[1].splice(i + cohortIdx, 0, {
          title: cohortStudies[i],
          field: {
            study: cohortStudies[i],
            cohorts: this.cohorts[this.opencgaSession.project.id][cohortStudies[i]],
            colors: this.populationFrequencies.color,
            context: this
          },
          rowspan: 1,
          colspan: 1,
          formatter: this.cohortFormatter,
          align: "center"
        });
      }
    }

    if (typeof this.populationFrequencies !== "undefined" && typeof this.populationFrequencies.studies !== "undefined" && this.populationFrequencies.studies.length > 0) {
      const popIdx = isCohortPresent ? 8 : 7;
      const subPopIdx = isCohortPresent ? 6 + Object.keys(this.cohorts[this.opencgaSession.project.id]).length : 6; // Just one column called 'Population Frequencies'

      this._columns[0].splice(popIdx, 0, {
        title: "Population Frequencies <span class=\"popFreqInfoIcon\"><i class=\"fa fa-info-circle\" style=\"color: #337ab7\" aria-hidden=\"true\"></i></span>",
        field: "",
        rowspan: 1,
        colspan: this.populationFrequencies.studies.length,
        align: "center"
      });

      for (let j = 0; j < this.populationFrequencies.studies.length; j++) {
        const populations = [];
        const populationMap = {};

        for (const pop in this.populationFrequencies.studies[j].populations) {
          populations.push(this.populationFrequencies.studies[j].populations[pop].id);
          populationMap[this.populationFrequencies.studies[j].populations[pop].id] = true;
        }

        this._columns[1].splice(j + subPopIdx, 0, {
          title: this.populationFrequencies.studies[j].title,
          field: {
            study: this.populationFrequencies.studies[j].id,
            populations: populations,
            populationMap: populationMap,
            colors: this.populationFrequencies.color,
            context: this
          },
          rowspan: 1,
          colspan: 1,
          formatter: this.populationFrequenciesFormatter,
          align: "center"
        });
      }
    }

    if (typeof this._columns !== "undefined" && typeof this.samples !== "undefined" && this.samples.length > 0) {
      this._columns[0].splice(4, 0, {
        title: "Samples",
        field: "samples",
        rowspan: 1,
        colspan: this.samples.length,
        align: "center"
      });

      for (let i = 0; i < this.samples.length; i++) {
        this._columns[1].splice(i, 0, {
          title: this.samples[i].id,
          field: "samples",
          rowspan: 1,
          colspan: 1,
          formatter: this.sampleFormatter,
          align: "center",
          nucleotideGenotype: true
        });
      }
    }
  }

  onDownload(e) {
    const params = this._getUrlQueryParams();

    params.limit = 1; // Default limit is 1000 for now

    this.downloadRefreshIcon.css("display", "inline-block");
    this.downloadIcon.css("display", "none");

    const _this = this;

    this.opencgaSession.opencgaClient.variants().query(params).then(function (response) {
      const result = response.response[0].result;
      let dataString = [];
      let mimeType = "";
      let extension = ""; // Check if user clicked in Tab or JSON format

      if (e.detail.option.toLowerCase() === "tab") {
        dataString = variant_utils_VariantUtils.jsonToTabConvert(result, _this.populationFrequencies.studies, _this.samples, _this._config.nucleotideGenotype);
        mimeType = "text/plain";
        extension = ".txt";
      } else {
        for (const res of result) {
          dataString.push(JSON.stringify(res));
        }

        mimeType = "application/json";
        extension = ".json";
      } // Build file and anchor link


      const data = new Blob([dataString.join("\n")], {
        type: mimeType
      });
      const file = window.URL.createObjectURL(data);
      const a = document.createElement("a");
      a.href = file;
      a.download = _this.opencgaSession.study.alias + extension;
      document.body.appendChild(a);
      a.click();
      setTimeout(function () {
        document.body.removeChild(a);
      }, 0);
    }).then(function () {
      _this.downloadRefreshIcon.css("display", "none");

      _this.downloadIcon.css("display", "inline-block");
    });
  }
  /* onShare() {
      let _this = this;
      $("[data-toggle=popover]").popover({
          content: function() {
              let getUrlQueryParams = _this._getUrlQueryParams();
              let query = ["limit=1000"];
              for (let key in getUrlQueryParams.queryParams) {
                  // Check sid has a proper value. For public projects sid is undefined. In that case, sid must be removed from the url
                  if (key === "sid" && getUrlQueryParams.queryParams[key] === undefined) {
                      delete getUrlQueryParams.queryParams["sid"];
                  } else {
                      query.push(key + "=" + getUrlQueryParams.queryParams[key]);
                  }
              }
              return getUrlQueryParams.host + "?" + query.join("&");
          }
      }).on("show.bs.popover", function() {
          $(this).data("bs.popover").tip().css("max-width", "none");
      });
  }*/


  getDefaultConfig() {
    return {
      pagination: true,
      pageSize: 10,
      pageList: [10, 25, 50],
      showExport: false,
      detailView: true,
      detailFormatter: this.detailFormatter,
      showSelectCheckbox: false,
      multiSelection: false,
      nucleotideGenotype: true,
      alleleStringLengthMax: 15,
      header: {
        horizontalAlign: "center",
        verticalAlign: "bottom"
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_variant_grid_templateObject(), this.from, this.to, this.numTotalResultsText, this.toolbarConfig, this.onColumnChange, this.onDownload, this.onShare, this._prefix, this._prefix);
  }

}
customElements.define("opencga-variant-grid", opencga_variant_grid_OpencgaVariantGrid);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/opencga-variant-browser.js
function opencga_variant_browser_templateObject3() {
  const data = opencga_variant_browser_taggedTemplateLiteral(["\n                <h3 class=\"text-center\">No public projects available to browse. Please login to continue</h3>\n        "]);

  opencga_variant_browser_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_variant_browser_templateObject2() {
  const data = opencga_variant_browser_taggedTemplateLiteral(["\n            <div class=\"page-title\">\n                <h2>\n                    <i class=\"fa fa-bars\" aria-hidden=\"true\"></i> </i>&nbsp;", "\n                </h2>\n            </div>\n\n            <div class=\"row\">\n                <div id=\"", "FilterMenu\" class=\"col-md-2\">\n                    <opencga-variant-filter .opencgaSession=\"", "\"\n                                            .query=\"", "\"\n                                            .cohorts=\"", "\"\n                                            .cellbaseClient=\"", "\"\n                                            .populationFrequencies=\"", "\"\n                                            .consequenceTypes=\"", "\"\n                                            .config=\"", "\"\n                                            @queryChange=\"", "\"\n                                            @querySearch=\"", "\"\n                                            @samplechange=\"", "\">\n                    </opencga-variant-filter>\n                </div>\n                \n                <div id=\"", "MainWindow\" class=\"col-md-10\">\n                   \n                    <opencga-active-filters .opencgaSession=\"", "\"\n                                            .defaultStudy=\"", "\"\n                                            .query=\"", "\"\n                                            .refresh=\"", "\"\n                                            .filters=\"", "\"\n                                            .alias=\"", "\"\n                                            .config=\"", "\"\n                                            filterBioformat=\"VARIANT\"\n                                            @activeFilterChange=\"", "\"\n                                            @activeFilterClear=\"", "\">\n                    </opencga-active-filters>\n                    \n                    <div class=\"col-md-12\" style=\"padding: 5px 0px 5px 0px\">\n                        <div class=\"btn-toolbar\" role=\"toolbar\" aria-label=\"...\" style=\"padding: 10px 0px;margin-left: 0px\">\n                            <div id=\"", "LeftToolbar\" style=\"padding-bottom: 0px\">\n                                <div class=\"btn-group\" role=\"group\">\n                                    <button type=\"button\" class=\"btn btn-success variant-browser-view-buttons active ripple\"\n                                            data-view=\"TableResult\" @click=\"", "\">\n                                        <i class=\"fa fa-table icon-padding\" aria-hidden=\"true\" data-view=\"TableResult\"\n                                           @click=\"", "\"></i> Table Result\n                                    </button>\n                                    <button type=\"button\" class=\"btn btn-success variant-browser-view-buttons ripple\" data-view=\"Summary\"\n                                            @click=\"", "\">\n                                        <i class=\"fas fa-chart-bar icon-padding\" aria-hidden=\"true\" data-view=\"Summary\"\n                                           @click=\"", "\"></i> Summary Stats\n                                    </button>\n                                    <!--<template is=\"dom-if\" if=\"{{config.showGenomeBrowser}}\">-->\n                                    <!--<button id=\"{{prefix}}GenomeBrowserButton\" type=\"button\" class=\"btn btn-success variant-browser-view-buttons\" data-view=\"GenomeBrowser\" on-click=\"_changeView\">-->\n                                    <!--<i class=\"fa fa-list-alt icon-padding\" aria-hidden=\"true\" data-view=\"GenomeBrowser\" on-click=\"_changeView\"></i> Genome Browser (Beta)-->\n                                    <!--</button>-->\n                                    <!--</template>-->\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n            \n                    <div>\n                        <!-- First TAB -->\n                        <div id=\"", "TableResult\" class=\"variant-browser-content\">\n                            <!-- Variant Browser Grid -->\n            \n                            <opencga-variant-grid .opencgaSession=\"", "\"\n                                                  .query=\"", "\"\n                                                  .cohorts=\"", "\"\n                                                  .cellbaseClient=\"", "\"\n                                                  .populationFrequencies=\"", "\"\n                                                  .active=\"", "\" \n                                                  .proteinSubstitutionScores=\"", "\"\n                                                  .consequenceTypes=\"", "\"\n                                                  .config=\"", "\"\n                                                  @selected=\"", "\"\n                                                  @selectvariant=\"", "\"\n                                                  @setgenomebrowserposition=\"", "\">\n                            </opencga-variant-grid>\n            \n            \n                            <!-- Bottom tabs with specific variant information -->\n                            <opencga-variant-detail-view    .opencgaSession=\"", "\" \n                                                            .cellbaseClient=\"", "\"\n                                                            .variantId=\"", "\">\n                            </opencga-variant-detail-view>\n                                        \n                        </div>\n            \n                        <!-- Second TAB -->\n                        <div id=\"", "Summary\" class=\"variant-browser-content\" style=\"display: none; padding: 0px 15px\">\n                            <opencga-variant-facet-query .opencgaSession=\"", "\"\n                                                         .cellbaseClient=\"", "\"\n                                                         .populationFrequencies=\"", "\"\n                                                         .query=\"", "\"\n                                                         .active=\"", "\">\n                            </opencga-variant-facet-query>\n                        </div>\n            \n                        <!-- Third TAB -->\n                        <div id=\"", "GenomeBrowser\" class=\"variant-browser-content\" style=\"display: none\">\n                            <br>\n                            <br>\n                            <opencga-genome-browser .opencgaSession=\"", "\"\n                                                    .opencgaClient=\"", "\"\n                                                    .cellbaseClient=\"", "\"\n                                                    .query=", "\n                                                    .search=", "\n                                                    .species=", "\n                                                    .region=\"", "\"\n                                                    .active=\"", "\"\n                                                    .fullScreen=\"", "\"\n                                                    .config=\"", "\">\n                            </opencga-genome-browser>\n                        </div>\n                    </div>\n            \n                    <div class=\"modal fade\" id=\"", "LoadingModal\" data-backdrop=\"static\" data-keyboard=\"false\"\n                         tabindex=\"-1\"\n                         role=\"dialog\" aria-hidden=\"true\" style=\"padding-top:15%; overflow-y:visible;\">\n                        <div class=\"modal-dialog\">\n                            <div class=\"modal-content\">\n                                <div class=\"modal-header\">\n                                    <h3>Loading...</h3>\n                                </div>\n                                <div class=\"modal-body\">\n                                    <div class=\"progress progress-striped active\">\n                                        <div class=\"progress-bar progress-bar-success\" style=\"width: 100%\"></div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div> \n            </div>\n        "]);

  opencga_variant_browser_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_variant_browser_templateObject() {
  const data = opencga_variant_browser_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .browser-center {\n                margin: auto;\n                text-align: justify;\n                width: 95%;\n            }\n\n            .browser-variant-tab-title {\n                font-size: 115%;\n                font-weight: bold;\n            }\n\n            th {\n                text-align: center\n            }\n\n            .icon-padding {\n                padding-left: 4px;\n                padding-right: 5px;\n            }\n        </style>\n        \n        ", "\n"]);

  opencga_variant_browser_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_variant_browser_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_variant_browser_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_variant_browser_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_variant_browser_ownKeys(Object(source), true).forEach(function (key) { opencga_variant_browser_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_variant_browser_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_variant_browser_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


 // import "./opencga-variant-cohort-stats.js";
// import "./opencga-variant-samples.js";

 // import "./variant-beacon-network.js";



 // import "../reactome/reactome-variant-network.js";
// import "./annotation/cellbase-variantannotation-view.js";


 // import "./opencga-variant-detail-template.js";


class opencga_variant_browser_OpencgaVariantBrowser extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      reactomeClient: {
        type: Object
      },
      query: {
        type: Object
      },
      samples: {
        type: Array
      },
      cellbaseClient: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      config: {
        type: Object
      },
      //FIXME temp solution
      preparedQuery: {
        type: Object
      } // executedQuery: {
      //     type: Object
      // },

      /* TODO recheck if can be removed
      detailActiveTabs: {
          type: Array
      },
      checkProjects: {
          type: Boolean
      }
       */

    };
  } // static get observers() {
  //     /*
  //      * We do not need to Observer 'query' property, when passed it will be shared (bound) with the other components.
  //      * 'search; is observed to ensure 'query' is in sync.
  //      */
  //     return [
  //         "propertyObserver(opencgaSession)"
  //     ];
  // }


  updated(changedProperties) {
    if (changedProperties.has("opencgaSession")) {
      this.opencgaSessionObserver();
    }

    if (changedProperties.has("query")) {
      this.queryObserver();
    }
  }

  _init() {
    this._prefix = "ovb-" + utils.randomString(6) + "_";
    this.checkProjects = false;
    this._collapsed = false;
    this.genotypeColor = {
      "0/0": "#6698FF",
      "0/1": "#FFA500",
      "1/1": "#FF0000",
      "./.": "#000000",
      "0|0": "#6698FF",
      "0|1": "#FFA500",
      "1|0": "#FFA500",
      "1|1": "#FF0000",
      ".|.": "#000000"
    };
    this.variantId = "No variant selected";
    this._sessionInitialised = false;
    this._config = this.getDefaultConfig();
    this.detailActiveTabs = []; // this.query = {};
    //run the observer the first time
    //this.opencgaSessionObserver();
    //this.queryObserver();
    // this.requestUpdate();
  }

  opencgaSessionObserver() {
    // With each property change we must updated config and create the columns again. No extra checks are needed.
    this._config = opencga_variant_browser_objectSpread({}, this.getDefaultConfig(), {}, this.config); // Check if Beacon hosts are configured

    for (let detail of this._config.detail) {
      if (detail.id === "beacon" && utilsNew_UtilsNew.isNotEmptyArray(detail.hosts)) {
        this.beaconConfig = {
          hosts: detail.hosts
        };
      }
    } // Update cohorts from config, this updates the Cohort filter MAF


    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.project)) {
      for (let section of this._config.filter.menu.sections) {
        for (let subsection of section.subsections) {
          if (subsection.id === "cohort") {
            this.cohorts = subsection.cohorts;
          }
        }
      }

      if (this._sessionInitialised) {
        // We reset the query object when the session is changed
        this.query = {
          study: this.opencgaSession.study.fqn
        };
      } else {
        this.query = opencga_variant_browser_objectSpread({}, this.query);
      }

      this.checkProjects = true;
    } else {
      this.checkProjects = false;
    }

    this._sessionInitialised = true;
  } // TODO NOTE changing an active Filter, queryObserver is used to update executedQuery and consequently the table in variant-grid.
  // Maybe the whole query process can be simplified, onActiveFilterChange and onActiveFilterClear can edit executedQuery directly


  queryObserver() {
    // Query passed is executed and set to variant-filter, active-filters and variant-grid components
    let _query = {};

    if (utilsNew_UtilsNew.isEmpty(this.query) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.study)) {
      _query = {
        study: this.opencgaSession.study.fqn
      };
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query)) {
      this.preparedQuery = Object.assign({}, _query, this.query);
      this.executedQuery = Object.assign({}, _query, this.query);
    } // onServerFilterChange() in opencga-active-filters drops a filterchange event when the Filter dropdown is used


    this.dispatchEvent(new CustomEvent("queryChange", {
      detail: this.preparedQuery
    }));
    this.requestUpdate();
  }

  onCollapse() {
    if (this._collapsed) {
      $("#" + this._prefix + "FilterMenu").show(400);
      $("#" + this._prefix + "MainWindow").removeClass("browser-center").addClass("col-md-10");
    } else {
      $("#" + this._prefix + "FilterMenu").hide(400);
      $("#" + this._prefix + "MainWindow").removeClass("col-md-10").addClass("browser-center");
    }

    this._collapsed = !this._collapsed;
  }
  /*
   * Variant Filter component listeners
   */


  onQueryFilterChange(e) {
    console.log("onQueryFilterChange on variant browser", e.detail.query);
    this.preparedQuery = e.detail.query;
    this.requestUpdate();
  }

  onQueryFilterSearch(e) {
    this.preparedQuery = e.detail.query;
    this.executedQuery = e.detail.query;
    this.requestUpdate();
  }
  /*
   * Active Filters component listeners
   */


  onActiveFilterChange(e) {
    console.log("onActiveFilterChange on variant browser", e.detail); //TODO FIXME!! study prop have to be wiped off! use studies instead

    this.preparedQuery = opencga_variant_browser_objectSpread({
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias
    }, e.detail);
    this.query = opencga_variant_browser_objectSpread({
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias
    }, e.detail);
    this.requestUpdate();
  } //it was called onClear


  onActiveFilterClear() {
    console.log("onActiveFilterClear");
    this.query = {
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias
    };
    this.preparedQuery = opencga_variant_browser_objectSpread({}, this.query); //TODO quick fix to update
  }

  onSampleChange(e) {
    this.samples = e.detail.samples;
    this.dispatchEvent(new CustomEvent("samplechange", {
      detail: {
        samples: this.samples
      },
      bubbles: true,
      composed: true
    }));
  }

  _changeBottomTab(e) {
    let _activeTabs = {};

    for (let detail of this.config.detail) {
      _activeTabs[detail.id] = detail.id === e.currentTarget.dataset.id;
    }

    this.detailActiveTabs = _activeTabs;
    this.requestUpdate();
  }

  onGenomeBrowserPositionChange(e) {
    $(".variant-browser-content").hide(); // hides all content divs
    // Show genome browser div

    PolymerUtils.getElementById(this._prefix + "GenomeBrowser").style.display = "block"; // Show the active button

    $(".variant-browser-view-buttons").removeClass("active");
    PolymerUtils.addClass(this._prefix + "GenomeBrowserButton", "active");
    this._genomeBrowserActive = true;
    this.region = e.detail.genomeBrowserPosition;
  }

  checkVariant(variant) {
    return variant.split(":").length > 2;
  }

  onSelectVariant(e) {
    this.variantId = e.detail.id;
    this.variant = e.detail.variant;
    let genes = [];

    for (let i = 0; i < e.detail.variant.annotation.consequenceTypes.length; i++) {
      let gene = e.detail.variant.annotation.consequenceTypes[i].geneName;

      if (utilsNew_UtilsNew.isNotEmpty(gene) && genes.indexOf(gene) === -1) {
        genes.push(gene);
      }
    }

    this.genes = genes;
    this.requestUpdate();
  }

  selectedGene(e) {
    this.dispatchEvent(new CustomEvent("propagate", {
      gene: e.detail.gene
    }));
  }
  /**
   * @deprecated
   */


  fetchFacets() {
    let queryParams = opencga_variant_browser_objectSpread({
      sid: this.opencgaSession.opencgaClient._config.sessionId,
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias,
      facet: "type;genes;soAcc;studies",
      timeout: 60000
    }, this.query);

    if (typeof queryParams.sid === "undefined" || queryParams.sid === "") {
      delete queryParams["sid"];
    }

    let _this = this; // Shows loading modal


    $("#" + this._prefix + "LoadingModal").modal("show");
    setTimeout(_ => {
      this.opencgaSession.opencgaClient.variants().facet(queryParams, {}).then(function (queryResponse) {
        _this.facetResults = queryResponse.response[0].result[0].result.fields;

        for (let result of _this.facetResults) {
          let categories = [];
          let data = [];

          for (let countObj of result.counts) {
            categories.push(countObj.value);
            data.push(countObj.count);
          }

          $("#" + _this._prefix + result.name).highcharts({
            credits: {
              enabled: false
            },
            chart: {
              type: "column"
            },
            title: {
              text: result.name
            },
            xAxis: {
              categories: categories
            },
            yAxis: {
              min: 0,
              title: {
                text: "Total number of Variants"
              }
            },
            tooltip: {
              headerFormat: "<span style=\"font-size:10px\">{point.key}</span><table>",
              pointFormat: "<tr><td style=\"color:{series.color};padding:0\">{series.name}: </td>" + "<td style=\"padding:0\"><b>{point.y:.1f} </b></td></tr>",
              footerFormat: "</table>",
              shared: true,
              useHTML: true
            },
            plotOptions: {
              column: {
                pointPadding: 0.2,
                borderWidth: 0
              }
            },
            series: [{
              name: result.name,
              data: data
            }]
          });
        } // Remove loading modal


        $("#" + _this._prefix + "LoadingModal").modal("hide");
      }).catch(function (e) {
        // Remove loading modal
        $("#" + _this._prefix + "LoadingModal").modal("hide");
      });
    }, 250);
  }
  /**
   * @deprecated
   */
  // This observer is needed when pie charts are rendered instead of table. This is where the data needed for high charts is prepared


  variantStudiesChanged() {
    this.$.variantStudies.render();

    if (this.variantStudies.length > 0) {
      for (let i = 0; i < this.variantStudies.length; i++) {
        let statsArray = this.variantStudies[i].stats;

        for (let j = 0; j < statsArray.length; j++) {
          let genotypeCount = statsArray[j].value.genotypesCount;
          let data = []; //TODO functional refactor in map

          if (Object.keys(genotypeCount).length > 0) {
            for (let k in genotypeCount) {
              data.push({
                name: k,
                y: genotypeCount[k],
                color: this.genotypeColor[k]
              });
            }

            let params = {
              title: statsArray[j].name,
              data: data
            };

            this._updatePieChart("#" + statsArray[j].study + statsArray[j].name, params);
          }
        }
      }
    }
  }

  getStudy(study) {
    if (study !== undefined) {
      let fields = study.split(":");
      return fields[fields.length - 1];
    }

    return "";
  }

  checkForGenotypes(stat) {
    let genotypesCount = stat.value.genotypesCount;
    return Object.keys(genotypesCount).length > 0;
  }

  checkForSampleData(samplesData) {
    return samplesData.length > 0;
  }

  _changeView(e) {
    e.preventDefault(); // prevents the hash change to "#" and allows to manipulate the hash fragment as needed

    $(".variant-browser-content").hide(); // hides all content divs

    if (typeof e.target !== "undefined" && typeof e.target.dataset.view !== "undefined") {
      // $("#" + this._prefix + e.target.dataset.view).show(); // get the href and use it find which div to show
      PolymerUtils.show(this._prefix + e.target.dataset.view);
    } // Show the active button


    $(".variant-browser-view-buttons").removeClass("active");
    $(e.target).addClass("active");

    if (e.target.dataset.view === "Summary") {
      //TODO temp fix
      this.SummaryActive = true;
      this.requestUpdate();
    } else {
      this.SummaryActive = false;
    }

    if (e.target.dataset.view === "GenomeBrowser") {
      //                    window.location.hash = "genomebrowser";
      this._genomeBrowserActive = true;
    } else {
      this._genomeBrowserActive = false;
    }
  }

  getDefaultConfig() {
    return {
      activeFilters: {
        alias: {// Example:
          // "region": "Region",
          // "gene": "Gene",
          // "genotype": "Sample Genotypes",
        },
        complexFields: ["genotype"],
        hiddenFields: ["study"]
      },
      showGenomeBrowser: false,
      genomeBrowser: {
        showTitle: false
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_variant_browser_templateObject(), this.checkProjects ? lit_html_lit_html_html(opencga_variant_browser_templateObject2(), this._config.title, this._prefix, this.opencgaSession, this.query, this.cohorts, this.cellbaseClient, this.populationFrequencies, this.consequenceTypes, this._config.filter, this.onQueryFilterChange, this.onQueryFilterSearch, this.onSampleChange, this._prefix, this.opencgaSession, this.opencgaSession.study.alias, this.preparedQuery, this.executedQuery, this._config.filter.examples, this._config.activeFilterAlias, this._config.activeFilters, this.onActiveFilterChange, this.onActiveFilterClear, this._prefix, this._changeView, this._changeView, this._changeView, this._changeView, this._prefix, this.opencgaSession, this.executedQuery, this.cohorts, this.cellbaseClient, this.populationFrequencies, this.active, this.proteinSubstitutionScores, this.consequenceTypes, this.config, this.selectedGene, this.onSelectVariant, this.onGenomeBrowserPositionChange, this.opencgaSession, this.cellbaseClient, this.variantId, this._prefix, this.opencgaSession, this.cellbaseClient, this.populationFrequencies, this.executedQuery, this.SummaryActive, this._prefix, this.opencgaSession, this.opencgaSession.opencgaClient, this.cellbaseClient, this.preparedQuery, this.executedQuery, this.config.species, this.region, this._genomeBrowserActive, this.fullScreen, this._config.genomeBrowser, this._prefix) : lit_html_lit_html_html(opencga_variant_browser_templateObject3()));
  }

}
customElements.define("opencga-variant-browser", opencga_variant_browser_OpencgaVariantBrowser);
// CONCATENATED MODULE: ./lib/jsorolla/node_modules/countup.js/dist/countUp.min.js
var __assign=undefined&&undefined.__assign||function(){return(__assign=Object.assign||function(t){for(var i,a=1,s=arguments.length;a<s;a++)for(var n in i=arguments[a])Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n]);return t}).apply(this,arguments)},CountUp=function(){function t(t,i,a){var s=this;this.target=t,this.endVal=i,this.options=a,this.version="2.0.4",this.defaults={startVal:0,decimalPlaces:0,duration:2,useEasing:!0,useGrouping:!0,smartEasingThreshold:999,smartEasingAmount:333,separator:",",decimal:".",prefix:"",suffix:""},this.finalEndVal=null,this.useEasing=!0,this.countDown=!1,this.error="",this.startVal=0,this.paused=!0,this.count=function(t){s.startTime||(s.startTime=t);var i=t-s.startTime;s.remaining=s.duration-i,s.useEasing?s.countDown?s.frameVal=s.startVal-s.easingFn(i,0,s.startVal-s.endVal,s.duration):s.frameVal=s.easingFn(i,s.startVal,s.endVal-s.startVal,s.duration):s.countDown?s.frameVal=s.startVal-(s.startVal-s.endVal)*(i/s.duration):s.frameVal=s.startVal+(s.endVal-s.startVal)*(i/s.duration),s.countDown?s.frameVal=s.frameVal<s.endVal?s.endVal:s.frameVal:s.frameVal=s.frameVal>s.endVal?s.endVal:s.frameVal,s.frameVal=Math.round(s.frameVal*s.decimalMult)/s.decimalMult,s.printValue(s.frameVal),i<s.duration?s.rAF=requestAnimationFrame(s.count):null!==s.finalEndVal?s.update(s.finalEndVal):s.callback&&s.callback()},this.formatNumber=function(t){var i,a,n,e,r,o=t<0?"-":"";if(i=Math.abs(t).toFixed(s.options.decimalPlaces),n=(a=(i+="").split("."))[0],e=a.length>1?s.options.decimal+a[1]:"",s.options.useGrouping){r="";for(var l=0,h=n.length;l<h;++l)0!==l&&l%3==0&&(r=s.options.separator+r),r=n[h-l-1]+r;n=r}return s.options.numerals&&s.options.numerals.length&&(n=n.replace(/[0-9]/g,function(t){return s.options.numerals[+t]}),e=e.replace(/[0-9]/g,function(t){return s.options.numerals[+t]})),o+s.options.prefix+n+e+s.options.suffix},this.easeOutExpo=function(t,i,a,s){return a*(1-Math.pow(2,-10*t/s))*1024/1023+i},this.options=__assign({},this.defaults,a),this.formattingFn=this.options.formattingFn?this.options.formattingFn:this.formatNumber,this.easingFn=this.options.easingFn?this.options.easingFn:this.easeOutExpo,this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.endVal=this.validateValue(i),this.options.decimalPlaces=Math.max(this.options.decimalPlaces),this.decimalMult=Math.pow(10,this.options.decimalPlaces),this.resetDuration(),this.options.separator=String(this.options.separator),this.useEasing=this.options.useEasing,""===this.options.separator&&(this.options.useGrouping=!1),this.el="string"==typeof t?document.getElementById(t):t,this.el?this.printValue(this.startVal):this.error="[CountUp] target is null or undefined"}return t.prototype.determineDirectionAndSmartEasing=function(){var t=this.finalEndVal?this.finalEndVal:this.endVal;this.countDown=this.startVal>t;var i=t-this.startVal;if(Math.abs(i)>this.options.smartEasingThreshold){this.finalEndVal=t;var a=this.countDown?1:-1;this.endVal=t+a*this.options.smartEasingAmount,this.duration=this.duration/2}else this.endVal=t,this.finalEndVal=null;this.finalEndVal?this.useEasing=!1:this.useEasing=this.options.useEasing},t.prototype.start=function(t){this.error||(this.callback=t,this.duration>0?(this.determineDirectionAndSmartEasing(),this.paused=!1,this.rAF=requestAnimationFrame(this.count)):this.printValue(this.endVal))},t.prototype.pauseResume=function(){this.paused?(this.startTime=null,this.duration=this.remaining,this.startVal=this.frameVal,this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count)):cancelAnimationFrame(this.rAF),this.paused=!this.paused},t.prototype.reset=function(){cancelAnimationFrame(this.rAF),this.paused=!0,this.resetDuration(),this.startVal=this.validateValue(this.options.startVal),this.frameVal=this.startVal,this.printValue(this.startVal)},t.prototype.update=function(t){cancelAnimationFrame(this.rAF),this.startTime=null,this.endVal=this.validateValue(t),this.endVal!==this.frameVal&&(this.startVal=this.frameVal,this.finalEndVal||this.resetDuration(),this.determineDirectionAndSmartEasing(),this.rAF=requestAnimationFrame(this.count))},t.prototype.printValue=function(t){var i=this.formattingFn(t);"INPUT"===this.el.tagName?this.el.value=i:"text"===this.el.tagName||"tspan"===this.el.tagName?this.el.textContent=i:this.el.innerHTML=i},t.prototype.ensureNumber=function(t){return"number"==typeof t&&!isNaN(t)},t.prototype.validateValue=function(t){var i=Number(t);return this.ensureNumber(i)?i:(this.error="[CountUp] invalid start or end value: "+t,null)},t.prototype.resetDuration=function(){this.startTime=null,this.duration=1e3*Number(this.options.duration),this.remaining=this.duration},t}();
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/opencga-projects.js
function opencga_projects_templateObject6() {
  const data = opencga_projects_taggedTemplateLiteral(["\n                            <tr>\n                                <td>", "</td>\n                                <td>", "</td>\n                                <td>", "</td>\n                                <td>", "</td>\n                                <!--<td>{{item.jobs}}</td>-->\n                                <!--<td>{{item.individuals}}</td>-->\n                            </tr>\n                        "]);

  opencga_projects_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_projects_templateObject5() {
  const data = opencga_projects_taggedTemplateLiteral(["\n                        <tr>\n                            <td rowspan=\"", "\" colspan=\"5\">\n                                ", "\n                               \n                            </td>\n                        </tr>\n                        ", "\n                    "]);

  opencga_projects_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_projects_templateObject4() {
  const data = opencga_projects_taggedTemplateLiteral(["\n                    <div role=\"tabpanel\" class=\"tab-pane ", "\" id=\"facet_tab\">\n                        ", " tab\n                    </div>\n                "]);

  opencga_projects_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_projects_templateObject3() {
  const data = opencga_projects_taggedTemplateLiteral(["\n                    <div class=\"col-md-4\" id=\"", "-chart1\"></div>\n                    <div class=\"col-md-4\" id=\"", "-chart2\"></div>\n                    <div class=\"col-md-4\" id=\"", "-chart3\"></div>\n                "]);

  opencga_projects_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_projects_templateObject2() {
  const data = opencga_projects_taggedTemplateLiteral(["\n                    <li role=\"presentation\" class=\"", "\"><a href=\"#", "\" aria-controls=\"profile\" role=\"tab\" data-toggle=\"tab\">", "</a></li>\n                "]);

  opencga_projects_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_projects_templateObject() {
  const data = opencga_projects_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .center {\n                margin: auto;\n                text-align: justify;\n            }\n            #projects .panel-container {\n                display: flex;\n                justify-content: center;\n            }\n            #projects .panel-container .panel{\n                flex-basis: 250px;\n                margin: 1em;\n                background: #f1f1f1;\n            }\n            #projects .panel-container .panel .counter {\n                font-size: 4em;\n                color: #204d74;\n            }\n            \n            #projects .panel-container .panel .counter-title {\n                margin: -20px 0 0 0;\n                font-size: 15px;\n                text-transform: uppercase;\n                letter-spacing: 2px;\n            }        \n    \n        </style>\n        <!-- TODO check if logged in -->\n        <div id=\"projects\">\n            <div class=\"panel\">\n                <h3 class=\"page-title\">\n                    <i class=\"fa fa-search\" aria-hidden=\"true\"></i> Projects summary\n                </h3>\n            </div>\n\n            <div class=\"panel-container\">\n                <div class=\"panel panel-default shadow\">\n                    <div class=\"panel-body\">\n                        <p class=\"counter\" id=\"files-count\"></p>\n                        <p class=\"counter-title\">Files</p>\n                    </div>\n                </div>\n            \n                <div class=\"panel panel-default shadow\">\n                    <div class=\"panel-body\">\n                        <p class=\"counter\" id=\"samples-count\"></p>\n                        <p class=\"counter-title\">Samples</p>\n                    </div>\n                </div>\n                \n                <div class=\"panel panel-default shadow\">\n                    <div class=\"panel-body\">\n                        <p class=\"counter\" id=\"jobs-count\"></p>\n                        <p class=\"counter-title\">Jobs</p>\n                    </div>\n                </div>\n                \n                <div class=\"panel panel-default shadow\">\n                    <div class=\"panel-body\">\n                        <p class=\"counter\" id=\"individuals-count\"></p>\n                        <p class=\"counter-title\">Individuals</p>\n                    </div>\n                </div>\n                \n                <div class=\"panel panel-default shadow\">\n                    <div class=\"panel-body\">\n                        <p class=\"counter\" id=\"cohorts-count\"></p>\n                        <p class=\"counter-title\">Cohorts</p>\n                    </div>\n                </div>\n                \n                <div class=\"panel panel-default shadow\">\n                    <div class=\"panel-body\">\n                        <p class=\"counter\" id=\"variants-count\">-</p>\n                        <p class=\"counter-title\">Variants</p>\n                    </div>\n                </div>\n            </div>\n            \n            <div style=\"margin:100px\"></div>\n            \n            <ul class=\"nav nav-tabs left-menu-tabs\" role=\"tablist\">\n                <!--<li role=\"presentation\" class=\"active\"><a href=\"#facet_tab\" aria-controls=\"home\" role=\"tab\" data-toggle=\"tab\">Aggregation</a></li>\n                <li role=\"presentation\"><a href=\"#filters_tab\" aria-controls=\"profile\" role=\"tab\" data-toggle=\"tab\">Filters</a></li> -->\n                \n                ", "\n            </ul>\n                        \n            <div class=\"tab-content\">\n                <div class=\"container\">\n                    <div class=\"row\">\n                ", "\n                    </div>\n                </div>\n                ", "\n                <!--<div role=\"tabpanel\" class=\"tab-pane active\" id=\"facet_tab\">\n                    facet_tab\n                </div>\n                <div role=\"tabpanel\" class=\"tab-pane\" id=\"filters_tab\">\n                    filters_tab\n                </div> -->\n            </div>\n            \n            <div id=\"loading\" style=\"\">\n                <loading-spinner></loading-spinner>\n            </div>    \n            <div id=\"facetChart\"></div>    \n            <div id=\"containerChart\"></div>\n            <div>\n                <!--<br>-->\n                <table class=\"table\" style=\"display: none\">\n                    <thead class=\"thead-inverse\">\n                    <tr>\n                        <th colspan=\"5\">Project</th>\n                        <th>Study</th>\n                        <th>Date</th>\n                        <th>Files</th>\n                        <th>Samples</th>\n                        <!--<th>Jobs</th>-->\n                        <!--<th>Individuals</th>-->\n                    </tr>\n                    </thead>\n                    <tbody>\n                    ", "\n                    \n                    </tbody>\n                </table>\n            </div>\n        </div>\n        "]);

  opencga_projects_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_projects_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */




class opencga_projects_OpencgaProjects extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaClient: {
        type: Object
      },
      opencgaSession: {
        type: Object
      },
      projects: {
        type: Array
      },
      studySummaries: {
        type: Array
      }
    };
  }

  _init() {
    this._prefix = "sf-" + utils.randomString(6) + "_";
    this._studies = [];
    this.requestDone = false;
    this.totalCount = {
      files: 0,
      samples: 0,
      jobs: 0,
      individuals: 0,
      cohorts: 0,
      variants: 0
    };
    this.data = {};
  }

  updated(changedProperties) {
    if (changedProperties.has("projects")) {// this.projectsChanged();
    }

    if (changedProperties.has("studySummaries")) {
      this.summariesChanged();
    }
  }

  firstUpdated(_changedProperties) {
    this.filesCount = new CountUp("files-count", 0);
    this.filesCount.start();
    this.samplesCount = new CountUp("samples-count", 0);
    this.samplesCount.start();
    this.jobsCount = new CountUp("jobs-count", 0);
    this.jobsCount.start();
    this.individualsCount = new CountUp("individuals-count", 0);
    this.individualsCount.start();
    this.cohortsCount = new CountUp("cohorts-count", 0);
    this.cohortsCount.start();
    this.variantsCount = new CountUp("variants-count", 0);
    this.variantsCount.start(); // this.loadHighcharts();
    // firstUpdated() like every other props related methods is executed once for each prop

    if (!this.requestDone) {
      this.facetQuery();
      this.requestDone = true;
    }
  }

  start() {}

  _isFirstRow(indexStudy) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(indexStudy) && indexStudy === 0) {
      return "block";
    }

    return "none";
  }
  /*
  loadHighcharts() {
       const colors = Highcharts.getOptions().colors;
       //                    let categories = ['MSIE', 'Firefox', 'Chrome', 'Safari', 'Opera'];
      const categories = this.projects.map(element => {
          return element.name;
      });
      const data = [];
      const _this = this;
      const total = 0;
      const numberOfStudies = this.projects.reduce((total, element) => {
          return total + element.studies.length;
      }, 0);
       this.projects.forEach((element, index) => {
          const studies = element.studies.map(study => {
              return study.name;
          });
          const creationDate = element.studies.map(study => {
              return study.creationDate;
          });
           const projectPercent = studies.length * 100 / numberOfStudies;
          data.push({
              y: projectPercent,
              color: colors[index],
              drilldown: {
                  name: element.name,
                  categories: studies,
                  color: colors[0],
                  data: element.studies.map(study => {
                      return projectPercent / studies.length;
                  }),
                  creationDate: creationDate
              }
          });
      });
      const browserData = [];
      const versionsData = [];
      let i;
      let j;
      const dataLen = categories.length;
      let drillDataLen;
      let brightness;
        // Build the data arrays
      for (i = 0; i < dataLen; i += 1) {
           // add browser data
          browserData.push({
              name: categories[i],
              y: data[i].y,
              color: data[i].color
          });
           // add version data
          drillDataLen = data[i].drilldown.data.length;
          for (j = 0; j < drillDataLen; j += 1) {
              brightness = 0.2 - (j / drillDataLen) / 5;
              versionsData.push({
                  name: data[i].drilldown.categories[j],
                  y: data[i].drilldown.data[j],
                  color: Highcharts.Color(data[i].color).brighten(brightness).get(),
                  creationDate: data[i].drilldown.creationDate[j]
              });
          }
      }
       // Create the chart
      Highcharts.chart("containerChart", {
          chart: {
              type: "pie"
          },
          title: {
              text: "Iva Projects"
          },
          subtitle: {
              text: "<a href=\"https://github.com/opencb\">OpenCB</a>"
          },
          yAxis: {
              title: {
                  text: "Total percent market share"
              }
          },
          plotOptions: {
              pie: {
                  shadow: false,
                  center: ["50%", "50%"],
                  size: 100
              }
          },
          tooltip: {
              valueSuffix: "%",
              formatter: function() {
                  let s = "<b>" + this.key + "</b>";
                   s += "<br/>" + this.percentage.toFixed(2) + "%";
                  if (UtilsNew.isNotUndefinedOrNull(this.point.creationDate)) {
                      s += "<br/>" + moment(this.point.creationDate, "YYYYMMDDHHmmss").format("HH:mm:ss MMM/D/YY");
                  }
                  return s;
              },
              footerFormat: true
           },
          series: [{
              name: "Browsddders",
              data: browserData,
              size: "60%",
              dataLabels: {
                  formatter: function() {
                      return this.y > 5 ? this.point.name : null;
                  },
                  color: "#ffffff",
                  distance: -30
              }
          }, {
              name: "Versions",
              data: versionsData,
              size: "80%",
              innerSize: "60%",
              dataLabels: {
                  formatter: function() {
                      // display only if larger than 1
                      return this.y > 1 ? "<b>" + this.point.name + "</b> ": null;
                  }
              },
              id: "versions"
          }],
          responsive: {
              rules: [{
                  condition: {
                      maxWidth: 800
                  },
                  chartOptions: {
                      series: [{
                          id: "versions",
                          dataLabels: {
                              enabled: false
                          }
                      }]
                  }
              }]
          }
      });
  }*/

  /*
  projectsChanged() {
      if (UtilsNew.isNotUndefined(this.opencgaClient) && this.opencgaClient instanceof OpenCGAClient &&
          UtilsNew.isNotUndefined(this.projects) && this.projects.length > 0) {
          const _this = this;
           if (true) {
              const projectPromises = [];
              this.projects.forEach(function(project) {
                  const studyPromises = [];
                  project.studies.forEach(function(study) {
                      const studyPromise = _this.opencgaClient.studies().summary(project.alias + ":" + study.alias)
                          .then(function(response) {
                              // We add the id to the summary
                              response.response[0].result[0].id = this.studyId;
                              response.response[0].result[0].acl = study.acl;
                              return response;
                          }.bind({studyId: study.id}));
                      studyPromises.push(studyPromise);
                  });
                  projectPromises.push(Promise.all(studyPromises)
                      .then(function(responses) {
                          const studies = [];
                          responses.forEach(function(response) {
                              const study = response.response[0].result[0];
                              study.creationDate = moment(study.creationDate, "YYYYMMDDHHmmss").format("D MMM YY");
                              studies.push(study);
                          });
                          return studies;
                      }));
              });
               const _studySummaries = [];
              Promise.all(projectPromises)
                  .then(function(responses) {
                      for (let i = 0; i < responses.length; i++) {
                          _studySummaries.push({
                              id: _this.projects[i].id,
                              alias: _this.projects[i].alias,
                              name: _this.projects[i].name,
                              rowspan: responses[i].length + 1,
                              studies: responses[i]
                          });
                      }
                      _this.loadHighcharts();
                      _this.renderTable(_studySummaries);
                      _this.requestUpdate();
                  });
          }
      }
  }*/


  async facetQuery() {
    // this.clearPlots();
    console.log("projects", this.projects);
    console.log("this.opencgaSession", this.opencgaSession); // console.log("study",this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias)

    this.querySelector("#loading").style.display = "block";

    const sleep = s => new Promise(resolve => setTimeout(() => resolve(), s * 1000));

    const _this = this;

    this.projects.forEach(project => {
      // let studyPromises = [];
      project.studies.forEach(study => {
        const catalogStats = _this.opencgaClient.studies().aggregationStats(study.fqn).then(response => {
          // handle opencga 1.4 and 2
          const r = response.getResult(0).results ? response.getResult(0).results[0] : response.getResult(0);
          console.log(r);
          this.filesCount.update(this.totalCount.files += r.files);
          this.samplesCount.update(this.totalCount.samples += r.samples);
          this.jobsCount.update(this.totalCount.jobs += r.jobs);
          this.individualsCount.update(this.totalCount.individuals += r.individuals);
          this.samplesCount.update(this.totalCount.samples += r.samples); // this.variantCount.update(this.totalCount.variants += r.variants);

          this.cohortsCount.update(this.totalCount.cohorts += r.cohorts);
          this.data[project.id] = {
            name: project.name,
            dataset: [// ...r.buckets.map( datapoint => ({name: datapoint.value, data: [datapoint.count], type: "column"})),
            {
              name: "count",
              data: [r.count],
              type: "spline"
            }]
          };
          this.requestUpdate();
        });

        _this.opencgaClient.variants().aggregationStats({
          fields: "studies"
        }).then(response => {
          const r = response.getResult(0).results ? response.getResult(0).results[0] : response.getResult(0);
          console.log("variants", r);

          _this.variantsCount.update(this.totalCount.variants += r.count);
        }); // studyPromises.push(studyPromise);

      });
    }); // TODO remove this??

    /* this.projects.map(project => this.opencgaClient.variants().facet({
        // sid: this.opencgaClient._config.sessionId,
        study: this.opencgaSession.study.fqn,
        project: project.fqn,
        timeout: 60000,
        facet: "studies"
    }, {})
        .then( response => {
            //the first is opencga1.4, the second opencga 2
            let r = response.getResult(0).results ? response.getResult(0).results[0] : response.getResult(0);
            //console.log(r)
            this.variantCount.update(this.totalCount.variants += r.count);
            this.data[project.id] = {
                name: project.name,
                dataset: [
                    ...r.buckets.map( datapoint => ({name: datapoint.value, data: [datapoint.count], type: "column"})),
                    {name: "count", data: [r.count], type: "spline"}
                ]
            };
             //this.facetChart("#" + project.name + "chart", this.data[project.id].dataset)
            this.facetChart(project.alias + "-chart1", this.data[project.id].dataset);
            this.facetChart(project.alias + "-chart2", this.data[project.id].dataset);
            this.facetChart(project.alias + "-chart3", this.data[project.id].dataset);
            this.requestUpdate();
        })
     );*/

    /*
    Promise.all([...results]).then( responses => {
        // response.pop() //remove along with sleep
         console.log("response", responses);
        // console.log("res", JSON.stringify(response));
        const data = responses.map( (projectFacet, i) => ({
            project: this.projects[i].name,
            data: projectFacet.getResult(0)
        }));
        // format data for highchart
        const dataset = [];
        // TODO for (var [i, project] of Object.entries()) { // build project infos }
        for (const project of responses) {
             console.log("project", project.getResult(0));
            dataset.push(
                ...project.getResult(0).buckets.map( datapoint => ({name: datapoint.value, data: [datapoint.count], type: "column"})),
                {name: "count", data: [project.getResult(0).count], type: "spline"});
        }
        this.facetChart(dataset);
    }).catch( e => {
        this.errorState = "Error from server";
        console.error(e);
        this.requestUpdate();
    }).finally(() => {
        this.querySelector("#loading").style.display = "none";
    });
    */
  }

  facetChart(selector, facetData) {
    console.log("facetResults", facetData);
    Highcharts.chart(selector, {
      chart: {
        type: "column"
      },
      legend: false,
      title: {
        text: "Total variant"
      },
      subtitle: {
        text: ""
      },
      xAxis: {},
      yAxis: {
        min: 0,
        plotLines: [{
          color: "green",
          // TODO temp solution. It shows the total count for the first project only (replace this point with a line (no splined))
          value: facetData.find(point => point.name === "count").data[0],
          width: 1,
          zIndex: 2
        }]
      },
      tooltip: {
        headerFormat: "<span style=\"font-size:10px\">{point.key}</span><table>",
        pointFormat: "<tr><td style=\"color:{series.color};padding:0\">{series.name}: </td>" + "<td style=\"padding:0\"><b>{point.y} </b></td></tr>",
        footerFormat: "</table>",
        shared: true,
        useHTML: true
      },
      plotOptions: {
        column: {
          borderWidth: 0
        }
      },
      series: facetData,
      showInLegend: false,
      dataLabels: {
        enabled: false
      }
    });
  }

  renderTable(studySummaries) {
    this._studies = studySummaries;
  }

  render() {
    return lit_html_lit_html_html(opencga_projects_templateObject(), this.data ? Object.entries(this.data).map((project, i) => lit_html_lit_html_html(opencga_projects_templateObject2(), i === 0 ? "active" : "", project[0], project[0])) : null, this.projects.length ? this.projects.map(project => lit_html_lit_html_html(opencga_projects_templateObject3(), project.alias, project.alias, project.alias)) : null, this.data ? Object.entries(this.data).map((project, i) => lit_html_lit_html_html(opencga_projects_templateObject4(), i === 0 ? "active" : "", project[0])) : null, this._studies && this._studies.length ? this._studies.map(summaries => lit_html_lit_html_html(opencga_projects_templateObject5(), summaries.rowspan, summaries.name, summaries.studies && summaries.studies.length ? summaries.studies.map(item => lit_html_lit_html_html(opencga_projects_templateObject6(), item.name, item.creationDate, item.files, item.samples)) : null)) : null);
  }

}
customElements.define("opencga-projects", opencga_projects_OpencgaProjects);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/files/opencga-file-filter.js
function opencga_file_filter_templateObject10() {
  const data = opencga_file_filter_taggedTemplateLiteral(["No filter has been configured."]);

  opencga_file_filter_templateObject10 = function _templateObject10() {
    return data;
  };

  return data;
}

function opencga_file_filter_templateObject9() {
  const data = opencga_file_filter_taggedTemplateLiteral(["\n            <div class=\"search-button-wrapper\">\n                <button type=\"button\" class=\"btn btn-primary ripple\" @click=\"", "\">\n                    <i class=\"fa fa-search\" aria-hidden=\"true\"></i> Search\n                </button>\n            </div>\n            "]);

  opencga_file_filter_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function opencga_file_filter_templateObject8() {
  const data = opencga_file_filter_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .label-opencga-file-filter {\n                padding-top: 10px;\n            }\n            span + span {\n                margin-left: 10px;\n            }\n\n            .browser-ct-scroll {\n                /*max-height: 450px;*/\n                /*overflow-y: scroll;*/\n                overflow-x: scroll;\n            }\n\n            .browser-ct-tree-view,\n            .browser-ct-tree-view * {\n                padding: 0;\n                margin: 0;\n                list-style: none;\n            }\n\n            .browser-ct-tree-view li ul {\n                margin: 0 0 0 22px;\n            }\n\n            .browser-ct-tree-view * {\n                vertical-align: middle;\n            }\n\n            .browser-ct-tree-view {\n                /*font-size: 14px;*/\n            }\n\n            .browser-ct-tree-view input[type=\"checkbox\"] {\n                cursor: pointer;\n            }\n\n            .browser-ct-item {\n                white-space: nowrap;\n                display: inline\n            }\n\n            div.block {\n                overflow: hidden;\n            }\n\n            div.block label {\n                width: 80px;\n                display: block;\n                float: left;\n                text-align: left;\n                font-weight: normal;\n            }\n\n            select + select {\n                margin-left: 10px;\n            }\n\n            select + input {\n                margin-left: 10px;\n            }\n\n            span.searchingSpan{\n                background-color: #286090;\n            }\n            .searchingButton{\n                color: #fff;\n            }\n            .notbold{\n                font-weight: normal;\n            }\n        </style>\n\n        ", "\n\n        <div class=\"panel-group\" id=\"", "Accordion\" role=\"tablist\" aria-multiselectable=\"true\">\n\n            <!-- File field attributes -->\n            <div class=\"\">\n                ", "\n            </div>\n        </div>\n        "]);

  opencga_file_filter_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_file_filter_templateObject7() {
  const data = opencga_file_filter_taggedTemplateLiteral(["\n                                <div class=\"tooltip-div pull-right\">\n                                    <a><i class=\"fa fa-info-circle\" aria-hidden=\"true\" id=\"", "", "Tooltip\"></i></a>\n                                </div>"]);

  opencga_file_filter_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_file_filter_templateObject6() {
  const data = opencga_file_filter_taggedTemplateLiteral(["\n                    <div class=\"form-group\">\n                        <div class=\"browser-subsection\" id=\"", "\">", "\n                            ", "\n                        </div>\n                        <div id=\"", "", "\" class=\"subsection-content\">\n                            ", "\n                         </div>\n                    </div>\n                "]);

  opencga_file_filter_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_file_filter_templateObject5() {
  const data = opencga_file_filter_taggedTemplateLiteral(["<opencga-date-filter .config=\"", "\" @filterChange=\"", "\"></opencga-date-filter>"]);

  opencga_file_filter_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_file_filter_templateObject4() {
  const data = opencga_file_filter_taggedTemplateLiteral(["<opencga-annotation-filter .opencgaSession=\"", "\"\n                                                          .config=\"", "\"\n                                                          entity=\"FILE\"\n                                                          @filterannotation=\"", "\">\n                                    </opencga-annotation-filter>"]);

  opencga_file_filter_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_file_filter_templateObject3() {
  const data = opencga_file_filter_taggedTemplateLiteral(["<select-field-filter multiple .value=\"", "\" .data=\"", "\" @filterChange=\"", "\"></select-field-filter>"]);

  opencga_file_filter_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_file_filter_templateObject2() {
  const data = opencga_file_filter_taggedTemplateLiteral(["<text-field-filter placeholder=\"", "\" .value=\"", "\" @filterChange=\"", "\"></text-field-filter>"]);

  opencga_file_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_file_filter_templateObject() {
  const data = opencga_file_filter_taggedTemplateLiteral(["<section-filter .config=\"", "\" .filters=\"", "\">"]);

  opencga_file_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_file_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_file_filter_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_file_filter_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_file_filter_ownKeys(Object(source), true).forEach(function (key) { opencga_file_filter_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_file_filter_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_file_filter_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */





 // import "../../../commons/filters/text-field-filter.js";

class opencga_file_filter_OpencgaFileFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      files: {
        type: Array
      },
      query: {
        type: Object
      },
      search: {
        type: Object
      },
      variableSets: {
        type: Array
      },
      variables: {
        type: Array
      },
      minYear: {
        type: Number
      },
      compact: {
        type: Boolean
      },
      config: {
        type: Object
      },
      discriminator: {
        type: String
      }
    };
  }

  _init() {
    // super.ready();
    this._prefix = "osf-" + utils.randomString(6) + "_";
    this.annotationFilterConfig = {
      class: "small",
      buttonClass: "btn-sm",
      inputClass: "input-sm"
    }; //remove this, move into date-filter

    this.dateFilterConfig = {
      recentDays: 10
    };
    this.minYear = 1920;
    this.query = {};
    this.preparedQuery = {};
    this.searchButton = true;
  }

  connectedCallback() {
    super.connectedCallback();
    this.preparedQuery = opencga_file_filter_objectSpread({}, this.query); // propagates here the iva-app query object
  }

  updated(changedProperties) {
    if (changedProperties.has("query")) {
      this.queryObserver();
    }

    if (changedProperties.has("variables")) {
      this.variablesChanged();
    }
  }

  onSearch() {
    // this.search = {...this.query};
    this.notifySearch(this.preparedQuery);
  }

  addAnnotation(e) {
    if (typeof this._annotationFilter === "undefined") {
      this._annotationFilter = {};
    }

    const split = e.detail.value.split("=");
    this._annotationFilter[split[0]] = split[1];
    const _query = {};
    Object.assign(_query, this.query);
    const annotations = [];

    for (const key in this._annotationFilter) {
      annotations.push("".concat(key, "=").concat(this._annotationFilter[key]));
    }

    _query["annotation"] = annotations.join(";");
    this._reset = false;
    this.query = _query;
    this._reset = true;
  }

  onDateChanged(e) {
    const query = {};
    Object.assign(query, this.query);

    if (utilsNew_UtilsNew.isNotEmpty(e.detail.date)) {
      query["creationDate"] = e.detail.date;
    } else {
      delete query["creationDate"];
    }

    this._reset = false;
    this.query = query;
    this._reset = true;
  }

  queryObserver() {
    if (this._reset) {
      console.log("queryObserver: calling to 'renderQueryFilters()'", this.query, "discriminator", this.discriminator);
      this.preparedQuery = this.query; // this.renderQueryFilters();

      this.requestUpdate();
    } else {
      this._reset = true;
    }
  }
  /*
  // TODO refactor!
  renderQueryFilters() {
      // Empty everything before rendering
      this._clearHtmlDom();
       console.log(this.querySelector(`${this._prefix}-name-input`));
      // File name
      if (UtilsNew.isNotUndefined(this.query.name)) {
          PolymerUtils.setValue(`${this._prefix}-name-input`, this.query.name);
      }
       // File path
      if (UtilsNew.isNotUndefined(this.query.path)) {
          PolymerUtils.setValue(`${this._prefix}-path-input`, this.query.path);
      }
       // Sample
      if (UtilsNew.isNotUndefined(this.query.samples)) {
          PolymerUtils.setValue(`${this._prefix}-sample-input`, this.query.samples);
      }
       // File format
      if (UtilsNew.isNotUndefined(this.query.format)) {
          PolymerUtils.setValue(`${this._prefix}-format-input`, this.query.format);
      }
       // File bioformat
      if (UtilsNew.isNotUndefined(this.query.bioformat)) {
          PolymerUtils.setValue(`${this._prefix}-bioformat-input`, this.query.bioformat);
      }
      this.requestUpdate();
  }*/

  /*    filterChanged(e) {
      console.log(e.target.name, e.target.value.trim());
      if (e.target.value.trim()) {
          this.query[e.target.name] = e.target.value.trim();
      } else {
          delete this.query[e.target.name];
      }
      console.log(this.query)
  }*/


  onFilterChange(key, value) {
    console.log("filterChange", {
      [key]: value
    });

    if (value && value !== "") {
      this.preparedQuery = opencga_file_filter_objectSpread({}, this.preparedQuery, {}, {
        [key]: value
      });
    } else {
      console.log("deleting", key, "from preparedQuery");
      delete this.preparedQuery[key];
      this.preparedQuery = opencga_file_filter_objectSpread({}, this.preparedQuery);
    }

    this.notifyQuery(this.preparedQuery);
    this.requestUpdate();
  }

  notifyQuery(query) {
    this.dispatchEvent(new CustomEvent("queryChange", {
      detail: {
        query: query
      },
      bubbles: true,
      composed: true
    }));
  }

  notifySearch(query) {
    this.dispatchEvent(new CustomEvent("querySearch", {
      detail: {
        query: query
      },
      bubbles: true,
      composed: true
    }));
  }

  _createSection(section) {
    const htmlFields = section.fields && section.fields.length && section.fields.map(subsection => this._createSubSection(subsection));
    return this.config.sections.length > 1 ? lit_html_lit_html_html(opencga_file_filter_templateObject(), section, htmlFields) : htmlFields;
  }

  _createSubSection(subsection) {
    let content = "";

    switch (subsection.id) {
      case "name":
      case "path":
      case "sample":
      case "bioformat":
        content = lit_html_lit_html_html(opencga_file_filter_templateObject2(), subsection.placeholder, this.preparedQuery[subsection.id], e => this.onFilterChange(subsection.id, e.detail.value));
        break;

      case "format":
        content = lit_html_lit_html_html(opencga_file_filter_templateObject3(), this.preparedQuery.format, subsection.allowedValues, e => this.onFilterChange("format", e.detail.value));
        break;

      case "annotations":
        content = lit_html_lit_html_html(opencga_file_filter_templateObject4(), this.opencgaSession, this.annotationFilterConfig, this.addAnnotation);
        break;

      case "date":
        content = lit_html_lit_html_html(opencga_file_filter_templateObject5(), this.dateFilterConfig, e => this.onFilterChange("creationDate", e.detail.value));
        break;

      default:
        console.error("Filter component not found");
    }

    return lit_html_lit_html_html(opencga_file_filter_templateObject6(), subsection.id, subsection.name, subsection.description ? lit_html_lit_html_html(opencga_file_filter_templateObject7(), this._prefix, subsection.id) : null, this._prefix, subsection.id, content);
  }
  /**
   * Use custom CSS class to easily reset all controls.
   */


  _clearHtmlDom() {
    // Input controls
    PolymerUtils_PolymerUtils.setPropertyByClassName(this._prefix + "FilterTextInput", "value", "");
    PolymerUtils_PolymerUtils.removeAttributebyclass(this._prefix + "FilterTextInput", "disabled");
  }

  isNotEmpty(myArray) {
    return utilsNew_UtilsNew.isNotEmptyArray(myArray);
  }

  render() {
    return lit_html_lit_html_html(opencga_file_filter_templateObject8(), this.searchButton ? lit_html_lit_html_html(opencga_file_filter_templateObject9(), this.onSearch) : null, this._prefix, this.config.sections && this.config.sections.length ? this.config.sections.map(section => this._createSection(section)) : lit_html_lit_html_html(opencga_file_filter_templateObject10()));
  }

}
customElements.define("opencga-file-filter", opencga_file_filter_OpencgaFileFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/files/opencga-file-grid.js
function opencga_file_grid_templateObject() {
  const data = opencga_file_grid_taggedTemplateLiteral(["\n        <style include=\"jso-styles\"></style>\n\n        <opencb-grid-toolbar .from=\"", "\"\n                            .to=\"", "\"\n                            .numTotalResultsText=\"", "\"\n                            @download=\"", "\">\n        </opencb-grid-toolbar>\n\n        <div id=\"", "GridTableDiv\">\n            <table id=\"", "FileBrowserGrid\">\n            </table>\n        </div>\n        "]);

  opencga_file_grid_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_file_grid_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_file_grid_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_file_grid_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_file_grid_ownKeys(Object(source), true).forEach(function (key) { opencga_file_grid_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_file_grid_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_file_grid_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */





 // todo check functionality and notify usage

class opencga_file_grid_OpencgaFileGrid extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      files: {
        type: Array
      },
      filters: {
        type: Object
      },
      //TODO replace with query
      search: {
        type: Object
      },
      eventNotifyName: {
        type: String
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "VarFileGrid" + utils.randomString(6) + "_";
    this._config = this.getDefaultConfig();
    this.eventNotifyName = "messageevent";
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession") || changedProperties.has("search")) {
      this.renderTable();
    }

    if (changedProperties.has("filters")) {
      this.onFilterUpdate();
    }

    if (changedProperties.has("config")) {
      this.configObserver();
    }

    if (changedProperties.has("filteredVariables")) {
      this.calculateFilters();
    }
  } // todo recheck! it was connectedCallback() and ready()


  firstUpdated(_changedProperties) {
    this._initTableColumns();

    this.dispatchEvent(new CustomEvent("clear", {
      detail: {},
      bubbles: true,
      composed: true
    }));
    this.table = PolymerUtils_PolymerUtils.getElementById(this._prefix + "FileBrowserGrid");
    this.search = {};
  }

  configObserver() {
    this._config = Object.assign(this.getDefaultConfig(), this.config);
  }

  renderTable() {
    this.files = []; // We avoid listing directories in the grid

    let filters = Object.assign({}, this.search);

    if (Object.keys(filters).length === 0) {
      filters["type"] = "FILE";
    }

    this.from = 1;
    this.to = 10;

    if (utilsNew_UtilsNew.isNotUndefined(this.opencgaSession.opencgaClient) && utilsNew_UtilsNew.isNotUndefined(this.opencgaSession.study) && utilsNew_UtilsNew.isNotUndefined(this.opencgaSession.study.fqn)) {
      // Make a copy of the files (if they exist), we will use this private copy until it is assigned to this.files
      if (utilsNew_UtilsNew.isNotUndefined(this.files)) {
        this._files = this.files;
      } else {
        this._files = [];
      } // Check that HTTP protocol is present and complete the URL


      let opencgaHostUrl = this.opencgaSession.opencgaClient.getConfig().host;

      if (!opencgaHostUrl.startsWith("http://") && !opencgaHostUrl.startsWith("https://")) {
        opencgaHostUrl = "http://" + opencgaHostUrl;
      }

      opencgaHostUrl += "/webservices/rest/v1/files/search";
      let skipCount = false;

      const _table = $("#" + this._prefix + "FileBrowserGrid");

      const _this = this;

      $("#" + this._prefix + "FileBrowserGrid").bootstrapTable("destroy");
      $("#" + this._prefix + "FileBrowserGrid").bootstrapTable({
        //url: opencgaHostUrl,
        columns: _this._columns,
        method: "get",
        sidePagination: "server",
        uniqueId: "id",
        formatLoadingMessage: () => "<div><loading-spinner></loading-spinner></div>",
        ajax: params => {
          if (this.pageNumber > 1) {
            skipCount = true;
          }

          let filters = opencga_file_grid_objectSpread({
            study: this.opencgaSession.study.fqn,
            //sid: Cookies.get(this.opencgaSession.opencgaClient.getConfig().cookieSessionId),
            type: "FILE",
            order: params.data.order,
            limit: params.data.limit,
            skip: params.data.offset || 0,
            skipCount: skipCount,
            include: "name,path,samples,status,format,bioformat,creationDate,modificationDate,uuid"
          }, this.search);

          this.opencgaSession.opencgaClient.files().search(filters).then(res => params.success(res));
        },
        // Table properties
        pagination: _this._config.pagination,
        pageSize: _this._config.pageSize,
        pageList: _this._config.pageList,
        showExport: _this._config.showExport,
        detailView: _this._config.detailView,
        detailFormatter: _this._config.detailFormatter,
        //it is not used anymore

        /*queryParams: function(params) {
            if (this.pageNumber > 1) {
                skipCount = true;
            }
            const auxParams = {
                study: _this.opencgaSession.study.fqn,
                sid: Cookies.get(_this.opencgaSession.opencgaClient.getConfig().cookieSessionId),
                order: params.order,
                sort: params.sort,
                limit: params.limit,
                skip: params.offset,
                skipCount: skipCount,
                include: "name,path,samples,status,format,bioformat,creationDate,modificationDate,uuid"
            };
             if (UtilsNew.isUndefined(filters)) {
                filters = {};
            }
            return Object.assign(filters, auxParams);
        },*/
        responseHandler: function responseHandler(response) {
          if (!skipCount) {
            if (!_this.hasOwnProperty("numTotalResults")) {
              _this.numTotalResults = 0;
            }

            if (_this.numTotalResults !== response.response[0].numTotalResults && response.queryOptions.skip === 0) {
              _this.numTotalResults = response.response[0].numTotalResults;
            }
          }

          _this.numTotalResultsText = _this.numTotalResults.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

          if (response.queryOptions.skip === 0 && _this.numTotalResults < response.queryOptions.limit) {
            _this.from = 1;
            _this.to = _this.numTotalResults;
          }

          _this.requestUpdate(); // it is necessary to refresh numTotalResultsText in opencga-grid-toolbar


          return {
            total: _this.numTotalResults,
            rows: response.response[0].result
          };
        },
        onClickRow: function onClickRow(row, element, field) {
          if (_this._config.multiselection) {
            $(element).toggleClass("success");
            const index = element[0].getAttribute("data-index"); // Check and uncheck actions trigger events that are captured below

            if ("selected" === element[0].className) {
              $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "FileBrowserGrid")).bootstrapTable("uncheck", index);
            } else {
              $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "FileBrowserGrid")).bootstrapTable("check", index);
            }
          } else {
            $(".success").removeClass("success");
            $(element).addClass("success");
          }

          _this._onSelectFile(row);
        },
        onCheck: function onCheck(row, elem) {
          // check file is not already selected
          for (const i in _this._files) {
            if (_this._files[i].id === row.id) {
              return;
            }
          } // we add files to selected files
          // _this.push("_files", row);
          // _this.set("files", _this._files.slice());


          _this._files.push(row);

          _this.files = _this._files.slice();
        },
        onUncheck: function onUncheck(row, elem) {
          let fileToDeleteIdx = -1;

          for (const i in _this.files) {
            if (_this.files[i].id === row.id) {
              fileToDeleteIdx = i;
              break;
            }
          }

          if (fileToDeleteIdx === -1) {
            return;
          } // _this.splice("_files", fileToDeleteIdx, 1);
          // _this.set("files", _this._files.slice());


          _this._files.splice(fileToDeleteIdx, 1);

          _this.files = _this._files.slice();
        },
        onCheckAll: function onCheckAll(rows) {
          const newFiles = _this._files.slice(); // check file is not already selected


          rows.forEach(file => {
            const existsNewSelected = _this._files.some(fileSelected => {
              return fileSelected.id === file.id;
            });

            if (!existsNewSelected) {
              newFiles.push(file);
            }
          }); // we add files to selected files

          _this._files = newFiles;
          _this.files = newFiles.slice();
        },
        onUncheckAll: function onUncheckAll(rows) {
          // check file is not already selected
          rows.forEach(file => {
            _this._files = _this._files.filter(fileSelected => {
              return fileSelected.id !== file.id;
            });
          }); // we add files to selected files
          //                            _this.push("_files", row);

          _this.files = _this._files.slice();
        },
        onLoadSuccess: function onLoadSuccess(data) {
          // Check all already selected rows. Selected files are stored in this.files array
          if (utilsNew_UtilsNew.isNotUndefinedOrNull(_table)) {
            if (!_this._config.multiselection) {
              PolymerUtils_PolymerUtils.querySelector(_table.selector).rows[1].setAttribute("class", "success");

              _this._onSelectFile(data.rows[0]);
            }

            if (_this.files !== "undefined") {
              for (const idx in _this.files) {
                for (const j in data.rows) {
                  if (_this.files[idx].id === data.rows[j].id) {
                    $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "FileBrowserGrid")).bootstrapTable("check", j);
                    break;
                  }
                }
              }
            }
          }
        },
        onPageChange: function onPageChange(page, size) {
          _this.from = (page - 1) * size + 1;
          _this.to = page * size;
        } //                         onPostBody: function() {
        //                             if(PolymerUtils.getElementsByClassName(_this._prefix + 'Download')) {
        //                                 PolymerUtils.querySelectorAll("." + _this._prefix + "Download").forEach(elem => elem.addEventListener("click", _this.downloadQCFile.bind(_this), true));
        //
        // //                                PolymerUtils.getElementById(_this._prefix + 'Download').addEventListener('click', _this.downloadQCFile.bind(_this));
        //                             }
        //                         }

      });
      this.opencgaSession.opencgaClient.studies().info(this.opencgaSession.study.id).then(function (response) {
        _this.variableSets = response.response[0].result[0].variableSets;
      }).catch(function () {
        console.log("Could not obtain the variable sets of the study " + _this.opencgaSession.study.id);
      });
    } else {
      // Delete table
      $(PolymerUtils_PolymerUtils.getElementById(this._prefix + "FileBrowserGrid")).bootstrapTable("destroy");
      this.numTotalResults = 0;
    }
  }
  /**
   * If filters have been removed, clean the values from the forms.
   */


  onFilterUpdate() {//this.updateForms(this.filters); //TODO recheck, this shouldn't be necessary anymore (and it seems not)
  }

  _onSelectFile(row) {
    if (typeof row !== "undefined") {
      this.dispatchEvent(new CustomEvent("selectfile", {
        detail: {
          id: row.id,
          file: row
        }
      }));
    }
  }

  updateForms(filters) {
    // This is just to avoid entering here when it has just been initialized
    if (utilsNew_UtilsNew.isUndefined(this._prefix)) {
      return;
    }

    const fileName = PolymerUtils_PolymerUtils.getValue(this._prefix + "NameTextarea");

    if (!filters.hasOwnProperty("name") && utilsNew_UtilsNew.isNotUndefined(fileName) && fileName.length > 0) {
      PolymerUtils_PolymerUtils.getElementById(this._prefix + "NameTextarea").value = "";
    }

    const individual = PolymerUtils_PolymerUtils.getValue(this._prefix + "IndividualTextarea");

    if (!filters.hasOwnProperty("individual.id") && utilsNew_UtilsNew.isNotUndefined(individual) && individual.length > 0) {
      PolymerUtils_PolymerUtils.setValue(this._prefix + "IndividualTextarea", "");
    }

    if (this.filteredVariables.variables.length > 0) {
      if (!filters.hasOwnProperty("annotation")) {
        // Remove the filter variableSetId as it won't make more sense.
        this.filteredVariables.variables = [];
      } else if (filters.annotation.length < this.filteredVariables.variables.length) {
        const tmpVariables = [];
        filters.annotation.forEach(function (variable) {
          tmpVariables.push(variable);
        });
        this.filteredVariables.variables = tmpVariables;
      }
    }
  }
  /**
   * Read from the values in the forms, and sets the filters.
   */


  calculateFilters() {
    const filters = {};
    let fileName = "";
    let individual = "";

    if (PolymerUtils_PolymerUtils.getElementById(this._prefix + "NameTextarea") !== null) {
      fileName = PolymerUtils_PolymerUtils.getElementById(this._prefix + "NameTextarea").value;
    }

    if (PolymerUtils_PolymerUtils.getElementById(this._prefix + "IndividualTextarea") !== null) {
      individual = PolymerUtils_PolymerUtils.getElementById(this._prefix + "IndividualTextarea").value;
    }

    if (utilsNew_UtilsNew.isNotUndefined(fileName) && fileName.length > 0) {
      filters["name"] = "~" + fileName;
    }

    if (utilsNew_UtilsNew.isNotUndefined(individual) && individual.length > 0) {
      filters["individual.id"] = "~" + individual;
    }

    if (utilsNew_UtilsNew.isNotUndefined(this.filteredVariables.variables) && this.filteredVariables.variables.length > 0) {
      //                    filters["variableSetId"] = this.filteredVariables.variableSet;
      const annotations = [];
      this.filteredVariables.variables.forEach(function (variable) {
        annotations.push(variable);
      });
      filters["annotation"] = annotations;
    }

    this.filters = filters;
  }

  onSearch() {
    // Convert the filters to an objectParam that can be directly send to the file search
    const filterParams = {};
    const keys = Object.keys(this.filters);

    for (let i = 0; i < keys.length; i++) {
      // Some filters can come as an array of things.
      // annotation = [{name: name, value: Smith}, {name: age, value: >5}]
      if (Array.isArray(this.filters[keys[i]])) {
        const myArray = this.filters[keys[i]];
        let myArrayFilter = []; // The elements in the array can be either an object

        if (Object.getPrototypeOf(myArray[0]) === Object.prototype) {
          const myArray = this.filters[keys[i]];

          for (let j = 0; j < myArray.length; j++) {
            // TODO: We have to check if the value already has an operand
            myArrayFilter.push(myArray[j].name + "=" + myArray[j].value);
          }
        } else {
          // Or an array of strings or numbers
          myArrayFilter = this.filters[keys[i]];
        }

        filterParams[keys[i]] = myArrayFilter.join(";");
      } else {
        filterParams[keys[i]] = this.filters[keys[i]];
      }
    }

    if (this.filters.hasOwnProperty("annotation")) {
      // Add the variable set whose annotations will be queried
      filterParams["variableSetId"] = this.filteredVariables.variableSet;
    }

    this.search = filterParams;
  }

  stateFormatter(value, row, index) {
    if (typeof this.field.context.files != "undefined") {
      for (const idx in this.field.context.files) {
        if (this.field.context.files[idx].name == row.name) {
          break;
        }
      }
    }
  }

  individualFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotUndefined(row.attributes) && utilsNew_UtilsNew.isNotUndefined(row.attributes.individual) && utilsNew_UtilsNew.isNotUndefined(row.attributes.individual.id)) {
      return row.attributes.individual.id;
    } else {
      return "-";
    }
  }

  dateFormatter(value, row) {
    return moment(value, "YYYYMMDDHHmmss").format("D MMM YYYY");
  }

  diagnosisFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotUndefined(row.attributes) && utilsNew_UtilsNew.isNotUndefined(row.attributes.individual) && utilsNew_UtilsNew.isNotEmptyArray(row.attributes.individual.phenotypes)) {
      const diagnosisPhenotypes = row.attributes.individual.phenotypes.filter(disease => {
        return disease.source === "ICD10";
      }).map(icd10disease => {
        return icd10disease.name;
      });

      if (utilsNew_UtilsNew.isNotEmptyArray(diagnosisPhenotypes)) {
        return diagnosisPhenotypes.join(",");
      }
    }

    return "-";
  }

  hpoFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotUndefined(row.attributes) && utilsNew_UtilsNew.isNotUndefined(row.attributes.individual) && utilsNew_UtilsNew.isNotEmptyArray(row.attributes.individual.phenotypes)) {
      const hpoPhenotypes = row.attributes.individual.phenotypes.filter(disease => {
        return disease.source === "HPO";
      }).map(hpoDisease => {
        return hpoDisease.name;
      });

      if (utilsNew_UtilsNew.isNotEmptyArray(hpoPhenotypes)) {
        return hpoPhenotypes.join(",");
      }
    }

    return "-";
  }

  fatherFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotUndefined(row.attributes) && utilsNew_UtilsNew.isNotUndefined(row.attributes.individual) && utilsNew_UtilsNew.isNotUndefined(row.attributes.individual.father) && utilsNew_UtilsNew.isNotUndefined(row.attributes.individual.father.id)) {
      return row.attributes.individual.father.id;
    } else {
      return "-";
    }
  }

  motherFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotUndefined(row.attributes) && utilsNew_UtilsNew.isNotUndefined(row.attributes.individual) && utilsNew_UtilsNew.isNotUndefined(row.attributes.individual.mother) && utilsNew_UtilsNew.isNotUndefined(row.attributes.individual.mother.id)) {
      return row.attributes.individual.mother.id;
    } else {
      return "-";
    }
  }

  cellTypeFormatter(value, row) {
    return row.somatic ? "Somatic" : "Germline";
  }

  _initTableColumns() {
    const columns = [];

    if (this._config.multiselection) {
      columns.push({
        field: {
          source: "state",
          context: this
        },
        checkbox: true,
        formatter: this.stateFormatter
      });
    }

    this._columns = [columns.concat([// name,path,samples,status,format,bioformat,creationDate,modificationDate,uuid"
    {
      title: "Uuid",
      field: "uuid",
      visible: false
    }, {
      title: "Name",
      field: "name"
    }, {
      title: "Path",
      field: "path"
    }, {
      title: "Format",
      field: "format"
    }, {
      title: "Bioformat",
      field: "bioformat"
    }, {
      title: "Creation date",
      field: "creationDate",
      formatter: this.dateFormatter
    }, {
      title: "Modification date",
      field: "modificationDate",
      formatter: this.dateFormatter
    }, {
      title: "Status",
      field: "status.name"
    }])];
    return this._columns;
  }

  _getUrlQueryParams() {
    // Check the opencgaClient exists
    if (utilsNew_UtilsNew.isUndefinedOrNull(this.opencgaSession.opencgaClient)) {
      return {
        host: "",
        queryParams: {}
      };
    }

    let host = this.opencgaSession.opencgaClient.getConfig().host; // By default we assume https protocol instead of http

    if (!host.startsWith("https://") && !host.startsWith("http://")) {
      host = "https://" + this.opencgaSession.opencgaClient.getConfig().host;
    }

    console.log("this.opencgaSession", this.opencgaSession);

    if (typeof this.opencgaSession.project !== "undefined" && typeof this.opencgaSession.study.alias !== "undefined") {
      if (typeof this.query === "undefined") {
        this.query = {};
      }

      if (utilsNew_UtilsNew.isEmpty(this.query.studies) || this.query.studies.split(new RegExp("[,;]")).length === 1) {
        this.query.study = this.opencgaSession.study.fqn;
      }

      host += "/webservices/rest/v1/files/search";
    } else {
      return {
        host: host,
        queryParams: {}
      };
    } // Init queryParams with default and config values plus query object


    const queryParams = Object.assign({
      sid: this.opencgaSession.opencgaClient._config.sessionId,
      include: "id,name,format",
      skipCount: false
    }, this.query);
    console.log("QUERYPARAM", queryParams);
    return {
      host: host,
      queryParams: queryParams
    };
  }

  onDownload(e) {
    // let urlQueryParams = this._getUrlQueryParams();
    // let params = urlQueryParams.queryParams;
    console.log(this.opencgaSession);

    const params = opencga_file_grid_objectSpread({}, this.query, {
      limit: 1000,
      sid: this.opencgaSession.opencgaClient._config.sessionId,
      skip: 0,
      skipCount: true,
      study: this.opencgaSession.study.fqn,
      include: "name,path,format,bioformat,creationDate,modificationDate,status",
      type: "FILE"
    });

    this.opencgaSession.opencgaClient.files().search(params).then(response => {
      const result = response.response[0].result;
      let dataString = [];
      let mimeType = "";
      let extension = "";

      if (result) {
        // Check if user clicked in Tab or JSON format
        if (e.detail.option.toLowerCase() === "tab") {
          dataString = [["Name", "Path", "Format", "Bioformat", "Creation date", "Modification date", "Status"].join("\t"), ...result.map(_ => [_.id, _.path, _.format, _.bioformat, _.creationDate, _.modificationDate, _.status.name].join("\t"))]; //console.log(dataString);

          mimeType = "text/plain";
          extension = ".txt";
        } else {
          for (const res of result) {
            dataString.push(JSON.stringify(res, null, "\t"));
          }

          mimeType = "application/json";
          extension = ".json";
        } // Build file and anchor link


        const data = new Blob([dataString.join("\n")], {
          type: mimeType
        });
        const file = window.URL.createObjectURL(data);
        const a = document.createElement("a");
        a.href = file;
        a.download = this.opencgaSession.study.alias + extension;
        document.body.appendChild(a);
        a.click();
        setTimeout(function () {
          document.body.removeChild(a);
        }, 0);
      } else {
        console.error("Error in result format");
      }
    }).then(function () {//this.downloadRefreshIcon.css("display", "none");
      //this.downloadIcon.css("display", "inline-block");
    });
  }

  getDefaultConfig() {
    return {
      pagination: true,
      pageSize: 10,
      pageList: [10, 25, 50],
      showExport: false,
      detailView: false,
      detailFormatter: undefined,
      // function with the detail formatter
      multiselection: false
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_file_grid_templateObject(), this.from, this.to, this.numTotalResultsText, this.onDownload, this._prefix, this._prefix);
  }

}
customElements.define("opencga-file-grid", opencga_file_grid_OpencgaFileGrid);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/opencb-facet-query.js
function opencb_facet_query_templateObject2() {
  const data = opencb_facet_query_taggedTemplateLiteral([" \n            <div class=\"col-md-12\">\n                <div>\n                    <button type=\"button\" class=\"btn btn-primary ripple pull-right\" @click=\"", "\">Run Advanced facet query</button>\n                </div>\n                <div >\n                    <h2>Results</h2>\n                    <opencb-facet-results .data=\"", "\" .errorState=\"", "\" ?loading=\"", "\"></opencb-facet-results>\n                </div>\n            </div>"]);

  opencb_facet_query_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencb_facet_query_templateObject() {
  const data = opencb_facet_query_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            option:disabled {\n                font-size: 0.85em;\n                font-weight: bold;\n            }\n\n            .active-filter-button:hover {\n                text-decoration: line-through;\n            }\n            .deletable:hover {\n                text-decoration: line-through;\n            }\n            #loading {\n                text-align: center;\n                margin-top: 40px;\n            }\n        </style>\n\n        <div class=\"row\">\n            <!-- RESULTS - Facet Plots -->\n            ", "\n        </div>\n    "]);

  opencb_facet_query_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencb_facet_query_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencb_facet_query_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencb_facet_query_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencb_facet_query_ownKeys(Object(source), true).forEach(function (key) { opencb_facet_query_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencb_facet_query_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencb_facet_query_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */





 //TODO delete opencga-variant-facet-query and use this for variant too
//TODO this components needs cleaning from the old code
//TODO avg(popFreq__1kG_phase3__AFR)[0..1]:0.1>>avg(popFreq__GNOMAD_GENOMES__EAS[0..1]):0.1

class opencb_facet_query_OpencbFacetQuery extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      resource: {
        type: String
      },
      opencgaSession: {
        type: Object
      },
      query: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      config: {
        type: Object
      },
      active: {
        type: Boolean
      }
    };
  }

  _init() {
    this._prefix = "facet" + utils.randomString(6); // this.checkProjects = true;
    // These are for making the queries to server

    this.facetFields = [];
    this.facetRanges = [];
    this.facetFieldsName = [];
    this.facetRangeFields = [];
    this.results = [];
    this._showInitMessage = true;
    this.facetFilters = [];
    this.facetConfig = {
      a: 1
    };
    this.facetActive = true;
    this.facetResults = [];
  }

  connectedCallback() {
    super.connectedCallback();

    if (this.config.summary && this.config.summary.fields) {
      this.facetFilters = this.config.summary.fields;
    } else {
      throw new Error("DefaultStats fields has not been configured");
    }
  }

  firstUpdated(_changedProperties) {
    $(".bootstrap-select", this).selectpicker();
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession") || changedProperties.has("query")) {
      this.propertyObserver();
    }

    if (changedProperties.has("query")) {
      this.queryObserver();
    }

    if (changedProperties.has("config")) {
      this.configObserver();
    }

    if (changedProperties.has("active")) {
      this.fetchDefaultData();
    }
  }

  propertyObserver(opencgaSession, query) {// this.clear();
    //PolymerUtils.show(this._prefix + "Warning");
  }

  queryObserver() {
    console.log("queryObserver  in facet!"); //executedQuery in opencga-variant-browser has changed so, if requested,  we have to repeat the facet query

    this.facetResults = [];
    this.fetchDefaultData();
  }

  configObserver() {}

  fetchDefaultData() {
    //this.facetResults is reset in queryObserver
    if (this.active && this.config && !this.facetResults.length) {
      //this.addDefaultStats();
      this.fetchData();
    }
  }

  fetchData() {
    if (utilsNew_UtilsNew.isUndefinedOrNull(this.opencgaSession.opencgaClient)) {
      console.log("opencgaClient is null or undefined");
      return;
    }

    PolymerUtils_PolymerUtils.hide(this._prefix + "Warning");
    this.clearPlots();
    this.loading = true; //this.querySelector("#loading").style.display = "block";
    // Join 'query' from left menu and facet filters

    let queryParams = opencb_facet_query_objectSpread({}, this.query, {
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias,
      sid: this.opencgaSession.opencgaClient._config.sessionId,
      fields: this.facetFilters.join(";"),
      timeout: 60000
    });

    console.warn("queryParams", queryParams);
    this.opencgaSession.opencgaClient[this.resource]().aggregationStats(queryParams).then(queryResponse => {
      this.facetResults = queryResponse.response[0].result[0].results;
      this.loading = false; //this.querySelector("#loading").style.display = "none";

      this._showInitMessage = false;
    }).catch(e => {
      console.log(e); //this.querySelector("#loading").style.display = "none";

      this.loading = false;
      this.errorState = "Error from server: " + e.error;
      this._showInitMessage = false;
    }).finally(() => this.requestUpdate());
  }

  clearPlots() {
    if (utilsNew_UtilsNew.isNotUndefined(this.results) && this.results.length > 0) {
      for (let result of this.results) {
        PolymerUtils_PolymerUtils.removeElement(this._prefix + result.name + "Plot");
      }
    }

    this.results = [];
  }

  clear() {
    this.clearPlots();
    this.chromosome = "";
    this.facets = new Set();
    this.facetFilters = [];
    PolymerUtils_PolymerUtils.hide(this._prefix + "Warning");
    this.facetFields = [];
    this.facetRanges = [];
    this.facetFieldsName = [];
    this.facetRangeFields = [];
    this._showInitMessage = true;
    this.requestUpdate();
  }

  facetSearch() {
    //query.study = this.opencgaSession.study.fqn;
    this.dispatchEvent(new CustomEvent("facetSearch", {
      detail: this.query,
      bubbles: true,
      composed: true
    }));
  }

  getDefaultConfig__Variant() {
    return {
      // title: "Aggregation Stats",
      active: false,
      populationFrequencies: true,
      defaultStats: {
        visible: true,
        fields: ["chromosome", "biotypes", "type"]
      },
      fields: {
        terms: [{
          name: "Chromosome",
          value: "chromosome"
        }, {
          name: "Studies",
          value: "studies"
        }, {
          name: "Variant Type",
          value: "type"
        }, {
          name: "Genes",
          value: "genes"
        }, {
          name: "Biotypes",
          value: "biotypes"
        }, {
          name: "Consequence Type",
          value: "soAcc"
        }],
        ranges: [{
          name: "PhastCons",
          value: "phastCons",
          default: "[0..1]:0.1"
        }, {
          name: "PhyloP",
          value: "phylop",
          default: ""
        }, {
          name: "Gerp",
          value: "gerp",
          default: "[-12.3..6.17]:2"
        }, {
          name: "CADD Raw",
          value: "caddRaw"
        }, {
          name: "CADD Scaled",
          value: "caddScaled"
        }, {
          name: "Sift",
          value: "sift",
          default: "[0..1]:0.1"
        }, {
          name: "Polyphen",
          value: "polyphen",
          default: "[0..1]:0.1"
        }]
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencb_facet_query_templateObject(), this.active ? lit_html_lit_html_html(opencb_facet_query_templateObject2(), this.facetSearch, this.facetResults, this.errorState, this.loading) : null);
  }

}

customElements.define("opencb-facet-query", opencb_facet_query_OpencbFacetQuery);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/files/opencga-file-browser.js
function opencga_file_browser_templateObject3() {
  const data = opencga_file_browser_taggedTemplateLiteral(["\n                                <button type=\"button\" class=\"btn btn-success file-browser-view-buttons ripple\" data-view=\"FileComparator\" @click=\"", "\">\n                                    <i class=\"fa fa-users icon-padding\" aria-hidden=\"true\" data-view=\"FileComparator\" @click=\"", "\"></i> File Comparator\n                                </button>\n                            "]);

  opencga_file_browser_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_file_browser_templateObject2() {
  const data = opencga_file_browser_taggedTemplateLiteral(["\n            <div class=\"page-title\">\n                <h2>\n                    <i class=\"fa fa-users\" aria-hidden=\"true\"></i> </i>&nbsp;", "\n                </h2>\n            </div>\n        "]);

  opencga_file_browser_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_file_browser_templateObject() {
  const data = opencga_file_browser_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .icon-padding {\n                padding-left: 4px;\n                padding-right: 5px;\n            }\n\n            .detail-tab-title {\n                font-size: 115%;\n                font-weight: bold;\n            }\n        </style>\n\n        ", "\n        \n        <div class=\"row\" style=\"padding: 0px 10px\">\n            <div class=\"col-md-2\">\n                <opencga-file-filter .opencgaSession=\"", "\"\n                                     .config=\"", "\"\n                                     .files=\"", "\"\n                                     .query=\"", "\"\n                                     .search=\"", "\"\n                                     .variableSets=\"", "\"\n                                     @queryChange=\"", "\"\n                                     @querySearch=\"", "\">\n                </opencga-file-filter>\n            </div>\n\n            <div class=\"col-md-10\">\n                <opencga-active-filters .opencgaSession=\"", "\"\n                                        .query=\"", "\"\n                                        .refresh=\"", "\"\n                                        .defaultStudy=\"", "\"\n                                        .config=\"", "\"\n                                        .alias=\"", "\"\n                                        @activeFilterClear=\"", "\"\n                                        @activeFilterChange=\"", "\">\n                </opencga-active-filters>\n\n                <!-- File View Buttons -->\n                <div class=\"col-md-12\" style=\"padding: 5px 0px 5px 0px\">\n                    <div class=\"btn-toolbar\" role=\"toolbar\" aria-label=\"...\" style=\"padding: 10px 0px;margin-left: 0px\">\n                        <div class=\"btn-group\" role=\"group\" style=\"margin-left: 0px\">\n                            <button type=\"button\" class=\"btn btn-success file-browser-view-buttons active ripple\" data-view=\"TableResult\" @click=\"", "\">\n                                <i class=\"fa fa-table icon-padding\" aria-hidden=\"true\" data-view=\"TableResult\" @click=\"", "\"></i> Table Result\n                            </button>\n                            <button type=\"button\" class=\"btn btn-success file-browser-view-buttons ripple\" data-view=\"Summary\"\n                                @click=\"", "\">\n                                <i class=\"fas fa-chart-bar icon-padding\" aria-hidden=\"true\" data-view=\"Summary\" @click=\"", "\"></i> Summary Stats\n                            </button>\n                            ", "\n                            \n                        </div>\n                    </div>\n                </div>\n\n\n                <!--File View Content-->\n                <div>\n                    <div id=\"", "TableResult\" class=\"file-browser-view-content\">\n                        <opencga-file-grid .opencgaSession=\"", "\"\n                                           .config=\"", "\"\n                                           .query=\"", "\"\n                                           .search=\"", "\"\n                                           .eventNotifyName=\"", "\"\n                                           .files=\"", "\"\n                                           style=\"font-size: 12px\"\n                                           @selectfile=\"", "\">\n                        </opencga-file-grid>\n\n                        <div style=\"padding-top: 5px\">\n                            <ul id=\"", "ViewTabs\" class=\"nav nav-tabs\" role=\"tablist\">\n\n                                <li role=\"presentation\" class=\"active\">\n                                    <a href=\"#", "FileViewer\" role=\"tab\" data-toggle=\"tab\" class=\"detail-tab-title\">\n                                        File info\n                                    </a>\n                                </li>\n\n                                <li role=\"presentation\">\n                                    <a href=\"#", "SampleViewer\" role=\"tab\" data-toggle=\"tab\" class=\"detail-tab-title\">\n                                        Sample grid\n                                    </a>\n                                </li>\n                            </ul>\n\n                            <div class=\"tab-content\" style=\"height: 680px\">\n                                <div role=\"tabpanel\" class=\"tab-pane active\" id=\"", "FileViewer\">\n                                    Work in progress\n                                </div>\n                                <div role=\"tabpanel\" class=\"tab-pane\" id=\"", "SampleViewer\">\n                                    <opencga-sample-grid .opencgaClient=\"", "\"\n                                                         .opencgaSession=\"", "\"\n                                                         .search=\"", "\"\n                                                         style=\"font-size: 12px\">\n                                    </opencga-sample-grid>\n                                </div>\n\n                            </div>\n                        </div>\n\n                    </div>\n\n                    <div id=\"", "Summary\" class=\"file-browser-view-content\" style=\"display: none\">\n                        <opencb-facet-query resource=\"files\"\n                                            .opencgaSession=\"", "\"\n                                            .cellbaseClient=\"", "\"  \n                                            .config=\"", "\"\n                                            .query=\"", "\"\n                                            .active=\"", "\">\n                        </opencb-facet-query>\n                    </div>\n\n                    <div id=\"", "FileComparator\" class=\"file-browser-view-content\" style=\"display: none\">\n\n                        <opencga-file-grid .opencgaSession=\"", "\"\n                                            .config=\"", "\"\n                                            .eventNotifyName=\"", "\"\n                                            .files=\"", "\"\n                                            .search=\"", "\"\n                                            style=\"font-size: 12px\">\n                        </opencga-file-grid>\n\n                        <div style=\"padding-top: 5px\">\n                            <h3> Annotation comparator</h3>\n                            <opencga-annotation-viewer .opencgaClient=\"", "\"\n                                                       .opencgaSession=\"", "\"\n                                                       .config=\"", "\"\n                                                       .entryIds=\"", "\"\n                                                       entity=\"FILE\">\n                            </opencga-annotation-viewer>\n                        </div>\n\n                    </div>\n                </div>\n\n            </div>\n        </div>\n        "]);

  opencga_file_browser_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_file_browser_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_file_browser_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_file_browser_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_file_browser_ownKeys(Object(source), true).forEach(function (key) { opencga_file_browser_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_file_browser_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_file_browser_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */









 //TODO check functionality (notify usage)

class opencga_file_browser_OpencgaFileBrowser extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      filters: {
        type: Object //notify: true

      },
      search: {
        type: Object //notify: true

      },
      config: {
        type: Object
      },
      query: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ofb-" + utils.randomString(6) + "_";
    this.files = []; // TODO recheck what's the point of this

    this._config = this.getDefaultConfig();
    this.filtersConfig = {
      complexFields: ["annotation"]
    };
  }

  updated(changedProperties) {
    if (changedProperties.has("filters")) {
      this.onFilterUpdate();
    }

    if (changedProperties.has("config")) {
      this.configObserver();
    }

    if (changedProperties.has("opencgaSession") || changedProperties.has("config")) {
      this.filterAvailableVariableSets();
    }

    if (changedProperties.has("query")) {
      this.queryObserver();
    }
  }

  configObserver() {
    this._config = Object.assign(this.getDefaultConfig(), this.config);
  }

  queryObserver() {
    console.log(this.query);

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query)) {
      this.preparedQuery = opencga_file_browser_objectSpread({}, this.query);
      this.executedQuery = opencga_file_browser_objectSpread({}, this.query);
    }

    this.requestUpdate();
  }

  onClear() {
    this._config = Object.assign(this.getDefaultConfig(), this.config);
    this.query = {};
    this.search = {};
  }

  onSelectFile(e) {
    this.file = e.detail.file;
    let sampleList = [];

    for (let i = 0; i < e.detail.file.samples.length; i++) {
      sampleList.push(e.detail.file.samples[i].id);
    }

    this.sampleSearch = {
      id: sampleList.join(",")
    };
  }

  _changeView(e) {
    e.preventDefault(); // prevents the hash change to "#" and allows to manipulate the hash fragment as needed

    $('.file-browser-view-content').hide(); // hides all content divs

    if (typeof e.target !== "undefined" && typeof e.target.dataset.view !== "undefined") {
      PolymerUtils_PolymerUtils.show(this._prefix + e.target.dataset.view);
    } // Show the active button


    $('.file-browser-view-buttons').removeClass("active");
    $(e.target).addClass("active");

    if (e.target.dataset.view === "Summary") {
      this.SummaryActive = true;
      this.requestUpdate();
    } else {
      this.SummaryActive = false;
    }
  }

  filterAvailableVariableSets() {
    this._config = Object.assign(this.getDefaultConfig(), this.config);

    if (this._config.disableVariableSets) {
      this.variableSets = [];
      return;
    }

    if (this._config.variableSetIds.length === 0) {
      this.variableSets = this.opencgaSession.study.variableSets;
    } else {
      let variableSets = [];

      for (let i = 0; i < this.opencgaSession.study.variableSets.length; i++) {
        if (this._config.variableSetIds.indexOf(this.opencgaSession.study.variableSets[i].id) !== -1) {
          variableSets.push(this.opencgaSession.study.variableSets[i]);
        }
      }

      this.variableSets = variableSets;
    }

    this.requestUpdate();
  }

  isNotEmpty(myArray) {
    return utilsNew_UtilsNew.isNotEmptyArray(myArray);
  }

  onQueryFilterChange(e) {
    this.preparedQuery = e.detail.query;
    this.requestUpdate();
  }

  onQueryFilterSearch(e) {
    this.preparedQuery = e.detail.query;
    this.executedQuery = e.detail.query;
    this.requestUpdate();
  }

  onActiveFilterChange(e) {
    this.preparedQuery = opencga_file_browser_objectSpread({}, e.detail);
    this.query = opencga_file_browser_objectSpread({}, e.detail);
    this.requestUpdate();
  }

  onActiveFilterClear() {
    //this._config = Object.assign(this.getDefaultConfig(), this.config);
    this.query = {}; //this.search = {};

    this.preparedQuery = {};
    this.requestUpdate();
  }

  getDefaultConfig() {
    return {
      title: "File Browser",
      showTitle: true,
      showAggregationStats: true,
      showComparator: true,
      disableVariableSets: false,
      filter: {},
      grid: {},
      gridComparator: {
        multiselection: true,
        pageSize: 5,
        pageList: [5, 10]
      },
      variableSetIds: [],
      summary: {
        fields: ["type", "format", "bioformat"]
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_file_browser_templateObject(), this._config.showTitle ? lit_html_lit_html_html(opencga_file_browser_templateObject2(), this._config.title) : null, this.opencgaSession, this._config.filter, this.files, this.query, this.search, this.variableSets, this.onQueryFilterChange, this.onQueryFilterSearch, this.opencgaSession, this.preparedQuery, this.executedQuery, this.opencgaSession.study.alias, this.filtersConfig, this.activeFilterAlias, this.onActiveFilterClear, this.onActiveFilterChange, this._changeView, this._changeView, this._changeView, this._changeView, this.isNotEmpty(this.variableSets) ? lit_html_lit_html_html(opencga_file_browser_templateObject3(), this._changeView, this._changeView) : null, this._prefix, this.opencgaSession, this._config.grid, this.executedQuery, this.executedQuery, this.eventNotifyName, this.files, this.onSelectFile, this._prefix, this._prefix, this._prefix, this._prefix, this._prefix, this.opencgaSession.opencgaClient, this.opencgaSession, this.sampleSearch, this._prefix, this.opencgaSession, this.cellbaseClient, this._config, this.executedQuery, this.SummaryActive, this._prefix, this.opencgaSession, this._config.gridComparator, this.eventNotifyName, this.files, this.search, this.opencgaSession.opencgaClient, this.opencgaSession, this._config, this.files);
  }

}
customElements.define("opencga-file-browser", opencga_file_browser_OpencgaFileBrowser);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/variant-protein-view.js
function variant_protein_view_templateObject9() {
  const data = variant_protein_view_taggedTemplateLiteral(["\n                <div style=\"padding-left: 10px\">\n                    <h4>No proteins present</h4>\n                </div>\n            "]);

  variant_protein_view_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function variant_protein_view_templateObject8() {
  const data = variant_protein_view_taggedTemplateLiteral(["\n                        <br>\n                        <div role=\"tabpanel\" class=\"tab-pane\" id=\"", "{protein.id}\"></div>\n                        <br>\n                        "]);

  variant_protein_view_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function variant_protein_view_templateObject7() {
  const data = variant_protein_view_taggedTemplateLiteral(["\n                        <br>\n                        <div role=\"tabpanel\" class=\"tab-pane active\" id=\"", "", "\"></div>\n                        <br>\n                        "]);

  variant_protein_view_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function variant_protein_view_templateObject6() {
  const data = variant_protein_view_taggedTemplateLiteral(["\n                    ", "\n                        <a href=\"#protein/", "/", "/", "\">Please click here for more details</a>\n                "]);

  variant_protein_view_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function variant_protein_view_templateObject5() {
  const data = variant_protein_view_taggedTemplateLiteral(["\n                <div id=\"proteinsDiv\">\n                ", "\n                </div>\n            "]);

  variant_protein_view_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function variant_protein_view_templateObject4() {
  const data = variant_protein_view_taggedTemplateLiteral(["\n                    <br>\n                    <li role=\"presentation\"><a href=\"#", "", "\" role=\"tab\" data-toggle=\"tab\">", "</a></li>\n                "]);

  variant_protein_view_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function variant_protein_view_templateObject3() {
  const data = variant_protein_view_taggedTemplateLiteral(["\n                    <br>\n                    <li role=\"presentation\" class=\"active\"><a href=\"#", "", "\" role=\"tab\" data-toggle=\"tab\">", "</a></li>\n                "]);

  variant_protein_view_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function variant_protein_view_templateObject2() {
  const data = variant_protein_view_taggedTemplateLiteral(["\n                ", "\n            "]);

  variant_protein_view_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function variant_protein_view_templateObject() {
  const data = variant_protein_view_taggedTemplateLiteral(["\n        <style include=\"jso-styles\"></style>\n\n        <!--<h4>{{study.alias}} - {{protein.id}}</h4>-->\n\n        <ul class=\"nav nav-pills\">\n            ", "\n        </ul>\n\n        <div class=\"tab-content\">\n            ", "\n        </div>\n        "]);

  variant_protein_view_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function variant_protein_view_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


 //TODO Lollipop dependency

class variant_protein_view_VariantProteinView extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      config: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      query: {
        type: Object
      },
      gene: {
        type: String
      },
      // xref ids accept protein ids, transcript ids. Eg: CCDS31418.1,Q9UL59,ENST00000278314
      ids: {
        type: String
      }
    };
  }

  _init() {
    this._prefix = "proteinView" + utils.randomString(6) + "_";
    this.proteins = [];
  }

  updated(changedProperties) {
    if (changedProperties.has("gene") || changedProperties.has("ids")) {
      this._fetchProteins();
    }
  }

  checkProteinsAvailable(proteins) {
    return proteins.length > 0;
  }

  _fetchProteins() {
    this.proteins = []; // Reset the previously shown proteins svg

    if (typeof this.cellbaseClient !== "undefined" && typeof this.opencgaClient !== "undefined") {
      const _this = this;

      const queryParams = {};

      if (typeof this.gene !== "undefined" && this.gene !== "") {
        queryParams.gene = this.gene;

        if (typeof this.ids !== "undefined" && this.ids !== "") {
          queryParams.xrefs = this.ids;
        }
      } else if (typeof this.ids !== "undefined" && this.ids !== "") {
        queryParams.xrefs = this.ids;
      }

      this.cellbaseClient.getProteinClient(null, "search", queryParams).then(function (response) {
        const proteinObjects = response.response[0].result; // This render the Bootstrap tabs with Nav pills

        const _proteins = [];

        for (let i = 0; i < proteinObjects.length; i++) {
          _proteins.push({
            id: proteinObjects[i].accession[0],
            active: i === 0
          });
        }

        _this.proteins = _proteins; // DO NOT EVEN DARE TO TOUCH THIS LINE! //fixme to LitElement

        _this.$.proteinsDiv.render();

        if (proteinObjects.length > 0 && typeof _this.opencgaSession.project !== "undefined" && typeof _this.opencgaSession.study !== "undefined" && typeof _this.opencgaSession.study.alias !== "undefined") {
          const params = {
            ct: "missense_variant,transcript_ablation,splice_acceptor_variant,splice_donor_variant,stop_gained,frameshift_variant,stop_lost,start_lost," + "transcript_amplification,inframe_insertion,inframe_deletion",
            studies: _this.opencgaSession.project.alias + ":" + _this.opencgaSession.study.alias,
            returnedStudies: _this.opencgaSession.project.alias + ":" + _this.opencgaSession.study.alias,
            summary: true // exclude: "studies.samplesData,studies.files"

          };

          if (typeof _this.gene !== "undefined" && _this.gene !== "") {
            params.gene = _this.gene;
          } else if (typeof _this.ids !== "undefined" && _this.ids !== "") {
            params["annot-xref"] = _this.ids;
          }

          _this.opencgaClient.variants().query(params).then(function (variants) {
            const lollipop = new Lollipop();

            for (let i = 0; i < proteinObjects.length; i++) {
              const svgSettings = {
                // width: proteinObjects[i].sequence.length,
                width: 1280,
                height: 140,
                proteinPositioningInterval: 3,
                color: _this.config.color
              };
              const svg = lollipop.createSvg(proteinObjects[i], variants.response[0].result, svgSettings);
              const querySelector = PolymerUtils_PolymerUtils.getElementById(_this._prefix + proteinObjects[i].accession[0]);
              querySelector.appendChild(svg);
            }
          }).catch(function (e) {
            console.log(e);
          });
        }
      }).catch(function (e) {
        console.log(e);
      });
    }
  }

  render() {
    return lit_html_lit_html_html(variant_protein_view_templateObject(), this.proteins && this.proteins.length ? this.proteins.map(protein => lit_html_lit_html_html(variant_protein_view_templateObject2(), protein.active ? lit_html_lit_html_html(variant_protein_view_templateObject3(), this._prefix, protein.id, protein.id) : lit_html_lit_html_html(variant_protein_view_templateObject4(), this._prefix, protein.id, protein.id))) : null, this.checkProteinsAvailable(this.proteins) ? lit_html_lit_html_html(variant_protein_view_templateObject5(), this.proteins.map(protein => lit_html_lit_html_html(variant_protein_view_templateObject6(), protein.active ? lit_html_lit_html_html(variant_protein_view_templateObject7(), this._prefix, protein.id) : lit_html_lit_html_html(variant_protein_view_templateObject8(), this._prefix), this.opencgaSession.project.alias, this.opencgaSession.study.alias, protein.id))) : lit_html_lit_html_html(variant_protein_view_templateObject9()));
  }

}
customElements.define("variant-protein-view", variant_protein_view_VariantProteinView);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/opencga-transcript-view.js
function opencga_transcript_view_templateObject3() {
  const data = opencga_transcript_view_taggedTemplateLiteral(["\n                <div>\n                    <br>\n                    <h3>Please select a variant to view variant's detailed annotation</h3>\n                </div>\n                "]);

  opencga_transcript_view_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_transcript_view_templateObject2() {
  const data = opencga_transcript_view_taggedTemplateLiteral(["\n                    <!-- Bottom tabs with specific variant information -->\n                    <div style=\"padding-top: 20px; height: 400px\">\n                        <h3>Advanced Annotation for Variant: ", "</h3>\n                        <cellbase-variantannotation-view _prefix=\"", "\" \n                                                        .data=\"", "\"\n                                                        .cellbaseClient=\"", "\"\n                                                        .assembly=", "\n                                                        .hashFragmentCredentials=\"", "\"\n                                                        .populationFrequencies=\"", "\"\n                                                        .proteinSubstitutionScores=\"", "\"\n                                                        .consequenceTypes=\"", "\"\n                                                        style=\"font-size: 12px\">\n                        </cellbase-variantannotation-view>\n                    </div>\n                "]);

  opencga_transcript_view_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_transcript_view_templateObject() {
  const data = opencga_transcript_view_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .transcript-variant-tab-title {\n                font-size: 150%;\n                font-weight: bold;\n            }\n\n            .transcript-summary-title {\n                font-weight: bold;\n            }\n        </style>\n\n        <div>\n            <div style=\"float: right;padding: 10px 5px 10px 5px\">\n                <button type=\"button\" class=\"btn btn-primary\" @click=\"", "\">\n                    <i class=\"fa fa-hand-o-left\" aria-hidden=\"true\"></i> Variant Browser\n                </button>\n            </div>\n\n            <h2>", "</h2>\n\n            <div class=\"row\" style=\"padding: 5px 0px 25px 0px\">\n                <div class=\"col-md-5\">\n                    <h3>Summary</h3>\n                    <table width=\"100%\">\n                        <tr>\n                            <td class=\"transcript-summary-title\" width=\"20%\">Name</td>\n                            <td width=\"80%\">", " (", ")</td>\n                        </tr>\n                        <tr>\n                            <td class=\"transcript-summary-title\" width=\"20%\">Biotype</td>\n                            <td width=\"80%\">", "</td>\n                        </tr>\n                        <tr>\n                            <td class=\"transcript-summary-title\">Location</td>\n                            <td>", ":", "-", "\n                                (", ")\n                            </td>\n                        </tr>\n                        <tr>\n                            <td class=\"transcript-summary-title\">Gene</td>\n                            <td><a href=\"#gene/", "/", "/", "\">", "</a></td>\n                        </tr>\n                        <tr>\n                            <td class=\"transcript-summary-title\">Genome Browser</td>\n                            <td>\n                                <a target=\"_blank\"\n                                   href=\"http://genomemaps.org/?region=", ":", "-", "\">\n                                    ", ":", "-", "\n                                </a>\n                            </td>\n                        </tr>\n                    </table>\n                </div>\n\n            </div>\n        </div>\n\n        <div id=\"", "TranscriptSvg\"></div>\n\n        <ul id=\"", "ViewTabs\" class=\"nav nav-tabs\" role=\"tablist\">\n            <li role=\"presentation\" class=\"active\">\n                <a href=\"#", "Variants\" role=\"tab\" data-toggle=\"tab\" class=\"transcript-variant-tab-title\">\n                    Variants\n                </a>\n            </li>\n            <li role=\"presentation\">\n                <a href=\"#", "Protein\" role=\"tab\" data-toggle=\"tab\" class=\"transcript-variant-tab-title\">\n                    Protein\n                </a>\n            </li>\n        </ul>\n\n        <div class=\"tab-content\" style=\"height: 1024px\">\n            <div role=\"tabpanel\" class=\"tab-pane active\" id=\"", "Variants\">\n                <div class=\"btn-group btn-group\" role=\"group\" aria-label=\"...\" style=\"padding: 15px;float: right\">\n                    <button id=\"", "AllConsTypeButton\" type=\"button\" class=\"btn btn-default btn-warning transcript-ct-buttons active\" @click=\"", "\">\n                        All\n                    </button>\n                    <button id=\"", "MissenseConsTypeButton\" type=\"button\" class=\"btn btn-default btn-warning transcript-ct-buttons\" @click=\"", "\">\n                        Missense\n                    </button>\n                    <button id=\"", "LoFConsTypeButton\" type=\"button\" class=\"btn btn-default btn-warning transcript-ct-buttons\" @click=\"", "\">\n                        LoF\n                    </button>\n                </div>\n\n                <br>\n                <br>\n                <variant-browser-grid _prefix=\"", "\" \n                                      .project=\"", "\"\n                                      .study=\"", "\"\n                                      .opencga-client=\"", "\"\n                                      .population-frequencies=\"", "\"\n                                      .protein-substitution-scores=\"", "\"\n                                      .consequence-types=\"", "\"\n                                      .search=\"", "\"\n                                      .query=\"", "\"\n                                      .variant=\"", "\"\n                                      style=\"font-size: 12px\"\n                                      @selectvariant=\"", "\">\n                </variant-browser-grid>\n\n                ", "\n            </div>\n\n            <div role=\"tabpanel\" class=\"tab-pane\" id=\"", "Protein\">\n                <variant-protein-view .opencgaClient=\"", "\"\n                                      .cellbaseClient=\"", "\"\n                                      .project=\"", "\"\n                                      .study=\"", "\"\n                                      .ids=\"", "\"\n                                      .config=\"", "\">\n                </variant-protein-view>\n            </div>\n        </div>\n        "]);

  opencga_transcript_view_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_transcript_view_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */






class opencga_transcript_view_OpencgaTranscriptView extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      cellbaseClient: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      project: {
        type: Object
      },
      study: {
        type: Object
      },
      transcript: {
        type: String
      },
      gene: {
        type: String
      },
      populationFrequencies: {
        type: Array
      },
      proteinSubstitutionScores: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      variant: {
        type: String
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "transcript" + utils.randomString(6);
    this.variant = "";
    this.transcriptObj = {};
  }

  updated(changedProperties) {
    if (changedProperties.has("transcript")) {
      this.transcriptChanged();
    }

    if (changedProperties.has("project") || changedProperties.has("study")) {
      this.projectStudyObtained();
    }
  }

  projectStudyObtained(project, study) {
    if (utilsNew_UtilsNew.isNotUndefined(this.project) && utilsNew_UtilsNew.isNotEmpty(this.project.alias) && utilsNew_UtilsNew.isNotUndefined(this.study) && utilsNew_UtilsNew.isNotEmpty(this.study.alias)) {
      this.hashFragmentCredentials = {
        project: this.project.alias,
        study: this.study.alias
      };
    }
  }

  transcriptChanged() {
    // Remove the previously added SVG
    let svg = PolymerUtils_PolymerUtils.querySelector("svg");

    if (svg !== null) {
      let proteinSvgDiv = PolymerUtils_PolymerUtils.getElementById(this._prefix + "TranscriptSvg");

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(proteinSvgDiv)) {// proteinSvgDiv.removeChild(svg);
      }
    }

    let query = {};

    let _this = this;

    if (utilsNew_UtilsNew.isNotEmpty(this.transcript)) {
      query["annot-xref"] = this.transcript;
      this.cellbaseClient.getTranscriptClient(this.transcript, 'info', {
        exclude: "xrefs, exons.sequence"
      }, {}).then(function (response) {
        _this.transcriptObj = response.response[0].result[0]; // FIXME We need to improve how the transcript is rendered
        // let svg = _this._createSvgTranscript(_this.transcriptObj);
        // let querySelector = PolymerUtils.getElementById(_this._prefix + "TranscriptSvg");
        // querySelector.appendChild(svg);
      });
      _this.query = query;
    }
  }

  updateQuery(e) {
    PolymerUtils_PolymerUtils.removeClass(".transcript-ct-buttons", "active");
    PolymerUtils_PolymerUtils.addClass(e.target.id, "active");
    let query = this.query;

    switch (e.target.innerText) {
      case "Missense":
        query["ct"] = "missense_variant";
        break;

      case "LoF":
        query["ct"] = this.consequenceTypes.lof.join(",");
        break;

      default:
        if (utilsNew_UtilsNew.isNotUndefined(query["ct"])) {
          delete query["ct"];
        }

        break;
    }

    this.query = Object.assign({}, query);
  }

  checkVariant(variant) {
    return variant.split(':').length > 2;
  }

  showBrowser() {
    let hash = window.location.hash.split('/');
    let newHash = '#browser/' + hash[1] + '/' + hash[2];
    window.location.hash = newHash;
  }

  onSelectVariant(e) {
    this.variant = e.detail.id;
  }

  _createSvgTranscript(transcriptObject) {
    let length = transcriptObject.end - transcriptObject.start;
    let svg = SVG.create('svg', {
      width: length + 40,
      height: 140,
      viewBox: "0 0 " + (length + 40) + " " + 140,
      style: "fill: white"
    });
    SVG.addChild(svg, 'rect', {
      width: length + 40,
      height: 140,
      style: "fill: white;stroke: black"
    });
    let center = 140 / 2;
    SVG.addChild(svg, 'line', {
      x1: 20,
      y1: center,
      x2: length,
      y2: center,
      style: "stroke: red"
    });
    let exons = transcriptObject.exons;
    let gExons = SVG.create('g', {});

    for (let i = 0; i < exons.length; i++) {
      let exon = SVG.addChild(gExons, 'rect', {
        x: 20 + (exons[i].start - transcriptObject.start),
        y: center - 7,
        rx: 2,
        ry: 2,
        width: exons[i].end - exons[i].start,
        height: 15,
        style: "fill: lightblue"
      });
      $(exon).qtip({
        content: {
          title: exons[i].id,
          text: "<b>ID</b>: " + exons[i].id + "<br>" + "<b>Chromosome</b>: " + exons[i].chromosome + "<br>" + "<b>Start</b>: " + exons[i].start + "<br>" + "<b>End</b>: " + exons[i].end + "<br>" + "<b>Strand</b>: " + exons[i].strand
        },
        position: {
          viewport: $(window),
          target: "mouse",
          adjust: {
            x: 25,
            y: 15
          }
        },
        style: {
          width: true,
          classes: ' ui-tooltip ui-tooltip-shadow'
        },
        show: {
          delay: 250
        },
        hide: {
          delay: 200
        }
      });
    }

    svg.appendChild(gExons);
    let lollipop = new Lollipop();

    let ruleSVG = lollipop._createSvgRuleBar(length, {
      ratio: 1
    });

    svg.appendChild(ruleSVG);
    return svg;
  }

  render() {
    return lit_html_lit_html_html(opencga_transcript_view_templateObject(), this.showBrowser, this.transcriptObj.name, this.transcriptObj.name, this.transcriptObj.id, this.transcriptObj.biotype, this.transcriptObj.chromosome, this.transcriptObj.start, this.transcriptObj.end, this.transcriptObj.strand, this.project.alias, this.study.alias, this.gene, this.gene, this.transcriptObj.chromosome, this.transcriptObj.start, this.transcriptObj.end, this.transcriptObj.chromosome, this.transcriptObj.start, this.transcriptObj.end, this._prefix, this._prefix, this._prefix, this._prefix, this._prefix, this._prefix, this.updateQuery, this._prefix, this.updateQuery, this._prefix, this.updateQuery, this._prefix, this.project, this.study, this.opencgaClient, this.populationFrequencies, this.proteinSubstitutionScores, this.consequenceTypes, this.query, this.query, this.variant, this.onSelectVariant, this.checkVariant(this.variant) ? lit_html_lit_html_html(opencga_transcript_view_templateObject2(), this.variant, this._prefix, this.variant, this.cellbaseClient, this.project.organism.assembly, this.hashFragmentCredentials, this.populationFrequencies, this.proteinSubstitutionScores, this.consequenceTypes) : lit_html_lit_html_html(opencga_transcript_view_templateObject3()), this._prefix, this.opencgaClient, this.cellbaseClient, this.project, this.study, this.transcriptObj.id, this.config.protein);
  }

}
customElements.define("opencga-transcript-view", opencga_transcript_view_OpencgaTranscriptView);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/opencga-gene-view.js
function opencga_gene_view_templateObject4() {
  const data = opencga_gene_view_taggedTemplateLiteral(["\n                    <div>\n                        <br>\n                        <h3>Please select a variant to view the detailed annotation</h3>\n                    </div>\n                "]);

  opencga_gene_view_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_gene_view_templateObject3() {
  const data = opencga_gene_view_taggedTemplateLiteral(["\n                    <!-- Bottom tabs with specific variant information -->\n                    <div style=\"padding-top: 20px; height: 400px\">\n                        <h3>Advanced Annotation for Variant: ", "</h3>\n                        <cellbase-variantannotation-view _prefix=\"", "\"\n                                                         .data=\"", "\"\n                                                         .cellbaseClient=\"", "\"\n                                                         .assembly=", "\n                                                         .hashFragmentCredentials=\"", "\"\n                                                         .populationFrequencies=\"", "\"\n                                                         .proteinSubstitutionScores=\"", "\"\n                                                         .consequenceTypes=\"", "\"\n                                                         style=\"font-size: 12px\">\n                        </cellbase-variantannotation-view>\n                    </div>\n                "]);

  opencga_gene_view_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_gene_view_templateObject2() {
  const data = opencga_gene_view_taggedTemplateLiteral(["\n                            <tr>\n                                <td>", "</td>\n                                <td>\n                                    <a href=\"#transcript/", "/", "/", "\">", "</a>\n                                </td>\n                                <td>", "</td>\n                                <td>\n                                    <a target=\"_blank\"\n                                       href=\"http://genomemaps.org/?region=", ":", "-", "\">\n                                        ", ":", "-", "\n                                    </a>\n                                </td>\n                                <td>\n                                    <a target=\"_blank\"\n                                       href=\"http://genomemaps.org/?region=", ":", "-", "\">\n                                        ", "-", "\n                                    </a>\n                                </td>\n                                <!--<td>-->\n                                <!--", "-", "-->\n                                <!--</td>-->\n                                <!--<td>", "</td>-->\n                                <td>", "</td>\n                            </tr>\n                        "]);

  opencga_gene_view_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_gene_view_templateObject() {
  const data = opencga_gene_view_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .gene-variant-tab-title {\n                font-size: 150%;\n                font-weight: bold;\n            }\n\n            .gene-summary-title {\n                font-weight: bold;\n            }\n        </style>\n\n        <div>\n            <div style=\"float: right;padding: 10px 5px 10px 5px\">\n                <button type=\"button\" class=\"btn btn-primary\" @click=\"", "\">\n                    <i class=\"fa fa-hand-o-left\" aria-hidden=\"true\"></i> Variant Browser\n                </button>\n            </div>\n\n            <h2>", "</h2>\n\n            <div class=\"row\" style=\"padding: 5px 0px 25px 0px\">\n                <div class=\"col-md-4\">\n                    <h3>Summary</h3>\n                    <table width=\"100%\">\n                        <tr>\n                            <td class=\"gene-summary-title\" width=\"20%\">Name</td>\n                            <td width=\"80%\">", " (", ")</td>\n                        </tr>\n                        <tr>\n                            <td class=\"gene-summary-title\" width=\"20%\">Biotype</td>\n                            <td width=\"80%\">", "</td>\n                        </tr>\n                        <tr>\n                            <td class=\"gene-summary-title\" width=\"20%\">Description</td>\n                            <td width=\"80%\">", "</td>\n                        </tr>\n                        <tr>\n                            <td class=\"gene-summary-title\">Location</td>\n                            <td>", ":", "-", " (", ")</td>\n                        </tr>\n                        <tr>\n                            <td class=\"gene-summary-title\">Genome Browser</td>\n                            <td>\n                                <a target=\"_blank\"\n                                   href=\"http://genomemaps.org/?region=", ":", "-", "\">\n                                    ", ":", "-", "\n                                </a>\n                            </td>\n                        </tr>\n                    </table>\n                </div>\n\n                <div class=\"col-md-8\">\n                    <h3>Transcripts</h3>\n                    <table class=\"table table-bordered\" width=\"100%\">\n                        <thead style=\"background-color: #eeeeee\">\n                        <tr>\n                            <th>Name</th>\n                            <th>Ensembl ID</th>\n                            <th>Biotype</th>\n                            <th>Location</th>\n                            <th>Coding</th>\n                            <!--<th>cDNA</th>-->\n                            <!--<th>CDS Length</th>-->\n                            <th>Flags</th>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        ", "\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n\n        <ul id=\"", "ViewTabs\" class=\"nav nav-tabs\" role=\"tablist\">\n            <li role=\"presentation\" class=\"active\">\n                <a href=\"#", "Variants\" role=\"tab\" data-toggle=\"tab\" class=\"gene-variant-tab-title\">Variants</a>\n            </li>\n            <li role=\"presentation\">\n                <a href=\"#", "Protein\" role=\"tab\" data-toggle=\"tab\" class=\"gene-variant-tab-title\">Protein (Beta)</a>\n            </li>\n        </ul>\n\n        <div class=\"tab-content\" style=\"height: 1024px\">\n            <div role=\"tabpanel\" class=\"tab-pane active\" id=\"", "Variants\">\n                <div class=\"btn-group btn-group\" role=\"group\" aria-label=\"...\" style=\"padding: 15px;float: right\">\n                    <button id=\"", "AllConsTypeButton\" type=\"button\" class=\"btn btn-default btn-warning gene-ct-buttons active\" @click=\"", "\">\n                        All\n                    </button>\n                    <button id=\"", "MissenseConsTypeButton\" type=\"button\" class=\"btn btn-default btn-warning gene-ct-buttons\" @click=\"", "\">\n                        Missense\n                    </button>\n                    <button id=\"", "LoFConsTypeButton\" type=\"button\" class=\"btn btn-default btn-warning gene-ct-buttons\" @click=\"", "\">\n                        LoF\n                    </button>\n                </div>\n\n                <!--<br>-->\n                <br>\n                <opencga-variant-grid .opencgaSession=\"", "\"\n                                      .query=\"", "\"\n                                      .populationFrequencies=\"", "\"\n                                      .proteinSubstitutionScores=\"", "\"\n                                      .consequenceTypes=\"", "\"\n                                      .summary=\"", "\"\n                                      .config=\"", "\"\n                                      style=\"font-size: 12px\"\n                                      @selectvariant=\"", "\">\n                </opencga-variant-grid>\n\n                ", "\n                \n\n                \n            </div>\n\n            <div role=\"tabpanel\" class=\"tab-pane\" id=\"", "Protein\">\n                <variant-protein-view .opencgaSession=\"", "\"\n                                      .opencgaClient=\"", "\"\n                                      .cellbaseClient=\"", "\"\n                                      .gene=\"", "\"\n                                      .config=\"", "\"\n                                      .summary=\"", "\">\n                </variant-protein-view>\n            </div>\n        </div>\n        "]);

  opencga_gene_view_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_gene_view_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */






class opencga_gene_view_OpencgaGeneView extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      gene: {
        type: String
      },
      populationFrequencies: {
        type: Array
      },
      proteinSubstitutionScores: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      variant: {
        type: String
      },
      config: {
        type: Object
      },
      summary: {
        type: Boolean
      },
      project: {
        type: Object
      },
      study: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "geneView" + utils.randomString(6) + "_";
    this.variant = "";
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession") || changedProperties.has("gene")) {
      this.geneChanged();
    }

    if (changedProperties.has("project") || changedProperties.has("study")) {
      this.projectStudyObtained();
    }
  }

  projectStudyObtained(project, study) {
    if (utilsNew_UtilsNew.isNotUndefined(this.opencgaSession.project) && utilsNew_UtilsNew.isNotEmpty(this.opencgaSession.project.alias) && utilsNew_UtilsNew.isNotUndefined(this.opencgaSession.study) && utilsNew_UtilsNew.isNotEmpty(this.opencgaSession.study.alias)) {
      this.hashFragmentCredentials = {
        project: this.opencgaSession.project.alias,
        study: this.opencgaSession.study.alias
      };
    }
  }

  geneChanged(neo, old) {
    if (utilsNew_UtilsNew.isNotEmpty(this.gene)) {
      this.query = {
        gene: this.gene,
        study: this.opencgaSession.study.fqn
      };

      const _this = this;

      this.cellbaseClient.getGeneClient(this.gene, "info", {
        exclude: "annotation"
      }, {}).then(function (response) {
        _this.geneObj = response.response[0].result[0];

        _this.requestUpdate();
      });
    }
  }

  updateQuery(e) {
    PolymerUtils_PolymerUtils.removeClass(".gene-ct-buttons", "active");
    PolymerUtils_PolymerUtils.addClass(e.target.id, "active");
    const query = this.query;

    switch (e.target.innerText) {
      case "Missense":
        query["ct"] = "missense_variant";
        break;

      case "LoF":
        query["ct"] = this.consequenceTypes.lof.join(",");
        break;

      default:
        if (utilsNew_UtilsNew.isNotUndefined(query["ct"])) {
          delete query["ct"];
        }

        break;
    }

    this.query = Object.assign({}, query);
  }

  checkVariant(variant) {
    return variant.split(":").length > 2;
  }

  showBrowser() {
    const hash = window.location.hash.split("/");
    const newHash = "#browser/" + hash[1] + "/" + hash[2];
    window.location.hash = newHash;
  }

  onSelectVariant(e) {
    this.variant = e.detail.id;
  }

  render() {
    return this.geneObj ? lit_html_lit_html_html(opencga_gene_view_templateObject(), this.showBrowser, this.geneObj.name, this.geneObj.name, this.geneObj.id, this.geneObj.biotype, this.geneObj.description, this.geneObj.chromosome, this.geneObj.start, this.geneObj.end, this.geneObj.strand, this.geneObj.chromosome, this.geneObj.start, this.geneObj.end, this.geneObj.chromosome, this.geneObj.start, this.geneObj.end, this.geneObj.transcripts && this.geneObj.transcripts.length ? this.geneObj.transcripts.map(transcript => lit_html_lit_html_html(opencga_gene_view_templateObject2(), transcript.name, this.project.alias, this.study.alias, transcript.id, transcript.id, transcript.biotype, transcript.chromosome, transcript.start, transcript.end, transcript.chromosome, transcript.start, transcript.end, transcript.chromosome, transcript.genomicCodingStart, transcript.genomicCodingEnd, transcript.genomicCodingStart, transcript.genomicCodingEnd, transcript.cdnaCodingStart, transcript.cdnaCodingEnd, transcript.cdsLength, transcript.annotationFlags)) : null, this._prefix, this._prefix, this._prefix, this._prefix, this._prefix, this.updateQuery, this._prefix, this.updateQuery, this._prefix, this.updateQuery, this.opencgaSession, this.query, this.populationFrequencies, this.proteinSubstitutionScores, this.consequenceTypes, this.summary, this.config, this.onSelectVariant, this.checkVariant(this.variant) ? lit_html_lit_html_html(opencga_gene_view_templateObject3(), this.variant, this._prefix, this.variant, this.cellbaseClient, this.opencgaSession.project.organism.assembly, this.hashFragmentCredentials, this.populationFrequencies, this.proteinSubstitutionScores, this.consequenceTypes) : lit_html_lit_html_html(opencga_gene_view_templateObject4()), this._prefix, this.opencgaSession, this.opencgaClient, this.cellbaseClient, this.gene, this.config.protein, this.summary) : null;
  }

}
customElements.define("opencga-gene-view", opencga_gene_view_OpencgaGeneView);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/samples/opencga-sample-view.js
function opencga_sample_view_templateObject5() {
  const data = opencga_sample_view_taggedTemplateLiteral(["\n                                        <span>", " (<a href=\"http://compbio.charite.de/hpoweb/showterm?id=", "\" target=\"_blank\">", "</a>)</span>\n                                        <br>\n                                    "]);

  opencga_sample_view_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_sample_view_templateObject4() {
  const data = opencga_sample_view_taggedTemplateLiteral(["\n                                        <span>", " (<a href=\"http://compbio.charite.de/hpoweb/showterm?id=", "\" target=\"_blank\">", "</a>)</span>\n                                        <br>\n                                    "]);

  opencga_sample_view_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_sample_view_templateObject3() {
  const data = opencga_sample_view_taggedTemplateLiteral(["\n                <div class=\"panel\" style=\"margin-bottom: 10px\">\n                    <h2 >&nbsp;", ": ", "</h2>\n                </div>\n            "]);

  opencga_sample_view_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_sample_view_templateObject2() {
  const data = opencga_sample_view_taggedTemplateLiteral(["\n            ", "\n            \n       \n            <div class=\"row\" style=\"padding: 0px 10px\">\n                <div class=\"col-md-12\">\n                    <div class=\"col-md-8\" style=\"padding-left: 0px\">\n                        <!--<h2 style=\"margin-bottom: 5px\"> Summary Sample: {{sample.id}}</h2>-->\n                        <!--<hr style=\"margin: 2px 0px;border-top: 2px solid #eee\">-->\n    \n                        <h3 class=\"section-title\">Summary</h3>\n    \n                        <div class=\"col-md-6\">\n                            <!--<label>Sample</label>-->\n                            <!--<hr style=\"margin: 2px 0px;border-top: 2px solid #eee\">-->\n                            <form class=\"form-horizontal\">\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">Sample ID</label>\n                                    <span class=\"col-md-9\">", "</span>\n                                </div>\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">Version</label>\n                                    <span class=\"col-md-9\">", "</span>\n                                </div>\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">UUID</label>\n                                    <span class=\"col-md-9\">", "</span>\n                                </div>\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">Release</label>\n                                    <span class=\"col-md-9\">", "</span>\n                                </div>\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">Status</label>\n                                    <span class=\"col-md-9\">", "</span>\n                                </div>\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">Creation Date</label>\n                                    <span class=\"col-md-9\">", "</span>\n                                </div>\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">Modification Date</label>\n                                    <span class=\"col-md-9\">", "</span>\n                                </div>\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">Description</label>\n                                    <span class=\"col-md-9\">", "</span>\n                                </div>\n                            </form>\n                        </div>\n    \n                        <div class=\"col-md-6\">\n                            <form class=\"form-horizontal\">\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">File</label>\n                                    <span class=\"col-md-9\">", "</span>\n                                </div>\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">Type</label>\n                                    <span class=\"col-md-9\">", "</span>\n                                </div>\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">Somatic</label>\n                                    <span class=\"col-md-9\">", "</span>\n                                </div>\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">Phenotypes</label>\n                                    <span class=\"col-md-9\">\n                                    ", "\n                                </span>\n                                </div>\n                            </form>\n                        </div>\n                    </div>\n    \n                    <div class=\"col-md-4\" style=\"padding-left: 0px\">\n                        <h3 class=\"section-title\">Individual</h3>\n                        <div class=\"col-md-12\">\n                            <form class=\"form-horizontal\">\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">ID</label>\n                                    <span class=\"col-md-9\">", "aaa</span>\n                                </div>\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">Name</label>\n                                    <span class=\"col-md-9\">", "bbb</span>\n                                </div>\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">Version</label>\n                                    <span class=\"col-md-9\">", "</span>\n                                </div>\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">UUID</label>\n                                    <span class=\"col-md-9\">", "</span>\n                                </div>\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">Sex (Karyotype)</label>\n                                    <span class=\"col-md-9\">", "MALE (", "XY)</span>\n                                </div>\n                                <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                    <label class=\"col-md-3 label-title\">Phenotypes</label>\n                                    <span class=\"col-md-9\">\n                                    ", "\n                                </span>\n                                </div>\n                            </form>\n                        </div>\n                    </div>\n                </div>\n    \n                <div class=\"col-md-12\">\n                    <h3 class=\"section-title\">Annotations</h3>\n    \n                </div>\n            </div>\n        "]);

  opencga_sample_view_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_sample_view_templateObject() {
  const data = opencga_sample_view_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .section-title {\n                border-bottom: 2px solid #eee;\n            }\n            .label-title {\n                text-align: left;\n                padding-left: 5px;\n                padding-right: 10px;\n            }\n        </style>\n\n        ", "\n        "]);

  opencga_sample_view_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_sample_view_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


class opencga_sample_view_OpencgaSampleView extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      sampleId: {
        type: String
      },
      sample: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    // this.prefix = "osv" + Utils.randomString(6);
    //this.samples = {};
    //this.sample = {};
    this._config = this.getDefaultConfig();
  }

  firstUpdated(_changedProperties) {
    this.sampleIdObserver();
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaClient")) {
      this.renderAnalysisTable();
    }

    if (changedProperties.has("sampleId")) {
      this.sampleIdObserver();
    }

    if (changedProperties.has("sample")) {
      this.sampleObserver();
    }

    if (changedProperties.has("config")) {
      this.configObserver();
    }
  }

  configObserver() {
    this._config = Object.assign(this.getDefaultConfig(), this.config);
  }

  sampleIdObserver() {
    console.warn("sampleIdObserver");

    if (this.sampleId !== undefined && this.sampleId !== "") {
      let params = {
        study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias,
        includeIndividual: true
      };

      let _this = this;

      this.opencgaSession.opencgaClient.samples().info(this.sampleId, params).then(function (response) {
        if (response.response[0].id === undefined) {
          response.response[0].id = response.response[0].name;
        }

        _this.sample = response.response[0].result[0];
        console.log("_this.sample", _this.sample);

        _this.requestUpdate();
      }).catch(function (reason) {
        console.error(reason);
      });
    }
  }

  sampleObserver() {
    if (this.sample !== undefined && this.sample.attributes !== undefined) {
      this.individual = this.sample.attributes.OPENCGA_INDIVIDUAL;
    }
  }

  getDefaultConfig() {
    return {
      title: "Sample",
      showTitle: true
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_sample_view_templateObject(), this.sample ? lit_html_lit_html_html(opencga_sample_view_templateObject2(), this._config.showTitle ? lit_html_lit_html_html(opencga_sample_view_templateObject3(), this._config.title, this.sample.id) : null, this.sample.id, this.sample.version, this.sample.uuid, this.sample.release, this.sample.status.name, this.sample.creationDate, this.sample.modificationDate, this.sample.description, this.sample.source, this.sample.type, this.sample.somatic, this.sample.phenotypes && this.sample.phenotypes.length ? this.sample.phenotypes.map(item => lit_html_lit_html_html(opencga_sample_view_templateObject4(), this.item.name, this.item.id, this.item.id)) : null, this.individual.id, this.individual.name, this.individual.version, this.individual.uuid, this.individual.sex, this.individual.karyotypicSex, this.individual.phenotypes && this.individual.phenotypes.length ? this.individual.phenotypes.map(item => lit_html_lit_html_html(opencga_sample_view_templateObject5(), this.item.name, this.item.id, this.item.id)) : null) : null);
  }

}
customElements.define("opencga-sample-view", opencga_sample_view_OpencgaSampleView);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/opencga-protein-view.js
function opencga_protein_view_templateObject8() {
  const data = opencga_protein_view_taggedTemplateLiteral(["\n                    <br>\n                    <h3>Please select a variant to view variant's detailed annotation</h3>\n                "]);

  opencga_protein_view_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_protein_view_templateObject7() {
  const data = opencga_protein_view_taggedTemplateLiteral(["\n                    <div style=\"padding-top: 20px; height: 400px\">\n                        <h3>Advanced Annotation for Variant: ", "</h3>\n                        <!--<cellbase-variantannotation-view data=\"", "\" prefix=\"", "\"-->\n                                                         <!--cellbase-client=\"", "\" assembly=", " -->\n                                                         <!--hash-fragment-credentials=\"", "\"-->\n                                                         <!--style=\"font-size: 12px\"-->\n                                                         <!--population-frequencies=\"", "\"-->\n                                                         <!--protein-substitution-scores=\"", "\"-->\n                                                         <!--consequence-types=\"", "\">-->\n                        <!--</cellbase-variantannotation-view>-->\n                    </div>\n                    "]);

  opencga_protein_view_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_protein_view_templateObject6() {
  const data = opencga_protein_view_taggedTemplateLiteral(["\n                                    ", "\n                                    ", "\n                                "]);

  opencga_protein_view_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_protein_view_templateObject5() {
  const data = opencga_protein_view_taggedTemplateLiteral(["\n                                    ", "\n                                "]);

  opencga_protein_view_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_protein_view_templateObject4() {
  const data = opencga_protein_view_taggedTemplateLiteral(["\n                                    ", "\n                                    ", "\n                                "]);

  opencga_protein_view_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_protein_view_templateObject3() {
  const data = opencga_protein_view_taggedTemplateLiteral(["\n                                    ", "<br>\n                                "]);

  opencga_protein_view_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_protein_view_templateObject2() {
  const data = opencga_protein_view_taggedTemplateLiteral(["\n                <div class=\"row\" style=\"padding: 5px 0px 25px 0px\">\n                    <div class=\"col-md-5\">\n                        <h3>Summary</h3>\n                        <div class=\"block\">\n                            <label class=\"protein-align-left\">Name</label>\n                            <div class=\"protein-align-right\">\n                                ", "\n                            </div>\n                            <br>\n                        </div>\n                        <div class=\"block\">\n                            <label class=\"protein-align-left\">Recommended Name</label>\n                            <div class=\"protein-align-right\">", "\n                            </div>\n                            <br>\n                        </div>\n                        <div class=\"block\">\n                            <label class=\"protein-align-left\">Accession</label>\n                            <div class=\"protein-align-right\">\n                                <!-- TODO refactor with join-->\n                                ", "\n                            </div>\n                            <br>\n                        </div>\n                        <div class=\"block\">\n                            <label class=\"protein-align-left\">Gene</label>\n                            <div class=\"protein-align-right\">\n                                <!-- TODO add checkPrimary filter above! (see original file) -->\n                                ", "\n                            </div>\n                            <br>\n                        </div>\n                        <div class=\"block\">\n                            <label class=\"protein-align-left\">Keywords</label>\n                            <div class=\"protein-align-right\">\n                                ", "\n                            </div>\n                            <br>\n                        </div>\n                        <div class=\"block\">\n                            <label class=\"protein-align-left\">Sequence</label>\n                            <div class=\"protein-align-right\">\n                                <textarea class=\"form-control\" rows=\"3\" readonly>", "</textarea>\n                            </div>\n                            <br>\n                        </div>\n                        <div class=\"block\">\n                            <label class=\"protein-align-left\">Sequence Length</label>\n                            <div class=\"protein-align-right\">", "\n                            </div>\n                            <br>\n                        </div>\n                    </div>\n    \n                </div>\n            "]);

  opencga_protein_view_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_protein_view_templateObject() {
  const data = opencga_protein_view_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .protein-variant-tab-title {\n                font-size: 150%;\n                font-weight: bold;\n            }\n\n            div.block {\n                overflow: hidden;\n                width: 100%\n            }\n\n            .protein-align-left {\n                width: 25%;\n                display: block;\n                float: left;\n                text-align: left;\n            }\n\n            .protein-align-right {\n                width: 75%;\n                display: block;\n                float: left;\n                text-align: left;\n            }\n        </style>\n\n        <div>\n            <div style=\"float: right;padding: 10px 5px 10px 5px\">\n                <button type=\"button\" class=\"btn btn-primary\" @click=\"", "\">\n                    <i class=\"fa fa-hand-o-left\" aria-hidden=\"true\"></i> Variant Browser\n                </button>\n            </div>\n\n            <h2>", " (<i>Beta</i>)</h2>\n\n            ", "\n            <!--SVG-->\n            <div id=\"", "ProteinSvgDiv\">\n            </div>\n        </div>\n        <br>\n\n        <ul id=\"", "ViewTabs\" class=\"nav nav-tabs\" role=\"tablist\">\n            <li role=\"presentation\" class=\"active\">\n                <a href=\"#", "Variants\" role=\"tab\" data-toggle=\"tab\" class=\"protein-variant-tab-title\">Variants</a>\n            </li>\n        </ul>\n\n        <div class=\"tab-content\" style=\"height: 1024px\">\n            <div role=\"tabpanel\" class=\"tab-pane active\" id=\"", "Variants\">\n                <div class=\"btn-group btn-group\" role=\"group\" aria-label=\"...\" style=\"padding: 15px;float: right\">\n                    <button id=\"", "AllConsTypeButton\" type=\"button\" class=\"btn btn-default btn-warning protein-ct-buttons active\" @click=\"", "\">\n                        All\n                    </button>\n                    <button id=\"", "MissenseConsTypeButton\" type=\"button\" class=\"btn btn-default btn-warning protein-ct-buttons\" @click=\"", "\">\n                        Missense\n                    </button>\n                    <button id=\"", "LoFConsTypeButton\" type=\"button\" class=\"btn btn-default btn-warning protein-ct-buttons\" @click=\"", "\">\n                        LoF\n                    </button>\n                </div>\n\n                <br>\n                <br>\n                <opencga-variant-grid .opencgaSession=\"", "\"\n                                        .project=\"", "\"\n                                        .study=\"", "\"\n                                        .opencgaClient=\"", "\"\n                                        .populationFrequencies=\"", "\"\n                                        .proteinSubstitutionScores=\"", "\"\n                                        .consequenceTypes=\"", "\"\n                                        .search=\"", "\"\n                                        .query=\"", "\"\n                                        .variant=\"", "\"\n                                        .summary=\"", "\"\n                                        style=\"font-size: 12px\"\n                                        @selectvariant=\"onSelectVariant\">\n                </opencga-variant-grid>\n                \n                 <!-- Bottom tabs with specific variant information -->\n                ", "\n            </div>\n\n        </div>\n        "]);

  opencga_protein_view_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_protein_view_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */





class opencga_protein_view_OpencgaProteinView extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      project: {
        type: Object
      },
      study: {
        type: Object
      },
      protein: {
        type: String
      },
      populationFrequencies: {
        type: Array
      },
      proteinSubstitutionScores: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      variant: {
        type: String
      },
      config: {
        type: Object
      },
      summary: {
        type: Boolean
      }
    };
  }

  _init() {
    this._prefix = "opencgaProteinView" + utils.randomString(6) + "_";
    this.variant = "";
    this.summary = true;
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession")) {// this.geneChanged();
    }

    if (changedProperties.has("protein")) {
      this.projectStudyObtained();
    }

    if (changedProperties.has("project") || changedProperties.has("study")) {
      this._proteinChanged();
    }
  }

  projectStudyObtained() {
    if (utilsNew_UtilsNew.isNotUndefined(this.project) && utilsNew_UtilsNew.isNotEmpty(this.project.alias) && utilsNew_UtilsNew.isNotUndefined(this.study) && utilsNew_UtilsNew.isNotEmpty(this.study.alias)) {
      this.hashFragmentCredentials = {
        project: this.project.alias,
        study: this.study.alias
      };
    }
  }

  checkPrimary(item) {
    if (item.type === "primary") {
      return true;
    }
  }

  checkLastItem(array, item) {
    if (array[array.length - 1] === item) {
      return true;
    }
  }

  _proteinChanged() {
    // Remove the previously added SVG
    const svg = PolymerUtils_PolymerUtils.querySelector("svg");

    if (svg !== null) {
      const proteinSvgDiv = PolymerUtils_PolymerUtils.getElementById(this._prefix + "ProteinSvgDiv");

      if (proteinSvgDiv !== undefined && proteinSvgDiv !== null) {//                        proteinSvgDiv.removeChild(svg);
      }
    }

    const query = {};
    query.xref = this.protein;

    const _this = this;

    if (this.cellbaseClient instanceof CellBaseClient && utilsNew_UtilsNew.isNotEmpty(this.protein)) {
      // FIXME Below line should work as soon as the proteins are annotated
      //                    query["annot-xref"] = this.protein; // Query object that is passed to Variant browser grid
      // FIXME Below is a patch that needs to be removed
      //                    _this.cellbaseClient.get("feature", "id", this.protein, "xref", {
      //                        dbname: "ensembl_transcript"
      // //                        "Output format": "json"
      //                    }).then(function (response) {
      //                        let transcripts = [];
      //                        let results = response.response[0].result;
      //                        for (let result of results) {
      //                            transcripts.push(result.id);
      //                        }
      //                        query["annot-xref"] = transcripts.join(",");
      //                        _this.query = query;
      //                    });
      _this.cellbaseClient.getProteinClient(this.protein, "info", {}, {}).then(function (response) {
        _this.proteinObj = response.response[0].result[0];

        if (typeof _this.proteinObj !== "undefined" && typeof _this.project !== "undefined" && typeof _this.study !== "undefined" && typeof _this.study.alias !== "undefined") {
          const params = {
            //                                    "annot-xref": _this.protein,
            // TODO remove below gene and give proper query param
            "xref": _this.proteinObj.gene[0].name[0].value,
            "annot-ct": "missense_variant,transcript_ablation,splice_acceptor_variant,splice_donor_variant,stop_gained,frameshift_variant,stop_lost,start_lost," + "transcript_amplification,inframe_insertion,inframe_deletion",
            "study": _this.project.alias + ":" + _this.study.alias,
            "includeStudy": _this.project.alias + ":" + _this.study.alias,
            "summary": _this.summary // exclude: "studies.samplesData,studies.files"

          };

          _this.opencgaClient.variants().query(params).then(function (variants) {
            const lollipop = new Lollipop();
            const svgSettings = {
              // width: _this.proteinObj.sequence.length,
              width: 1280,
              height: 140,
              proteinPositioningInterval: 3,
              color: _this.config.color
            };
            const svg = lollipop.createSvg(_this.proteinObj, variants.response[0].result, svgSettings);
            const querySelector = PolymerUtils_PolymerUtils.getElementById(_this._prefix + "ProteinSvgDiv");
            querySelector.appendChild(svg);

            _this.requestUpdate();
          }).catch(function (e) {
            console.log(e);
          });
        }
      });

      _this.query = query;
    }
  }

  updateQuery(e) {
    PolymerUtils_PolymerUtils.removeClass(".protein-ct-buttons", "active");
    PolymerUtils_PolymerUtils.addClass(e.target.id, "active");
    const query = this.query;

    switch (e.target.innerText) {
      case "Missense":
        query.ct = "missense_variant";
        break;

      case "LoF":
        query.ct = this.consequenceTypes.lof.join(",");
        break;

      default:
        if (typeof query.ct !== "undefined") {
          delete query.ct;
        }

        break;
    }

    this.query = Object.assign({}, query);
  }

  checkVariant(variant) {
    return variant.split(":").length > 2;
  }

  showBrowser() {
    const hash = window.location.hash.split("/");
    const newHash = "#browser/" + hash[1] + "/" + hash[2];
    window.location.hash = newHash;
  }

  onSelectVariant(e) {
    this.variant = e.detail.id;
  }

  render() {
    return lit_html_lit_html_html(opencga_protein_view_templateObject(), this.showBrowser, this.protein, this.proteinObj ? lit_html_lit_html_html(opencga_protein_view_templateObject2(), this.proteinObj.name && this.proteinObj.name.length ? this.proteinObj.name.map(item => lit_html_lit_html_html(opencga_protein_view_templateObject3(), item)) : null, this.proteinObj.protein ? this.proteinObj.protein.recommendedName.fullName.value : "", this.proteinObj.accession && this.proteinObj.accession.length ? this.proteinObj.accession.map(item => lit_html_lit_html_html(opencga_protein_view_templateObject4(), this.item, !this.checkLastItem(this.proteinObj.accession, item) ? "," : "")) : null, this.proteinObj.gene && this.proteinObj.gene.length ? this.proteinObj.gene.map(gene => gene.name.map(item => lit_html_lit_html_html(opencga_protein_view_templateObject5(), item))) : null, this.proteinObj.keyword && this.proteinObj.keyword.length ? this.proteinObj.keyword.map(item => lit_html_lit_html_html(opencga_protein_view_templateObject6(), this.item.value, !this.checkLastItem(this.proteinObj.accession, item) ? "," : "")) : null, this.proteinObj.sequence.value, this.proteinObj.sequence.length) : null, this._prefix, this._prefix, this._prefix, this._prefix, this._prefix, this.updateQuery, this._prefix, this.updateQuery, this._prefix, this.updateQuery, this.opencgaSession, this.project, this.study, this.opencgaClient, this.populationFrequencies, this.proteinSubstitutionScores, this.consequenceTypes, this.query, this.query, this.variant, this.summary, this.checkVariant(this.variant) ? lit_html_lit_html_html(opencga_protein_view_templateObject7(), this.variant, this.variant, this._prefix, this.cellbaseClient, this.project.organism.assembly, this.hashFragmentCredentials, this.populationFrequencies, this.proteinSubstitutionScores, this.consequenceTypes) : lit_html_lit_html_html(opencga_protein_view_templateObject8()));
  }

}
customElements.define("opencga-protein-view", opencga_protein_view_OpencgaProteinView);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/opencga-login.js
function opencga_login_templateObject() {
  const data = opencga_login_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .v-offset {\n                margin-top: 90px;\n            }\n\n            .input-login {\n                border-left: 0;\n            }\n\n            #formLogin .input-group-addon{\n                background: none;\n            }\n            \n            .has-error .form-control:focus {\n            \n            }\n        </style>\n        <div class=\"container-fluid\">\n            <div class=\"row v-offset\">\n                <div class=\"col-md-12\">\n                    <form id=\"formLogin\" data-toggle=\"validator\" class=\"form-horizontal\" role=\"form\">\n                        <div class=\"form-group has-feedback\">\n                            <label for=\"opencgaUser\" class=\"control-label label-login\">User ID</label>\n                            <div class=\"input-group\">\n                                <span class=\"input-group-addon\" id=\"username\">\n                                    <i class=\"fa fa-user fa-lg\"></i>\n                                </span>\n                                <input id=\"opencgaUser\" value=\"", "\" type=\"text\" pattern=\"^[_\\-A-z0-9]+$\" maxlength=\"20\" class=\"form-control input-login\"\n                                       placeholder=\"User ID (case sensitive)\" aria-label=\"Recipient's username\" aria-describedby=\"username\" required data-required-error=\"This field is required\">\n                            </div>\n                            <div class=\"help-block with-errors\"></div>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label for=\"opencgaPassword\" class=\"control-label label-login\">Password</label>\n                            <div class=\"input-group\">\n                                <span class=\"input-group-addon \" id=\"password\">\n                                    <i class=\"fa fa-key\"></i>\n                                </span>\n                                <input id=\"opencgaPassword\" value=\"", "\" type=\"password\" maxlength=\"20\" class=\"form-control input-login\"\n                                       placeholder=\"Password\" aria-describedby=\"password\" required>\n                            </div>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <button type=\"submit\" class=\"btn btn-lg btn-primary btn-block ripple\">", "</button>\n                        </div>\n\n                    </form>\n                </div>\n            </div>\n        </div>\n        "], ["\n        <style include=\"jso-styles\">\n            .v-offset {\n                margin-top: 90px;\n            }\n\n            .input-login {\n                border-left: 0;\n            }\n\n            #formLogin .input-group-addon{\n                background: none;\n            }\n            \n            .has-error .form-control:focus {\n            \n            }\n        </style>\n        <div class=\"container-fluid\">\n            <div class=\"row v-offset\">\n                <div class=\"col-md-12\">\n                    <form id=\"formLogin\" data-toggle=\"validator\" class=\"form-horizontal\" role=\"form\">\n                        <div class=\"form-group has-feedback\">\n                            <label for=\"opencgaUser\" class=\"control-label label-login\">User ID</label>\n                            <div class=\"input-group\">\n                                <span class=\"input-group-addon\" id=\"username\">\n                                    <i class=\"fa fa-user fa-lg\"></i>\n                                </span>\n                                <input id=\"opencgaUser\" value=\"", "\" type=\"text\" pattern=\"^[_\\\\-A-z0-9]+$\" maxlength=\"20\" class=\"form-control input-login\"\n                                       placeholder=\"User ID (case sensitive)\" aria-label=\"Recipient's username\" aria-describedby=\"username\" required data-required-error=\"This field is required\">\n                            </div>\n                            <div class=\"help-block with-errors\"></div>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label for=\"opencgaPassword\" class=\"control-label label-login\">Password</label>\n                            <div class=\"input-group\">\n                                <span class=\"input-group-addon \" id=\"password\">\n                                    <i class=\"fa fa-key\"></i>\n                                </span>\n                                <input id=\"opencgaPassword\" value=\"", "\" type=\"password\" maxlength=\"20\" class=\"form-control input-login\"\n                                       placeholder=\"Password\" aria-describedby=\"password\" required>\n                            </div>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <button type=\"submit\" class=\"btn btn-lg btn-primary btn-block ripple\">", "</button>\n                        </div>\n\n                    </form>\n                </div>\n            </div>\n        </div>\n        "]);

  opencga_login_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_login_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */




class opencga_login_OpencgaLogin extends lit_element_lit_element_LitElement {
  constructor() {
    super();
    this.userName = "";
    this.password = "";
    this.buttonText = "Sign in";
    this.notifyEventMessage = "messageevent";
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaClient: {
        type: Object
      },
      buttonText: {
        type: String
      },
      userName: {
        type: String
      },
      password: {
        type: String
      },
      notifyEventMessage: {
        type: String
      }
    };
  } // TODO recheck


  ready() {
    super.ready();
  }

  firstUpdated(changedProperties) {
    $("#formLogin").validator("update");
    $("#formLogin").validator().on("submit", e => this.submitLogin(e));
  }

  submitLogin(e) {
    console.log("e", e);

    if (e.isDefaultPrevented()) {
      console.error("submitLogin() Error", e); // handle the invalid form...
      // this._clearHtmlDom(true);
    } else {
      // everything looks good!
      e.preventDefault();
      const user = document.getElementById("opencgaUser").value;
      const pass = document.getElementById("opencgaPassword").value;

      const _this = this;

      this.opencgaClient.login(user, pass).then(response => {
        if (response) {
          this.querySelector("#opencgaUser").value = "";
          this.querySelector("#opencgaPassword").value = "";
          console.log("response", response);
          const token = response.getResult(0).token;
          const decoded = jwt_decode(token); // TODO expose as module

          const dateExpired = new Date(decoded.exp * 1000);
          const validTimeSessionId = moment(dateExpired, "YYYYMMDDHHmmss").format("D MMM YY HH:mm:ss"); // TODO expose as module

          this.dispatchEvent(new CustomEvent("login", {
            detail: {
              userId: user,
              token: token
            },
            bubbles: true,
            composed: true
          }));
          this.dispatchEvent(new CustomEvent(_this.notifyEventMessage, {
            detail: {
              message: "Welcome " + user + ". Your session is valid until " + validTimeSessionId,
              options: {
                icon: "fa fa-user-circle"
              },
              type: utilsNew_UtilsNew.MESSAGE_SUCCESS
            },
            bubbles: true,
            composed: true
          }));
        }
      }).catch(function (response) {
        console.log(response);

        const _message = this.errorMessage = response.error || "Login error. Please check your credentials.";

        console.log(response.getEvents());
        this.dispatchEvent(new CustomEvent(_this.notifyEventMessage, {
          detail: {
            message: _message,
            type: utilsNew_UtilsNew.MESSAGE_ERROR
          },
          bubbles: true,
          composed: true
        }));
      }.bind(this));
    }
  }

  checkEnterKey(e) {
    if (e.keyCode === 13) {// this.login();
    }
  }

  render() {
    return lit_html_lit_html_html(opencga_login_templateObject(), this.userName, this.password, this.buttonText);
  }

}
customElements.define("opencga-login", opencga_login_OpencgaLogin);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/cohorts/opencga-cohort-grid.js
function opencga_cohort_grid_templateObject() {
  const data = opencga_cohort_grid_taggedTemplateLiteral(["\n        <style include=\"jso-styles\"></style>\n\n        <opencb-grid-toolbar .from=\"", "\"\n                             .to=\"", "\"\n                             numTotalResultsText=\"", "\"\n                             @download=\"", "\">\n        </opencb-grid-toolbar>\n\n        <div id=\"", "GridTableDiv\">\n            <table id=\"", "CohortBrowserGrid\">\n            </table>\n        </div>\n        "]);

  opencga_cohort_grid_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_cohort_grid_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_cohort_grid_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_cohort_grid_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_cohort_grid_ownKeys(Object(source), true).forEach(function (key) { opencga_cohort_grid_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_cohort_grid_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_cohort_grid_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */




class opencga_cohort_grid_OpencgaCohortGrid extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      search: {
        type: Object
      },
      active: {
        type: Boolean
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "VarCohortGrid" + utils.randomString(6) + "_";
    this.active = false;
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession") || changedProperties.has("search") || changedProperties.has("config") || changedProperties.has("active")) {
      this.propertyObserver();
    }
  }

  connectedCallback() {
    super.connectedCallback(); // //////this.renderTable(this.active);
  }

  propertyObserver() {
    // With each property change we must updated config and create the columns again. No extra checks are needed.
    this._config = Object.assign(this.getDefaultConfig(), this.config);
    this._columns = this._initTableColumns(); // Config for the grid toolbar

    this.toolbarConfig = {
      columns: this._columns[0]
    };
    this.renderTable(this.active);
  }

  renderTable(active) {
    if (!active) {
      return;
    }

    this.opencgaClient = this.opencgaSession.opencgaClient; // this.set('cohorts', []);

    this.cohorts = [];

    let filters = opencga_cohort_grid_objectSpread({}, this.query);

    this.from = 1;
    this.to = 10;

    if (this.opencgaClient && this.opencgaSession.study && this.opencgaSession.study.fqn) {
      filters.study = this.opencgaSession.study.fqn;

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.lastFilters) && JSON.stringify(this.lastFilters) === JSON.stringify(filters)) {
        // Abort destroying and creating again the grid. The filters have not changed
        return;
      } // Store the current filters


      this.lastFilters = opencga_cohort_grid_objectSpread({}, filters); // Make a copy of the cohorts (if they exist), we will use this private copy until it is assigned to this.cohorts

      if (utilsNew_UtilsNew.isNotUndefined(this.cohorts)) {
        this._cohorts = this.cohorts;
      } else {
        this._cohorts = [];
      } // Check that HTTP protocol is present and complete the URL

      /*            let opencgaHostUrl = this.opencgaClient.getConfig().host;
                  if (!opencgaHostUrl.startsWith("http://") && !opencgaHostUrl.startsWith("https://")) {
                      opencgaHostUrl = "http://" + opencgaHostUrl;
                  }
                  opencgaHostUrl += "/webservices/rest/v1/cohorts/search";*/


      let skipCount = false;

      const _table = $("#" + this._prefix + "CohortBrowserGrid");

      const _this = this;

      $("#" + this._prefix + "CohortBrowserGrid").bootstrapTable("destroy");
      $("#" + this._prefix + "CohortBrowserGrid").bootstrapTable({
        //url: opencgaHostUrl,
        columns: _this._columns,
        method: "get",
        sidePagination: "server",
        uniqueId: "id",
        // Table properties
        pagination: _this._config.pagination,
        pageSize: _this._config.pageSize,
        pageList: _this._config.pageList,
        showExport: _this._config.showExport,
        detailView: _this._config.detailView,
        detailFormatter: _this._config.detailFormatter,

        /*
                        queryParams: function(params) {
                            if (this.pageNumber > 1) {
                                skipCount = true;
                            }
        
                            const auxParams = {
                                sid: Cookies.get(_this.opencgaClient.getConfig().cookieSessionId),
                                order: params.order,
                                sort: params.sort,
                                limit: params.limit,
                                skip: params.offset,
                                skipCount: skipCount,
                                include: "id,creationDate,status,type,samples"
                            };
        
                            if (UtilsNew.isUndefined(filters)) {
                                filters = {};
                            }
                            return Object.assign(filters, auxParams);
                        },*/
        formatLoadingMessage: () => "<div><loading-spinner></loading-spinner></div>",
        ajax: params => {
          if (this.pageNumber > 1) {
            skipCount = true;
          }

          let _filters = opencga_cohort_grid_objectSpread({
            //study: this.opencgaSession.study.fqn,
            order: params.data.order,
            limit: params.data.limit,
            skip: params.data.offset || 0,
            skipCount: skipCount,
            include: "id,creationDate,status,type,samples"
          }, filters);

          this.opencgaSession.opencgaClient.cohorts().search(_filters).then(res => params.success(res)).catch(e => console.error(e));
        },
        responseHandler: function responseHandler(response) {
          if (!skipCount) {
            if (!_this.hasOwnProperty("numTotalResults")) {
              _this.numTotalResults = 0;
            }

            if (_this.numTotalResults !== response.getResponse().numTotalResults && response.queryOptions.skip === 0) {
              _this.numTotalResults = response.getResponse().numTotalResults;
            }
          }

          _this.numTotalResultsText = _this.numTotalResults.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");

          if (response.getParams().skip === 0 && _this.numTotalResults < response.getParams().limit) {
            _this.from = 1;
            _this.to = _this.numTotalResults;
          }

          _this.requestUpdate(); // it is necessary to refresh numTotalResultsText in opencga-grid-toolbar


          return {
            total: _this.numTotalResults,
            rows: response.getResults()
          };
        },
        onClickRow: function onClickRow(row, element, field) {
          let checked = true;

          if (_this._config.multiSelection) {
            // Check and uncheck when clicking in the checkbox TD cell
            if (field === "state") {
              const index = element[0].dataset.index;

              if (element[0].className.includes("selected")) {
                $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "CohortBrowserGrid")).bootstrapTable("uncheck", index);
                checked = false;
              } else {
                $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "CohortBrowserGrid")).bootstrapTable("check", index);
                $(".success").removeClass("success");
                $(element).addClass("success");
              }
            } else {
              // If user has clicked in the row
              const index = element[0].dataset.index;

              if (element[0].className.includes("selected")) {
                $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "CohortBrowserGrid")).bootstrapTable("uncheck", index);
                $(element).removeClass("success");
                checked = false;
              } else {
                $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "CohortBrowserGrid")).bootstrapTable("check", index);
              }
            }
          } else {
            // If not checkboxes exist
            $(".success").removeClass("success");
            $(element).addClass("success");
          }

          _this._onSelectCohort(row, checked);
        },
        onDblClickRow: function onDblClickRow(row, element, field) {
          // We detail view is active we expand the row automatically.
          // FIXME: Note that we use a CSS class way of knowing if the row is expand or collapse, this is not ideal but works.
          if (_this._config.detailView) {
            if (element[0].innerHTML.includes("icon-plus")) {
              $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "CohortBrowserGrid")).bootstrapTable("expandRow", element[0].dataset.index);
            } else {
              $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "CohortBrowserGrid")).bootstrapTable("collapseRow", element[0].dataset.index);
            }
          }
        },
        onCheck: function onCheck(row, element) {
          // check cohort is not already selected
          for (const i in _this._cohorts) {
            if (_this._cohorts[i].id === row.id) {
              return;
            }
          } // we add cohorts to selected cohorts
          // _this.push("_cohorts", row);
          // _this.set('cohorts', _this._cohorts.slice());


          _this._cohorts.push(row);

          _this.cohorts = _this._cohorts.slice(); // We detail view is active we expand the row automatically

          if (_this._config.detailView) {
            $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "CohortBrowserGrid")).bootstrapTable("expandRow", element[0].dataset.index);
          } // We only activate the row when checking


          if (_this._config.detailView) {
            $(".success").removeClass("success");
          }

          $(element[0].parentElement.parentElement).addClass("success"); // If exist on single nested sample we must check it

          if (row.samples.length === 1) {
            const checkbox = PolymerUtils_PolymerUtils.getElementById(_this._prefix + row.samples[0].id + "Checkbox");

            if (utilsNew_UtilsNew.isNotUndefinedOrNull(checkbox)) {
              checkbox.checked = true;
            }
          }

          _this._onSelectCohort(row, true);
        },
        onUncheck: function onUncheck(row, elem) {
          let cohortToDeleteIdx = -1;

          for (const i in _this.cohorts) {
            if (_this.cohorts[i].id === row.id) {
              cohortToDeleteIdx = i;
              break;
            }
          }

          if (cohortToDeleteIdx === -1) {
            return;
          } // _this.splice('_cohorts', cohortToDeleteIdx, 1);
          // _this.set('cohorts', _this._cohorts.slice());


          _this._cohorts.splice(cohortToDeleteIdx, 1);

          _this.cohorts = _this._cohorts.slice(); // We detail view is active we expand the row automatically

          if (_this._config.detailView) {
            $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "CohortBrowserGrid")).bootstrapTable("collapseRow", elem[0].dataset.index);
          } // We must uncheck nested checked samples


          if (row.samples.length > 0) {
            for (const sample of row.samples) {
              const checkbox = PolymerUtils_PolymerUtils.getElementById(_this._prefix + sample.id + "Checkbox");

              if (utilsNew_UtilsNew.isNotUndefinedOrNull(checkbox)) {
                checkbox.checked = false;
              }
            }
          }

          _this._onSelectCohort(row, false);
        },
        onCheckAll: function onCheckAll(rows) {
          const newCohorts = _this._cohorts.slice(); // check cohort is not already selected


          rows.forEach(cohort => {
            const existsNewSelected = _this._cohorts.some(cohortSelected => {
              return cohortSelected.id === cohort.id;
            });

            if (!existsNewSelected) {
              newCohorts.push(cohort);
            }
          }); // we add cohorts to selected cohorts

          _this._cohorts = newCohorts; // _this.set('cohorts', newCohorts.slice());

          _this.cohorts = newCohorts.slice(); // We must uncheck nested checked samples

          for (const row of rows) {
            if (row.samples.length === 1) {
              const checkbox = PolymerUtils_PolymerUtils.getElementById(_this._prefix + row.samples[0].id + "Checkbox");

              if (utilsNew_UtilsNew.isNotUndefinedOrNull(checkbox)) {
                checkbox.checked = true;
              }
            }
          }
        },
        onUncheckAll: function onUncheckAll(rows) {
          // check cohort is not already selected
          rows.forEach(cohort => {
            _this._cohorts = _this._cohorts.filter(cohortSelected => {
              return cohortSelected.id !== cohort.id;
            });
          }); // we add cohorts to selected cohorts
          //                            _this.push("_cohorts", row);

          _this.cohorts = _this._cohorts.slice(); // We must uncheck nested checked samples

          for (const row of rows) {
            for (const sample of row.samples) {
              const checkbox = PolymerUtils_PolymerUtils.getElementById(_this._prefix + sample.id + "Checkbox");

              if (utilsNew_UtilsNew.isNotUndefinedOrNull(checkbox)) {
                checkbox.checked = false;
              }
            }
          }
        },
        onLoadSuccess: function onLoadSuccess(data) {
          // Check all already selected rows. Selected cohorts are stored in this.cohorts array
          if (utilsNew_UtilsNew.isNotUndefinedOrNull(_table)) {
            if (!_this._config.multiSelection) {
              PolymerUtils_PolymerUtils.querySelector(_table.selector).rows[1].setAttribute("class", "success");

              _this._onSelectCohort(data.rows[0]);
            }

            if (_this.cohorts !== "undefined") {
              for (const idx in _this.cohorts) {
                for (const j in data.rows) {
                  if (_this.cohorts[idx].id === data.rows[j].id) {
                    $(PolymerUtils_PolymerUtils.getElementById(_this._prefix + "CohortBrowserGrid")).bootstrapTable("check", j);
                    break;
                  }
                }
              }
            }
          }
        },
        onPageChange: function onPageChange(page, size) {
          _this.from = (page - 1) * size + 1;
          _this.to = page * size;
        }
      });
    } else {
      // Delete table
      $(PolymerUtils_PolymerUtils.getElementById(this._prefix + "CohortBrowserGrid")).bootstrapTable("destroy");
      this.numTotalResults = 0;
    }
  }

  _onSelectCohort(row, checked) {
    if (typeof row !== "undefined") {
      this.dispatchEvent(new CustomEvent("selectcohort", {
        detail: {
          id: row.id,
          cohort: row,
          checked: checked
        }
      }));
    }
  }

  onColumnChange(e) {
    const table = $("#" + this._prefix + "CohortBrowserGrid");

    if (e.detail.selected) {
      table.bootstrapTable("showColumn", e.detail.id);
    } else {
      table.bootstrapTable("hideColumn", e.detail.id);
    }
  }

  sampleFormatter(value, row) {
    if (utilsNew_UtilsNew.isNotUndefined(row.samples)) {
      return row.samples.length;
    } else {
      return 0;
    }
  }

  dateFormatter(value, row) {
    const pattern = /^(\d\d\d\d)(\d\d)(\d\d)/;
    const matches = pattern.exec(value);

    if (matches) {
      const [year, month, day] = [matches[1], matches[2] - 1, matches[3]];
      return year + "-" + month + "-" + day;
    } else {
      return "Invalid date: '" + value + "'";
    }
  }

  _initTableColumns() {
    const customAnnotationVisible = utilsNew_UtilsNew.isNotUndefinedOrNull(this._config.customAnnotations) && utilsNew_UtilsNew.isNotEmptyArray(this._config.customAnnotations.fields);
    const columns = [];

    if (this._config.multiSelection) {
      columns.push({
        field: "state",
        checkbox: true,
        class: "cursor-pointer",
        eligible: false
      });
    }

    this._columns = [columns.concat([{
      title: "Cohort",
      field: "id",
      sortable: true,
      halign: this._config.header.horizontalAlign
    }, {
      title: "#Samples",
      field: "samples",
      formatter: this.sampleFormatter,
      halign: this._config.header.horizontalAlign
    }, {
      title: "Date",
      field: "creationDate",
      formatter: this.dateFormatter,
      sortable: true,
      halign: this._config.header.horizontalAlign
    }, {
      title: "Status",
      field: "status.name",
      halign: this._config.header.horizontalAlign
    }, {
      title: "Type",
      field: "type",
      halign: this._config.header.horizontalAlign
    }])];
    return this._columns;
  }

  _getUrlQueryParams() {// TODO
  }

  onDownload(e) {
    // let urlQueryParams = this._getUrlQueryParams();
    // let params = urlQueryParams.queryParams;
    //console.log(this.opencgaSession);
    const params = opencga_cohort_grid_objectSpread({}, this.query, {
      study: this.opencgaSession.study.fqn,
      sid: this.opencgaSession.opencgaClient._config.sessionId,
      limit: 1000,
      includeIndividual: true,
      skipCount: true,
      include: "id,creationDate,status,type,samples"
    });

    this.opencgaSession.opencgaClient.cohorts().search(params).then(response => {
      const result = response.response[0].result;
      console.log(result);
      let dataString = [];
      let mimeType = "";
      let extension = "";

      if (result) {
        // Check if user clicked in Tab or JSON format
        if (e.detail.option.toLowerCase() === "tab") {
          dataString = [["Cohort", "#Samples", "Date", "Status", "Type"].join("\t"), ...result.map(_ => [_.id, _.samples ? _.samples.map(_ => "".concat(_.id)).join(",") : "", _.creationDate, _.status.name, _.type].join("\t"))]; //console.log(dataString);

          mimeType = "text/plain";
          extension = ".txt";
        } else {
          for (const res of result) {
            dataString.push(JSON.stringify(res, null, "\t"));
          }

          mimeType = "application/json";
          extension = ".json";
        } // Build file and anchor link


        const data = new Blob([dataString.join("\n")], {
          type: mimeType
        });
        const file = window.URL.createObjectURL(data);
        const a = document.createElement("a");
        a.href = file;
        a.download = this.opencgaSession.study.alias + extension;
        document.body.appendChild(a);
        a.click();
        setTimeout(function () {
          document.body.removeChild(a);
        }, 0);
      } else {
        console.error("Error in result format");
      }
    }).then(function () {//this.downloadRefreshIcon.css("display", "none");
      //this.downloadIcon.css("display", "inline-block");
    });
  }

  getDefaultConfig() {
    return {
      pagination: true,
      pageSize: 10,
      pageList: [10, 25, 50],
      showExport: false,
      detailView: false,
      detailFormatter: undefined,
      // function with the detail formatter
      multiSelection: false,
      header: {
        horizontalAlign: "center",
        verticalAlign: "bottom"
      },
      customAnnotations: {
        title: "Custom Annotation",
        fields: []
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_cohort_grid_templateObject(), this.from, this.to, this.numTotalResultsText, this.onDownload, this._prefix, this._prefix);
  }

}
customElements.define("opencga-cohort-grid", opencga_cohort_grid_OpencgaCohortGrid);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/variableSets/opencga-annotation-viewer.js
function opencga_annotation_viewer_templateObject5() {
  const data = opencga_annotation_viewer_taggedTemplateLiteral(["\n                    <p>No variableSets defined in the study</p>\n                "]);

  opencga_annotation_viewer_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_annotation_viewer_templateObject4() {
  const data = opencga_annotation_viewer_taggedTemplateLiteral(["\n                                    <option data-variable=\"", "\">", "</option>\n                                "]);

  opencga_annotation_viewer_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_annotation_viewer_templateObject3() {
  const data = opencga_annotation_viewer_taggedTemplateLiteral(["\n                        <div style=\"width: 40%\">\n                            <label for=\"", "-variableSetSelect\">Select Variable Set</label>\n                            <select class=\"selectpicker\" id=\"", "-variableSetSelect\" @change=\"", "\"\n                                    on-dom-change=\"renderDomRepeat\" data-width=\"40%\">\n                                <!--<select class=\"form-control\" id=\"variableSetSelect\" style=\"width: 100%\"-->\n                                <!--on-change=\"onSelectedVariableSetChange\">-->\n                                ", "\n                            </select>\n                        </div>\n                        <div style=\"width: 50%\">\n                            <opencga-variable-selector .variableSet=\"", "\" .config=\"", "\"\n                                                       @variablechange=\"", "\">\n                            </opencga-variable-selector>\n                        </div>\n                    \n                    "]);

  opencga_annotation_viewer_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_annotation_viewer_templateObject2() {
  const data = opencga_annotation_viewer_taggedTemplateLiteral(["\n                <!-- Annotations -->\n                    ", "\n                    \n                    <div id=\"", "-table\" style=\"padding: 25px 10px; max-height: 500px; overflow-x: auto; overflow-y: auto;\"></div>\n\n                "]);

  opencga_annotation_viewer_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_annotation_viewer_templateObject() {
  const data = opencga_annotation_viewer_taggedTemplateLiteral(["\n        <style include=\"jso-styles\"></style>\n\n        <div style=\"padding: 15px 20px\">\n\n            <div id=\"", "-main-annotation-comparator-div\">\n                \n                ", "\n            </div>\n        </div>\n        "]);

  opencga_annotation_viewer_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_annotation_viewer_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



 // TODO check functionality and table _generateTable!


class opencga_annotation_viewer_OpencgaAnnotationViewer extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      entryIds: {
        type: Array
      },
      entity: {
        // Allowed values are SAMPLE,INDIVIDUAL,COHORT,FAMILY,FILE
        type: String
      }
    };
  }

  _init() {
    // super.ready();
    this._prefix = "oac-" + utils.randomString(6);
    this.selectedVariables = [];
    this.ovsConfig = {
      title: "Select variables",
      multiSelection: true,
      onlyAllowLeafSelection: false,
      showResetButton: true
    };
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession")) {
      this.opencgaSessionObserver();
    }

    if (changedProperties.has("entryIds")) {
      this.entryIdsObserver();
    }
  }

  opencgaSessionObserver() {
    this.variableSets = [];
    this.variables = [];
    this._annotations = {};

    if (typeof this.opencgaSession.study === "undefined") {
      return;
    }

    if (typeof this.opencgaSession.study.variableSets !== "undefined") {
      this._updateVariableSets(this.opencgaSession.study);

      this.requestUpdate();
    } else {
      const _this = this;

      this.opencgaClient.studies().info(this.opencgaSession.study.id, {
        include: "variableSets"
      }).then(function (response) {
        _this._updateVariableSets(response.response[0].result[0]);
      }).catch(function () {
        _this.multipleVariableSets = false; // Hide all selectpicker selectors

        $("#".concat(this._prefix, "-variableSetSelect")).selectpicker("hide");
        console.log("Could not obtain the variable sets of the study " + _this.opencgaSession.study);
        this.requestUpdate();
      });
    }
  } // TODO refactor


  entryIdsObserver(e) {
    // Get the selected variableSet
    if (e === undefined || typeof e.target === "undefined") {
      const variableSet = $("button[data-id=".concat(this._prefix, "-variableSetSelect]"))[0];

      if (typeof variableSet !== "undefined") {
        const variableSetId = variableSet.title;

        for (const i in this.variableSets) {
          if (this.variableSets[i].id === variableSetId) {
            this.selectedVariableSet = this.variableSets[i];
            break;
          }
        }
      }
    } else {
      for (const i in this.variableSets) {
        if (this.variableSets[i].id === e.target.value) {
          this.selectedVariableSet = this.variableSets[i];
          break;
        }
      }
    }

    console.log("this.variableSets", this.variableSets);
    let client = undefined;

    switch (this.entity) {
      case "SAMPLE":
        client = this.opencgaClient.samples();
        break;

      case "INDIVIDUAL":
        client = this.opencgaClient.individuals();
        break;

      case "COHORT":
        client = this.opencgaClient.cohorts();
        break;

      case "FAMILY":
        client = this.opencgaClient.families();
        break;

      case "FILE":
        client = this.opencgaClient.files();
        break;

      default:
        console.error("Unexpected entity value passed to annotation-comparator webcomponent");
        return;
    } // Extract sample ids


    const entryIds = [];

    for (const i in this.entryIds) {
      if (!(this.entryIds[i].id in this._annotations)) {
        entryIds.push(this.entryIds[i].id);
      }
    }

    const _this = this;

    if (entryIds.length > 0) {
      client.info(entryIds.join(","), {
        study: this.opencgaSession.study.id,
        include: "annotationSets,id"
      }).then(function (response) {
        _this._storeAnnotations(response);

        _this._renderNewTable();
      });
    } else {
      this._storeAnnotations(undefined);

      this._renderNewTable();
    }
  }

  onSelectedVariablesChange(e) {
    const selectedVariables = [];

    for (let i = 0; i < e.detail.value.length; i++) {
      selectedVariables.push(e.detail.value[i].tags);
    }

    this.selectedVariables = selectedVariables;

    this._renderNewTable();
  }

  _renderNewTable() {
    const annotations = {};

    for (const entry in this._annotations) {
      for (let i = 0; i < this._annotations[entry].length; i++) {
        if (this._annotations[entry][i]["variableSetId"] === this.selectedVariableSet.id) {
          if (!(entry in annotations)) {
            annotations[entry] = [];
          }

          annotations[entry].push(this._annotations[entry][i]);
        }
      }
    }

    console.log("this._annotations", annotations);

    this._generateTable(annotations);
  } // TODO urgent refactor


  _generateTable(annotations) {
    console.warn("_generateTable needs to be refactored in lit-element");
    /*
    * <table class="table">
        <thead>
        <tr>
            <th>#</th>
            <th>Firstname</th>
            <th>Lastname</th>
            <th>Age</th>
            <th>City</th>
            <th>Country</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td><span>1</span></td>
            <td><br>Anna</td>
            <td>Pitt</td>
            <td>35</td>
            <td>New York</td>
            <td>USA</td>
        </tr>
        </tbody>
    </table>
    * */

    if (Object.keys(annotations).length === 0) {
      // If the user hasn't selected any sample
      if (this.entryIds.length === 0) {
        PolymerUtils_PolymerUtils.innerHTML(this._prefix + "-table", "");
      } else {
        PolymerUtils_PolymerUtils.innerHTML(this._prefix + "-table", "No annotations found in the variable set");
      }

      return;
    }

    let head = "";
    let body = "";
    const filteredAnnotations = {};
    const annotationIds = [];
    console.log("annotations", annotations); //TODO continue migration table

    /*        const head1 = annotations.map( sampleKey => html`<th> ${sampleKey} ${annotations[sampleKey].map( el => {
                const key = this._prefix + "-" + sampleKey + "-"+ el["variableSetId"] + "-" + el["id"];
                const annotationId = sampleKey + "-"+ el["variableSetId"] + "-" + el["id"] + ".json";
                // We filter the current annotation
                filteredAnnotations[key] = this.getFilteredAnnotations(el);
                const annotationString = JSON.stringify(filteredAnnotations[key]);
                // We generate a button to be able to download the filtered annotation
                return html`<a data-annotation='${annotationString}' data-title='${annotationId}'
                                        title='Download ${annotationId}' style='cursor: pointer; margin-left: 5px'>
                                         <i class='fa fa-download fa-lg' aria-hidden='true'></i>
                                    </a>`;
    
                }).join("") }` ).join("");*/

    for (const sampleKey in annotations) {
      head += "<th>" + sampleKey;
      let annotationHtml = "";

      for (let i = 0; i < annotations[sampleKey].length; i++) {
        const key = this._prefix + "-" + sampleKey + "-" + annotations[sampleKey][i]["variableSetId"] + "-" + annotations[sampleKey][i]["id"];
        const annotationId = sampleKey + "-" + annotations[sampleKey][i]["variableSetId"] + "-" + annotations[sampleKey][i]["id"] + ".json"; // We filter the current annotation

        filteredAnnotations[key] = this.getFilteredAnnotations(annotations[sampleKey][i]);
        const annotationString = JSON.stringify(filteredAnnotations[key]); // We generate a button to be able to download the filtered annotation

        head += "<a data-annotation='".concat(annotationString, "' data-title='").concat(annotationId, "'\n                                    title='Download ").concat(annotationId, "' style='cursor: pointer; margin-left: 5px'>\n                                     <i class='fa fa-download fa-lg' aria-hidden='true'></i>\n                                </a>");
        annotationIds.push(annotationId);
        annotationHtml += "<div id=\"" + key + "\"></div>";
      }

      head += "</th>";
      body += "<td>" + annotationHtml + "</td>";
    }

    let html = "<table class=\"table\">";
    html += "<thead><tr>" + head + "</tr></thead>";
    html += "<tbody><tr>" + body + "</tr></tbody>";
    html += "</table>";
    console.log(html);
    PolymerUtils_PolymerUtils.innerHTML(this._prefix + "-table", html); // We now add the on-click event (it was impossible adding it to the html directly)

    for (let i = 0; i < annotationIds.length; i++) {
      $("a[data-title='".concat(annotationIds[i], "']"))[0].addEventListener("click", this.downloadFile);
    } // Now we iterate again to view the jsons in the table


    for (const sampleKey in annotations) {
      for (let i = 0; i < annotations[sampleKey].length; i++) {
        const key = this._prefix + "-" + sampleKey + "-" + annotations[sampleKey][i]["variableSetId"] + "-" + annotations[sampleKey][i]["id"];
        $("#" + key).jsonViewer(filteredAnnotations[key]);
      }
    }
  }

  downloadFile(e) {
    const mime_type = "text/plain";
    const name = e.currentTarget.dataset.title;
    const contents = e.currentTarget.dataset.annotation;
    const blob = new Blob([contents], {
      type: mime_type
    });
    const dlink = document.createElement("a");
    dlink.download = name;
    dlink.href = window.URL.createObjectURL(blob);

    dlink.onclick = function (e) {
      // revokeObjectURL needs a delay to work properly
      const that = this;
      setTimeout(function () {
        window.URL.revokeObjectURL(that.href);
      }, 1500);
    };

    dlink.click();
    dlink.remove();
  }

  _storeAnnotations(response) {
    // Add the new samples
    if (typeof response !== "undefined") {
      for (let i = 0; i < response.response.length; i++) {
        for (let j = 0; j < response.response[i].result.length; j++) {
          const entry = response.response[i].result[j];

          if (utilsNew_UtilsNew.isNotUndefinedOrNull(entry.annotationSets)) {
            this._annotations[entry.id] = entry.annotationSets;
          }
        }
      }
    } // Remove unselected samples


    const selectedEntries = [];

    for (let i = 0; i < this.entryIds.length; i++) {
      selectedEntries.push(this.entryIds[i].id);
    }

    for (const entry in this._annotations) {
      if (selectedEntries.indexOf(entry) === -1) {
        delete this._annotations[entry];
      }
    }
  }

  getFilteredAnnotations(annotationSet) {
    // If the user hasn't filtered, we will show all the information
    if (this.selectedVariables.length === 0) {
      return annotationSet;
    }

    const annotationSetCopy = {};
    Object.assign(annotationSetCopy, annotationSet);
    const annotations = {};

    for (let i = 0; i < this.selectedVariables.length; i++) {
      const keys = this.selectedVariables[i].split(".");

      this._addFilteredAnnotation(keys, annotations, annotationSet.annotations);
    }

    annotationSetCopy["annotations"] = annotations;
    return annotationSetCopy;
  } // This method will clone in 'annotationClone' the object keys 'keys' read from 'annotation'


  _addFilteredAnnotation(keys, annotationClone, annotation) {
    const myKey = keys[0];

    if (keys.length === 1) {
      if (typeof annotation !== "undefined" && typeof annotation[myKey] !== "undefined") {
        annotationClone[myKey] = annotation[myKey];
      }
    } else {
      if (Array.isArray(annotation[myKey])) {
        if (!(myKey in annotationClone)) {
          annotationClone[myKey] = [];
        }

        for (let i = 0; i < annotation[myKey].length; i++) {
          let myObject;

          if (annotationClone[myKey].length === annotation[myKey].length) {
            // The array was already defined
            myObject = annotationClone[myKey][i];
          } else {
            myObject = {};
            annotationClone[myKey].push(myObject);
          }

          this._addFilteredAnnotation(keys.slice(1), myObject, annotation[myKey][i]);
        }
      } else if (typeof annotation[myKey] !== "undefined") {
        // It is an object
        if (!(myKey in annotationClone)) {
          annotationClone[myKey] = {};
        }

        this._addFilteredAnnotation(keys.slice(1), annotationClone[myKey], annotation[myKey]);
      }
    }
  }

  _updateVariableSets(study) {
    if (typeof study.variableSets === "undefined") {
      this.variableSets = [];
    } else {
      this.variableSets = study.variableSets;
    }

    if (this.variableSets.length > 0) {
      // this.variables = this.parseVariableForDisplay(this.variableSets[0].variables); // select first one by default
      // Show selectpicker selector
      $("#".concat(this._prefix, "-variableSetSelect")).selectpicker("show");
      this.multipleVariableSets = this.variableSets.length > 1;
    } else {
      this.multipleVariableSets = false; // Hide selectpicker selector

      $("#".concat(this._prefix, "-variableSetSelect")).selectpicker("hide");
    }
  }

  renderDomRepeat(e) {
    $("select.selectpicker").selectpicker("refresh");
    $("select.selectpicker").selectpicker("deselectAll");
  }

  render() {
    return lit_html_lit_html_html(opencga_annotation_viewer_templateObject(), this._prefix, this.variableSets && this.variableSets.length ? lit_html_lit_html_html(opencga_annotation_viewer_templateObject2(), this.multipleVariableSets ? lit_html_lit_html_html(opencga_annotation_viewer_templateObject3(), this._prefix, this._prefix, this.entryIdsObserver, this.variableSets && this.variableSets.length && this.variableSets.map(item => lit_html_lit_html_html(opencga_annotation_viewer_templateObject4(), item, item.id)), this.selectedVariableSet, this.ovsConfig, this.onSelectedVariablesChange) : null, this._prefix) : lit_html_lit_html_html(opencga_annotation_viewer_templateObject5()));
  }

}
customElements.define("opencga-annotation-viewer", opencga_annotation_viewer_OpencgaAnnotationViewer);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/cohorts/opencga-cohort-filter.js
function opencga_cohort_filter_templateObject10() {
  const data = opencga_cohort_filter_taggedTemplateLiteral(["No filter has been configured."]);

  opencga_cohort_filter_templateObject10 = function _templateObject10() {
    return data;
  };

  return data;
}

function opencga_cohort_filter_templateObject9() {
  const data = opencga_cohort_filter_taggedTemplateLiteral(["\n            <div class=\"search-button-wrapper\">\n                <button type=\"button\" class=\"btn btn-primary ripple\" @click=\"", "\">\n                    <i class=\"fa fa-search\" aria-hidden=\"true\"></i> Search\n                </button>\n            </div>\n            "]);

  opencga_cohort_filter_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function opencga_cohort_filter_templateObject8() {
  const data = opencga_cohort_filter_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n\n            span + span {\n                margin-left: 10px;\n            }\n\n            div.block {\n                overflow: hidden;\n            }\n\n            div.block label {\n                width: 80px;\n                display: block;\n                float: left;\n                text-align: left;\n                font-weight: normal;\n            }\n\n            select + select {\n                margin-left: 10px;\n            }\n\n            select + input {\n                margin-left: 10px;\n            }\n\n            .subsection-content {\n                margin: 5px 5px;\n            }\n        </style>\n\n        ", "\n\n        <div class=\"panel-group\" id=\"", "Accordion\" role=\"tablist\" aria-multiselectable=\"true\">\n            <div class=\"\">\n                ", "\n            </div>\n        </div>\n        "]);

  opencga_cohort_filter_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_cohort_filter_templateObject7() {
  const data = opencga_cohort_filter_taggedTemplateLiteral(["\n                                <div class=\"tooltip-div pull-right\">\n                                    <a><i class=\"fa fa-info-circle\" aria-hidden=\"true\" id=\"", "", "Tooltip\"></i></a>\n                                </div>"]);

  opencga_cohort_filter_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_cohort_filter_templateObject6() {
  const data = opencga_cohort_filter_taggedTemplateLiteral(["\n                    <div class=\"form-group\">\n                        <div class=\"browser-subsection\" id=\"", "\">", "\n                            ", "\n                        </div>\n                        <div id=\"", "", "\" class=\"subsection-content\">\n                            ", "\n                         </div>\n                    </div>\n                "]);

  opencga_cohort_filter_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_cohort_filter_templateObject5() {
  const data = opencga_cohort_filter_taggedTemplateLiteral(["<opencga-date-filter .config=\"", "\" @filterChange=\"", "\"></opencga-date-filter>"]);

  opencga_cohort_filter_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_cohort_filter_templateObject4() {
  const data = opencga_cohort_filter_taggedTemplateLiteral(["<select-field-filter ?multiple=\"", "\" .data=\"", "\" .value=\"", "\" @filterChange=\"", "\"></select-field-filter>"]);

  opencga_cohort_filter_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_cohort_filter_templateObject3() {
  const data = opencga_cohort_filter_taggedTemplateLiteral(["<opencga-annotation-filter .opencgaSession=\"", "\"\n                                                      .opencgaClient=\"", "\"\n                                                      entity=\"COHORT\"\n                                                      .config=\"", "\"\n                                                      @filterannotation=\"", "\">\n                           </opencga-annotation-filter>"]);

  opencga_cohort_filter_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_cohort_filter_templateObject2() {
  const data = opencga_cohort_filter_taggedTemplateLiteral(["<text-field-filter placeholder=\"", "\" .value=\"", "\" @filterChange=\"", "\"></text-field-filter>"]);

  opencga_cohort_filter_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_cohort_filter_templateObject() {
  const data = opencga_cohort_filter_taggedTemplateLiteral(["<section-filter .config=\"", "\" .filters=\"", "\">"]);

  opencga_cohort_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_cohort_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_cohort_filter_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_cohort_filter_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_cohort_filter_ownKeys(Object(source), true).forEach(function (key) { opencga_cohort_filter_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_cohort_filter_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_cohort_filter_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */








class opencga_cohort_filter_OpencgaCohortFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object // observer: "updateVariableSets"

      },
      opencgaClient: {
        type: Object
      },
      cohorts: {
        type: Array
      },
      query: {
        type: Object
      },
      search: {
        type: Object
      },
      variableSets: {
        type: Array
      },
      variables: {
        type: Array
      },
      minYear: {
        type: Number
      },
      compact: {
        type: Boolean
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    // super.ready();
    this._prefix = "osf-" + utils.randomString(6) + "_";
    const _years = [];
    const fullDate = new Date();
    const limitYear = fullDate.getFullYear();

    for (let year = this.minYear; year <= limitYear; year++) {
      _years.push(year);
    } // This change triggers the polymer dom-repeat


    this.years = _years; // Init arrays for Date selector

    const _yearsToSearch = [];

    for (let year = limitYear, i = 0; i < 5; year--, i++) {
      _yearsToSearch.push(year);
    }

    this.yearsToSearch = _yearsToSearch;
    this.monthToSearch = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
    const _days = [];

    for (let i = 1; i <= 31; i++) {
      _days.push(i);
    }

    this.daysToSearch = _days;
    this.annotationFilterConfig = {
      class: "small",
      buttonClass: "btn-sm",
      inputClass: "input-sm"
    };
    this.dateFilterConfig = {
      recentDays: 10
    };
    this.minYear = 1920;
    this.query = {};
    this.preparedQuery = {};
    this.searchButton = true;
  }

  connectedCallback() {
    super.connectedCallback();
    this.preparedQuery = opencga_cohort_filter_objectSpread({}, this.query); // propagates here the iva-app query object
  }

  updated(changedProperties) {
    if (changedProperties.has("query")) {
      this.queryObserver();
    }

    if (changedProperties.has("variables")) {
      this.variablesChanged();
    }
  }

  firstUpdated(_changedProperties) {// Decrease the button and font size of the selectpicker component
    // const annotationDiv = $(`#${this._prefix}-type-div`);
    // Add the class to the select picker buttons
    // annotationDiv.find(".selectpicker").selectpicker("setStyle", "btn-sm", "add");
    // Add the class to the lists
    // annotationDiv.find("ul > li").addClass("small");
  }

  onSearch() {
    this.search = opencga_cohort_filter_objectSpread({}, this.query);
    this.notifySearch(this.preparedQuery);
  }

  addAnnotation(e) {
    if (typeof this._annotationFilter === "undefined") {
      this._annotationFilter = {};
    }

    const split = e.detail.value.split("=");
    this._annotationFilter[split[0]] = split[1];
    const _query = {};
    Object.assign(_query, this.query);
    const annotations = [];

    for (const key in this._annotationFilter) {
      annotations.push("".concat(key, "=").concat(this._annotationFilter[key]));
    }

    _query["annotation"] = annotations.join(";");
    this._reset = false; // this.set("query", _query);

    this.query = _query;
    this._reset = true;
  }
  /*
  onDateChanged(e) {
      const query = {};
      Object.assign(query, this.query);
      if (UtilsNew.isNotEmpty(e.detail.date)) {
          query["creationDate"] = e.detail.date;
      } else {
          delete query["creationDate"];
      }
       this._reset = false;
      // this.set("query", _query);
      this.query = query;
      this._reset = true;
  }*/


  queryObserver() {
    if (this._reset) {
      console.log("queryObserver: calling to 'renderQueryFilters()'", this.query);
      this.preparedQuery = this.query; // renderQueryFilters shouldn't be necessary anymore
      // this.renderQueryFilters();

      this.requestUpdate();
    } else {
      this._reset = true;
    }
  }

  renderQueryFilters() {
    // Empty everything before rendering
    this._clearHtmlDom();

    this._checkAnnotations(); // Cohort


    if (utilsNew_UtilsNew.isNotUndefined(this.query.name)) {
      PolymerUtils_PolymerUtils.setValue(this._prefix + "CohortName", this.query.name);
    }
  }

  onFilterChange(key, value) {
    console.log("filterChange", {
      [key]: value
    });

    if (value && value !== "") {
      this.preparedQuery = opencga_cohort_filter_objectSpread({}, this.preparedQuery, {}, {
        [key]: value
      });
    } else {
      console.log("deleting", key, "from preparedQuery");
      delete this.preparedQuery[key];
      this.preparedQuery = opencga_cohort_filter_objectSpread({}, this.preparedQuery);
    }

    this.notifyQuery(this.preparedQuery);
    this.requestUpdate();
  }

  notifyQuery(query) {
    this.dispatchEvent(new CustomEvent("queryChange", {
      detail: {
        query: query
      },
      bubbles: true,
      composed: true
    }));
  }

  notifySearch(query) {
    this.dispatchEvent(new CustomEvent("querySearch", {
      detail: {
        query: query
      },
      bubbles: true,
      composed: true
    }));
  }

  _createSection(section) {
    const htmlFields = section.fields && section.fields.length && section.fields.map(subsection => this._createSubSection(subsection));
    return this.config.sections.length > 1 ? lit_html_lit_html_html(opencga_cohort_filter_templateObject(), section, htmlFields) : htmlFields;
  }

  _createSubSection(subsection) {
    let content = "";

    switch (subsection.id) {
      case "id":
      case "samples":
        content = lit_html_lit_html_html(opencga_cohort_filter_templateObject2(), subsection.placeholder, this.preparedQuery[subsection.id], e => this.onFilterChange(subsection.id, e.detail.value));
        break;

      case "annotations":
        content = lit_html_lit_html_html(opencga_cohort_filter_templateObject3(), this.opencgaSession, this.opencgaSession.opencgaClient, this.annotationFilterConfig, this.addAnnotation);
        break;

      case "type":
        content = lit_html_lit_html_html(opencga_cohort_filter_templateObject4(), subsection.multiple, subsection.allowedValues, this.preparedQuery[subsection.id], e => this.onFilterChange(subsection.id, e.detail.value));
        break;

      case "date":
        content = lit_html_lit_html_html(opencga_cohort_filter_templateObject5(), this.dateFilterConfig, e => this.onFilterChange("creationDate", e.detail.value));
        break;

      default:
        console.error("Filter component not found");
    }

    return lit_html_lit_html_html(opencga_cohort_filter_templateObject6(), subsection.id, subsection.name, subsection.description ? lit_html_lit_html_html(opencga_cohort_filter_templateObject7(), this._prefix, subsection.id) : null, this._prefix, subsection.id, content);
  }

  addAnnotationFilter(e) {
    const _query = {};
    const annotations = [];
    let annotationTextInputElements = PolymerUtils_PolymerUtils.getElementsByClassName(this._prefix + "AnnotationTextInput");

    for (const annot of annotationTextInputElements) {
      if (annot.value !== "") {
        annotations.push(annot.dataset.variableName + "=" + annot.value);
      }
    }

    annotationTextInputElements = PolymerUtils_PolymerUtils.getElementsByClassName(this._prefix + "AnnotationSelect");

    for (const annot of annotationTextInputElements) {
      if (annot.value !== "") {
        annotations.push(annot.dataset.variableName + "=" + annot.value);
      }
    }

    _query.annotation = annotations.join(",");
    this._reset = false; // this.set("query", _query);

    this.query = _query;
    this._reset = true;
  }

  _getDateFilter(e) {
    const year = PolymerUtils_PolymerUtils.getElementById(this._prefix + "YearSelect").value;
    const month = PolymerUtils_PolymerUtils.getElementById(this._prefix + "MonthSelect").value;
    let day = PolymerUtils_PolymerUtils.getElementById(this._prefix + "DaySelect").value;
    let date;

    if (month === "any") {
      date = "~^" + year + "*";
    } else {
      let monthIndex = this.monthToSearch.indexOf(month) + 1;

      if (monthIndex < 10) {
        monthIndex = "0" + monthIndex;
      }

      if (day === "any") {
        date = "~^" + year + monthIndex + "*";
      } else {
        if (day < 10) {
          day = "0" + day;
        }

        date = "~^" + year + monthIndex + day + "*";
      }
    }

    return date;
  }

  updateVariableSets() {
    this.variables = [];

    const _this = this;

    this.opencgaClient.studies().info(this.opencgaSession.study.id, {
      include: "variableSets"
    }).then(function (response) {
      _this.variableSets = response.response[0].result[0].variableSets; // debugger

      if (_this.variableSets.length > 0) {
        _this.variables = _this.variableSets[0].variables; // setting first one by default

        _this.filteredVariables = {
          variableSet: _this.variableSets[0].id,
          variables: []
        };
      } else {
        // _this.variableSets = [{name: "none"}];
        _this.variableSets = [];
      }
    }).catch(function () {
      console.log("Could not obtain the variable sets of the study " + _this.opencgaSession.study);
    });
  }

  renderVariableTemplate() {
    const myTemplate = PolymerUtils_PolymerUtils.getElementById(this._prefix + "VariableTemplate");

    if (utilsNew_UtilsNew.isNotNull(myTemplate)) {
      myTemplate.render();
    }
  }

  variableSelected(e) {
    this.variable = e.target.dataVariable;

    if (utilsNew_UtilsNew.isUndefined(this.variable) || Object.getOwnPropertyNames(this.variable).length === 0) {
      return;
    }

    this._isCategorical = false;
    this._isText = false;
    this._isNumerical = false;
    this._isBoolean = false;
    this._isObject = false;

    if (this.variable.type.toLowerCase() === "categorical") {
      this._isCategorical = true;
    } else if (this.variable.type.toLowerCase() === "text") {
      this._isText = true;
    } else if (this.variable.type.toLowerCase() === "numeric") {
      this._isNumerical = true;
    } else if (this.variable.type.toLowerCase() === "boolean") {
      this._isBoolean = true;
    } else if (this.variable.type.toLowerCase() === "object") {
      this._isObject = true;
    } // TODO Refactor


    $(e.target.dataTarget).modal("show");
  }

  updateCompactFilter(e) {
    let myFilter = {};

    if (this.variable.type.toLowerCase() === "categorical") {
      const allValues = []; // TODO Refactor

      const selected = $("input[name='" + this._prefix + "Categorical']:checked");

      for (let i = 0; i < selected.length; i++) {
        allValues.push(selected[i].value);
      }

      myFilter = {
        name: this.variable.name,
        value: allValues.join()
      };
    } else if (this.variable.type.toLowerCase() === "text") {
      // TODO Refactor
      const value = $("input[name='" + this._prefix + "Text']");
      myFilter = {
        name: this.variable.name,
        value: value.value
      };
      value.value = "";
    } else if (this.variable.type.toLowerCase() === "numeric") {
      // TODO Refactor
      const value = $("input[name='" + this._prefix + "Numerical']");
      myFilter = {
        name: this.variable.name,
        value: value.value
      };
      value.value = "";
    } else if (this.variable.type.toLowerCase() === "boolean") {
      this._isBoolean = true;
    } else if (this.variable.type.toLowerCase() === "object") {
      this._isObject = true;
    }

    this.query[myFilter.name] = myFilter.value;
    this.query = Object.assign({}, this.query);
    this.fire("opencga-filter-added", myFilter);
  }

  variablesChanged() {
    this._areVariablesEmpty = this.variables.length === 0;
  }

  checkVarType(myVar, type) {
    return myVar.type === type;
  }

  checkCatType(myVar, type, lowerLimit, upperLimit) {
    return myVar.type === type && myVar.allowedValues.length >= lowerLimit && myVar.allowedValues.length < upperLimit;
  }

  checkYears(e) {
    e.preventDefault(); // prevents the hash change to "#" and allows to manipulate the hash fragment as needed

    PolymerUtils_PolymerUtils.innerHTML(this._prefix + "_errorDiv_birthYear", "");
    PolymerUtils_PolymerUtils.innerHTML(this._prefix + "_errorDiv_testYear", "");
    let currentElement = PolymerUtils_PolymerUtils.getElementById(e.target.id);
    const identifier = e.target.id;
    let pairElement = "";
    let divSuffix = "";
    let message = "";

    if (identifier.search("birthYear") !== -1) {
      // Birth year element raises the event -> check Test year
      pairElement = PolymerUtils_PolymerUtils.getElementById(this._prefix + "testYear");
      divSuffix = "birthYear";
      message = "Year of Birth must be prior to year of Test";
    } else {
      // Year of test element raises the event -> swap elements and check the birth year
      currentElement = PolymerUtils_PolymerUtils.getElementById(this._prefix + "birthYear");
      pairElement = PolymerUtils_PolymerUtils.getElementById(e.target.id);
      divSuffix = "testYear";
      message = "Year of Test must be posterior to year of Birth";
    }

    if (PolymerUtils_PolymerUtils.querySelectorAll("option:selected", pairElement) !== "" && parseInt(PolymerUtils_PolymerUtils.querySelectorAll("option:selected", currentElement).textContent) > parseInt(PolymerUtils_PolymerUtils.querySelectorAll("option:selected", pairElement).textContent)) {
      // Year of birth cannot be lower than Year of test
      PolymerUtils_PolymerUtils.innerHTML(this._prefix + "_errorDiv_" + divSuffix, message);
    }
  }

  checkType(str1, str2) {
    return str1.search(str2) !== -1;
  }

  _filterVariable(variable) {
    for (let i = 0; i < this.filteredVariables.variables.length; i++) {
      if (variable.name === this.filteredVariables.variables[i].name) {
        return false;
      }
    }

    if (utilsNew_UtilsNew.isNotUndefined(this.searchVariable) && variable.name.toLowerCase().indexOf(this.searchVariable.toLowerCase()) === -1) {
      return false;
    }

    return true;
  }

  _sortVariables(a, b) {
    if (a.rank < b.rank) {
      return -1;
    }

    return 1;
  }

  _changeMode(e) {
    this.compact = !this.compact;
  }

  _checkAnnotations() {
    if (typeof this._annotationFilter !== "undefined") {
      const annotations = this.query["annotation"];
      this._annotationFilter = {};

      if (typeof annotations !== "undefined") {
        const splitAnnotations = annotations.split(";");

        for (const i in splitAnnotations) {
          const splitAnnotation = splitAnnotations[i].split("=");
          this._annotationFilter[splitAnnotation[0]] = splitAnnotation[1];
        }
      }
    }
  }
  /**
   * Use custom CSS class to easily reset all controls.
   */


  _clearHtmlDom() {
    // Input controls
    PolymerUtils_PolymerUtils.setPropertyByClassName(this._prefix + "FilterTextInput", "value", "");
    PolymerUtils_PolymerUtils.removeAttributebyclass(this._prefix + "FilterTextInput", "disabled"); // Uncheck checkboxes

    PolymerUtils_PolymerUtils.setPropertyByClassName(this._prefix + "FilterCheckBox", "checked", false); // Set first option and make it active

    PolymerUtils_PolymerUtils.setAttributeByClassName(this._prefix + "FilterSelect", "selectedIndex", 0);
    PolymerUtils_PolymerUtils.removeAttributebyclass(this._prefix + "FilterSelect", "disabled");
    PolymerUtils_PolymerUtils.setPropertyByClassName(this._prefix + "FilterRadio", "checked", false);
    PolymerUtils_PolymerUtils.setAttributeByClassName(this._prefix + "FilterRadio", "disabled", true); // TODO Refactor

    $("." + this._prefix + "FilterRadio").filter("[value=\"or\"]").prop("checked", true);
  }

  isVisible(myVar) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.config) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.config.variableSet)) {
      const excludeArray = this.config.variableSet.exclude;

      for (const index in excludeArray) {
        if (excludeArray[index].webComponent === this.localName) {
          return !(excludeArray[index].variable.indexOf(myVar.name) !== -1);
        } else {
          return true;
        }
      }
    }

    return true;
  }

  render() {
    return lit_html_lit_html_html(opencga_cohort_filter_templateObject8(), this.searchButton ? lit_html_lit_html_html(opencga_cohort_filter_templateObject9(), this.onSearch) : null, this._prefix, this.config.sections && this.config.sections.length ? this.config.sections.map(section => this._createSection(section)) : lit_html_lit_html_html(opencga_cohort_filter_templateObject10()));
  }

}
customElements.define("opencga-cohort-filter", opencga_cohort_filter_OpencgaCohortFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/cohorts/opencga-cohort-browser.js
function opencga_cohort_browser_templateObject2() {
  const data = opencga_cohort_browser_taggedTemplateLiteral(["\n            <div class=\"page-title\">\n                <h2>\n                    <i class=\"fa fa-users\" aria-hidden=\"true\"></i> </i>&nbsp;", "\n                </h2>\n            </div>\n        "]);

  opencga_cohort_browser_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_cohort_browser_templateObject() {
  const data = opencga_cohort_browser_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .icon-padding {\n                padding-left: 4px;\n                padding-right: 5px;\n            }\n\n            .detail-tab-title {\n                font-size: 115%;\n                font-weight: bold;\n            }\n        </style>\n\n        ", "\n        \n        <div class=\"row\" style=\"padding: 0px 10px\">\n            <div class=\"col-md-2\">\n                <opencga-cohort-filter .opencgaSession=\"", "\"\n                                       .config=\"", "\"\n                                       .cohorts=\"", "\"\n                                       .opencgaClient=\"", "\"\n                                       .query=\"", "\"\n                                       .search=\"", "\"\n                                        @queryChange=\"", "\"\n                                        @querySearch=\"", "\">\n                </opencga-cohort-filter>\n            </div>\n\n            <div class=\"col-md-10\">\n                <opencga-active-filters .opencgaSession=\"", "\"\n                                        .query=\"", "\"\n                                        .refresh=\"", "\"\n                                        .filters=\"", "\"\n                                        .defaultStudy=\"", "\"\n                                        .config=\"", "\"\n                                        .alias=\"", "\"\n                                        @activeFilterClear=\"", "\"\n                                        @activeFilterChange=\"", "\">\n                </opencga-active-filters>\n\n                <!-- Cohort View Buttons -->\n                <div style=\"padding: 5px 0px 5px 0px\">\n                    <div class=\"btn-toolbar\" role=\"toolbar\" aria-label=\"...\" style=\"padding: 10px 0px;margin-left: 0px\">\n                        <div class=\"btn-group\" role=\"group\" style=\"margin-left: 0px\">\n                            <button type=\"button\" class=\"btn btn-success cohort-browser-view-buttons ripple active\" data-view=\"TableResult\" @click=\"", "\" data-id=\"table\">\n                                <i class=\"fa fa-table icon-padding\" aria-hidden=\"true\" data-view=\"TableResult\" @click=\"", "\" data-id=\"table\"></i> Table Result\n                            </button>\n                            <button type=\"button\" class=\"btn btn-success cohort-browser-view-buttons ripple\" data-view=\"Summary\" @click=\"", "\">\n                                <i class=\"fas fa-chart-bar icon-padding\" aria-hidden=\"true\" data-view=\"Summary\" @click=\"", "\"></i> Summary Stats\n                            </button>\n                            <button type=\"button\" class=\"btn btn-success cohort-browser-view-buttons ripple\" data-view=\"CohortComparator\" @click=\"", "\" data-id=\"comparator\">\n                                <i class=\"fa fa-users icon-padding\" aria-hidden=\"true\" data-view=\"CohortComparator\" @click=\"", "\" data-id=\"comparator\"></i> Cohort Comparator\n                            </button>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- Cohort View Content -->\n                <div>\n                    <div id=\"", "TableResult\" class=\"cohort-browser-view-content\">\n                        <opencga-cohort-grid .opencgaSession=\"", "\"\n                                             .opencgaClient=\"", "\"\n                                             .query=\"", "\"\n                                             .search=\"", "\"\n                                             .config=\"", "\"\n                                             .eventNotifyName=\"", "\"\n                                             .active=\"", "\"\n                                             style=\"font-size: 12px\"\n                                             @selectcohort=\"", "\">\n                        </opencga-cohort-grid>\n\n                        <div style=\"padding-top: 5px\">\n                            <ul id=\"", "ViewTabs\" class=\"nav nav-tabs\" role=\"tablist\">\n\n                                <li role=\"presentation\" class=\"active\">\n                                    <a href=\"#", "CohortViewer\" role=\"tab\" data-toggle=\"tab\" class=\"detail-tab-title\"\n                                       data-id=\"info\" @click=\"", "\">\n                                        Cohort info\n                                    </a>\n                                </li>\n\n                                <li role=\"presentation\">\n                                    <a href=\"#", "SampleViewer\" role=\"tab\" data-toggle=\"tab\" class=\"detail-tab-title\"\n                                       data-id=\"sampleGrid\" @click=\"", "\">\n                                        Sample grid\n                                    </a>\n                                </li>\n                            </ul>\n\n                            <div class=\"tab-content\" style=\"height: 680px\">\n                                <div role=\"tabpanel\" class=\"tab-pane active\" id=\"", "CohortViewer\">\n                                    Work in progress\n                                </div>\n                                <div role=\"tabpanel\" class=\"tab-pane\" id=\"", "SampleViewer\">\n                                    <opencga-sample-grid .opencgaClient=\"", "\"\n                                                         .opencgaSession=\"", "\"\n                                                         .search=\"", "\"\n                                                         .active=\"", "\"\n                                                         style=\"font-size: 12px\" >\n                                    </opencga-sample-grid>\n                                </div>\n\n                            </div>\n                        </div>\n                    </div>\n\n                    <div id=\"", "Summary\" class=\"cohort-browser-view-content\" style=\"display: none;\" >\n                        <opencb-facet-query resource=\"cohorts\"\n                                            .opencgaSession=\"", "\"\n                                            .cellbaseClient=\"", "\"  \n                                            .config=\"", "\"\n                                            .query=\"", "\"\n                                            .active=\"", "\">\n                        </opencb-facet-query>\n                    </div>\n\n                    <div id=\"", "CohortComparator\" class=\"cohort-browser-view-content\" style=\"display: none\">\n\n                        <opencga-cohort-grid .opencgaClient=\"", "\"\n                                             .opencgaSession=\"", "\"\n                                             .config=\"", "\"\n                                             .eventNotifyName=\"", "\"\n                                             .search=\"", "\"\n                                             .active=\"", "\"\n                                             style=\"font-size: 12px\"\n                                             @selectcohort=\"", "\">\n                        </opencga-cohort-grid>\n\n                        <div style=\"padding-top: 5px\">\n                            <h3> Annotation comparator</h3>\n                            <opencga-annotation-viewer .opencgaClient=\"", "\"\n                                                       .opencgaSession=\"", "\"\n                                                       .config=\"", "\"\n                                                       .entryIds=\"", "\"\n                                                       entity=\"COHORT\">\n                            </opencga-annotation-viewer>\n                        </div>\n\n                    </div>\n                </div>\n            </div>\n        </div>\n        "]);

  opencga_cohort_browser_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_cohort_browser_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_cohort_browser_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_cohort_browser_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_cohort_browser_ownKeys(Object(source), true).forEach(function (key) { opencga_cohort_browser_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_cohort_browser_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_cohort_browser_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */










class opencga_cohort_browser_OpencgaCohortBrowser extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object // observer: "renderAnalysisTable" TODO it doesn't exist

      },
      filters: {
        type: Object,
        notify: true // observer: "onFilterUpdate" TODO it doesn't exist

      },
      //TODO remove
      search: {
        type: Object,
        notify: true
      },
      config: {
        type: Object
      },
      query: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ocb-" + utils.randomString(6) + "_";
    this.cohorts = [];
    this.sampleSearch = {
      id: "nonexisting"
    };
    this._config = this.getDefaultConfig();
    this.filtersConfig = {
      complexFields: ["annotation"]
    };

    if (utilsNew_UtilsNew.isUndefinedOrNull(this._selectedCohortsComparator)) {
      this._selectedCohortsComparator = {
        set: new Set(),
        array: []
      };
    } //TODO active flag of Summary tab have to be included here


    this.activeMenu = {
      table: true,
      comparator: false
    };
    this.detailActiveTabs = {
      info: true,
      sampleGrid: false
    };
  }

  updated(changedProperties) {
    if (changedProperties.has("config")) {
      this.configObserver();
    }

    if (changedProperties.has("opencgaSession") || changedProperties.has("config")) {
      this.filterAvailableVariableSets();
    }

    if (changedProperties.has("cohorts")) {
      this.cohortObserver();
    }

    if (changedProperties.has("query")) {
      this.queryObserver();
    }
  }

  configObserver() {
    this._config = Object.assign(this.getDefaultConfig(), this.config);
  }

  queryObserver() {
    if (this.query) {
      this.preparedQuery = opencga_cohort_browser_objectSpread({}, this.query);
      this.executedQuery = opencga_cohort_browser_objectSpread({}, this.query);
    } // onServerFilterChange() in opencga-active-filters drops a filterchange event when the Filter dropdown is used


    this.requestUpdate();
  }

  _changeView(e) {
    e.preventDefault(); // prevents the hash change to "#" and allows to manipulate the hash fragment as needed

    const activeMenu = {
      table: e.currentTarget.dataset.id === "table",
      comparator: e.currentTarget.dataset.id === "comparator"
    }; // this.set("activeMenu", activeMenu);

    this.activeMenu = activeMenu;
    $(".cohort-browser-view-content").hide(); // hides all content divs

    if (typeof e.target !== "undefined" && typeof e.target.dataset.view !== "undefined") {
      PolymerUtils_PolymerUtils.show(this._prefix + e.target.dataset.view);
    } // Show the active button


    $(".cohort-browser-view-buttons").removeClass("active");
    $(e.target).addClass("active");

    if (e.target.dataset.view === "Summary") {
      this.SummaryActive = true;
      this.requestUpdate();
    } else {
      this.SummaryActive = false;
    }

    this.requestUpdate();
  }

  onSelectCohort(e) {
    const sampleList = [];

    for (let i = 0; i < e.detail.cohort.samples.length; i++) {
      sampleList.push(e.detail.cohort.samples[i].id);
    }

    this.sampleSearch = {
      id: sampleList.join(",")
    };
  }

  onSelectCohortComparator(e) {
    /*if (UtilsNew.isUndefinedOrNull(this._selectedCohortsComparator)) {
        this._selectedCohortsComparator = {
            set: new Set(),
            array: []
        };
    }*/
    if (e.detail.checked) {
      this._selectedCohortsComparator.set.add(e.detail.cohort);
    } else {
      this._selectedCohortsComparator.set.delete(e.detail.cohort);
    } // this.set("_selectedCohortsComparator.array", Array.from(this._selectedCohortsComparator.set));


    this._selectedCohortsComparator.array = Array.from(this._selectedCohortsComparator.set);
  }

  filterAvailableVariableSets() {
    if (this._config.variableSetIds.length === 0) {
      this.variableSets = this.opencgaSession.study.variableSets;
    } else {
      const variableSets = [];

      for (let i = 0; i < this.opencgaSession.study.variableSets.length; i++) {
        if (this._config.variableSetIds.indexOf(this.opencgaSession.study.variableSets[i].id) !== -1) {
          variableSets.push(this.opencgaSession.study.variableSets[i]);
        }
      }

      this.variableSets = variableSets;
    }
  }

  executeFacet() {}

  cohortObserver() {
    this.dispatchEvent(new CustomEvent("cohortchange", {
      detail: {
        cohorts: this.cohorts
      },
      bubbles: true,
      composed: true
    }));
  }

  _changeBottomTab(e) {
    const _activeTabs = {
      info: e.currentTarget.dataset.id === "info",
      sampleGrid: e.currentTarget.dataset.id === "sampleGrid"
    }; // this.set("detailActiveTabs", _activeTabs);

    this.detailActiveTabs = _activeTabs;
  }

  onQueryFilterChange(e) {
    console.log("onQueryFilterChange on sample browser", e.detail.query);
    this.preparedQuery = e.detail.query;
    this.requestUpdate();
  }

  onQueryFilterSearch(e) {
    this.preparedQuery = e.detail.query;
    this.executedQuery = e.detail.query;
    this.requestUpdate();
  }

  onActiveFilterChange(e) {
    console.log("onActiveFilterChange on cohort browser", e.detail);
    this.preparedQuery = opencga_cohort_browser_objectSpread({}, e.detail);
    this.query = opencga_cohort_browser_objectSpread({}, e.detail);
    this.requestUpdate();
  }

  onActiveFilterClear() {
    this._config = opencga_cohort_browser_objectSpread({}, this.getDefaultConfig(), {}, this.config);
    this.query = {}; //this.search = {};

    this.preparedQuery = {};
    this.requestUpdate();
  }

  getDefaultConfig() {
    return {
      title: "Cohort Browser",
      showTitle: true,
      showAggregationStats: true,
      showComparator: true,
      filter: {},
      grid: {},
      gridComparator: {
        multiSelection: true,
        pageSize: 5,
        pageList: [5, 10]
      },
      variableSetIds: [],
      summary: {
        fields: ["name"]
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_cohort_browser_templateObject(), this._config.showTitle ? lit_html_lit_html_html(opencga_cohort_browser_templateObject2(), this._config.title) : null, this.opencgaSession, this._config, this.cohorts, this.opencgaSession.opencgaClient, this.query, this.search, this.onQueryFilterChange, this.onQueryFilterSearch, this.opencgaSession, this.preparedQuery, this.executedQuery, this._config.filters, this.opencgaSession.study.alias, this.filtersConfig, this.activeFilterAlias, this.onActiveFilterClear, this.onActiveFilterChange, this._changeView, this._changeView, this._changeView, this._changeView, this._changeView, this._changeView, this._prefix, this.opencgaSession, this.opencgaSession.opencgaClient, this.executedQuery, this.executedQuery, this._config.grid, this.eventNotifyName, this.activeMenu.table, this.onSelectCohort, this._prefix, this._prefix, this._changeBottomTab, this._prefix, this._changeBottomTab, this._prefix, this._prefix, this.opencgaSession.opencgaClient, this.opencgaSession, this.sampleSearch, this.detailActiveTabs.sampleGrid, this._prefix, this.opencgaSession, this.cellbaseClient, this._config, this.executedQuery, this.SummaryActive, this._prefix, this.opencgaSession.opencgaClient, this.opencgaSession, this._config.gridComparator, this.eventNotifyName, this.search, this.activeMenu.comparator, this.onSelectCohortComparator, this.opencgaSession.opencgaClient, this.opencgaSession, this._config, this._selectedCohortsComparator.array);
  }

}
customElements.define("opencga-cohort-browser", opencga_cohort_browser_OpencgaCohortBrowser);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/clinical/opencga-clinical-analysis-facet.js
function opencga_clinical_analysis_facet_templateObject() {
  const data = opencga_clinical_analysis_facet_taggedTemplateLiteral(["\n            <opencga-facet  resource=\"clinical-analysis\"\n                            .opencgaSession=\"", "\"\n                            .opencgaClient=\"", "\"\n                            .query=\"", "\"\n                            .config=\"", "\"\n                            .cellbaseClient=\"", "\">\n            </opencga-facet>"]);

  opencga_clinical_analysis_facet_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_clinical_analysis_facet_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_clinical_analysis_facet_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_clinical_analysis_facet_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_clinical_analysis_facet_ownKeys(Object(source), true).forEach(function (key) { opencga_clinical_analysis_facet_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_clinical_analysis_facet_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_clinical_analysis_facet_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



class opencga_clinical_analysis_facet_OpencgaClinicalAnalysisFacet extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      query: {
        type: Object
      },
      search: {
        type: Object
      },
      config: {
        type: Object
      },
      facetQuery: {
        type: Object
      },
      selectedFacet: {
        type: Object
      },
      resource: {
        type: String
      }
    };
  }

  _init() {
    this._prefix = "facet" + utils.randomString(6);
    this.checkProjects = false;
    this.activeFilterAlias = {
      "annot-xref": "XRef",
      "biotype": "Biotype",
      "annot-ct": "Consequence Types",
      "alternate_frequency": "Population Frequency",
      "annot-functional-score": "CADD",
      "protein_substitution": "Protein Substitution",
      "annot-go": "GO",
      "annot-hpo": "HPO"
    };
    this.fixedFilters = ["studies"]; // These are for making the queries to server

    this.facetFields = [];
    this.facetRanges = [];
    this.facetFieldsName = [];
    this.facetRangeFields = [];
    this.results = [];
    this._showInitMessage = true;
    this.facets = new Set();
    this.facetFilters = [];
    this.facetConfig = {
      a: 1
    };
    this.facetActive = true;
    this.query = {};
    this.preparedQuery = {};
    this.selectedFacet = {};
    this.selectedFacetFormatted = {};
    this.errorState = false;
  }

  connectedCallback() {
    super.connectedCallback();
    this._config = opencga_clinical_analysis_facet_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  getDefaultConfig() {
    return {
      title: "Clinical Analysis Browser",
      showTitle: true,
      showAggregationStats: true,
      showComparator: true,
      filter: {
        sections: [{
          name: "section title",
          fields: [{
            id: "id",
            name: "Clinical Analysis ID",
            type: "string",
            placeholder: "CA-1234,CA-2345...",
            description: ""
          }, {
            id: "family",
            name: "Family ID",
            type: "string",
            placeholder: "FAM123, FAM124...",
            description: ""
          }, {
            id: "proband",
            name: "Proband ID",
            placeholder: "LP-1234, LP-2345...",
            description: ""
          }, {
            id: "samples",
            name: "Sample ID",
            placeholder: "HG01879, HG01880, HG01881...",
            description: ""
          }, {
            id: "priority",
            name: "Priority",
            allowedValues: ["URGENT", "HIGH", "MEDIUM", "LOW"],
            description: ""
          }, {
            id: "type",
            name: "Analysis type",
            allowedValues: ["SINGLE", "DUO", "TRIO", "FAMILY", "AUTO", "MULTISAMPLE"],
            description: ""
          }, {
            id: "date",
            name: "Date",
            description: ""
          }]
        }],
        grid: {
          pageSize: 10,
          pageList: [10, 25, 50],
          detailView: false,
          multiSelection: false
        }
      },
      aggregation: {
        default: [],
        sections: [{
          name: "section title",
          fields: [{
            id: "include",
            name: "include",
            type: "string",
            description: "Fields included in the response, whole JSON path must be provided"
          }, {
            id: "exclude",
            name: "exclude",
            type: "string",
            description: "Fields excluded in the response, whole JSON path must be provided"
          }, {
            name: "limit",
            type: "integer",
            description: "Number of results to be returned"
          }, {
            name: "skip",
            type: "integer",
            description: "Number of results to skip"
          }, {
            name: "count",
            type: "category",
            allowedValues: ["true", "false"],
            multiple: false,
            defaultValue: "false",
            description: "Get the total number of results matching the query. Deactivated by default."
          }, {
            name: "sort",
            type: "category",
            allowedValues: ["true", "false"],
            multiple: false,
            defaultValue: "false",
            description: "Sort the results"
          }, {
            name: "summary",
            type: "category",
            allowedValues: ["true", "false"],
            multiple: false,
            defaultValue: "false",
            description: "Fast fetch of main variant parameters"
          }, {
            name: "approximateCount",
            type: "category",
            allowedValues: ["true", "false"],
            multiple: false,
            defaultValue: "false",
            description: "Get an approximate count, instead of an exact total count. Reduces execution time"
          }, {
            name: "approximateCountSamplingSize",
            type: "integer",
            description: "Sampling size to get the approximate count. Larger values increase accuracy but also increase execution time"
          }, {
            name: "id",
            type: "string",
            description: "List of IDs, these can be rs IDs (dbSNP) or variants in the format chrom:start:ref:alt, e.g. rs116600158,19:7177679:C:T"
          }, {
            name: "region",
            type: "string",
            description: "List of regions, these can be just a single chromosome name or regions in the format chr:start-end, e.g.: 2,3:100000-200000"
          }, {
            name: "type",
            type: "string",
            description: "List of types, accepted values are SNV, MNV, INDEL, SV, CNV, INSERTION, DELETION, e.g. SNV,INDEL"
          }, {
            name: "reference",
            type: "string",
            description: "Reference allele"
          }, {
            name: "alternate",
            type: "string",
            description: "Main alternate allele"
          }, {
            name: "project",
            type: "string",
            description: "Project [user@]project where project can be either the ID or the alias"
          }, {
            name: "study",
            type: "string",
            description: "Filter variants from the given studies, these can be either the numeric ID or the alias with the format user@project:study"
          }, {
            name: "file",
            type: "string",
            description: "Filter variants from the files specified. This will set includeFile parameter when not provided"
          }, {
            name: "filter",
            type: "string",
            description: "Specify the FILTER for any of the files. If 'file' filter is provided, will match the file and the filter. e.g.: PASS,LowGQX"
          }, {
            name: "qual",
            type: "string",
            description: "Specify the QUAL for any of the files. If 'file' filter is provided, will match the file and the qual. e.g.: >123.4"
          }, {
            name: "info",
            type: "string",
            description: "Filter by INFO attributes from file. [{file}:]{key}{op}{value}[,;]* . If no file is specified, will use all files from \"file\" filter. e.g. AN>200 or file_1.vcf:AN>200;file_2.vcf:AN<10 . Many INFO fields can be combined. e.g. file_1.vcf:AN>200;DB=true;file_2.vcf:AN<10"
          }, {
            name: "sample",
            type: "string",
            description: "Filter variants where the samples contain the variant (HET or HOM_ALT). Accepts AND (;) and OR (,) operators. This will automatically set 'includeSample' parameter when not provided"
          }, {
            name: "genotype",
            type: "string",
            description: "Samples with a specific genotype: {samp_1}:{gt_1}(,{gt_n})*(;{samp_n}:{gt_1}(,{gt_n})*)* e.g. HG0097:0/0;HG0098:0/1,1/1. Unphased genotypes (e.g. 0/1, 1/1) will also include phased genotypes (e.g. 0|1, 1|0, 1|1), but not vice versa. When filtering by multi-allelic genotypes, any secondary allele will match, regardless of its position e.g. 1/2 will match with genotypes 1/2, 1/3, 1/4, .... Genotype aliases accepted: HOM_REF, HOM_ALT, HET, HET_REF, HET_ALT and MISS  e.g. HG0097:HOM_REF;HG0098:HET_REF,HOM_ALT. This will automatically set 'includeSample' parameter when not provided"
          }, {
            name: "format",
            type: "string",
            description: "Filter by any FORMAT field from samples. [{sample}:]{key}{op}{value}[,;]* . If no sample is specified, will use all samples from \"sample\" or \"genotype\" filter. e.g. DP>200 or HG0097:DP>200,HG0098:DP<10 . Many FORMAT fields can be combined. e.g. HG0097:DP>200;GT=1/1,0/1,HG0098:DP<10"
          }, {
            name: "sampleAnnotation",
            type: "string",
            description: "Selects some samples using metadata information from Catalog. e.g. age>20;phenotype=hpo:123,hpo:456;name=smith"
          }, {
            name: "sampleMetadata",
            type: "category",
            allowedValues: ["true", "false"],
            multiple: false,
            defaultValue: "false",
            description: "Return the samples metadata group by study. Sample names will appear in the same order as their corresponding genotypes."
          }, {
            name: "unknownGenotype",
            type: "string",
            description: "Returned genotype for unknown genotypes. Common values: [0/0, 0|0, ./.]"
          }, {
            name: "sampleLimit",
            type: "integer",
            description: "Limit the number of samples to be included in the result"
          }, {
            name: "sampleSkip",
            type: "integer",
            description: "Skip some samples from the result. Useful for sample pagination."
          }, {
            name: "cohort",
            type: "string",
            description: "Select variants with calculated stats for the selected cohorts"
          }, {
            name: "cohortStatsRef",
            type: "string",
            description: "Reference Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4"
          }, {
            name: "cohortStatsAlt",
            type: "string",
            description: "Alternate Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4"
          }, {
            name: "cohortStatsMaf",
            type: "string",
            description: "Minor Allele Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4"
          }, {
            name: "cohortStatsMgf",
            type: "string",
            description: "Minor Genotype Frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL<=0.4"
          }, {
            name: "cohortStatsPass",
            type: "string",
            description: "Filter PASS frequency: [{study:}]{cohort}[<|>|<=|>=]{number}. e.g. ALL>0.8"
          }, {
            name: "missingAlleles",
            type: "string",
            description: "Number of missing alleles: [{study:}]{cohort}[<|>|<=|>=]{number}"
          }, {
            name: "missingGenotypes",
            type: "string",
            description: "Number of missing genotypes: [{study:}]{cohort}[<|>|<=|>=]{number}"
          }, {
            name: "score",
            type: "string",
            description: "Filter by variant score: [{study:}]{score}[<|>|<=|>=]{number}"
          }, {
            name: "includeStudy",
            type: "string",
            description: "List of studies to include in the result. Accepts 'all' and 'none'."
          }, {
            name: "includeFile",
            type: "string",
            description: "List of files to be returned. Accepts 'all' and 'none'."
          }, {
            name: "includeSample",
            type: "string",
            description: "List of samples to be included in the result. Accepts 'all' and 'none'."
          }, {
            name: "includeFormat",
            type: "string",
            description: "List of FORMAT names from Samples Data to include in the output. e.g: DP,AD. Accepts 'all' and 'none'."
          }, {
            name: "includeGenotype",
            type: "string",
            description: "Include genotypes, apart of other formats defined with includeFormat"
          }, {
            name: "annotationExists",
            type: "category",
            allowedValues: ["true", "false"],
            multiple: false,
            defaultValue: "false",
            description: "Return only annotated variants"
          }, {
            name: "gene",
            type: "string",
            description: "List of genes, most gene IDs are accepted (HGNC, Ensembl gene, ...). This is an alias to 'xref' parameter"
          }, {
            name: "ct",
            type: "string",
            description: "List of SO consequence types, e.g. missense_variant,stop_lost or SO:0001583,SO:0001578"
          }, {
            name: "xref",
            type: "string",
            description: "List of any external reference, these can be genes, proteins or variants. Accepted IDs include HGNC, Ensembl genes, dbSNP, ClinVar, HPO, Cosmic, ..."
          }, {
            name: "biotype",
            type: "string",
            description: "List of biotypes, e.g. protein_coding"
          }, {
            name: "proteinSubstitution",
            type: "string",
            description: "Protein substitution scores include SIFT and PolyPhen. You can query using the score {protein_score}[<|>|<=|>=]{number} or the description {protein_score}[~=|=]{description} e.g. polyphen>0.1,sift=tolerant"
          }, {
            name: "conservation",
            type: "string",
            description: "Filter by conservation score: {conservation_score}[<|>|<=|>=]{number} e.g. phastCons>0.5,phylop<0.1,gerp>0.1"
          }, {
            name: "populationFrequencyAlt",
            type: "string",
            description: "Alternate Population Frequency: {study}:{population}[<|>|<=|>=]{number}. e.g. 1kG_phase3:ALL<0.01"
          }, {
            name: "populationFrequencyRef",
            type: "string",
            description: "Reference Population Frequency: {study}:{population}[<|>|<=|>=]{number}. e.g. 1kG_phase3:ALL<0.01"
          }, {
            name: "populationFrequencyMaf",
            type: "string",
            description: "Population minor allele frequency: {study}:{population}[<|>|<=|>=]{number}. e.g. 1kG_phase3:ALL<0.01"
          }, {
            name: "transcriptFlag",
            type: "string",
            description: "List of transcript annotation flags. e.g. CCDS, basic, cds_end_NF, mRNA_end_NF, cds_start_NF, mRNA_start_NF, seleno"
          }, {
            name: "geneTraitId",
            type: "string",
            description: "List of gene trait association id. e.g. \"umls:C0007222\" , \"OMIM:269600\""
          }, {
            name: "go",
            type: "string",
            description: "List of GO (Gene Ontology) terms. e.g. \"GO:0002020\""
          }, {
            name: "expression",
            type: "string",
            description: "List of tissues of interest. e.g. \"lung\""
          }, {
            name: "proteinKeyword",
            type: "string",
            description: "List of Uniprot protein variant annotation keywords"
          }, {
            name: "drug",
            type: "string",
            description: "List of drug names"
          }, {
            name: "functionalScore",
            type: "string",
            description: "Functional score: {functional_score}[<|>|<=|>=]{number} e.g. cadd_scaled>5.2 , cadd_raw<=0.3"
          }, {
            name: "clinicalSignificance",
            type: "string",
            description: "Clinical significance: benign, likely_benign, likely_pathogenic, pathogenic"
          }, {
            name: "customAnnotation",
            type: "string",
            description: "Custom annotation: {key}[<|>|<=|>=]{number} or {key}[~=|=]{text}"
          }, {
            name: "trait",
            type: "string",
            description: "List of traits, based on ClinVar, HPO, COSMIC, i.e.: IDs, histologies, descriptions,..."
          }, {
            name: "field",
            type: "string",
            description: "Facet field for categorical fields"
          }, {
            name: "fieldRange",
            type: "string",
            description: "Facet field range for continuous fields"
          }, {
            name: "study",
            type: "string",
            description: "Study [[user@]project:]study where study and project can be either the ID or UUID"
          }, {
            name: "clinicalAnalysisId",
            type: "string",
            description: "Clinical analysis ID"
          }, {
            name: "disease",
            type: "string",
            description: "Disease (HPO term)"
          }, {
            name: "familyId",
            type: "string",
            description: "Family ID"
          }, {
            name: "subjectIds",
            type: "string",
            description: "Comma separated list of subject IDs"
          }, {
            name: "type",
            type: "string",
            description: "Clinical analysis type, e.g. DUO, TRIO, ..."
          }, {
            name: "panelId",
            type: "string",
            description: "Panel ID"
          }, {
            name: "panelVersion",
            type: "string",
            description: "Panel version"
          }, {
            name: "save",
            type: "category",
            allowedValues: ["true", "false"],
            multiple: false,
            defaultValue: "false",
            description: "Save interpretation in Catalog"
          }, {
            name: "interpretationId",
            type: "string",
            description: "ID of the stored interpretation"
          }, {
            name: "interpretationName",
            type: "string",
            description: "Name of the stored interpretation"
          }]
        }]
      },
      // TODO recheck (they come from clinical-analysis-browser and used in opencga-clinical-analysis-filter and opencga-clinical-analysis-grid now they have been moved in config)
      analyses: [],
      analysis: {},
      gridComparator: {
        pageSize: 5,
        pageList: [5, 10],
        detailView: true,
        multiSelection: true
      }
    };
  }

  render() {
    return this._config ? lit_html_lit_html_html(opencga_clinical_analysis_facet_templateObject(), this.opencgaSession, this.opencgaSession.opencgaClient, this.query, this._config, this.cellbaseClient) : null;
  }

}
customElements.define("opencga-clinical-analysis-facet", opencga_clinical_analysis_facet_OpencgaClinicalAnalysisFacet);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/files/opencga-file-facet.js
function opencga_file_facet_templateObject() {
  const data = opencga_file_facet_taggedTemplateLiteral(["\n            <opencga-facet  resource=\"files\"\n                            .opencgaSession=\"", "\"\n                            .query=\"", "\"\n                            .config=\"", "\">\n            </opencga-facet>"]);

  opencga_file_facet_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_file_facet_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_file_facet_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_file_facet_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_file_facet_ownKeys(Object(source), true).forEach(function (key) { opencga_file_facet_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_file_facet_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_file_facet_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


 // TODO this component will be the new opencga-file-browser and this configuration will be for browser and facet both

class opencga_file_facet_OpencgaFileFacet extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      query: {
        type: Object
      },
      search: {
        type: Object
      },
      config: {
        type: Object
      },
      facetQuery: {
        type: Object
      },
      selectedFacet: {
        type: Object
      },
      resource: {
        type: String
      }
    };
  }

  _init() {
    this._prefix = "facet" + utils.randomString(6);
    this.checkProjects = false;
    this.activeFilterAlias = {
      "annot-xref": "XRef",
      "biotype": "Biotype",
      "annot-ct": "Consequence Types",
      "alternate_frequency": "Population Frequency",
      "annot-functional-score": "CADD",
      "protein_substitution": "Protein Substitution",
      "annot-go": "GO",
      "annot-hpo": "HPO"
    };
    this.fixedFilters = ["studies"]; // These are for making the queries to server

    this.facetFields = [];
    this.facetRanges = [];
    this.facetFieldsName = [];
    this.facetRangeFields = [];
    this.results = [];
    this._showInitMessage = true;
    this.facets = new Set();
    this.facetFilters = [];
    this.facetConfig = {
      a: 1
    };
    this.facetActive = true;
    this.query = {};
    this.preparedQuery = {};
    this.selectedFacet = {};
    this.selectedFacetFormatted = {};
    this.errorState = false;
  }

  connectedCallback() {
    super.connectedCallback();
    this._config = opencga_file_facet_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  getDefaultConfig() {
    return {
      title: "File Browser",
      //active: false,
      icon: "fas fa-chart-bar",
      description: "",
      searchButtonText: "Run",
      filter: {
        sections: [{
          title: "Section title",
          collapsed: false,
          fields: [{
            id: "name",
            name: "Name",
            type: "string",
            placeholder: "accepted_hits.bam, phenotypes.vcf...",
            description: ""
          }, {
            id: "path",
            name: "Path",
            type: "string",
            placeholder: "genomes/resources/files/...",
            description: ""
          }, {
            id: "sample",
            name: "Sample",
            type: "string",
            placeholder: "HG01879, HG01880, HG01881...",
            description: ""
          }, {
            id: "format",
            name: "Format",
            type: "category",
            allowedValues: ["VCF", "BCF", "GVCF", "TBI", "BIGWIG", "SAM", "BAM", "BAI", "CRAM", "CRAI", "FASTQ", "FASTA", "PED", "TAB_SEPARATED_VALUES", "COMMA_SEPARATED_VALUES", "XML", "PROTOCOL_BUFFER", "JSON", "AVRO", "PARQUET", "IMAGE", "PLAIN", "BINARY", "EXECUTABLE", "GZIP", "NONE", "UNKNOWN"],
            placeholder: "genomes/resources/files/...",
            description: ""
          }, {
            id: "bioformat",
            name: "Bioformat",
            type: "string",
            placeholder: "ALIGNMENT,VARIANT...",
            description: ""
          }, {
            id: "annotations",
            name: "File annotations",
            description: ""
          }, {
            id: "date",
            name: "Date",
            type: "date",
            description: ""
          }]
        }],
        examples: [{
          name: "Full",
          active: false,
          query: {
            name: "bam",
            path: "genomes",
            sample: "hg3333",
            format: "VCF,BCF,GVCF,BIGWIG",
            bioformat: "ALIGNMENT",
            creationDate: ">=20200216"
          }
        }],
        result: {
          grid: {}
        },
        detail: []
      },
      aggregation: {
        default: ["type", "study>>bioformat"],
        result: {
          numColumns: 2
        },
        sections: [{
          name: "Section Title",
          // collapsed: false,
          fields: [{
            id: "study",
            name: "study",
            type: "string",
            description: "Study [[user@]project:]study where study and project can be either the ID or UUID"
          }, {
            id: "name",
            name: "name",
            type: "string",
            description: "Name"
          }, {
            id: "type",
            name: "type",
            type: "string",
            description: "Type"
          }, {
            id: "format",
            name: "format",
            type: "string",
            description: "Format"
          }, {
            id: "bioformat",
            name: "bioformat",
            type: "string",
            description: "Bioformat"
          }, {
            id: "creationYear",
            name: "creationYear",
            type: "string",
            description: "Creation year"
          }, {
            id: "creationMonth",
            name: "creationMonth",
            type: "string",
            description: "Creation month (JANUARY, FEBRUARY...)"
          }, {
            id: "creationDay",
            name: "creationDay",
            type: "string",
            description: "Creation day"
          }, {
            id: "creationDayOfWeek",
            name: "creationDayOfWeek",
            type: "string",
            description: "Creation day of week (MONDAY, TUESDAY...)"
          }, {
            id: "status",
            name: "status",
            type: "string",
            description: "Status"
          }, {
            id: "release",
            name: "release",
            type: "string",
            description: "Release"
          }, {
            id: "external",
            name: "external",
            type: "category",
            allowedValues: ["true", "false"],
            defaultValue: "false",
            description: "External"
          }, {
            id: "size",
            name: "size",
            type: "string",
            description: "Size"
          }, {
            id: "software",
            name: "software",
            type: "string",
            description: "Software"
          }, {
            id: "experiment",
            name: "experiment",
            type: "string",
            description: "Experiment"
          }, {
            id: "numSamples",
            name: "numSamples",
            type: "string",
            description: "Number of samples"
          }, {
            id: "numRelatedFiles",
            name: "numRelatedFiles",
            type: "string",
            description: "Number of related files"
          }, {
            id: "annotation",
            name: "annotation",
            type: "string",
            description: "Annotation, e.g: key1=value(,key2=value)"
          }, {
            id: "field",
            name: "field",
            type: "string",
            description: "List of fields separated by semicolons, e.g.: studies;type. For nested fields use >>, e.g.: studies>>biotype;type;numSamples[0..10]:1"
          }]
        }]
      }
    };
  }

  render() {
    return this._config ? lit_html_lit_html_html(opencga_file_facet_templateObject(), this.opencgaSession, this.query, this._config) : null;
  }

}
customElements.define("opencga-file-facet", opencga_file_facet_OpencgaFileFacet);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/samples/opencga-sample-facet.js
function opencga_sample_facet_templateObject() {
  const data = opencga_sample_facet_taggedTemplateLiteral(["\n            <opencga-facet  resource=\"samples\"\n                            .opencgaSession=\"", "\"\n                            .opencgaClient=\"", "\"\n                            .query=\"", "\"\n                            .config=\"", "\"\n                            .cellbaseClient=\"", "\"\n                            .populationFrequencies=\"", "\"\n                            .proteinSubstitutionScores=\"", "\"\n                            .consequenceTypes=\"", "\">\n            </opencga-facet>"]);

  opencga_sample_facet_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_sample_facet_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_sample_facet_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_sample_facet_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_sample_facet_ownKeys(Object(source), true).forEach(function (key) { opencga_sample_facet_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_sample_facet_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_sample_facet_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



class opencga_sample_facet_OpencgaSampleFacet extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      query: {
        type: Object
      },
      search: {
        type: Object
      },
      config: {
        type: Object
      },
      facetQuery: {
        type: Object
      },
      selectedFacet: {
        type: Object
      },
      resource: {
        type: String
      }
    };
  }

  _init() {
    this._prefix = "facet" + utils.randomString(6);
    this.checkProjects = false;
    this.activeFilterAlias = {
      "annot-xref": "XRef",
      "biotype": "Biotype",
      "annot-ct": "Consequence Types",
      "alternate_frequency": "Population Frequency",
      "annot-functional-score": "CADD",
      "protein_substitution": "Protein Substitution",
      "annot-go": "GO",
      "annot-hpo": "HPO"
    };
    this.fixedFilters = ["studies"]; // These are for making the queries to server

    this.facetFields = [];
    this.facetRanges = [];
    this.facetFieldsName = [];
    this.facetRangeFields = [];
    this.results = [];
    this._showInitMessage = true;
    this.facets = new Set();
    this.facetFilters = [];
    this.facetConfig = {
      a: 1
    };
    this.facetActive = true;
    this.query = {};
    this.preparedQuery = {};
    this.selectedFacet = {};
    this.selectedFacetFormatted = {};
    this.errorState = false;
  }

  connectedCallback() {
    super.connectedCallback();
    this._config = opencga_sample_facet_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  firstUpdated(_changedProperties) {}

  getDefaultConfig() {
    return {
      title: "Sample Browser",
      showTitle: true,
      showAggregationStats: true,
      showComparator: true,
      icon: "fas fa-chart-bar",
      filter: {
        sections: [{
          title: "Section title",
          collapsed: false,
          fields: [{
            id: "id",
            name: "Id",
            placeholder: "HG01879, HG01880, HG01881...",
            description: ""
          }, {
            id: "individual",
            name: "Individual",
            placeholder: "LP-1234, LP-4567...",
            description: ""
          }, {
            id: "source",
            name: "Source",
            placeholder: "LP-1234, LP-4567...",
            description: ""
          }, {
            id: "annotations",
            name: "Sample annotations",
            description: ""
          }, {
            id: "phenotypes",
            name: "Phenotypes",
            placeholder: "Full-text search, e.g. melanoma",
            description: ""
          }, {
            id: "somatic",
            name: "Somatic",
            description: ""
          }, {
            id: "date",
            name: "Date",
            description: ""
          }]
        }],
        examples: [{
          name: "Full",
          active: false,
          query: {
            id: "HG",
            individual: "LP",
            source: "LP",
            phenotypes: "melanoma",
            somatic: "True",
            creationDate: ">=20200216"
          }
        }],
        result: {
          grid: {
            pageSize: 10,
            pageList: [10, 25, 50],
            multiSelection: false
          },
          sampleDetail: {
            showTitle: false
          }
        }
      },
      aggregation: {
        default: [],
        result: {
          numColumns: 2
        },
        sections: [{
          name: "Section Title",
          // collapsed: false,
          fields: [{
            id: "study",
            name: "study",
            type: "string",
            description: "Study [[user@]project:]study where study and project can be either the ID or UUID"
          }, {
            id: "source",
            name: "source",
            type: "string",
            description: "Source"
          }, {
            id: "creationYear",
            name: "creationYear",
            type: "string",
            description: "Creation year"
          }, {
            id: "creationMonth",
            name: "creationMonth",
            type: "string",
            description: "Creation month (JANUARY, FEBRUARY...)"
          }, {
            id: "creationDay",
            name: "creationDay",
            type: "string",
            description: "Creation day"
          }, {
            id: "creationDayOfWeek",
            name: "creationDayOfWeek",
            type: "string",
            description: "Creation day of week (MONDAY, TUESDAY...)"
          }, {
            id: "status",
            name: "status",
            type: "string",
            description: "Status"
          }, {
            id: "type",
            name: "type",
            type: "string",
            description: "type"
          }, {
            id: "phenotypes",
            name: "phenotypes",
            type: "string",
            description: "Phenotypes"
          }, {
            id: "release",
            name: "release",
            type: "string",
            description: "Release"
          }, {
            id: "version",
            name: "version",
            type: "string",
            description: "Version"
          }, {
            id: "somatic",
            name: "somatic",
            type: "boolean",
            description: "Somatic"
          }, {
            id: "annotation",
            name: "annotation",
            type: "string",
            description: "Annotation, e.g: key1=value(,key2=value)"
          }, {
            id: "field",
            name: "field",
            type: "string",
            description: "List of fields separated by semicolons, e.g.: studies;type. For nested fields use >>, e.g.: studies>>biotype;type;numSamples[0..10]:1"
          }]
        }]
      },
      // TODO recheck following fields
      annotations: {},
      gridComparator: {
        pageSize: 5,
        pageList: [5, 10],
        multiSelection: true
      },
      variableSetIds: []
    };
  }

  render() {
    return this._config ? lit_html_lit_html_html(opencga_sample_facet_templateObject(), this.opencgaSession, this.opencgaSession.opencgaClient, this.browserSearchQuery, this._config, this.cellbaseClient, this.populationFrequencies, this.proteinSubstitutionScores, this.consequenceTypes) : null;
  }

}
customElements.define("opencga-sample-facet", opencga_sample_facet_OpencgaSampleFacet);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/individual/opencga-individual-facet.js
function opencga_individual_facet_templateObject() {
  const data = opencga_individual_facet_taggedTemplateLiteral(["\n            <opencga-facet  resource=\"individuals\"\n                            .opencgaSession=\"", "\"\n                            .opencgaClient=\"", "\"\n                            .query=\"", "\"\n                            .config=\"", "\"\n                            .cellbaseClient=\"", "\"\n                            .populationFrequencies=\"", "\"\n                            .proteinSubstitutionScores=\"", "\"\n                            .consequenceTypes=\"", "\">\n            </opencga-facet>"]);

  opencga_individual_facet_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_individual_facet_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_individual_facet_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_individual_facet_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_individual_facet_ownKeys(Object(source), true).forEach(function (key) { opencga_individual_facet_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_individual_facet_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_individual_facet_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



class opencga_individual_facet_OpencgaIndividualFacet extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      query: {
        type: Object
      },
      search: {
        type: Object
      },
      config: {
        type: Object
      },
      facetQuery: {
        type: Object
      },
      selectedFacet: {
        type: Object
      },
      resource: {
        type: String
      }
    };
  }

  _init() {
    this._prefix = "facet" + utils.randomString(6);
    this.checkProjects = false;
    this.activeFilterAlias = {
      "annot-xref": "XRef",
      "biotype": "Biotype",
      "annot-ct": "Consequence Types",
      "alternate_frequency": "Population Frequency",
      "annot-functional-score": "CADD",
      "protein_substitution": "Protein Substitution",
      "annot-go": "GO",
      "annot-hpo": "HPO"
    };
    this.fixedFilters = ["studies"]; // These are for making the queries to server

    this.facetFields = [];
    this.facetRanges = [];
    this.facetFieldsName = [];
    this.facetRangeFields = [];
    this.results = [];
    this._showInitMessage = true;
    this.facets = new Set();
    this.facetFilters = [];
    this.facetConfig = {
      a: 1
    };
    this.facetActive = true;
    this.query = {};
    this.preparedQuery = {};
    this.selectedFacet = {};
    this.selectedFacetFormatted = {};
    this.errorState = false;
  }

  connectedCallback() {
    super.connectedCallback();
    this._config = opencga_individual_facet_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  firstUpdated(_changedProperties) {}

  getDefaultConfig() {
    return {
      title: "Individual Browser",
      icon: "fas fa-chart-bar",
      showAggregationStats: true,
      showComparator: true,
      filter: {
        sections: [{
          title: "Section title",
          collapsed: false,
          fields: [{
            id: "id",
            name: "Individual ID",
            type: "string",
            placeholder: "LP-1234,LP-2345...",
            description: ""
          }, {
            id: "samples",
            name: "Sample ID",
            type: "string",
            placeholder: "HG01879, HG01880, HG01881...",
            description: ""
          }, {
            id: "sex",
            name: "Sex",
            allowedValues: ["MALE", "FEMALE", "UNKNOWN", "UNDETERMINED"],
            multiple: true,
            description: ""
          }, {
            id: "karyotypicSex",
            name: "Karyotypic Sex",
            type: "category",
            allowedValues: ["VCF", "BCF", "GVCF", "TBI", "BIGWIG", "SAM", "BAM", "BAI", "CRAM", "CRAI", "FASTQ", "FASTA", "PED", "TAB_SEPARATED_VALUES", "COMMA_SEPARATED_VALUES", "XML", "PROTOCOL_BUFFER", "JSON", "AVRO", "PARQUET", "IMAGE", "PLAIN", "BINARY", "EXECUTABLE", "GZIP", "NONE", "UNKNOWN"],
            multiple: true,
            description: ""
          }, {
            id: "ethnicity",
            name: "Ethnicity",
            type: "string",
            placeholder: "White caucasian,asiatic...",
            description: ""
          }, {
            id: "disorder",
            name: "Disorder",
            placeholder: "Intellectual disability,Arthrogryposis...",
            description: ""
          }, {
            id: "affectationStatus",
            name: "Affectation Status",
            allowedValues: ["CONTROL", "AFFECTED", "UNAFFECTED", "UNKNOWN"],
            multiple: true,
            description: ""
          }, {
            id: "lifeStatus",
            name: "Life Status",
            allowedValues: ["ALIVE", "ABORTED", "DECEASED", "UNBORN", "STILLBORN", "MISCARRIAGE", "UNKNOWN"],
            multiple: true,
            description: ""
          }, {
            id: "phenotypes",
            name: "Phenotypes",
            placeholder: "Full-text search, e.g. *melanoma*",
            description: ""
          }, {
            id: "annotations",
            name: "Individual Annotations",
            description: ""
          }, {
            id: "date",
            name: "Date",
            description: ""
          }]
        }],
        examples: [{
          name: "Full",
          active: false,
          query: {
            id: "LP",
            samples: "HG",
            sex: "FEMALE",
            karyotypicSex: "VCF,BCF,PROTOCOL_BUFFER",
            ethnicity: "asiatic",
            disorder: "british",
            affectationStatus: "AFFECTED",
            lifeStatus: "ALIVE",
            phenotypes: "melanoma",
            creationDate: "20201004"
          }
        }],
        grid: {
          pageSize: 10,
          pageList: [10, 25, 50],
          detailView: true,
          multiSelection: false
        },
        gridComparator: {
          pageSize: 5,
          pageList: [5, 10],
          detailView: true,
          multiSelection: true
        },
        individualDetail: {
          showTitle: false
        }
      },
      aggregation: {
        default: ["type", "format", "bioformat"],
        result: {
          numColumns: 2
        },
        sections: [{
          name: "section title",
          fields: [{
            id: "study",
            name: "study",
            type: "string",
            description: "Study [[user@]project:]study where study and project can be either the ID or UUID"
          }, {
            id: "source",
            name: "source",
            type: "string",
            description: "Source"
          }, {
            id: "creationYear",
            name: "creationYear",
            type: "string",
            description: "Creation year"
          }, {
            id: "creationMonth",
            name: "creationMonth",
            type: "string",
            description: "Creation month (JANUARY, FEBRUARY...)"
          }, {
            id: "creationDay",
            name: "creationDay",
            type: "string",
            description: "Creation day"
          }, {
            id: "creationDayOfWeek",
            name: "creationDayOfWeek",
            type: "string",
            description: "Creation day of week (MONDAY, TUESDAY...)"
          }, {
            id: "status",
            name: "status",
            type: "string",
            description: "Status"
          }, {
            id: "type",
            name: "type",
            type: "string",
            description: "type"
          }, {
            id: "phenotypes",
            name: "phenotypes",
            type: "string",
            description: "Phenotypes"
          }, {
            id: "release",
            name: "release",
            type: "string",
            description: "Release"
          }, {
            id: "version",
            name: "version",
            type: "string",
            description: "Version"
          }, {
            id: "somatic",
            name: "somatic",
            type: "category",
            allowedValues: ["true", "false"],
            multiple: false,
            defaultValue: "false",
            description: "Somatic"
          }, {
            id: "annotation",
            name: "annotation",
            type: "string",
            description: "Annotation, e.g: key1=value(,key2=value)"
          }, {
            id: "field",
            name: "field",
            type: "string",
            description: "List of fields separated by semicolons, e.g.: studies;type. For nested fields use >>, e.g.: studies>>biotype;type;numSamples[0..10]:1"
          }]
        }]
      },
      annotations: {},
      //TODO recheck
      variableSetIds: []
    };
  }

  render() {
    return this._config ? lit_html_lit_html_html(opencga_individual_facet_templateObject(), this.opencgaSession, this.opencgaSession.opencgaClient, this.browserSearchQuery, this._config, this.cellbaseClient, this.populationFrequencies, this.proteinSubstitutionScores, this.consequenceTypes) : null;
  }

}
customElements.define("opencga-individual-facet", opencga_individual_facet_OpencgaIndividualFacet);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/family/opencga-family-facet.js
function opencga_family_facet_templateObject() {
  const data = opencga_family_facet_taggedTemplateLiteral(["\n            <opencga-facet  resource=\"family\"\n                            .opencgaSession=\"", "\"\n                            .opencgaClient=\"", "\"\n                            .query=\"", "\"\n                            .config=\"", "\"\n                            .cellbaseClient=\"", "\"\n                            .populationFrequencies=\"", "\"\n                            .proteinSubstitutionScores=\"", "\"\n                            .consequenceTypes=\"", "\">\n            </opencga-facet>"]);

  opencga_family_facet_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_family_facet_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_family_facet_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_family_facet_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_family_facet_ownKeys(Object(source), true).forEach(function (key) { opencga_family_facet_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_family_facet_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_family_facet_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



class opencga_family_facet_OpencgaFamilyFacet extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      query: {
        type: Object
      },
      search: {
        type: Object
      },
      config: {
        type: Object
      },
      facetQuery: {
        type: Object
      },
      selectedFacet: {
        type: Object
      },
      resource: {
        type: String
      }
    };
  }

  _init() {
    this._prefix = "facet" + utils.randomString(6);
    this.checkProjects = false;
    this.activeFilterAlias = {
      "annot-xref": "XRef",
      "biotype": "Biotype",
      "annot-ct": "Consequence Types",
      "alternate_frequency": "Population Frequency",
      "annot-functional-score": "CADD",
      "protein_substitution": "Protein Substitution",
      "annot-go": "GO",
      "annot-hpo": "HPO"
    };
    this.fixedFilters = ["studies"]; // These are for making the queries to server

    this.facetFields = [];
    this.facetRanges = [];
    this.facetFieldsName = [];
    this.facetRangeFields = [];
    this.results = [];
    this._showInitMessage = true;
    this.facets = new Set();
    this.facetFilters = [];
    this.facetConfig = {
      a: 1
    };
    this.facetActive = true;
    this.query = {};
    this.preparedQuery = {};
    this.selectedFacet = {};
    this.selectedFacetFormatted = {};
    this.errorState = false;
  }

  connectedCallback() {
    super.connectedCallback();
    this._config = opencga_family_facet_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  firstUpdated(_changedProperties) {}

  getDefaultConfig() {
    return {
      title: "Family Browser",
      icon: "fas fa-chart-bar",
      showTitle: true,
      showAggregationStats: true,
      showComparator: true,
      filter: {
        sections: [{
          title: "Section title",
          collapsed: false,
          fields: [{
            id: "id",
            name: "Family ID",
            type: "string",
            placeholder: "LP-1234,LP-2345...",
            description: ""
          }, {
            id: "members",
            name: "Members",
            type: "string",
            placeholder: "HG01879, HG01880, HG01881...",
            description: ""
          }, {
            id: "phenotypes",
            name: "Phenotypes",
            placeholder: "Full-text search, e.g. *melanoma*",
            description: ""
          }, {
            id: "annotations",
            name: "Family Annotations",
            description: ""
          }, {
            id: "date",
            name: "Date",
            description: ""
          }]
        }],
        examples: [{
          name: "Full",
          query: {
            id: "lp",
            members: "hg",
            phenotypes: "melanoma",
            creationDate: "2020"
          }
        }],
        activeFilters: {
          complexFields: ["annotation"]
        },
        grid: {
          pageSize: 10,
          pageList: [10, 25, 50],
          detailView: true,
          multiSelection: false
        },
        familyDetail: {
          showTitle: false
        }
      },
      aggregation: {
        default: ["study"],
        result: {
          numColumns: 2
        },
        sections: [{
          name: "section title",
          fields: [{
            id: "study",
            name: "study",
            type: "string",
            description: "Study [[user@]project:]study where study and project can be either the ID or UUID"
          }, {
            id: "creationYear",
            name: "creationYear",
            type: "string",
            description: "Creation year"
          }, {
            id: "creationMonth",
            name: "creationMonth",
            type: "string",
            description: "Creation month (JANUARY, FEBRUARY...)"
          }, {
            id: "creationDay",
            name: "creationDay",
            type: "string",
            description: "Creation day"
          }, {
            id: "creationDayOfWeek",
            name: "creationDayOfWeek",
            type: "string",
            description: "Creation day of week (MONDAY, TUESDAY...)"
          }, {
            id: "status",
            name: "status",
            type: "string",
            description: "Status"
          }, {
            id: "phenotypes",
            name: "phenotypes",
            type: "string",
            description: "Phenotypes"
          }, {
            id: "release",
            name: "release",
            type: "string",
            description: "Release"
          }, {
            id: "version",
            name: "version",
            type: "string",
            description: "Version"
          }, {
            id: "numMembers",
            name: "numMembers",
            type: "string",
            description: "Number of members"
          }, {
            id: "expectedSize",
            name: "expectedSize",
            type: "string",
            description: "Expected size"
          }, {
            id: "annotation",
            name: "annotation",
            type: "string",
            description: "Annotation, e.g: key1=value(,key2=value)"
          }, {
            id: "field",
            name: "field",
            type: "string",
            description: "List of fields separated by semicolons, e.g.: studies;type. For nested fields use >>, e.g.: studies>>biotype;type;numSamples[0..10]:1"
          }]
        }]
      },
      annotations: {},
      // TODO recheck
      variableSetIds: [],
      gridComparator: {
        pageSize: 5,
        pageList: [5, 10],
        detailView: true,
        multiSelection: true
      }
    };
  }

  render() {
    return this._config ? lit_html_lit_html_html(opencga_family_facet_templateObject(), this.opencgaSession, this.opencgaSession.opencgaClient, this.browserSearchQuery, this._config, this.cellbaseClient, this.populationFrequencies, this.proteinSubstitutionScores, this.consequenceTypes) : null;
  }

}
customElements.define("opencga-family-facet", opencga_family_facet_OpencgaFamilyFacet);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/cohorts/opencga-cohort-facet.js
function opencga_cohort_facet_templateObject() {
  const data = opencga_cohort_facet_taggedTemplateLiteral(["\n            <opencga-facet  resource=\"cohort\"\n                            .opencgaSession=\"", "\"\n                            .opencgaClient=\"", "\"\n                            .query=\"", "\"\n                            .config=\"", "\"\n                            .cellbaseClient=\"", "\"\n                            .populationFrequencies=\"", "\"\n                            .proteinSubstitutionScores=\"", "\"\n                            .consequenceTypes=\"", "\">\n            </opencga-facet>"]);

  opencga_cohort_facet_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_cohort_facet_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_cohort_facet_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_cohort_facet_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_cohort_facet_ownKeys(Object(source), true).forEach(function (key) { opencga_cohort_facet_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_cohort_facet_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_cohort_facet_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



class opencga_cohort_facet_OpencgaCohortFacet extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      query: {
        type: Object
      },
      search: {
        type: Object
      },
      config: {
        type: Object
      },
      facetQuery: {
        type: Object
      },
      selectedFacet: {
        type: Object
      },
      resource: {
        type: String
      }
    };
  }

  _init() {
    this._prefix = "facet" + utils.randomString(6);
    this.checkProjects = false;
    this.activeFilterAlias = {
      "annot-xref": "XRef",
      "biotype": "Biotype",
      "annot-ct": "Consequence Types",
      "alternate_frequency": "Population Frequency",
      "annot-functional-score": "CADD",
      "protein_substitution": "Protein Substitution",
      "annot-go": "GO",
      "annot-hpo": "HPO"
    };
    this.fixedFilters = ["studies"]; // These are for making the queries to server

    this.facetFields = [];
    this.facetRanges = [];
    this.facetFieldsName = [];
    this.facetRangeFields = [];
    this.results = [];
    this._showInitMessage = true;
    this.facets = new Set();
    this.facetFilters = [];
    this.facetConfig = {
      a: 1
    };
    this.facetActive = true;
    this.query = {};
    this.preparedQuery = {};
    this.selectedFacet = {};
    this.selectedFacetFormatted = {};
    this.errorState = false;
  }

  connectedCallback() {
    super.connectedCallback();
    this._config = opencga_cohort_facet_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  firstUpdated(_changedProperties) {}

  getDefaultConfig() {
    return {
      title: "Cohort Browser",
      icon: "fas fa-chart-bar",
      showComparator: true,
      filter: {
        sections: [{
          title: "Section title",
          collapsed: false,
          fields: [{
            id: "id",
            name: "ID",
            type: "string",
            placeholder: "LP-1234,LP-2345...",
            description: ""
          }, {
            id: "samples",
            name: "Samples",
            type: "string",
            placeholder: "HG01879, HG01880, HG01881...",
            description: ""
          }, {
            id: "annotations",
            name: "Cohort annotations",
            placeholder: "Full-text search, e.g. *melanoma*",
            description: ""
          }, {
            id: "type",
            name: "Type",
            multiple: true,
            allowedValues: ["All", "CASE_CONTROL", "CASE_SET", "CONTROL_SET", "PAIRED", "PAIRED_TUMOR", "AGGREGATE", "TIME_SERIES", "FAMILY", "TRIO"],
            description: ""
          }, {
            id: "date",
            name: "Date",
            description: ""
          }]
        }],
        examples: [{
          name: "Full",
          query: {
            annotation: "Pedigree:versionControl.GitVersionControl=git",
            type: "TIME_SERIES,FAMILY",
            id: "lp",
            samples: "hg"
          }
        }],
        grid: {}
      },
      aggregation: {
        default: ["name"],
        result: {
          numColumns: 2
        },
        sections: [{
          name: "section title",
          fields: [{
            id: "study",
            name: "study",
            type: "string",
            description: "Study [[user@]project:]study where study and project can be either the ID or UUID"
          }, {
            id: "type",
            name: "type",
            type: "string",
            description: "type"
          }, {
            id: "creationYear",
            name: "creationYear",
            type: "string",
            description: "Creation year"
          }, {
            id: "creationMonth",
            name: "creationMonth",
            type: "string",
            description: "Creation month (JANUARY, FEBRUARY...)"
          }, {
            id: "creationDay",
            name: "creationDay",
            type: "string",
            description: "Creation day"
          }, {
            id: "creationDayOfWeek",
            name: "creationDayOfWeek",
            type: "string",
            description: "Creation day of week (MONDAY, TUESDAY...)"
          }, {
            id: "numSamples",
            name: "numSamples",
            type: "string",
            description: "Number of samples"
          }, {
            id: "status",
            name: "status",
            type: "string",
            description: "Status"
          }, {
            id: "release",
            name: "release",
            type: "string",
            description: "Release"
          }, {
            id: "annotation",
            name: "annotation",
            type: "string",
            description: "Annotation, e.g: key1=value(,key2=value)"
          }, {
            id: "field",
            name: "field",
            type: "string",
            description: "List of fields separated by semicolons, e.g.: studies;type. For nested fields use >>, e.g.: studies>>biotype;type;numSamples[0..10]:1"
          }]
        }]
      },
      // TODO recheck
      gridComparator: {
        multiSelection: true,
        pageSize: 5,
        pageList: [5, 10]
      },
      variableSetIds: []
    };
  }

  render() {
    return this._config ? lit_html_lit_html_html(opencga_cohort_facet_templateObject(), this.opencgaSession, this.opencgaSession.opencgaClient, this.browserSearchQuery, this._config, this.cellbaseClient, this.populationFrequencies, this.proteinSubstitutionScores, this.consequenceTypes) : null;
  }

}
customElements.define("opencga-cohort-facet", opencga_cohort_facet_OpencgaCohortFacet);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/catalog/jobs/opencga-jobs-facet.js
function opencga_jobs_facet_templateObject() {
  const data = opencga_jobs_facet_taggedTemplateLiteral(["\n            <opencga-facet  resource=\"jobs\"\n                            .opencgaSession=\"", "\"\n                            .query=\"", "\"\n                            .config=\"", "\">\n            </opencga-facet>"]);

  opencga_jobs_facet_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_jobs_facet_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_jobs_facet_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_jobs_facet_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_jobs_facet_ownKeys(Object(source), true).forEach(function (key) { opencga_jobs_facet_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_jobs_facet_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_jobs_facet_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


 // TODO this component will be the new opencga-file-browser and this configuration will be for browser and facet both

class opencga_jobs_facet_OpencgaJobsFacet extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      query: {
        type: Object
      },
      search: {
        type: Object
      },
      config: {
        type: Object
      },
      facetQuery: {
        type: Object
      },
      selectedFacet: {
        type: Object
      },
      resource: {
        type: String
      }
    };
  }

  _init() {
    this._prefix = "facet" + utils.randomString(6);
    this.checkProjects = false;
    this.activeFilterAlias = {
      "annot-xref": "XRef",
      "biotype": "Biotype",
      "annot-ct": "Consequence Types",
      "alternate_frequency": "Population Frequency",
      "annot-functional-score": "CADD",
      "protein_substitution": "Protein Substitution",
      "annot-go": "GO",
      "annot-hpo": "HPO"
    };
    this.fixedFilters = ["studies"]; // These are for making the queries to server

    this.facetFields = [];
    this.facetRanges = [];
    this.facetFieldsName = [];
    this.facetRangeFields = [];
    this.results = [];
    this._showInitMessage = true;
    this.facets = new Set();
    this.facetFilters = [];
    this.facetConfig = {
      a: 1
    };
    this.facetActive = true;
    this.query = {};
    this.preparedQuery = {};
    this.selectedFacet = {};
    this.selectedFacetFormatted = {};
    this.errorState = false;
  }

  connectedCallback() {
    super.connectedCallback();
    this._config = opencga_jobs_facet_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  getDefaultConfig() {
    return {
      title: "Jobs Browser",
      //active: false,
      icon: "fas fa-chart-bar",
      description: "",
      searchButtonText: "Run",
      filter: {
        sections: [{
          title: "Section title",
          collapsed: false,
          fields: [{
            id: "name",
            name: "Name",
            type: "string",
            placeholder: "accepted_hits.bam, phenotypes.vcf...",
            description: ""
          }, {
            id: "path",
            name: "Path",
            type: "string",
            placeholder: "genomes/resources/files/...",
            description: ""
          }, {
            id: "sample",
            name: "Sample",
            type: "string",
            placeholder: "HG01879, HG01880, HG01881...",
            description: ""
          }, {
            id: "format",
            name: "Format",
            type: "category",
            allowedValues: ["VCF", "BCF", "GVCF", "TBI", "BIGWIG", "SAM", "BAM", "BAI", "CRAM", "CRAI", "FASTQ", "FASTA", "PED", "TAB_SEPARATED_VALUES", "COMMA_SEPARATED_VALUES", "XML", "PROTOCOL_BUFFER", "JSON", "AVRO", "PARQUET", "IMAGE", "PLAIN", "BINARY", "EXECUTABLE", "GZIP", "NONE", "UNKNOWN"],
            placeholder: "genomes/resources/files/...",
            description: ""
          }, {
            id: "bioformat",
            name: "Bioformat",
            type: "string",
            placeholder: "ALIGNMENT,VARIANT...",
            description: ""
          }, {
            id: "annotations",
            name: "File annotations",
            description: ""
          }, {
            id: "date",
            name: "Date",
            type: "date",
            description: ""
          }]
        }],
        examples: [{
          name: "Full",
          active: false,
          query: {
            name: "bam",
            path: "genomes",
            sample: "hg3333",
            format: "VCF,BCF,GVCF,BIGWIG",
            bioformat: "ALIGNMENT",
            creationDate: ">=20200216"
          }
        }],
        result: {
          grid: {}
        },
        detail: []
      },
      aggregation: {
        default: ["type", "study>>bioformat"],
        result: {
          numColumns: 2
        },
        sections: [{
          name: "Section Title",
          // collapsed: false,
          fields: [
            /*{
                id: "study",
                name: "study",
                type: "string",
                description: "Study [[user@]project:]study where study and project can be either the ID or UUID"
            },
            {
                id: "name",
                name: "name",
                type: "string",
                description: "Name"
            },
            {
                id: "type",
                name: "type",
                type: "string",
                description: "Type"
            },
            {
                id: "format",
                name: "format",
                type: "string",
                description: "Format"
            },
            {
                id: "bioformat",
                name: "bioformat",
                type: "string",
                description: "Bioformat"
            },
            {
                id: "creationYear",
                name: "creationYear",
                type: "string",
                description: "Creation year"
            },
            {
                id: "creationMonth",
                name: "creationMonth",
                type: "string",
                description: "Creation month (JANUARY, FEBRUARY...)"
            },
            {
                id: "creationDay",
                name: "creationDay",
                type: "string",
                description: "Creation day"
            },
            {
                id: "creationDayOfWeek",
                name: "creationDayOfWeek",
                type: "string",
                description: "Creation day of week (MONDAY, TUESDAY...)"
            },
            {
                id: "status",
                name: "status",
                type: "string",
                description: "Status"
            },
            {
                id: "release",
                name: "release",
                type: "string",
                description: "Release"
            },
            {
                id: "external",
                name: "external",
                type: "category",
                allowedValues: ["true", "false"],
                defaultValue: "false",
                description: "External"
            },
            {
                id: "size",
                name: "size",
                type: "string",
                description: "Size"
            },
            {
                id: "software",
                name: "software",
                type: "string",
                description: "Software"
            },
            {
                id: "experiment",
                name: "experiment",
                type: "string",
                description: "Experiment"
            },
            {
                id: "numSamples",
                name: "numSamples",
                type: "string",
                description: "Number of samples"
            },
            {
                id: "numRelatedFiles",
                name: "numRelatedFiles",
                type: "string",
                description: "Number of related files"
            },
            {
                id: "annotation",
                name: "annotation",
                type: "string",
                description: "Annotation, e.g: key1=value(,key2=value)"
            },
            {
                id: "field",
                name: "field",
                type: "string",
                description: "List of fields separated by semicolons, e.g.: studies;type. For nested fields use >>, e.g.: studies>>biotype;type;numSamples[0..10]:1"
            }*/
          ]
        }]
      }
    };
  }

  render() {
    return this._config ? lit_html_lit_html_html(opencga_jobs_facet_templateObject(), this.opencgaSession, this.query, this._config) : null;
  }

}
customElements.define("opencga-jobs-facet", opencga_jobs_facet_OpencgaJobsFacet);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/analysis/opencga-analysis-tool-form-field.js
function opencga_analysis_tool_form_field_templateObject7() {
  const data = opencga_analysis_tool_form_field_taggedTemplateLiteral(["\n            <div class=\"", "\">\n                ", "\n                <div id=\"", "-wrapper\">\n                    ", "\n                </div>\n            </div>\n        "]);

  opencga_analysis_tool_form_field_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_analysis_tool_form_field_templateObject6() {
  const data = opencga_analysis_tool_form_field_taggedTemplateLiteral(["<text-field-filter placeholder=\"", "\" ?disabled=", " ?required=", " .value=\"", "\" @filterChange=\"", "\"></text-field-filter>"]);

  opencga_analysis_tool_form_field_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_analysis_tool_form_field_templateObject5() {
  const data = opencga_analysis_tool_form_field_taggedTemplateLiteral(["<sample-filter ?enabled=\"", "\" .opencgaSession=\"", "\" .clinicalAnalysis=\"", "\" .query=\"", "\" @sampleFilterChange=\"", "\"></sample-filter>"]);

  opencga_analysis_tool_form_field_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_analysis_tool_form_field_templateObject4() {
  const data = opencga_analysis_tool_form_field_taggedTemplateLiteral(["<cohort-filter .opencgaSession=\"", "\" .cohorts=\"", "\" ._cohorts=\"", "\" .cohortStatsAlt=\"", "\" @filterChange=\"", "\"> </cohort-filter>"]);

  opencga_analysis_tool_form_field_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_analysis_tool_form_field_templateObject3() {
  const data = opencga_analysis_tool_form_field_taggedTemplateLiteral(["<div id=\"", "-wrapper\" class=\"subsection-content form-group\">\n                                <input type=\"number\" min=", " max=", " step=\"0.01\" .disabled=", " ?required=", " value=\"", "\" id=\"", "-input-", "\" class=\"input form-control input-sm ", "FilterTextInput\" placeholder=\"", "\" @input=\"", "\">\n                            </div>"]);

  opencga_analysis_tool_form_field_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_analysis_tool_form_field_templateObject2() {
  const data = opencga_analysis_tool_form_field_taggedTemplateLiteral(["<text-field-filter placeholder=\"", "\" ?disabled=", " ?required=", " .value=\"", "\" @filterChange=\"", "\"></text-field-filter>"]);

  opencga_analysis_tool_form_field_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_analysis_tool_form_field_templateObject() {
  const data = opencga_analysis_tool_form_field_taggedTemplateLiteral(["<select-field-filter id=\"", "\" ?multiple=\"", "\" ?disabled=", " ?required=", " .data=\"", "\" .value=\"", "\" maxOptions=\"2\" @filterChange=\"", "\"></select-field-filter>"]);

  opencga_analysis_tool_form_field_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_analysis_tool_form_field_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */





class opencga_analysis_tool_form_field_OpencgaAnalysisToolFormField extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "oatff-" + utils.randomString(6) + "_";
  }

  connectedCallback() {
    super.connectedCallback();
  }

  fieldChange(fieldId, value) {
    //console.log("fieldId, value", fieldId, value)
    this.dispatchEvent(new CustomEvent("fieldChange", {
      detail: {
        [fieldId]: value
      },
      bubbles: true,
      composed: true
    }));
  }

  renderField(field) {
    // console.log(field)
    switch (field.type) {
      case "category":
        return lit_html_lit_html_html(opencga_analysis_tool_form_field_templateObject(), field.id, field.multiple, this.config.disabled, this.config.required, field.allowedValues, field.defaultValue, e => this.fieldChange(field.id, e.detail.value));

      case "string":
        return lit_html_lit_html_html(opencga_analysis_tool_form_field_templateObject2(), field.placeholder || "", this.config.disabled, this.config.required, field.defaultValue || "", e => this.fieldChange(field.id, e.detail.value));

      case "number":
        const [min = "", max = ""] = field.allowedValues || [];
        return lit_html_lit_html_html(opencga_analysis_tool_form_field_templateObject3(), this._prefix, min, max, this.config.disabled, this.config.required, field.defaultValue || "", this._prefix, field.id, this._prefix, field.placeholder || "", e => this.fieldChange(field.id, e.target.value));

      case "COHORT_FILTER":
        return lit_html_lit_html_html(opencga_analysis_tool_form_field_templateObject4(), this.opencgaSession, {
          "reference_grch37": {
            "1kG_phase3": [{
              "id": "ALL",
              "name": "All"
            }, {
              "id": "MXL",
              "name": "Mexican"
            }],
            "EXAC": [{
              "id": "ALL",
              "name": "All"
            }]
          },
          "GRCH37": {
            "platinum": [{
              "id": "ALL",
              "name": "ALL"
            }]
          },
          "exomes_grch37": {
            "corpasome": [{
              "id": "ALL",
              "name": "ALL"
            }]
          }
        }, {
          "corpasome": [{
            "id": "ALL",
            "name": "ALL"
          }]
        }, [], e => this.fieldChange("cohort", e.detail.value));

      case "SAMPLE-FILTER":
        return lit_html_lit_html_html(opencga_analysis_tool_form_field_templateObject5(), true, this.opencgaSession, this.clinicalAnalysis, this.query, e => this.fieldChange(e.detail.value));

      default:
        console.warn("field type " + field.type + " not implemented. String type fallback");
        return lit_html_lit_html_html(opencga_analysis_tool_form_field_templateObject6(), field.placeholder || "", this.config.disabled, this.config.required, field.defaultValue || "", e => this.fieldChange(field.id, e.detail.value));
    }
  }

  render() {
    return lit_html_lit_html_html(opencga_analysis_tool_form_field_templateObject7(), this.config.colspan ? "col-md-" + this.config.colspan : "col-md-12", this.config.title || this.config.id, this.config.id, this.renderField(this.config));
  }

}
customElements.define("opencga-analysis-tool-form-field", opencga_analysis_tool_form_field_OpencgaAnalysisToolFormField);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/analysis/opencga-analysis-tool-form.js
function opencga_analysis_tool_form_templateObject3() {
  const data = opencga_analysis_tool_form_taggedTemplateLiteral(["\n                                        <opencga-analysis-tool-form-field .opencgaSession=\"", "\" .config=\"", "\" @fieldChange=\"", "\"> </opencga-analysis-tool-form-field>\n                                    "]);

  opencga_analysis_tool_form_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_analysis_tool_form_templateObject2() {
  const data = opencga_analysis_tool_form_taggedTemplateLiteral(["\n                     <div class=\"panel panel-default filter-section shadow-sm\">\n                         <div class=\"panel-heading\" role=\"tab\" id=\"", "Heading", "\">\n                             <h4 class=\"panel-title\">\n                                 <a class=\"collapsed\" role=\"button\" data-toggle=\"collapse\" data-parent=\"#", "Accordion\"\n                                    href=\"#", "section-", "\" aria-expanded=\"true\" aria-controls=\"", "-", "\">\n                                    ", "\n                                 </a>\n                             </h4>\n                         </div>\n                         <div id=\"", "section-", "\" class=\"panel-collapse ", "\" role=\"tabpanel\" aria-labelledby=\"", "", "Heading\">\n                             <div class=\"panel-body\">\n                                <div class=\"row\">\n                                    ", "\n                             </div>\n                             </div>\n                        </div>\n                    </div>\n                "]);

  opencga_analysis_tool_form_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_analysis_tool_form_templateObject() {
  const data = opencga_analysis_tool_form_taggedTemplateLiteral(["\n            <div class=\"panel-group\">\n            <!--<pre style=\"font-size: 10px;height: 25vh;\">\n            ", "\n            </pre> -->\n                <form id=\"analysis-form\" data-toggle=\"validator\" data-feedback='{\"success\": \"fa-check\", \"error\": \"fa-times\"}' role=\"form\">\n                ", "\n                <button type=\"submit\" class=\"ripple btn btn-primary btn-lg\" @click=\"", "\">Run</button>\n                </form>\n           </div>\n        "]);

  opencga_analysis_tool_form_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_analysis_tool_form_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/*
 * Copyright 2015-2016 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
// import {LitElement, html} from "/test/lit-element.js";
// import {Utils} from "./../../../utils.js"; //this cannot be a plain script and a module at the same time



class opencga_analysis_tool_form_OpencgaAnalysisToolForm extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "oatf-";
    this._config = {};
  }

  connectedCallback() {
    super.connectedCallback(); // deep copy

    this._config = $.extend(true, {}, this.config); // this should be executed on change of each field (or better just on actuator param change)

    if (this._config.sections && this._config.sections.length) {
      this._config.sections.forEach(section => {
        if (section.parameters && section.parameters.length) {
          section.parameters.forEach(param => {
            param.value = param.defaultValue; // TODO change defaultValue to value in config?

            if (param.dependsOn) {
              // since we use this._config as unique source of truth we can imagine to change any other prop here (like allowedValues)
              param.disabled = !this.checkDependency(param.dependsOn);
            } else {
              param.disabled = false;
            }
          });
        }
      });
    }
  }

  updated(changedProperties) {}

  checkDependency(dependsOn) {
    if (typeof dependsOn === "string") {
      const [actuatorId, operator, value] = dependsOn.split(/  *(!*==?|===?)  */); // draft

      const actuator = this.findParam(this._config, actuatorId);
      return this._operatorExec(actuator.value, value, operator);
    } else if (typeof dependsOn === "function") {
      return dependsOn(this._config);
    } else {
      console.error("Rule not found. Stop messing up with the configuration please.");
    }
  }

  _operatorExec(a, b, operator) {
    if (operator === "==" || operator === "===") {
      return a === b;
    } else if (operator === "!=" || operator === "!==") {
      return a !== b;
    } else {
      throw new Error("Operator not found");
    }
  }

  findParam(config, paramId) {
    for (const section of config.sections) {
      if (section.parameters && section.parameters.length) {
        for (const param of section.parameters) {
          if (param.id === paramId) {
            return param;
          }
        }
      }
    }

    console.error(paramId, "not found");
    return null;
  } // DOM manipulation version

  /*    checkDependency2(parent, field) {
      console.log("parent, field", parent, field);
      console.log("dependsOn", field.dependsOn);
      if (field.dependsOn) {
          const [fieldId, value] = field.dependsOn.split(/  *===?  *!/); // draft
          console.log(fieldId, value);
          if (!fieldId || !value) {
              console.error("dependsOn parse failed");
          } else {
              console.log("selector", parent.querySelector("#" + fieldId));
               if (parent.querySelector("#" + fieldId).value === value) {
                  console.log("value OK", parent.querySelector("#" + fieldId).value);
              }
              this.visible = parent.querySelector("#" + fieldId).value === value;
          }
      }
      this.requestUpdate();
   }*/
  // this method is in charge of update this._config with new value of "actuator" and update "target" visible prop


  onFieldChange(e) {
    console.log(e.detail);

    if (e.detail) {
      const [paramId, value] = Object.entries(e.detail)[0];
      const param = this.findParam(this._config, paramId);
      param.value = value;

      if (this._config.sections && this._config.sections.length) {
        this._config.sections.forEach(section => {
          if (section.parameters && section.parameters.length) {
            section.parameters.forEach(param => {
              if (param.dependsOn) {
                param.disabled = !this.checkDependency(param.dependsOn);
              }
            });
          }
        });
      }

      this._config.sections = $.extend(true, [], this._config.sections); // god save the queen

      this.requestUpdate();
    }
  }

  onRun() {
    $('#analysis-form').validator().on('submit', e => {
      if (e.isDefaultPrevented()) {// handle the invalid form...
      } else {
        // everything looks good!
        const params = this._config.sections.reduce((acc, curr) => [...acc, ...curr.parameters], []);

        console.log(params);
      }
    });
  }

  render() {
    return lit_html_lit_html_html(opencga_analysis_tool_form_templateObject(), JSON.stringify(this._config.sections, null, "\t"), this._config.sections && this._config.sections.length ? this._config.sections.map((section, i) => lit_html_lit_html_html(opencga_analysis_tool_form_templateObject2(), this._prefix, i, this._prefix, this._prefix, i, this._prefix, i, section.title, this._prefix, i, !section.collapsed ? "in" : "", this._prefix, i, section.parameters && section.parameters.length ? section.parameters.map(param => lit_html_lit_html_html(opencga_analysis_tool_form_templateObject3(), this.opencgaSession, param, this.onFieldChange)) : null)) : null, this.onRun);
  }

}
customElements.define("opencga-analysis-tool-form", opencga_analysis_tool_form_OpencgaAnalysisToolForm);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/commons/analysis/opencga-analysis-tool.js
function opencga_analysis_tool_templateObject() {
  const data = opencga_analysis_tool_taggedTemplateLiteral(["\n            <div class=\"container\">\n                <h2>", "</h2>\n                <opencga-analysis-tool-form .opencgaSession=", " .config=\"", "\"></opencga-analysis-tool-form>\n            </div>\n            \n        "]);

  opencga_analysis_tool_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_analysis_tool_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/*
 * Copyright 2015-2016 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

 // import {Utils} from "./../../../utils.js"; //this cannot be a plain script and a module at the same time


class opencga_analysis_tool_OpencgaAnalysisTool extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    // this._prefix = "oat-" + Utils.randomString(6);
    this._prefix = "oat-";
  }

  updated(changedProperties) {}

  render() {
    return this.config ? lit_html_lit_html_html(opencga_analysis_tool_templateObject(), this.config.title, this.opencgaSession, this.config.form) : null;
  }

}
customElements.define("opencga-analysis-tool", opencga_analysis_tool_OpencgaAnalysisTool);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/analysis/opencga-gwas-analysis.js
function opencga_gwas_analysis_templateObject() {
  const data = opencga_gwas_analysis_taggedTemplateLiteral(["\n           <opencga-analysis-tool .opencgaSession=\"", "\" .config=\"", "\" ></opencga-analysis-tool>\n        "]);

  opencga_gwas_analysis_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_gwas_analysis_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_gwas_analysis_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_gwas_analysis_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_gwas_analysis_ownKeys(Object(source), true).forEach(function (key) { opencga_gwas_analysis_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_gwas_analysis_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_gwas_analysis_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/*
 * Copyright 2015-2016 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



class opencga_gwas_analysis_OpencgaGwasAnalysis extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "oga-" + utils.randomString(6);
  }

  connectedCallback() {
    super.connectedCallback();
    this._config = opencga_gwas_analysis_objectSpread({}, this.getDefaultConfig(), {}, this.config);
    this.fieldMap = {};
  }

  updated(changedProperties) {
    if (changedProperties.has("config")) {//this._config = Object.assign(this.getDefaultConfig(), this.config);
    }
  }

  getDefaultConfig() {
    return {
      id: "test1",
      title: "Test 1",
      icon: "",
      requires: "2.0.0",
      description: "Test1 description",
      links: [{
        title: "Wikipedia",
        url: "",
        icon: ""
      }],
      form: {
        sections: [{
          title: "Input Parameters",
          collapsed: false,
          parameters: [{
            id: "sample",
            title: "Select samples",
            type: "SAMPLE_FILTER",
            colspan: 6
          }, {
            id: "cohort",
            title: "Select cohort",
            type: "COHORT_FILTER",
            colspan: 6
          }]
        }, {
          title: "Configuration Parameters",
          collapsed: false,
          parameters: [{
            id: "assoc",
            title: "Select association test",
            type: "category",
            required: true,
            defaultValue: "Fisher",
            allowedValues: ["Fisher", "Chi", "LR"],
            multiple: false,
            colspan: 6 //maxOptions: 1 //you don't need to define maxOptions if multiple=false

          }, {
            id: "fisher-test",
            title: "Select Fisher mode",
            type: "category",
            defaultValue: "GT",
            allowedValues: ["GT", "LT"],
            multiple: false,
            colspan: 6,
            dependsOn: "assoc == Fisher"
          }, {
            id: "freq",
            title: "Filter by frequency",
            type: "number",
            required: true,
            defaultValue: "0.01",
            allowedValues: [0, 1],
            colspan: 6
          }, {
            id: "gene",
            title: "Filter by Genes",
            type: "string",
            required: true,
            defaultValue: "default String",
            colspan: 6,
            dependsOn: config => {
              console.warn("dependsOn Callback", config);
              return true;
            }
          }]
        }],
        run: {
          title: "Job Info",
          job: {
            id: "$ID-$DATE-$RANDOM",
            tags: "",
            description: ""
          },
          execute: {
            validation: function validation(params) {
              alert("test:" + params);
            },
            button: "Run"
          }
        }
      },
      result: {}
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_gwas_analysis_templateObject(), this.opencgaSession, this._config);
  }

}
customElements.define("opencga-gwas-analysis", opencga_gwas_analysis_OpencgaGwasAnalysis);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/opencga-interpretation-variant-review.js
function opencga_interpretation_variant_review_templateObject() {
  const data = opencga_interpretation_variant_review_taggedTemplateLiteral(["\n        <style include=\"jso-styles\"></style>\n\n        <span>", "</span>\n        <div class=\"form-horizontal\" data-toggle=\"validator\" role=\"form\">\n\n            <div class=\"form-group\">\n                <label class=\"control-label col-md-1 jso-label-title\">Interpretation ID</label>\n                <div class=\"col-md-3\">\n                    <input type=\"text\" id=\"", "IDInterpretation\" class=\"", "TextInput form-control\"\n                           placeholder=\"ID of the interpretation\" data-field=\"id\" @input=\"", "\"\n                           value=\"", "\">\n                </div>\n            </div>\n\n            <div class=\"form-group\">\n                <label class=\"control-label col-md-1 jso-label-title\">Comment</label>\n                <div class=\"col-md-3\">\n                    <input type=\"text\" id=\"", "CommentInterpretation\" class=\"", "TextInput form-control\"\n                           placeholder=\"Add a comment\" data-field=\"comment\">\n                </div>\n            </div>\n\n            <div class=\"form-group\">\n                <label class=\"control-label col-md-1 jso-label-title\">Description</label>\n                <div class=\"col-md-3\">\n                    <textarea id=\"", "DescriptionInterpretation\" class=\"", "TextInput form-control\"\n                              placeholder=\"Description of the interpretation\" data-field=\"description\"\n                              @input=\"", "\"></textarea>\n                </div>\n            </div>\n\n        </div>\n        "]);

  opencga_interpretation_variant_review_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_interpretation_variant_review_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


class opencga_interpretation_variant_review_OpencgaInterpretationVariantReview extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      cellbaseClient: {
        type: Object
      },
      query: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ovcs" + utils.randomString(6) + "_";
  }

  updated(changedProperties) {
    /*if(changedProperties.has("property")) {
        this.propertyObserver();
    }*/
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      variant: {
        type: Object //observer: "variantObserver"

      } // active: {
      //     type: Boolean,
      //     value: false,
      //     observer: "activeObserver"
      // }

    };
  }

  variantObserver(e) {// this._fetchCohortStats(e);
  }

  render() {
    return lit_html_lit_html_html(opencga_interpretation_variant_review_templateObject(), this.variant ? this.variant.id : "", this._prefix, this._prefix, this.onInputChange, this._interpretation.id, this._prefix, this._prefix, this._prefix, this._prefix, this.onInputChange);
  }

}
customElements.define("opencga-interpretation-variant-review", opencga_interpretation_variant_review_OpencgaInterpretationVariantReview);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/opencga-variant-interpretation-grid.js
function opencga_variant_interpretation_grid_templateObject() {
  const data = opencga_variant_interpretation_grid_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .variant-link-dropdown:hover .dropdown-menu {\n                display: block;\n            }\n\n            .detail-view :hover {\n                background-color: white;\n            }\n\n            .detail-view-row :hover {\n                background-color: #f5f5f5;\n            }\n\n            .qtip-custom-class .qtip-content {\n                font-size: 12px;\n            }\n            \n            /*quickfix for loading-spinner in bootstrap table*/ \n            .fixed-table-body{\n                min-height: 20vh;\n            }\n        </style>\n\n        <opencb-grid-toolbar .from=\"", "\"\n                             .to=\"", "\"\n                             .numTotalResultsText=\"", "\"\n                             .config=\"", "\"\n                             @columnchange=\"", "\"\n                             @download=\"", "\"\n                             @sharelink=\"", "\">\n        </opencb-grid-toolbar>\n\n        <div id=\"", "GridTableDiv\">\n            <table id=\"", "VariantBrowserGrid\">\n            </table>\n        </div>\n\n        <div class=\"modal fade\" id=\"", "ReviewSampleModal\" data-backdrop=\"static\" data-keyboard=\"false\" tabindex=\"-1\"\n             role=\"dialog\" aria-hidden=\"true\" style=\"padding-top:0; overflow-y: visible\">\n            <div class=\"modal-dialog\" style=\"width: 1280px\">\n                <div class=\"modal-content\">\n                    <div class=\"modal-header\" style=\"padding: 5px 15px\">\n                        <h3>Sample and File Filters</h3>\n                    </div>\n\n                    <opencga-interpretation-variant-review .opencgaSession=\"", "\"\n                                                           .variant=\"", "\">\n                    </opencga-interpretation-variant-review>\n\n                    <div class=\"modal-footer\">\n                        <button type=\"button\" class=\"btn btn-primary\" data-dismiss=\"modal\">Cancel</button>\n                        <button type=\"button\" class=\"btn btn-primary\" data-dismiss=\"modal\">OK</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        "]);

  opencga_variant_interpretation_grid_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_grid_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_variant_interpretation_grid_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_variant_interpretation_grid_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_variant_interpretation_grid_ownKeys(Object(source), true).forEach(function (key) { opencga_variant_interpretation_grid_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_variant_interpretation_grid_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_variant_interpretation_grid_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */









class opencga_variant_interpretation_grid_OpencgaVariantInterpretationGrid extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      clinicalAnalysis: {
        type: Object
      },
      query: {
        type: Object
      },
      reportedVariants: {
        type: Array
      },
      consequenceTypes: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ovig-" + utils.randomString(6) + "_";
    this._initialised = false; // Config for the grid toolbar

    this.toolbarConfig = {
      columns: [{
        title: "Variant",
        field: "id"
      }, {
        title: "Genes",
        field: "genes"
      }, {
        title: "Type",
        field: "type"
      }, {
        title: "Gene Annotations",
        field: "consequenceType"
      }]
    };
    this._config = this.getDefaultConfig();
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession")) {
      this.opencgaSessionObserver();
    }

    if (changedProperties.has("clinicalAnalysis")) {
      this.clinicalAnalysisObserver();
    }

    if (changedProperties.has("query")) {
      this.queryObserver();
    }

    if (changedProperties.has("reportedVariants")) {
      this.renderFromLocal();
    }
  }

  firstUpdated(_changedProperties) {
    // debugger
    // TODO Refactor
    this.downloadRefreshIcon = $("#" + this._prefix + "DownloadRefresh");
    this.downloadIcon = $("#" + this._prefix + "DownloadIcon");

    if (utilsNew_UtilsNew.isUndefinedOrNull(this.reportedVariants)) {
      this.renderVariantTable();
    } else {
      this.renderFromLocal();
    }

    this._initialised = true;
  }

  opencgaSessionObserver() {
    this._config = Object.assign({}, this.getDefaultConfig(), this.config);
    this.variantGridFormatter = new VariantGridFormatter_VariantGridFormatter(this.opencgaSession, this._config);
    const colors = this.variantGridFormatter.assignColors(this.consequenceTypes, this.proteinSubstitutionScores);
    Object.assign(this, colors);
  }

  queryObserver() {
    if (utilsNew_UtilsNew.isUndefinedOrNull(this.reportedVariants)) {
      this.renderVariantTable();
    } else {
      this.renderFromLocal();
    }
  }

  clinicalAnalysisObserver(clinicalAnalysis) {
    let _individuals = [];
    const _samples = [];

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis)) {
      // let _individuals = [];
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.family) && utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.family.members)) {
        _individuals = clinicalAnalysis.family.members;
      } else {
        if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.proband)) {
          _individuals = [clinicalAnalysis.proband];
        }
      }

      for (const individual of _individuals) {
        if (utilsNew_UtilsNew.isNotEmptyArray(individual.samples)) {
          _samples.push(individual.samples[0]);
        }
      }
    }

    this.samples = _samples;
    this.individuals = _individuals; // We reset the query object when the session is changed

    if (utilsNew_UtilsNew.isUndefinedOrNull(this.reportedVariants)) {
      this.renderVariantTable();
    } else {
      this.renderFromLocal();
    }
  }

  onColumnChange(e) {
    const table = $("#" + this._prefix + "VariantBrowserGrid");

    if (e.detail.selected) {
      table.bootstrapTable("showColumn", e.detail.id);
    } else {
      table.bootstrapTable("hideColumn", e.detail.id);
    }
  }

  renderVariantTable() {
    this.from = 1;
    this.to = 10;
    this.approximateCountResult = false;

    const _table = $("#" + this._prefix + "VariantBrowserGrid");

    if (typeof this.opencgaSession !== "undefined" && typeof this.opencgaSession.project !== "undefined" && typeof this.opencgaSession.study !== "undefined" && utilsNew_UtilsNew.isNotEmpty(this.query)) {
      this._columns = this._createDefaultColumns();

      const urlQueryParams = this._getUrlQueryParams();

      const _queryParams = urlQueryParams.queryParams;

      let _numTotal = -1;

      const _this = this;

      let skipCount = false;
      $("#" + this._prefix + "VariantBrowserGrid").bootstrapTable("destroy");
      $("#" + this._prefix + "VariantBrowserGrid").bootstrapTable({
        //url: urlQueryParams.host,
        columns: _this._columns,
        method: "get",
        sidePagination: "server",
        formatLoadingMessage: () => "<div><loading-spinner></loading-spinner></div>",
        ajax: params => {
          if (this.pageNumber > 1) {
            skipCount = true;
          }

          let filters = opencga_variant_interpretation_grid_objectSpread({
            study: this.opencgaSession.study.fqn,
            limit: params.data.limit,
            skip: params.data.offset || 0,
            skipCount: skipCount,
            include: "name,path,samples,status,format,bioformat,creationDate,modificationDate,uuid"
          }, this.query);

          this.opencgaSession.opencgaClient.clinical().runInterpretationCustom(filters).then(res => params.success(res));
        },
        // Set table properties, these are read from config property
        uniqueId: "id",
        pagination: _this._config.pagination,
        pageSize: _this._config.pageSize,
        pageList: _this._config.pageList,
        showExport: _this._config.showExport,
        detailView: _this._config.detailView,
        detailFormatter: _this._config.detailFormatter,
        // this makes the opencga-interpreted-variant-grid properties available in the bootstrap-table formatters
        variantGrid: _this,
        queryParams: function queryParams(params) {
          _queryParams.limit = params.limit;
          _queryParams.skip = params.offset;
          return _queryParams;
        },
        responseHandler: function responseHandler(resp) {
          if (_numTotal === -1) {
            _numTotal = resp.response[0].numTotalResults; // _numTotal = resp.response[0].numTotalResults >= 0 && resp.response[0].numTotalResults < this.pageSize
            //     ? resp.response[0].numTotalResults
            //     : 1150;
          } // Format the number string with commas


          _this.to = Math.min(resp.response[0].numResults, this.pageSize);
          _this.numTotalResultsText = _numTotal.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
          _this.approximateCountResult = resp.response[0].approximateCount;
          return {
            total: _numTotal,
            rows: resp.response[0].result.primaryFindings
          };
        },
        onClickRow: function onClickRow(row, $element, field) {
          $("#" + _this._prefix + "VariantBrowserGrid tr").removeClass("success");
          $($element).addClass("success");

          _this._onSelectVariant(row);
        },
        onCheck: function onCheck(row, $element) {
          const _variant = row.chromosome + ":" + row.start + ":" + row.reference + ":" + row.alternate;

          _this.dispatchEvent(new CustomEvent("checkvariant", {
            detail: {
              id: _variant,
              variant: row,
              checkdVariant: true,
              variants: $("#" + _this._prefix + "VariantBrowserGrid").bootstrapTable("getAllSelections")
            }
          }));
        },
        onCheckAll: function onCheckAll(rows) {
          _this.dispatchEvent(new CustomEvent("checkvariant", {
            detail: {
              variants: $("#" + _this._prefix + "VariantBrowserGrid").bootstrapTable("getAllSelections")
            }
          }));
        },
        onUncheck: function onUncheck(row, $element) {
          const _variant = row.chromosome + ":" + row.start + ":" + row.reference + ":" + row.alternate;

          _this.dispatchEvent(new CustomEvent("checkvariant", {
            detail: {
              id: _variant,
              variant: row,
              checkdVariant: false,
              variants: $("#" + _this._prefix + "VariantBrowserGrid").bootstrapTable("getAllSelections")
            }
          }));
        },
        onLoadSuccess: function onLoadSuccess(data) {
          // The first time we mark as selected the first row that is rows[2] since the first two rows are the header
          if (utilsNew_UtilsNew.isNotEmptyArray(data.rows) && utilsNew_UtilsNew.isNotUndefinedOrNull(_table)) {
            PolymerUtils_PolymerUtils.querySelector(_table.selector).rows[2].setAttribute("class", "success");

            _this._onSelectVariant(data.rows[0]);

            const elementsByClassName = PolymerUtils_PolymerUtils.getElementsByClassName("genome-browser-option");

            for (const elem of elementsByClassName) {
              elem.addEventListener("click", function (e) {
                // _this.genomeBrowserPosition = e.target.dataset.variantPosition;
                _this.dispatchEvent(new CustomEvent("setgenomebrowserposition", {
                  detail: {
                    genomeBrowserPosition: e.target.dataset.variantPosition
                  },
                  bubbles: true,
                  composed: true
                }));
              });
            }
          }
        },
        onLoadError: function onLoadError(status, res) {
          console.error(res); //debugger;
        },
        onPageChange: function onPageChange(page, size) {
          _this.from = (page - 1) * size + 1;
          _this.to = page * size;
        },
        onPostBody: function onPostBody(data) {
          const _onPostBody = _this._onPostBody.bind(_this, data, "remote");

          _this._onPostBody();
        }
      });
      $("#" + _this._prefix + "VariantBrowserGrid").bootstrapTable("showLoading");
    }
  }

  _getUrlQueryParams() {
    // Check the opencgaClient exists
    if (utilsNew_UtilsNew.isUndefinedOrNull(this.opencgaSession.opencgaClient)) {
      return {
        host: "",
        queryParams: {}
      };
    } // Prepare host. By default we assume https protocol instead of http


    let host = this.opencgaSession.opencgaClient.getConfig().host;

    if (!host.startsWith("https://") && !host.startsWith("http://")) {
      host += "https://";
    }

    if (typeof this.opencgaSession.project !== "undefined" && typeof this.opencgaSession.study.alias !== "undefined") {
      // if (typeof this.query === "undefined") {
      //     this.query = {};
      // }     || this.query.study.split(new RegExp("[,;]")).length === 1
      if (utilsNew_UtilsNew.isEmpty(this.query.study)) {
        this.query.study = this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias;
      } // host += '/webservices/rest/v1/analysis/variant/query';


      host += "/webservices/rest/v1/analysis/clinical/interpretation/tools/custom";
    } else {
      return {
        host: host,
        queryParams: {}
      };
    } // Init queryParams with default and config values plus query object


    let queryParams;

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.config) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.config.queryParams)) {
      queryParams = Object.assign({}, this.config.queryParams, this.query);
    } else {
      queryParams = Object.assign({}, this.query);
    }

    if (this.opencgaSession.opencgaClient._config.sessionId !== undefined) {
      queryParams = Object.assign(queryParams, {
        sid: this.opencgaSession.opencgaClient._config.sessionId
      });
    }

    if (utilsNew_UtilsNew.isNotEmptyArray(this.samples)) {
      // Filters sample and genotype are exclusive
      if (utilsNew_UtilsNew.isUndefinedOrNull(queryParams.genotype) && utilsNew_UtilsNew.isUndefinedOrNull(queryParams.family)) {
        const sampleIds = [];
        this.samples.forEach(sample => {
          sampleIds.push(sample.id);
        });
        queryParams.sample = sampleIds.join(";"); // queryParams.includeSample = sampleIds.join(",");
      }

      queryParams.summary = false;
      queryParams.exclude = "annotation.geneExpression"; // FIXME
      // queryParams.approximateCount = true;
      // queryParams.skipCount = false;

      queryParams.useSearchIndex = "auto";
      queryParams.unknownGenotype = "0/0";
    } else {
      queryParams.summary = true; // queryParams.exclude = "annotation.geneExpression";
    }

    if (typeof this.config !== "undefined" && this.config.includeMissing) {
      const keys = Object.keys(queryParams);

      for (let i = 0; i < keys.length; i++) {
        let val = queryParams[keys[i]]; // Replace standard fields with aliases

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.config.alias) && (keys[i] === "filter" || keys[i] === "format")) {
          for (const aliasKey of Object.keys(this.config.alias)) {
            if (val.includes(aliasKey)) {
              val = val.replace(aliasKey + ">", this.config.alias[aliasKey] + ">");
              queryParams[keys[i]] = val;
              break;
            }
          }
        }

        if (typeof val === "string" && keys[i] !== "cohortStatsMaf" && keys[i] !== "cohortStatsAlt") {
          val = val.replace(/</g, "<<");
          val = val.replace(/>/g, ">>");
          queryParams[keys[i]] = val;
        }
      }
    }

    return {
      host: host,
      queryParams: queryParams
    };
  }

  renderFromLocal() {
    this.from = 1;
    this.to = Math.min(this.reportedVariants.length, this._config.pageSize);
    this.numTotalResultsText = this.reportedVariants.length.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    this._columns = this._createDefaultColumns();

    const _this = this;

    $("#" + this._prefix + "VariantBrowserGrid").bootstrapTable("destroy");
    $("#" + this._prefix + "VariantBrowserGrid").bootstrapTable({
      data: _this.reportedVariants,
      columns: _this._columns,
      sidePagination: "local",
      // Set table properties, these are read from config property
      uniqueId: "id",
      pagination: _this._config.pagination,
      pageSize: _this._config.pageSize,
      pageList: _this._config.pageList,
      showExport: _this._config.showExport,
      detailView: _this._config.detailView,
      detailFormatter: _this._config.detailFormatter,
      // this makes the opencga-interpreted-variant-grid properties available in the bootstrap-table formatters
      variantGrid: _this,
      onClickRow: function onClickRow(row, $element) {
        $("#" + _this._prefix + "VariantBrowserGrid tr").removeClass("success");
        $($element).addClass("success");

        _this._onClickSelectedVariant(row);
      },
      onPageChange: function onPageChange(page, size) {
        _this.from = (page - 1) * size + 1;
        _this.to = page * size;
      },
      onPostBody: function onPostBody(data) {
        const _onPostBody = _this._onPostBody.bind(_this, data, "local");

        _this._onPostBody();
      }
    });
  }

  _onPostBody(data, mode) {
    const removeIndividualButtons = PolymerUtils_PolymerUtils.querySelectorAll(".removeIndividualButton");

    for (let i = 0; i < removeIndividualButtons.length; i++) {
      removeIndividualButtons[i].addEventListener("click", this.onReviewClick.bind(this));
    } // The first time we mark as selected the first row that is rows[2] since the first two rows are the header


    const _table = $("#" + this._prefix + "VariantBrowserGrid");

    if (utilsNew_UtilsNew.isNotEmptyArray(data) && utilsNew_UtilsNew.isNotUndefinedOrNull(_table)) {
      PolymerUtils_PolymerUtils.querySelector(_table.selector).rows[2].setAttribute("class", "success");

      if (mode === "remote") {
        this._onSelectVariant(data[0]);
      } else {
        this._onClickSelectedVariant(data[0]);
      }
    } // Add tooltips


    this.variantGridFormatter.addTooltip("div.variant-tooltip", "Links");
    this.variantGridFormatter.addTooltip("span.gene-tooltip", "Links");
    this.variantGridFormatter.addTooltip("div.zygositySampleTooltip", "File metrics", "", {
      style: {
        classes: "qtip-rounded qtip-shadow qtip-custom-class"
      }
    });
    this.variantGridFormatter.addPopulationFrequenciesTooltip("table.populationFrequenciesTable", this.populationFrequencies);
    this.variantGridFormatter.addPopulationFrequenciesInfoTooltip("span.pop-preq-info-icon", this.populationFrequencies);
    const predictionTooltipContent = "<span style='font-weight: bold'>Prediction</span> column shows the Clinical Significance prediction and Tier following the ACMG guide recommendations";
    this.variantGridFormatter.addTooltip("span.interpretation-info-icon", "Interpretation", predictionTooltipContent, {
      position: {
        my: "top right"
      },
      style: {
        classes: "qtip-rounded qtip-shadow qtip-custom-class"
      }
    });
    this.variantGridFormatter.addTooltip("div.predictionTooltip", "Classification", "", {
      position: {
        my: "top right"
      },
      style: {
        classes: "qtip-rounded qtip-shadow qtip-custom-class"
      },
      width: "360px"
    });
  }

  _onSelectVariant(row) {
    if (typeof row !== "undefined") {
      const reference = row.reference !== "" ? row.reference : "-";
      const alternate = row.alternate !== "" ? row.alternate : "-";

      const _variant = row.chromosome + ":" + row.start + ":" + reference + ":" + alternate;

      this.dispatchEvent(new CustomEvent("selectvariant", {
        detail: {
          id: _variant,
          variant: row
        }
      }));
    }
  }

  _onClickSelectedVariant(row) {
    if (typeof row !== "undefined") {
      const _variant = row.chromosome + ":" + row.start + ":" + row.reference + ":" + row.alternate;

      this.dispatchEvent(new CustomEvent("selectvariant2", {
        detail: {
          id: _variant,
          variant: row
        }
      }));
    }
  }

  onReviewClick(e) {
    // debugger
    // this.dispatchEvent(new CustomEvent('reviewvariant', {
    //     detail: {
    //         variant: e.currentTarget.dataset.variant
    //     }
    // }));
    for (const rv of this.reportedVariants) {
      if (rv.id === e.currentTarget.dataset.variantId) {
        this.variantReview = rv;
        break;
      }
    }

    $("#" + this._prefix + "ReviewSampleModal").modal("show");
  }

  showGene(geneName) {
    this.dispatchEvent(new CustomEvent("selected", {
      detail: {
        gene: geneName
      }
    }));
  }
  /*
   *  GRID FORMATTERS
   */


  detailFormatter(value, row, a) {
    let result = "<div class='row' style='padding-bottom: 20px'>";
    let detailHtml = "";

    if (typeof row !== "undefined" && typeof row.annotation !== "undefined") {
      detailHtml = "<div style='padding: 10px 0px 5px 25px'><h4>Relevant Mutation Events</h4></div>";
      detailHtml += "<div style='padding: 5px 50px'>";
      detailHtml += this.variantGrid.variantGridFormatter.reportedEventDetailFormatter(value, row, this.variantGrid);
      detailHtml += "</div>";
      detailHtml += "<div style='padding: 25px 0px 5px 25px'><h4>Consequence Types</h4></div>";
      detailHtml += "<div style='padding: 5px 50px'>";
      detailHtml += this.variantGrid.variantGridFormatter.consequenceTypeDetailFormatter(value, row, this.variantGrid);
      detailHtml += "</div>";
      detailHtml += "<div style='padding: 20px 0px 5px 25px'><h4>Clinical Phenotypes</h4></div>";
      detailHtml += "<div style='padding: 5px 50px'>";
      let clinvarTraits = "<div><label style='padding-right: 10px'>ClinVar: </label>-</div>";
      let cosmicTraits = "<div><label style='padding-right: 10px'>Cosmic: </label>-</div>";

      if (typeof row.annotation.variantTraitAssociation !== "undefined" && row.annotation.variantTraitAssociation != null) {
        const traits = {
          clinvar: [],
          cosmic: []
        };
        const fields = ["clinvar", "cosmic"];

        for (const field of fields) {
          const clinicalData = row.annotation.variantTraitAssociation[field];

          if (utilsNew_UtilsNew.isNotEmptyArray(clinicalData)) {
            for (let j = 0; j < clinicalData.length; j++) {
              if (field === "clinvar" && traits.clinvar.indexOf(clinicalData[j].traits[0]) === -1 && clinicalData[j].traits[0] !== "not specified" && clinicalData[j].traits[0] !== "not provided") {
                traits.clinvar.push(clinicalData[j].traits[0]);
              } else if (field === "cosmic" && traits.cosmic.indexOf(clinicalData[j].primaryHistology) === -1) {
                const histologySubtype = utilsNew_UtilsNew.isNotEmpty(clinicalData[j].histologySubtype) ? clinicalData[j].histologySubtype : "-";
                traits.cosmic.push(clinicalData[j].primaryHistology + " (" + histologySubtype + ")");
              }
            }
          }
        }

        if (traits.clinvar.length > 0) {
          clinvarTraits = "<div><label style='padding-right: 10px'>ClinVar: </label>" + traits.clinvar.join(", ") + "</div>";
        }

        if (traits.cosmic.length > 0) {
          cosmicTraits = "<div><label style='padding-right: 10px'>Cosmic: </label>" + traits.cosmic.join(", ") + "</div>";
        }
      }

      detailHtml += clinvarTraits + cosmicTraits;
      detailHtml += "</div>";
    }

    result += detailHtml + "</div>";
    return result;
  }

  variantFormatter(value, row, index) {
    const variantHtmlDiv = this.variantGridFormatter.variantFormatter(value, row, this._config);
    const snptHtmlAnchor = this.variantGridFormatter.snpFormatter(value, row, index);
    return variantHtmlDiv + "<div style='padding-top: 10px'>" + snptHtmlAnchor + "</div>";
  } // predictionFormatter(value, row, index) {
  //     let res = "";
  //     if (UtilsNew.isNotUndefinedOrNull(row.reportEvents)){
  //         row.reportEvents.forEach((reportEvent) => {
  //             if (UtilsNew.isNotUndefinedOrNull(reportEvent.prediction)) {
  //                 res += "<label>" + reportEvent.prediction + "</label>";
  //             }
  //             if (UtilsNew.isNotUndefinedOrNull(reportEvent.score)) {
  //                 res += " (<label>" + reportEvent.score + "</label>)";
  //             }
  //         });
  //     }
  //     return res;
  // }


  zygosityFormatter(value, row, index) {
    let resultHtml = "";

    if (utilsNew_UtilsNew.isNotEmptyArray(row.studies)) {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(row.studies[0].samplesData) && utilsNew_UtilsNew.isNotUndefinedOrNull(row.studies[0].samplesData[this.field.memberIdx]) && utilsNew_UtilsNew.isNotUndefinedOrNull(row.studies[0].samplesData[this.field.memberIdx][0])) {
        // First, get and check info fields QUAL, FILTER; and format fields DP, AD and GQ
        let qual = "-";
        let filter = "-";
        let mutationColor = "black";
        const sampleFormat = row.studies[0].samplesData[this.field.memberIdx]; // INFO fields

        if (utilsNew_UtilsNew.isNotEmptyArray(this.field.clinicalAnalysis.files[this.field.memberName])) {
          for (const file of this.field.clinicalAnalysis.files[this.field.memberName]) {
            // Find the sample VCF file, if exists
            if (file.format === "VCF") {
              for (const studyFile of row.studies[0].files) {
                if (studyFile.fileId === file.name) {
                  qual = Number(studyFile.attributes.QUAL).toFixed(2);

                  if (qual < this.field.quality.qual) {
                    mutationColor = "silver";
                  }

                  filter = studyFile.attributes.FILTER;

                  if (filter !== "PASS") {
                    mutationColor = "silver";
                  }
                }
              }
            }
          }
        } // FORMAT fields


        const formatFields = [];

        for (const formatField in row.studies[0].format) {
          // GT fields is treated separately
          if (row.studies[0].format[formatField] !== "GT") {
            const html = "<div class=\"form-group\" style=\"margin: 0px 2px\">\n                                            <label class=\"col-md-5\">".concat(row.studies[0].format[formatField], "</label>\n                                            <div class=\"col-md-7\">").concat(sampleFormat[formatField], "</div>\n                                        </div>");
            formatFields.push(html);
          }
        } // Second, prepare the visual representation of genotypes


        let left;
        let right;
        let leftRadio = 8;
        let rightRadio = 8;
        const genotypeSplitRegExp = new RegExp("[/|]");
        const sampleGT = row.studies[0].samplesData[this.field.memberIdx][0];

        if (sampleGT === "0/1" || sampleGT === "1/0") {
          // If genotype si 0/1 or 1/0 they must be displayed like 0/1 (not phased)
          left = "white";
          right = mutationColor;
        } else {
          const genotypes = sampleGT.split(genotypeSplitRegExp);

          switch (genotypes[0]) {
            case "0":
              left = "white";
              break;

            case "1":
              left = mutationColor;
              break;

            case ".":
              left = "red";
              leftRadio = 1;
              break;
          }

          switch (genotypes[1]) {
            case "0":
              right = "white";
              break;

            case "1":
              right = mutationColor;
              break;

            case ".":
              right = "red";
              rightRadio = 1;
              break;
          }
        } // Third, prepare the tooltip information


        const tooltipText = "<div class=\"col-md-12\" style=\"padding: 0px\">\n                                                <form class=\"form-horizontal\">\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-5\">GT</label>\n                                                        <div class=\"col-md-7\">".concat(sampleGT, "</div>\n                                                    </div>\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-5\">QUAL</label>\n                                                        <div class=\"col-md-7\">").concat(qual, "</div>\n                                                    </div>\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-5\">FILTER</label>\n                                                        <div class=\"col-md-7\">").concat(filter, "</div>\n                                                    </div>\n                                                    ").concat(formatFields.join(""), "\n                                                </form>\n                                           </div>"); // Last, put everything together and display

        resultHtml = "<div class='zygositySampleTooltip' data-tooltip-text='".concat(tooltipText, "' style=\"width: 70px\" align=\"center\">\n                                        <svg viewBox=\"0 0 70 30\" xmlns=\"http://www.w3.org/2000/svg\">\n                                            <circle cx=\"20\" cy=\"15\" r=\"").concat(leftRadio, "\" style=\"stroke: black;fill: ").concat(left, "\"/>\n                                            <circle cx=\"50\" cy=\"15\" r=\"").concat(rightRadio, "\" style=\"stroke: black;fill: ").concat(right, "\"/>\n                                        </svg>\n                                      </div>\n                                ");
      }
    }

    return resultHtml;
  }

  pathogeniticyFormatter(value, row, index) {
    // TODO we must call to PathDB to get the frequency of each variant, next code is just an example
    const val = "<div class=\"col-md-12\" style=\"padding: 0px\">\n                                <form class=\"form-horizontal\">\n                                    <div class=\"col-md-12\" style=\"padding: 0px\">\n                                        <form class=\"form-horizontal\">\n                                            <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                <label class=\"col-md-5\">HP:00".concat(Math.floor(Math.random() * 1000 + 1), "</label>\n                                                <div class=\"col-md-7\">").concat(Number(Math.random()).toFixed(2), "</div>\n                                            </div>\n                                             <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                <label class=\"col-md-5\">HP:00").concat(Math.floor(Math.random() * 1000 + 1), "</label>\n                                                <div class=\"col-md-7\">").concat(Number(Math.random()).toFixed(2), "</div>\n                                             </div>\n                                         </form>\n                                      </div>\n                                </form>\n                           </div>");
    return val;
  }
  /**
   * Create a color table with ALL cohort for all studies.
   * @param value
   * @param row
   * @return {*}
   */


  studyCohortsFormatter(value, row) {
    if (typeof row !== "undefined" && typeof row.studies !== "undefined") {
      const cohorts = [];
      const cohortMap = new Map();

      for (const study of row.studies) {
        const arr = study.studyId.split(":");
        const s = arr[arr.length - 1] + ":ALL";
        cohorts.push(s);
        cohortMap.set(s, Number(study.stats["ALL"].altAlleleFreq).toFixed(4));
      }

      return this.variantGridFormatter.createPopulationFrequenciesTable(cohorts, cohortMap, this.populationFrequencies.color);
    } else {
      return "-";
    }
  }

  clinicalPopulationFrequenciesFormatter(value, row) {
    if (typeof row !== "undefined" && typeof row.annotation !== "undefined") {
      const popFreqMap = new Map();

      if (utilsNew_UtilsNew.isNotEmptyArray(row.annotation.populationFrequencies)) {
        for (const popFreq of row.annotation.populationFrequencies) {
          popFreqMap.set(popFreq.study + ":" + popFreq.population, Number(popFreq.altAlleleFreq).toFixed(4));
        }
      }

      return this.variantGridFormatter.createPopulationFrequenciesTable(this._config.populationFrequencies, popFreqMap, this.populationFrequencies.color);
    } else {
      return "-";
    }
  }

  clinicalPhenotypeFormatter(value, row, index) {
    let phenotypeHtml = "<span><i class='fa fa-times' style='color: red'></i></span>";

    if (typeof row !== "undefined" && typeof row.annotation !== "undefined") {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(row.annotation.variantTraitAssociation)) {
        const traits = [];
        const clinicalData = row.annotation.variantTraitAssociation[this.field];

        if (utilsNew_UtilsNew.isNotEmptyArray(clinicalData)) {
          for (let j = 0; j < clinicalData.length; j++) {
            if (this.field === "clinvar" && traits.indexOf(clinicalData[j].traits[0]) === -1 && clinicalData[j].traits[0] !== "not specified" && clinicalData[j].traits[0] !== "not provided") {
              traits.push(clinicalData[j].traits[0]);
            } else if (this.field === "cosmic" && traits.indexOf(clinicalData[j].primaryHistology) === -1) {
              traits.push(clinicalData[j].primaryHistology);
            }
          }

          if (traits.length > 0) {
            let traitText = traits[0];

            if (traits.length > 1) {
              traitText += ", ...";
            }

            phenotypeHtml = "<span data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"".concat(traitText, "\"><i class='fa fa-check' style='color: green'></i></span>");
          }
        }
      }
    }

    return phenotypeHtml;
  }

  predictionFormatter(value, row, index) {
    const clinicalSignificanceCodes = {
      PATHOGENIC_VARIANT: {
        code: 5,
        color: "red"
      },
      LIKELY_PATHOGENIC_VARIANT: {
        code: 5,
        color: "red"
      },
      VARIANT_OF_UNKNOWN_CLINICAL_SIGNIFICANCE: {
        code: 5,
        color: "darkorange"
      },
      LIKELY_BENIGN_VARIANT: {
        code: 5,
        color: "blue"
      },
      BENIGN_VARIANT: {
        code: 5,
        color: "blue"
      },
      NOT_ASSESSED: {
        code: 5,
        color: "black"
      }
    };
    let clinicalSignificanceCode = 0;
    let clinicalSignificanceHtml = "NA";
    let clinicalSignificanceTooltipText = "";
    const modeOfInheritances = [];

    for (const re of row.evidences) {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(re.modeOfInheritance) && !modeOfInheritances.includes(re.modeOfInheritance)) {
        modeOfInheritances.push(re.modeOfInheritance);
      }

      if (clinicalSignificanceCodes[re.classification.clinicalSignificance] !== undefined && clinicalSignificanceCodes[re.classification.clinicalSignificance].code > clinicalSignificanceCode) {
        clinicalSignificanceCode = clinicalSignificanceCodes[re.classification.clinicalSignificance].code;
        let clinicalSignificance;

        if (re.classification.clinicalSignificance === "VARIANT_OF_UNKNOWN_CLINICAL_SIGNIFICANCE") {
          clinicalSignificance = "VUS";
        } else {
          clinicalSignificance = re.classification.clinicalSignificance.replace("_VARIANT", "").replace("_", " ");
        }

        clinicalSignificanceHtml = "<span style=\"color: ".concat(clinicalSignificanceCodes[re.classification.clinicalSignificance].color, "\">").concat(clinicalSignificance, "</span>");
        clinicalSignificanceTooltipText = "<div class=\"col-md-12\" style=\"padding: 0px\">\n                                                                <form class=\"form-horizontal\">\n                                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                                        <label class=\"col-md-5\">ACMG</label>\n                                                                        <div class=\"col-md-7\">".concat(re.classification.acmg.join(", "), "</div>\n                                                                    </div>\n                                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                                        <label class=\"col-md-5\">ACMG Tier</label>\n                                                                        <div class=\"col-md-7\">").concat(re.classification.tier, "</div>\n                                                                    </div>\n                                                                </form>\n                                                            </div>");
      }
    }

    return "<div class='predictionTooltip' data-tooltip-text='".concat(clinicalSignificanceTooltipText, "'>\n                            ").concat(clinicalSignificanceHtml, "\n                        </div>");
  }

  reviewFormatter(value, row, index) {
    return "<button class=\"btn btn-link removeIndividualButton\" data-variant-id=\"".concat(row.id, "\">\n                            <i class=\"fa fa-edit icon-padding removeIndividualButton\" aria-hidden=\"true\"></i> Edit\n                        </button>");
  }

  _createDefaultColumns() {
    if (this.variantGridFormatter === undefined) {
      return;
    }

    this._columns = [[{
      title: "Variant",
      field: "id",
      rowspan: 2,
      colspan: 1,
      // formatter: this.variantGridFormatter.variantFormatter.bind(this),
      formatter: this.variantFormatter.bind(this),
      halign: "center",
      sortable: true
    }, {
      title: "Genes",
      field: "genes",
      rowspan: 2,
      colspan: 1,
      formatter: this.variantGridFormatter.geneFormatter.bind(this),
      halign: "center"
    }, {
      title: "Type",
      field: "type",
      rowspan: 2,
      colspan: 1,
      formatter: this.variantGridFormatter.typeFormatter.bind(this),
      halign: "center"
    }, {
      title: "Gene Annotation",
      field: "consequenceType",
      rowspan: 2,
      colspan: 1,
      formatter: this.variantGridFormatter.consequenceTypeFormatter.bind(this),
      halign: "center"
    }, {
      title: "Variant Stats <span class='pop-preq-info-icon'><i class='fa fa-info-circle' style='color: #337ab7' aria-hidden='true'></i></span>",
      field: "frequencies",
      rowspan: 1,
      colspan: 2,
      align: "center"
    }, {
      title: "Phenotypes",
      field: "phenotypes",
      rowspan: 1,
      colspan: 2,
      align: "center"
    } // {
    //     title: "Interpretation <span class='interpretation-info-icon'><i class='fa fa-info-circle' style='color: #337ab7' aria-hidden='true'></i></span>",
    //     field: "interpretation",
    //     rowspan: 1,
    //     colspan: 2,
    //     halign: 'center'
    // },
    ], [{
      title: "Cohorts",
      field: "cohort",
      colspan: 1,
      rowspan: 1,
      formatter: this.studyCohortsFormatter.bind(this)
    }, {
      title: "Population Frequencies",
      field: "populationFrequencies",
      colspan: 1,
      rowspan: 1,
      formatter: this.clinicalPopulationFrequenciesFormatter.bind(this)
    }, // {
    //     title: "Max Allele Freq",
    //     field: "maxAlleleFreq",
    //     rowspan: 1,
    //     colspan: 1,
    //     // halign: 'center'
    // },
    {
      title: "ClinVar",
      field: "clinvar",
      colspan: 1,
      rowspan: 1,
      formatter: this.clinicalPhenotypeFormatter,
      align: "center"
    }, {
      title: "Cosmic",
      field: "cosmic",
      colspan: 1,
      rowspan: 1,
      formatter: this.clinicalPhenotypeFormatter,
      align: "center"
    }, {
      title: "Prediction",
      field: "prediction",
      rowspan: 1,
      colspan: 1,
      formatter: this.predictionFormatter,
      halign: "center" // formatter: this.predictionFormatter

    } // {
    //     title: "Select",
    //     field: "selectForInterpretation",
    //     rowspan: 1,
    //     colspan: 1,
    //     align: 'center'
    // }
    ]]; // update columns dynamically

    this._updateTableColumns();

    return this._columns;
  }

  _updateTableColumns() {
    // Add a checkbox column
    this._columns[0].push({
      title: "Interpretation <span class='interpretation-info-icon'><i class='fa fa-info-circle' style='color: #337ab7' aria-hidden='true'></i></span>",
      field: "interpretation",
      rowspan: 1,
      colspan: this._config.showSelectCheckbox ? 2 : 1,
      halign: "center"
    });

    if (this._config.showSelectCheckbox) {
      this._columns[1].push({
        // field: "stateCheckBox",
        checkbox: true,
        rowspan: 1,
        colspan: 1
      });
    }

    if (this._config.showStatus) {
      // this._columns[1].push({
      //     title: "Status",
      //     field: "status",
      //     rowspan: 1,
      //     colspan: 1
      // });
      this._columns[0].push({
        title: "Review",
        // field: "status",
        rowspan: 2,
        colspan: 1,
        formatter: this.reviewFormatter.bind(this),
        align: "center"
      });
    }

    const sampleInfo = {};

    if (utilsNew_UtilsNew.isNotEmptyArray(this.individuals)) {
      const probandId = utilsNew_UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis.proband) ? this.clinicalAnalysis.proband.id : "";

      for (const individual of this.individuals) {
        if (utilsNew_UtilsNew.isNotEmptyArray(individual.samples)) {
          let affected = false;

          if (utilsNew_UtilsNew.isNotEmptyArray(individual.disorders)) {
            for (const disorder of individual.disorders) {
              if (disorder.id === this.clinicalAnalysis.disorder.id) {
                affected = true;
                break;
              }
            }
          }

          let role = "";

          for (const ind of this.individuals) {
            if (utilsNew_UtilsNew.isNotUndefinedOrNull(ind.father) && ind.father.id === individual.id) {
              role = "father";
            }

            if (utilsNew_UtilsNew.isNotUndefinedOrNull(ind.mother) && ind.mother.id === individual.id) {
              role = "mother";
            }
          }

          sampleInfo[individual.samples[0].id] = {
            proband: individual.id === probandId,
            affected: affected,
            role: role,
            sex: individual.sex
          };
        }
      }
    }

    if (typeof this._columns !== "undefined" && utilsNew_UtilsNew.isNotEmptyArray(this.samples)) {
      this._columns[0].splice(4, 0, {
        title: "Sample Genotypes",
        field: "zygosity",
        rowspan: 1,
        colspan: this.samples.length,
        align: "center"
      });

      for (let i = 0; i < this.samples.length; i++) {
        let color = "black";

        if (sampleInfo[this.samples[i].id].proband) {
          color = "darkred";

          if (utilsNew_UtilsNew.isEmpty(sampleInfo[this.samples[i].id].role)) {
            sampleInfo[this.samples[i].id].role = "proband";
          }
        }

        let affected = "<span>UnAff.</span>";

        if (sampleInfo[this.samples[i].id].affected) {
          affected = "<span style='color: red'>Aff.</span>";
        }

        this._columns[1].splice(i, 0, {
          title: "<span style=\"color: ".concat(color, "\">").concat(this.samples[i].id, "</span>\n                                    <br>\n                                    <span style=\"font-style: italic\">").concat(sampleInfo[this.samples[i].id].role, ", ").concat(affected, "</span>"),
          // field: 'samples',
          field: {
            memberIdx: i,
            memberName: this.samples[i].id,
            quality: this._config.quality,
            clinicalAnalysis: this.clinicalAnalysis
          },
          rowspan: 1,
          colspan: 1,
          formatter: this.zygosityFormatter,
          align: "center",
          nucleotideGenotype: true
        });
      } // Add Proband File Metrics
      // this._columns[0].splice(5, 0, {
      //     title: "Pathogenicity",
      //     field: "pathogenicity",
      //     rowspan: 2,
      //     colspan: 1,
      //     formatter: this.pathogeniticyFormatter,
      //     halign: 'center'
      // });

    }
  } // TODO adapt to this resource!


  onDownload(e) {
    const urlQueryParams = this._getUrlQueryParams();

    const params = urlQueryParams.queryParams;
    params.limit = 1000; // Default limit is 1000 for now

    this.downloadRefreshIcon.css("display", "inline-block");
    this.downloadIcon.css("display", "none");

    const _this = this;

    this.opencgaSession.opencgaClient.variants().query(params).then(function (response) {
      const result = response.response[0].result;
      let dataString = [];
      let mimeType = "";
      let extension = ""; // Check if user clicked in Tab or JSON format

      if (e.detail.option.toLowerCase() === "tab") {
        dataString = variant_utils_VariantUtils.jsonToTabConvert(result, _this.populationFrequencies.studies, _this.samples, _this._config.nucleotideGenotype);
        mimeType = "text/plain";
        extension = ".txt";
      } else {
        for (const res of result) {
          dataString.push(JSON.stringify(res));
        }

        mimeType = "application/json";
        extension = ".json";
      } // Build file and anchor link


      const data = new Blob([dataString.join("\n")], {
        type: mimeType
      });
      const file = window.URL.createObjectURL(data);
      const a = document.createElement("a");
      a.href = file;
      a.download = _this.opencgaSession.study.alias + extension;
      document.body.appendChild(a);
      a.click();
      setTimeout(function () {
        document.body.removeChild(a);
      }, 0);
    }).then(function () {
      _this.downloadRefreshIcon.css("display", "none");

      _this.downloadIcon.css("display", "inline-block");
    });
  }

  onShare() {
    const _this = this;

    $("[data-toggle=popover]").popover({
      content: function content() {
        const getUrlQueryParams = _this._getUrlQueryParams();

        const query = ["limit=1000"];

        for (const key in getUrlQueryParams.queryParams) {
          // Check sid has a proper value. For public projects sid is undefined. In that case, sid must be removed from the url
          if (key === "sid" && getUrlQueryParams.queryParams[key] === undefined) {
            delete getUrlQueryParams.queryParams["sid"];
          } else {
            query.push(key + "=" + getUrlQueryParams.queryParams[key]);
          }
        }

        return getUrlQueryParams.host + "?" + query.join("&");
      }
    }).on("show.bs.popover", function () {
      $(this).data("bs.popover").tip().css("max-width", "none");
    });
  }

  getDefaultConfig() {
    return {
      pagination: true,
      pageSize: 10,
      pageList: [10, 25, 50],
      showExport: false,
      detailView: true,
      detailFormatter: this.detailFormatter,
      showSelectCheckbox: false,
      showStatus: false,
      multiSelection: false,
      nucleotideGenotype: true,
      alleleStringLengthMax: 10,
      header: {
        horizontalAlign: "center",
        verticalAlign: "bottom"
      },
      quality: {
        qual: 30,
        dp: 20
      },
      populationFrequencies: ["1kG_phase3:ALL", "GNOMAD_GENOMES:ALL", "GNOMAD_EXOMES:ALL", "UK10K:ALL", "GONL:ALL", "ESP6500:ALL", "EXAC:ALL"]
    };
  }

  showLoading() {
    $("#" + this._prefix + "VariantBrowserGrid").bootstrapTable("showLoading");
  }

  render() {
    return lit_html_lit_html_html(opencga_variant_interpretation_grid_templateObject(), this.from, this.to, this.numTotalResultsText, this.toolbarConfig, this.onColumnChange, this.onDownload, this.onShare, this._prefix, this._prefix, this._prefix, this.opencgaSession, this.variantReview);
  }

}
customElements.define("opencga-variant-interpretation-grid", opencga_variant_interpretation_grid_OpencgaVariantInterpretationGrid);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/annotation/cellbase-variantannotation-view.js
function cellbase_variantannotation_view_templateObject15() {
  const data = cellbase_variantannotation_view_taggedTemplateLiteral(["No ClinVar and Cosmic data available"]);

  cellbase_variantannotation_view_templateObject15 = function _templateObject15() {
    return data;
  };

  return data;
}

function cellbase_variantannotation_view_templateObject14() {
  const data = cellbase_variantannotation_view_taggedTemplateLiteral(["\n                            No Cosmic data available\n                        "]);

  cellbase_variantannotation_view_templateObject14 = function _templateObject14() {
    return data;
  };

  return data;
}

function cellbase_variantannotation_view_templateObject13() {
  const data = cellbase_variantannotation_view_taggedTemplateLiteral(["\n                                    <tr>\n                                        <td>", "</td>\n                                        <td>", "</td>\n                                        <td>", "</td>\n                                        <td>", "</td>\n                                        <td>", "</td>\n                                        <td>", "</td>\n                                        <td>", "</td>\n                                        <td>", "</td>\n                                        <td>", "</td>\n                                    </tr>\n                                "]);

  cellbase_variantannotation_view_templateObject13 = function _templateObject13() {
    return data;
  };

  return data;
}

function cellbase_variantannotation_view_templateObject12() {
  const data = cellbase_variantannotation_view_taggedTemplateLiteral(["\n                            <table class=\"table table-hover table-bordered\">\n                                <thead style=\"background-color: #eee\">\n                                <tr>\n                                    <th>Mutation Id</th>\n                                    <th>Primary Site</th>\n                                    <th>Site Subtype</th>\n                                    <th>Primary Histology</th>\n                                    <th>Histology Subtype</th>\n                                    <th>Sample Source</th>\n                                    <th>Tumour Origin</th>\n                                    <th>Gene Name</th>\n                                    <th>Mutation Somatic Status</th>\n                                </tr>\n                                </thead>\n                                <tbody>\n                                ", "\n                                </tbody>\n                            </table>\n                        "]);

  cellbase_variantannotation_view_templateObject12 = function _templateObject12() {
    return data;
  };

  return data;
}

function cellbase_variantannotation_view_templateObject11() {
  const data = cellbase_variantannotation_view_taggedTemplateLiteral(["\n                            <div>No ClinVar data available</div>\n                        "]);

  cellbase_variantannotation_view_templateObject11 = function _templateObject11() {
    return data;
  };

  return data;
}

function cellbase_variantannotation_view_templateObject10() {
  const data = cellbase_variantannotation_view_taggedTemplateLiteral(["", "<br>"]);

  cellbase_variantannotation_view_templateObject10 = function _templateObject10() {
    return data;
  };

  return data;
}

function cellbase_variantannotation_view_templateObject9() {
  const data = cellbase_variantannotation_view_taggedTemplateLiteral(["", "<br>"]);

  cellbase_variantannotation_view_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function cellbase_variantannotation_view_templateObject8() {
  const data = cellbase_variantannotation_view_taggedTemplateLiteral(["\n                                    <tr>\n                                        <td>", "</td>\n                                        <td>", "</td>\n                                        <td>\n                                            ", "\n                                        </td>\n                                        <td>\n                                            ", "\n                                        </td>\n                                        <td>", "</td>\n                                    </tr>\n                                "]);

  cellbase_variantannotation_view_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function cellbase_variantannotation_view_templateObject7() {
  const data = cellbase_variantannotation_view_taggedTemplateLiteral(["\n                        <div>\n                            <table class=\"table table-hover table-bordered\">\n                                <thead style=\"background-color: #eee\">\n                                <tr>\n                                    <th>Accession</th>\n                                    <th>Clinical Significance</th>\n                                    <th>Traits</th>\n                                    <th>Gene Names</th>\n                                    <th>Review Status</th>\n                                </tr>\n                                </thead>\n                                <tbody>\n                                ", "\n                                </tbody>\n                            </table>\n                        </div>"]);

  cellbase_variantannotation_view_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function cellbase_variantannotation_view_templateObject6() {
  const data = cellbase_variantannotation_view_taggedTemplateLiteral(["\n                        <h4>Clinvar</h4>\n                        ", "\n                        \n                        \n                        <h4>Cosmic</h4>\n                        ", "\n                    "]);

  cellbase_variantannotation_view_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function cellbase_variantannotation_view_templateObject5() {
  const data = cellbase_variantannotation_view_taggedTemplateLiteral(["\n        <div id=\"", "Div\" class=\"col-xs-10\">\n            <div class=\"tab-content\">\n                <!--Summary Tab-->\n                <div role=\"tabpanel\" class=\"tab-pane active\" id=\"", "VariantAnnotationSummary\">\n                    <br>\n                    <cellbase-variant-annotation-summary .data=\"", "\"\n                                                         .consequenceTypes=\"", "\"\n                                                         .proteinSubstitutionScores=\"", "\">\n                    </cellbase-variant-annotation-summary>\n                </div>\n                <!--Consequence types Tab-->\n                <div role=\"tabpanel\" class=\"tab-pane\" id=\"", "VariantAnnotationConsequenceTypes\">\n                    <cellbase-annotation-consequencetype-grid .data=\"", "\"\n                                                              _prefix=\"", "annotationView\"\n                                                              .hashFragmentCredentials=\"", "\"\n                                                              .consequenceTypes=\"", "\">\n                    </cellbase-annotation-consequencetype-grid>\n                </div>\n                <!--Population frequency Tab-->\n                <div role=\"tabpanel\" class=\"tab-pane\" id=\"", "VariantAnnotationPopulationFrequencies\">\n                    <cellbase-population-frequency-grid .populationFrequencies=\"", "\">\n                    </cellbase-population-frequency-grid>\n                </div>\n                <!--Gene Trait Association Tab-->\n                <div role=\"tabpanel\" class=\"tab-pane\" id=\"", "VariantAnnotationGTA\">\n                    <table id=\"", "GTATable\" data-search=\"true\" data-show-columns=\"true\" data-pagination=\"true\"\n                           data-page-list=\"[10, 25, 50]\"\n                           data-show-pagination-switch=\"true\" data-show-export=\"true\" data-icons-prefix=\"fa\"\n                           data-icons=\"icons\">\n                    </table>\n                </div>\n                <!--Variant Trait Association-->\n                <div role=\"tabpanel\" class=\"tab-pane\" id=\"", "VariantAnnotationVTA\">\n                    ", "\n                    \n                </div>\n            </div>\n            \n        </div>"]);

  cellbase_variantannotation_view_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function cellbase_variantannotation_view_templateObject4() {
  const data = cellbase_variantannotation_view_taggedTemplateLiteral(["\n                <ul id=\"", "myTabs\" class=\"nav nav-tabs\" role=\"tablist\">\n                    <li role=\"presentation\" class=\"active\"><a href=\"#", "VariantAnnotationSummary\" role=\"tab\"\n                                                              data-toggle=\"tab\">Summary</a></li>\n                    <li role=\"presentation\"><a href=\"#", "VariantAnnotationConsequenceTypes\" role=\"tab\" data-toggle=\"tab\">Consequence\n                        Types (", ")</a></li>\n                    <li role=\"presentation\"><a href=\"#", "VariantAnnotationPopulationFrequencies\" role=\"tab\"\n                                               data-toggle=\"tab\">Population Frequencies (", ")</a>\n                    </li>\n                    <li role=\"presentation\"><a href=\"#", "VariantAnnotationVTA\" role=\"tab\" data-toggle=\"tab\">Variant Trait\n                        Association (", ")</a></li>\n                    <li role=\"presentation\"><a href=\"#", "VariantAnnotationGTA\" role=\"tab\" data-toggle=\"tab\">Gene Trait\n                        Association (", ")</a></li>\n                </ul>\n                "]);

  cellbase_variantannotation_view_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function cellbase_variantannotation_view_templateObject3() {
  const data = cellbase_variantannotation_view_taggedTemplateLiteral(["\n                <div class=\"col-xs-2\">\n                    <ul id=\"", "stackedPills\" class=\"nav nav-pills nav-stacked\" role=\"tablist\">\n                        <li role=\"presentation\" class=\"active\"><a href=\"#", "VariantAnnotationSummary\" role=\"tab\"\n                                                                  data-toggle=\"tab\">Summary</a></li>\n                        <li role=\"presentation\"><a href=\"#", "VariantAnnotationConsequenceTypes\" role=\"tab\"\n                                                   data-toggle=\"tab\">Consequence Types (", ")</a></li>\n                        <li role=\"presentation\"><a href=\"#", "VariantAnnotationPopulationFrequencies\" role=\"tab\"\n                                                   data-toggle=\"tab\">Population Frequencies\n                            (", ")</a></li>\n                        <li role=\"presentation\"><a href=\"#", "VariantAnnotationVTA\" role=\"tab\" data-toggle=\"tab\">Variant\n                            Trait Association (", ")</a></li>\n                        <li role=\"presentation\"><a href=\"#", "VariantAnnotationGTA\" role=\"tab\" data-toggle=\"tab\">Gene\n                            Trait Association (", ")</a></li>\n                    </ul>\n                </div>"]);

  cellbase_variantannotation_view_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function cellbase_variantannotation_view_templateObject2() {
  const data = cellbase_variantannotation_view_taggedTemplateLiteral(["\n            <div style=\"padding-top: 20px;padding-left: 20px\">\n        \n            <!-- This renders a vertical menu, this is controlled by the mode property -->\n            ", "\n        \n            <!-- This renders a horizontal menu, this is controlled by the mode property -->\n            ", "\n\n    ", "\n</div>\n        "]);

  cellbase_variantannotation_view_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function cellbase_variantannotation_view_templateObject() {
  const data = cellbase_variantannotation_view_taggedTemplateLiteral(["\n                        <div><h3>Please click on a variant to view annotations</h3></div>\n            "]);

  cellbase_variantannotation_view_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function cellbase_variantannotation_view_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/*
 * Copyright 2015-2016 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */






class cellbase_variantannotation_view_CellbaseVariantAnnotationView extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      cellbaseClient: {
        type: Object
      },
      data: {
        type: String,
        value: ""
      },
      assembly: {
        type: String
      },
      variantAnnotation: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      mode: {
        type: String
      },
      hashFragmentCredentials: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "cbvav-" + utils.randomString(6) + "_";
    window.icons = {
      refresh: "fa-refresh",
      columns: "fa-th",
      paginationSwitchDown: "fa-caret-square-o-down",
      paginationSwitchUp: "fa-caret-square-o-up"
    };
    this.data = "";
    this.mode = "horizontal";
    this.assembly = "GRCh37";
  }

  updated(_changedProperties) {
    if (_changedProperties.has("data")) {
      console.log("_variantChanged");

      this._variantChanged();
    }
  }

  attached() {
    if (this.mode === "vertical") {
      $("#" + this._prefix + "Div").addClass("col-xs-10");
    }
  }

  checkData(data) {
    return data !== "";
  }

  check(data) {
    return data.variantTraitAssociation !== null;
  }

  checkVertical(mode) {
    return this.mode === "vertical";
  }

  checkHorizontal(mode) {
    return this.mode === "horizontal";
  }

  checkClinvar(clinvar) {
    return typeof clinvar !== "undefined" && clinvar.length > 0;
  }

  checkCosmic(cosmic) {
    return typeof cosmic !== "undefined" && cosmic.length > 0;
  }

  _variantChanged() {
    const _this = this;

    if (typeof this.cellbaseClient !== "undefined" && utilsNew_UtilsNew.isNotEmpty(this.data) && !this.data.includes(" ")) {
      this.cellbaseClient.get("genomic", "variant", this.data, "annotation", {
        assembly: this.assembly
      }, {}).then(function (response) {
        _this.variantAnnotation = response.response[0].result[0];
        _this.numberConsequenceTypes = 0;
        _this.numberPopulationFrequencies = 0;
        _this.numberVTA = 0;
        _this.numberGTA = 0;

        if (_this.variantAnnotation.geneTraitAssociation != null) {
          _this.numberConsequenceTypes = _this.variantAnnotation.consequenceTypes.length;
          _this.numberPopulationFrequencies = utilsNew_UtilsNew.isNotEmptyArray(_this.variantAnnotation.populationFrequencies) ? _this.variantAnnotation.populationFrequencies.length : 0;
          _this.numberVTA = utilsNew_UtilsNew.isNotUndefinedOrNull(_this.variantAnnotation.traitAssociation) ? _this.variantAnnotation.traitAssociation.length : 0;
          _this.numberGTA = utilsNew_UtilsNew.isNotUndefinedOrNull(_this.variantAnnotation.geneTraitAssociation) ? _this.variantAnnotation.geneTraitAssociation.length : 0;
        } // Gene Trait Association definition


        $("#" + _this._prefix + "GTATable").bootstrapTable("destroy");
        $("#" + _this._prefix + "GTATable").bootstrapTable({
          data: _this.variantAnnotation.geneTraitAssociation,
          columns: [[{
            title: "id",
            field: "id"
          }, {
            title: "name",
            field: "name"
          }, {
            title: "hpo",
            field: "hpo"
          }, {
            title: "source",
            field: "source"
          }]]
        });

        _this.requestUpdate();
      });
    }
  }

  render() {
    if (this.data === undefined || this.data === "") {
      return lit_html_lit_html_html(cellbase_variantannotation_view_templateObject());
    } else {
      return lit_html_lit_html_html(cellbase_variantannotation_view_templateObject2(), this.checkVertical(this.mode) ? lit_html_lit_html_html(cellbase_variantannotation_view_templateObject3(), this._prefix, this._prefix, this._prefix, this.numberConsequenceTypes, this._prefix, this.numberPopulationFrequencies, this._prefix, this.numberVTA, this._prefix, this.numberGTA) : null, this.checkHorizontal(this.mode) ? lit_html_lit_html_html(cellbase_variantannotation_view_templateObject4(), this._prefix, this._prefix, this._prefix, this.numberConsequenceTypes, this._prefix, this.numberPopulationFrequencies, this._prefix, this.numberVTA, this._prefix, this.numberGTA) : null, this.variantAnnotation ? lit_html_lit_html_html(cellbase_variantannotation_view_templateObject5(), this._prefix, this._prefix, this.variantAnnotation, this.consequenceTypes, this.proteinSubstitutionScores, this._prefix, this.variantAnnotation.consequenceTypes, this._prefix, this.hashFragmentCredentials, this.consequenceTypes, this._prefix, this.variantAnnotation.populationFrequencies, this._prefix, this._prefix, this._prefix, this.check(this.variantAnnotation) ? lit_html_lit_html_html(cellbase_variantannotation_view_templateObject6(), this.variantAnnotation.variantTraitAssociation && this.variantAnnotation.variantTraitAssociation.clinvar ? lit_html_lit_html_html(cellbase_variantannotation_view_templateObject7(), this.variantAnnotation.variantTraitAssociation.clinvar.map(item => lit_html_lit_html_html(cellbase_variantannotation_view_templateObject8(), item.accession, item.clinicalSignificance, item.traits.map(trait => lit_html_lit_html_html(cellbase_variantannotation_view_templateObject9(), trait)), item.geneNames.map(geneName => lit_html_lit_html_html(cellbase_variantannotation_view_templateObject10(), geneName)), item.reviewStatus))) : lit_html_lit_html_html(cellbase_variantannotation_view_templateObject11()), this.variantAnnotation.variantTraitAssociation && this.variantAnnotation.variantTraitAssociation.cosmic ? lit_html_lit_html_html(cellbase_variantannotation_view_templateObject12(), this.variantAnnotation.variantTraitAssociation.cosmic.map(item => lit_html_lit_html_html(cellbase_variantannotation_view_templateObject13(), item.mutationId, item.primarySite, item.siteSubtype, item.primaryHistology, item.histologySubtype, item.sampleSource, item.tumourOrigin, item.geneName, item.mutationSomaticStatus))) : lit_html_lit_html_html(cellbase_variantannotation_view_templateObject14())) : lit_html_lit_html_html(cellbase_variantannotation_view_templateObject15())) : null);
    }
  }

}
customElements.define("cellbase-variantannotation-view", cellbase_variantannotation_view_CellbaseVariantAnnotationView);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/opencga-variant-file-metrics.js
function opencga_variant_file_metrics_templateObject4() {
  const data = opencga_variant_file_metrics_taggedTemplateLiteral(["\n                                <td>", "</td>\n                            "]);

  opencga_variant_file_metrics_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_variant_file_metrics_templateObject3() {
  const data = opencga_variant_file_metrics_taggedTemplateLiteral(["\n                        <tr id=\"", "\" class=\"file-metrics-table-", "\">\n                            <td><span style=\"font-weight: bold\">", "</span></td>\n                            ", "                            \n                        </tr>\n                    "]);

  opencga_variant_file_metrics_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_variant_file_metrics_templateObject2() {
  const data = opencga_variant_file_metrics_taggedTemplateLiteral(["\n                            <th>", "</th>\n                        "]);

  opencga_variant_file_metrics_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_variant_file_metrics_templateObject() {
  const data = opencga_variant_file_metrics_taggedTemplateLiteral(["\n        <style include=\"jso-styles\"></style>\n\n        <div id=\"", "FileMetrics\">\n            <div class=\"col-md-10 col-md-offset-1\" style=\"padding-top: 20px;overflow: auto;\">\n                <table class=\"table table-hover\">\n                    <thead>\n                    <tr>\n                        <th>VCF Attributes</th>\n                        ", "\n                    </tr>\n                    </thead>\n                    <tbody id=\"", "TableTBody\">\n                    ", "\n                    </tbody>\n                </table>\n            </div>\n        </div>\n        "]);

  opencga_variant_file_metrics_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_variant_file_metrics_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */



class opencga_variant_file_metrics_OpencgaVariantFileMetrics extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      variant: {
        type: Object
      },
      clinicalAnalysis: {
        type: Object
      },
      // active: {
      //     type: Boolean,
      //     value: false,
      // },
      config: {
        type: Object
      }
    };
  } // This is executed before the actual Polymer properties exist


  _init() {
    // All id fields in the template must start with prefix, this allows components to be instantiated more than once
    this._prefix = "ovfm" + utils.randomString(6) + "_";
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession")) {
      this.propertyObserver();
    }

    if (changedProperties.has("variant")) {
      this.propertyObserver();
    }

    if (changedProperties.has("config")) {
      this.propertyObserver();
    }
  }

  propertyObserver() {
    this.renderTable();
  }

  renderTable() {
    if (utilsNew_UtilsNew.isUndefinedOrNull(this.variant) || utilsNew_UtilsNew.isEmptyArray(this.variant.studies)) {
      return [];
    } // We take the first study by default. Two possible improvements are:
    // 1. we could pass a new studyId parameter to choose the study
    // 2. render all of the studies in different tables or the same table with two-level columns


    const files = this.variant.studies[0].files;
    const attributesSet = new Set(); // We find all the existing attributes

    for (const file of files) {
      for (const attr of Object.keys(file.attributes)) {
        if (attr !== "QUAL" && attr !== "FILTER") {
          attributesSet.add(attr);
        }
      }
    }

    const attributesArray = Array.from(attributesSet.values()).sort();
    attributesArray.unshift("QUAL", "FILTER"); // We store the values as: result = [{name: "AC", values: [1, 2, 3, 4]}]

    const result = [];

    for (const attr of attributesArray) {
      const tmp = {
        name: attr,
        values: []
      };

      for (const file of files) {
        tmp.values.push(file.attributes[attr]);
      }

      result.push(tmp);
    }

    this._attributes = result; // return result;
  }

  getDefaultConfig() {
    return {
      property: "example property"
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_variant_file_metrics_templateObject(), this._prefix, this.variant.studies[0].files && this.variant.studies[0].files.length ? this.variant.studies[0].files.map(member => lit_html_lit_html_html(opencga_variant_file_metrics_templateObject2(), member.fileId)) : null, this._prefix, this._attributes && this._attributes.length ? this._attributes.map(attribute => lit_html_lit_html_html(opencga_variant_file_metrics_templateObject3(), attribute.name, attribute.name, attribute.name, attribute.values && attribute.values.length ? attribute.values.map(attr => lit_html_lit_html_html(opencga_variant_file_metrics_templateObject4(), attr)) : null)) : null);
  }

}
customElements.define("opencga-variant-file-metrics", opencga_variant_file_metrics_OpencgaVariantFileMetrics);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/opencga-variant-interpretation-detail.js
function opencga_variant_interpretation_detail_templateObject5() {
  const data = opencga_variant_interpretation_detail_taggedTemplateLiteral(["\n                            <li role=\"presentation\" class=\"\">\n                                <a href=\"#", "", "\" role=\"tab\" data-toggle=\"tab\" data-id=\"", "\"\n                                   class=\"browser-variant-tab-title\" @click=\"", "\">", "</a>\n                            </li>\n                        "]);

  opencga_variant_interpretation_detail_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_detail_templateObject4() {
  const data = opencga_variant_interpretation_detail_taggedTemplateLiteral(["\n                            <li role=\"presentation\" class=\"active\">\n                                <a href=\"#", "", "\" role=\"tab\" data-toggle=\"tab\" data-id=\"", "\"\n                                   class=\"browser-variant-tab-title\" @click=\"", "\">", "</a>\n                            </li>\n                        "]);

  opencga_variant_interpretation_detail_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_detail_templateObject3() {
  const data = opencga_variant_interpretation_detail_taggedTemplateLiteral(["\n                        ", "\n                    "]);

  opencga_variant_interpretation_detail_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_detail_templateObject2() {
  const data = opencga_variant_interpretation_detail_taggedTemplateLiteral(["\n        <div style=\"padding-top: 20px\">\n            <h3>Variant: ", "</h3>\n\n            <div style=\"padding-top: 20px\">\n                <!-- Dynamically create the Detail Tabs from Browser config -->\n                <ul id=\"", "ViewTabs\" class=\"nav nav-tabs\" role=\"tablist\">\n                    \n                    ", "\n                    \n                </ul>\n\n<!--                style=\"height: 680px\"-->\n                <div class=\"tab-content\">\n<!--                    &lt;!&ndash; Annotation Tab &ndash;&gt;-->\n<!--                    <div id=\"", "variantReview\" role=\"tabpanel\" class=\"tab-pane\">-->\n<!--                        <div style=\"width: 75%;padding-top: 8px\">-->\n<!--                            <opencga-interpretation-variant-review opencga-session=\"{{opencgaSession}}\"-->\n<!--                                                                   variant=\"{{variant}}\">-->\n<!--                            </opencga-interpretation-variant-review>-->\n<!--                        </div>-->\n<!--                    </div>-->\n\n                    <!-- Annotation Tab -->\n                    <div id=\"", "annotation\" role=\"tabpanel\" class=\"tab-pane active\">\n                        <div style=\"width: 75%;padding-top: 8px\">\n                            <cellbase-variantannotation-view .data=\"", "\"\n                                                             .assembly=\"", "\"\n                                                             _prefix=\"", "\"\n                                                             .cellbaseClient=\"", "\"\n                                                             mode=\"vertical\"\n                                                             .consequenceTypes=\"", "\"\n                                                             .proteinSubstitutionScores=\"", "\"\n                                                             style=\"font-size: 12px\">\n                            </cellbase-variantannotation-view>\n                        </div>\n                    </div>\n\n                    <!-- Cohort Stats Tab -->\n                    <div id=\"", "fileMetrics\" role=\"tabpanel\" class=\"tab-pane\">\n                        <div style=\"width: 75%;padding-top: 8px\">\n                            <opencga-variant-file-metrics .opencgaSession=\"", "\"\n                                                          .variant=\"", "\"\n                                                          .clinicalAnalysis=\"", "\"\n                            </opencga-variant-file-metrics>\n                        </div>\n                    </div>\n\n                    <!-- Cohort Stats Tab -->\n                    <div id=\"", "cohortStats\" role=\"tabpanel\" class=\"tab-pane\">\n                        <div style=\"width: 75%;padding-top: 8px\">\n                            <opencga-variant-cohort-stats .opencgaSession=\"", "\"\n                                                          .variant=\"", "\"\n                                                          .active=\"", "\">\n                            </opencga-variant-cohort-stats>\n                        </div>\n                    </div>\n\n                    <!-- Samples Tab -->\n                    <div id=\"", "samples\" role=\"tabpanel\" class=\"tab-pane\">\n                        <div style=\"width: 75%;padding-top: 8px\">\n                            <opencga-variant-samples .opencgaSession=\"", "\"\n                                                     .variant=\"", "\"\n                                                     .active=\"", "\">\n                            </opencga-variant-samples>\n                        </div>\n                    </div>\n\n                    <!-- Beacon Network Tab-->\n                    <div id=\"", "beacon\" role=\"tabpanel\" class=\"tab-pane\">\n                        <div style=\"width: 75%;padding-top: 8px\">\n                            <variant-beacon-network .variant=\"", "\" .clear=\"", "\" .config=\"", "\">\n                            </variant-beacon-network>\n                        </div>\n                    </div>\n\n                    <!-- Example Template Tab-->\n                    <div id=\"", "template\" role=\"tabpanel\" class=\"tab-pane\">\n                        <div style=\"width: 75%;padding-top: 8px\">\n                            <opencga-variant-detail-template .opencgaSession=\"", "\"\n                                                             .variant=\"", "\"\n                                                             .active=\"", "\">\n                            </opencga-variant-detail-template>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        "]);

  opencga_variant_interpretation_detail_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_detail_templateObject() {
  const data = opencga_variant_interpretation_detail_taggedTemplateLiteral(["\n        <style include=\"jso-styles\"></style>\n\n        ", "\n        \n        "]);

  opencga_variant_interpretation_detail_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_detail_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */







class opencga_variant_interpretation_detail_OpencgaVariantInterpretationDetail extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      clinicalAnalysis: {
        type: Object
      },
      variant: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    // All id fields in the template must start with prefix, this allows components to be instantiated more than once
    this._prefix = "oivd" + utils.randomString(6); // Initially we set the default config, this will be overridden if 'config' is passed

    this._config = this.getDefaultConfig();
    this.detailActiveTabs = {};
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession") || changedProperties.has("variant") || changedProperties.has("config")) {
      this.propertyObserver();
    }
  }

  propertyObserver() {
    // With each property change we must updated config and create the columns again. No extra checks are needed.
    this._config = Object.assign(this.getDefaultConfig(), this.config);

    if (utilsNew_UtilsNew.isNotEmpty(this.variant)) {
      this._variantId = "".concat(this.variant.chromosome, ":").concat(this.variant.start, ":").concat(this.variant.reference, ":").concat(this.variant.alternate);
    }
  }

  checkVariant(variant) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(variant)) {
      return variant.id.startsWith("rs") || variant.id.split(":").length > 2;
    } else {
      return false;
    }
  }

  _changeBottomTab(e) {
    const _activeTabs = {};

    for (const detail of this.config) {
      _activeTabs[detail.id] = detail.id === e.currentTarget.dataset.id;
    }

    this.detailActiveTabs = _activeTabs;
  }

  getDefaultConfig() {
    return {};
  }

  render() {
    return lit_html_lit_html_html(opencga_variant_interpretation_detail_templateObject(), this.checkVariant(this.variant) ? lit_html_lit_html_html(opencga_variant_interpretation_detail_templateObject2(), this.variant.id, this._prefix, this.config && this.config.length ? this.config.map(item => lit_html_lit_html_html(opencga_variant_interpretation_detail_templateObject3(), this.active ? lit_html_lit_html_html(opencga_variant_interpretation_detail_templateObject4(), this._prefix, item.id, item.id, this._changeBottomTab, item.title) : lit_html_lit_html_html(opencga_variant_interpretation_detail_templateObject5(), this._prefix, item.id, item.id, this._changeBottomTab, item.title))) : null, this._prefix, this._prefix, this._variantId, this.opencgaSession.project.organism.assembly, this._prefix, this.cellbaseClient, this.consequenceTypes, this.proteinSubstitutionScores, this._prefix, this.opencgaSession, this.variant, this.clinicalAnalysis, this._prefix, this.opencgaSession, this.variant.id, this.detailActiveTabs.cohortStats, this._prefix, this.opencgaSession, this.variant.id, this.detailActiveTabs.samples, this._prefix, this.variant.id, this.variant.id, this.beaconConfig, this._prefix, this.opencgaSession, this.variant.id, this.detailActiveTabs.template) : null);
  }

}
customElements.define("opencga-variant-interpretation-detail", opencga_variant_interpretation_detail_OpencgaVariantInterpretationDetail);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/clinical/clinical-interpretation-view.js
function clinical_interpretation_view_templateObject9() {
  const data = clinical_interpretation_view_taggedTemplateLiteral(["\n                                                    <td>", "</td>\n                                                "]);

  clinical_interpretation_view_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function clinical_interpretation_view_templateObject8() {
  const data = clinical_interpretation_view_taggedTemplateLiteral(["\n                                            <tr id=\"", "\" class=\"file-metrics-table-", "\">\n                                                <td><span style=\"font-weight: bold\">", "</span></td>\n                                                ", "\n                                            </tr>  \n                                        "]);

  clinical_interpretation_view_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function clinical_interpretation_view_templateObject7() {
  const data = clinical_interpretation_view_taggedTemplateLiteral(["\n                                                <th>", "</th>\n                                            "]);

  clinical_interpretation_view_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function clinical_interpretation_view_templateObject6() {
  const data = clinical_interpretation_view_taggedTemplateLiteral(["\n                                        <div class=\"btn-group\">\n                                            <!--<button type=\"button\" class=\"btn btn-primary\">-->\n                                            <!--<i class=\"fa fa-pencil\" aria-hidden=\"true\"></i>&nbsp;&nbsp;Update-->\n                                            <!--</button>-->\n                                            <!--<button type=\"button\" class=\"btn btn-primary\">-->\n                                            <!--<i class=\"fa fa-comments-o\" aria-hidden=\"true\"></i>&nbsp;&nbsp;Review Case-->\n                                            <!--</button>-->\n                                            <button type=\"button\" class=\"btn btn-primary\" @click=\"", "\">\n                                                <i class=\"fa fa-file-text-o\" aria-hidden=\"true\"></i>&nbsp;&nbsp;Create\n                                                Report&nbsp;&nbsp;<span class=\"badge\" style=\"font-size: 75%\">", "</span>\n                                            </button>\n                                        </div>\n                                    "]);

  clinical_interpretation_view_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function clinical_interpretation_view_templateObject5() {
  const data = clinical_interpretation_view_taggedTemplateLiteral(["\n                                                        <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                            <label class=\"col-md-4\">", ":</label>\n                                                            <span class=\"col-md-8\">", "</span>\n                                                        </div>\n                                                    "]);

  clinical_interpretation_view_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function clinical_interpretation_view_templateObject4() {
  const data = clinical_interpretation_view_taggedTemplateLiteral(["\n                                                                    <span>", " (v", ")</span>\n                                                                "]);

  clinical_interpretation_view_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function clinical_interpretation_view_templateObject3() {
  const data = clinical_interpretation_view_taggedTemplateLiteral(["\n                                                                    <span>", " (<a href=\"http://compbio.charite.de/hpoweb/showterm?id=", "\" target=\"_blank\">", "</a>)</span>\n                                                                    <br>\n                                                                "]);

  clinical_interpretation_view_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function clinical_interpretation_view_templateObject2() {
  const data = clinical_interpretation_view_taggedTemplateLiteral(["\n                        <!--<h2 style=\"border-bottom-width: 1px;border-bottom-style: solid;border-bottom-color: #ddd\">-->\n                        <h2 style=\"\">\n                            Interpretation Analysis: ", "\n                        </h2>\n                        <hr style=\"margin-top: 5px\">\n    \n    \n                        <div class=\"panel-group\" id=\"accordion\" role=\"tablist\" aria-multiselectable=\"true\">\n                            <div class=\"panel panel-default\">\n                                <div class=\"panel-heading\" role=\"tab\" id=\"headingTwo\">\n                                    <h4 class=\"panel-title\">\n                                        <a role=\"button\" data-toggle=\"collapse\" data-parent=\"#accordion\"\n                                           href=\"#collapseTwo\" aria-expanded=\"true\" aria-controls=\"collapseTwo\"\n                                           @click=\"", "\">\n                                            <i id=\"", "SummaryCollapseIcon\" class=\"fa fa-minus-square-o\"\n                                               aria-hidden=\"true\"></i> Summary\n                                        </a>\n                                    </h4>\n                                </div>\n                                <div id=\"collapseTwo\" class=\"panel-collapse collapse in\" role=\"tabpanel\"\n                                     aria-labelledby=\"headingTwo\">\n                                    <div class=\"panel-body\">\n                                        <div class=\"col-md-12\">\n                                            <div class=\"col-md-4\">\n                                                <label>Sample</label>\n                                                <hr style=\"margin: 2px 0px;border-top: 2px solid #eee\">\n                                                <form class=\"form-horizontal\">\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Name:</label>\n                                                        <span class=\"col-md-8\">\n                                                                ", "\n                                                            </span>\n                                                    </div>\n                                                    <!--<div class=\"form-group\" style=\"margin: 0px 2px\">-->\n                                                    <!--<label class=\"col-md-4\">File:</label>-->\n                                                    <!--<span class=\"col-md-8\">", "</span>-->\n                                                    <!--</div>-->\n                                                    <!--<div class=\"form-group\" style=\"margin: 0px 2px\">-->\n                                                    <!--<label class=\"col-md-4\">Genome Assembly:</label>-->\n                                                    <!--<span class=\"col-md-8\">", "</span>-->\n                                                    <!--</div>-->\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Somatic:</label>\n                                                        <span class=\"col-md-6\">", "</span>\n                                                    </div>\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Phenotypes:</label>\n                                                        <span class=\"col-md-8\">\n                                                                <template is=\"dom-repeat\"\n                                                                          items=\"", "\">\n                                                                    <span>", " (<a\n                                                                            href=\"http://compbio.charite.de/hpoweb/showterm?id=", "\"\n                                                                            target=\"_blank\">", "</a>)</span>\n                                                                    <br>\n                                                                </template>\n                                                            </span>\n                                                    </div>\n                                                    <!--<div class=\"form-group\" style=\"margin: 0px 2px\">-->\n                                                    <!--<label class=\"col-md-4\">Description:</label>-->\n                                                    <!--<span class=\"col-md-8\">", "</span>-->\n                                                    <!--</div>-->\n                                                </form>\n                                            </div>\n                                            <div class=\"col-md-4\">\n                                                <label>Subject</label>\n                                                <hr style=\"margin: 2px 0px;border-top: 2px solid #eee\">\n                                                <form class=\"form-horizontal\">\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Name:</label>\n                                                        <span class=\"col-md-8\">\n                                                                ", "\n                                                            </span>\n                                                    </div>\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Sex (karyotype):</label>\n                                                        <span class=\"col-md-8\">", " &nbsp;&nbsp; (", ")</span>\n                                                    </div>\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Date of Birth:</label>\n                                                        <span class=\"col-md-8\">", " &nbsp;&nbsp; (", ")</span>\n                                                    </div>\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Parental Consanguinity:</label>\n                                                        <span class=\"col-md-8\">", "</span>\n                                                    </div>\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Phenotypes:</label>\n                                                        <span class=\"col-md-8\">\n                                                                <template is=\"dom-repeat\"\n                                                                          items=\"", "\">\n                                                                    <span>", " (<a\n                                                                            href=\"http://compbio.charite.de/hpoweb/showterm?id=", "\"\n                                                                            target=\"_blank\">", "</a>)</span>\n                                                                    <br>\n                                                                </template>\n                                                            </span>\n                                                    </div>\n                                                    <!--<div class=\"form-group\" style=\"margin: 0px 2px\">-->\n                                                    <!--<label class=\"col-md-4\">Description:</label>-->\n                                                    <!--<span class=\"col-md-8\">", "</span>-->\n                                                    <!--</div>-->\n                                                </form>\n                                            </div>\n                                            <div class=\"col-md-4\">\n                                                <label>Family</label>\n                                                <hr style=\"margin: 2px 0px;border-top: 2px solid #eee\">\n                                                <form class=\"form-horizontal\">\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Name:</label>\n                                                        <span class=\"col-md-8\">", "</span>\n                                                    </div>\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Phenotypes:</label>\n                                                        <span class=\"col-md-8\">\n                                                                ", "\n                                                            </span>\n                                                    </div>\n    \n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Pedigree:</label>\n                                                        <span class=\"col-md-8\">\n                                                                 <div class=\"col-md-12\">\n                                                                     <div id=\"", "PedigreeView\"></div>\n                                                                </div>\n                                                            <!--<br>-->\n                                                            <!--\n                                                                                                                        <span>Click <a href=\"\" style=\"font-weight: bold\">here</a> for more info</span>\n                                                            -->\n                                                            </span>\n                                                    </div>\n                                                </form>\n                                            </div>\n                                        </div>\n    \n                                        <div class=\"col-md-12\">\n                                            <br>\n                                            <div class=\"col-md-4\">\n                                                <label>Analysis</label>\n                                                <hr style=\"margin: 2px 0px;border-top: 2px solid #eee\">\n                                                <form class=\"form-horizontal\">\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Name (date):</label>\n                                                        <span class=\"col-md-8\">", " &nbsp; (", ")</span>\n                                                    </div>\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Type:</label>\n                                                        <span class=\"col-md-8\">", "</span>\n                                                    </div>\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Analyst:</label>\n                                                        <span class=\"col-md-8\">", " (<a>", "</a>)</span>\n                                                    </div>\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Description:</label>\n                                                        <span class=\"col-md-8\">", "</span>\n                                                    </div>\n                                                </form>\n                                            </div>\n                                            <div class=\"col-md-4\">\n                                                <label>Software</label>\n                                                <hr style=\"margin: 2px 0px;border-top: 2px solid #eee\">\n                                                <form class=\"form-horizontal\">\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Name:</label>\n                                                        <span class=\"col-md-8\">\n                                                                ", " (<a\n                                                                href=\"", "\"\n                                                                target=\"_blank\"><i class=\"fa fa-external-link\"\n                                                                                   aria-hidden=\"true\"></i> website</a>)\n                                                            </span>\n                                                    </div>\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Version:</label>\n                                                        <span class=\"col-md-8\">\n                                                                ", " (<a\n                                                                href=\"", "/commit/", "\"\n                                                                target=\"_blank\"><i class=\"fa fa-external-link\" aria-hidden=\"true\"></i> commit</a>)\n                                                            </span>\n                                                    </div>\n                                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                                        <label class=\"col-md-4\">Dependencies:</label>\n                                                        <span class=\"col-md-8\">\n                                                                ", "\n                                                            </span>\n                                                    </div>\n                                                </form>\n                                            </div>\n                                            <div class=\"col-md-4\">\n                                                <label>Variant Filters</label>\n                                                <hr style=\"margin: 2px 0px;border-top: 2px solid #eee\">\n                                                <form class=\"form-horizontal\">\n                                                    ", "\n                                                </form>\n                                            </div>\n                                        </div>\n                                    </div>\n    \n                                </div>\n                            </div>\n                        </div>\n                    "]);

  clinical_interpretation_view_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function clinical_interpretation_view_templateObject() {
  const data = clinical_interpretation_view_taggedTemplateLiteral(["<template>\n    <style include=\"jso-styles\">\n        .clinical-bottom-tab-title {\n            font-size: 115%;\n            font-weight: bold;\n        }\n\n        .file-metrics-table-FILTER {\n            border-bottom: 2px solid #ccc;\n        }\n    </style>\n\n\n    <div class=\"container-fluid\" id=\"", "container-interpretation-view\">\n        <div class=\"row\">\n\n            <div id=\"", "mainIntepretation\" class=\"\">\n\n                ", "\n                \n\n\n                <div style=\"padding-top: 5px\">\n                    <h2 style=\"border-bottom-width: 1px;border-bottom-style: solid;border-bottom-color: #ddd\">Reported\n                        Variants</h2>\n\n                    <div class=\"panell panel--default\">\n                        <div class=\"panel--body\">\n                            <!--<div class=\"row\">-->\n                            <div class=\"col-md-12\" style=\"padding: 5px 0px 15px 0px\">\n                                <div class=\"btn-toolbar\" role=\"toolbar\" aria-label=\"...\" style=\"float: right\">\n                                    <!--<div class=\"btn-group btn-group-sm\" role=\"group\" aria-label=\"...\" style=\"padding: 10px 0px\">-->\n                                    <!--<button type=\"button\" class=\"btn btn-default btn-warning gene-ct-buttons active\" on-click=\"updateQuery\">-->\n                                    <!--All-->\n                                    <!--</button>-->\n                                    <!--<button type=\"button\" class=\"btn btn-default btn-warning gene-ct-buttons\" on-click=\"updateQuery\">-->\n                                    <!--SNV-->\n                                    <!--</button>-->\n                                    <!--<button type=\"button\" class=\"btn btn-default btn-warning gene-ct-buttons\" on-click=\"updateQuery\">-->\n                                    <!--INDEL-->\n                                    <!--</button>-->\n                                    <!--<button type=\"button\" class=\"btn btn-default btn-warning gene-ct-buttons\" on-click=\"updateQuery\">-->\n                                    <!--SV-->\n                                    <!--</button>-->\n                                    <!--</div>-->\n\n                                    <!--<div class=\"btn-group btn-group-sm\" role=\"group\" aria-label=\"...\" style=\"padding: 10px 0px\">-->\n                                    <!--<button type=\"button\" class=\"btn btn-default btn-warning gene-ct-buttons active\" on-click=\"updateQuery\">-->\n                                    <!--All-->\n                                    <!--</button>-->\n                                    <!--<button type=\"button\" class=\"btn btn-default btn-warning gene-ct-buttons\" on-click=\"updateQuery\">-->\n                                    <!--Missense-->\n                                    <!--</button>-->\n                                    <!--<button type=\"button\" class=\"btn btn-default btn-warning gene-ct-buttons\" on-click=\"updateQuery\">-->\n                                    <!--LoF-->\n                                    <!--</button>-->\n                                    <!--</div>-->\n\n                                    <!--<div class=\"btn-group btn-group-sm\" role=\"group\" aria-label=\"...\" style=\"padding: 10px 0px\">-->\n                                    <!--<button type=\"button\" class=\"btn btn-default btn-warning gene-ct-buttons active\" on-click=\"updateQuery\">-->\n                                    <!--All-->\n                                    <!--</button>-->\n                                    <!--<button type=\"button\" class=\"btn btn-default btn-warning gene-ct-buttons\" on-click=\"updateQuery\">-->\n                                    <!--Tier 1-->\n                                    <!--</button>-->\n                                    <!--<button type=\"button\" class=\"btn btn-default btn-warning gene-ct-buttons\" on-click=\"updateQuery\">-->\n                                    <!--Tier 2-->\n                                    <!--</button>-->\n                                    <!--<button type=\"button\" class=\"btn btn-default btn-warning gene-ct-buttons\" on-click=\"updateQuery\">-->\n                                    <!--Tier 3-->\n                                    <!--</button>-->\n                                    <!--</div>-->\n                                </div>\n                            </div>\n                            <!--</div>-->\n                        </div>\n                    </div>\n\n                    <!-- GRID HEADER TOOLBAR -->\n                    <div class=\"col-md-15\" style=\"padding: 12px 0px 0px 0px\">\n                        <div id=\"", "ToolbarLeft\" class=\"col-md-6\" style=\"padding: 15px 0px 0px 0px\">\n                                    <span style=\"padding: 0px 0px 0px 0px\">\n                                        Showing <label>", "-", "</label> of <label>", "</label> variants\n                                    </span>\n                        </div>\n\n                        <div class=\"col-md-6\" style=\"padding: 0px\">\n                            <div class=\"form-inline\">\n                                <div class=\"form-group\" style=\"padding: 0px;float: right\">\n                                    <div class=\"input-group\">\n                                        <!--<input type=\"text\" class=\"form-control\" name=\"date\" size=\"20\" placeholder=\"Search for...\">-->\n                                        <!--<span class=\"input-group-btn\">-->\n                                        <!--<button type=\"button\" class=\"btn btn-default\"><i class=\"fa fa-search\" aria-hidden=\"true\"></i></button>-->\n                                        <!--</span>-->\n                                    </div>\n\n                                    ", "\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div id=\"", "GridTableDiv\">\n                        <table id=\"", "mainTable\" data-pagination=\"true\" data-page-list=\"[5, 10, 25]\"\n                               data-show-export=\"true\" data-detail-view=\"true\" data-detail-formatter=\"detailFormatter\">\n                        </table>\n                    </div>\n                </div>\n\n\n                <div class=\"\" style=\"padding-top: 10px\">\n                    <h3>Variant Detail View: ", "</h3>\n                    <!-- Bottom TABs -->\n                    <div style=\"padding-top: 20px\">\n                        <ul id=\"", "ViewTabs\" class=\"nav nav-tabs\" role=\"tablist\">\n                            <li role=\"presentation\" class=\"active\">\n                                <a href=\"#", "Annotation\" role=\"tab\" data-toggle=\"tab\"\n                                   class=\"clinical-bottom-tab-title\">\n                                    Current Annotation\n                                </a>\n                            </li>\n                            <!--<li role=\"presentation\">-->\n                            <!--<a href=\"#", "Genotype\" role=\"tab\" data-toggle=\"tab\" class=\"clinical-bottom-tab-title\">-->\n                            <!--Genotype Stats-->\n                            <!--</a>-->\n                            <!--</li>-->\n                            <li role=\"presentation\">\n                                <a href=\"#", "FileMetrics\" role=\"tab\" data-toggle=\"tab\"\n                                   class=\"clinical-bottom-tab-title\">\n                                    File Metrics\n                                </a>\n                            </li>\n                            <li role=\"presentation\">\n                                <a href=\"#", "BeaconNetwork\" role=\"tab\" data-toggle=\"tab\"\n                                   class=\"clinical-bottom-tab-title\">\n                                    Beacon Network\n                                </a>\n                            </li>\n                            <li role=\"presentation\" @click=\"", "\">\n                                <a href=\"#", "GenomeBrowser\" role=\"tab\" data-toggle=\"tab\"\n                                   class=\"clinical-bottom-tab-title\">\n                                    Genome Browser\n                                </a>\n                            </li>\n                        </ul>\n\n                        <div class=\"tab-content\" style=\"height: 680px\">\n                            <!-- Current Annotation Tab -->\n                            <div role=\"tabpanel\" class=\"tab-pane active\" id=\"", "Annotation\">\n                                <cellbase-variantannotation-view _prefix=\"", "\"\n                                                                mode=\"vertical\"\n                                                                .data=\"", "\"\n                                                                .cellbaseClient=\"", "\"\n                                                                .assembly=\"", "\"\n                                                                .hashFragmentCredentials=\"", "\"\n                                                                .consequenceTypes=\"", "\"\n                                                                .proteinSubstitutionScores=\"", "\"\n                                                                style=\"font-size: 12px\">\n                                </cellbase-variantannotation-view>\n                            </div>\n\n                            <!--&lt;!&ndash; Genotypes & Files Tab &ndash;&gt;-->\n                            <!--<div id=\"", "Genotype\" role=\"tabpanel\" class=\"tab-pane\">-->\n                            <!--Under construction.-->\n                            <!--</div>-->\n\n                            <!-- File Metrics Tab -->\n                            <div id=\"", "FileMetrics\" role=\"tabpanel\" class=\"tab-pane\">\n                                <div class=\"col-md-8 col-md-offset-1\" style=\"padding-top: 20px;overflow: auto;\">\n                                    <table class=\"table table-hover\">\n                                        <thead>\n                                        <tr>\n                                            <th>VCF Attribute</th>\n                                            ", "\n                                        </tr>\n                                        </thead>\n                                        <tbody id=\"", "TableTBody\">\n                                        ", "\n                                        </tbody>\n                                    </table>\n                                </div>\n                            </div>\n\n                            <!--Beacon network-->\n                            <div role=\"tabpanel\" class=\"tab-pane\" id=\"", "BeaconNetwork\">\n                                <br>\n                                <button class=\"btn btn-primary\" type=\"button\" @click=\"", "\">Search Beacon\n                                    Network\n                                </button>\n                                <a data-toggle=\"tooltip\"\n                                   title=\"Beacon Network is a search engine across the world's public beacons. You can find it here - https://beacon-network.org/#/\">\n                                    <i class=\"fa fa-info-circle\" aria-hidden=\"true\"></i>\n                                </a>\n                                <br>\n                                <br>\n                                <variant-beacon-network .clear=\"", "\" .variant=\"", "\"></variant-beacon-network>\n                            </div>\n\n                            <!-- Genome Browser -->\n                            <div role=\"tabpanel\" class=\"tab-pane\" id=\"", "GenomeBrowser\">\n                                <div class=\"\" style=\"padding: 0px 5px\">\n                                    <!--<variant-genome-browser project=\"", "\" study=\"", "\" samples=\"", "\" active=\"", "\"-->\n                                    <!--opencga-client=\"", "\" cellbase-client=\"", "\" region=\"", "\">-->\n                                    <!--</variant-genome-browser>-->\n                                    <genome-browser .cellbaseclient=\"", "\"\n                                                    .opencgaClient=\"", "\"\n                                                    .region=\"", "\"\n                                                    .opencgaSession=\"", "\"\n                                                    .active=\"", "\"\n                                                    .settings=\"", "\">\n                                    </genome-browser>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n            </div>\n        </div>\n    </div>\n</template>\n</template>\n        "]);

  clinical_interpretation_view_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function clinical_interpretation_view_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
// todo check functionality (there is a _render() method and explicit calls to render())








class clinical_interpretation_view_ClinicalInterpretationView extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      opencgaClient: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      interpretation: {
        type: Object
      },
      interpretationId: {
        type: String
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "clinical-interpretation-" + utils.randomString(6) + "_";
    this.tracks = {
      sequence: {
        type: "sequence"
      },
      gene: {
        type: "gene"
      }
    };
    this.config = {
      summary: true,
      toolbar: true,
      detail: true
    };
  }

  updated(changedProperties) {
    if (changedProperties.has("interpretationId")) {
      this.onChangeId();
    }

    if (changedProperties.has("opencgaSession")) {
      this.projectStudyObtained();
    }
  }

  ready() {
    super.ready();
    this._summaryCollapsed = false;
    this.variantObj = {};
    this.reportVariants = [];
  }

  connectedCallback() {
    super.connectedCallback();
    PolymerUtils_PolymerUtils.hide(this._prefix + "container-interpretation-view");

    this._render();
  }

  _render() {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.interpretation)) {
      PolymerUtils_PolymerUtils.show(this._prefix + "container-interpretation-view");
      this.render();
      this.pedigreeRender();
      const table = $("#" + this._prefix + "mainTable");

      const _this = this;

      table.on("expand-row.bs.table", function (e, index, row, $detail) {
        const res = _this.detailFormatter(index, row);

        $detail.html(res);
        console.log("row expanded", e, index);
      }); // Add click event to "Add to Report" button

      PolymerUtils_PolymerUtils.querySelectorAll(".interpretation-add-to-report").forEach(elem => elem.addEventListener("click", function (e) {
        _this.onAddVariantToReport(e.target.dataset.variantId);

        e.stopPropagation();
      }, true));
    }
  }

  _summaryOnClick() {
    if (this._summaryCollapsed) {
      $("#" + this._prefix + "SummaryCollapseIcon").removeClass("fa-plus-square-o").addClass("fa-minus-square-o");
    } else {
      $("#" + this._prefix + "SummaryCollapseIcon").removeClass("fa-minus-square-o").addClass("fa-plus-square-o");
    }

    this._summaryCollapsed = !this._summaryCollapsed;
  }

  onCreateReport() {
    // Make a deep copy object
    const copy = JSON.parse(JSON.stringify(this.interpretation)); // Find all reportedVariant object from this.reportVariants

    const _reportVariants = [];

    for (const variantId of this.reportVariants) {
      for (const reportedVariant of this.interpretation.reportedVariants) {
        if (variantId === reportedVariant.id) {
          _reportVariants.push(reportedVariant);

          break;
        }
      }
    }

    copy.reportedVariants = _reportVariants; // Fire an event with the new interpretation data model

    this.dispatchEvent(new CustomEvent("createreport", {
      detail: {
        interpretation: copy
      }
    }));
    this.reportVariants = [];

    this._render();
  }

  onAddVariantToReport(variantId) {
    const _reportVariants = this.reportVariants;

    if (!_reportVariants.includes(variantId)) {
      PolymerUtils_PolymerUtils.getElementById("v" + variantId + "ButtonText").innerHTML = "Remove from Report";
      PolymerUtils_PolymerUtils.removeClass("v" + variantId + "Button", "btn-success");
      PolymerUtils_PolymerUtils.addClass("v" + variantId + "Button", "btn-danger");
      PolymerUtils_PolymerUtils.removeClass("v" + variantId + "ButtonIcon", "fa-check");
      PolymerUtils_PolymerUtils.addClass("v" + variantId + "ButtonIcon", "fa-times");

      _reportVariants.push(variantId);
    } else {
      PolymerUtils_PolymerUtils.getElementById("v" + variantId + "ButtonText").innerHTML = "Add to Report";
      PolymerUtils_PolymerUtils.removeClass("v" + variantId + "Button", "btn-danger");
      PolymerUtils_PolymerUtils.addClass("v" + variantId + "Button", "btn-success");
      PolymerUtils_PolymerUtils.removeClass("v" + variantId + "ButtonIcon", "fa-times");
      PolymerUtils_PolymerUtils.addClass("v" + variantId + "ButtonIcon", "fa-check");

      const idx = _reportVariants.indexOf(variantId);

      _reportVariants.splice(idx, 1);
    }

    this.reportVariants = [];
    this.reportVariants = _reportVariants;
  }

  _getFileMetricsArray() {
    if (this.variantObj === undefined || this.variantObj.studies === undefined) {
      return [];
    }

    const files = this.variantObj.studies[0].files; // Let's find all the existing attributes

    const attributesSet = new Set();

    for (const file of files) {
      for (const attr of Object.keys(file.attributes)) {
        if (attr !== "QUAL" && attr !== "FILTER") {
          attributesSet.add(attr);
        }
      }
    }

    const attributesArray = Array.from(attributesSet.values()).sort();
    attributesArray.unshift("QUAL", "FILTER"); // We store the values as: result = [{name: "AC", values: [1, 2, 3, 4]}]

    const result = [];

    for (const attr of attributesArray) {
      const tmp = {
        name: attr,
        values: []
      };

      for (const file of files) {
        tmp.values.push(file.attributes[attr]);
      }

      result.push(tmp);
    }

    return result;
  }

  onChangeId(e) {
    const params = {
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias
    };

    const _this = this;

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.interpretationId)) {
      this.opencgaClient.files().content(this.interpretationId, params).then(response => {
        _this.interpretation = JSON.parse(response);
        console.log("end");

        this._render();
      });
    }
  }

  detailFormatter(value, row) {
    const ctHtml = [];

    for (const ct of row.annotation.consequenceTypes) {
      let x = "<span class='col-md-12' style='padding: 0px'>";

      if (ct.geneName !== undefined) {
        x += "<span class='col-md-3'>\n                            <span style=\"font-weight: bold\">".concat(ct.geneName, "</span> (<a href='http://www.ensembl.org/Homo_sapiens/Gene/Summary?db=core;g=").concat(ct.ensemblGeneId, ";r=13:32315474-32400266' target=\"_blank\">").concat(ct.ensemblGeneId, "</a>)\n                          </span>");
        x += "<span class='col-md-3'><a href=\"http://www.ensembl.org/Homo_sapiens/Transcript/Summary?db=core;t=".concat(ct.ensemblTranscriptId, "\" target=\"_blank\">").concat(ct.ensemblTranscriptId, "</a> (").concat(ct.biotype, ")</span>");
      } else {
        x += "<span class='col-md-3' style=\"font-weight: bold\">NA</span>";
        x += "<span class='col-md-3' style=\"font-weight: bold\">NA</span>";
      }

      x += "<span class='col-md-3'>";

      for (const so of ct.sequenceOntologyTerms) {
        x += "<span><span style=\"font-weight: bold\">".concat(so.name, "</span>&nbsp;(").concat(so.accession, ")</span> ");
      }

      x += "</span>";
      x += "<span class='col-md-3'>";

      if (ct.exonOverlap !== undefined) {
        x += "<span><span style=\"font-weight: bold\">cDNA:</span> ".concat(ct.cdnaPosition, ", <span style=\"font-weight: bold\">CDS:</span> ").concat(ct.cdsPosition, ", <span style=\"font-weight: bold\">Codon:</span> ").concat(ct.codon, ", <span style=\"font-weight: bold\">Exon:</span> ").concat(ct.exonOverlap[0].number, "</span>");
      }

      x += "</span>";
      x += "</span>";
      ctHtml.push(x);
    }

    const commentsHtml = [];

    for (const comment of row.comments) {
      const x = "<span class='col-md-12'>".concat(comment.comment, " (").concat(comment.author, ", ").concat(comment.date, ")</span><br>");
      commentsHtml.push(x);
    }

    const html = "<div class=\"col-md-12\" style=\"padding: 2px 0px\">\n                                <div class=\"col-md-2\" style=\"padding: 0px 5px\">\n                                    <label>Consequence Type:</label>\n                                </div>\n                                <div class=\"col-md-10\" style=\"padding: 0px 5px\">\n                                    <form class=\"form-horizontal\">\n                                        <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                            ".concat(ctHtml.join("\n"), "\n                                        </div>\n                                    </form>\n                                </div>\n                            </div>\n                            <div class=\"col-md-12\" style=\"padding: 2px 0px\">\n                                <div class=\"col-md-2\" style=\"padding: 0px 5px\">\n                                    <label>Comments:</label>\n                                </div>\n                                <div class=\"col-md-10\" style=\"padding: 0px 5px\">\n                                    <form class=\"form-horizontal\">\n                                        <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                            ").concat(commentsHtml.join("\n"), "\n                                        </div>\n                                    </form>\n                                </div>\n                            </div>");
    return html;
  }

  render() {
    this.variant = ""; // Empty the variant every time the grid is loaded

    this.from = 1;
    this.to = Math.min(this.interpretation.reportedVariants.length, 10);
    this.numTotalResultsText = this.interpretation.reportedVariants.length.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    this.cols = this._refreshTableColumns();
    this._genomeBrowserActive = false;

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.interpretation.reportedVariants[0])) {
      this.regionGenomeBrowser = new Region({
        chromosome: this.interpretation.reportedVariants[0].chromosome,
        start: this.interpretation.reportedVariants[0].start,
        end: this.interpretation.reportedVariants[0].end
      });
    }

    this._collapse = false;

    const _this = this;

    const _table = $("#" + this._prefix + "mainTable");

    $("#" + this._prefix + "mainTable").bootstrapTable("destroy");
    $("#" + this._prefix + "mainTable").bootstrapTable({
      data: _this.interpretation.reportedVariants,
      columns: _this.cols,
      onPageChange: function onPageChange(page, size) {
        _this.from = (page - 1) * size + 1;
        _this.to = page * size;
      },
      onClickRow: function onClickRow(row, $element) {
        $(".success").removeClass("success");
        $($element).addClass("success");

        _this._onSelectVariant(row);

        _this.regionGenomeBrowser = new Region({
          chromosome: row.chromosome,
          start: row.start,
          end: row.end
        });
      },
      onPostBody: function onPostBody(data) {
        if (utilsNew_UtilsNew.isNotUndefinedOrNull(_table)) {
          PolymerUtils_PolymerUtils.querySelector(_table.selector).rows[2].setAttribute("class", "success");

          _this._onSelectVariant(data[0]);
        }
      }
    });
  }

  _onSelectVariant(row) {
    if (typeof row !== "undefined") {
      //                    let variant = row.chromosome + ":" + row.start + ":" + row.reference + ":" + row.alternate;
      this.variant = row.chromosome + ":" + row.start + ":" + row.reference + ":" + row.alternate; //                    this.variant  = row.annotation.chromosome + ":" + row.annotation.start + ":" + row.annotation.reference + ":" + row.annotation.alternate;

      this.variantObj = row;
      this.dispatchEvent(new CustomEvent("selectvariant", {
        detail: {
          id: this.variant,
          variant: row
        },
        bubbles: true,
        composed: true
      }));
    }
  }

  projectStudyObtained(project, study) {
    if (typeof this.opencgaSession.project !== "undefined" && this.opencgaSession.project.alias !== "" && typeof this.opencgaSession.study !== "undefined" && this.opencgaSession.study.alias !== "") {
      this.hashFragmentCredentials = {
        project: this.opencgaSession.project.alias,
        study: this.opencgaSession.study.alias
      };
    }
  }

  variantIdFormatter(value, row, index) {
    //                let res = "";
    const ref = row.reference != "" ? row.reference : "-";
    const alt = row.alternate != "" ? row.alternate : "-";
    return "<span style='white-space: nowrap'>" + row.chromosome + ":" + row.start + " " + ref + "/" + alt + "</span>"; //
    //                if (UtilsNew.isNotUndefinedOrNull(row.id)) {
    //                    res += "<label>" + row.id + "</label><br>";
    //                    if (row.annotation.cytoband !== undefined) {
    //                        res += "<label>" + row.annotation.cytoband[0].name + "</label><br>";
    //                    }
    //                }
    //                if (UtilsNew.isNotUndefinedOrNull(row.names) && row.names.length > 0) {
    //                    res += "<label><a href='https://www.ncbi.nlm.nih.gov/projects/SNP/snp_ref.cgi?searchType=adhoc_search&type=rs&rs="
    //                        + row.names[0]+ "' target='_blank'>dbSNP " + row.names[0] + "</a></label>";
    //                }
    //                return res;
  }

  geneFormatter(value, row, index) {
    if (typeof row !== "undefined" && typeof row.annotation !== "undefined") {
      if (typeof row.annotation !== "undefined" && typeof row.annotation.consequenceTypes !== "undefined" && row.annotation.consequenceTypes.length > 0) {
        const visited = {};
        const geneLinks = [];

        for (let i = 0; i < row.annotation.consequenceTypes.length; i++) {
          if (typeof row.annotation.consequenceTypes[i].geneName !== "undefined" && row.annotation.consequenceTypes[i].geneName !== "" && typeof visited[row.annotation.consequenceTypes[i].geneName] === "undefined") {
            if (typeof this.field.context.project !== "undefined" && typeof this.field.context.study !== "undefined") {
              geneLinks.push("<a style=\"cursor: pointer;white-space: nowrap\" href=\"#gene/" + this.field.context.project.alias + "/" + this.field.context.study.alias + "/" + row.annotation.consequenceTypes[i].geneName + "\">" + row.annotation.consequenceTypes[i].geneName + "</a>");
            } else {
              geneLinks.push("<a style=\"cursor: pointer;white-space: nowrap\">" + row.annotation.consequenceTypes[i].geneName + "</a>");
            }

            visited[row.annotation.consequenceTypes[i].geneName] = true;
          }
        }

        return geneLinks.join(", ");
      }
    }

    return "-";
  }

  geneAnnotationFormatter(value, row, index) {
    const val = "<span style='color: red'>missense_variant</span>";
    return val;
  }

  prediciotnFormatter(value, row, index) {
    let res = "";

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(row.reportEvents)) {
      row.reportEvents.forEach(reportEvent => {
        if (utilsNew_UtilsNew.isNotUndefinedOrNull(reportEvent.prediction)) {
          res += "<label>" + reportEvent.prediction + "</label>";
        }

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(reportEvent.score)) {
          res += " (<label>" + reportEvent.score + "</label>)";
        }
      });
    }

    return res;
  }

  zigosityFormatter(value, row, index) {
    let res = "";

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(row.studies)) {
      let left;
      let right;

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(row.studies[0]) && utilsNew_UtilsNew.isNotUndefinedOrNull(row.studies[0].samplesData) && utilsNew_UtilsNew.isNotUndefinedOrNull(row.studies[0].samplesData[this.field.memberIdx]) && utilsNew_UtilsNew.isNotUndefinedOrNull(row.studies[0].samplesData[this.field.memberIdx][0])) {
        switch (row.studies[0].samplesData[this.field.memberIdx][0]) {
          case "0/0":
          case "0|0":
            left = "white";
            right = "white";
            break;

          case "0/1":
          case "1/0":
            left = "black";
            right = "white";
            break;

          case "1/1":
          case "1|1":
            left = "black";
            right = "black";
            break;
        }
      }

      res = "<table>\n                                <tr style=\"padding: 0px;\">\n                                    <td style=\"padding: 0px\"><div style='width: 15px;height: 15px;border: 1px solid black;border-radius: 50%;background-color: ".concat(left, "'></div></td>\n                                    <td style=\"padding: 0px\"><div style='width: 15px;height: 15px;border: 1px solid black;border-radius: 50%;background-color: ").concat(right, "'></div></td>\n                                </tr>\n                           </table>");
    }

    return res;
  }

  fileMetricsFormatter(value, row, index) {
    let val;

    if (row !== undefined && row.studies !== undefined && row.studies.length > 0 && row.studies[0].files.length > 0 && utilsNew_UtilsNew.isNotUndefinedOrNull(row.studies[0].files[0].attributes)) {
      val = "<div class=\"col-md-12\" style=\"padding: 0px\">\n                                <form class=\"form-horizontal\">\n                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                        <label class=\"col-md-4\">Quality:</label>\n                                        <span class=\"col-md-8\">".concat(row.studies[0].files[0].attributes.QUAL, "</span>\n                                    </div>\n                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                        <label class=\"col-md-4\">Filter:</label>\n                                        <span class=\"col-md-8\">").concat(row.studies[0].files[0].attributes.FILTER, "</span>\n                                    </div>\n                                    <div class=\"form-group\" style=\"margin: 0px 2px\">\n                                        <label class=\"col-md-4\">DP:</label>\n                                        <span class=\"col-md-8\">").concat(row.studies[0].files[0].attributes.DP, "</span>\n                                    </div>\n                                </form>\n                            </div>");
    }

    return val;
  }

  interpretationFormatter(value, row, index) {
    const res = "<button id=\"v".concat(row.id, "Button\" type='button' class='btn btn-success btn-xs interpretation-add-to-report' data-variant-id='").concat(row.id, "'>\n                                    <i id=\"v").concat(row.id, "ButtonIcon\" class=\"fa fa-check interpretation-add-to-report\" aria-hidden=\"true\" data-variant-id='").concat(row.id, "'></i>\n                                    <span id=\"v").concat(row.id, "ButtonText\" class=\"interpretation-add-to-report\" data-variant-id='").concat(row.id, "'>Add to Report</span>\n                               </button>");
    const comments = utilsNew_UtilsNew.isNotEmptyArray(row.comments) ? row.comments.length : 0;
    return res + "<br><br><span>Comments (" + comments + ")</span>";
  }

  _refreshTableColumns() {
    this.cols = this._createDefaultColumns();

    if (typeof this.cols !== "undefined" && (utilsNew_UtilsNew.isNotUndefinedOrNull(this.interpretation.clinicalAnalysis.family) && this.interpretation.clinicalAnalysis.family.id > 0 && Object.keys(this.interpretation.clinicalAnalysis.family.members).length > 0 || utilsNew_UtilsNew.isNotUndefinedOrNull(this.interpretation.clinicalAnalysis.subjects) && utilsNew_UtilsNew.isNotEmptyArray(this.interpretation.clinicalAnalysis.subjects))) {
      const zigosityIdx = 5;
      let members = [];

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.interpretation.clinicalAnalysis.family) && this.interpretation.clinicalAnalysis.family.id > 0) {
        members = this.interpretation.clinicalAnalysis.family.members;
      } else {
        members.push(this.interpretation.clinicalAnalysis.subjects[0]);
      }

      this.cols[0].splice(zigosityIdx, 0, {
        title: "Zigosity",
        rowspan: 1,
        colspan: members.length,
        halign: "center"
      });

      for (let i = 0; i < members.length; i++) {
        this.cols[1].splice(i, 0, {
          title: members[i].name,
          field: {
            memberIdx: i,
            memberName: members[i].name
          },
          rowspan: 1,
          colspan: 1,
          halign: "center",
          formatter: this.zigosityFormatter
        });
      }
    }

    return this.cols;
  }

  _createDefaultColumns() {
    return [[{
      title: "Variant",
      field: "variant",
      rowspan: 2,
      colspan: 1,
      formatter: this.variantIdFormatter,
      halign: "center",
      sortable: true
    }, {
      title: "Genes",
      field: {
        name: "genes",
        context: this
      },
      rowspan: 2,
      colspan: 1,
      halign: "center",
      formatter: this.geneFormatter
    }, {
      title: "Type",
      field: "type",
      rowspan: 2,
      colspan: 1,
      halign: "center"
    }, {
      title: "Gene Annotation",
      field: "consequence",
      rowspan: 2,
      colspan: 1,
      formatter: this.geneAnnotationFormatter,
      halign: "center"
    }, {
      title: "Prediction",
      field: "prediction",
      rowspan: 2,
      colspan: 1,
      halign: "center",
      formatter: this.prediciotnFormatter
    }, {
      title: "Max allele freq",
      field: "masAllele",
      rowspan: 2,
      colspan: 1,
      halign: "center"
    }, {
      title: "File metrics",
      field: "read",
      rowspan: 2,
      colspan: 1,
      formatter: this.fileMetricsFormatter,
      halign: "center"
    }, {
      title: "Custom Annotations",
      field: "customAnnotations",
      rowspan: 2,
      colspan: 1,
      halign: "center"
    }, {
      title: "Interpretation",
      field: "interpretation",
      rowspan: 2,
      colspan: 1,
      formatter: this.interpretationFormatter,
      halign: "center"
    }], []];
  }

  triggerBeacon(e) {
    this.variantToBeacon = this.variant;
  }

  _toArray(obj) {
    return Object.keys(obj).map(function (key) {
      const spacers = [",", ";"];
      return {
        name: key,
        value: obj[key].split(new RegExp(spacers.join("|"), "g")).join(", ")
      };
    });
  }

  pedigreeRender() {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(PolymerUtils_PolymerUtils.getElementById(this._prefix + "PedigreeView"))) {
      PolymerUtils_PolymerUtils.innerHTML(this._prefix + "PedigreeView", "");
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.interpretation.clinicalAnalysis) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.interpretation.clinicalAnalysis.family) && this.interpretation.clinicalAnalysis.family.id > 0) {
      //                    if (UtilsNew.isNotUndefined(this.svg)) {
      //                        PolymerUtils.getElementById(this._prefix + "PedigreeView").removeChild(this.svg);
      //                    }
      const body = Object.assign({}, this.interpretation.clinicalAnalysis.family);
      const membersNew = [];
      body.members.forEach(member => {
        const newMember = Object.assign({}, member);

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(newMember.father) && utilsNew_UtilsNew.isNotUndefinedOrNull(newMember.father.id)) {
          const newFather = body.members.find(member => {
            return member.id === newMember.father.id;
          });

          if (utilsNew_UtilsNew.isNotUndefinedOrNull(newFather)) {
            newMember.father = newFather.name;
          }
        }

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(newMember.mother) && utilsNew_UtilsNew.isNotUndefinedOrNull(newMember.mother.id)) {
          const newMother = body.members.find(member => {
            return member.id === newMember.mother.id;
          });

          if (utilsNew_UtilsNew.isNotUndefinedOrNull(newMother)) {
            newMember.mother = newMother.name;
          }
        }

        membersNew.push(newMember);
      });
      body.members = membersNew; // Render new Pedigree

      const querySelector = PolymerUtils_PolymerUtils.getElementById(this._prefix + "PedigreeView");
      const pedigree = new Pedigree(body, {
        selectShowSampleNames: true
      });
      this.svg = pedigree.pedigreeFromFamily(pedigree.pedigree, {
        width: 200,
        height: 180
      });
      querySelector.appendChild(this.svg);
    }
  }

  activeGenomeBrowser() {
    const width = $(".tab-content").width();
    this.settings = {
      width: width
    };
    this._genomeBrowserActive = true;
  }

  render() {
    return lit_html_lit_html_html(clinical_interpretation_view_templateObject(), this._prefix, this._prefix, this.config.summary ? lit_html_lit_html_html(clinical_interpretation_view_templateObject2(), this.interpretation.name, this._summaryOnClick, this._prefix, this.interpretation.clinicalAnalysis.subjects[0].samples[0].name, this.interpretation.clinicalAnalysis.germline.name, this.interpretation.clinicalAnalysis.germline.assembly, this.interpretation.clinicalAnalysis.subjects[0].samples[0].somatic, this.interpretation.clinicalAnalysis.subjects[0].samples[0].phenotypes, this.item.name, this.item.id, this.item.id, this.interpretation.clinicalAnalysis.subjects[0].samples[0].description, this.interpretation.clinicalAnalysis.subjects[0].name, this.interpretation.clinicalAnalysis.subjects[0].sex, this.interpretation.clinicalAnalysis.subjects[0].karyotypicSex, this.interpretation.clinicalAnalysis.subjects[0].dateOfBirth, this.interpretation.clinicalAnalysis.subjects[0].lifeStatus, this.interpretation.clinicalAnalysis.subjects[0].parentalConsanguinity, this.interpretation.clinicalAnalysis.subjects[0].phenotypes, this.item.name, this.item.id, this.item.id, this.interpretation.clinicalAnalysis.subjects[0].description, this.interpretation.clinicalAnalysis.family.name, this.interpretation.clinicalAnalysis.family.phenotypes && this.interpretation.clinicalAnalysis.family.phenotypes.length ? this.interpretation.clinicalAnalysis.family.phenotypes.map(item => lit_html_lit_html_html(clinical_interpretation_view_templateObject3(), this.item.name, this.item.id, this.item.id)) : null, this._prefix, this.interpretation.name, this.interpretation.creationDate, this.interpretation.clinicalAnalysis.type, this.interpretation.analyst.name, this.interpretation.analyst.email, this.interpretation.description, this.interpretation.software.name, this.interpretation.software.website, this.interpretation.software.version, this.interpretation.software.repository, this.interpretation.software.commit, this.interpretation.versions && this.interpretation.versions.length ? this.interpretation.versions.map(item => lit_html_lit_html_html(clinical_interpretation_view_templateObject4(), this.item.name, this.item.version)) : null, this._toArray(this.interpretation.filters).map(item => lit_html_lit_html_html(clinical_interpretation_view_templateObject5(), item.name, item.value))) : null, this._prefix, this.from, this.to, this.numTotalResultsText, this.config.toolbar ? lit_html_lit_html_html(clinical_interpretation_view_templateObject6(), this.onCreateReport, this.reportVariants.length) : null, this._prefix, this._prefix, this.variant, this._prefix, this._prefix, this._prefix, this._prefix, this._prefix, this.activeGenomeBrowser, this._prefix, this._prefix, this._prefix, this.variant, this.cellbaseClient, this.opencgaSession.project.organism.assembly, this.hashFragmentCredentials, this.consequenceTypes, this.proteinSubstitutionScores, this._prefix, this._prefix, this.interpretation.clinicalAnalysis.family.members.map(member => lit_html_lit_html_html(clinical_interpretation_view_templateObject7(), member.name)), this._prefix, this._getFileMetricsArray(this.variantObj.studies[0].files).map(attrs => lit_html_lit_html_html(clinical_interpretation_view_templateObject8(), attrs.name, attrs.name, attrs.name, attrs.values.map(attr => lit_html_lit_html_html(clinical_interpretation_view_templateObject9(), attr)))), this._prefix, this.triggerBeacon, this.variant, this.variantToBeacon, this._prefix, this.project, this.study, this.samples, this._genomeBrowserActive, this.opencgaClient, this.cellbaseClient, this.regionGenomeBrowser, this.cellbaseClient, this.opencgaClient, this.regionGenomeBrowser, this.opencgaSession, this._genomeBrowserActive, this.settings);
  }

}
customElements.define("clinical-interpretation-view", clinical_interpretation_view_ClinicalInterpretationView);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/opencga-variant-interpretation-editor.js
function opencga_variant_interpretation_editor_templateObject12() {
  const data = opencga_variant_interpretation_editor_taggedTemplateLiteral(["\n                        <clinical-interpretation-view id=\"id\"\n                                                      interpretation=\"", "\"\n                                                      .opencgaSession=\"", "\"\n                                                      .opencgaClient=\"", "\"\n                                                      .cellbaseClient=\"", "\"\n                                                      .consequenceTypes=\"", "\"\n                                                      .proteinSubstitutionScores=\"", "\"\n                                                      style=\"font-size: 12px\">\n                        </clinical-interpretation-view>\n                    "]);

  opencga_variant_interpretation_editor_templateObject12 = function _templateObject12() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_editor_templateObject11() {
  const data = opencga_variant_interpretation_editor_taggedTemplateLiteral(["\n                                <h4 style=\"padding: 20px\">No interpreted variants</h4>\n                            "]);

  opencga_variant_interpretation_editor_templateObject11 = function _templateObject11() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_editor_templateObject10() {
  const data = opencga_variant_interpretation_editor_taggedTemplateLiteral(["\n                                <opencga-variant-interpretation-grid .opencgaSession=\"", "\"\n                                                                     .reportedVariants=\"", "\"\n                                                                     .clinicalAnalysis=\"", "\"\n                                                                     .consequenceTypes=\"", "\"\n                                                                     .populationFrequencies=\"", "\"\n                                                                     .proteinSubstitutionScores=\"", "\"\n                                                                     .config=\"", "\"\n                                                                     @selected=\"", "\"\n                                                                     @selectvariant2=\"", "\"\n                                                                     @checkvariant=\"", "\"\n                                                                     @reviewvariant=\"", "\"\n                                                                     @setgenomebrowserposition=\"", "\">\n                                </opencga-variant-interpretation-grid>\n\n                                <opencga-variant-interpretation-detail .opencgaSession=\"", "\"\n                                                                       .cellbaseClient=\"", "\"\n                                                                       .variant=\"", "\"\n                                                                       .clinicalAnalysis=\"", "\"\n                                                                       .consequenceTypes=\"", "\"\n                                                                       .proteinSubstitutionScores=\"", "\"\n                                                                       .config=\"", "\">\n                                </opencga-variant-interpretation-detail>\n                            "]);

  opencga_variant_interpretation_editor_templateObject10 = function _templateObject10() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_editor_templateObject9() {
  const data = opencga_variant_interpretation_editor_taggedTemplateLiteral(["\n                                    <i class=\"fa fa-caret-down\" aria-hidden=\"true\" style=\"width: 20px;padding-left: 5px;padding-right: 5px\"></i>\n                                "]);

  opencga_variant_interpretation_editor_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_editor_templateObject8() {
  const data = opencga_variant_interpretation_editor_taggedTemplateLiteral(["\n                                    <i class=\"fa fa-caret-right\" aria-hidden=\"true\" style=\"width: 20px;padding-left: 5px;padding-right: 5px\"></i>\n                                "]);

  opencga_variant_interpretation_editor_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_editor_templateObject7() {
  const data = opencga_variant_interpretation_editor_taggedTemplateLiteral(["\n                                        <div class=\"input-group\">\n                                            <input type=\"text\" id=\"", "IDInterpretation\" class=\"", "TextInput form-control\"\n                                                   placeholder=\"ID of the interpretation\" data-field=\"id\" @input=\"", "\">\n                                            <span class=\"input-group-btn\">\n                                            <button class=\"btn btn-default\" type=\"button\">\n                                                <i class=\"fa fa-search\" aria-hidden=\"true\"></i>\n                                            </button>\n                                        </span>\n                                        </div>\n                                    "]);

  opencga_variant_interpretation_editor_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_editor_templateObject6() {
  const data = opencga_variant_interpretation_editor_taggedTemplateLiteral(["\n                                        <input type=\"text\" id=\"", "IDInterpretation\" class=\"", "TextInput form-control\"\n                                               placeholder=\"ID of the interpretation\" data-field=\"id\" @input=\"", "\"\n                                               value=\"", "\">\n                                    "]);

  opencga_variant_interpretation_editor_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_editor_templateObject5() {
  const data = opencga_variant_interpretation_editor_taggedTemplateLiteral(["\n                                <i class=\"fa fa-caret-down\" aria-hidden=\"true\" style=\"width: 20px;padding-left: 5px;padding-right: 5px\"></i>\n                                "]);

  opencga_variant_interpretation_editor_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_editor_templateObject4() {
  const data = opencga_variant_interpretation_editor_taggedTemplateLiteral(["\n                                    <i class=\"fa fa-caret-right\" aria-hidden=\"true\" style=\"width: 20px;padding-left: 5px;padding-right: 5px\"></i>\n                                "]);

  opencga_variant_interpretation_editor_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_editor_templateObject3() {
  const data = opencga_variant_interpretation_editor_taggedTemplateLiteral(["\n                        <div class=\"alert alert-success\" role=\"alert\" id=\"", "messageSuccess\" style=\"margin:5px auto;\">", "</div>\n                    "]);

  opencga_variant_interpretation_editor_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_editor_templateObject2() {
  const data = opencga_variant_interpretation_editor_taggedTemplateLiteral([" \n                        <div class=\"alert alert-danger\" role=\"alert\" id=\"", "messageError\" style=\"margin:5px auto;\">", "</div>\n                    "]);

  opencga_variant_interpretation_editor_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_editor_templateObject() {
  const data = opencga_variant_interpretation_editor_taggedTemplateLiteral(["\n        <style include=\"jso-styles\">\n            .prioritization-center {\n                margin: auto;\n                text-align: justify;\n                width: 95%;\n            }\n\n            .browser-variant-tab-title {\n                font-size: 115%;\n                font-weight: bold;\n            }\n\n            .prioritization-variant-tab-title {\n                font-size: 115%;\n                font-weight: bold;\n            }\n\n            .icon-padding {\n                padding-left: 4px;\n                padding-right: 8px;\n            }\n\n            .form-section-title {\n                padding: 5px 0px;\n                width: 90%;\n                border-bottom-width: 1px;\n                border-bottom-style: solid;\n                border-bottom-color: #ddd\n            }\n\n            .jso-label-title {\n                width: 15em !important;\n            }\n        </style>\n\n        <div class=\"row\" style=\"padding: 0px 10px\">\n            <div id=\"", "SaveInterpretation\">\n                <div class=\"col-md-12\">\n                    ", "\n                    ", "\n                </div>\n\n                <div class=\"col-md-12\">\n                    <div>\n                        <!-- <h3 class=\"form-section-title\" style=\"margin-top: 10px\">Interpretation</h3> -->\n                        <div style=\"display: inline; cursor:pointer\" @click=\"toggleInterpretationCollapsed\"\n                             data-toggle=\"collapse\" href=\"#", "collapsibleInterpretation\">\n                            <h3 class=\"form-section-title\">\n                                ", "\n                                Interpretation\n                            </h3>\n                        </div>\n\n                        <div id=\"", "collapsibleInterpretation\" class=\"form-horizontal collapse in\" data-toggle=\"validator\" data-feedback='{\"success\": \"fa-check\", \"error\": \"fa-times\"}' role=\"form\">\n                            <div class=\"form-group\">\n                                <label class=\"control-label col-md-1 jso-label-title\">Interpretation ID</label>\n                                <div class=\"col-md-3\">\n                                    ", "\n                                    \n                                </div>\n                            </div>\n\n                            <div class=\"form-group\">\n                                <label class=\"control-label col-md-1 jso-label-title\">Comment</label>\n                                <div class=\"col-md-3\">\n                                    <input type=\"text\" id=\"", "CommentInterpretation\" class=\"", "TextInput form-control\"\n                                           placeholder=\"Add a comment\" data-field=\"comment\">\n                                </div>\n                            </div>\n\n                            <div class=\"form-group\">\n                                <label class=\"control-label col-md-1 jso-label-title\">Description</label>\n                                <div class=\"col-md-3\">\n                                <textarea id=\"", "DescriptionInterpretation\" class=\"", "TextInput form-control\"\n                                          placeholder=\"Description of the interpretation\" data-field=\"description\"\n                                          @input=\"", "\"></textarea>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div style=\"padding-top: 5px\">\n                        <!--                        <h3 class=\"form-section-title\">Edit Reported Variants</h3>-->\n                        <div style=\"display: inline; cursor:pointer\" @click=\"", "\"\n                             data-toggle=\"collapse\" href=\"#", "collapsibleVariants\">\n                            <h3 class=\"form-section-title\">\n                                ", "\n                                Primary Findings\n                            </h3>\n                        </div>\n\n                        <div id=\"", "collapsibleVariants\" class=\"collapse in\">\n                            ", "\n\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"col-md-12\">\n                    <div class=\"col-md-4 col-md-offset-8\" style=\"padding: 0px 20px;\">\n                        <button type=\"button\" class=\"btn btn-primary\" @click=\"", "\">View</button>\n                        <button type=\"button\" class=\"btn btn-primary\" @click=\"", "\">Save</button>\n                    </div>\n                </div>\n\n                <div class=\"col-md-12\">\n                    ", "\n                </div>\n            </div>\n        </div>\n        <!--</template>-->\n\n        <!--<template is=\"dom-if\" if=\"", "}\">-->\n        <!--<span style=\"text-align: center\"><h3>No public projects available to browse. Please login to continue</h3></span>-->\n        <!--</template>-->\n\n    "]);

  opencga_variant_interpretation_editor_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_editor_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */












class opencga_variant_interpretation_editor_OpencgaVariantInterpretationEditor extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      interpretation: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      consequenceTypes: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      mode: {
        type: String
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ovi-" + utils.randomString(6); //TODO recheck this variant-interpretation-editor doesn't have a "mode" prop in opencga-variant-interpretation

    this.mode = "create";
    this.isCreate = this.mode.toLowerCase() === "create";
    this.interpretationCollapsed = false;
    this.variantsCollapsed = false;
    this.isInterpretedVariants = false;
    this.checkProjects = false;
    this.interactive = true;
    this.filterClass = "col-md-2";
    this.gridClass = "col-md-10";
    this._collapsed = true;
    this.messageError = false;
    this.messageSuccess = false;
    this.variant = null;
    this.reportedVariants = [];
    this._config = this.getDefaultConfig();
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession") || changedProperties.has("mode") || changedProperties.has("config")) {
      this.propertyObserver();
    }

    if (changedProperties.has("interpretation")) {
      this.interpretationObserver();
    }
  }

  connectedCallback() {
    super.connectedCallback();
    console.log("this.interpretation in variant-interpretation-editor", this.interpretation);
    this._interpretation = this.interpretation;
  }

  firstUpdated(_changedProperties) {
    // if (!this.interactive) {
    //     this.collapseFilter();
    // }
    // CellBase version
    this.cellbaseClient.getMeta("about").then(response => {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(response) && utilsNew_UtilsNew.isNotEmptyArray(response.response)) {
        if (utilsNew_UtilsNew.isNotUndefinedOrNull(response.response[0].result) && utilsNew_UtilsNew.isNotEmptyArray(response.response[0].result)) {
          this.cellbaseVersion = response.response[0].result[0]["Version: "];
        }
      }
    });
  }

  propertyObserver(opencgaSession, mode, config) {
    // With each property change we must updated config and create the columns again. No extra checks are needed.
    let _config = JSON.parse(JSON.stringify(config));

    _config = Object.assign(this.getDefaultConfig(), _config);
    _config.grid.showSelectCheckbox = false;
    _config.grid.showStatus = true;
    this._config = _config; // Check if Beacon hosts are configured

    for (const detail of this._config.detail) {
      if (detail.id === "beacon" && utilsNew_UtilsNew.isNotEmptyArray(detail.hosts)) {
        this.beaconConfig = {
          hosts: detail.hosts
        };
      }
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(mode)) {
      this.isCreate = mode.toLowerCase() === "create";
    } // if (UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && UtilsNew.isNotUndefinedOrNull(this.opencgaSession.project)) {
    //     this.checkProjects = true;
    // } else {
    //     this.checkProjects = false;
    // }

  }

  interpretationObserver() {
    // TODO We need to respect all the changes made in the reported variants
    this._interpretation = this.interpretation;

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this._interpretation)) {
      if (utilsNew_UtilsNew.isNotEmptyArray(this._interpretation.primaryFindings)) {
        this.isInterpretedVariants = true;
      } else {
        this.isInterpretedVariants = false;
      }
    } // this.fillForm(this._interpretation);

  }

  toggleInterpretationCollapsed(e) {
    this.interpretationCollapsed = !this.interpretationCollapsed;
  }

  toggleVariantsCollapsed(e) {
    this.variantsCollapsed = !this.variantsCollapsed;
  }

  onClinicalAnalysisEditor(e) {
    // debugger
    this.clinicalAnalysis = Object.assign({}, e.detail.clinicalAnalysis);
  } // interactiveObserver() {
  //     if (!this.interactive) {
  //         this.collapseFilter();
  //     } else {
  //         this.unCollapseFilter();
  //     }
  // }
  // onCollapse() {
  //     if (this._collapsed) {
  //         this.unCollapseFilter();
  //     } else {
  //         this.collapseFilter();
  //     }
  // }
  // collapseFilter() {
  //     this.filterClass = "hidden";
  //     this.gridClass = "prioritization-center";
  //     this._collapsed = true;
  // }
  //
  // unCollapseFilter() {
  //     if (this.interactive) {
  //         this.filterClass = "col-md-2";
  //         this.gridClass = "col-md-10";
  //         this._collapsed = false;
  //     }
  // }


  _changeBottomTab(e) {
    const _activeTabs = {};

    for (const detail of this.config.detail) {
      _activeTabs[detail.id] = detail.id === e.currentTarget.dataset.id;
    }

    this.set("detailActiveTabs", _activeTabs);
  }

  checkVariant(variant) {
    return variant.split(":").length > 2;
  }

  onSelectVariant(e) {
    this.variant = e.detail.variant; // this.variant = e.detail.id;
    // this.variantObj = e.detail.variant;
  }

  onSelectVariant2(e) {
    this.selectedVariant = e.detail.variant; // this.variant = e.detail.id;
    // this.variantObj = e.detail.variant;
  }

  onCheckVariant(e) {
    // Alexis: we need to do something like this:
    this.checkedVariants = e.detail.variants; // We set/remove disable status to Save button
    // if (this.checkedVariants.length > 0 && UtilsNew.isNotEmptyArray(this.samples)) {
    //     PolymerUtils.removeAttribute(this._prefix + 'SaveInterpretationButton', 'disabled');
    // } else {
    //     PolymerUtils.setAttribute(this._prefix + 'SaveInterpretationButton', 'disabled', true);
    // }
  } // onReviewVariant(e) {
  //     $("#" + this._prefix + "ReviewSampleModal").modal("show");
  // }


  onGenomeBrowserPositionChange(e) {
    $(".variant-interpretation-content").hide(); // hides all content divs

    $("#" + this._prefix + "GenomeBrowser").show(); // get the href and use it find which div to show
    // Show the active button

    $(".variant-interpretation-view-buttons").removeClass("active"); // $(e.target).addClass("active");

    PolymerUtils_PolymerUtils.addClass(this._prefix + "GenomeBrowserButton", "active");
    this._genomeBrowserActive = true;
    this.region = e.detail.genomeBrowserPosition;
  }

  _backToSelectAnalysis(e) {
    this.dispatchEvent(new CustomEvent("backtoselectanalysis", {
      detail: {
        idTab: "PrioritizationButton"
      }
    }));
  }

  _goToReport(e) {
    this.dispatchEvent(new CustomEvent("gotoreport", {
      detail: {
        interpretation: this.interpretation
      }
    }));
  }

  triggerBeacon(e) {
    this.variantToBeacon = this.variant.id;
  }

  onViewInterpretation(e) {
    // this.interpretationView = this._createInterpretation();
    this.interpretationView = this._interpretation;
  }

  onSaveInterpretation(e, obj) {
    const id = PolymerUtils_PolymerUtils.getValue(this._prefix + "IDInterpretation");
    const description = PolymerUtils_PolymerUtils.getValue(this._prefix + "DescriptionInterpretation");
    const comment = PolymerUtils_PolymerUtils.getValue(this._prefix + "CommentInterpretation");

    if (utilsNew_UtilsNew.isNotEmpty(id)) {
      if (/s/.test(id)) {
        this.dispatchEvent(new CustomEvent(this.eventNotifyName, {
          detail: {
            message: "ID must not contains blanks.",
            type: utilsNew_UtilsNew.MESSAGE_ERROR
          },
          bubbles: true,
          composed: true
        }));
      } else {
        this.interpretation = this._createInterpretation();
      }
    } else {
      this.dispatchEvent(new CustomEvent(this.eventNotifyName, {
        detail: {
          message: "ID must not be empty.",
          type: utilsNew_UtilsNew.MESSAGE_ERROR
        },
        bubbles: true,
        composed: true
      }));
    }
  }

  _createInterpretation() {
    try {
      // let userID = this.opencgaSession.opencgaClient._config.userId;
      // let interpretation = {};
      // interpretation.id = this.clinicalAnalysis.id + "_" + PolymerUtils.getValue(this._prefix + "IDInterpretation");
      // // interpretation.name = PolymerUtils.getValue(this._prefix + "NameInterpretation");
      // interpretation.description = PolymerUtils.getValue(this._prefix + "DescriptionInterpretation");
      // interpretation.clinicalAnalysisId = this.clinicalAnalysisId;
      // interpretation.software = {
      //     name: "TEAM",
      //     version: "2.0",
      //     website: "https://www.ncbi.nlm.nih.gov/pubmed/24861626",
      //     repository: "https://github.com/opencb/opencga",
      //     commit: "f43372aa",
      //     params: {}
      // };
      // interpretation.analyst = {
      //     name: userID,
      //     email: "",
      //     company: ""
      // };
      // interpretation.dependencies = [
      //     {
      //         name: "CellBase", repository: "https://github.com/opencb/cellbase", version: this.cellbaseVersion
      //     }
      // ];
      // interpretation.filters = this.query;
      // //                interpretation.creationDate = Date();
      // interpretation.comments = [{
      //     author: userID,
      //     type: "comment",
      //     text: PolymerUtils.getValue(this._prefix + "CommentInterpretation"),
      //     date: moment(new Date(), "YYYYMMDDHHmmss").format('D MMM YY')
      // }];
      //
      // // Remove 'stateCheckbox' from the variant list. When we receive the list from the grid, we are getting
      // // an additional field that should not be present in a reported variant.
      // let reportedVariants = [];
      // for (let i in this.reportedVariants) {
      //     let variant = Object.assign({}, this.reportedVariants[i]);
      //     delete variant['stateCheckBox'];
      //     reportedVariants.push(variant);
      // }
      // interpretation.primaryFindings = reportedVariants;
      // interpretation.attributes = {};
      // // interpretation.creationDate = moment(new Date(), "YYYYMMDDHHmmss").format('D MMM YY');
      let params = {
        study: this.opencgaSession.study.fqn
      };

      const _this = this;

      console.error("new client recheck");
      this.opencgaSession.opencgaClient.interpretations().create(this.clinicalAnalysis.id, params, interpretation).then(response => {
        console.log(response); // TODO We should update here clinicalAnalysis and add to interpretation list this file with its name from save interpertation form.

        console.error("interpretation ref is not defined");

        if (utilsNew_UtilsNew.isNotUndefinedOrNull(interpretation) && utilsNew_UtilsNew.isNotUndefinedOrNull(interpretation.clinicalAnalysis)) {
          if (utilsNew_UtilsNew.isEmptyArray(interpretation.clinicalAnalysis.interpretations)) {
            interpretation.clinicalAnalysis.interpretations = [];
          } else {
            interpretation.clinicalAnalysis.interpretations = interpretation.clinicalAnalysis.interpretations.map(interpretation => {
              return {
                id: interpretation.id,
                name: interpretation.name,
                file: interpretation.file.id
              };
            });
          }

          interpretation.clinicalAnalysis.interpretations.push({
            id: interpretation.id,
            name: interpretation.name,
            file: response.response[0].result[0].id
          });
        }

        params = {
          study: _this.opencgaSession.project.alias + ":" + _this.opencgaSession.study.alias
        };
        const interpretations = {
          interpretations: interpretation.clinicalAnalysis.interpretations
        };
        console.log("new clients change");

        _this.opencgaSession.opencgaClient.clinical().update(interpretation.clinicalAnalysis.id, interpretations, params).then(response => {
          this.dispatchEvent(new CustomEvent(this.eventNotifyName, {
            detail: {
              message: interpretation.id + " interpretation has been created correctly.",
              type: utilsNew_UtilsNew.MESSAGE_SUCCESS
            },
            bubbles: true,
            composed: true
          }));

          _this.cleanSaveInterpretation();

          console.log(response); // Update analysis with new interpretations

          _this.getAnalysisInterpretations();
        }).catch(err => {
          this.dispatchEvent(new CustomEvent(this.eventNotifyName, {
            detail: {
              message: err.error,
              type: utilsNew_UtilsNew.MESSAGE_ERROR
            },
            bubbles: true,
            composed: true
          }));
        });
      }).catch(err => {
        this.dispatchEvent(new CustomEvent(this.eventNotifyName, {
          detail: {
            message: err.error,
            type: utilsNew_UtilsNew.MESSAGE_ERROR
          },
          bubbles: true,
          composed: true
        }));
      });
    } catch (err) {
      this.dispatchEvent(new CustomEvent(this.eventNotifyName, {
        detail: {
          message: err,
          type: utilsNew_UtilsNew.MESSAGE_ERROR
        },
        bubbles: true,
        composed: true
      }));
    }
  }

  cleanSaveInterpretation() {
    PolymerUtils_PolymerUtils.setValue(this._prefix + "IDInterpretation", ""); // PolymerUtils.setValue(this._prefix + "NameInterpretation", "");

    PolymerUtils_PolymerUtils.setValue(this._prefix + "DescriptionInterpretation", "");
    PolymerUtils_PolymerUtils.setValue(this._prefix + "CommentInterpretation", "");
  }

  getAnalysisInterpretations() {
    const params = {
      study: this.opencgaSession.project.alias + ":" + this.opencgaSession.study.alias
    };

    const _this = this;

    this.opencgaSession.opencgaClient.clinical().info(this.clinicalAnalysis.id, params).then(function (response) {
      _this.showSummary = false;

      if (response.response[0].numResults === 1) {
        _this.clinicalAnalysis = response.response[0].result[0];
      }
    });
  }

  getDefaultConfig() {
    return {
      activeFilters: {
        alias: {// Example:
          // "region": "Region",
          // "gene": "Gene",
          // "genotype": "Sample Genotypes",
        },
        complexFields: ["genotype"],
        hiddenFields: ["study"]
      },
      genomeBrowser: {
        showTitle: false
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_variant_interpretation_editor_templateObject(), this._prefix, this.messageError ? lit_html_lit_html_html(opencga_variant_interpretation_editor_templateObject2(), this._prefix, this.messageErrorText) : null, this.messageSuccess ? lit_html_lit_html_html(opencga_variant_interpretation_editor_templateObject3(), this._prefix, this.messageSuccessText) : null, this._prefix, this.interpretationCollapsed ? lit_html_lit_html_html(opencga_variant_interpretation_editor_templateObject4()) : lit_html_lit_html_html(opencga_variant_interpretation_editor_templateObject5()), this._prefix, this.isCreate ? lit_html_lit_html_html(opencga_variant_interpretation_editor_templateObject6(), this._prefix, this._prefix, this.onInputChange, this._interpretation.id) : lit_html_lit_html_html(opencga_variant_interpretation_editor_templateObject7(), this._prefix, this._prefix, this.onInputChange), this._prefix, this._prefix, this._prefix, this._prefix, this.onInputChange, this.toggleVariantsCollapsed, this._prefix, this.variantsCollapsed ? lit_html_lit_html_html(opencga_variant_interpretation_editor_templateObject8()) : lit_html_lit_html_html(opencga_variant_interpretation_editor_templateObject9()), this._prefix, this.isInterpretedVariants ? lit_html_lit_html_html(opencga_variant_interpretation_editor_templateObject10(), this.opencgaSession, this._interpretation.primaryFindings, this.clinicalAnalysis, this.consequenceTypes, this.populationFrequencies, this.proteinSubstitutionScores, this._config.grid, this.selectedGene, this.onSelectVariant2, this.onCheckVariant, this.onReviewVariant, this.onGenomeBrowserPositionChange, this.opencgaSession, this.cellbaseClient, this.selectedVariant, this.clinicalAnalysis, this.consequenceTypes, this.proteinSubstitutionScores, this._config.detail) : lit_html_lit_html_html(opencga_variant_interpretation_editor_templateObject11()), this.onViewInterpretation, this.onSaveInterpretation, this.interpretationView ? lit_html_lit_html_html(opencga_variant_interpretation_editor_templateObject12(), this.interpretationView, this.opencgaSession, this.opencgaSession.opencgaClient, this.cellbaseClient, this.consequenceTypes, this.proteinSubstitutionScores) : null, !this.checkProjects);
  }

}
customElements.define("opencga-variant-interpretation-editor", opencga_variant_interpretation_editor_OpencgaVariantInterpretationEditor);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/opencga-variant-family-analysis.js
function opencga_variant_family_analysis_templateObject3() {
  const data = opencga_variant_family_analysis_taggedTemplateLiteral(["\n                <div class=\"col-md-8 col-md-offset-2\" style=\"padding: 20px\">\n                    <div class=\"alert alert-warning\" role=\"alert\" id=\"", "Warning\" style=\"font-size: 14px;margin-bottom: 10px\">\n                        <span style=\"font-style: italic; font-weight: bold\">", " </span> require at least one parent,\n                        no parents found for proband <b>", "</b>.\n                    </div>\n                </div>\n            "]);

  opencga_variant_family_analysis_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_variant_family_analysis_templateObject2() {
  const data = opencga_variant_family_analysis_taggedTemplateLiteral(["\n            <div class=\"col-md-12\" style=\"padding: 10px 0px\">\n                    <div class=\"col-md-2\">\n                        <opencga-variant-filter .opencgaSession=\"", "\"\n                                                .query=\"", "\"\n                                                .clinicalAnalysis=\"", "\"\n                                                .cellbaseClient=\"", "\"\n                                                .populationFrequencies=\"", "\"\n                                                .consequenceTypes=\"", "\"\n                                                .config=\"", "\"\n                                                @queryChange=\"", "\"\n                                                @querySearch=\"", "\"\n                                                @samplechange=\"", "\"\n                                                @inheritancemode=\"", "\">\n                        </opencga-variant-filter>\n                    </div>\n\n                    <div class=\"col-md-10\">\n                        <opencga-active-filters .opencgaSession=\"", "\"\n                                                .defaultStudy=\"", "\"\n                                                .query=\"", "\"\n                                                .refresh=\"", "\"\n                                                .filters=\"", "\"\n                                                .filterBioformat=\"VARIANT\"\n                                                .alias=\"", "\"\n                                                .genotypeSamples=\"", "\"\n                                                .modeInheritance=\"", "\"\n                                                .config=\"", "\"\n                                                @activeFilterChange=\"", "\"\n                                                @activeFilterClear=\"", "\">\n\n                        </opencga-active-filters>\n\n                        <div style=\"padding-top: 5px\">\n                            <opencga-variant-interpretation-grid .opencgaSession=\"", "\"\n                                                                 .query=\"", "\"\n                                                                 .clinicalAnalysis=\"", "\"\n                                                                 .consequenceTypes=\"", "\"\n                                                                 .populationFrequencies=\"", "\"\n                                                                 .proteinSubstitutionScores=\"", "\"\n                                                                 .config=\"", "\"\n                                                                 @selected=\"", "\"\n                                                                 @selectvariant=\"", "\"\n                                                                 @checkvariant=\"", "\"\n                                                                 @setgenomebrowserposition=\"", "\">\n                            </opencga-variant-interpretation-grid>\n\n                            <!-- Bottom tabs with detailed variant information -->\n                            <opencga-variant-interpretation-detail .opencgaSession=\"", "\"\n                                                                   .cellbaseClient=\"", "\"\n                                                                   .variant=\"", "\"\n                                                                   .clinicalAnalysis=\"", "\"\n                                                                   .consequenceTypes=\"", "\"\n                                                                   .proteinSubstitutionScores=\"", "\"\n                                                                   .config=", ">\n                            </opencga-variant-interpretation-detail>\n                        </div>\n                    </div>\n                </div>\n            "]);

  opencga_variant_family_analysis_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_variant_family_analysis_templateObject() {
  const data = opencga_variant_family_analysis_taggedTemplateLiteral(["\n        <style>\n            .qtip-family-class {\n                max-width: 480px;\n                font-size: 12px;\n            }\n        </style>\n\n        <div class=\"row\">\n            <div class=\"col-md-12\">\n                <h4 id=\"", "Title\" class=\"form-section-title\" style=\"margin: 5px 0px;padding: 0px 10px\">\n                    ", "\n                    <span id=\"", "family-info-icon\" style=\"color: #337ab7; padding-left: 20px\">\n                        <i class='fa fa-info-circle' aria-hidden='true'></i>\n                    </span>\n                </h4>\n            </div>\n\n            ", "\n        </div>\n        "]);

  opencga_variant_family_analysis_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_variant_family_analysis_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_variant_family_analysis_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_variant_family_analysis_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_variant_family_analysis_ownKeys(Object(source), true).forEach(function (key) { opencga_variant_family_analysis_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_variant_family_analysis_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_variant_family_analysis_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */







class opencga_variant_family_analysis_OpencgaVariantFamilyAnalysis extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      clinicalAnalysis: {
        type: Object
      },
      query: {
        type: Object
      },
      mode: {
        type: String
      },
      cellbaseClient: {
        type: Object
      },
      active: {
        type: Boolean
      },
      consequenceTypes: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    // All id fields in the template must start with prefix, this allows components to be instantiated more than once
    this._prefix = "ovdna" + utils.randomString(6) + "_";
    this.existParent = true;
    this._samples = [];
    this._sampleIds = [];
    this._individualToSampleIds = {}; // Initially we set the default config, this will be overridden if 'config' is passed
    // this._config = this.getDefaultConfig();
    //this.mode = "interactive";

    this.active = true;
  } //TODO RECHECK
  // ADD FLAG to avoid repeated calls


  connectedCallback() {
    super.connectedCallback(); //since _config.filter.menu.skipSubsections in going to be edited, a deep copy of this.config is required

    const _config = $.extend(true, this.getDefaultConfig(), this.config, {
      title: this.getDefaultConfig().title,
      tooltip: this.getDefaultConfig().tooltip
    });

    if (this.mode !== "interactive") {
      _config.filter.skipSubsections.push("sample");
    }

    this._config = _config;

    this._addTooltip();
  }

  updated(changedProperties) {
    if (changedProperties.has("clinicalAnalysis")) {
      this.clinicalAnalysisObserver();
    }

    if (changedProperties.has("query")) {
      this.queryObserver();
    }

    if (changedProperties.has("active")) {
      this.activeObserver();
    }
  }

  firstUpdated(_changedProperties) {}

  clinicalAnalysisObserver() {
    console.log("clinicalAnalysisObserver", this.clinicalAnalysis);

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis)) {
      this._calculateSamples();

      if (this.mode !== "interactive" && utilsNew_UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis.roleToProband)) {
        let _existParent = false;

        for (const individualId of Object.keys(this.clinicalAnalysis.roleToProband)) {
          if (this.clinicalAnalysis.roleToProband[individualId] === "FATHER" || this.clinicalAnalysis.roleToProband[individualId] === "MOTHER") {
            if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis.files) && utilsNew_UtilsNew.isNotEmptyArray(this.clinicalAnalysis.files[this._individualToSampleIds[individualId]])) {
              for (const file of this.clinicalAnalysis.files[this._individualToSampleIds[individualId]]) {
                if (file.format === "VCF" && utilsNew_UtilsNew.isNotUndefinedOrNull(file.index.status) && file.index.status.name === "READY") {
                  _existParent = true;
                  break;
                }
              }
            }
          }
        }

        this.existParent = _existParent;
      } // Init query objects every time there is a new session or clinical analysis


      const _query = Object.assign({}, this.query, {
        study: this.opencgaSession.study.fqn,
        includeSample: this._sampleIds.join(",")
      });

      switch (this.mode) {
        case "interactive":
          const _genotypes = [];

          for (const sampleId of this._sampleIds) {
            if (this.clinicalAnalysis.proband.samples[0].id === sampleId) {
              _genotypes.push(sampleId + ":0/1,1/1");
            } else {
              _genotypes.push(sampleId + ":0/0,0/1,1/1");
            }
          }

          _query.genotype = _genotypes.join(";");
          break;

        case "compoundHeterozygous":
          _query.biotype = "protein_coding";
          _query.ct = "missense_variant," + this._config.filter.lof.join(",");
          break;
      } // Reset query when new session or clinical analysis is provided


      this.query = opencga_variant_family_analysis_objectSpread({}, this.query, {}, _query);
    }
  }

  queryObserver() {
    if (this.query) {
      this.preparedQuery = this._prepareQuery(this.query);
      this.executedQuery = opencga_variant_family_analysis_objectSpread({}, this.preparedQuery);
    }

    this.requestUpdate();
  }

  activeObserver() {
    if (this.active) {// this.executedQuery = Object.assign({}, this.executedQuery);
    }
  }

  onVariantFilterChange(e) {
    this.preparedQuery = this._prepareQuery(e.detail.query); //console.log("onVariantFilterChange preparedQuery", this.preparedQuery)

    this.preparedQuery = opencga_variant_family_analysis_objectSpread({}, this.preparedQuery);
    this.requestUpdate();
  }

  onVariantFilterSearch(e) {
    this.preparedQuery = this._prepareQuery(e.detail.query);
    this.executedQuery = opencga_variant_family_analysis_objectSpread({}, this.preparedQuery);
    this.requestUpdate();
  }

  onActiveFilterChange(e) {
    //console.log("onActiveFilterChange", e.detail)
    this.query = opencga_variant_family_analysis_objectSpread({}, e.detail);
    this.preparedQuery = opencga_variant_family_analysis_objectSpread({}, e.detail);
    this.requestUpdate();
  }

  onActiveFilterClear() {
    this.query = {
      study: this.opencgaSession.study.fqn
    };
    this.preparedQuery = opencga_variant_family_analysis_objectSpread({}, this.query);
    this.requestUpdate();
  }

  onSelectVariant(e) {
    this.variant = e.detail.variant;
  }

  onCheckVariant(e) {
    this.dispatchEvent(new CustomEvent("checkvariant", {
      detail: e.detail
    }));
  }

  _prepareQuery(query) {
    let _query = Object.assign({}, query, {
      study: this.opencgaSession.study.fqn,
      includeSample: this._sampleIds.join(",")
    });

    if (this.mode === "interactive") {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(_query.genotype)) {
        delete _query.sample;
      } else {
        if (utilsNew_UtilsNew.isUndefinedOrNull(_query.sample)) {
          _query.sample = this._sampleIds.join(",");
        }
      }

      delete _query.family;
      return _query;
    } else {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis.family)) {
        _query = Object.assign({}, _query, {
          // Replace family and familyDisorder with clinicalAnalysisId
          family: this.clinicalAnalysis.family.id,
          familyDisorder: this.clinicalAnalysis.disorder.id,
          familySegregation: this.mode
        });
        delete _query.genotype;
        delete _query.sample;

        if (this.mode === "compoundHeterozygous") {
          _query.biotype = "protein_coding";
        }

        return _query;
      }
    }
  }

  _calculateSamples() {
    const _samples = [];
    const _sampleIds = [];
    const _individualToSampleIds = {};

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis.family) && utilsNew_UtilsNew.isNotEmptyArray(this.clinicalAnalysis.family.members)) {
      this.clinicalAnalysis.family.members.forEach(individual => {
        if (utilsNew_UtilsNew.isNotEmptyArray(individual.samples)) {
          _samples.push(individual.samples[0]);

          _sampleIds.push(individual.samples[0].id);

          _individualToSampleIds[individual.id] = individual.samples[0].id;
        }
      });
    }

    this._samples = _samples;
    this._sampleIds = _sampleIds;
    this._individualToSampleIds = _individualToSampleIds;
  }

  _addTooltip() {
    $("#" + this._prefix + "family-info-icon").qtip({
      content: {
        title: "information",
        text: this._config.tooltip
      },
      position: {
        target: "mouse",
        // my: (config !== undefined && config.position !== undefined && config.position.my !== undefined) ? config.position.my : "top left",
        adjust: {
          x: 2,
          y: 2,
          mouse: false
        }
      },
      style: {
        classes: "qtip-light qtip-rounded qtip-shadow qtip-family-class",
        width: "480px"
      },
      show: {
        delay: 250
      },
      hide: {
        fixed: true,
        delay: 300
      }
    });
  }

  getDefaultConfig() {
    switch (this.mode) {
      case "interactive":
        return {
          title: "Interactive Variant Interpretation Analysis",
          tooltip: "<p>\n                                        <span style=\"font-weight: bold\">Interactive Variant</span> analysis allows clinicians to filter\n                                        variants from the left menu and perform a clinical analysis. Results can be stored as an Interpretation.\n                                      </p>",
          activeFilters: {
            alias: {// Example:
              // "region": "Region",
            },
            complexFields: ["genotype"],
            hiddenFields: ["study", "sample", "includeSample"]
          },
          genomeBrowser: {
            showTitle: false
          }
        };

      case "compoundHeterozygous":
        return {
          title: "Compound Heterozygous Variant Analysis",
          tooltip: "<p>\n                                        <span style=\"font-weight: bold\">Compound Heterozygous Variant</span> in medical genetics is the\n                                        condition of having two heterozygous recessive alleles at a particular gene locus that can cause a\n                                        genetic disease in a heterozygous state, one on each chromosome of a pair. You can find more\n                                        information at <a href=\"https://en.wikipedia.org/wiki/Compound_heterozygosity\" target=\"_blank\">Wikipedia</a>\n                                      </p>\n                                      <p>\n                                        Compound Heterozygous variant analysis sets automatically the <span style=\"font-weight: bold\">genotype</span>\n                                        and <span style=\"font-weight: bold\">biotype (protein_coding)</span> filters. However,\n                                        you can use any other selected filter from the left menu. Note that finding Compound Heterozygous variants\n                                        can take few seconds depending on the OpenCGA server installation.\n                                      </p>",
          activeFilters: {
            alias: {// "region": "Region",
            },
            complexFields: ["genotype"],
            hiddenFields: ["study", "family", "familyDisorder", "familySegregation", "includeSample"],
            lockedFields: [{
              id: "biotype",
              message: "'biotype' filter is mandatory in Compound Heterozygous analysis"
            }]
          }
        };

      case "deNovo":
        return {
          title: "de Novo Variant Analysis",
          tooltip: "<p>\n                                        <span style=\"font-weight: bold\">de Novo Variant</span> is a genetic alteration that is present\n                                        for the first time in one family member as a result of a variant (or mutation) in a germ cell (egg or sperm)\n                                        of one of the parents, or a variant that arises in the fertilized egg itself during early embryogenesis.\n                                    </p>\n                                    <p>\n                                        de Novo variant analysis sets automatically the <span style=\"font-weight: bold\">genotype</span> filter.\n                                        However, you can use any other selected filter from the left menu. Note that finding de Novo variants can take few seconds\n                                        depending on the OpenCGA server installation.\n                                    </p>",
          activeFilters: {
            alias: {// "region": "Region",
            },
            complexFields: ["genotype"],
            hiddenFields: ["study", "family", "familyDisorder", "familySegregation", "includeSample"]
          }
        };
    }
  }

  render() {
    return lit_html_lit_html_html(opencga_variant_family_analysis_templateObject(), this._prefix, this._config.title, this._prefix, this.existParent ? lit_html_lit_html_html(opencga_variant_family_analysis_templateObject2(), this.opencgaSession, this.query, this.clinicalAnalysis, this.cellbaseClient, this.populationFrequencies, this.consequenceTypes, this._config.filter, this.onVariantFilterChange, this.onVariantFilterSearch, this.onSampleChange, this._onInheritanceMode, this.opencgaSession, this.opencgaSession.study.alias, this.preparedQuery, this.executedQuery, this._config.filter.examples, this._config.activeFilterAlias, this.genotypeSamples, this.modeInheritance, this._config.activeFilters, this.onActiveFilterChange, this.onActiveFilterClear, this.opencgaSession, this.executedQuery, this.clinicalAnalysis, this.consequenceTypes, this.populationFrequencies, this.proteinSubstitutionScores, this.config.grid, this.selectedGene, this.onSelectVariant, this.onCheckVariant, this.onGenomeBrowserPositionChange, this.opencgaSession, this.cellbaseClient, this.variant, this.clinicalAnalysis, this.consequenceTypes, this.proteinSubstitutionScores, this.config.detail) : lit_html_lit_html_html(opencga_variant_family_analysis_templateObject3(), this._prefix, this._config.title, this.clinicalAnalysis.proband.id));
  }

}
customElements.define("opencga-variant-family-analysis", opencga_variant_family_analysis_OpencgaVariantFamilyAnalysis);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/cellbase/core/cellbase-gene-filter.js
function cellbase_gene_filter_templateObject() {
  const data = cellbase_gene_filter_taggedTemplateLiteral(["\n        <!--<input id=\"", "FeatureIdText\" type=\"text\" class=\"form-control\" list$=\"", "FeatureDatalist\"-->\n               <!--placeholder=\"Search for Gene Symbols\" value=\"\" on-change=\"onGeneChange\">-->\n        <!--<datalist id=\"", "FeatureDatalist\"></datalist>-->\n\n        <div class=\"input-group\">\n            <input id=\"", "FeatureIdText\" type=\"text\" class=\"form-control\" list=\"", "FeatureDatalist\"\n                   placeholder=\"Search for Gene Symbols\" value=\"\" @change=\"", "\">\n            <datalist id=\"", "FeatureDatalist\"></datalist>\n\n            <span class=\"input-group-btn\">\n                <button class=\"btn btn-default\" type=\"button\" @click=\"", "\">\n                    <i class=\"fa fa-eraser\" aria-hidden=\"true\"></i>\n                </button>\n            </span>\n        </div>\n        "]);

  cellbase_gene_filter_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function cellbase_gene_filter_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */




class cellbase_gene_filter_CellbaseGeneFilter extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      cellbaseClient: {
        type: Object
      },
      erase: {
        type: Boolean
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "CellbaseGeneFilter" + utils.randomString(6) + "_"; // Initially we set the default config, this will be overridden if 'config' is passed

    this._config = this.getDefaultConfig();
  }

  updated(changedProperties) {
    if (changedProperties.has("erase")) {
      this.eraseObserver();
    }
  }

  firstUpdated(_changedProperties) {
    // Add events for Feature IDs
    PolymerUtils_PolymerUtils.getElementById(this._prefix + "FeatureIdText").addEventListener("keyup", this.callAutocomplete.bind(this));
  }

  eraseObserver(newValue, oldValue) {
    if (newValue !== oldValue) {
      this.clear();
    }
  }

  callAutocomplete(e) {
    // Only gene symbols are going to be searched and not Ensembl IDs
    const featureId = PolymerUtils_PolymerUtils.getElementById(this._prefix + "FeatureIdText").value;

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(featureId) && featureId.length >= 3 && !featureId.startsWith("ENS")) {
      const _this = this;

      _this.cellbaseClient.get("feature", "id", featureId.toUpperCase(), "starts_with", {
        limit: 15
      }, {}).then(function (response) {
        let options = "";

        for (const id of response.response[0].result) {
          options += "<option value=\"".concat(id.name, "\">");
        }

        PolymerUtils_PolymerUtils.innerHTML(_this._prefix + "FeatureDatalist", options);
      });
    }
  }

  clear() {
    PolymerUtils_PolymerUtils.setValue(this._prefix + "FeatureIdText", "");
    this.gene = "";
  }

  onGeneChange(e) {
    this.gene = e.target.value;
    this.dispatchEvent(new CustomEvent("genechange", {
      detail: {
        gene: e.target.value
      },
      bubbles: false,
      composed: true
    }));
  }

  onEraserClicked() {
    this.clear();
  }

  getDefaultConfig() {
    return {};
  }

  render() {
    return lit_html_lit_html_html(cellbase_gene_filter_templateObject(), this._prefix, this._prefix, this._prefix, this._prefix, this._prefix, this.onGeneChange, this._prefix, this.onEraserClicked);
  }

}
customElements.define("cellbase-gene-filter", cellbase_gene_filter_CellbaseGeneFilter);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/opencga/alignment/opencga-panel-transcript-view.js
function opencga_panel_transcript_view_templateObject14() {
  const data = opencga_panel_transcript_view_taggedTemplateLiteral(["\n                                            <td>", "</td>\n                                            <td>", "</td>\n                                            <td>", "</td>\n                                            <td>", "</td>\n                                        "]);

  opencga_panel_transcript_view_templateObject14 = function _templateObject14() {
    return data;
  };

  return data;
}

function opencga_panel_transcript_view_templateObject13() {
  const data = opencga_panel_transcript_view_taggedTemplateLiteral(["\n                                    <tr class=\"detail-view-row\">\n                                        <td>", "</td>\n                                        <td>", "</td>\n                                        <td>", "</td>\n                                        <td>", "</td>\n                                        <td>", "</td>\n                                        ", "\n                                    </tr>\n                                "]);

  opencga_panel_transcript_view_templateObject13 = function _templateObject13() {
    return data;
  };

  return data;
}

function opencga_panel_transcript_view_templateObject12() {
  const data = opencga_panel_transcript_view_taggedTemplateLiteral(["\n                                        <th rowspan=\"1\">% covered</th>\n                                        <th rowspan=\"1\">Average</th>\n                                        <th rowspan=\"1\">Max</th>\n                                        <th rowspan=\"1\">Min</th>\n                                    "]);

  opencga_panel_transcript_view_templateObject12 = function _templateObject12() {
    return data;
  };

  return data;
}

function opencga_panel_transcript_view_templateObject11() {
  const data = opencga_panel_transcript_view_taggedTemplateLiteral(["\n                                        <th rowspan=\"1\" colspan=\"4\" style=\"", "\">\n                                            ", "\n                                            <i class$=\"fa ", " fa-lg\" style='padding-left: 5px'></i>\n                                        </th>\n                                    "]);

  opencga_panel_transcript_view_templateObject11 = function _templateObject11() {
    return data;
  };

  return data;
}

function opencga_panel_transcript_view_templateObject10() {
  const data = opencga_panel_transcript_view_taggedTemplateLiteral(["\n                <!--Low covered regions table-->\n                    <div class=\"col-md-12\">\n                        <div style='padding: 10px 0px 10px 25px'>\n                            <h4>Low covered regions</h4>\n                        </div>\n\n                        <div style='padding: 5px 50px'>\n                            <table id=\"", "LowCoveredRegions\" class=\"table table-hover table-no-bordered\">\n                                <thead>\n                                <tr>\n                                    <th rowspan=\"2\">Position</th>\n                                    <th rowspan=\"2\">Length</th>\n                                    <th rowspan=\"1\" colspan=\"3\" style=\"", "\">\n                                        {{_probandFile.name}}\n                                        <i class=\"fa ", " fa-lg\" style='padding-left: 5px'></i>\n                                    </th>\n                                    ", "\n                                    <!--                                <th rowspan=\"1\" colspan$=\"{{_numberOfFiles}}\" style=\"text-align: center\">Medium coverage</th>-->\n\n                                </tr>\n                                <tr>\n                                    <th rowspan=\"1\">Average</th>\n                                    <th rowspan=\"1\">Max</th>\n                                    <th rowspan=\"1\">Min</th>\n\n                                    <!--TODO recheck this-->\n                                    ", "\n                                </tr>\n                                </thead>\n                                <tbody>\n                                ", "\n                                \n                                </tbody>\n                            </table>\n                        </div>\n                    </div>\n                "]);

  opencga_panel_transcript_view_templateObject10 = function _templateObject10() {
    return data;
  };

  return data;
}

function opencga_panel_transcript_view_templateObject9() {
  const data = opencga_panel_transcript_view_taggedTemplateLiteral(["\n                        <h3 class=\"form-section-title\">{{selectedGene}} Gene Low Coverage</h3>\n                    "]);

  opencga_panel_transcript_view_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function opencga_panel_transcript_view_templateObject8() {
  const data = opencga_panel_transcript_view_taggedTemplateLiteral(["\n                                                <option>", "</option>\n                                            "]);

  opencga_panel_transcript_view_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_panel_transcript_view_templateObject7() {
  const data = opencga_panel_transcript_view_taggedTemplateLiteral(["\n                                        <optgroup label=\"", "\">\n                                            ", "\n                                        </optgroup>\n                                    "]);

  opencga_panel_transcript_view_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_panel_transcript_view_templateObject6() {
  const data = opencga_panel_transcript_view_taggedTemplateLiteral(["\n                                            <option>", "</option>\n                                        "]);

  opencga_panel_transcript_view_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_panel_transcript_view_templateObject5() {
  const data = opencga_panel_transcript_view_taggedTemplateLiteral(["\n                                <i class=\"fa fa-caret-down\" aria-hidden=\"true\" style=\"padding-right: 5px\"></i>\n                            "]);

  opencga_panel_transcript_view_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_panel_transcript_view_templateObject4() {
  const data = opencga_panel_transcript_view_taggedTemplateLiteral(["\n                                <i class=\"fa fa-caret-right\" aria-hidden=\"true\" style=\"padding-right: 5px\"></i>\n                            "]);

  opencga_panel_transcript_view_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_panel_transcript_view_templateObject3() {
  const data = opencga_panel_transcript_view_taggedTemplateLiteral(["\n                <div class=\"col-md-12\">\n                    <!--<h3 class=\"form-section-title\">Low Coverage Filters</h3>-->\n\n                    <div style=\"display: block; cursor:pointer;\" @click=\"", "\"\n                         data-toggle=\"collapse\" href=\"#", "collapsibleFilter\">\n                        <h3 class=\"form-section-title\">\n                            ", "\n                            Low Coverage Filters\n                        </h3>\n                    </div>\n\n\n                    <div id=\"", "collapsibleFilter\" class=\"form-horizontal collapse in\" style=\"padding: 5px 10px\">\n\n                        <div class=\"form-group\">\n                            <label class=\"control-label col-md-1 jso-label-title\">Search by Gene</label>\n                            <div class=\"col-md-3\">\n                                <cellbase-gene-filter .cellbaseClient=\"", "\"\n                                                      .erase=\"", "\"\n                                                      @genechange=\"", "\">\n                                </cellbase-gene-filter>\n                                <!--<button type=\"button\" class=\"btn btn-primary\" on-click=\"onSearchGeneClicked\">Search</button>-->\n                                <!--<span class=\"input-group-btn\">-->\n                                <!--<button class=\"btn btn-default\" type=\"button\" on-click=\"onSearchGeneClicked\">-->\n                                <!--<i class=\"fa fa-eraser\" aria-hidden=\"true\"></i>-->\n                                <!--</button>-->\n                                <!--</span>-->\n                            </div>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label class=\"control-label col-md-1 jso-label-title\">Select a Gene from Panel</label>\n                            <div class=\"col-md-3\">\n                                <select class=\"selectpicker\" id=\"", "-geneSelect\" data-live-search=\"true\" data-max-options=\"1\"\n                                        on-dom-change=\"renderDomRepeat\" multiple>\n                                    <optgroup label=\"Selected Genes\">\n                                        ", "\n                                        </optgroup>\n\n                                    ", "\n                                </select>\n                            </div>\n                        </div>\n\n                        <!--on-change=\"onLowCoverageThresholdChange\"-->\n                        <div class=\"form-group\">\n                            <label class=\"control-label col-md-1 jso-label-title\">Select Low Coverage</label>\n                            <div class=\"col-md-3\">\n                                <select class=\"selectpicker\" id=\"", "-lowCoverageThreshold\" data-width=\"fit\">\n                                    <option>5</option>\n                                    <option>10</option>\n                                    <option>15</option>\n                                    <option selected>20</option>\n                                    <option>25</option>\n                                    <option>30</option>\n                                    <option>35</option>\n                                    <option>40</option>\n                                </select>\n                            </div>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <div class=\"col-md-offset-3 col-md-9\">\n                                <button type=\"submit\" class=\"btn btn-primary\" @click=\"", "\">Clear</button>\n                                <button type=\"submit\" class=\"btn btn-primary\" @click=\"", "\">Render</button>\n                            </div>\n                        </div>\n                    </div>\n\n                </div>\n\n\n                <div class=\"col-md-12\">\n                    ", "\n                    <div id=\"", "-svg\" style=\"padding: 20px\"></div>\n                </div>\n\n                ", "\n            "]);

  opencga_panel_transcript_view_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_panel_transcript_view_templateObject2() {
  const data = opencga_panel_transcript_view_taggedTemplateLiteral(["\n                <h4 style=\"color: #940303; margin: 20px 0px; text-align: center\">\n                    No files available.\n                </h4>\n            "]);

  opencga_panel_transcript_view_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_panel_transcript_view_templateObject() {
  const data = opencga_panel_transcript_view_taggedTemplateLiteral(["\n<style include=\"jso-styles\">\n            .form-section-title {\n                padding: 5px 0px;\n                width: 80%;\n                border-bottom-width: 1px;\n                border-bottom-style: solid;\n                border-bottom-color: #ddd\n            }\n\n            .jso-label-title {\n                width: 15em !important;\n            }\n        </style>\n\n        <div class=\"row\" style=\"padding: 0px 10px; margin: 10px 0px;\">\n\n            ", "\n        </div>\n        "]);

  opencga_panel_transcript_view_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_panel_transcript_view_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */




class opencga_panel_transcript_view_OpencgaPanelTranscriptView extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      clinicalAnalysisId: {
        type: String
      },
      clinicalAnalysis: {
        type: Object
      },
      geneIds: {
        type: Array
      },
      panelIds: {
        type: Array
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "PanelTranscriptView" + utils.randomString(6) + "_";
    this.eraseSearchGene = false;
    this._filtersCollapsed = false; // The component will show an error message instead of the whole app if no alignment files are found

    this._disabled = true;
    this._lowCoverageValues = [];
    this.showCoverageTable = false; // Initially we set the default config, this will be overridden if 'config' is passed

    this._config = this.getDefaultConfig();
  }

  updated(changedProperties) {
    if (changedProperties.has("clinicalAnalysisId")) {
      this.clinicalAnalysisIdObserver();
    }

    if (changedProperties.has("opencgaSession") || changedProperties.has("clinicalAnalysis") || changedProperties.has("panelIds") || changedProperties.has("geneIds") || changedProperties.has("config")) {
      this.propertyObserver(this.opencgaSession, this.clinicalAnalysis, this.panelIds, this.geneIds, this.config);
    }
  }

  firstUpdated(_changedProperties) {
    // We add this listener to receive any future change over the selected genes
    $("#".concat(this._prefix, "-geneSelect")).on("changed.bs.select", this.onGeneChange.bind(this));
    $("select.selectpicker", this).selectpicker("render");
    $("select.selectpicker", this).selectpicker({
      iconBase: "fa",
      tickIcon: "fa-check"
    });
  }

  propertyObserver(opencgaSession, clinicalAnalysis, panelIds, geneIds, config) {
    this._config = Object.assign(this.getDefaultConfig(), config);
    this.clear(); // if (UtilsNew.isNotUndefinedOrNull(config)) {
    // }

    this._files = [];
    this._numberOfFiles = 0;
    this._autoRenderWhenFilesAreRetrieved = false;
    this._initialiseCoverageTracks = true;

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession)) {
      const _this = this;

      if (utilsNew_UtilsNew.isNotEmptyArray(this.panelIds)) {
        this.opencgaSession.opencgaClient.panels().info(panelIds.join(","), {
          study: _this.opencgaSession.study.fqn,
          include: "id,name,genes"
        }).then(function (response) {
          // _this._panelGenesAvailable = true;
          const _panels = [];

          for (const panel of response.response) {
            _panels.push(panel.result[0]);
          }

          _this._genePanels = _panels;
        }).catch(response => {
          console.error("An error occurred fetching clinicalAnalysis: ", response);
        });
      } else {
        this._genePanels = [];
      }

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis)) {
        // let result = response.response[0].result[0];
        const disorder = clinicalAnalysis.disorder.id;
        const files = [];
        const members = {}; // member_id : member

        const samples = {}; // sample_id : member

        for (let i = 0; i < clinicalAnalysis.family.members.length; i++) {
          const member = clinicalAnalysis.family.members[i];
          members[member.id] = member;

          if (utilsNew_UtilsNew.isNotEmptyArray(member.samples)) {
            for (let j = 0; j < member.samples.length; j++) {
              samples[member.samples[j].id] = member;
            }
          }
        }

        const availableBigWigs = {}; // sample id - file id

        for (const key in clinicalAnalysis.files) {
          for (let i = 0; i < clinicalAnalysis.files[key].length; i++) {
            if (clinicalAnalysis.files[key][i].format === "BIGWIG") {
              availableBigWigs[key] = clinicalAnalysis.files[key][i].id;
            }
          }
        } // Get proband sample


        for (let i = 0; i < clinicalAnalysis.proband.samples.length; i++) {
          if (availableBigWigs.hasOwnProperty(clinicalAnalysis.proband.samples[i].id)) {
            // In theory, there should only be one BAM file available for each member
            files.push({
              id: availableBigWigs[clinicalAnalysis.proband.samples[i].id],
              // name: "Proband '" + clinicalAnalysis.proband.id + "'",
              name: "Proband '" + clinicalAnalysis.proband.samples[i].id + "'",
              sex: clinicalAnalysis.proband.sex,
              isProband: true,
              affectationStatus: this._getAffectationStatus(clinicalAnalysis.proband, disorder)
            }); // Take the bam out of the map

            delete availableBigWigs[clinicalAnalysis.proband.samples[i].id];
          }
        } // Get mother


        if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.proband.mother) && utilsNew_UtilsNew.isNotEmpty(clinicalAnalysis.proband.mother.id)) {
          const motherId = clinicalAnalysis.proband.mother.id;

          if (members.hasOwnProperty(motherId) && utilsNew_UtilsNew.isNotEmptyArray(members[motherId].samples) && availableBigWigs.hasOwnProperty(members[motherId].samples[0].id)) {
            files.push({
              id: availableBigWigs[members[motherId].samples[0].id],
              name: "Mother '" + members[motherId].samples[0].id + "'",
              // name: "Mother '" + motherId + "'",
              sex: members[motherId].sex,
              isProband: false,
              affectationStatus: this._getAffectationStatus(members[motherId], disorder)
            }); // Take the bam out of the map

            delete availableBigWigs[members[motherId].samples[0].id];
          }
        } // Get father


        if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.proband.father) && utilsNew_UtilsNew.isNotEmpty(clinicalAnalysis.proband.father.id)) {
          const fatherId = clinicalAnalysis.proband.father.id;

          if (members.hasOwnProperty(fatherId) && utilsNew_UtilsNew.isNotEmptyArray(members[fatherId].samples) && availableBigWigs.hasOwnProperty(members[fatherId].samples[0].id)) {
            files.push({
              id: availableBigWigs[members[fatherId].samples[0].id],
              name: "Father '" + members[fatherId].samples[0].id + "'",
              // name: "Father '" + fatherId + "'",
              sex: members[fatherId].sex,
              isProband: false,
              affectationStatus: this._getAffectationStatus(members[fatherId], disorder)
            }); // Take the bam out of the map

            delete availableBigWigs[members[fatherId].samples[0].id];
          }
        } // If there are any remaining BAM files, we will add them in a random position


        for (const key in availableBigWigs) {
          if (samples.hasOwnProperty(key)) {
            files.push({
              id: availableBigWigs[key],
              name: "Member '" + samples[key].id + "'",
              sex: samples[key].sex,
              isProband: false,
              affectationStatus: this._getAffectationStatus(samples[key], disorder)
            });
          } else {
            files.push({
              id: availableBigWigs[key],
              name: "Sample '" + key + "'",
              isProband: false
            });
          }
        }

        this._disabled = utilsNew_UtilsNew.isEmptyArray(files);
        this._files = files;
        this._numberOfFiles = files.length;

        if (this._autoRenderWhenFilesAreRetrieved) {
          this._displaySVG($("#".concat(_this._prefix, "-geneSelect")).selectpicker("val"), $("#".concat(this._prefix, "-lowCoverageThreshold")).selectpicker("val"));

          this._autoRenderWhenFilesAreRetrieved = false;
        }
      } else {
        this._disabled = true;
      }
    }
  }
  /**
   * Fetch the CinicalAnalysis object from REST and trigger the observer call.
   */


  clinicalAnalysisIdObserver() {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotEmpty(this.clinicalAnalysisId)) {
      const _this = this;

      this.opencgaSession.opencgaClient.clinical().info(this.clinicalAnalysisId, {
        study: this.opencgaSession.study.fqn
      }).then(function (response) {
        // This will trigger the call clinicalAnalysis observer
        _this.clinicalAnalysis = response.response[0].result[0];
      }).catch(response => {
        console.error("An error occurred fetching clinicalAnalysis: ", response);
      });
    }
  }

  _getAffectationStatus(member, disorderId) {
    let status = "UNAFFECTED";

    if (utilsNew_UtilsNew.isNotEmptyArray(member.disorders)) {
      for (const disorder of member.disorders) {
        if (utilsNew_UtilsNew.isNotUndefinedOrNull(disorder) && disorder.id === disorderId) {
          status = "AFFECTED";
          break;
        }
      }
    }

    return status;
  }

  renderDomRepeat(e) {
    $("#".concat(this._prefix, "-geneSelect")).selectpicker("refresh");
    $("#".concat(this._prefix, "-geneSelect")).selectpicker("deselectAll");
  }

  toggleCollapsedFilter() {
    // this.set("_filtersCollapsed", !this._filtersCollapsed);
    this._filtersCollapsed = !this._filtersCollapsed;
  }

  onInputGeneChange(e) {
    this._inputGene = e.detail.gene;
    $("#" + this._prefix + "-geneSelect").selectpicker("val", []);
  }

  onGeneChange(e) {
    this.selectedGene = $("#".concat(this._prefix, "-geneSelect")).selectpicker("val"); // This erase the text input of cellbase-gene web component

    this.eraseSearchGene = !this.eraseSearchGene; // this._displaySVG(e.currentTarget.value, $(`#${this._prefix}-lowCoverageThreshold`).selectpicker('val'));
  }

  onRender(e) {
    if (utilsNew_UtilsNew.isNotEmpty(this._inputGene)) {
      this.selectedGene = this._inputGene;

      this._displaySVG(this.selectedGene, $("#".concat(this._prefix, "-lowCoverageThreshold")).selectpicker("val"));
    } else if (utilsNew_UtilsNew.isNotEmpty(this.selectedGene)) {
      this._displaySVG(this.selectedGene, $("#".concat(this._prefix, "-lowCoverageThreshold")).selectpicker("val"));
    }
  }

  onClear(e) {
    this.clear();
  }

  clear() {
    // Clean the SVG in case there is anything drawn
    const children = $("#".concat(this._prefix, "-svg")).children();

    for (let i = 0; i < children.length; i++) {
      children[i].remove();
    }

    this._lowCoverageValues = [];
    this.showCoverageTable = false;
    this._initialiseCoverageTracks = true;
  }

  _displaySVG(geneId, threshold) {
    if (utilsNew_UtilsNew.isEmptyArray(this._files)) {
      // Probably the files are being fetched at this same moment. Force them to be rendered automatically after that
      this._autoRenderWhenFilesAreRetrieved = true;
      return;
    }

    if (utilsNew_UtilsNew.isEmpty(geneId)) {
      return;
    }

    this.lastGeneId = geneId;

    if (this._initialiseCoverageTracks) {
      const tracks = [];
      this._otherFiles = [];
      this._probandFile = {};

      for (let i = 0; i < this._files.length; i++) {
        let style = "";

        if (utilsNew_UtilsNew.isNotEmpty(this._files[i].affectationStatus)) {
          if (this._files[i].affectationStatus === "AFFECTED") {
            style = "color: darkred";
          } else if (this._files[i].affectationStatus === "UNKNOWN") {
            style = "color: gray";
          }
        }

        if (this._files[i].isProband) {
          style += ";font-weight: bold";
        }

        const sampleIcon = this._config.sexIConMap[this._files[i].sex];
        const htmlTitle = "<span style=\"".concat(style, "\">\n                                ").concat(this._files[i].name, "\n                                <i class='fa ").concat(sampleIcon, " fa-lg' style='padding-left: 5px'></i>\n                            </span>");

        if (this._files[i].isProband) {
          this._probandFile = {
            style: style,
            name: this._files[i].name,
            icon: sampleIcon,
            id: this._files[i].id
          };
        } else {
          this._otherFiles.push({
            style: style,
            name: this._files[i].name,
            icon: sampleIcon,
            id: this._files[i].id
          });
        }

        tracks.push(new LinearCoverageTrack({
          htmlTitle: htmlTitle,
          opencga: {
            client: this.opencgaSession.opencgaClient
          },
          targetId: "".concat(this._prefix, "-svg")
        }, {
          width: $("#".concat(this._prefix, "-svg")).width()
        }));
        this.coverageTracks = tracks;
      }

      this._initialiseCoverageTracks = false;
    }

    if (utilsNew_UtilsNew.isUndefinedOrNull(this.geneTrack)) {
      this.geneTrack = new LinearGeneTrack({
        name: geneId,
        targetId: "".concat(this._prefix, "-svg")
      }, {
        width: $("#".concat(this._prefix, "-svg")).width()
      });
    }

    const _this = this;

    this.cellbaseClient.get("feature", "gene", geneId, "info", {
      assembly: this.opencgaSession.project.organism.assembly
    }, {}).then(function (response) {
      const gene = response.response[0].result[0];
      const region = new Region("".concat(gene.chromosome, ":").concat(gene.start, "-").concat(gene.end));
      const promises = [];

      for (let i = 0; i < _this.coverageTracks.length; i++) {
        promises.push(_this.opencgaSession.opencgaClient.alignments().queryCoverage(_this._files[i].id, {
          region: region,
          study: _this.opencgaSession.study.fqn,
          windowSize: 1,
          threshold: threshold,
          sid: _this.opencgaSession.opencgaClient._config.sessionId
        }));

        _this.coverageTracks[i].draw({
          query: {
            region: region,
            study: _this.opencgaSession.study.fqn,
            fileId: _this._files[i].id
          },
          config: {
            regionOffset: _this._config.offset,
            lowCoverageThreshold: threshold
          }
        });
      }

      Promise.all(promises).then(function (responses) {
        let probandIdx = -1;

        for (let i = 0; i < _this._files.length; i++) {
          if (_this._files[i].isProband) {
            probandIdx = i;
            break;
          }
        }

        const coverageGroups = responses[probandIdx].response[0].result; // Format the main response

        for (let w = 0; w < coverageGroups.length; w++) {
          if (utilsNew_UtilsNew.isUndefinedOrNull(coverageGroups[w]["region"])) {
            coverageGroups[w]["region"] = "".concat(coverageGroups[w]["chromosome"], ":").concat(coverageGroups[w]["start"], "-").concat(coverageGroups[w]["end"]);
            coverageGroups[w]["length"] = coverageGroups[w]["end"] - coverageGroups[w]["start"] + 1;
            coverageGroups[w]["stats"]["average"] = coverageGroups[w]["stats"]["average"].toFixed(2);
            coverageGroups[w]["stats"]["max"] = coverageGroups[w]["stats"]["max"].toFixed(2);
            coverageGroups[w]["stats"]["min"] = coverageGroups[w]["stats"]["min"].toFixed(2);
          }
        }

        for (let i = 0; i < responses.length; i++) {
          if (probandIdx === i) {
            continue;
          }

          const fileId = _this._files[i].id;
          let responseIdx = 0;

          for (let w = 0; w < coverageGroups.length; w++) {
            coverageGroups[w][fileId] = {
              average: -1,
              max: -1,
              min: -1,
              covered: 0,
              regions: [],
              values: []
            };

            for (let j = responseIdx; j < responses[i].response[0].result.length; j++) {
              response = responses[i].response[0].result[j];

              if (response.start > coverageGroups[w].end) {
                break;
              }

              if (response.end < coverageGroups[w].start) {
                responseIdx = j;
                continue;
              }

              if (response.start >= coverageGroups[w].start && response.end <= coverageGroups[w].end) {
                // Completely contained within the coverage group
                const covered = (response.end - response.start + 1) / (coverageGroups[w].end - coverageGroups[w].start + 1);
                coverageGroups[w][fileId]["covered"] += covered;
                coverageGroups[w][fileId]["max"] = Math.max(coverageGroups[w][fileId]["max"], response.stats.max);
                coverageGroups[w][fileId]["min"] = coverageGroups[w][fileId]["min"] === -1 ? response.stats.min : Math.min(coverageGroups[w][fileId]["min"], response.stats.min);
                const region = "".concat(response.chromosome, ":").concat(response.start, ":").concat(response.end);
                coverageGroups[w][fileId]["regions"].push(region);
                coverageGroups[w][fileId]["values"] = coverageGroups[w][fileId]["values"].concat(response.values);
              } else if (response.start < coverageGroups[w].start && response.end > coverageGroups[w].end) {
                // Response contains completely the coverage group
                coverageGroups[w][fileId]["covered"] = 1;
                const startIdx = coverageGroups[w].start - response.start - 1;
                const endIdx = startIdx + coverageGroups[w].end - coverageGroups[w].start + 1;
                const values = response.values.slice(startIdx, endIdx);
                coverageGroups[w][fileId]["max"] = _this._getMaximumValue(0, values);
                coverageGroups[w][fileId]["min"] = _this._getMinimumValue(-1, values);
                const region = "".concat(response.chromosome, ":").concat(coverageGroups[w].start, ":").concat(coverageGroups[w].end);
                coverageGroups[w][fileId]["regions"].push(region);
                coverageGroups[w][fileId]["values"] = coverageGroups[w][fileId]["values"].concat(values);
              } else if (response.start < coverageGroups[w].start) {
                // Response overlaps the start of the coverageGroup
                const covered = (response.end - coverageGroups[w].start + 1) / (coverageGroups[w].end - coverageGroups[w].start + 1);
                coverageGroups[w][fileId]["covered"] += covered;
                const startIdx = coverageGroups[w].start - response.start - 1;
                const endIdx = startIdx + response.end - coverageGroups[w].start;
                const values = response.values.slice(startIdx, endIdx);
                coverageGroups[w][fileId]["max"] = _this._getMaximumValue(coverageGroups[w][fileId]["max"], values);
                coverageGroups[w][fileId]["min"] = _this._getMinimumValue(coverageGroups[w][fileId]["min"], values);
                const region = "".concat(response.chromosome, ":").concat(coverageGroups[w].start, ":").concat(response.end);
                coverageGroups[w][fileId]["regions"].push(region);
                coverageGroups[w][fileId]["values"] = coverageGroups[w][fileId]["values"].concat(values);
              } else {
                // Response overlaps the end of the coverageGroup
                const covered = (coverageGroups[w].end - response.start + 1) / (coverageGroups[w].end - coverageGroups[w].start + 1);
                coverageGroups[w][fileId]["covered"] += covered;
                const startIdx = 0;
                const endIdx = coverageGroups[w].end - response.start + 1;
                const values = response.values.slice(startIdx, endIdx);
                coverageGroups[w][fileId]["max"] = _this._getMaximumValue(coverageGroups[w][fileId]["max"], values);
                coverageGroups[w][fileId]["min"] = _this._getMinimumValue(coverageGroups[w][fileId]["min"], values);
                const region = "".concat(response.chromosome, ":").concat(response.start, ":").concat(coverageGroups[w].end);
                coverageGroups[w][fileId]["regions"].push(region);
                coverageGroups[w][fileId]["values"] = coverageGroups[w][fileId]["values"].concat(values);
              }
            }

            if (utilsNew_UtilsNew.isNotEmptyArray(coverageGroups[w][fileId]["values"])) {
              let values = 0;

              for (let i = 0; i < coverageGroups[w][fileId]["values"].length; i++) {
                values += coverageGroups[w][fileId]["values"][i];
              }

              coverageGroups[w][fileId]["average"] = values / coverageGroups[w][fileId]["values"].length;
              coverageGroups[w][fileId]["covered"] = coverageGroups[w][fileId]["covered"] * 100;
            }
          }
        }

        _this._lowCoverageValues = coverageGroups;

        if (_this._lowCoverageValues.length > 0) {
          _this.showCoverageTable = true;
        } // // Sort the positions
        // positions = positions.sort();
        //
        // // Now we need to group all the low coverage values by files
        // let coverageGroups = [];
        //
        // let lastGroup = "";
        // let groupedResult = {
        // };
        // let lastPosition = positions[0] - 1;
        //
        // for (let i = 0; i < positions.length; i++) {
        //     let group = "";
        //     let numberOfFiles = 0;
        //     for (let j = 0; j < _this._files.length; j++) {
        //         if (UtilsNew.isNotUndefinedOrNull(result[positions[i]][_this._files[j].id])) {
        //             group += _this._files[j].id;
        //             numberOfFiles += 1;
        //         }
        //     }
        //
        //     // Filter out low coverages over only one of the samples if the array of files contains more than one sample
        //     if (_this._files.length > 1 && numberOfFiles === 1) {
        //         continue;
        //     }
        //
        //     if ((lastGroup !== group || lastPosition + 1 < positions[i])) {
        //         if (Object.entries(groupedResult).length > 0) {
        //             coverageGroups.push(Object.assign({}, groupedResult));
        //         }
        //
        //         groupedResult = {
        //             start: positions[i]
        //         };
        //
        //         lastGroup = group;
        //     }
        //
        //
        //     for (let j = 0; j < _this._files.length; j++) {
        //         if (UtilsNew.isNotUndefinedOrNull(result[positions[i]][_this._files[j].id])) {
        //             if (UtilsNew.isUndefinedOrNull(groupedResult[_this._files[j].id])) {
        //                 groupedResult[_this._files[j].id] = [];
        //             }
        //             groupedResult[_this._files[j].id].push(result[positions[i]][_this._files[j].id]);
        //         }
        //     }
        //
        //     lastPosition = positions[i];
        // }
        //
        // // Add the last group
        // coverageGroups.push(Object.assign({}, groupedResult));
        //
        // // Calculate mean coverage for the groups
        // for (let i = 0; i < coverageGroups.length; i++) {
        //     for (let j = 0; j < _this._files.length; j++) {
        //         if (UtilsNew.isNotUndefinedOrNull(coverageGroups[i][_this._files[j].id])) {
        //             let sum = 0;
        //             for (let w = 0; w < coverageGroups[i][_this._files[j].id].length; w++) {
        //                 sum += coverageGroups[i][_this._files[j].id][w];
        //             }
        //
        //             coverageGroups[i].length = coverageGroups[i][_this._files[j].id].length;
        //             coverageGroups[i].end = coverageGroups[i].start + coverageGroups[i].length -1;
        //             coverageGroups[i].region = `${gene.chromosome}:${coverageGroups[i].start}-${coverageGroups[i].end}`;
        //             coverageGroups[i][_this._files[j].id] = sum / coverageGroups[i].length ;
        //         }
        //     }
        // }
        //
        // _this._lowCoverageValues = coverageGroups;
        // let result = {};
        // let positions = [];
        //
        // for (let i = 0; i < responses.length; i++) {
        //     for (let j = 0; j < responses[i].response[0].result.length; j++) {
        //         response = responses[i].response[0].result[j];
        //
        //         for (let w = 0; w < response.values.length; w++) {
        //             let position = response.start + w;
        //             if (UtilsNew.isUndefinedOrNull(result[position])) {
        //                 positions.push(position);
        //                 result[position] = {};
        //             }
        //
        //             result[position][_this._files[i].id] = response.values[w];
        //         }
        //     }
        // }
        //
        // // Sort the positions
        // positions = positions.sort();
        //
        // // Now we need to group all the low coverage values by files
        // let coverageGroups = [];
        //
        // let lastGroup = "";
        // let groupedResult = {
        // };
        // let lastPosition = positions[0] - 1;
        //
        // for (let i = 0; i < positions.length; i++) {
        //     let group = "";
        //     let numberOfFiles = 0;
        //     for (let j = 0; j < _this._files.length; j++) {
        //         if (UtilsNew.isNotUndefinedOrNull(result[positions[i]][_this._files[j].id])) {
        //             group += _this._files[j].id;
        //             numberOfFiles += 1;
        //         }
        //     }
        //
        //     // Filter out low coverages over only one of the samples if the array of files contains more than one sample
        //     if (_this._files.length > 1 && numberOfFiles === 1) {
        //         continue;
        //     }
        //
        //     if ((lastGroup !== group || lastPosition + 1 < positions[i])) {
        //         if (Object.entries(groupedResult).length > 0) {
        //             coverageGroups.push(Object.assign({}, groupedResult));
        //         }
        //
        //         groupedResult = {
        //             start: positions[i]
        //         };
        //
        //         lastGroup = group;
        //     }
        //
        //
        //     for (let j = 0; j < _this._files.length; j++) {
        //         if (UtilsNew.isNotUndefinedOrNull(result[positions[i]][_this._files[j].id])) {
        //             if (UtilsNew.isUndefinedOrNull(groupedResult[_this._files[j].id])) {
        //                 groupedResult[_this._files[j].id] = [];
        //             }
        //             groupedResult[_this._files[j].id].push(result[positions[i]][_this._files[j].id]);
        //         }
        //     }
        //
        //     lastPosition = positions[i];
        // }
        //
        // // Add the last group
        // coverageGroups.push(Object.assign({}, groupedResult));
        //
        // // Calculate mean coverage for the groups
        // for (let i = 0; i < coverageGroups.length; i++) {
        //     for (let j = 0; j < _this._files.length; j++) {
        //         if (UtilsNew.isNotUndefinedOrNull(coverageGroups[i][_this._files[j].id])) {
        //             let sum = 0;
        //             for (let w = 0; w < coverageGroups[i][_this._files[j].id].length; w++) {
        //                 sum += coverageGroups[i][_this._files[j].id][w];
        //             }
        //
        //             coverageGroups[i].length = coverageGroups[i][_this._files[j].id].length;
        //             coverageGroups[i].end = coverageGroups[i].start + coverageGroups[i].length -1;
        //             coverageGroups[i].region = `${gene.chromosome}:${coverageGroups[i].start}-${coverageGroups[i].end}`;
        //             coverageGroups[i][_this._files[j].id] = sum / coverageGroups[i].length ;
        //         }
        //     }
        // }
        //
        // _this._lowCoverageValues = coverageGroups;

      });

      _this.geneTrack.draw({
        data: gene
      });
    });
  }

  _getMaximumValue(value, values) {
    for (let i = 0; i < values.length; i++) {
      if (values[i] > value) {
        value = values[i];
      }
    }

    return value;
  }

  _getMinimumValue(value, values) {
    let myValue = value;

    if (myValue === -1) {
      myValue = values[0];
    }

    for (let i = 0; i < values.length; i++) {
      if (values[i] < myValue) {
        myValue = values[i];
      }
    }

    return myValue;
  }

  _getCoverage(coverage, file) {
    return utilsNew_UtilsNew.isUndefinedOrNull(coverage[file.id]) ? "-" : coverage[file.id].covered.toFixed(2);
  }

  _getAverage(coverage, file) {
    return utilsNew_UtilsNew.isUndefinedOrNull(coverage[file.id]) ? "-" : coverage[file.id].average > -1 ? coverage[file.id].average.toFixed(2) : "-";
  }

  _getMax(coverage, file) {
    return utilsNew_UtilsNew.isUndefinedOrNull(coverage[file.id]) ? "-" : coverage[file.id].max > -1 ? coverage[file.id].max.toFixed(2) : "-";
  }

  _getMin(coverage, file) {
    return utilsNew_UtilsNew.isUndefinedOrNull(coverage[file.id]) ? "-" : coverage[file.id].min > -1 ? coverage[file.id].min.toFixed(2) : "-";
  }

  getDefaultConfig() {
    return {
      offset: 2500,
      sexIConMap: {
        MALE: "fa-mars",
        FEMALE: "fa-venus",
        UNKNOWN: "fa-genderless"
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_panel_transcript_view_templateObject(), this._disabled ? lit_html_lit_html_html(opencga_panel_transcript_view_templateObject2()) : lit_html_lit_html_html(opencga_panel_transcript_view_templateObject3(), this.toggleCollapsedFilter, this._prefix, this._filtersCollapsed ? lit_html_lit_html_html(opencga_panel_transcript_view_templateObject4()) : lit_html_lit_html_html(opencga_panel_transcript_view_templateObject5()), this._prefix, this.cellbaseClient, this.eraseSearchGene, this.onInputGeneChange, this._prefix, this.geneIds && this.geneIds.length ? this.geneIds.map(geneId => lit_html_lit_html_html(opencga_panel_transcript_view_templateObject6(), geneId)) : null, this._genePanels && this._genePanels.length ? this._genePanels.map(panel => lit_html_lit_html_html(opencga_panel_transcript_view_templateObject7(), panel.name, panel.genes && panel.genes.length ? panel.genes.map(gene => lit_html_lit_html_html(opencga_panel_transcript_view_templateObject8(), gene.name)) : null)) : null, this._prefix, this.onClear, this.onRender, this.showCoverageTable ? lit_html_lit_html_html(opencga_panel_transcript_view_templateObject9()) : null, this._prefix, this.showCoverageTable ? lit_html_lit_html_html(opencga_panel_transcript_view_templateObject10(), this._prefix, this._probandFile.style, this._probandFile.icon, this._otherFiles && this._otherFiles.length ? this._otherFiles.map(file => lit_html_lit_html_html(opencga_panel_transcript_view_templateObject11(), file.style, file.name, file.icon)) : null, this._otherFiles && this._otherFiles.length ? this._otherFiles.map(file => lit_html_lit_html_html(opencga_panel_transcript_view_templateObject12())) : null, this._lowCoverageValues && this._lowCoverageValues.length ? this._lowCoverageValues.map(coverage => lit_html_lit_html_html(opencga_panel_transcript_view_templateObject13(), coverage.region, coverage.length, coverage.stats.average, coverage.stats.max, coverage.stats.min, this._otherFiles && this._otherFiles.length ? this._otherFiles.map(file => lit_html_lit_html_html(opencga_panel_transcript_view_templateObject14(), this._getCoverage(coverage, file), this._getAverage(coverage, file), this._getMax(coverage, file), this._getMin(coverage, file))) : null)) : null) : null));
  }

}
customElements.define("opencga-panel-transcript-view", opencga_panel_transcript_view_OpencgaPanelTranscriptView);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/opencga-variant-interpreter-genome-browser.js
function opencga_variant_interpreter_genome_browser_templateObject() {
  const data = opencga_variant_interpreter_genome_browser_taggedTemplateLiteral(["\n        <genome-browser .id=\"", "gb\"\n                        .opencgaSession=\"", "\"\n                        .cellbaseClient=\"", "\"\n                        .region=\"", "\"\n                        .tracks=\"", "\"\n                        .settings=\"", "\"\n                        .filter=\"", "\"\n                        .active=\"", "\">\n        </genome-browser>\n        <!--        <style include=\"jso-styles\">-->\n        <!--            .form-section-title {-->\n        <!--                padding: 5px 0px;-->\n        <!--                width: 80%;-->\n        <!--                border-bottom-width: 1px;-->\n        <!--                border-bottom-style: solid;-->\n        <!--                border-bottom-color: #ddd-->\n        <!--            }-->\n\n        <!--            .jso-label-title {-->\n        <!--                width: 15em !important;-->\n        <!--            }-->\n        <!--        </style>-->\n\n        <!--        <template is=\"dom-if\" if=\"{{_disabled}}\">-->\n        <!--            <h4 style=\"color: #940303; margin: 20px 0px; text-align: center\">-->\n        <!--                No files available.-->\n        <!--            </h4>-->\n        <!--        </template>-->\n\n        <!--        <template is=\"dom-if\" if=\"{{!_disabled}}\">-->\n\n        <!--            <template is=\"dom-if\" if=\"{{_config.showTitle}}\">-->\n        <!--                <div class=\"panel\" style=\"margin-bottom: 15px\">-->\n        <!--                    <h3 style=\"margin: 10px 10px 10px 15px\">-->\n        <!--                        <i class=\"fa fa-list\" aria-hidden=\"true\"></i> &nbsp;{{_config.title}}-->\n        <!--                    </h3>-->\n        <!--                </div>-->\n        <!--            </template>-->\n\n        <!--            <div class=\"row \" style=\"padding: 0px 10px; margin: 10px 0px;\">-->\n        <!--                <div class=\"col-md-12\">-->\n\n        <!--                    <div style=\"display: block; cursor:pointer;\" on-click=\"toggleCollapsedFilter\"-->\n        <!--                         data-toggle=\"collapse\" href$=\"#", "collapsibleFilter\">-->\n        <!--                        <h3 class=\"form-section-title\">-->\n        <!--                            <template is=\"dom-if\" if=\"{{_filtersCollapsed}}\">-->\n        <!--                                <i class=\"fa fa-caret-right\" aria-hidden=\"true\" style=\"padding-right: 5px\"></i>-->\n        <!--                            </template>-->\n        <!--                            <template is=\"dom-if\" if=\"{{!_filtersCollapsed}}\">-->\n        <!--                                <i class=\"fa fa-caret-down\" aria-hidden=\"true\" style=\"padding-right: 5px\"></i>-->\n        <!--                            </template>-->\n        <!--                            Genome Browser Filters</h3>-->\n        <!--                    </div>-->\n\n        <!--                    <div id=\"", "collapsibleFilter\" class=\"form-horizontal collapse in\">-->\n\n        <!--                        <div class=\"form-group\">-->\n        <!--                            <label class=\"control-label col-md-1 jso-label-title\">Search by Region</label>-->\n        <!--                            <div class=\"input-group col-md-3\" style=\"padding-left: 15px;padding-right: 15px\">-->\n        <!--                                <input id=\"", "RegionInputText\" type=\"text\" class=\"form-control\" placeholder=\"e.g. 3:55555-666666\">-->\n        <!--                                <span class=\"input-group-btn\">-->\n        <!--                                <button class=\"btn btn-default\" type=\"button\" on-click=\"onEraserClicked\">-->\n        <!--                                    <i class=\"fa fa-eraser\" aria-hidden=\"true\"></i>-->\n        <!--                                </button>-->\n        <!--                            </span>-->\n        <!--                            </div>-->\n        <!--                        </div>-->\n\n        <!--                        <div class=\"form-group\">-->\n        <!--                            <label class=\"control-label col-md-1 jso-label-title\">Search by Gene</label>-->\n        <!--                            <div class=\"col-md-3\">-->\n        <!--                                <cellbase-gene-filter cellbase-client=\"{{cellbaseClient}}\"-->\n        <!--                                                      erase=\"{{eraseSearchGene}}\"-->\n        <!--                                                      on-genechange=\"onInputGeneChange\">-->\n        <!--                                </cellbase-gene-filter>-->\n        <!--                            </div>-->\n        <!--                        </div>-->\n\n        <!--                        <div class=\"form-group\">-->\n        <!--                            <label class=\"control-label col-md-1 jso-label-title\">Select a Gene from Panel</label>-->\n        <!--                            <div class=\"col-md-3\">-->\n        <!--                                <select class=\"selectpicker\" id=\"", "-geneSelect\" data-live-search=\"true\" data-max-options=\"1\"-->\n        <!--                                        on-dom-change=\"renderDomRepeat\" multiple>-->\n        <!--                                    <optgroup label=\"Selected Genes\">-->\n        <!--                                        <template is=\"dom-repeat\" items=\"{{geneIds}}\" as=\"geneId\">-->\n        <!--                                            <option>{{geneId}}</option>-->\n        <!--                                        </template>-->\n        <!--                                    </optgroup>-->\n\n        <!--                                    <template is=\"dom-repeat\" items=\"{{_genePanels}}\" as=\"panel\">-->\n        <!--                                        <optgroup label=\"{{panel.name}}\">-->\n        <!--                                            <template is=\"dom-repeat\" items=\"{{panel.genes}}\" as=\"gene\">-->\n        <!--                                                <option>{{gene.name}}</option>-->\n        <!--                                            </template>-->\n        <!--                                        </optgroup>-->\n        <!--                                    </template>-->\n        <!--                                </select>-->\n        <!--                            </div>-->\n        <!--                        </div>-->\n\n        <!--                        <div class=\"form-group\">-->\n        <!--                            <label class=\"control-label col-md-1 jso-label-title\">Show Alignments (BAM)</label>-->\n        <!--                            <div class=\"col-md-3\">-->\n        <!--                                <input type=\"checkbox\">-->\n        <!--                            </div>-->\n        <!--                        </div>-->\n\n        <!--                        <div class=\"form-group\">-->\n        <!--                            <div class=\"col-md-offset-3 col-md-9\">-->\n        <!--                                <button type=\"submit\" class=\"btn btn-primary\" on-click=\"onClear\">Clear</button>-->\n        <!--                                <button type=\"submit\" class=\"btn btn-primary\" on-click=\"showSelectionInGenomeBrowser\">Render</button>-->\n        <!--                            </div>-->\n        <!--                        </div>-->\n        <!--                    </div>-->\n\n        <!--                    &lt;!&ndash;<div class=\"col-md-6\" style=\"margin-top: 15px;\">&ndash;&gt;-->\n        <!--                    &lt;!&ndash;<button id=\"", "RunGenomeBrowser\" type=\"button\" class=\"btn btn-primary\"&ndash;&gt;-->\n        <!--                    &lt;!&ndash;on-click=\"showSelectionInGenomeBrowser\" style=\"float: right\">&ndash;&gt;-->\n        <!--                    &lt;!&ndash;Show Genome Browser&ndash;&gt;-->\n        <!--                    &lt;!&ndash;</button>&ndash;&gt;-->\n        <!--                    &lt;!&ndash;</div>&ndash;&gt;-->\n        <!--                </div>-->\n\n\n        <!--                &lt;!&ndash; Genome browser &ndash;&gt;-->\n        <!--                <div class=\"col-md-12\">-->\n        <!--                    <h3 class=\"form-section-title\">Genome Browser</h3>-->\n\n        <!--                    &lt;!&ndash;<div style$=\"padding: 20px 0px;display: {{displayGenomeBrowserMessage}};\">&ndash;&gt;-->\n        <!--                    &lt;!&ndash;<div style=\"padding: 20px\">&ndash;&gt;-->\n        <!--                    &lt;!&ndash;<span style=\"font-weight: bolder\">Please select some data above</span>&ndash;&gt;-->\n        <!--                    &lt;!&ndash;</div>&ndash;&gt;-->\n        <!--                    &lt;!&ndash;</div>&ndash;&gt;-->\n\n        <!--                    <div style=\"padding: 20px\">-->\n        <!--                        <genome-browser id=\"", "gb\" opencga-session={{opencgaSession}} cellbase-client=\"{{cellbaseClient}}\"-->\n        <!--                                        region=\"{{genomeBrowserRegion}}\" tracks=\"{{tracks}}\" settings=\"{{settings}}\" active=\"{{active}}\">-->\n        <!--                        </genome-browser>-->\n        <!--                    </div>-->\n        <!--                </div>-->\n        <!--            </div>-->\n        <!--        </template>-->\n        "]);

  opencga_variant_interpreter_genome_browser_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_variant_interpreter_genome_browser_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */







class opencga_variant_interpreter_genome_browser_OpencgaVariantInterpreterGenomeBrowser extends lit_element_lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      cellbaseClient: {
        type: Object //                        observer: "init"

      },
      clinicalAnalysisId: {
        type: String
      },
      clinicalAnalysis: {
        type: Object
      },
      // samples: {
      //     type: Array,
      //     observer: "samplesObserver"
      // },
      region: {
        type: String
      },
      geneIds: {
        type: Array
      },
      panelIds: {
        type: Array
      },
      active: {
        type: Boolean
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "OpencgaVariantInterpreterGenomeBrowser" + utils.randomString(6) + "_";
    this._availableFiles = [];

    if (!utilsNew_UtilsNew.isNotEmpty(this.region)) {
      this.genomeBrowserRegion = new region_Region({
        chromosome: "11",
        start: 68177378,
        end: 68177510
      });
    }

    this._filtersCollapsed = false; // The component will show an error message instead of the whole app if no alignment files are found

    this._disabled = true;
    this.displayGenomeBrowserMessage = "inline";
    this._config = this.getDefaultConfig();
    this.tracks = this._config.tracks;
    this.active = false;
    console.error("clinicalAnalysis in this class is not defined. Check if it refers to the WC prop");
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession")) {
      this.onStudyUpdate();
    }

    if (changedProperties.has("clinicalAnalysisId")) {
      this.clinicalAnalysisIdObserver();
    }

    if (changedProperties.has("region")) {
      this.regionObserver();
    }

    if (changedProperties.has("active")) {//this._setActive();
    }

    if (changedProperties.has("opencgaSession") || changedProperties.has("clinicalAnalysis") || changedProperties.has("panelIds") || changedProperties.has("geneIds") || changedProperties.has("config")) {
      this.propertyObserver(this.opencgaSession, this.clinicalAnalysis, this.panelIds, this.geneIds, this.config);
    }
  }

  propertyObserver(opencgaSession, clinicalAnalysis, panelIds, geneIds, config) {
    this._config = Object.assign(this.getDefaultConfig(), config);
    this.genomeBrowserFilters = {
      title: "Genome Browser Filters",
      active: true,
      filters: [{
        title: "Search by Region",
        example: "e.g. 3:55555-666666",
        id: "region"
      }, {
        title: "Search by Gene",
        example: "Search for Gene Symbols",
        id: "gene"
      }, {
        title: "Panel",
        id: "panel",
        values: panelIds
      }, {
        title: "Show alignments (BAM)",
        id: "alignment"
      }, {
        title: "Show variants (VCF)",
        id: "variant"
      }]
    };

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession)) {
      let _this = this;

      if (utilsNew_UtilsNew.isNotEmptyArray(this.panelIds)) {
        this.opencgaSession.opencgaClient.panels().info(panelIds.join(","), {
          study: _this.opencgaSession.study.fqn,
          include: "id,name,genes"
        }).then(function (response) {
          // _this._panelGenesAvailable = true;
          let _panels = [];

          for (let panel of response.response) {
            _panels.push(panel.result[0]);
          }

          _this._genePanels = _panels;
        }).catch(response => {
          console.error("An error occurred fetching clinicalAnalysis: ", response);
        });
      } else {
        this._genePanels = [];
      }

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis)) {
        this.addTracks(this.clinicalAnalysis);
      }
    }
  }
  /**
   * Fetch the CinicalAnalysis object from REST and trigger the observer call.
   */


  clinicalAnalysisIdObserver() {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotEmpty(this.clinicalAnalysisId)) {
      let _this = this;

      this.opencgaSession.opencgaClient.clinical().info(clinicalAnalysis, {
        study: this.opencgaSession.study.fqn
      }).then(function (response) {
        // This will trigger the call clinicalAnalysis observer
        _this.clinicalAnalysis = response.response[0].result[0];

        _this.addTracks(_this.clinicalAnalysis);
      }).catch(response => {
        this._disabled = true;
        console.error("An error occurred fetching clinicalAnalysis: ", response);
      });
    }
  }

  renderDomRepeat(e) {
    $("#".concat(this._prefix, "-geneSelect")).selectpicker('refresh');
    $("#".concat(this._prefix, "-geneSelect")).selectpicker('deselectAll');
  }

  toggleCollapsedFilter() {
    this.set("_filtersCollapsed", !this._filtersCollapsed);
  }

  regionObserver() {
    if (!utilsNew_UtilsNew.isNotEmpty(this.region)) {
      this.genomeBrowserRegion = new region_Region(this.region);
    }
  }

  onStudyUpdate() {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.study)) {
      this._availableFiles = []; // this.showSelectionInGenomeBrowser();
    }
  }

  showSelectionInGenomeBrowser() {
    let region = PolymerUtils_PolymerUtils.getValue(this._prefix + "RegionInputText");

    if (utilsNew_UtilsNew.isNotEmpty(region)) {
      this.genomeBrowserRegion = new region_Region(region);
    }

    let genomeBrowser = PolymerUtils_PolymerUtils.getElementById(this._prefix + "gb");

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(genomeBrowser)) {
      let inputArray = document.querySelectorAll('input[name=' + this._prefix + 'file-checkbox]:checked');
      let myVariantFiles = [];
      let myAlignmentFiles = [];
      inputArray.forEach(function (input) {
        let file = input.data;

        if (file.format === "VCF") {
          myVariantFiles.push(file);
        } else if (file.format === "BAM") {
          myAlignmentFiles.push(file);
        }
      }); // Activate genome browser
      // if (myVariantFiles.length > 0 || myAlignmentFiles.length > 0) {
      // Hide Genome Browser initial message

      this.displayGenomeBrowserMessage = "none";
      genomeBrowser.active = true; // }
    }
  }

  addTracks(clinicalAnalysis) {
    if (utilsNew_UtilsNew.isUndefinedOrNull(clinicalAnalysis.files) || utilsNew_UtilsNew.isUndefinedOrNull(this.opencgaSession.study)) {
      this._disabled = true;
      return;
    }

    let roleToProband = {};

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(clinicalAnalysis.roleToProband)) {
      roleToProband = clinicalAnalysis.roleToProband;
    }

    let samplesToIndividual = {};

    for (let i = 0; i < clinicalAnalysis.family.members.length; i++) {
      let member = clinicalAnalysis.family.members[i];

      if (utilsNew_UtilsNew.isNotEmptyArray(member.samples)) {
        for (let j = 0; j < member.samples.length; j++) {
          samplesToIndividual[member.samples[j].id] = member.id;
        }
      }
    }

    let samples = Object.keys(clinicalAnalysis.files);
    let variants = {};
    let alignments = {};
    let coverage = {};

    for (let i = 0; i < samples.length; i++) {
      let files = clinicalAnalysis.files[samples[i]];
      let role = roleToProband[samplesToIndividual[samples[i]]];
      let display = role === samples[i] ? role : "".concat(samples[i], " (").concat(role, ")");

      for (let j = 0; j < files.length; j++) {
        files[j].display = display;

        if (files[j].bioformat === "VARIANT") {
          variants[samples[i]] = files[j];
        } else if (files[j].bioformat === "ALIGNMENT") {
          alignments[samples[i]] = files[j];
        } else if (files[j].bioformat === "COVERAGE") {
          coverage[samples[i]] = files[j];
        }
      }
    } // Merge alignment and coverage files


    for (let sampleId in alignments) {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(coverage[sampleId])) {
        alignments[sampleId]['bigwig'] = coverage[sampleId];
      }
    }

    let tracks = this._config.tracks.slice(); // Add the rest of the tracks


    let _this = this;

    Object.entries(alignments).forEach(([key, value]) => tracks.push(_this._generateAlignmentTrack(value)));

    if (clinicalAnalysis.type !== "FAMILY") {
      Object.entries(variants).forEach(([key, value]) => tracks.push(_this._generateVariantTrack(value)));
    } else {
      // We only generate one multi sample variant track
      tracks.push(this._generateMultiSampleVariantTrack(variants));
    }

    this.tracks = tracks;
    this._disabled = tracks.length === this._config.tracks.length;
  }

  _generateTrack(file) {
    return {
      type: file.bioformat === "VARIANT" ? "variant" : "alignment",
      config: {
        source: 'opencga',
        data: {
          study: this.opencgaSession.study.fqn,
          fileId: file.id
        }
      }
    };
  }

  _generateAlignmentTrack(file, role) {
    let track = {
      type: "alignment",
      // id: `alignment-${file.id}`,
      config: {
        source: 'opencga',
        data: {
          study: this.opencgaSession.study.fqn,
          fileId: file.id,
          name: file.display
        }
      }
    };

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(file['bigwig'])) {
      track['config']['data']['bigwig'] = file['bigwig']['id'];
    }

    return track;
  }

  _generateVariantTrack(file) {
    return {
      type: "variant",
      // id: `variant-${file.sample}`,
      config: {
        source: 'opencga',
        data: {
          study: this.opencgaSession.study.fqn,
          // files: [file.id],
          samples: [file.sample],
          name: file.display
        }
      }
    };
  }

  _generateMultiSampleVariantTrack(variantFiles) {
    return {
      type: "variant",
      config: {
        source: 'opencga',
        data: {
          study: this.opencgaSession.study.fqn,
          samples: Object.keys(variantFiles),
          name: Object.keys(variantFiles).join(", ")
        }
      }
    };
  }

  getDefaultConfig() {
    return {
      title: "Genome Browser",
      showTitle: true,
      tracks: [{
        type: "sequence"
      }, {
        type: "gene"
      }]
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_variant_interpreter_genome_browser_templateObject(), this._prefix, this.opencgaSession, this.cellbaseClient, this.genomeBrowserRegion, this.tracks, this.settings, this.genomeBrowserFilters, this.active, this._prefix, this._prefix, this._prefix, this._prefix, this._prefix, this._prefix);
  }

}
customElements.define("opencga-variant-interpreter-genome-browser", opencga_variant_interpreter_genome_browser_OpencgaVariantInterpreterGenomeBrowser);
// CONCATENATED MODULE: ./lib/jsorolla/src/core/webcomponents/variant/opencga-variant-interpretation.js
function opencga_variant_interpretation_templateObject8() {
  const data = opencga_variant_interpretation_taggedTemplateLiteral(["\n             <span style=\"text-align: center\"><h3>No public projects available to browse. Please login to continue</h3></span>\n        "]);

  opencga_variant_interpretation_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_templateObject7() {
  const data = opencga_variant_interpretation_taggedTemplateLiteral(["\n                        <div class=\"btn-group\" role=\"group\" aria-label=\"...\" style=\"float: right\">\n                            <button id=\"", "ClinicalAnalysisEditorButton\" class=\"btn btn-primary variant-interpretation-view-buttons\" data-view=\"ClinicalAnalysisEditor\" @click=\"", "\" >\n                                <i class=\"fa fa-edit icon-padding\" aria-hidden=\"true\" data-view=\"ClinicalAnalysisEditor\" @click=\"", "\"></i>Clinical Analysis Definition\n                            </button>\n                            <button id=\"", "InterpretationEditorButton\" type=\"button\" class=\"btn btn-primary variant-interpretation-view-buttons\"\n                                    data-view=\"InterpretationEditor\" @click=\"", "\" .disabled=\"", "\">\n                                <i class=\"fa fa-save icon-padding\" aria-hidden=\"true\" data-view=\"InterpretationEditor\" @click=\"", "\"></i>Review and Save ", "\n                            </button>\n                        </div>\n                    "]);

  opencga_variant_interpretation_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_templateObject6() {
  const data = opencga_variant_interpretation_taggedTemplateLiteral(["\n                        <div class=\"btn-group\" role=\"group\" aria-label=\"...\" style=\"float: right\">\n                            <button id=\"", "ClinicalAnalysisButton\" type=\"button\" class=\"btn btn-primary variant-interpretation-view-buttons\" data-view=\"ClinicalAnalysis\" @click=\"", "\">\n                                <i class=\"fa fa-user-md icon-padding\" aria-hidden=\"true\" data-view=\"ClinicalAnalysis\" @click=\"", "\"></i>Case Summary\n                            </button>\n                            <button id=\"", "InterpretationEditorButton\" type=\"button\" class=\"btn btn-primary variant-interpretation-view-buttons\"\n                                    data-view=\"InterpretationEditor\" @click=\"", "\" .disabled=\"", "\">\n                                <i class=\"fa fa-save icon-padding\" aria-hidden=\"true\" data-view=\"InterpretationEditor\" @click=\"", "\"></i>Review and Save ", "\n                            </button>\n                        </div>\n                    "]);

  opencga_variant_interpretation_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_templateObject5() {
  const data = opencga_variant_interpretation_taggedTemplateLiteral(["\n                        <div class=\"btn-group\">\n                            <button type=\"button\" class=\"btn btn-success dropdown-toggle ripple\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                                <i class=\"fa fa-wrench\" aria-hidden=\"true\" style=\"padding-right: 5px\"></i> Other Tools <span class=\"caret\"></span>\n                            </button>\n                            <ul class=\"dropdown-menu dropdown-menu-right\">\n                                <li>\n                                    <a id=\"", "LowCoverageButton\" data-view=\"LowCoverage\" @click=\"", "\" style=\"cursor: pointer\">\n                                        <i class=\"fa fa-water icon-padding\" aria-hidden=\"true\" data-view=\"LowCoverage\" @click=\"", "\"></i>Low Coverage Regions\n                                    </a>\n                                </li>\n                                <li>\n                                    <a id=\"", "GenomeBrowserButton\" data-view=\"GenomeBrowser\" @click=\"", "\" data-view=\"GenomeBrowser\" style=\"cursor: pointer\">\n                                        <i class=\"fa fa-stream icon-padding\" aria-hidden=\"true\" data-view=\"GenomeBrowser\" @click=\"", "\"></i>Genome Browser (Beta)\n                                    </a>\n                                </li>\n                            </ul>\n                        </div>\n                    "]);

  opencga_variant_interpretation_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_templateObject4() {
  const data = opencga_variant_interpretation_taggedTemplateLiteral(["\n                        <i class=\"fa fa-filter\" aria-hidden=\"true\"></i>&nbsp; ", "   \n                    "]);

  opencga_variant_interpretation_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_templateObject3() {
  const data = opencga_variant_interpretation_taggedTemplateLiteral(["\n                        <i class=\"fa fa-filter\" aria-hidden=\"true\" style=\"padding-left: 10px;padding-right: 10px\"></i>&nbsp;", " - Case ", "\n                    "]);

  opencga_variant_interpretation_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_templateObject2() {
  const data = opencga_variant_interpretation_taggedTemplateLiteral(["\n            <div class=\"page-title\">\n                <h2>\n                    ", "\n                </h2>\n            </div>\n\n            <div class=\"col-md-12\" style=\"padding: 10px 25px 25px 25px\">\n                <div class=\"btn-toolbar \" role=\"toolbar\" aria-label=\"...\" >\n                    <!-- Left buttons -->\n                    <div class=\"btn-group\" role=\"group\" aria-label=\"...\" >\n                        <button id=\"", "InteractiveButton\" type=\"button\" class=\"btn btn-success variant-interpretation-view-buttons active ripple\" data-view=\"Interactive\" @click=\"", "\">\n                            <i class=\"fa fa-filter icon-padding\" aria-hidden=\"true\" data-view=\"Interactive\" @click=\"", "\"></i>Interactive Analysis ", "\n                        </button>\n                        <button id=\"", "CompoundHeterozygousButton\" type=\"button\" class=\"btn btn-success variant-interpretation-view-buttons ripple\" data-view=\"CompoundHeterozygous\" @click=\"", "\">\n                            <i class=\"fas fa-random icon-padding\" aria-hidden=\"true\" data-view=\"CompoundHeterozygous\" @click=\"", "\"></i>Compound Heterozygous ", "\n                        </button>\n                        <button id=\"", "DeNovoButton\" type=\"button\" class=\"btn btn-success variant-interpretation-view-buttons ripple\" data-view=\"DeNovo\" @click=\"", "\">\n                            <i class=\"fa fa-divide icon-padding\" aria-hidden=\"true\" data-view=\"DeNovo\" @click=\"", "\"></i>de Novo ", "\n                        </button>\n                    </div>\n\n                    <!--<div class=\"btn-group\">-->\n                    <!--<button type=\"button\" class=\"btn btn-success variant-interpretation-view-buttons\" data-view=\"SecondaryFindings\" on-click=\"onChangeView\">-->\n                    <!--<i class=\"fa fa-comment-medical icon-padding\" aria-hidden=\"true\" data-view=\"SecondaryFindings\" on-click=\"onChangeView\"></i>Secondary Findings-->\n                    <!--</button>-->\n                    <!--</div>-->\n\n                    ", "\n\n                    <!-- Right buttons -->\n                    ", "\n                </div>\n            </div>\n\n\n            <!--<div class=\"row\">-->\n            <div class=\"\" style=\"padding: 0px 10px\">\n\n                <!-- SEARCH TABLE RESULT -->\n                <div id=\"", "MainContent\" class=\"\">\n                    <!--<template is=\"dom-if\" if=\"{{interactive}}\">-->\n                    <!--                    <div class=\"col-md-12\">-->\n                    <!--                        <h4 id=\"", "Title\" class=\"form-section-title\" style=\"margin: 5px 0px;padding: 0px 10px\">-->\n                    <!--                            Interactive Variant Analysis-->\n                    <!--                            <span class='denovo-info-icon' style=\"color: #337ab7; padding-left: 20px\">-->\n                    <!--                        <i class='fa fa-info-circle' aria-hidden='true'></i>-->\n                    <!--                    </span>-->\n                    <!--                        </h4>-->\n                    <!--                    </div>-->\n                    <div id=\"", "Interactive\" class=\"variant-interpretation-content\">\n                        <div style=\"padding: 10px 10px\">\n                            <opencga-variant-family-analysis .opencgaSession=\"", "\"\n                                                             .clinicalAnalysis=\"", "\"\n                                                             .query=\"", "\"\n                                                             .config=\"", "\"\n                                                             .cellbaseClient=\"", "\"\n                                                             .consequenceTypes=\"", "\"\n                                                             .populationFrequencies=\"", "\"\n                                                             .proteinSubstitutionScores=\"", "\"\n                                                             mode=\"interactive\"\n                                                             @selectvariant=\"", "\"\n                                                             @checkvariant=\"", "\">\n                            </opencga-variant-family-analysis>\n                        </div>\n                    </div>\n\n                    <!-- COMPOUND HETEROZYGOUS -->\n                    <div id=\"", "CompoundHeterozygous\" class=\"variant-interpretation-content\" style=\"display: none\">\n                        <div style=\"padding: 10px 10px\">\n                            <opencga-variant-family-analysis .opencgaSession=\"", "\"\n                                                             .clinicalAnalysis=\"", "\"\n                                                             .query=\"", "\"\n                                                             .config=\"", "\"\n                                                             .cellbaseClient=\"", "\"\n                                                             .consequenceTypes=\"", "\"\n                                                             .populationFrequencies=\"", "\"\n                                                             .proteinSubstitutionScores=\"", "\"\n                                                             mode=\"compoundHeterozygous\"\n                                                             @selectvariant=\"", "\"\n                                                             @checkvariant=\"", "\">\n                            </opencga-variant-family-analysis>\n                        </div>\n                    </div>\n\n                    <!-- DE NOVO -->\n                    <div id=\"", "DeNovo\" class=\"variant-interpretation-content\" style=\"display: none\">\n                        <div style=\"padding: 10px 10px\">\n                            <opencga-variant-family-analysis .opencgaSession=\"", "\"\n                                                             .clinicalAnalysis=\"", "\"\n                                                             .query=\"", "\"\n                                                             .config=\"", "\"\n                                                             .cellbaseClient=\"", "\"\n                                                             .consequenceTypes=\"", "\"\n                                                             .populationFrequencies=\"", "\"\n                                                             .proteinSubstitutionScores=\"", "\"\n                                                             mode=\"deNovo\"\n                                                             @selectvariant=\"", "\"\n                                                             @checkvariant=\"", "\">\n                            </opencga-variant-family-analysis>\n                        </div>\n                    </div>\n\n                    <!-- PANEL LOW COVERAGE VIEW -->\n                    <div id=\"", "LowCoverage\" class=\"variant-interpretation-content\" style=\"display: none\">\n                        <opencga-panel-transcript-view .opencgaSession=\"", "\"\n                                                       .cellbaseClient=\"", "\"\n                                                       .clinicalAnalysis=\"", "\"\n                                                       .geneIds=\"", "\"\n                                                       .panelIds=\"", "\">\n                        </opencga-panel-transcript-view>\n                    </div>\n\n                    <!-- GENOME BROWSER VIEW -->\n                    <div id=\"", "GenomeBrowser\" class=\"variant-interpretation-content\" style=\"display: none\">\n                        <opencga-variant-interpreter-genome-browser .opencgaSession=\"", "\"\n                                                                    .cellbaseClient=\"", "\"\n                                                                    .samples=\"", "\"\n                                                                    .query=\"", "\"\n                                                                    .search=\"", "\"\n                                                                    .region=\"", "\"\n                                                                    .geneIds=\"", "\"\n                                                                    .panelIds=\"", "\"\n                                                                    .clinicalAnalysis=\"", "\"\n                                                                    .active=\"", "\"\n                                                                    .fullScreen=\"", "\"\n                                                                    .config=\"", "\">\n                        </opencga-variant-interpreter-genome-browser>\n                    </div>\n\n\n                    <!-- CLINICAL ANALYSIS VIEW -->\n                    <div id=\"", "ClinicalAnalysis\" class=\"variant-interpretation-content\" style=\"padding: 0px 20px;display: none\">\n                        <opencga-clinical-analysis-view .opencgaSession=\"", "\"\n                                                        .clinicalAnalysis=\"", "\"\n                                                        style=\"font-size: 12px\"\n                                                        .config=\"", "\">\n                        </opencga-clinical-analysis-view>\n                    </div>\n\n                    <!-- CREATE CLINICAL ANALYSIS TAB -->\n                    <div id=\"", "ClinicalAnalysisEditor\" class=\"variant-interpretation-content\" style=\"display: none\">\n                        <!--<div id=\"", "ClinicalAnalysisCreatorWarning\" class=\"col-md-10 col-md-offset-2\" style=\"padding: 20px 10px\">-->\n                        <!--<span class=\"alert alert-warning\" role=\"alert\" style=\"padding: 10px 10px;font-weight: bold;font-size: 1.2em\">-->\n                        <!--No valid Clinical Analysis found, please fill the form below to define one case. You can also save it.-->\n                        <!--</span>-->\n                        <!--</div>-->\n                        <div style=\"padding: 10px 20px\">\n                            <opencga-clinical-analysis-editor .opencgaSession=\"", "\"\n                                                                .clinicalAnalysis=\"", "\"\n                                                                .config=\"", "\"\n                                                                @clinicalanalysischange=\"", "\"\n                                                              >\n                            </opencga-clinical-analysis-editor>\n                        </div>\n                    </div>\n\n                    <!-- SAVE INTERPRETATION TAB -->\n                    <div id=\"", "InterpretationEditor\" class=\"variant-interpretation-content\" style=\"display: none\">\n                        <div style=\"padding: 10px 20px\">\n                            <!--                                clinical-analysis=\"{{clinicalAnalysis}}\"-->\n                            <!--                                reported-variants=\"{{checkedVariants}}\"-->\n                            <opencga-variant-interpretation-editor .opencgaSession=\"", "\"\n                                                                   .cellbaseClient=\"", "\"\n                                                                   .clinicalAnalysis=\"", "\"\n                                                                   .interpretation=\"", "\"\n                                                                   .populationFrequencies=\"", "\"\n                                                                   .proteinSubstitutionScores=\"", "\"\n                                                                   .consequenceTypes=\"", "\"\n                                                                   .config=\"", "\"\n                                                                   @gene=\"", "\"\n                                                                   @samplechange=\"", "\"\n                                                                   style=\"font-size: 12px\" >\n                            </opencga-variant-interpretation-editor>\n                        </div>\n                    </div>\n\n                </div>\n                <!--                </div>-->\n            </div>\n        "]);

  opencga_variant_interpretation_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_templateObject() {
  const data = opencga_variant_interpretation_taggedTemplateLiteral(["\n            <style include=\"jso-styles\">\n                opencga-variant-intepretation {\n                    font-size: 12px;\n                }\n                \n                .prioritization-center {\n                    margin: auto;\n                    text-align: justify;\n                    width: 95%;\n                }\n    \n                .browser-variant-tab-title {\n                    font-size: 115%;\n                    font-weight: bold;\n                }\n    \n                .prioritization-variant-tab-title {\n                    font-size: 115%;\n                    font-weight: bold;\n                }\n    \n                .icon-padding {\n                    padding-left: 4px;\n                    padding-right: 8px;\n                }\n    \n                .form-section-title {\n                    padding: 5px 0px;\n                    width: 95%;\n                    border-bottom-width: 1px;\n                    border-bottom-style: solid;\n                    border-bottom-color: #ddd\n                }\n    \n                .jso-label-title {\n                    width: 15em !important;\n                }\n            </style>\n\n        ", "\n    "]);

  opencga_variant_interpretation_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function opencga_variant_interpretation_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function opencga_variant_interpretation_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function opencga_variant_interpretation_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { opencga_variant_interpretation_ownKeys(Object(source), true).forEach(function (key) { opencga_variant_interpretation_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { opencga_variant_interpretation_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function opencga_variant_interpretation_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

















class opencga_variant_interpretation_OpencgaVariantInterpretation extends lit_element_lit_element_LitElement {
  constructor() {
    super(); // Set status and init private properties

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      clinicalAnalysisId: {
        type: String
      },
      clinicalAnalysis: {
        type: Object
      },
      query: {
        type: Object
      },
      cellbaseClient: {
        type: Object
      },
      // diseasePanelId: {
      //     type: String,
      //     observer: "diseasePanelIdObserver"
      // },
      consequenceTypes: {
        type: Object
      },
      populationFrequencies: {
        type: Object
      },
      proteinSubstitutionScores: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }

  _init() {
    this._prefix = "ovi-" + utils.randomString(6);
    this.diseasePanelIds = [];
    this.hasClinicalAnalysis = false;
    this.checkProjects = false;
    this.interactive = true;
    this.filterClass = "col-md-2";
    this.gridClass = "col-md-10";
    this._collapsed = true;
    this.messageError = false;
    this.messageSuccess = false;
    this.samples = [];
    this.missingMembersMessage = "Missing clinical analysis";
    this.variant = null;
    this.reportedVariants = [];
    this.counters = {
      rv: 0,
      ch: 0,
      dn: 0,
      total: 0
    };
    this.counterTitles = {
      rv: "",
      ch: "",
      dn: "",
      total: ""
    }; // this.lofe = ["missense_variant", "transcript_ablation", "splice_acceptor_variant", "splice_donor_variant", "stop_gained",
    //     "frameshift_variant", "stop_lost", "start_lost", "transcript_amplification", "inframe_insertion", "inframe_deletion"].join(", ");

    this.query = {};
    this.search = {};
  }

  connectedCallback() {
    super.connectedCallback();
    this._config = opencga_variant_interpretation_objectSpread({}, this.getDefaultConfig(), {}, this.config);
  }

  firstUpdated(_changedProperties) {
    // if (!this.interactive) {
    //     this.collapseFilter();
    // }
    // CellBase version
    this.cellbaseClient.getMeta("about").then(response => {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(response) && utilsNew_UtilsNew.isNotEmptyArray(response.response)) {
        if (utilsNew_UtilsNew.isNotUndefinedOrNull(response.response[0].result) && utilsNew_UtilsNew.isNotEmptyArray(response.response[0].result)) {
          this.cellbaseVersion = response.response[0].result[0]["Version: "];
        }
      }
    });
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession")) {
      this.opencgaSessionObserver();
    }

    if (changedProperties.has("clinicalAnalysisId")) {
      this.clinicalAnalysisIdObserver();
    }

    if (changedProperties.has("clinicalAnalysis")) {
      this.clinicalAnalysisObserver();
    }

    if (changedProperties.has("query")) {
      this.queryObserver();
    }
  }

  opencgaSessionObserver() {
    // With each property change we must updated config and create the columns again. No extra checks are needed.
    this._config = opencga_variant_interpretation_objectSpread({}, this.getDefaultConfig(), {}, this.config); // Check if Beacon hosts are configured

    for (const detail of this._config.detail) {
      if (detail.id === "beacon" && utilsNew_UtilsNew.isNotEmptyArray(detail.hosts)) {
        this.beaconConfig = {
          hosts: detail.hosts
        };
      }
    }

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession.project)) {
      this.checkProjects = true;
    } else {
      this.checkProjects = false;
    }

    this.requestUpdate();
  }

  queryObserver() {} // debugger
  // // Query passed is executed and set to variant-filter, active-filters and variant-grid components
  // if (UtilsNew.isNotUndefinedOrNull(this.query)) {
  //     this.preparedQuery = this.query;
  //     this.executedQuery = this.query;
  // }

  /**
           * Fetch the CinicalAnalysis object from REST and trigger the observer call.
           */


  clinicalAnalysisIdObserver() {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotEmpty(this.clinicalAnalysisId)) {
      const _this = this;

      this.opencgaSession.opencgaClient.clinical().info(this.clinicalAnalysisId, {
        study: this.opencgaSession.study.fqn
      }).then(response => {
        // This triggers the call to clinicalAnalysisObserver function below
        _this.clinicalAnalysis = response.response[0].result[0];
        console.log("clinicalAnalysisIdObserver _this.clinicalAnalysis", _this.clinicalAnalysis);

        _this.requestUpdate();
      }).catch(response => {
        console.error("An error occurred fetching clinicalAnalysis: ", response);
      });
    }
  }

  clinicalAnalysisObserver() {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis)) {
      this._changeView("Interactive"); // let _individuals = [];
      // let _samples = [];
      // let _sampleIds = [];
      // let _sampleDefaultGenotypes = [];
      //
      // this._checkFullFamily();
      //
      // if (UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis.family) && UtilsNew.isNotEmptyArray(this.clinicalAnalysis.family.members)) {
      //     _individuals = this.clinicalAnalysis.family.members;
      // } else {
      //     if (UtilsNew.isNotUndefinedOrNull(this.clinicalAnalysis.proband)) {
      //         _individuals = [this.clinicalAnalysis.proband];
      //     }
      // }
      //
      // if (UtilsNew.isNotEmptyArray(_individuals)) {
      //     _individuals.forEach(individual => {
      //         if (UtilsNew.isNotEmptyArray(individual.samples)) {
      //             individual.samples.map(sample => {
      //                 _samples.push(sample);
      //                 _sampleIds.push(sample.id);
      //                 if (this.clinicalAnalysis.proband.id === individual.id) {
      //                     _sampleDefaultGenotypes.push(sample.id + ":0/1,1/1");
      //                 } else {
      //                     _sampleDefaultGenotypes.push(sample.id + ":0/0,0/1,1/1");
      //                     // _sampleIds.push(sample.id + ":0/1,1/1");
      //                 }
      //             });
      //         }
      //     });
      //
      //     if (UtilsNew.isNotEmptyArray(_sampleDefaultGenotypes)) {
      //         if (UtilsNew.isNotUndefinedOrNull(this.query)) {
      //             this.query = Object.assign({}, this.query, {
      //                 genotype: _sampleDefaultGenotypes.join(";"),
      //                 study: this.opencgaSession.study.fqn
      //             });
      //         } else {
      //             this.query = {
      //                 genotype: _sampleDefaultGenotypes.join(";"),
      //                 study: this.opencgaSession.study.fqn
      //             };
      //         }
      //
      //         // Notify to all listeners of the new samples
      //         this.dispatchEvent(new CustomEvent('samplechange', {detail: {samples: this.samples}}));
      //     }
      // } else {
      //     console.warn("A Clinical Analysis with no proband or family has been passed");
      // }
      //
      // this._individuals = _individuals;
      // this._samples = _samples;
      // this._sampleIds = _sampleIds;


      this.hasClinicalAnalysis = true;
    } else {
      this.missingMembersMessage = "Missing clinical analysis";
    }
  }

  onClinicalAnalysisEditor(e) {
    //console.warn("onClinicalAnalysisEditor commented")
    //console.warn(" e.detail.clinicalAnalysis", e.detail.clinicalAnalysis)
    this.clinicalAnalysis = Object.assign({}, e.detail.clinicalAnalysis);
  } // interactiveObserver() {
  //     if (!this.interactive) {
  //         this.collapseFilter();
  //     } else {
  //         this.unCollapseFilter();
  //     }
  // }


  onCollapse() {
    if (this._collapsed) {
      this.unCollapseFilter();
    } else {
      this.collapseFilter();
    }
  }

  collapseFilter() {
    this.filterClass = "hidden";
    this.gridClass = "prioritization-center";
    this._collapsed = true;
  }

  unCollapseFilter() {
    if (this.interactive) {
      this.filterClass = "col-md-2";
      this.gridClass = "col-md-10";
      this._collapsed = false;
    }
  }
  /**
           * Set properties for LowCoverage tools and others
           */


  _setPropertiesForTools() {
    this.diseasePanelIds = utilsNew_UtilsNew.isNotEmpty(this.preparedQuery.panel) ? this.preparedQuery.panel.split(",") : [];

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.preparedQuery.xref)) {
      const _geneIds = [];

      for (const geneId of this.preparedQuery.xref.split(",")) {
        if (!geneId.startsWith("ENS") && !geneId.startsWith("rs") && !geneId.startsWith("RCV")) {
          _geneIds.push(geneId);
        }
      }

      this.geneIds = _geneIds;
    }
  }

  onClear() {
    const _search = {};

    for (const hiddenField of this._config.activeFilters.hiddenFields) {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.query[hiddenField])) {
        _search[hiddenField] = this.query[hiddenField];
      }
    } // this.search = _search;


    this.query = {
      study: this.opencgaSession.study.fqn
    };
  }

  onSelectVariant(e) {// this.variant = e.detail.variant;
  }

  onCheckVariant(e) {
    this.counters.rv = e.detail.variants.length;
    this.counterTitles.rv = e.detail.variants.length > 0 ? "(" + e.detail.variants.length + ")" : "";
    this.counters.total = this.counters.rv + this.counters.ch + this.counters.dn;
    this.counterTitles.total = this.counters.total > 0 ? "(" + this.counters.total + ")" : "";
    this.counters = Object.assign({}, this.counters);
    this.counterTitles = Object.assign({}, this.counterTitles);
    this.checkedVariants = e.detail.variants;

    this._createInterpretation();
  }
  /*
          * Compound Heterozygous Analysis functions
          */


  onCheckCompHetVariant(e) {
    this.counters.ch = e.detail.variants.length;
    this.counterTitles.ch = e.detail.variants.length > 0 ? "(" + e.detail.variants.length + ")" : "";
    this.counters.total = this.counters.rv + this.counters.ch + this.counters.dn;
    this.counterTitles.total = this.counters.total > 0 ? "(" + this.counters.total + ")" : "";
    this.counters = Object.assign({}, this.counters);
    this.counterTitles = Object.assign({}, this.counterTitles);
    this.checkedCompHetVariants = e.detail.variants;

    this._createInterpretation();
  }
  /*
           * De Novo Analysis functions
           */


  onCheckDeNovoVariant(e) {
    this.counters.dn = e.detail.variants.length;
    this.counterTitles.dn = e.detail.variants.length > 0 ? "(" + e.detail.variants.length + ")" : "";
    this.counters.total = this.counters.rv + this.counters.ch + this.counters.dn;
    this.counterTitles.total = this.counters.total > 0 ? "(" + this.counters.total + ")" : "";
    this.counters = Object.assign({}, this.counters);
    this.counterTitles = Object.assign({}, this.counterTitles);
    this.checkedDeNovoVariants = e.detail.variants;

    this._createInterpretation();
  } // _changeBottomTab(e) {
  //     let _activeTabs = {}
  //     for (let detail of this.config.detail) {
  //         _activeTabs[detail.id] = (detail.id === e.currentTarget.dataset.id);
  //     }
  //     this.set("detailActiveTabs", _activeTabs);
  // }
  // checkVariant(variant) {
  //     return variant.split(':').length > 2;
  // }


  onSampleChange(e) {
    const _samples = e.detail.samples; // this.set("samples", _samples.slice());

    this.samples = _samples.slice();
    this.dispatchEvent(new CustomEvent("samplechange", {
      detail: e.detail,
      bubbles: true,
      composed: true
    })); // this._initGenotypeSamples(this.samples);
  }

  onGenomeBrowserPositionChange(e) {
    $(".variant-interpretation-content").hide(); // hides all content divs

    $("#" + this._prefix + "GenomeBrowser").show(); // get the href and use it find which div to show
    // Show the active button

    $(".variant-interpretation-view-buttons").removeClass("active"); // $(e.target).addClass("active");

    PolymerUtils_PolymerUtils.addClass(this._prefix + "GenomeBrowserButton", "active");
    this._genomeBrowserActive = true;
    this.region = e.detail.genomeBrowserPosition;
  }

  onChangeView(e) {
    e.preventDefault(); // prevents the hash change to "#" and allows to manipulate the hash fragment as needed

    this._changeView(e.target.dataset.view);
  }

  _changeView(view) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(view)) {
      // Hide all views and show the requested one
      PolymerUtils_PolymerUtils.hideByClass("variant-interpretation-content");
      PolymerUtils_PolymerUtils.show(this._prefix + view); // Show the active button
      // $(e.target).addClass("active");

      PolymerUtils_PolymerUtils.removeClass(".variant-interpretation-view-buttons", "active");
      PolymerUtils_PolymerUtils.addClass(this._prefix + view + "Button", "active");
    } // Make Genome Browser active
    // this._genomeBrowserActive = (e.target.dataset.view === "GenomeBrowser");

  }

  _backToSelectAnalysis(e) {
    this.dispatchEvent(new CustomEvent("backtoselectanalysis", {
      detail: {
        idTab: "PrioritizationButton"
      }
    }));
  }

  _goToReport(e) {
    this.dispatchEvent(new CustomEvent("gotoreport", {
      detail: {
        interpretation: this.interpretation
      }
    }));
  }

  triggerBeacon(e) {
    this.variantToBeacon = this.variant.id;
  }

  onViewInterpretation(e) {
    this.interpretationView = this._createInterpretation();
  }

  onSaveInterpretation(e, obj) {
    const id = PolymerUtils_PolymerUtils.getValue(this._prefix + "IDInterpretation");
    const description = PolymerUtils_PolymerUtils.getValue(this._prefix + "DescriptionInterpretation");
    const comment = PolymerUtils_PolymerUtils.getValue(this._prefix + "CommentInterpretation");

    if (utilsNew_UtilsNew.isNotEmpty(id)) {
      if (/\s/.test(id)) {
        this.dispatchEvent(new CustomEvent(this.eventNotifyName, {
          detail: {
            message: "ID must not contains blanks.",
            type: utilsNew_UtilsNew.MESSAGE_ERROR
          },
          bubbles: true,
          composed: true
        }));
      } else {
        this.interpretation = this._createInterpretation();
      }
    } else {
      this.dispatchEvent(new CustomEvent(this.eventNotifyName, {
        detail: {
          message: "ID must not be empty.",
          type: utilsNew_UtilsNew.MESSAGE_ERROR
        },
        bubbles: true,
        composed: true
      }));
    }
  }

  _createInterpretation() {
    try {
      const userId = this.opencgaSession.opencgaClient._config.userId;
      const interpretation = {};
      interpretation.id = this.clinicalAnalysis.id + "-" + this.clinicalAnalysis.interpretations.length + 1;
      interpretation.clinicalAnalysisId = this.clinicalAnalysis.id; // interpretation.description = PolymerUtils.getValue(this._prefix + "DescriptionInterpretation");

      interpretation.software = {
        name: "IVA",
        version: "1.0.1",
        repository: "https://github.com/opencb/iva",
        commit: "",
        website: "",
        params: {}
      };
      interpretation.analyst = {
        name: userId,
        email: "",
        company: ""
      };
      interpretation.dependencies = [{
        name: "CellBase",
        repository: "https://github.com/opencb/cellbase",
        version: this.cellbaseVersion
      }];
      interpretation.filters = this.query; //                interpretation.creationDate = Date();
      // interpretation.comments = [{
      //     author: userId,
      //     type: "comment",
      //     text: PolymerUtils.getValue(this._prefix + "CommentInterpretation"),
      //     date: moment(new Date(), "YYYYMMDDHHmmss").format('D MMM YY')
      // }];
      // Remove 'stateCheckbox' from the variant list. When we receive the list from the grid, we are getting
      // an additional field that should not be present in a reported variant.
      // let allCheckedVariants = [].concat(this.checkedVariants).concat(this.checkedCompHetVariants).concat(this.checkedDeNovoVariants);

      const reportedVariants = [];

      for (const i in this.checkedVariants) {
        const variant = Object.assign({}, this.checkedVariants[i]);
        delete variant["stateCheckBox"];
        reportedVariants.push(variant);
      }

      if (utilsNew_UtilsNew.isNotEmptyArray(this.checkedCompHetVariants)) {
        for (const i in this.checkedCompHetVariants) {
          const variant = Object.assign({}, this.checkedCompHetVariants[i]);
          delete variant["stateCheckBox"];
          reportedVariants.push(variant);
        }
      }

      if (utilsNew_UtilsNew.isNotEmptyArray(this.checkedDeNovoVariants)) {
        for (const i in this.checkedDeNovoVariants) {
          const variant = Object.assign({}, this.checkedDeNovoVariants[i]);
          delete variant["stateCheckBox"];
          reportedVariants.push(variant);
        }
      }

      interpretation.primaryFindings = reportedVariants;
      interpretation.attributes = {}; // interpretation.creationDate = moment(new Date(), "YYYYMMDDHHmmss").format('D MMM YY');

      this.interpretation = interpretation; // let params = {
      //     study: this.opencgaSession.study.fqn
      // };
      // let _this = this;
      // this.opencgaSession.opencgaClient.interpretations().create(this.clinicalAnalysis.id, params, interpretation)
      //     .then((response) => {
      //         console.log(response);
      //         // TODO We should update here clinicalAnalysis and add to interpretation list this file with its name from save interpertation form.
      //         if (UtilsNew.isNotUndefinedOrNull(interpretation) && UtilsNew.isNotUndefinedOrNull(interpretation.clinicalAnalysis)) {
      //             if (UtilsNew.isEmptyArray(interpretation.clinicalAnalysis.interpretations)) {
      //                 interpretation.clinicalAnalysis.interpretations = [];
      //             } else {
      //                 interpretation.clinicalAnalysis.interpretations = interpretation.clinicalAnalysis.interpretations.map((interpretation) => {
      //                     return { id: interpretation.id, name: interpretation.name, file:  interpretation.file.id };
      //                 });
      //             }
      //             interpretation.clinicalAnalysis.interpretations.push({
      //                 id: interpretation.id,
      //                 name: interpretation.name,
      //                 file: response.response[0].result[0].id
      //             });
      //         }
      //
      //         params = {
      //             study: _this.opencgaSession.project.alias + ":" + _this.opencgaSession.study.alias
      //         };
      //         let interpretations =  { interpretations: interpretation.clinicalAnalysis.interpretations };
      //         _this.opencgaSession.opencgaClient.clinical().update(interpretation.clinicalAnalysis.id, params, interpretations)
      //             .then((response) => {
      //                 this.dispatchEvent(new CustomEvent(this.eventNotifyName, {
      //                     detail: {
      //                         message:  interpretation.id + " interpretation has been created correctly.",
      //                         type: UtilsNew.MESSAGE_SUCCESS
      //                     },
      //                     bubbles: true,
      //                     composed: true
      //                 }));
      //
      //                 _this.cleanSaveInterpretation();
      //                 console.log(response);
      //                 // Update analysis with new interpretations
      //                 _this.getAnalysisInterpretations();
      //             })
      //             .catch((err) => {
      //                 this.dispatchEvent(new CustomEvent(this.eventNotifyName, {
      //                     detail: {
      //                         message:  err.error,
      //                         type: UtilsNew.MESSAGE_ERROR
      //                     },
      //                     bubbles: true,
      //                     composed: true
      //                 }));
      //             });
      //     })
      //     .catch((err) => {
      //         this.dispatchEvent(new CustomEvent(this.eventNotifyName, {
      //             detail: {
      //                 message:  err.error,
      //                 type: UtilsNew.MESSAGE_ERROR
      //             },
      //             bubbles: true,
      //             composed: true
      //         }));
      //     });
      //
    } catch (err) {
      this.dispatchEvent(new CustomEvent(this.eventNotifyName, {
        detail: {
          message: err,
          type: utilsNew_UtilsNew.MESSAGE_ERROR
        },
        bubbles: true,
        composed: true
      }));
    }
  }

  getDefaultConfig() {
    return {
      title: "Variant Interpreter",
      showSaveInterpretation: true,
      showOtherTools: true,
      activeFilters: {
        alias: {// Example:
          // "region": "Region",
          // "gene": "Gene",
          // "genotype": "Sample Genotypes",
        },
        complexFields: ["genotype"],
        hiddenFields: ["study"]
      },
      genomeBrowser: {
        showTitle: false
      }
    };
  }

  render() {
    return lit_html_lit_html_html(opencga_variant_interpretation_templateObject(), this.checkProjects ? lit_html_lit_html_html(opencga_variant_interpretation_templateObject2(), this.clinicalAnalysis ? lit_html_lit_html_html(opencga_variant_interpretation_templateObject3(), this.config.title, this.clinicalAnalysis.id) : lit_html_lit_html_html(opencga_variant_interpretation_templateObject4(), this.config.title), this._prefix, this.onChangeView, this.onChangeView, this.counterTitles.rv, this._prefix, this.onChangeView, this.onChangeView, this.counterTitles.ch, this._prefix, this.onChangeView, this.onChangeView, this.counterTitles.dn, this._config.showOtherTools ? lit_html_lit_html_html(opencga_variant_interpretation_templateObject5(), this._prefix, this.onChangeView, this.onChangeView, this._prefix, this.onChangeView, this.onChangeView) : null, this.hasClinicalAnalysis ? lit_html_lit_html_html(opencga_variant_interpretation_templateObject6(), this._prefix, this.onChangeView, this.onChangeView, this._prefix, this.onChangeView, this._config.disableSaveInterpretation, this.onChangeView, this.counterTitles.total) : lit_html_lit_html_html(opencga_variant_interpretation_templateObject7(), this._prefix, this.onChangeView, this.onChangeView, this._prefix, this.onChangeView, this._config.disableSaveInterpretation, this.onChangeView, this.counterTitles.total), this._prefix, this._prefix, this._prefix, this.opencgaSession, this.clinicalAnalysis, this.query, this.config, this.cellbaseClient, this.consequenceTypes, this.populationFrequencies, this.proteinSubstitutionScores, this.onSelectVariant, this.onCheckVariant, this._prefix, this.opencgaSession, this.clinicalAnalysis, this.query, this.config, this.cellbaseClient, this.consequenceTypes, this.populationFrequencies, this.proteinSubstitutionScores, this.onSelectCompHetVariant, this.onCheckCompHetVariant, this._prefix, this.opencgaSession, this.clinicalAnalysis, this.query, this.config, this.cellbaseClient, this.consequenceTypes, this.populationFrequencies, this.proteinSubstitutionScores, this.onSelectDeNovoVariant, this.onCheckDeNovoVariant, this._prefix, this.opencgaSession, this.cellbaseClient, this.clinicalAnalysis, this.geneIds, this.diseasePanelIds, this._prefix, this.opencgaSession, this.cellbaseClient, this.samples, this.query, this.search, this.search.region, this.geneIds, this.diseasePanelIds, this.clinicalAnalysis, this._genomeBrowserActive, this.fullScreen, this._config.genomeBrowser, this._prefix, this.opencgaSession, this.clinicalAnalysis, this.config, this._prefix, this._prefix, this.opencgaSession, this.clinicalAnalysis, this.config.clinicalAnalysisBrowser, this.onClinicalAnalysisEditor, this._prefix, this.opencgaSession, this.cellbaseClient, this.clinicalAnalysis, this.interpretation, this.populationFrequencies, this.proteinSubstitutionScores, this.consequenceTypes, this.config, this.geneSelected, this.onSampleChange) : lit_html_lit_html_html(opencga_variant_interpretation_templateObject8()));
  }

}

customElements.define("opencga-variant-interpretation", opencga_variant_interpretation_OpencgaVariantInterpretation);
// CONCATENATED MODULE: ./src/iva-app.js
function _templateObject59() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"settings\">\n                        <iva-settings .opencgaSession=\"", "\">\n                        </iva-settings>\n                    </div>\n                "]);

  _templateObject59 = function _templateObject59() {
    return data;
  };

  return data;
}

function _templateObject58() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"account\">\n                        <iva-profile .opencgaSession=\"", "\">\n                        </iva-profile>\n                    </div>\n                "]);

  _templateObject58 = function _templateObject58() {
    return data;
  };

  return data;
}

function _templateObject57() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"opencga-gwas-analysis\">\n                        <opencga-gwas-analysis .opencgaSession=\"", "\">\n                        </opencga-gwas-analysis>\n                    </div>\n                "]);

  _templateObject57 = function _templateObject57() {
    return data;
  };

  return data;
}

function _templateObject56() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"cat-ga4gh\">\n                        <category-page .opencgaSession=\"", "\" .config=\"", "\">\n                        </category-page>\n                    </div>\n                "]);

  _templateObject56 = function _templateObject56() {
    return data;
  };

  return data;
}

function _templateObject55() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"cat-catalog\">\n                        <category-page .opencgaSession=\"", "\" .config=\"", "\">\n                        </category-page>\n                    </div>\n                "]);

  _templateObject55 = function _templateObject55() {
    return data;
  };

  return data;
}

function _templateObject54() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"cat-clinical\">\n                        <category-page .opencgaSession=\"", "\" .config=\"", "\">\n                        </category-page>\n                    </div>\n                "]);

  _templateObject54 = function _templateObject54() {
    return data;
  };

  return data;
}

function _templateObject53() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"cat-analysis\">\n                        <category-page .opencgaSession=\"", "\" .config=\"", "\">\n                        </category-page>\n                    </div>\n                "]);

  _templateObject53 = function _templateObject53() {
    return data;
  };

  return data;
}

function _templateObject52() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"cat-browser\">\n                        <category-page .opencgaSession=\"", "\" .config=\"", "\">\n                        </category-page>\n                    </div>\n                "]);

  _templateObject52 = function _templateObject52() {
    return data;
  };

  return data;
}

function _templateObject51() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"jobs-facet\">\n                        <opencga-jobs-facet .opencgaSession=\"", "\"\n                                            .config=\"", "\"\n                                            .query=\"", "\"\n                                            @querySearch=\"", "\"\n                                            @activeFilterChange=\"", "\">  \n                        </opencga-jobs-facet>\n                    </div>\n                "]);

  _templateObject51 = function _templateObject51() {
    return data;
  };

  return data;
}

function _templateObject50() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"clinical-analysis-facet\">\n                        <opencga-clinical-analysis-facet    .opencgaSession=\"", "\"\n                                                            .config=\"", "\"\n                                                            .query=\"", "\"\n                                                            @querySearch=\"", "\"\n                                                            @activeFilterChange=\"", "\">  \n                        </opencga-clinical-analysis-facet>\n                    </div>\n                "]);

  _templateObject50 = function _templateObject50() {
    return data;
  };

  return data;
}

function _templateObject49() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"clinicalAnalysis\">\n                        <opencga-clinical-analysis-browser  .opencgaSession=\"", "\"\n                                                            .config=\"", "\"\n                                                            .query=\"", "\"\n                                                            @urlchange=\"", "\">\n                        </opencga-clinical-analysis-browser>\n                    </div>\n                "]);

  _templateObject49 = function _templateObject49() {
    return data;
  };

  return data;
}

function _templateObject48() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"cohort-facet\">\n                        <opencga-cohort-facet   .opencgaSession=\"", "\"\n                                                .opencgaClient=\"", "\"\n                                                .query=\"", "\"\n                                                .config=\"", "\"\n                                                .cellbaseClient=\"", "\"\n                                                .populationFrequencies=\"", "\"\n                                                .proteinSubstitutionScores=\"", "\"\n                                                .consequenceTypes=\"", "\"\n                                                @querySearch=\"", "\"\n                                                @activeFilterChange=\"", "\"\n                        </opencga-cohort-facet>\n                    </div>\n                "]);

  _templateObject48 = function _templateObject48() {
    return data;
  };

  return data;
}

function _templateObject47() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"cohorts\">\n                        <opencga-cohort-browser .query=\"", "\"\n                                                .opencgaSession=\"", "\"\n                                                .config=\"", "\"\n                                                @querySearch=\"", "\"\n                                                @activeFilterChange=\"", "\"\n                                                @facetSearch=\"", "\">\n                        </opencga-cohort-browser>\n                    </div>\n                "]);

  _templateObject47 = function _templateObject47() {
    return data;
  };

  return data;
}

function _templateObject46() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"family-facet\">\n                        <opencga-family-facet .opencgaSession=\"", "\"\n                                        .opencgaClient=\"", "\"\n                                        .query=\"", "\"\n                                        .config=\"", "\"\n                                        .cellbaseClient=\"", "\"\n                                        .populationFrequencies=\"", "\"\n                                        .proteinSubstitutionScores=\"", "\"\n                                        .consequenceTypes=\"", "\"\n                                        @querySearch=\"", "\"\n                                        @activeFilterChange=\"", "\">                                        \n                        </opencga-family-facet>\n                    </div>\n                "]);

  _templateObject46 = function _templateObject46() {
    return data;
  };

  return data;
}

function _templateObject45() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"families\">\n                        <opencga-family-browser .query=\"", "\"\n                                                .opencgaClient=\"", "\"\n                                                .opencgaSession=\"", "\"\n                                                @querySearch=\"", "\"\n                                                @activeFilterChange=\"", "\"\n                                                @facetSearch=\"", "\">\n                        </opencga-family-browser>\n                    </div>\n                "]);

  _templateObject45 = function _templateObject45() {
    return data;
  };

  return data;
}

function _templateObject44() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"individual-facet\">\n                        <opencga-individual-facet .opencgaSession=\"", "\"\n                                        .opencgaClient=\"", "\"\n                                        .query=\"", "\"\n                                        .config=\"", "\"\n                                        .cellbaseClient=\"", "\"\n                                        .populationFrequencies=\"", "\"\n                                        .proteinSubstitutionScores=\"", "\"\n                                        .consequenceTypes=\"", "\"\n                                        @querySearch=\"", "\"\n                                        @activeFilterChange=\"", "\">\n                        </opencga-individual-facet>\n                    </div>\n                "]);

  _templateObject44 = function _templateObject44() {
    return data;
  };

  return data;
}

function _templateObject43() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"individuals\">\n                        <opencga-individual-browser .query=\"", "\"\n                                                    .opencgaClient=\"", "\"\n                                                    .opencgaSession=\"", "\"\n                                                    .configValues=\"", "\"\n                                                    @querySearch=\"", "\"\n                                                    @activeFilterChange=\"", "\"\n                                                    @facetSearch=\"", "\">\n                        </opencga-individual-browser>\n                    </div>\n                "]);

  _templateObject43 = function _templateObject43() {
    return data;
  };

  return data;
}

function _templateObject42() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content feature-view\" id=\"protein\">\n                        <opencga-protein-view .opencgaSession=\"", "\"\n                                              .cellbaseClient=\"", "\"\n                                              .opencgaClient=\"", "\"\n                                              .project=\"", "\"\n                                              .study=\"", "\"\n                                              .protein=\"", "\"\n                                              .populationFrequencies=\"", "\"\n                                              .consequenceTypes=\"", "\"\n                                              .proteinSubstitutionScores=\"", "\"\n                                              .config=\"", "\">\n                        </opencga-protein-view>\n                    </div>\n                "]);

  _templateObject42 = function _templateObject42() {
    return data;
  };

  return data;
}

function _templateObject41() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content feature-view\" id=\"transcript\">\n                        <opencga-transcript-view .cellbaseClient=\"", "\"\n                                                 .opencgaClient=\"", "\"\n                                                 .project=\"", "\"\n                                                 .study=\"", "\"\n                                                 .transcript=\"", "\"\n                                                 .gene=\"", "\"\n                                                 .populationFrequencies=\"", "\"\n                                                 .consequenceTypes=\"", "\"\n                                                 .proteinSubstitutionScores=\"", "\"\n                                                 .config=\"", "\">\n                        </opencga-transcript-view>\n                    </div>\n                "]);

  _templateObject41 = function _templateObject41() {
    return data;
  };

  return data;
}

function _templateObject40() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"sample\" style=\"margin: auto; width: 90%\">\n                        <opencga-sample-view    .opencgaSession=\"", "\"\n                                                .config=\"", "\">\n                        </opencga-sample-view>\n                    </div>\n                "]);

  _templateObject40 = function _templateObject40() {
    return data;
  };

  return data;
}

function _templateObject39() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"gene\" style=\"margin: auto; width: 90%\">\n                        <opencga-gene-view .opencgaSession=\"", "\"\n                                           .cellbaseClient=\"", "\"\n                                           .project=\"", "\"\n                                           .study=\"", "\"\n                                           .gene=\"", "\"\n                                           .populationFrequencies=\"", "\"\n                                           .consequenceTypes=\"", "\"\n                                           .proteinSubstitutionScores=\"", "\"\n                                           .config=\"", "\"\n                                           .summary=\"", "\">\n                        </opencga-gene-view>\n                    </div>\n                "]);

  _templateObject39 = function _templateObject39() {
    return data;
  };

  return data;
}

function _templateObject38() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"files-facet\">\n                        <opencga-file-facet .opencgaSession=\"", "\"\n                                        .opencgaClient=\"", "\"\n                                        .query=\"", "\"\n                                        .config=\"", "\"\n                                        .cellbaseClient=\"", "\"\n                                        .populationFrequencies=\"", "\"\n                                        .proteinSubstitutionScores=\"", "\"\n                                        .consequenceTypes=\"", "\"\n                                        @querySearch=\"", "\"\n                                        @activeFilterChange=\"", "\">\n                        </opencga-file-facet>\n                    </div>\n                "]);

  _templateObject38 = function _templateObject38() {
    return data;
  };

  return data;
}

function _templateObject37() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"files\">\n                        <opencga-file-browser .opencgaSession=\"", "\"\n                                              .config=\"", "\"\n                                              .query=\"", "\"\n                                              @querySearch=\"", "\"\n                                              @activeFilterChange=\"", "\"\n                                              @facetSearch=\"", "\">\n                        </opencga-file-browser>\n                    </div>\n                "]);

  _templateObject37 = function _templateObject37() {
    return data;
  };

  return data;
}

function _templateObject36() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"panel\">\n                        <opencga-panel-browser  .opencgaSession=\"", "\"\n                                                .opencgaClient=\"", "\"\n                                                .cellbaseClient=\"", "\"\n                                                .eventNotifyName=\"", "\"\n                                                @notifymessage=\"", "\">\n                        </opencga-panel-browser>\n                    </div>\n                "]);

  _templateObject36 = function _templateObject36() {
    return data;
  };

  return data;
}

function _templateObject35() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"samples-facet\">\n                        <opencga-sample-facet resource=\"sample\"\n                                        .opencgaSession=\"", "\"\n                                        .opencgaClient=\"", "\"\n                                        .query=\"", "\"\n                                        .config=\"", "\"\n                                        .cellbaseClient=\"", "\"\n                                        .populationFrequencies=\"", "\"\n                                        .proteinSubstitutionScores=\"", "\"\n                                        .consequenceTypes=\"", "\"\n                                        @querySearch=\"", "\"\n                                        @activeFilterChange=\"", "\">\n                        </opencga-sample-facet>\n                    </div>\n                "]);

  _templateObject35 = function _templateObject35() {
    return data;
  };

  return data;
}

function _templateObject34() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"samples\">\n                        <opencga-sample-browser .query=\"", "\"\n                                                .opencgaSession=\"", "\"\n                                                .opencgaClient=\"", "\"\n                                                .config=\"", "\"\n                                                @querySearch=\"", "\"\n                                                @activeFilterChange=\"", "\"\n                                                @facetSearch=\"", "\">\n                        </opencga-sample-browser>\n                    </div>\n                "]);

  _templateObject34 = function _templateObject34() {
    return data;
  };

  return data;
}

function iva_app_templateObject33() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"projects\">\n                        <opencga-projects  .opencgaSession=\"", "\"  \n                                           .opencgaClient=\"", "\"\n                                           .projects=\"", "\"\n                                           .studySummaries=\"", "\"\n                                           @project=\"", "\"\n                                           @study=\"", "\">\n                        </opencga-projects>\n                    </div>\n                "]);

  iva_app_templateObject33 = function _templateObject33() {
    return data;
  };

  return data;
}

function iva_app_templateObject32() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"genomeBrowser\">\n                        <opencga-genome-browser .opencgaSession=\"", "\"\n                                                .cellbaseClient=\"", "\"\n                                                .opencgaClient=\"", "\">\n                        </opencga-genome-browser>\n                    </div>\n                "]);

  iva_app_templateObject32 = function _templateObject32() {
    return data;
  };

  return data;
}

function iva_app_templateObject31() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"beacon\">\n                        <variant-beacon .opencgaSession=\"", "\"\n                                        .hosts=\"", "\">\n                        </variant-beacon>\n                    </div>\n                "]);

  iva_app_templateObject31 = function _templateObject31() {
    return data;
  };

  return data;
}

function iva_app_templateObject30() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"interpretation\">\n                        <opencga-variant-interpretation .opencgaSession=\"", "\"\n                                                        .cellbaseClient=\"", "\"\n                                                        .clinicalAnalysisId=\"", "\"\n                                                        .query=\"", "\"\n                                                        .populationFrequencies=\"", "\"\n                                                        .proteinSubstitutionScores=\"", "\"\n                                                        .consequenceTypes=\"", "\"\n                                                        .config=\"", "\"\n                                                        @gene=\"", "\"\n                                                        @samplechange=\"", "\">\n                        </opencga-variant-interpretation>\n                    </div>\n                "]);

  iva_app_templateObject30 = function _templateObject30() {
    return data;
  };

  return data;
}

function iva_app_templateObject29() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"clinicalAnalysisPortal\">\n                        <opencga-clinical-portal .opencgaSession=\"", "\"\n                                                .opencgaClient=\"", "\"\n                                                .config=\"", "\"\n                                                .cellbaseClient=\"", "\">\n                        </opencga-clinical-portal>\n                    </div>\n                "]);

  iva_app_templateObject29 = function _templateObject29() {
    return data;
  };

  return data;
}

function iva_app_templateObject28() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"facet\">\n                        <opencga-variant-facet  .opencgaSession=\"", "\"\n                                                .opencgaClient=\"", "\"\n                                                .query=\"", "\"\n                                                .config=\"", "\"\n                                                .cellbaseClient=\"", "\"\n                                                .populationFrequencies=\"", "\"\n                                                .proteinSubstitutionScores=\"", "\"\n                                                   .consequenceTypes=\"", "\"\n                                                @querySearch=\"", "\"\n                                                @activeFilterChange=\"", "\">\n                        </opencga-variant-facet>\n                    </div>                \n                "]);

  iva_app_templateObject28 = function _templateObject28() {
    return data;
  };

  return data;
}

function iva_app_templateObject27() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"browser\">\n                        <!--search=\"{{browserSearchQuery}}\"-->\n                        <opencga-variant-browser .opencgaSession=\"", "\"\n                                                .cellbaseClient=\"", "\"\n                                                .reactomeClient=\"", "\"\n                                                .query=\"", "\"\n                                                .active=\"", "\"\n                                                .populationFrequencies=\"", "\"\n                                                .proteinSubstitutionScores=\"", "\"\n                                                .consequenceTypes=\"", "\"\n                                                .config=\"", "\"\n                                                style=\"font-size: 12px\"\n                                                @onGene=\"", "\"\n                                                @onSamplechange=\"", "\"\n                                                @querySearch=\"", "\"\n                                                @activeFilterChange=\"", "\"\n                                                @facetSearch=\"", "\">\n                        </opencga-variant-browser>\n                    </div>\n                "]);

  iva_app_templateObject27 = function _templateObject27() {
    return data;
  };

  return data;
}

function iva_app_templateObject26() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"login\">\n                        <opencga-login  .opencgaClient=\"", "\"\n                                        loginTitle=\"Sign in\"\n                                        .notifyEventMessage=\"", "\"\n                                        @login=\"", "\"\n                                        @notifymessage=\"", "\">\n                        </opencga-login>\n                    </div>\n                "]);

  iva_app_templateObject26 = function _templateObject26() {
    return data;
  };

  return data;
}

function iva_app_templateObject25() {
  const data = iva_app_taggedTemplateLiteral(["\n                <div class=\"content\" id=\"getting-started\">\n                    <getting-started .opencgaSession=\"", "\" .config=\"", "\"></getting-started>\n                </div>\n                "]);

  iva_app_templateObject25 = function _templateObject25() {
    return data;
  };

  return data;
}

function iva_app_templateObject24() {
  const data = iva_app_taggedTemplateLiteral(["\n                <div class=\"content\" id=\"faq\">\n                    <faq-web version=\"", "\"></faq-web>\n                </div>\n                "]);

  iva_app_templateObject24 = function _templateObject24() {
    return data;
  };

  return data;
}

function iva_app_templateObject23() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"contact\">\n                        <contact-web version=\"", "\"></contact-web>\n                    </div>\n                "]);

  iva_app_templateObject23 = function _templateObject23() {
    return data;
  };

  return data;
}

function iva_app_templateObject22() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"terms\">\n                        <terms-web version=\"", "\"></terms-web>\n                    </div>\n                "]);

  iva_app_templateObject22 = function _templateObject22() {
    return data;
  };

  return data;
}

function iva_app_templateObject21() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"about\">\n                        <about-web version=\"", "\"></about-web>\n                    </div>\n                "]);

  iva_app_templateObject21 = function _templateObject21() {
    return data;
  };

  return data;
}

function iva_app_templateObject20() {
  const data = iva_app_taggedTemplateLiteral(["\n                    <div class=\"content\" id=\"home\">\n                        <welcome-web .opencgaSession=\"", "\" version=\"", "\" .cellbaseClient=", " @search=\"", "\" .config=\"", "\"> </welcome-web>\n                    </div>\n                "]);

  iva_app_templateObject20 = function _templateObject20() {
    return data;
  };

  return data;
}

function iva_app_templateObject19() {
  const data = iva_app_taggedTemplateLiteral(["\n                <!--<div>\n                    <ol id=\"breadcrumb\" class=\"breadcrumb\" style=\"margin-bottom: 1px;padding-left: 40px\"></ol>\n                </div>-->\n                <opencga-breadcrumb .config=\"", "\" .opencgaSession=\"", "\"></opencga-breadcrumb>\n            "]);

  iva_app_templateObject19 = function _templateObject19() {
    return data;
  };

  return data;
}

function iva_app_templateObject18() {
  const data = iva_app_taggedTemplateLiteral(["\n                                    <li class=\"dropdown user-menu\">\n                                        <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                                            <i class=\"fa fa-user-circle\" aria-hidden=\"true\" style=\"padding-right: 5px\"></i>", " <span class=\"caret\"></span>\n                                        </a>\n                                        <ul class=\"dropdown-menu\">\n                                            <li>\n                                                <a href=\"#account\"><i class=\"fa fa-user\" aria-hidden=\"true\"></i> Your account</a>\n                                            </li>\n                                            <li>\n                                                <a href=\"#projects\"><i class=\"fa fa-database\" aria-hidden=\"true\"></i> Projects</a>\n                                            </li>\n                                            <li role=\"separator\" class=\"divider\"></li>\n                                            <li>\n                                                <a href=\"#settings\"><i class=\"fa fa-cog\" aria-hidden=\"true\"></i> Settings</a>\n                                            </li>\n                                            <li>\n                                                <a id=\"logoutButton\" role=\"button\" @click=\"", "\">\n                                                    <i class=\"fa fa-sign-out-alt\" aria-hidden=\"true\"></i> Logout\n                                                </a>\n                                            </li>\n                                        </ul>\n                                    </li>\n                                "]);

  iva_app_templateObject18 = function _templateObject18() {
    return data;
  };

  return data;
}

function iva_app_templateObject17() {
  const data = iva_app_taggedTemplateLiteral(["\n                                    <li>\n                                        <a href=\"#login\" id=\"loginButton\" role=\"button\" @click=\"", "\">\n                                            <i href=\"#login\" class=\"fa fa-sign-in-alt fa-lg\" aria-hidden=\"true\" style=\"padding-right: 5px\"></i>Login\n                                        </a>\n                                    </li>\n                                "]);

  iva_app_templateObject17 = function _templateObject17() {
    return data;
  };

  return data;
}

function iva_app_templateObject16() {
  const data = iva_app_taggedTemplateLiteral(["\n                                    <li>\n                                        <a href=\"#", "\" role=\"button\" @click=\"", "\">", "</a>\n                                    </li>\n                                "]);

  iva_app_templateObject16 = function _templateObject16() {
    return data;
  };

  return data;
}

function iva_app_templateObject15() {
  const data = iva_app_taggedTemplateLiteral(["\n                                                <li>\n                                                    <a href=\"", "\" ><i class=\"", "\" aria-hidden=\"true\"></i> ", "</a>\n                                                </li>\n                                            "]);

  iva_app_templateObject15 = function _templateObject15() {
    return data;
  };

  return data;
}

function iva_app_templateObject14() {
  const data = iva_app_taggedTemplateLiteral(["\n                                    <li class=\"dropdown\">\n                                        <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                                            <i class=\"fa fa-question-circle fa-lg\" style=\"padding-right: 5px\"></i>About\n                                        </a>\n                                        <ul class=\"dropdown-menu\">\n                                            ", "\n                                        </ul>\n                                    </li>\n                                "]);

  iva_app_templateObject14 = function _templateObject14() {
    return data;
  };

  return data;
}

function iva_app_templateObject13() {
  const data = iva_app_taggedTemplateLiteral(["\n                                        <form class=\"navbar-form navbar-left\" role=\"search\">\n                                            <div class=\"form-group\">\n                                                <div class=\"input-group search-box-wrapper\">\n                                                    <input class=\"form-control\" id=\"searchTextBox\"  placeholder=\"", "\" @input=\"", "\">\n                                                    <span class=\"input-group-addon\"><span class=\"fa fa-search\" aria-hidden=\"true\" @click=\"", "\"></span></span>\n                                                </div>\n                                            </div>\n                                        </form>\n                                "]);

  iva_app_templateObject13 = function _templateObject13() {
    return data;
  };

  return data;
}

function iva_app_templateObject12() {
  const data = iva_app_taggedTemplateLiteral(["\n                                                    <li>\n                                                        <a href=\"#\" data-study=\"", "\" data-project=\"", "\" @click=\"", "\">", "</a>\n                                                    </li>\n                                                "]);

  iva_app_templateObject12 = function _templateObject12() {
    return data;
  };

  return data;
}

function iva_app_templateObject11() {
  const data = iva_app_taggedTemplateLiteral(["\n                                                <li><a><b>", "</b></a></li>\n                                                ", "                                            \n                                            "]);

  iva_app_templateObject11 = function _templateObject11() {
    return data;
  };

  return data;
}

function iva_app_templateObject10() {
  const data = iva_app_taggedTemplateLiteral(["\n                                    <li class=\"dropdown\">\n                                        <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                                            <i class=\"fa fa-database fa-lg\" style=\"padding-right: 5px\"></i>Studies <span class=\"caret\"></span>\n                                        </a>\n                                        <ul class=\"dropdown-menu\">\n                                            ", "\n                                        </ul>\n                                    </li>\n                                "]);

  iva_app_templateObject10 = function _templateObject10() {
    return data;
  };

  return data;
}

function iva_app_templateObject9() {
  const data = iva_app_taggedTemplateLiteral(["\n                                    <li class=\"notification\">\n                                        <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                                            <span class=\"badge badge-pill badge-primary\">666</span><i class=\"fas fa-bell\"></i>\n                                        </a>\n                                        <ul class=\"dropdown-menu\">\n                                            <li>\n                                                <a href=\"#projects\">that would be a lot of notifications</a>\n                                            </li>\n                                            <li>\n                                                <a href=\"#projects\"> All notifications </a>\n                                            </li>\n                                        </ul>                                           \n                                    </li>\n                                "]);

  iva_app_templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function iva_app_templateObject8() {
  const data = iva_app_taggedTemplateLiteral(["\n                                                    <li><a href=\"#", "\" @click=\"", "\" data-id=\"", "\">", "</a></li>\n                                                "]);

  iva_app_templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function iva_app_templateObject7() {
  const data = iva_app_taggedTemplateLiteral(["\n                                                        <li role=\"separator\" class=\"divider\"></li>\n                                                    "]);

  iva_app_templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function iva_app_templateObject6() {
  const data = iva_app_taggedTemplateLiteral(["\n                                                        <li><a><label>", "</label></a></li>\n                                                    "]);

  iva_app_templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function iva_app_templateObject5() {
  const data = iva_app_taggedTemplateLiteral(["\n                                        <!-- If there is a submenu we create a dropdown menu item -->\n                                        <li class=\"dropdown\">\n                                            <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                                                ", " <span class=\"caret\"></span>\n                                            </a>\n                                            <ul class=\"dropdown-menu\">\n                                                ", "\n                                            </ul>\n                                        </li>"]);

  iva_app_templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function iva_app_templateObject4() {
  const data = iva_app_taggedTemplateLiteral(["\n                                        <li>\n                                            <a href=\"#", "\" role=\"button\" @click=\"", "\">", "</a>\n                                        </li>"]);

  iva_app_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function iva_app_templateObject3() {
  const data = iva_app_taggedTemplateLiteral(["\n                                    <!-- If there is not submenu we just display a button -->\n                                    ", ""]);

  iva_app_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function iva_app_templateObject2() {
  const data = iva_app_taggedTemplateLiteral(["\n                        <li>\n                            <a href=\"#cat-", "\" role=\"button\" @click=\"", "\">\n                                <img src=\"img/tools/icons/", "\"  alt=\"", "\"/>  ", "\n                            </a>\n                         </li>\n                    "]);

  iva_app_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function iva_app_templateObject() {
  const data = iva_app_taggedTemplateLiteral(["\n            <style include=\"jso-styles\">                \n                .navbar-inverse {\n                    background-color: #0c2f4c;\n                }\n                .navbar-inverse .navbar-nav>.open>a, .navbar-inverse .navbar-nav>.open>a:focus, .navbar-inverse .navbar-nav>.open>a:hover {\n                    background-color: #09243a;\n                }\n                .navbar-inverse .navbar-nav>.active>a, .navbar-inverse .navbar-nav>.active>a:focus, .navbar-inverse .navbar-nav>.active>a:hover {\n                    background-color: #09243a;\n                }\n                .navbar-inverse .navbar-nav>li>a {\n                    color: #d2d2d2;\n                }\n                .navbar-inverse .dropdown-menu>.active>a, .navbar-inverse .dropdown-menu>.active>a:focus, .navbar-inverse .dropdown-menu>.active>a:hover {\n                    background-color: #0c2f4c;\n                }\n                                \n                .navbar-nav li.notification > a > i {\n                    font-size: 25px;\n                    position: absolute;\n                    left: 10px;\n                    top: 13px;\n                }\n                \n                .navbar-nav li.user-menu > a {\n                    padding-left: 40px;                \n                }\n    \n                .navbar-nav li.user-menu > a > i {\n                    font-size: 25px;\n                    position: absolute;\n                    left: 10px;\n                    top: 13px;\n                }\n                \n                .navbar-nav .badge  {\n                    position: relative;\n                    z-index: 10;\n                    bottom: 6px;\n                    left: 9px;\n                    background-color: #41a7ff;\n                }\n                \n                .center {\n                    margin: auto;\n                    text-align: justify;\n                    width: 60%;\n                    font-size: 18px;\n                    color: #797979;\n                }\n            \n                .feature-view {\n                    margin: auto;\n                    text-align: justify;\n                    width: 90%;\n                }\n                .search-box-wrapper .form-control{\n                    border-right-width: 0;                   \n                }\n                .search-box-wrapper .input-group-addon{\n                    background: #fff;\n                    cursor: pointer;\n                }\n                .search-box-wrapper .input-group-addon:hover{\n                    background: #eee;\n                }\n                #searchTextBox {\n                    width: 100px;\n                }\n                \n                #login {\n                    display: flex;\n                    align-items: center; \n                    justify-content: center;\n                }\n               \n                            \n            /* The side navigation menu */\n            #side-nav {\n                position: fixed;\n                z-index: 10; \n                top: 0; \n                left: -250px;\n                background-color: #fff; \n                overflow-x: hidden;\n                padding-top: 20px; \n                width: 250px;\n                visibility: hidden;\n                /*transform: translate(-250px);*/                \n                height: 100vh;\n                transform-origin: top left;\n                animation-duration: .3s;\n                animation-timing-function: ease;\n                animation-name: slideOutFrames\n            }\n            \n            #side-nav.active {\n                left: 0px;\n                visibility: visible;\n                animation-name: slideInFrames\n            }  \n            \n            #side-nav a.logo {\n                margin: 25px 0px 15px 30px;\n                display: block;;\n            }\n            \n            #side-nav .logo img{\n                width: 150px;\n            }\n            \n            #side-nav .nav a {\n                padding: 8px;\n                text-decoration: none;\n                color: #818181;\n                display: block;\n                transition: 0.3s;\n                font-size: 14px;\n                text-transform: uppercase;\n                letter-spacing: 2px;\n            }\n            \n            #side-nav .nav a:hover {            \n                color: #204d74;\n            }\n\n            #side-nav .closebtn {\n                position: absolute;\n                top: 0;\n                right: 25px;\n                font-size: 36px;\n                margin-left: 50px;\n                padding:0;\n                z-index: 99;\n            }\n            \n            #side-nav a.closebtn:hover {        \n                background: transparent;\n                text-decoration: none;\n                color: black;\n            }\n            \n            #side-nav a > img {\n                width:48px\n            }\n            \n            #overlay {\n                position: fixed;\n                transform: translate(-100%);\n                width: 100%;\n                height: 100%;\n                top: 0;\n                left: 0;\n                right: 0;\n                bottom: 0;\n                background-color: rgba(0,0,0,.2);\n                z-index: 9;\n                transition: filter .3s, opacity .3s; \n                opacity:0;                \n                filter:alpha(opacity=100);\n            }\n            \n            #overlay.active {\n                display: block;\n                opacity:1;                \n                filter:alpha(opacity=50);\n                transform: translate(0);\n            }\n\n            \n            </style>\n\n            <div id=\"overlay\" @click=\"", "\"></div>\n            <div id=\"side-nav\" class=\"sidenav shadow-lg\">\n                <a href=\"javascript:void(0)\" class=\"closebtn\" @click=\"", "\">&times;</a>\n                <nav class=\"navbar\" id=\"sidebar-wrapper\" role=\"navigation\">\n                    <div>\n                        <a href=\"#home\" class=\"logo\" @click=\"", "\"><img src=\"", "\" alt=\"logo\"></a>\n                    </div>\n                    <ul class=\"nav sidebar-nav\">\n                    ", "\n                    </ul>\n                </nav>\n            </div>\n            \n            <div>\n                <nav class=\"navbar navbar-inverse\" style=\"margin-bottom: 5px; border-radius: 0px\">\n                    <div>\n            \n                        <ul class=\"nav navbar-nav\">\n                            <li>\n                                <a href=\"#\" @click=\"", "\" id=\"waffle-icon\">\n                                   <img src=\"img/waffle-icon.svg\" />\n                                </a>\n                            </li>\n                        </ul>\n                        <!-- Brand and toggle get grouped for better mobile display -->\n                        <div class=\"navbar-header\">\n                            <a href=\"#home\" class=\"navbar-brand\" style=\"padding-top: 10px\" @click=\"", "\">\n                                <img src=\"", "\" width=\"100px\" alt=\"logo\">\n                            </a>\n                            <a class=\"navbar-brand\" href=\"#home\" @click=\"", "\">\n                                <b>", " <sup>", "</sup></b>\n                            </a>\n                        </div>\n            \n                        <!-- Collect the nav links, forms, and other content for toggling -->\n                        <div class=\"collapse navbar-collapse\" id=\"bs-example-navbar-collapse-1\">\n            \n                            <!-- Controls aligned to the LEFT -->\n                            <ul class=\"nav navbar-nav\">\n                                <!-- This code parse the config menu arrays and creates a custom menu taken into account visibility -->\n                                ", "\n                            </ul>\n                            <!-- Controls aligned to the RIGHT: settings and about-->\n                            <ul class=\"nav navbar-nav navbar-right\">\n                               <!-- Jobs -->\n                                ", "\n            \n                                \n                                <!--Studies dropdown and Search menu-->\n                                ", "\n            \n                                <!--Search menu-->\n                                ", "\n            \n                                <!-- About dropdown menu-->\n                                ", "\n                                \n                                <!-- Login/Logout button -->\n                                ", "\n                                \n                                <!--User-->\n                                ", "                   \n                            </ul>\n                        </div>\n                    </div>\n                </nav>\n            </div>\n            <!-- End of navigation bar -->\n            \n            <!--Breadcrumb-->\n            ", "\n            \n            <!-- This is where main application is rendered -->\n            <div>\n                ", "\n            \n                ", "\n            \n                ", "\n            \n                ", "\n            \n                ", "\n                \n                ", "\n            </div>\n            \n             <!-- -<div class=\"alert alert-info\">", "</div> --> \n            \n            <!-- This is where main IVA application is rendered -->\n            <div class=\"container-fluid\">\n            \n                ", "\n                            \n                ", "\n                \n                ", "\n\n                ", "\n                \n                ", "\n                \n                ", "\n                    \n                ", " \n                \n                ", "\n                \n                ", "\n                \n                ", "\n                \n                ", "\n                \n                ", "\n\n                ", "\n\n                <!--todo check-->\n                ", "\n                \n                ", "\n                \n                \n                ", "\n                \n                ", "\n                \n                ", "\n                \n                ", "\n                \n                ", "\n                \n                ", "\n\n                ", "\n\n                ", "\n                \n                ", "\n                \n                ", "\n                                \n                ", "\n                                \n                ", "\n                \n                ", "\n                \n                ", "\n                \n                ", "\n                \n                ", "                                                                \n                                \n                                \n                ", "\n                \n                ", "\n                                \n                ", "\n                \n                \n            <!-- TODO convert in lit-element\n                <template is=\"dom-if\" if=\"{{config.enabledComponents.clinical}}\">\n                    <div class=\"content\" id=\"clinical\">\n                        <opencga-variant-clinical opencga-session=\"{{opencgaSession}}\" config=\"[[config.tools.clinical]]\"\n                                                  population-frequencies=\"{{config.populationFrequencies}}\"\n                                                  protein-substitution-scores=\"{{config.proteinSubstitutionScores}}\"\n                                                  consequence-types=\"{{config.consequenceTypes}}\"\n                                                  opencga-client=\"{{opencgaClient}}\" cellbase-client=\"{{cellbaseClient}}\"\n                                                  on-notifymessage=\"onNotifyMessage\"\n                                                  event-notify-name=\"{{config.notifyEventMessage}}\">\n                        </opencga-variant-clinical>\n                    </div>\n                </template>\n                \n                <template is=\"dom-if\" if=\"{{config.enabledComponents.settings}}\">\n                    <div class=\"content\" id=\"settings\" style=\"width: 40%; margin: auto\">\n                        <br>\n                        <iva-settings opencga-client=\"{{opencgaClient}}\" on-config=\"refreshConfig\"\n                                      default-config=\"{{defaultConfig}}\">\n                        </iva-settings>\n                    </div>\n                </template>\n            \n                <template is=\"dom-if\" if=\"{{config.enabledComponents.project}}\">\n                    <div class=\"content\" id=\"project\">\n                        <opencga-project opencga-client=\"{{opencgaClient}}\" project=\"{{opencgaSession.project}}\"\n                                         study-summaries=\"{{studySummaries}}\"\n                                         on-study=\"updateStudy\">\n                        </opencga-project>\n                    </div>\n                </template>\n            \n                <template is=\"dom-if\" if=\"{{config.enabledComponents.clinicalAnalysisCreator}}\">\n                    <div class=\"content\" id=\"clinicalAnalysisCreator\">\n                        <opencga-clinical-analysis-creator opencga-session=\"{{opencgaSession}}\"\n                                                           config=\"{{config.clinicalAnalysisBrowser}}\"></opencga-clinical-analysis-creator>\n                    </div>\n                </template>\n                -->\n            \n            </div>"]);

  iva_app_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function iva_app_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

function iva_app_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function iva_app_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { iva_app_ownKeys(Object(source), true).forEach(function (key) { iva_app_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { iva_app_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function iva_app_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

/**
 * Copyright 2015-2019 OpenCB
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
// import { LitElement, html } from 'lit-element'; // bare import by name doesn't work yet in browser,
// see: https://www.polymer-project.org/blog/2018-02-26-3.0-preview-paths-and-names










 // @dev[jsorolla]
































 // /@dev
//import {OpenCGAClient, CellBaseClientConfig, CellBaseClient, ReactomeClient, UtilsNew, NotificationUtils} from "../lib/jsorolla/dist/main.js";

class iva_app_IvaApp extends lit_element_LitElement {
  constructor() {
    super();

    this._init();
  }

  createRenderRoot() {
    return this;
  }

  static get properties() {
    return {
      opencgaSession: {
        type: Object
      },
      // samples: {
      //     type: Array
      // },
      // studySummaries: {
      //     type: Array
      // },
      // tool: {
      //     type: String
      // },
      cellbaseClient: {
        type: Object
      },
      config: {
        type: Object
      }
    };
  }
  /**
   * This function creates all the initial configuration
   * @private
   */


  _init() {
    // Create the 'config' , this objects contains all the different configuration
    const _config = application;
    _config.menu.counter = 0;
    _config.cellbase = cellbase;
    _config.tools = tools;
    _config.opencga = opencga; // _config.species = DEFAULT_SPECIES;

    _config.enabledComponents = {}; // _config.panelExamples = diseasePanels;

    _config.populationFrequencies = populationFrequencies;
    _config.proteinSubstitutionScores = proteinSubstitutionScores;
    _config.consequenceTypes = consequenceTypes; // We can customise which components are active by default, this improves the first loading time.

    _config.enabledComponents.home = true;
    _config.enabledComponents.about = false;
    _config.enabledComponents.contact = false;
    _config.enabledComponents.terms = false;
    _config.enabledComponents.faq = false;
    _config.enabledComponents.gettingstarted = false; // Enable tools reading the configuration

    for (const tool in _config.tools) {
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(_config.tools[tool].active)) {
        _config.enabledComponents[tool] = _config.tools[tool].active;
      }
    } // console.log("this.config.enabledComponents",_config.enabledComponents)
    // Enabled components catalog


    const components = ["login", "projects", "project", "sample", "files", "samples", "individuals", "families", "cohorts", "clinicalAnalysis", "clinicalAnalysisPortal", "clinicalAnalysisCreator", "settings", "gene", "transcript", "protein", "files-facet", "sample-grid", "sample-browser", "sample-facet", "individual-facet", "family-facet", "cohort-facet", "clinical-analysis-facet", "jobs-facet", "cat-browser", "cat-analysis", "cat-clinical", "cat-catalog", "cat-ga4gh", "gwas", "settings", "account"];

    for (const component of components) {
      _config.enabledComponents[component] = false;
    } // We set the global Polymer variable, this produces one single event


    this.config = _config; // We deep clone some config sections for having a default initial copy, this allows us to reset config.

    this.defaultConfig = {};

    if (utilsNew_UtilsNew.isNotUndefined(populationFrequencies)) {
      this.defaultConfig.populationFrequencies = JSON.parse(JSON.stringify(populationFrequencies));
    }

    if (utilsNew_UtilsNew.isNotUndefined(proteinSubstitutionScores)) {
      this.defaultConfig.proteinSubstitutionScores = JSON.parse(JSON.stringify(proteinSubstitutionScores));
    }

    if (utilsNew_UtilsNew.isNotUndefined(consequenceTypes)) {
      this.defaultConfig.consequenceTypes = JSON.parse(JSON.stringify(consequenceTypes));
    } // We need to listen to hash fragment changes to update the display and breadcrumb


    const _this = this;

    window.onhashchange = function () {
      _this.hashFragmentListener(_this);
    }; // Remember the tool that was previously set


    this.tool = window.location.hash.split("/")[0];

    if (utilsNew_UtilsNew.isEmpty(this.tool)) {
      this.tool = "#home";
    } // Go to the page that tool has


    if (window.location.hash !== this.tool) {
      window.location.hash = this.tool;
    } // Other initialisations


    this.icd10 = ICD_10;
    this._isBreadcrumbVisible = false; // This manages the samples selected in each tool for updating the breadcrumb

    this.samples = [];
    this._samplesPerTool = {}; // Initialise clients and create the session
    // this.opencgaClientConfig = new OpenCGAClientConfig(this.config.opencga.host, this.config.opencga.version, true, this.config.opencga.cookie.prefix);
    // this.opencgaClientConfig.serverVersion = this.config.opencga.serverVersion;

    const sid = Cookies.get(this.config.opencga.cookie.prefix + "_sid");
    const userId = Cookies.get(this.config.opencga.cookie.prefix + "_userId");
    this.opencgaClient = new opencga_client_OpenCGAClient({
      host: this.config.opencga.host,
      version: this.config.opencga.version,
      token: sid,
      userId: userId,
      cookies: {
        active: true,
        prefix: this.config.opencga.cookie.prefix
      },
      // TODO remove this soon!
      serverVersion: this.config.opencga.serverVersion
    });
    this.cellBaseClientConfig = new CellBaseClientConfig(this.config.cellbase.hosts, this.config.cellbase.version, "hsapiens");
    this.cellbaseClient = new cellbase_client_CellBaseClient(this.cellBaseClientConfig);
    console.log("cellbaseClient iva-app", this.cellbaseClient);
    this.reactomeClient = new ReactomeClient();

    if (utilsNew_UtilsNew.isNotEmpty(sid)) {
      // && !this._publicMode
      // this.opencgaClient._config.token = sid;
      this._createOpenCGASession(); // This must happen after creating the OpencgaClient


      this.checkSessionActive();
      this.intervalCheckSession = setInterval(this.checkSessionActive.bind(this), this.config.session.checkTime);
    } else {
      this._createOpencgaSessionFromConfig();
    } // this.browserSearchQuery = {gene: "BRCA2", sample: "NA12877", study: "platinum"};
    // this.browserSearchQuery = {};
    // run the observer the first time doesnt work TODO check why
    // this.opencgaSessionObserver();


    this.browserSearchQuery = {}; // keeps track of the executedQueries transitioning from browser tool to facet tool

    this.queries = [];
  }

  updated(changedProperties) {
    if (changedProperties.has("opencgaSession")) {
      this.opencgaSessionObserver();
    }
  }

  opencgaSessionObserver() {
    this.renderHashFragments(); // this._isBreadcrumbVisible = this.config.breadcrumb.visible && this.opencgaSession.projects !== undefined && this.opencgaSession.projects.length !== 0;

    this.requestUpdate(); // this.renderBreadcrumb();
  }

  _createOpenCGASession() {
    const _this = this;

    const opencgaSession = this.opencgaClient.createSession().then(function (response) {
      console.log("_createOpenCGASession", response); // check if project array has been defined in the config.js

      if (utilsNew_UtilsNew.isNotEmptyArray(_this.config.opencga.projects)) {
        // We store the project and study ids the user needs to visualise (defined in the config.js)
        const configProjects = {};

        for (let i = 0; i < _this.config.opencga.projects.length; i++) {
          configProjects[_this.config.opencga.projects[i].id] = [];

          for (let j = 0; j < _this.config.opencga.projects[i].studies.length; j++) {
            configProjects[_this.config.opencga.projects[i].id].push(_this.config.opencga.projects[i].studies[j].id);
          }
        } // We must keep only the projects defined in the configuration file


        const activeProjects = [];

        for (let i = 0; i < response.projects.length; i++) {
          if (response.projects[i].id in configProjects) {
            const project = response.projects[i];
            const activeStudies = [];

            for (let j = 0; j < project.studies.length; j++) {
              const study = project.studies[j];

              if (configProjects[project.id].indexOf(study.id) > -1) {
                activeStudies.push(study);
              }
            } // We replace the studies obtained with the ones from the configuration file


            project.studies = activeStudies;
            activeProjects.push(project);
          }
        } // TODO we must query projects/info URL to get the whole object


        response.projects = activeProjects;

        if (utilsNew_UtilsNew.isNotEmptyArray(response.projects[0].studies)) {
          response.project = response.projects[0];
          response.study = response.projects[0].studies[0];
        }
      } // this forces the observer to be executed.


      _this.opencgaSession = Object.assign({}, response); // _this.set('config.menu', application.menu.slice()); // Do not remove: this is for refreshing the menu
      // TODO check if render works

      _this.config.menu = application.menu.slice();
      _this.config = iva_app_objectSpread({}, _this.config);
    }).catch(function (response) {
      console.log("An error when creating the OpenCGA session:");
      console.error(response);
    });
  } //TODO turn this into a Promise


  _createOpencgaSessionFromConfig() {
    // Create a private opencga-session to avoid calling to the Observer
    const opencgaSession = this.opencgaClient.createAnonymousSession(); // If 'config.opencga.anonymous' exists and contains either 'user' or 'projects'

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.config.opencga.anonymous) && Object.keys(this.config.opencga.anonymous).length > 0) {
      // If 'projects' is defined we only load those projects
      if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.config.opencga.anonymous.projects)) {
        if (this.config.opencga.anonymous.projects.length > 0) {
          // TODO we must query projects/info URL to get the whole object
          opencgaSession.projects = this.config.opencga.anonymous.projects;

          if (utilsNew_UtilsNew.isNotEmptyArray(opencgaSession.projects[0].studies)) {
            opencgaSession.project = opencgaSession.projects[0];
            opencgaSession.study = opencgaSession.projects[0].studies[0];
          }
        } // This triggers the event and call to opencgaSessionObserver


        this.opencgaSession = opencgaSession;
      } else {
        // When no 'projects' is defined we fetch all public projects
        if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.config.opencga.anonymous.user)) {
          const _this = this;

          this.opencgaClient.users().projects(this.config.opencga.anonymous.user, {}).then(function (response) {
            // _this._setup(_projects);
            opencgaSession.projects = response.response[0].result;

            if (utilsNew_UtilsNew.isNotEmptyArray(opencgaSession.projects) && utilsNew_UtilsNew.isNotEmptyArray(opencgaSession.projects[0].studies)) {
              // this sets the current active project and study
              opencgaSession.project = opencgaSession.projects[0];
              opencgaSession.study = opencgaSession.projects[0].studies[0];
            } // This triggers the event and call to opencgaSessionObserver


            _this.opencgaSession = opencgaSession;
          }).catch(function (response) {
            console.log("An error when getting projects");
            console.log(response);
          });
        }
      }
    } else {
      // This triggers the event and call to opencgaSessionObserver
      this.opencgaSession = opencgaSession;
    }
  }

  onLogin(credentials) {
    // This creates a new authenticated opencga-session object
    console.log("iva-app: roger I'm in", credentials);
    this.opencgaClient._config.token = credentials.detail.token;

    this._createOpenCGASession();

    if (this.tool === "#login") {
      this.tool = "#home";
    } // 60000 ms = 1 min. Every 1 min we check if session is close to expire.


    this.intervalCheckSession = setInterval(this.checkSessionActive.bind(this), this.config.session.checkTime);
  }

  refresh() {
    this.opencgaClient.refresh();
  }

  async logout() {
    // this delete token in the client and removes the Cookies
    this.opencgaClient.logout();

    this._createOpencgaSessionFromConfig(); // TODO check if render works


    this.config.menu = application.menu.slice(); // Do not remove: this is for refreshing the menu

    this.tool = "#home";
    window.location.hash = "home";
    window.clearInterval(this.intervalCheckSession);
  }

  onUrlChange(e) {
    let hashFrag = e.detail.id;

    if (utilsNew_UtilsNew.isNotUndefined(this.opencgaSession.project) && utilsNew_UtilsNew.isNotEmpty(this.opencgaSession.project.alias)) {
      hashFrag += "/" + this.opencgaSession.project.alias;

      if (utilsNew_UtilsNew.isNotUndefined(this.opencgaSession.study) && utilsNew_UtilsNew.isNotEmpty(this.opencgaSession.study.alias)) {
        hashFrag += "/" + this.opencgaSession.study.alias;
      }
    }

    const myQueryParams = [];

    for (const key in e.detail.query) {
      myQueryParams.push(key + "=" + e.detail.query[key]);
    }

    if (myQueryParams.length > 0) {
      hashFrag += "?".concat(myQueryParams.join("&"));
    }

    window.location.hash = hashFrag;
  }

  checkSessionActive() {
    let _message = ""; // We check if refresh token has updated session id cookie
    // let sid = Cookies.get(this.config.opencga.cookie.prefix + "_sid");

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaClient._config.token)) {
      // UtilsNew.isNotEmpty(this.opencgaSession.token) &&
      // this.token = sid;
      const decoded = jwt_decode(this.opencgaClient._config.token);
      const currentTime = new Date().getTime();
      const remainingTime = decoded.exp * 1000 - currentTime; // 600000 ms = 10 min = 1000(1sec) * 60(60 sec = 1min) * 10(10 min)

      if (remainingTime <= this.config.session.maxRemainingTime && remainingTime >= this.config.session.minRemainingTime) {
        const remainingMinutes = Math.floor(remainingTime / this.config.session.minRemainingTime);
        _message = "Your session is close to expire. <strong>" + remainingMinutes + " minutes remaining</strong>. <a href=\"#\" onclick='eval(NotificationUtils.refreshToken()); return false;'>Click here to refresh</a>";
      } else {
        if (remainingTime < this.config.session.minRemainingTime) {
          _message = "Your session has expired.";
          this.logout();
          window.clearInterval(this.intervalCheckSession);
        } else {
          if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.notifySession)) {
            NotificationUtils_NotificationUtils.closeNotify(this.notifySession);
          }

          return;
        }
      }
    } else {} // _message = "Your session has expired.";
    // window.clearInterval(this.intervalCheckSession);
    // delay = 0 to fix the notify until user closes it.


    if (utilsNew_UtilsNew.isNotEmpty(_message)) {
      this.notifySession = NotificationUtils_NotificationUtils.showNotify(_message, utilsNew_UtilsNew.MESSAGE_INFO, {}, {
        delay: 0,
        onClosed: this.onCloseRefreshNotify.bind(this)
      }, this.opencgaClient, this.notifySession);
    }
  }

  onCloseRefreshNotify() {
    delete this.notifySession;
  }

  changeTool(e) {
    $(".navbar-inverse ul > li", this).removeClass("active");
    $(e.target).parent("li").addClass("active");

    if ($(e.target).closest("ul").hasClass("dropdown-menu")) {
      $(e.target).closest("ul").closest("li").addClass("active");
    }

    if (utilsNew_UtilsNew.isNotUndefined(e)) {
      e.preventDefault(); // prevents the hash change to "#" and allows to manipulate the hash fragment as needed
    }

    if (utilsNew_UtilsNew.isNotUndefined(e.target) && utilsNew_UtilsNew.isNotUndefined(e.target.attributes.href)) {
      //                    $(e.target.attributes.href.value).show(); // get the href and use it find which div to show
      this.tool = e.target.attributes.href.value;

      if (utilsNew_UtilsNew.isNotUndefinedOrNull(this._samplesPerTool)) {
        if (this._samplesPerTool.hasOwnProperty(this.tool.replace("#", ""))) {
          this.samples = this._samplesPerTool[this.tool.replace("#", "")];
        } else {
          this.samples = [];
        }
      } // this.renderBreadcrumb()

    } else {
      this.tool = "#home";
    }

    this.renderHashFragments();
  } // _setup(projects) {
  //     // We check that at least one project with one study exist, otherwise we do not do anything
  //     if (UtilsNew.isNotUndefined(projects) && projects.length > 0 && projects[0].studies.length > 0) {
  //         this.projects = projects;
  //         this.project = projects[0];
  //         this.study = projects[0].studies[0];
  //
  //         let _this = this;
  //         let projectPromises = [];
  //         projects.forEach(function (project) {
  //             let studyPromises = [];
  //             project.studies.forEach(function (study) {
  //                 studyPromises.push(_this.opencgaClient.studies().summary(project.alias + ":" + study.alias));
  //             });
  //             projectPromises.push(Promise.all(studyPromises)
  //                 .then(function (responses) {
  //                     let studies = [];
  //                     responses.forEach(function (response) {
  //                         let study = response.response[0].result[0];
  //                         study.creationDate = moment(study.creationDate, "YYYYMMDDHHmmss").format('D MMM YY');
  //                         studies.push(study);
  //                     });
  //                     return studies;
  //                 }));
  //         });
  //
  //         let _projects = [];
  //         Promise.all(projectPromises)
  //             .then(function (responses) {
  //                 for (let i = 0; i < responses.length; i++) {
  //                     _projects.push({
  //                         id: _this.projects[i].id,
  //                         alias: _this.projects[i].alias,
  //                         name: _this.projects[i].name,
  //                         organism: _this.projects[i].organism,
  //                         studies: responses[i]
  //                     });
  //                 }
  //                 _this.studySummaries = _projects;
  //             });
  //     }
  // }


  renderHashFragments() {
    console.log("renderHashFragments - DEBUG", this.tool);
    let hashFrag = this.tool;

    if (utilsNew_UtilsNew.isNotUndefined(this.opencgaSession.project) && utilsNew_UtilsNew.isNotEmpty(this.opencgaSession.project.alias)) {
      hashFrag += "/" + this.opencgaSession.project.id;

      if (utilsNew_UtilsNew.isNotUndefined(this.opencgaSession.study) && utilsNew_UtilsNew.isNotEmpty(this.opencgaSession.study.alias)) {
        hashFrag += "/" + this.opencgaSession.study.id;
      }
    }

    if (window.location.hash === hashFrag) {
      this.hashFragmentListener(this);
    } else {
      window.location.hash = hashFrag;
    }
  }

  hashFragmentListener(ctx) {
    console.log("hashFragmentListener - DEBUG", this.tool); // Hide all elements

    for (const element in this.config.enabledComponents) {
      if (utilsNew_UtilsNew.isNotUndefined(this.config.enabledComponents[element])) {
        this.config.enabledComponents[element] = false;
      }
    }

    let arr = window.location.hash.split("/");
    const [hashTool, hashProject, hashStudy, feature] = arr; // Stopping the recursive call

    if (hashTool !== this.tool || utilsNew_UtilsNew.isNotUndefined(this.opencgaSession) && utilsNew_UtilsNew.isNotUndefined(this.opencgaSession.project) && hashProject !== this.opencgaSession.project.alias || utilsNew_UtilsNew.isNotUndefined(this.study) && hashStudy !== this.opencgaSession.study.alias) {
      if (arr.length > 1) {
        // Field 'project' is being observed, just in case Polymer triggers
        // an unnecessary event we can check they are really different
        if (ctx.opencgaSession.project.alias !== hashProject) {
          ctx.opencgaSession.project.alias = hashProject;
        }

        if (arr.length > 2 && ctx.opencgaSession.study !== hashStudy) {
          for (let i = 0; i < ctx.opencgaSession.projects.length; i++) {
            if (ctx.opencgaSession.projects[i].name === ctx.opencgaSession.project.name || ctx.opencgaSession.projects[i].alias === ctx.opencgaSession.project.alias) {
              for (let j = 0; j < ctx.opencgaSession.projects[i].studies.length; j++) {
                if (ctx.opencgaSession.projects[i].studies[j].name === hashStudy || ctx.opencgaSession.projects[i].studies[j].alias === hashStudy) {
                  ctx.opencgaSession.study = ctx.opencgaSession.projects[i].studies[j];
                  break;
                }
              }

              break;
            }
          }
        }
      }

      switch (hashTool) {
        case "#browser":
          this.browserSearchQuery = Object.assign({}, this.browserSearchQuery);
          break;

        case "#protein":
          break;

        case "#interpretation":
          this.clinicalAnalysisId = feature;
          break;
      }

      if (utilsNew_UtilsNew.isNotEmpty(feature)) {
        if (hashTool === "#protein") {
          ctx.protein = feature;
        } else if (feature.startsWith("ENST")) {
          ctx.transcript = feature;
        } else {
          ctx.gene = feature;
        }
      }

      ctx.tool = hashTool;
    }

    const searchArr = window.location.hash.split("?");

    if (searchArr.length > 1) {
      const search = searchArr[1];
      arr = search.split("&");
      const query = {};

      for (let i = 0; i < arr.length; i++) {
        const split = arr[i].split("=");
        query[split[0]] = split[1];
      }

      this.query = query;
    }

    if (utilsNew_UtilsNew.isNotUndefined(this.config.enabledComponents[this.tool.replace("#", "")])) {
      this.config.enabledComponents[this.tool.replace("#", "")] = true;
    }

    this.config = iva_app_objectSpread({}, this.config);
  }

  refreshConfig(e) {
    const colorConfig = e.detail.config;

    const _this = this;

    for (const key in colorConfig) {
      switch (key) {
        case "consequenceTypes":
          const ctColor = colorConfig[key].color;

          for (const impact in ctColor) {
            _this.consequenceTypes.color[impact] = ctColor[impact];
          }

          const ctModified = Object.assign({}, _this.consequenceTypes);
          _this.consequenceTypes = ctModified;
          break;

        case "proteinSubstitutionScores":
          for (const source in colorConfig[key]) {
            if (source === "sift") {
              const sift = colorConfig[key].sift;

              for (const prediction in sift) {
                _this.proteinSubstitutionScores.sift[prediction] = sift[prediction];
              }
            } else if (source === "polyphen") {
              const polyphen = colorConfig[key].polyphen;

              for (const pred in polyphen) {
                _this.proteinSubstitutionScores.polyphen[pred] = polyphen[pred];
              }
            }
          }

          const pssModified = Object.assign({}, _this.proteinSubstitutionScores);
          _this.proteinSubstitutionScores = pssModified;
          break;

        case "populationFrequencies":
          const pfColor = colorConfig[key].color;

          for (const i in pfColor) {
            _this.populationFrequencies.color[i] = pfColor[i];
          }

          const pfModified = Object.assign({}, _this.populationFrequencies);
          _this.populationFrequencies = pfModified;
          break;
      }
    }
  }

  onStudySelect(e) {
    e.preventDefault(); // prevents the hash change to "#" and allows to manipulate the hash fragment as needed

    const [_studyname, _projectname] = [e.target.getAttribute("data-study"), e.target.getAttribute("data-project")];

    let _project;

    let _study;

    for (let i = 0; i < this.opencgaSession.projects.length; i++) {
      if (this.opencgaSession.projects[i].name === _projectname) {
        _project = this.opencgaSession.projects[i];

        for (let j = 0; j < this.opencgaSession.projects[i].studies.length; j++) {
          if (this.opencgaSession.projects[i].studies[j].name === _studyname || this.opencgaSession.projects[i].studies[j].alias === _studyname) {
            _study = this.opencgaSession.projects[i].studies[j];
            break;
          }
        }

        break;
      }
    }

    this.opencgaSession = iva_app_objectSpread({}, this.opencgaSession, {
      project: _project,
      study: _study
    });
  }

  updateProject(e) {
    for (let i = 0; i < this.projects.length; i++) {
      if (this.projects[i].name === e.detail.project.name) {
        // getting the selected project from projects array
        this.project = this.projects[i];
      }
    }

    this.tool = "#project";
    this.renderHashFragments(); // this.renderBreadcrumb();
  }

  updateStudy(e) {
    if (utilsNew_UtilsNew.isNotUndefined(e.detail.project) && utilsNew_UtilsNew.isNotEmpty(e.detail.project.name)) {
      this.project = e.detail.project;
    }

    for (let i = 0; i < this.project.studies.length; i++) {
      if (this.project.studies[i].name === e.detail.study.name || this.project.studies[i].alias === e.detail.study.alias) {
        this.study = this.project.studies[i];
      }
    } //                TODO: Opencga study will be shown later. For now variant browser is shown when the study changes
    //                this.tool = "studyInformation";


    this.tool = "#browser";
    this.renderHashFragments(); // this.renderBreadcrumb();
  }

  onSampleChange(e) {
    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.samples) && utilsNew_UtilsNew.isNotUndefinedOrNull(e.detail)) {
      this.samples = e.detail.samples;
      this._samplesPerTool[this.tool.replace("#", "")] = this.samples; // this.renderBreadcrumb();
    }
  }

  buildQuery(e) {
    const query = {};
    let value = "";

    if (utilsNew_UtilsNew.isNotUndefined(e) && utilsNew_UtilsNew.isNotUndefined(e.detail.value)) {
      value = e.detail.value; // It takes care of the fired event from welcome.html
    } else if (utilsNew_UtilsNew.isNotUndefined(e) && e.keyCode === "13" || utilsNew_UtilsNew.isNotUndefined(e) && e.type === "click") {
      value = this.querySelector("#" + searchTextBox).value; // When enter key is pressed or search icon is clicked, it takes the value entered and assign it
    }

    if (value !== "") {
      if (value.startsWith("rs") || value.split(":").length > 2) {
        query.ids = value;
      } else if (value.indexOf(":") > -1 && value.indexOf("-") > -1) {
        query.region = value;
      } else if (value.startsWith("GO:")) {
        query["annot-go"] = value;
      } else if (value.startsWith("HP:")) {
        query["annot-hpo"] = value;
      } else if (value.startsWith("ENST")) {
        this.transcript = value;
        this.tool = "#transcript";
      } else {
        this.gene = value.toUpperCase();
        this.tool = "#gene";
      } // This query object is built for variant browser. Only when the queries to browser are made, we are setting the tool to browser


      if (Object.keys(query).length > 0) {
        this._query = query;
        this.tool = "#browser";
      }

      this.renderHashFragments(); // TODO convert in LitElement compliant

      this.$.searchTextBox.value = ""; // Empty the value of search text box when search is complete and respective view is loaded
    }
  }

  onQuickSearch(e) {
    const gene = PolymerUtils.getValue("searchTextBox");

    if (utilsNew_UtilsNew.isNotUndefinedOrNull(this.tool)) {
      const _query = {
        xref: gene
      };

      switch (this.tool) {
        case "#browser":
          window.location.hash = "browser/" + this.opencgaSession.project.id + "/" + this.opencgaSession.study.id;
          this.browserSearchQuery = _query;
          break;

        case "#interpretation":
          window.location.hash = "interpretation/" + this.opencgaSession.project.id + "/" + this.opencgaSession.study.id;
          this.interpretationSearchQuery = _query;
          break;

        default:
          this.tool = "#browser";
          window.location.hash = "browser/" + this.opencgaSession.project.id + "/" + this.opencgaSession.study.id;
          this.browserSearchQuery = _query;
          break;
      }
    } // debugger

  }

  quickSearch(e) {
    // debugger
    this.tool = "#browser";
    window.location.hash = "browser/" + this.opencgaSession.project.id + "/" + this.opencgaSession.study.id; // this.browserQuery = {xref: e.detail.value};

    this.browserSearchQuery = e.detail;
  }

  quickFacetSearch(e) {
    console.log("IVA-APP quickfacetsearch");
    this.tool = "#facet";
    window.location.hash = "facet/" + this.opencgaSession.project.id + "/" + this.opencgaSession.study.id; // this.browserQuery = {xref: e.detail.value};

    this.browserSearchQuery = e.detail;
  } // _checkBreadcrumbVisible() {
  //     if (UtilsNew.isNotUndefinedOrNull(this.config) && UtilsNew.isNotUndefinedOrNull(this.opencgaSession)) {
  //         this._isBreadcrumbVisible = this.config.breadcrumb.visible && this.opencgaSession.projects !== undefined && this.opencgaSession.projects.length !== 0;
  //     }
  // }
  //     renderBreadcrumb() {
  //         debugger
  //         this._checkBreadcrumbVisible();
  //
  //         let breadcrumbElement = PolymerUtils.getElementById("breadcrumb");
  //
  //         if (UtilsNew.isNotNull(breadcrumbElement) && UtilsNew.isNotUndefined(this.config)
  //             && UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && UtilsNew.isNotEmptyArray(this.opencgaSession.projects)) {
  //
  //             // If there is no project in config, breadcrumb is set private so that it is shown only when logged in
  //             // if (UtilsNew.isUndefined(this.config.opencga.projects) || this.config.opencga.projects.length === 0) {
  //             //     this.config.breadcrumb.visibility = "private";
  //             // }
  //
  //             // we empty everything
  // //                    console.log(this.breadcrumbElement)
  //             PolymerUtils.innerHTML("breadcrumb", "");
  //             // we add the 'Projects' link
  //             let projects = this._createBreadcrumbElement(this.config.breadcrumb.title, false, this.config.breadcrumb.title);
  //             breadcrumbElement.appendChild(projects);
  //
  //             // We first check if one study is selected, for this study must be defined and have at least one key
  //             if (UtilsNew.isUndefined(this.opencgaSession.study) || Object.keys(this.opencgaSession.study).length === 0) {
  //                 if (UtilsNew.isNotUndefinedOrNull(this.opencgaSession.project)) {
  //                     let project = this._createBreadcrumbElement(this.opencgaSession.project.alias, true, "project"); // render only project if exists
  //                     breadcrumbElement.appendChild(project);
  //                 }
  //             } else {
  //                 let project = this._createBreadcrumbElement(this.opencgaSession.project.alias, false, "project");
  //                 breadcrumbElement.appendChild(project);
  //
  //                 if (UtilsNew.isNotUndefined(this.samples) && this.samples.length > 0) {
  //                     let study = this._createBreadcrumbElement(this.opencgaSession.study.alias, false, "study");
  //                     let sampleNames = [];
  //                     for (let i in this.samples) {
  //                         sampleNames.push(this.samples[i].name);
  //                     }
  //                     let samples = this._createBreadcrumbElement(sampleNames.join(","), true, "sample");
  //                     breadcrumbElement.appendChild(study);
  //                     breadcrumbElement.appendChild(samples);
  //                 } else {
  //                     let study = this._createBreadcrumbElement(this.opencgaSession.study.alias, true, "study");
  //                     breadcrumbElement.appendChild(study);
  //                 }
  //             }
  //
  //             let _this = this;
  //             PolymerUtils.querySelectorAll(".breadcrumb li a").forEach(function (element) {
  //                 element.addEventListener("click", function (e) {
  //                     e.preventDefault();
  //                     switch (e.target.dataset.category) {
  //                     case _this.config.breadcrumb.title:
  //                         _this.tool = "projects";
  //                         break;
  //                     case "project":
  //                         _this.tool = "project";
  //                         break;
  //                     case "study":
  //                         _this.tool = "browser";
  //                         break;
  //                     }
  //                     _this.renderHashFragments();
  //                 });
  //             });
  //         }
  //         this.requestUpdate();
  //     }
  // _createBreadcrumbElement(name, active, category) {
  //     // name can be undefined when Polymer initialise
  //     if (typeof name === "undefined") {
  //         name = "undefined";
  //     }
  //
  //     let li = document.createElement("li");
  //     if (active === true) {
  //         li.setAttribute("class", "active");
  //         li.textContent = name;
  //     } else {
  //         let a = document.createElement("a");
  //         a.setAttribute("href", "#");
  //         a.setAttribute("class", "");
  //         a.setAttribute("data-category", category);
  //         a.textContent = name;
  //         li.appendChild(a);
  //     }
  //     return li;
  // }


  _isMenuItemVisible(item) {
    switch (item.visibility) {
      case "public":
        return true;

      case "private":
        return utilsNew_UtilsNew.isNotUndefinedOrNull(this.opencgaSession) && utilsNew_UtilsNew.isNotEmpty(this.opencgaSession.token);

      case "none":
      default:
        return false;
    }
  }

  onNotifyMessage(e) {
    NotificationUtils_NotificationUtils.closeNotify(this.notifySession);
    NotificationUtils_NotificationUtils.showNotify(e.detail.message, e.detail.type, e.detail.options, e.detail.settings);
  } // TODO geneSelected() is called by several components but it doesn't exists
  // TODO CONTINUE this should keep in sync the query object between variant-browser and variant-facet


  onQueryChange(e) {
    console.log("onQueryChange", e);
    this.browserSearchQuery = iva_app_objectSpread({}, e.detail.query);
  }

  onQueryFilterSearch(e, source) {
    // FIXME filters component emits a event containing {detail:{query:Object}} while active-filter emits {detail:{Object}}
    // TODO fix active-filters
    const q = e.detail.query || e.detail;
    this.queries[source] = iva_app_objectSpread({}, q);
    this.queries = iva_app_objectSpread({}, this.queries); // console.log("this.queries",this.queries);

    this.requestUpdate();
  }
  /* Set the width of the side navigation to 250px */


  openNav() {
    this.querySelector("#side-nav").style.width = "250px";
    console.log("open");
  }
  /* Set the width of the side navigation to 0 */


  closeNav() {
    this.querySelector("#side-nav").style.width = "0";
  }

  toggleSideNav(e) {
    e.preventDefault();
    const sidenav = this.querySelector("#side-nav");
    $("#side-nav").toggleClass("active");
    $("#overlay").toggleClass("active");
  }

  render() {
    return lit_html_html(iva_app_templateObject(), this.toggleSideNav, this.toggleSideNav, this.changeTool, this.config.logo, this.config.menu && this.config.menu.length ? this.config.menu.map(item => lit_html_html(iva_app_templateObject2(), item.id, e => {
      this.toggleSideNav(e);
      this.changeTool(e);
    }, item.icon, item.title, item.title)) : null, this.toggleSideNav, this.changeTool, this.config.logo, this.changeTool, this.config.title, this.config.version, this.config.menu.length && this.config.menu.map(item => lit_html_html(iva_app_templateObject3(), !item.submenu ? lit_html_html(iva_app_templateObject4(), item.id, this.changeTool, item.title) : lit_html_html(iva_app_templateObject5(), item.title, item.submenu.map(subitem => subitem.category ? lit_html_html(iva_app_templateObject6(), subitem.title) : subitem.separator ? lit_html_html(iva_app_templateObject7()) : lit_html_html(iva_app_templateObject8(), subitem.id, this.changeTool, subitem.id, subitem.title))))),  true ? lit_html_html(iva_app_templateObject9()) : undefined, this.opencgaSession.projects && this.opencgaSession.projects.length ? lit_html_html(iva_app_templateObject10(), this.opencgaSession.projects.map(project => lit_html_html(iva_app_templateObject11(), project.name, project.studies && project.studies.length && project.studies && project.studies.map(study => lit_html_html(iva_app_templateObject12(), study.alias, project.name, this.onStudySelect, study.alias))))) : null, this.opencgaSession.projects && this.config.search.visible ? lit_html_html(iva_app_templateObject13(), this.config.search.placeholder, this.buildQuery, this.onQuickSearch) : null, this.config.about.dropdown ? lit_html_html(iva_app_templateObject14(), this.config.about.links && this.config.about.links.map(link => lit_html_html(iva_app_templateObject15(), link.url, link.icon, link.name))) : this.config.about.links && this.config.about.links.map(link => lit_html_html(iva_app_templateObject16(), link.id, this.changeTool, link.name)), this.config.login.visible && !this.opencgaSession.token ? lit_html_html(iva_app_templateObject17(), this.changeTool) : null, this.opencgaSession.token ? lit_html_html(iva_app_templateObject18(), this.opencgaSession.user.id, this.logout) : null, this.config.breadcrumb.visible && this.opencgaSession.projects ? lit_html_html(iva_app_templateObject19(), this.config, this.opencgaSession) : null, this.config.enabledComponents.home ? lit_html_html(iva_app_templateObject20(), this.opencgaSession, this.config.version, this.cellbaseClient, this.quickSearch, this.config) : null, this.config.enabledComponents.about ? lit_html_html(iva_app_templateObject21(), this.config.version) : null, this.config.enabledComponents.terms ? lit_html_html(iva_app_templateObject22(), this.config.version) : null, this.config.enabledComponents.contact ? lit_html_html(iva_app_templateObject23(), this.config.version) : null, this.config.enabledComponents.faq ? lit_html_html(iva_app_templateObject24(), this.config.version) : null, this.config.enabledComponents.gettingstarted ? lit_html_html(iva_app_templateObject25(), this.opencgaSession, this.config) : null, JSON.stringify(this.queries), this.config.enabledComponents.login ? lit_html_html(iva_app_templateObject26(), this.opencgaClient, this.config.notifyEventMessage, this.onLogin, this.onNotifyMessage) : null, this.config.enabledComponents.browser ? lit_html_html(iva_app_templateObject27(), this.opencgaSession, this.cellbaseClient, this.reactomeClient, this.queries.variant, this.config.tools.browser.active, this.config.populationFrequencies, this.config.proteinSubstitutionScores, this.config.consequenceTypes, this.config.tools.browser, this.geneSelected, this.onSampleChange, e => this.onQueryFilterSearch(e, "variant"), e => this.onQueryFilterSearch(e, "variant"), this.quickFacetSearch) : null, this.config.enabledComponents.facet ? lit_html_html(iva_app_templateObject28(), this.opencgaSession, this.opencgaSession.opencgaClient, this.queries.variant, this.config.tools.browser, this.cellbaseClient, this.config.populationFrequencies, this.config.proteinSubstitutionScores, this.config.consequenceTypes, e => this.onQueryFilterSearch(e, "variant"), e => this.onQueryFilterSearch(e, "variant")) : null, this.config.enabledComponents.clinicalAnalysisPortal ? lit_html_html(iva_app_templateObject29(), this.opencgaSession, this.opencgaSession.opencgaClient, this.config.tools.clinicalPortal, this.cellbaseClient) : null, this.config.enabledComponents.interpretation ? lit_html_html(iva_app_templateObject30(), this.opencgaSession, this.cellbaseClient, this.clinicalAnalysisId, this.interpretationSearchQuery, this.config.populationFrequencies, this.config.proteinSubstitutionScores, this.config.consequenceTypes, this.config.tools.interpretation, this.geneSelected, this.onSampleChange) : null, this.config.enabledComponents.beacon ? lit_html_html(iva_app_templateObject31(), this.opencgaSession, this.config.tools.beacon.hosts) : null, this.config.enabledComponents.genomeBrowser ? lit_html_html(iva_app_templateObject32(), this.opencgaSession, this.cellbaseClient, this.opencgaClient) : null, this.config.enabledComponents.projects ? lit_html_html(iva_app_templateObject33(), this.opencgaSession, this.opencgaClient, this.opencgaSession.projects, this.studySummaries, this.updateProject, this.updateStudy) : null, this.config.enabledComponents.samples ? lit_html_html(_templateObject34(), this.queries.sample, this.opencgaSession, this.opencgaClient, this.config.sampleBrowser, e => this.onQueryFilterSearch(e, "sample"), e => this.onQueryFilterSearch(e, "sample"), this.quickFacetSearch) : null, this.config.enabledComponents["sample-facet"] ? lit_html_html(_templateObject35(), this.opencgaSession, this.opencgaSession.opencgaClient, this.queries.sample, this.config.tools.sampleBrowser, this.cellbaseClient, this.config.populationFrequencies, this.config.proteinSubstitutionScores, this.config.consequenceTypes, e => this.onQueryFilterSearch(e, "sample"), e => this.onQueryFilterSearch(e, "sample")) : null, this.config.enabledComponents.panel ? lit_html_html(_templateObject36(), this.opencgaSession, this.opencgaClient, this.cellbaseClient, this.config.notifyEventMessage, this.onNotifyMessage) : null, this.config.enabledComponents.files ? lit_html_html(_templateObject37(), this.opencgaSession, this.config.fileBrowser, this.queries.files, e => this.onQueryFilterSearch(e, "files"), e => this.onQueryFilterSearch(e, "files"), this.quickFacetSearch) : null, this.config.enabledComponents["files-facet"] ? lit_html_html(_templateObject38(), this.opencgaSession, this.opencgaSession.opencgaClient, this.queries.files, this.config.tools.fileBrowser, this.cellbaseClient, this.config.populationFrequencies, this.config.proteinSubstitutionScores, this.config.consequenceTypes, e => this.onQueryFilterSearch(e, "files"), e => this.onQueryFilterSearch(e, "files")) : null, this.config.enabledComponents.gene ? lit_html_html(_templateObject39(), this.opencgaSession, this.cellbaseClient, this.opencgaSession.project, this.opencgaSession.study, this.gene, this.config.populationFrequencies, this.config.consequenceTypes, this.config.proteinSubstitutionScores, this.config.tools.gene, this.config.opencga.summary) : null, this.config.enabledComponents.sample ? lit_html_html(_templateObject40(), this.opencgaSession, this.config.sampleView) : null, this.config.enabledComponents.transcript ? lit_html_html(_templateObject41(), this.cellbaseClient, this.opencgaClient, this.opencgaSession.project, this.opencgaSession.study, this.transcript, this.gene, this.config.populationFrequencies, this.config.consequenceTypes, this.config.proteinSubstitutionScores, this.config.tools.gene) : null, this.config.enabledComponents.protein ? lit_html_html(_templateObject42(), this.opencgaSession, this.cellbaseClient, this.opencgaClient, this.opencgaSession.project, this.opencgaSession.study, this.protein, this.config.populationFrequencies, this.config.consequenceTypes, this.config.proteinSubstitutionScores, this.config.tools.gene.protein) : null, this.config.enabledComponents.individuals ? lit_html_html(_templateObject43(), this.queries.individuals, this.opencgaClient, this.opencgaSession, this.config.tools.individualBrowser, e => this.onQueryFilterSearch(e, "individuals"), e => this.onQueryFilterSearch(e, "individuals"), this.quickFacetSearch) : null, this.config.enabledComponents["individual-facet"] ? lit_html_html(_templateObject44(), this.opencgaSession, this.opencgaSession.opencgaClient, this.queries.individuals, this.config.tools.individualBrowser, this.cellbaseClient, this.config.populationFrequencies, this.config.proteinSubstitutionScores, this.config.consequenceTypes, e => this.onQueryFilterSearch(e, "individuals"), e => this.onQueryFilterSearch(e, "individuals")) : null, this.config.enabledComponents.families ? lit_html_html(_templateObject45(), this.queries.families, this.opencgaClient, this.opencgaSession, e => this.onQueryFilterSearch(e, "families"), e => this.onQueryFilterSearch(e, "families"), this.quickFacetSearch) : null, this.config.enabledComponents["family-facet"] ? lit_html_html(_templateObject46(), this.opencgaSession, this.opencgaSession.opencgaClient, this.queries.families, this.config.tools.familyBrowser, this.cellbaseClient, this.config.populationFrequencies, this.config.proteinSubstitutionScores, this.config.consequenceTypes, e => this.onQueryFilterSearch(e, "families"), e => this.onQueryFilterSearch(e, "families")) : null, this.config.enabledComponents.cohorts ? lit_html_html(_templateObject47(), this.queries.cohorts, this.opencgaSession, this.config.tools.cohortBrowser, e => this.onQueryFilterSearch(e, "cohorts"), e => this.onQueryFilterSearch(e, "cohorts"), this.quickFacetSearch) : null, this.config.enabledComponents["cohort-facet"] ? lit_html_html(_templateObject48(), this.opencgaSession, this.opencgaSession.opencgaClient, this.queries.cohorts, this.config.tools.cohortBrowser, this.cellbaseClient, this.config.populationFrequencies, this.config.proteinSubstitutionScores, this.config.consequenceTypes, e => this.onQueryFilterSearch(e, "cohorts"), e => this.onQueryFilterSearch(e, "cohorts")) : null, this.config.enabledComponents.clinicalAnalysis ? lit_html_html(_templateObject49(), this.opencgaSession, this.config.clinicalAnalysisBrowser, this.queries.clinicalAnalysis, this.onUrlChange) : null, this.config.enabledComponents["clinical-analysis-facet"] ? lit_html_html(_templateObject50(), this.opencgaSession, this.config.tools.clinicalAnalysisBrowser, this.queries.clinicalAnalysis, e => this.onQueryFilterSearch(e, "clinical-analysis"), e => this.onQueryFilterSearch(e, "clinical-analysis")) : null, this.config.enabledComponents["jobs-facet"] ? lit_html_html(_templateObject51(), this.opencgaSession, this.config.tools.jobsBrowser, this.queries.jobs, e => this.onQueryFilterSearch(e, "jobs"), e => this.onQueryFilterSearch(e, "jobs")) : null, this.config.enabledComponents["cat-browser"] ? lit_html_html(_templateObject52(), this.opencgaSession, this.config.menu.find(item => item.id === "browser")) : null, this.config.enabledComponents["cat-analysis"] ? lit_html_html(_templateObject53(), this.opencgaSession, this.config.menu.find(item => item.id === "analysis")) : null, this.config.enabledComponents["cat-clinical"] ? lit_html_html(_templateObject54(), this.opencgaSession, this.config.menu.find(item => item.id === "clinical")) : null, this.config.enabledComponents["cat-catalog"] ? lit_html_html(_templateObject55(), this.opencgaSession, this.config.menu.find(item => item.id === "catalog")) : null, this.config.enabledComponents["cat-ga4gh"] ? lit_html_html(_templateObject56(), this.opencgaSession, this.config.menu.find(item => item.id === "ga4gh")) : null, this.config.enabledComponents.gwas ? lit_html_html(_templateObject57(), this.opencgaSession) : null, this.config.enabledComponents.account ? lit_html_html(_templateObject58(), this.opencgaSession) : null, this.config.enabledComponents.settings ? lit_html_html(_templateObject59(), this.opencgaSession) : null);
  }

}

customElements.define("iva-app", iva_app_IvaApp);

/***/ })
/******/ ]);